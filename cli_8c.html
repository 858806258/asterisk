<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (24 May 2007)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Thu May 24 22:27:24 2007</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir__2Fusr_2Flocal_2Fsrc_2Fasterisk_2Esvn_2Fastum_2Fmain_2F.html">main</a></div>
<h1>cli.c File Reference</h1>Standard Command Line Interface. <a href="#_details">More...</a>
<p>
<code>#include &quot;<a class="el" href="asterisk_8h-source.html">asterisk.h</a>&quot;</code><br>
<code>#include &lt;unistd.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;sys/signal.h&gt;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;signal.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;ctype.h&gt;</code><br>
<code>#include &lt;regex.h&gt;</code><br>
<code>#include &quot;<a class="el" href="logger_8h-source.html">asterisk/logger.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="options_8h-source.html">asterisk/options.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="cli_8h-source.html">asterisk/cli.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="linkedlists_8h-source.html">asterisk/linkedlists.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="module_8h-source.html">asterisk/module.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="pbx_8h-source.html">asterisk/pbx.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="channel_8h-source.html">asterisk/channel.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="utils_8h-source.html">asterisk/utils.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="app_8h-source.html">asterisk/app.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="lock_8h-source.html">asterisk/lock.h</a>&quot;</code><br>
<code>#include &quot;editline/readline/readline.h&quot;</code><br>
<code>#include &quot;<a class="el" href="threadstorage_8h-source.html">asterisk/threadstorage.h</a>&quot;</code><br>

<p>
<a href="cli_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcli__iterator.html">cli_iterator</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#1b0385fff11aaf919ffe50ed69dca7ae">AST_CLI_INITLEN</a>&nbsp;&nbsp;&nbsp;256</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initial buffer size for resulting strings in <a class="el" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli()</a>.  <a href="#1b0385fff11aaf919ffe50ed69dca7ae"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#1b39a0e2c1f2a708bbbefd7121cc4e50">CONCISE_FORMAT_STRING</a>&nbsp;&nbsp;&nbsp;&quot;%s!%s!%s!%d!%s!%s!%s!%s!%s!%d!%s!%s\n&quot;</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#5b1d59b5451c06afb65ab1bc2713cfb4">DAY</a>&nbsp;&nbsp;&nbsp;(HOUR*24)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#f2999f6807db3259a76ab2262cfad8f8">FORMAT_STRING</a>&nbsp;&nbsp;&nbsp;&quot;%-25s  %-20s  %-20s\n&quot;</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#f2999f6807db3259a76ab2262cfad8f8">FORMAT_STRING</a>&nbsp;&nbsp;&nbsp;&quot;%-20.20s %-20.20s %-7.7s %-30.30s\n&quot;</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#cd1a3f1e21f1f2590757b0869d8aa143">FORMAT_STRING2</a>&nbsp;&nbsp;&nbsp;&quot;%-20.20s %-20.20s %-7.7s %-30.30s\n&quot;</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#dd3f965174e8bb2f64523981626ced1a">HOUR</a>&nbsp;&nbsp;&nbsp;(MINUTE*60)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#46bda4cde2f10bdb9e51e3bbefa4a2bf">MINUTE</a>&nbsp;&nbsp;&nbsp;(SECOND*60)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#3f3be2b87af5e46e9b37b78b2f6f954b">MODLIST_FORMAT</a>&nbsp;&nbsp;&nbsp;&quot;%-30s %-40.40s %-10d\n&quot;</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#8bcd477fc94018c598cd2031822e8baf">MODLIST_FORMAT2</a>&nbsp;&nbsp;&nbsp;&quot;%-30s %-40.40s %-10s\n&quot;</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#6405020f7d805f0a0c5bf1609be3a226">NEEDCOMMA</a>(x)&nbsp;&nbsp;&nbsp;((x)? &quot;,&quot;: &quot;&quot;)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#2200becb80f0019c4a2ccecec350d0db">SECOND</a>&nbsp;&nbsp;&nbsp;(1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#2dc5124f4b3587e50079582cfb00c3ce">VERBOSE_FORMAT_STRING</a>&nbsp;&nbsp;&nbsp;&quot;%-20.20s %-20.20s %-16.16s %4d %-7.7s %-12.12s %-25.25s %-15.15s %8.8s %-11.11s %-20.20s\n&quot;</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#c6c834d875c9525f400abf5c3bc8f4a5">VERBOSE_FORMAT_STRING2</a>&nbsp;&nbsp;&nbsp;&quot;%-20.20s %-20.20s %-16.16s %-4.4s %-7.7s %-12.12s %-25.25s %-15.15s %8.8s %-11.11s %-20.20s\n&quot;</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#02854858ab6190b2e40f3d9b1ee16982">WEEK</a>&nbsp;&nbsp;&nbsp;(DAY*7)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#d18101729d290479023d5eceeb29c9cf">YEAR</a>&nbsp;&nbsp;&nbsp;(DAY*365)</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#4c6099872e6a10522abb6afa7512ab3c">__ast_cli_generator</a> (const char *<a class="el" href="app__queue_8c.html#1cb251ec0d568de6a929b520c4aed8d1">text</a>, const char *word, int <a class="el" href="structstate.html">state</a>, int <a class="el" href="app__queue_8c.html#dce7c4174ce9323904a934a486c41288">lock</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#e4bb643cb59964a3189cf73e3018dfa9">__ast_cli_register</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *ed)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#de4510810e9e4bf8ce8168b412617e37">__ast_cli_unregister</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *ed)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#833ba54dcfde3b670f65097c0f1aae33">ast_builtins_init</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">initialize the _full_cmd string in * each of the builtins.  <a href="#833ba54dcfde3b670f65097c0f1aae33"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a> (int fd, const char *<a class="el" href="strings_8h.html#7631454338ff70b1a6b1262f5f36beac">fmt</a>,...)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#827723f4f6d9ba0111d178d8d931b892">ast_cli_command</a> (int fd, const char *s)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Interprets a command Interpret a command s, sending output to fd Returns 0 on succes, -1 on failure.  <a href="#827723f4f6d9ba0111d178d8d931b892"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#ff4b12b0f87714d5e22fdc54065104ac">ast_cli_complete</a> (const char *word, char *const choices[], int <a class="el" href="structstate.html">state</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">char **&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#2fa472a45042f3ae905a4fbba5677b68">ast_cli_completion_matches</a> (const char *<a class="el" href="app__queue_8c.html#1cb251ec0d568de6a929b520c4aed8d1">text</a>, const char *word)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generates a NULL-terminated array of strings that 1) begin with the string in the second parameter, and 2) are valid in a command after the string in the first parameter.  <a href="#2fa472a45042f3ae905a4fbba5677b68"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#c7625505d16ef1ca9bd8837f537dfb03">ast_cli_generator</a> (const char *<a class="el" href="app__queue_8c.html#1cb251ec0d568de6a929b520c4aed8d1">text</a>, const char *word, int <a class="el" href="structstate.html">state</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Readline madness Useful for readline, that's about it Returns 0 on success, -1 on failure.  <a href="#c7625505d16ef1ca9bd8837f537dfb03"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#4c0a7fc47581d0fbc8ade249a4a021c9">ast_cli_generatornummatches</a> (const char *<a class="el" href="app__queue_8c.html#1cb251ec0d568de6a929b520c4aed8d1">text</a>, const char *word)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the number of unique matches for the generator.  <a href="#4c0a7fc47581d0fbc8ade249a4a021c9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#63b8a59f72a7d4f5f3cdef8190057349">ast_cli_register</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Registers a command or an array of commands.  <a href="#63b8a59f72a7d4f5f3cdef8190057349"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#a334dfd903e83eea3729ff37aa372781">ast_cli_register_multiple</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Register multiple commands.  <a href="#a334dfd903e83eea3729ff37aa372781"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#b895af7894fd3ae1f535f8e84811b2ea">ast_cli_unregister</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unregisters a command or an array of commands.  <a href="#b895af7894fd3ae1f535f8e84811b2ea"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#321c001e02fcba48873965ff141ff29b">ast_cli_unregister_multiple</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unregister multiple commands.  <a href="#321c001e02fcba48873965ff141ff29b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#5230ec2c08f6ec3f2c5b34af707e6743">ast_complete_channels</a> (const char *<a class="el" href="manager_8h.html#6438c669e0d0de98e6929c2cc0fac474">line</a>, const char *word, int pos, int <a class="el" href="structstate.html">state</a>, int rpos)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Command completion for the list of active channels.  <a href="#5230ec2c08f6ec3f2c5b34af707e6743"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#1064725b406359ec508e5d90aae9f192">AST_LIST_HEAD_STATIC</a> (helpers, <a class="el" href="structast__cli__entry.html">ast_cli_entry</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#fa4c13809b857ee94e6a0c5404e23deb">AST_MUTEX_DEFINE_STATIC</a> (climodentrylock)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#d8152a07f15c77af14fe2fb4f7baf7e1">AST_THREADSTORAGE</a> (ast_cli_buf)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#e1ad08e15725db1ff280b812a583b4a2">cli_next</a> (struct <a class="el" href="structcli__iterator.html">cli_iterator</a> *i)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#5147e4d3b9a175552d6c9501e3af2695">complete_ch_3</a> (const char *<a class="el" href="manager_8h.html#6438c669e0d0de98e6929c2cc0fac474">line</a>, const char *word, int pos, int <a class="el" href="structstate.html">state</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#404b357a0aeee57c0d883de95de7f786">complete_ch_4</a> (const char *<a class="el" href="manager_8h.html#6438c669e0d0de98e6929c2cc0fac474">line</a>, const char *word, int pos, int <a class="el" href="structstate.html">state</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#ba0491f78f8468eb18f46c4a799627e0">complete_fn</a> (const char *word, int <a class="el" href="structstate.html">state</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#5be9502d1aa1a3046aef9e97e61a1611">find_best</a> (char *argv[])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#9d007afcc7a56b4dfc5347284219a0e7">find_cli</a> (char *const cmds[], int match_type)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">locate a cli command in the 'helpers' list (which must be locked). exact has 3 values: 0 returns if the search key is equal or longer than the entry. note that trailing optional arguments are skipped. -1 true if the mismatch is on the last word XXX not true! 1 true only on complete, exact match.  <a href="#9d007afcc7a56b4dfc5347284219a0e7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#ca4c598d1c26b929b56dafbb2b8c58a0">group_show_channels</a> (int fd, int argc, char *argv[])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#7a6f1b84d95ef6315d384f55e84f07f9">handle_chanlist</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#00f7c0106ba490e6e968a222fe99ed0b">handle_commandcomplete</a> (int fd, int argc, char *argv[])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#d4b55bb7714193fae722ea2f0c4e4425">handle_commandmatchesarray</a> (int fd, int argc, char *argv[])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#ecba7cdd68efeebd23b52a75848aa903">handle_commandnummatches</a> (int fd, int argc, char *argv[])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#b8d4ee33a1af5803a686d86778c813a1">handle_core_set_debug_channel</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#1360a55b26d6753211dc6654c0b1a308">handle_debugchan_deprecated</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#2bf09d536da04e857543470a94ea5da9">handle_help</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#6eee8b4857c6755de398bd3918c47d38">handle_load</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#476caeae500e88220908a4aa6fe8d18d">handle_load_deprecated</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#21ab2bb3a92ceb331027f5e0dc4a16db">handle_logger_mute</a> (int fd, int argc, char *argv[])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#6d6dab8b514eaacf1bad061fa8658ab4">handle_modlist</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#27e2983e2b6b4fe55cff4f49bcc88412">handle_nodebugchan_deprecated</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#b99f0d124404a1fc4444763b26b6eabe">handle_reload</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#5c30d597c38a199b1268c519e65db1a6">handle_reload_deprecated</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#9ce379bd32f9c4c32de954569e8d3989">handle_showchan</a> (int fd, int argc, char *argv[])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#a0e77a1fd57f96117b888e8f1f020437">handle_showuptime</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#8bc688c53d73b1057a6b9146861c6479">handle_softhangup</a> (int fd, int argc, char *argv[])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#3a5584424a010c12b96b841410370e2c">handle_unload</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#5778a6561e369daf3607fb79ee9af1be">handle_unload_deprecated</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#41a087a72619630d56abab64d5cd459f">handle_verbose</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *a)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#b32b4e17f86c7b90f20d9cfcc999a92b">help1</a> (int fd, char *match[], int locked)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">helper for final part of handle_help. if locked = 0 it's just "help_workhorse", otherwise assume the list is already locked and print an error message if not found.  <a href="#b32b4e17f86c7b90f20d9cfcc999a92b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#c068114fba4aab15f80a59cda41811b4">is_prefix</a> (const char *word, const char *token, int pos, int *actual)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">if word is a valid prefix for token, returns the pos-th match as a malloced string, or NULL otherwise. Always tell in *actual how many matches we got.  <a href="#c068114fba4aab15f80a59cda41811b4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#5f26fe7300ef7f1b5efee53cc95830ad">modlist_modentry</a> (const char *module, const char *description, int usecnt, const char *like)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#654843d19ae0981865b6489880fb9742">more_words</a> (char *const *dst)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">returns true if there are more words to match  <a href="#654843d19ae0981865b6489880fb9742"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#e01ab49bede0d1e1f151dc1380d1038a">parse_args</a> (const char *s, int *argc, char *argv[], int max, int *trailingwhitespace)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#abe9a7303debc41079df1e6c87be3401">print_uptimestr</a> (int fd, time_t timeval, const char *<a class="el" href="http_8c.html#93583f8993b24e7afddf9578925bd1d8">prefix</a>, int printsec)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#cbe3c5bc7c46fc8815615f69cb6d88d9">set_full_cmd</a> (struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *e)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#7f0fe151009e2ab5ebaff4ed0c0b3594">word_match</a> (const char *cmd, const char *cli_word)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#7b94c2c41ed9fd600b9a19bb54467397">builtins</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#fb3c7b069abee786fac0195e698d4bd9">cli_cli</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#08ffcfa9a09480d0d07517d7600ed61b">cli_debug_channel_deprecated</a> = NEW_CLI(handle_debugchan_deprecated, &quot;Enable debugging on channel&quot;)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#15dd226c7128f3f9815296162cacca68">cli_module_load_deprecated</a> = NEW_CLI(handle_load_deprecated, &quot;Load a module&quot;)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#6c494c05c3aecb8ad55097db35a2cb6f">cli_module_reload_deprecated</a> = NEW_CLI(handle_reload_deprecated, &quot;reload <a class="el" href="pbx__gtkconsole_8c.html#0eb9b3af2e4a00837a1b1a854c9ea18c">modules</a> by <a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>&quot;)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#32e73832d7844e9a68d5491ee65cbe3e">cli_module_unload_deprecated</a> = NEW_CLI(handle_unload_deprecated, &quot;unload <a class="el" href="pbx__gtkconsole_8c.html#0eb9b3af2e4a00837a1b1a854c9ea18c">modules</a> by <a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>&quot;)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#ec0a0fff99f9155021d653f2f1109fbc">cli_rsvd</a> [] = &quot;[]{}|*%&quot;</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#ade24f5837e1c073d2e7cfc2adc4073c">climodentryfd</a> = -1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#41485dee80c67f6efe342780bd239f34">commandcomplete_help</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#613059ef43215b5ccff9f74e8534ebac">commandmatchesarray_help</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#b42edb1b1bf15c462f8db1b721930ac5">commandnummatches_help</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#7cde9a0914613eb0fbded6201fc9ccb6">group_show_channels_help</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#80bbfb4f5eca7598f139bef36cd1e452">logger_mute_help</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#48a9bfdf23414caddbcb373a4366ba5d">showchan_help</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cli_8c.html#9b0ab32fcf13cf20985eb791a90fd769">softhangup_help</a> []</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Standard Command Line Interface. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Mark Spencer &lt;<a href="mailto:markster@digium.com">markster@digium.com</a>&gt; </dd></dl>

<p>
Definition in file <a class="el" href="cli_8c-source.html">cli.c</a>.<hr><h2>Define Documentation</h2>
<a class="anchor" name="1b0385fff11aaf919ffe50ed69dca7ae"></a><!-- doxytag: member="cli.c::AST_CLI_INITLEN" ref="1b0385fff11aaf919ffe50ed69dca7ae" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_CLI_INITLEN&nbsp;&nbsp;&nbsp;256          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initial buffer size for resulting strings in <a class="el" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli()</a>. 
<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00055">55</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="1b39a0e2c1f2a708bbbefd7121cc4e50"></a><!-- doxytag: member="cli.c::CONCISE_FORMAT_STRING" ref="1b39a0e2c1f2a708bbbefd7121cc4e50" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CONCISE_FORMAT_STRING&nbsp;&nbsp;&nbsp;&quot;%s!%s!%s!%d!%s!%s!%s!%s!%s!%d!%s!%s\n&quot;          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="cli_8c-source.html#l00452">handle_chanlist()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="5b1d59b5451c06afb65ab1bc2713cfb4"></a><!-- doxytag: member="cli.c::DAY" ref="5b1d59b5451c06afb65ab1bc2713cfb4" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DAY&nbsp;&nbsp;&nbsp;(HOUR*24)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="cli_8c-source.html#l00330">print_uptimestr()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="f2999f6807db3259a76ab2262cfad8f8"></a><!-- doxytag: member="cli.c::FORMAT_STRING" ref="f2999f6807db3259a76ab2262cfad8f8" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define FORMAT_STRING&nbsp;&nbsp;&nbsp;&quot;%-25s  %-20s  %-20s\n&quot;          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="f2999f6807db3259a76ab2262cfad8f8"></a><!-- doxytag: member="cli.c::FORMAT_STRING" ref="f2999f6807db3259a76ab2262cfad8f8" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define FORMAT_STRING&nbsp;&nbsp;&nbsp;&quot;%-20.20s %-20.20s %-7.7s %-30.30s\n&quot;          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="cli_8c-source.html#l00904">group_show_channels()</a>, and <a class="el" href="cli_8c-source.html#l00452">handle_chanlist()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="cd1a3f1e21f1f2590757b0869d8aa143"></a><!-- doxytag: member="cli.c::FORMAT_STRING2" ref="cd1a3f1e21f1f2590757b0869d8aa143" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define FORMAT_STRING2&nbsp;&nbsp;&nbsp;&quot;%-20.20s %-20.20s %-7.7s %-30.30s\n&quot;          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="cli_8c-source.html#l00452">handle_chanlist()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="dd3f965174e8bb2f64523981626ced1a"></a><!-- doxytag: member="cli.c::HOUR" ref="dd3f965174e8bb2f64523981626ced1a" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define HOUR&nbsp;&nbsp;&nbsp;(MINUTE*60)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="cli_8c-source.html#l00330">print_uptimestr()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="46bda4cde2f10bdb9e51e3bbefa4a2bf"></a><!-- doxytag: member="cli.c::MINUTE" ref="46bda4cde2f10bdb9e51e3bbefa4a2bf" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define MINUTE&nbsp;&nbsp;&nbsp;(SECOND*60)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="cli_8c-source.html#l00330">print_uptimestr()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="3f3be2b87af5e46e9b37b78b2f6f954b"></a><!-- doxytag: member="cli.c::MODLIST_FORMAT" ref="3f3be2b87af5e46e9b37b78b2f6f954b" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define MODLIST_FORMAT&nbsp;&nbsp;&nbsp;&quot;%-30s %-40.40s %-10d\n&quot;          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00314">314</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l00320">modlist_modentry()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="8bcd477fc94018c598cd2031822e8baf"></a><!-- doxytag: member="cli.c::MODLIST_FORMAT2" ref="8bcd477fc94018c598cd2031822e8baf" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define MODLIST_FORMAT2&nbsp;&nbsp;&nbsp;&quot;%-30s %-40.40s %-10s\n&quot;          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00315">315</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l00413">handle_modlist()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="6405020f7d805f0a0c5bf1609be3a226"></a><!-- doxytag: member="cli.c::NEEDCOMMA" ref="6405020f7d805f0a0c5bf1609be3a226" args="(x)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define NEEDCOMMA          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">x&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((x)? &quot;,&quot;: &quot;&quot;)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="cli_8c-source.html#l00330">print_uptimestr()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="2200becb80f0019c4a2ccecec350d0db"></a><!-- doxytag: member="cli.c::SECOND" ref="2200becb80f0019c4a2ccecec350d0db" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define SECOND&nbsp;&nbsp;&nbsp;(1)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2dc5124f4b3587e50079582cfb00c3ce"></a><!-- doxytag: member="cli.c::VERBOSE_FORMAT_STRING" ref="2dc5124f4b3587e50079582cfb00c3ce" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define VERBOSE_FORMAT_STRING&nbsp;&nbsp;&nbsp;&quot;%-20.20s %-20.20s %-16.16s %4d %-7.7s %-12.12s %-25.25s %-15.15s %8.8s %-11.11s %-20.20s\n&quot;          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="cli_8c-source.html#l00452">handle_chanlist()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="c6c834d875c9525f400abf5c3bc8f4a5"></a><!-- doxytag: member="cli.c::VERBOSE_FORMAT_STRING2" ref="c6c834d875c9525f400abf5c3bc8f4a5" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define VERBOSE_FORMAT_STRING2&nbsp;&nbsp;&nbsp;&quot;%-20.20s %-20.20s %-16.16s %-4.4s %-7.7s %-12.12s %-25.25s %-15.15s %8.8s %-11.11s %-20.20s\n&quot;          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="cli_8c-source.html#l00452">handle_chanlist()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="02854858ab6190b2e40f3d9b1ee16982"></a><!-- doxytag: member="cli.c::WEEK" ref="02854858ab6190b2e40f3d9b1ee16982" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define WEEK&nbsp;&nbsp;&nbsp;(DAY*7)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="cli_8c-source.html#l00330">print_uptimestr()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="d18101729d290479023d5eceeb29c9cf"></a><!-- doxytag: member="cli.c::YEAR" ref="d18101729d290479023d5eceeb29c9cf" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define YEAR&nbsp;&nbsp;&nbsp;(DAY*365)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="cli_8c-source.html#l00330">print_uptimestr()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="4c6099872e6a10522abb6afa7512ab3c"></a><!-- doxytag: member="cli.c::__ast_cli_generator" ref="4c6099872e6a10522abb6afa7512ab3c" args="(const char *text, const char *word, int state, int lock)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char * __ast_cli_generator           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>text</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>word</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>state</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>lock</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l01595">1595</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="utils_8c-source.html#l00849">ast_join()</a>, <a class="el" href="linkedlists_8h-source.html#l00038">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00104">AST_LIST_UNLOCK</a>, <a class="el" href="cli_8h-source.html#l00047">AST_MAX_ARGS</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d2f4c807e7bc4e767d91adc6ee3e8869e">CLI_GENERATE</a>, <a class="el" href="cli_8c-source.html#l01065">cli_next()</a>, <a class="el" href="cli_8h-source.html#l00154">ast_cli_entry::cmda</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="structast__cli__entry.html#d70225777a1aa3b83d9d67add5cc1b74">ast_cli_entry::generator</a>, <a class="el" href="cli_8c-source.html#l01062">cli_iterator::helpers</a>, <a class="el" href="cli_8c-source.html#l01127">is_prefix()</a>, <a class="el" href="cli_8h-source.html#l00140">ast_cli_args::line</a>, <a class="el" href="cli_8c-source.html#l01582">more_words()</a>, <a class="el" href="cli_8h-source.html#l00192">ast_cli_entry::new_handler</a>, <a class="el" href="cli_8c-source.html#l01451">parse_args()</a>, and <a class="el" href="cli_8c-source.html#l01098">word_match()</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l01676">ast_cli_generator()</a>, <a class="el" href="cli_8c-source.html#l00662">handle_commandcomplete()</a>, and <a class="el" href="cli_8c-source.html#l01411">handle_help()</a>.<div class="fragment"><pre class="fragment"><a name="l01596"></a>01596 {
<a name="l01597"></a>01597    <span class="keywordtype">char</span> *argv[<a class="code" href="cli_8h.html#351f2529f74a2d8ce79f28f3fd5b3279">AST_MAX_ARGS</a>];
<a name="l01598"></a>01598    <span class="keyword">struct </span><a class="code" href="structast__cli__entry.html">ast_cli_entry</a> *e;
<a name="l01599"></a>01599    <span class="keyword">struct </span><a class="code" href="structcli__iterator.html">cli_iterator</a> i = { NULL, NULL };
<a name="l01600"></a>01600    <span class="keywordtype">int</span> x = 0, argindex, matchlen;
<a name="l01601"></a>01601    <span class="keywordtype">int</span> matchnum=0;
<a name="l01602"></a>01602    <span class="keywordtype">char</span> *ret = NULL;
<a name="l01603"></a>01603    <span class="keywordtype">char</span> matchstr[80] = <span class="stringliteral">""</span>;
<a name="l01604"></a>01604    <span class="keywordtype">int</span> tws = 0;
<a name="l01605"></a>01605    <span class="comment">/* Split the argument into an array of words */</span>
<a name="l01606"></a>01606    <span class="keywordtype">char</span> *dup = <a class="code" href="cli_8c.html#e01ab49bede0d1e1f151dc1380d1038a">parse_args</a>(<a class="code" href="app__queue_8c.html#1cb251ec0d568de6a929b520c4aed8d1">text</a>, &amp;x, argv, <span class="keyword">sizeof</span>(argv) / <span class="keyword">sizeof</span>(argv[0]), &amp;tws);
<a name="l01607"></a>01607 
<a name="l01608"></a>01608    <span class="keywordflow">if</span> (!dup)   <span class="comment">/* malloc error */</span>
<a name="l01609"></a>01609       <span class="keywordflow">return</span> NULL;
<a name="l01610"></a>01610 
<a name="l01611"></a>01611    <span class="comment">/* Compute the index of the last argument (could be an empty string) */</span>
<a name="l01612"></a>01612    argindex = (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(word) &amp;&amp; x&gt;0) ? x-1 : x;
<a name="l01613"></a>01613 
<a name="l01614"></a>01614    <span class="comment">/* rebuild the command, ignore terminating white space and flatten space */</span>
<a name="l01615"></a>01615    <a class="code" href="utils_8c.html#33e7834c0d3de361f490e1c744011610">ast_join</a>(matchstr, <span class="keyword">sizeof</span>(matchstr)-1, argv);
<a name="l01616"></a>01616    matchlen = strlen(matchstr);
<a name="l01617"></a>01617    <span class="keywordflow">if</span> (tws) {
<a name="l01618"></a>01618       strcat(matchstr, <span class="stringliteral">" "</span>); <span class="comment">/* XXX */</span>
<a name="l01619"></a>01619       <span class="keywordflow">if</span> (matchlen)
<a name="l01620"></a>01620          matchlen++;
<a name="l01621"></a>01621    }
<a name="l01622"></a>01622    <span class="keywordflow">if</span> (<a class="code" href="event_8c.html#dce7c4174ce9323904a934a486c41288">lock</a>)
<a name="l01623"></a>01623       <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;<a class="code" href="structcli__iterator.html#c2c3081275569a523f7b887c77722c5b">helpers</a>);
<a name="l01624"></a>01624    <span class="keywordflow">while</span> ( (e = <a class="code" href="cli_8c.html#e1ad08e15725db1ff280b812a583b4a2">cli_next</a>(&amp;i)) ) {
<a name="l01625"></a>01625       <span class="comment">/* XXX repeated code */</span>
<a name="l01626"></a>01626       <span class="keywordtype">int</span> src = 0, dst = 0, n = 0;
<a name="l01627"></a>01627 
<a name="l01628"></a>01628       <span class="comment">/*</span>
<a name="l01629"></a>01629 <span class="comment">       * Try to match words, up to and excluding the last word, which</span>
<a name="l01630"></a>01630 <span class="comment">       * is either a blank or something that we want to extend.</span>
<a name="l01631"></a>01631 <span class="comment">       */</span>
<a name="l01632"></a>01632       <span class="keywordflow">for</span> (;src &lt; argindex; dst++, src += n) {
<a name="l01633"></a>01633          n = <a class="code" href="cli_8c.html#7f0fe151009e2ab5ebaff4ed0c0b3594">word_match</a>(argv[src], e-&gt;<a class="code" href="structast__cli__entry.html#ec27655330419638d73b5c69b3f1168e">cmda</a>[dst]);
<a name="l01634"></a>01634          <span class="keywordflow">if</span> (n &lt; 0)
<a name="l01635"></a>01635             <span class="keywordflow">break</span>;
<a name="l01636"></a>01636       }
<a name="l01637"></a>01637 
<a name="l01638"></a>01638       <span class="keywordflow">if</span> (src != argindex &amp;&amp; <a class="code" href="cli_8c.html#654843d19ae0981865b6489880fb9742">more_words</a>(e-&gt;<a class="code" href="structast__cli__entry.html#ec27655330419638d73b5c69b3f1168e">cmda</a> + dst))  <span class="comment">/* not a match */</span>
<a name="l01639"></a>01639          <span class="keywordflow">continue</span>;
<a name="l01640"></a>01640       ret = <a class="code" href="cli_8c.html#c068114fba4aab15f80a59cda41811b4">is_prefix</a>(argv[src], e-&gt;<a class="code" href="structast__cli__entry.html#ec27655330419638d73b5c69b3f1168e">cmda</a>[dst], <a class="code" href="structstate.html">state</a> - matchnum, &amp;n);
<a name="l01641"></a>01641       matchnum += n; <span class="comment">/* this many matches here */</span>
<a name="l01642"></a>01642       <span class="keywordflow">if</span> (ret) {
<a name="l01643"></a>01643          <span class="comment">/*</span>
<a name="l01644"></a>01644 <span class="comment">          * argv[src] is a valid prefix of the next word in this</span>
<a name="l01645"></a>01645 <span class="comment">          * command. If this is also the correct entry, return it.</span>
<a name="l01646"></a>01646 <span class="comment">          */</span>
<a name="l01647"></a>01647          <span class="keywordflow">if</span> (matchnum &gt; <a class="code" href="structstate.html">state</a>)
<a name="l01648"></a>01648             <span class="keywordflow">break</span>;
<a name="l01649"></a>01649          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(ret);
<a name="l01650"></a>01650          ret = NULL;
<a name="l01651"></a>01651       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(e-&gt;<a class="code" href="structast__cli__entry.html#ec27655330419638d73b5c69b3f1168e">cmda</a>[dst])) {
<a name="l01652"></a>01652          <span class="comment">/*</span>
<a name="l01653"></a>01653 <span class="comment">          * This entry is a prefix of the command string entered</span>
<a name="l01654"></a>01654 <span class="comment">          * (only one entry in the list should have this property).</span>
<a name="l01655"></a>01655 <span class="comment">          * Run the generator if one is available. In any case we are done.</span>
<a name="l01656"></a>01656 <span class="comment">          */</span>
<a name="l01657"></a>01657          <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__cli__entry.html#d70225777a1aa3b83d9d67add5cc1b74">generator</a>)
<a name="l01658"></a>01658             ret = e-&gt;<a class="code" href="structast__cli__entry.html#d70225777a1aa3b83d9d67add5cc1b74">generator</a>(matchstr, word, argindex, <a class="code" href="structstate.html">state</a> - matchnum);
<a name="l01659"></a>01659          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__cli__entry.html#944e010ea45a0ca00cbedfed82c436f4">new_handler</a>) { <span class="comment">/* new style command */</span>
<a name="l01660"></a>01660             <span class="keyword">struct </span><a class="code" href="structast__cli__args.html">ast_cli_args</a> a = {
<a name="l01661"></a>01661                .<a class="code" href="structast__cli__args.html#6438c669e0d0de98e6929c2cc0fac474">line</a> = matchstr, .word = <a class="code" href="structast__cli__args.html#c47d187067c6cf953245f128b5fde62a">word</a>,
<a name="l01662"></a>01662                .pos = argindex,
<a name="l01663"></a>01663                .n = <a class="code" href="structstate.html">state</a> - matchnum };
<a name="l01664"></a>01664             ret = e-&gt;<a class="code" href="structast__cli__entry.html#944e010ea45a0ca00cbedfed82c436f4">new_handler</a>(e, <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d2f4c807e7bc4e767d91adc6ee3e8869e">CLI_GENERATE</a>, &amp;a);
<a name="l01665"></a>01665          }
<a name="l01666"></a>01666          <span class="keywordflow">if</span> (ret)
<a name="l01667"></a>01667             <span class="keywordflow">break</span>;
<a name="l01668"></a>01668       }
<a name="l01669"></a>01669    }
<a name="l01670"></a>01670    <span class="keywordflow">if</span> (<a class="code" href="event_8c.html#dce7c4174ce9323904a934a486c41288">lock</a>)
<a name="l01671"></a>01671       <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;helpers);
<a name="l01672"></a>01672    <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(dup);
<a name="l01673"></a>01673    <span class="keywordflow">return</span> ret;
<a name="l01674"></a>01674 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="e4bb643cb59964a3189cf73e3018dfa9"></a><!-- doxytag: member="cli.c::__ast_cli_register" ref="e4bb643cb59964a3189cf73e3018dfa9" args="(struct ast_cli_entry *e, struct ast_cli_entry *ed)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int __ast_cli_register           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ed</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l01261">1261</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8h-source.html#l00193">ast_cli_entry::_deprecated_by</a>, <a class="el" href="cli_8h-source.html#l00183">ast_cli_entry::_full_cmd</a>, <a class="el" href="linkedlists_8h-source.html#l00538">AST_LIST_INSERT_BEFORE_CURRENT</a>, <a class="el" href="linkedlists_8h-source.html#l00670">AST_LIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h-source.html#l00038">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00491">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h-source.html#l00554">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h-source.html#l00104">AST_LIST_UNLOCK</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="cli_8h-source.html#l00045">AST_MAX_CMD_LEN</a>, <a class="el" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>, <a class="el" href="cli_8h-source.html#l00154">ast_cli_entry::cmda</a>, <a class="el" href="cli_8h-source.html#l00184">ast_cli_entry::cmdlen</a>, <a class="el" href="cli_8h-source.html#l00190">ast_cli_entry::command</a>, <a class="el" href="cli_8h-source.html#l00179">ast_cli_entry::deprecate_cmd</a>, <a class="el" href="cli_8h-source.html#l00191">ast_cli_entry::deprecated</a>, <a class="el" href="cli_8c-source.html#l01174">find_cli()</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="cli_8h-source.html#l00165">ast_cli_entry::handler</a>, <a class="el" href="utils_8h-source.html#l00386">len</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="cli_8h-source.html#l00192">ast_cli_entry::new_handler</a>, <a class="el" href="aesopt_8h-source.html#l00399">s</a>, <a class="el" href="strings_8h-source.html#l00045">S_OR</a>, <a class="el" href="cli_8c-source.html#l01022">set_full_cmd()</a>, <a class="el" href="cli_8h-source.html#l00167">ast_cli_entry::summary</a>, and <a class="el" href="cli_8h-source.html#l00168">ast_cli_entry::usage</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l01344">ast_cli_register()</a>.<div class="fragment"><pre class="fragment"><a name="l01262"></a>01262 {
<a name="l01263"></a>01263    <span class="keyword">struct </span><a class="code" href="structast__cli__entry.html">ast_cli_entry</a> *cur;
<a name="l01264"></a>01264    <span class="keywordtype">int</span> i, lf, ret = -1;
<a name="l01265"></a>01265 
<a name="l01266"></a>01266    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__cli__entry.html#c1cbfe271a40788a00e8bf8574d94d4b">handler</a> == NULL) {  <span class="comment">/* new style entry, run the handler to init fields */</span>
<a name="l01267"></a>01267       <span class="keyword">struct </span><a class="code" href="structast__cli__args.html">ast_cli_args</a> a;  <span class="comment">/* fake argument */</span>
<a name="l01268"></a>01268       <span class="keywordtype">char</span> **dst = (<span class="keywordtype">char</span> **)e-&gt;<a class="code" href="structast__cli__entry.html#ec27655330419638d73b5c69b3f1168e">cmda</a>;   <span class="comment">/* need to cast as the entry is readonly */</span>
<a name="l01269"></a>01269       <span class="keywordtype">char</span> *<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>;
<a name="l01270"></a>01270 
<a name="l01271"></a>01271       bzero (&amp;a, <span class="keyword">sizeof</span>(a));
<a name="l01272"></a>01272       e-&gt;<a class="code" href="structast__cli__entry.html#944e010ea45a0ca00cbedfed82c436f4">new_handler</a>(e, <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>, &amp;a);
<a name="l01273"></a>01273       <span class="comment">/* XXX check that usage and command are filled up */</span>
<a name="l01274"></a>01274       <a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a> = ast_skip_blanks(e-&gt;<a class="code" href="structast__cli__entry.html#1dccadfed7bcbb036c56a4afb97e906f">command</a>);
<a name="l01275"></a>01275       <a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a> = e-&gt;<a class="code" href="structast__cli__entry.html#1dccadfed7bcbb036c56a4afb97e906f">command</a> = <a class="code" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>(<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>);
<a name="l01276"></a>01276       <span class="keywordflow">for</span> (i=0; !<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>) &amp;&amp; i &lt; <a class="code" href="cli_8h.html#186773f13453a244aefe55221e197cf0">AST_MAX_CMD_LEN</a>-1; i++) {
<a name="l01277"></a>01277          *dst++ = <a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>; <span class="comment">/* store string */</span>
<a name="l01278"></a>01278          <a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a> = ast_skip_nonblanks(<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>);
<a name="l01279"></a>01279          <span class="keywordflow">if</span> (*<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a> == <span class="charliteral">'\0'</span>)   <span class="comment">/* we are done */</span>
<a name="l01280"></a>01280             <span class="keywordflow">break</span>;
<a name="l01281"></a>01281          *<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>++ = <span class="charliteral">'\0'</span>;
<a name="l01282"></a>01282          <a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a> = ast_skip_blanks(<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>);
<a name="l01283"></a>01283       }
<a name="l01284"></a>01284       *dst++ = NULL;
<a name="l01285"></a>01285    }
<a name="l01286"></a>01286    <span class="keywordflow">if</span> (<a class="code" href="cli_8c.html#cbe3c5bc7c46fc8815615f69cb6d88d9">set_full_cmd</a>(e))
<a name="l01287"></a>01287       <span class="keywordflow">goto</span> done;
<a name="l01288"></a>01288    <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;helpers);
<a name="l01289"></a>01289    
<a name="l01290"></a>01290    <span class="keywordflow">if</span> (<a class="code" href="cli_8c.html#9d007afcc7a56b4dfc5347284219a0e7">find_cli</a>(e-&gt;<a class="code" href="structast__cli__entry.html#ec27655330419638d73b5c69b3f1168e">cmda</a>, 1)) {
<a name="l01291"></a>01291       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Command '%s' already registered (or something close enough)\n"</span>, e-&gt;<a class="code" href="structast__cli__entry.html#93e8a3d20be0d24b9aa32e9934e9f7b7">_full_cmd</a>);
<a name="l01292"></a>01292       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(e-&gt;<a class="code" href="structast__cli__entry.html#93e8a3d20be0d24b9aa32e9934e9f7b7">_full_cmd</a>);
<a name="l01293"></a>01293       e-&gt;<a class="code" href="structast__cli__entry.html#93e8a3d20be0d24b9aa32e9934e9f7b7">_full_cmd</a> = NULL;
<a name="l01294"></a>01294       <span class="keywordflow">goto</span> done;
<a name="l01295"></a>01295    }
<a name="l01296"></a>01296    <span class="keywordflow">if</span> (!ed) {
<a name="l01297"></a>01297       e-&gt;<a class="code" href="structast__cli__entry.html#54dac5afe1fcac2f65c059fc97b44a58">deprecated</a> = 0;
<a name="l01298"></a>01298    } <span class="keywordflow">else</span> {
<a name="l01299"></a>01299       e-&gt;<a class="code" href="structast__cli__entry.html#54dac5afe1fcac2f65c059fc97b44a58">deprecated</a> = 1;
<a name="l01300"></a>01300       e-&gt;<a class="code" href="structast__cli__entry.html#a80da1282f2c775bbc5f2c92c836968b">summary</a> = ed-&gt;<a class="code" href="structast__cli__entry.html#a80da1282f2c775bbc5f2c92c836968b">summary</a>;
<a name="l01301"></a>01301       e-&gt;<a class="code" href="structast__cli__entry.html#9366282e11c151558bdfaab4a264aa1b">usage</a> = ed-&gt;<a class="code" href="structast__cli__entry.html#9366282e11c151558bdfaab4a264aa1b">usage</a>;
<a name="l01302"></a>01302       <span class="comment">/* XXX If command A deprecates command B, and command B deprecates command C...</span>
<a name="l01303"></a>01303 <span class="comment">         Do we want to show command A or command B when telling the user to use new syntax?</span>
<a name="l01304"></a>01304 <span class="comment">         This currently would show command A.</span>
<a name="l01305"></a>01305 <span class="comment">         To show command B, you just need to always use ed-&gt;_full_cmd.</span>
<a name="l01306"></a>01306 <span class="comment">       */</span>
<a name="l01307"></a>01307       e-&gt;<a class="code" href="structast__cli__entry.html#5d12d2d33b65908e76165cc0da40bdfe">_deprecated_by</a> = <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(ed-&gt;<a class="code" href="structast__cli__entry.html#5d12d2d33b65908e76165cc0da40bdfe">_deprecated_by</a>, ed-&gt;<a class="code" href="structast__cli__entry.html#93e8a3d20be0d24b9aa32e9934e9f7b7">_full_cmd</a>);
<a name="l01308"></a>01308    }
<a name="l01309"></a>01309 
<a name="l01310"></a>01310    lf = e-&gt;<a class="code" href="structast__cli__entry.html#2eb91f3d901de6f63517d61a884caad6">cmdlen</a>;
<a name="l01311"></a>01311    <a class="code" href="linkedlists_8h.html#915e438a9528c8d6316c617b5bd84487">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;helpers, cur, list) {
<a name="l01312"></a>01312       <span class="keywordtype">int</span> <a class="code" href="utils_8h.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a> = cur-&gt;<a class="code" href="structast__cli__entry.html#2eb91f3d901de6f63517d61a884caad6">cmdlen</a>;
<a name="l01313"></a>01313       <span class="keywordflow">if</span> (lf &lt; len)
<a name="l01314"></a>01314          len = lf;
<a name="l01315"></a>01315       <span class="keywordflow">if</span> (strncasecmp(e-&gt;<a class="code" href="structast__cli__entry.html#93e8a3d20be0d24b9aa32e9934e9f7b7">_full_cmd</a>, cur-&gt;<a class="code" href="structast__cli__entry.html#93e8a3d20be0d24b9aa32e9934e9f7b7">_full_cmd</a>, len) &lt; 0) {
<a name="l01316"></a>01316          <a class="code" href="linkedlists_8h.html#16868896f20911fb4e6c9c87da34a825">AST_LIST_INSERT_BEFORE_CURRENT</a>(&amp;helpers, e, list); 
<a name="l01317"></a>01317          <span class="keywordflow">break</span>;
<a name="l01318"></a>01318       }
<a name="l01319"></a>01319    }
<a name="l01320"></a>01320    <a class="code" href="linkedlists_8h.html#a93fdadc00a2a090968004b7d9c79630">AST_LIST_TRAVERSE_SAFE_END</a>;
<a name="l01321"></a>01321 
<a name="l01322"></a>01322    <span class="keywordflow">if</span> (!cur)
<a name="l01323"></a>01323       <a class="code" href="linkedlists_8h.html#8de6ce8a3b9d59e7e7fddee6b62b32a7">AST_LIST_INSERT_TAIL</a>(&amp;helpers, e, list); 
<a name="l01324"></a>01324    ret = 0; <span class="comment">/* success */</span>
<a name="l01325"></a>01325 
<a name="l01326"></a>01326 done:
<a name="l01327"></a>01327    <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;helpers);
<a name="l01328"></a>01328 
<a name="l01329"></a>01329    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__cli__entry.html#d2538f030d45f9d90afe505b2d817b0d">deprecate_cmd</a>) {
<a name="l01330"></a>01330       <span class="comment">/* This command deprecates another command.  Register that one also. */</span>
<a name="l01331"></a>01331       <a class="code" href="cli_8c.html#e4bb643cb59964a3189cf73e3018dfa9">__ast_cli_register</a>(e-&gt;<a class="code" href="structast__cli__entry.html#d2538f030d45f9d90afe505b2d817b0d">deprecate_cmd</a>, e);
<a name="l01332"></a>01332    }
<a name="l01333"></a>01333    
<a name="l01334"></a>01334    <span class="keywordflow">return</span> ret;
<a name="l01335"></a>01335 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="de4510810e9e4bf8ce8168b412617e37"></a><!-- doxytag: member="cli.c::__ast_cli_unregister" ref="de4510810e9e4bf8ce8168b412617e37" args="(struct ast_cli_entry *e, struct ast_cli_entry *ed)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int __ast_cli_unregister           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ed</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l01237">1237</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8h-source.html#l00183">ast_cli_entry::_full_cmd</a>, <a class="el" href="linkedlists_8h-source.html#l00038">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00731">AST_LIST_REMOVE</a>, <a class="el" href="linkedlists_8h-source.html#l00104">AST_LIST_UNLOCK</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="cli_8h-source.html#l00154">ast_cli_entry::cmda</a>, <a class="el" href="cli_8h-source.html#l00190">ast_cli_entry::command</a>, <a class="el" href="cli_8h-source.html#l00179">ast_cli_entry::deprecate_cmd</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="cli_8c-source.html#l01062">cli_iterator::helpers</a>, <a class="el" href="cli_8h-source.html#l00181">ast_cli_entry::inuse</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="cli_8h-source.html#l00192">ast_cli_entry::new_handler</a>, and <a class="el" href="cli_8h-source.html#l00168">ast_cli_entry::usage</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l01338">ast_cli_unregister()</a>.<div class="fragment"><pre class="fragment"><a name="l01238"></a>01238 {
<a name="l01239"></a>01239    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__cli__entry.html#d2538f030d45f9d90afe505b2d817b0d">deprecate_cmd</a>) {
<a name="l01240"></a>01240       <a class="code" href="cli_8c.html#de4510810e9e4bf8ce8168b412617e37">__ast_cli_unregister</a>(e-&gt;<a class="code" href="structast__cli__entry.html#d2538f030d45f9d90afe505b2d817b0d">deprecate_cmd</a>, e);
<a name="l01241"></a>01241    }
<a name="l01242"></a>01242    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__cli__entry.html#9ac84af00bd68fa1e4441a101c6b6305">inuse</a>) {
<a name="l01243"></a>01243       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Can't remove command that is in use\n"</span>);
<a name="l01244"></a>01244    } <span class="keywordflow">else</span> {
<a name="l01245"></a>01245       <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;helpers);
<a name="l01246"></a>01246       <a class="code" href="linkedlists_8h.html#d4a4c53d3b264b4e1c5e3fdd84cd8b5a">AST_LIST_REMOVE</a>(&amp;helpers, e, list);
<a name="l01247"></a>01247       <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;helpers);
<a name="l01248"></a>01248       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(e-&gt;<a class="code" href="structast__cli__entry.html#93e8a3d20be0d24b9aa32e9934e9f7b7">_full_cmd</a>);
<a name="l01249"></a>01249       e-&gt;<a class="code" href="structast__cli__entry.html#93e8a3d20be0d24b9aa32e9934e9f7b7">_full_cmd</a> = NULL;
<a name="l01250"></a>01250       <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__cli__entry.html#944e010ea45a0ca00cbedfed82c436f4">new_handler</a>) {
<a name="l01251"></a>01251          <span class="comment">/* this is a new-style entry. Reset fields and free memory. */</span>
<a name="l01252"></a>01252          bzero((<span class="keywordtype">char</span> **)(e-&gt;<a class="code" href="structast__cli__entry.html#ec27655330419638d73b5c69b3f1168e">cmda</a>), <span class="keyword">sizeof</span>(e-&gt;<a class="code" href="structast__cli__entry.html#ec27655330419638d73b5c69b3f1168e">cmda</a>));
<a name="l01253"></a>01253          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(e-&gt;<a class="code" href="structast__cli__entry.html#1dccadfed7bcbb036c56a4afb97e906f">command</a>);
<a name="l01254"></a>01254          e-&gt;<a class="code" href="structast__cli__entry.html#1dccadfed7bcbb036c56a4afb97e906f">command</a> = NULL;
<a name="l01255"></a>01255          e-&gt;<a class="code" href="structast__cli__entry.html#9366282e11c151558bdfaab4a264aa1b">usage</a> = NULL;
<a name="l01256"></a>01256       }
<a name="l01257"></a>01257    }
<a name="l01258"></a>01258    <span class="keywordflow">return</span> 0;
<a name="l01259"></a>01259 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="833ba54dcfde3b670f65097c0f1aae33"></a><!-- doxytag: member="cli.c::ast_builtins_init" ref="833ba54dcfde3b670f65097c0f1aae33" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_builtins_init           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
initialize the _full_cmd string in * each of the builtins. 
<p>
Provided by <a class="el" href="cli_8c.html">cli.c</a> 
<p>
Definition at line <a class="el" href="cli_8c-source.html#l01041">1041</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l01352">ast_cli_register_multiple()</a>, <a class="el" href="cli_8h-source.html#l00154">ast_cli_entry::cmda</a>, and <a class="el" href="cli_8c-source.html#l01022">set_full_cmd()</a>.
<p>
Referenced by <a class="el" href="asterisk_8c-source.html#l02570">main()</a>.<div class="fragment"><pre class="fragment"><a name="l01042"></a>01042 {
<a name="l01043"></a>01043    <span class="keyword">struct </span><a class="code" href="structast__cli__entry.html">ast_cli_entry</a> *e;
<a name="l01044"></a>01044 
<a name="l01045"></a>01045    <span class="keywordflow">for</span> (e = <a class="code" href="cli_8c.html#7b94c2c41ed9fd600b9a19bb54467397">builtins</a>; e-&gt;<a class="code" href="structast__cli__entry.html#ec27655330419638d73b5c69b3f1168e">cmda</a>[0] != NULL; e++)
<a name="l01046"></a>01046       <a class="code" href="cli_8c.html#cbe3c5bc7c46fc8815615f69cb6d88d9">set_full_cmd</a>(e);
<a name="l01047"></a>01047 
<a name="l01048"></a>01048    <a class="code" href="cli_8c.html#a334dfd903e83eea3729ff37aa372781">ast_cli_register_multiple</a>(<a class="code" href="cli_8c.html#fb3c7b069abee786fac0195e698d4bd9">cli_cli</a>, <span class="keyword">sizeof</span>(<a class="code" href="cli_8c.html#fb3c7b069abee786fac0195e698d4bd9">cli_cli</a>) / <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structast__cli__entry.html">ast_cli_entry</a>));
<a name="l01049"></a>01049 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b610d6e1fd70e1b164d66a2ee22207dc"></a><!-- doxytag: member="cli.c::ast_cli" ref="b610d6e1fd70e1b164d66a2ee22207dc" args="(int fd, const char *fmt,...)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_cli           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>...</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00057">57</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="utils_8c-source.html#l00648">ast_carefulwrite()</a>, <a class="el" href="cli_8c-source.html#l00055">AST_CLI_INITLEN</a>, <a class="el" href="strings_8h-source.html#l00552">ast_str_set_va</a>, <a class="el" href="adsistub_8c-source.html#l00065">buf</a>, and <a class="el" href="strings_8h-source.html#l00319">ast_str::str</a>.
<p>
Referenced by <a class="el" href="chan__iax2_8c-source.html#l04208">__iax2_show_peers()</a>, <a class="el" href="app__playback_8c-source.html#l00330">__say_init()</a>, <a class="el" href="chan__sip_8c-source.html#l11299">__sip_show_channels()</a>, <a class="el" href="chan__sip_8c-source.html#l10808">_sip_show_peer()</a>, <a class="el" href="chan__sip_8c-source.html#l10356">_sip_show_peers()</a>, <a class="el" href="chan__agent_8c-source.html#l01541">agent_logoff_cmd()</a>, <a class="el" href="chan__agent_8c-source.html#l01610">agents_show()</a>, <a class="el" href="chan__agent_8c-source.html#l01675">agents_show_online()</a>, <a class="el" href="res__agi_8c-source.html#l01328">agi_do_debug()</a>, <a class="el" href="res__agi_8c-source.html#l01337">agi_no_debug()</a>, <a class="el" href="res__jabber_8c-source.html#l01924">aji_do_debug()</a>, <a class="el" href="res__jabber_8c-source.html#l01940">aji_do_reload()</a>, <a class="el" href="res__jabber_8c-source.html#l01952">aji_no_debug()</a>, <a class="el" href="res__jabber_8c-source.html#l01968">aji_show_clients()</a>, <a class="el" href="res__jabber_8c-source.html#l02002">aji_test()</a>, <a class="el" href="cli_8c-source.html#l01681">ast_cli_command()</a>, <a class="el" href="chan__iax2_8c-source.html#l04530">ast_cli_netstats()</a>, <a class="el" href="asterisk_8c-source.html#l00800">ast_console_toggle_mute()</a>, <a class="el" href="res__convert_8c-source.html#l00057">cli_audio_convert()</a>, <a class="el" href="res__astum_8c-source.html#l00437">cli_aum_load_rtuser()</a>, <a class="el" href="res__astum_8c-source.html#l00562">cli_aum_show_group()</a>, <a class="el" href="res__astum_8c-source.html#l00633">cli_aum_show_groups()</a>, <a class="el" href="res__astum_8c-source.html#l00380">cli_aum_show_stats()</a>, <a class="el" href="res__astum_8c-source.html#l00474">cli_aum_show_user()</a>, <a class="el" href="res__astum_8c-source.html#l00408">cli_aum_show_users()</a>, <a class="el" href="res__musiconhold_8c-source.html#l01154">cli_files_show()</a>, <a class="el" href="func__devstate_8c-source.html#l00112">cli_funcdevstate_list()</a>, <a class="el" href="res__realtime_8c-source.html#l00050">cli_realtime_load()</a>, <a class="el" href="res__realtime_8c-source.html#l00075">cli_realtime_update()</a>, <a class="el" href="res__config__sqlite_8c-source.html#l01191">cli_status()</a>, <a class="el" href="config_8c-source.html#l01449">config_command()</a>, <a class="el" href="chan__oss_8c-source.html#l01374">console_active()</a>, <a class="el" href="chan__alsa_8c-source.html#l00891">console_answer()</a>, <a class="el" href="chan__alsa_8c-source.html#l00847">console_autoanswer()</a>, <a class="el" href="chan__alsa_8c-source.html#l01004">console_dial()</a>, <a class="el" href="chan__oss_8c-source.html#l01235">console_flash()</a>, <a class="el" href="chan__alsa_8c-source.html#l00972">console_hangup()</a>, <a class="el" href="chan__alsa_8c-source.html#l00927">console_sendtext()</a>, <a class="el" href="chan__oss_8c-source.html#l01339">console_transfer()</a>, <a class="el" href="db_8c-source.html#l00272">database_del()</a>, <a class="el" href="db_8c-source.html#l00286">database_deltree()</a>, <a class="el" href="db_8c-source.html#l00257">database_get()</a>, <a class="el" href="db_8c-source.html#l00243">database_put()</a>, <a class="el" href="db_8c-source.html#l00304">database_show()</a>, <a class="el" href="db_8c-source.html#l00354">database_showkey()</a>, <a class="el" href="chan__oss_8c-source.html#l01424">do_boost()</a>, <a class="el" href="app__queue_8c-source.html#l04132">do_print()</a>, <a class="el" href="pbx__dundi_8c-source.html#l02166">dundi_do_debug()</a>, <a class="el" href="pbx__dundi_8c-source.html#l02291">dundi_do_lookup()</a>, <a class="el" href="pbx__dundi_8c-source.html#l02332">dundi_do_precache()</a>, <a class="el" href="pbx__dundi_8c-source.html#l02357">dundi_do_query()</a>, <a class="el" href="pbx__dundi_8c-source.html#l02175">dundi_do_store_history()</a>, <a class="el" href="pbx__dundi_8c-source.html#l02184">dundi_flush()</a>, <a class="el" href="pbx__dundi_8c-source.html#l02217">dundi_no_debug()</a>, <a class="el" href="pbx__dundi_8c-source.html#l02226">dundi_no_store_history()</a>, <a class="el" href="pbx__dundi_8c-source.html#l02562">dundi_show_entityid()</a>, <a class="el" href="pbx__dundi_8c-source.html#l02596">dundi_show_mappings()</a>, <a class="el" href="pbx__dundi_8c-source.html#l02395">dundi_show_peer()</a>, <a class="el" href="pbx__dundi_8c-source.html#l02459">dundi_show_peers()</a>, <a class="el" href="pbx__dundi_8c-source.html#l02619">dundi_show_precache()</a>, <a class="el" href="pbx__dundi_8c-source.html#l02574">dundi_show_requests()</a>, <a class="el" href="pbx__dundi_8c-source.html#l02543">dundi_show_trans()</a>, <a class="el" href="res__eventtest_8c-source.html#l00121">event_get_cached()</a>, <a class="el" href="chan__features_8c-source.html#l00511">features_show()</a>, <a class="el" href="cli_8c-source.html#l00904">group_show_channels()</a>, <a class="el" href="chan__gtalk_8c-source.html#l01553">gtalk_show_channels()</a>, <a class="el" href="chan__h323_8c-source.html#l02654">h323_do_debug()</a>, <a class="el" href="chan__h323_8c-source.html#l02634">h323_do_trace()</a>, <a class="el" href="chan__h323_8c-source.html#l02664">h323_no_debug()</a>, <a class="el" href="chan__h323_8c-source.html#l02644">h323_no_trace()</a>, <a class="el" href="res__agi_8c-source.html#l01974">handle_agidumphtml()</a>, <a class="el" href="cli_8c-source.html#l00452">handle_chanlist()</a>, <a class="el" href="cdr_8c-source.html#l01170">handle_cli_status()</a>, <a class="el" href="cdr_8c-source.html#l01204">handle_cli_submit()</a>, <a class="el" href="cli_8c-source.html#l00662">handle_commandcomplete()</a>, <a class="el" href="cli_8c-source.html#l00605">handle_commandmatchesarray()</a>, <a class="el" href="cli_8c-source.html#l00648">handle_commandnummatches()</a>, <a class="el" href="pbx__config_8c-source.html#l00938">handle_context_add_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01065">handle_context_add_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00574">handle_context_add_include()</a>, <a class="el" href="pbx__config_8c-source.html#l00335">handle_context_remove_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01153">handle_context_remove_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00117">handle_context_remove_include()</a>, <a class="el" href="cli_8c-source.html#l00677">handle_core_set_debug_channel()</a>, <a class="el" href="cli_8c-source.html#l01411">handle_help()</a>, <a class="el" href="cli_8c-source.html#l00111">handle_load()</a>, <a class="el" href="logger_8c-source.html#l00524">handle_logger_reload()</a>, <a class="el" href="logger_8c-source.html#l00533">handle_logger_rotate()</a>, <a class="el" href="logger_8c-source.html#l00543">handle_logger_show_channels()</a>, <a class="el" href="manager_8c-source.html#l00479">handle_mandebug()</a>, <a class="el" href="app__minivm_8c-source.html#l02636">handle_minivm_list_templates()</a>, <a class="el" href="app__minivm_8c-source.html#l03196">handle_minivm_reload()</a>, <a class="el" href="app__minivm_8c-source.html#l02757">handle_minivm_show_settings()</a>, <a class="el" href="app__minivm_8c-source.html#l02778">handle_minivm_show_stats()</a>, <a class="el" href="app__minivm_8c-source.html#l02667">handle_minivm_show_users()</a>, <a class="el" href="app__minivm_8c-source.html#l02706">handle_minivm_show_zones()</a>, <a class="el" href="cli_8c-source.html#l00413">handle_modlist()</a>, <a class="el" href="res__features_8c-source.html#l02262">handle_parkedcalls()</a>, <a class="el" href="app__queue_8c-source.html#l04544">handle_queue_add_member()</a>, <a class="el" href="app__queue_8c-source.html#l04631">handle_queue_remove_member()</a>, <a class="el" href="cli_8c-source.html#l00144">handle_reload()</a>, <a class="el" href="asterisk_8c-source.html#l01584">handle_restart_when_convenient()</a>, <a class="el" href="pbx__config_8c-source.html#l00717">handle_save_dialplan()</a>, <a class="el" href="pbx_8c-source.html#l03770">handle_set_global()</a>, <a class="el" href="pbx_8c-source.html#l03021">handle_show_application()</a>, <a class="el" href="pbx_8c-source.html#l03196">handle_show_applications()</a>, <a class="el" href="pbx_8c-source.html#l03480">handle_show_dialplan()</a>, <a class="el" href="pbx_8c-source.html#l01269">handle_show_function()</a>, <a class="el" href="pbx_8c-source.html#l01241">handle_show_functions()</a>, <a class="el" href="pbx_8c-source.html#l03754">handle_show_globals()</a>, <a class="el" href="pbx_8c-source.html#l03142">handle_show_hints()</a>, <a class="el" href="http_8c-source.html#l01251">handle_show_http()</a>, <a class="el" href="res__indications_8c-source.html#l00149">handle_show_indications()</a>, <a class="el" href="asterisk_8c-source.html#l00543">handle_show_profile()</a>, <a class="el" href="asterisk_8c-source.html#l00344">handle_show_settings()</a>, <a class="el" href="pbx_8c-source.html#l03175">handle_show_switches()</a>, <a class="el" href="asterisk_8c-source.html#l00404">handle_show_threads()</a>, <a class="el" href="asterisk_8c-source.html#l00595">handle_show_version_files()</a>, <a class="el" href="res__agi_8c-source.html#l01919">handle_showagi()</a>, <a class="el" href="cli_8c-source.html#l00770">handle_showchan()</a>, <a class="el" href="res__features_8c-source.html#l02102">handle_showfeatures()</a>, <a class="el" href="manager_8c-source.html#l00494">handle_showmanager()</a>, <a class="el" href="manager_8c-source.html#l00532">handle_showmanagers()</a>, <a class="el" href="manager_8c-source.html#l00456">handle_showmancmd()</a>, <a class="el" href="manager_8c-source.html#l00566">handle_showmancmds()</a>, <a class="el" href="manager_8c-source.html#l00584">handle_showmanconn()</a>, <a class="el" href="manager_8c-source.html#l00601">handle_showmaneventq()</a>, <a class="el" href="asterisk_8c-source.html#l01559">handle_shutdown_when_convenient()</a>, <a class="el" href="cli_8c-source.html#l00588">handle_softhangup()</a>, <a class="el" href="cli_8c-source.html#l00259">handle_unload()</a>, <a class="el" href="cli_8c-source.html#l00187">handle_verbose()</a>, <a class="el" href="asterisk_8c-source.html#l01456">handle_version()</a>, <a class="el" href="app__voicemail_8c-source.html#l07236">handle_voicemail_show_users()</a>, <a class="el" href="app__voicemail_8c-source.html#l07296">handle_voicemail_show_zones()</a>, <a class="el" href="chan__zap_8c-source.html#l11025">handle_zap_show_cadences()</a>, <a class="el" href="cli_8c-source.html#l01378">help1()</a>, <a class="el" href="res__agi_8c-source.html#l01649">help_workhorse()</a>, <a class="el" href="chan__iax2_8c-source.html#l04618">iax2_do_debug()</a>, <a class="el" href="chan__iax2_8c-source.html#l04636">iax2_do_jb_debug()</a>, <a class="el" href="chan__iax2_8c-source.html#l04627">iax2_do_trunk_debug()</a>, <a class="el" href="chan__iax2_8c-source.html#l04645">iax2_no_debug()</a>, <a class="el" href="chan__iax2_8c-source.html#l04663">iax2_no_jb_debug()</a>, <a class="el" href="chan__iax2_8c-source.html#l04654">iax2_no_trunk_debug()</a>, <a class="el" href="chan__iax2_8c-source.html#l08168">iax2_prov_cmd()</a>, <a class="el" href="chan__iax2_8c-source.html#l01994">iax2_prune_realtime()</a>, <a class="el" href="chan__iax2_8c-source.html#l02203">iax2_set_mtu()</a>, <a class="el" href="chan__iax2_8c-source.html#l02228">iax2_show_cache()</a>, <a class="el" href="chan__iax2_8c-source.html#l04483">iax2_show_channels()</a>, <a class="el" href="chan__iax2_8c-source.html#l04399">iax2_show_firmware()</a>, <a class="el" href="chan__iax2_8c-source.html#l04606">iax2_show_netstats()</a>, <a class="el" href="chan__iax2_8c-source.html#l02087">iax2_show_peer()</a>, <a class="el" href="chan__iax2_8c-source.html#l04455">iax2_show_registry()</a>, <a class="el" href="chan__iax2_8c-source.html#l02169">iax2_show_stats()</a>, <a class="el" href="chan__iax2_8c-source.html#l04329">iax2_show_threads()</a>, <a class="el" href="chan__iax2_8c-source.html#l04147">iax2_show_users()</a>, <a class="el" href="iax2-provision_8c-source.html#l00428">iax_show_provisioning()</a>, <a class="el" href="chan__local_8c-source.html#l00669">locals_show()</a>, <a class="el" href="app__meetme_8c-source.html#l00808">meetme_cmd()</a>, <a class="el" href="chan__mgcp_8c-source.html#l01149">mgcp_do_debug()</a>, <a class="el" href="chan__mgcp_8c-source.html#l01158">mgcp_no_debug()</a>, <a class="el" href="chan__mgcp_8c-source.html#l01045">mgcp_show_endpoints()</a>, <a class="el" href="chan__misdn_8c-source.html#l01052">misdn_reload()</a>, <a class="el" href="chan__misdn_8c-source.html#l01239">misdn_send_cd()</a>, <a class="el" href="chan__misdn_8c-source.html#l01272">misdn_send_digit()</a>, <a class="el" href="chan__misdn_8c-source.html#l01349">misdn_send_display()</a>, <a class="el" href="chan__misdn_8c-source.html#l00731">misdn_set_debug()</a>, <a class="el" href="chan__misdn_8c-source.html#l01114">misdn_show_cls()</a>, <a class="el" href="chan__misdn_8c-source.html#l00904">misdn_show_config()</a>, <a class="el" href="chan__misdn_8c-source.html#l01220">misdn_show_port()</a>, <a class="el" href="chan__misdn_8c-source.html#l01203">misdn_show_ports_stats()</a>, <a class="el" href="chan__misdn_8c-source.html#l01186">misdn_show_stacks()</a>, <a class="el" href="chan__misdn_8c-source.html#l01312">misdn_toggle_echocancel()</a>, <a class="el" href="app__mixmonitor_8c-source.html#l00399">mixmonitor_cli()</a>, <a class="el" href="cli_8c-source.html#l00320">modlist_modentry()</a>, <a class="el" href="res__musiconhold_8c-source.html#l01173">moh_classes_show()</a>, <a class="el" href="res__musiconhold_8c-source.html#l01142">moh_cli()</a>, <a class="el" href="res__limit_8c-source.html#l00086">my_ulimit()</a>, <a class="el" href="res__odbc_8c-source.html#l00312">odbc_show_command()</a>, <a class="el" href="res__clioriginate_8c-source.html#l00072">orig_app()</a>, <a class="el" href="res__clioriginate_8c-source.html#l00094">orig_exten()</a>, <a class="el" href="app__osplookup_8c-source.html#l02026">osp_show()</a>, <a class="el" href="chan__misdn_8c-source.html#l01059">print_bc_info()</a>, <a class="el" href="chan__sip_8c-source.html#l10719">print_codec_to_cli()</a>, <a class="el" href="chan__sip_8c-source.html#l10510">print_group()</a>, <a class="el" href="cli_8c-source.html#l00330">print_uptimestr()</a>, <a class="el" href="res__config__pgsql_8c-source.html#l00775">realtime_pgsql_status()</a>, <a class="el" href="app__rpt_8c-source.html#l01110">rpt_do_debug()</a>, <a class="el" href="app__rpt_8c-source.html#l01131">rpt_do_dump()</a>, <a class="el" href="app__rpt_8c-source.html#l01329">rpt_do_lstats()</a>, <a class="el" href="app__rpt_8c-source.html#l01151">rpt_do_stats()</a>, <a class="el" href="rtp_8c-source.html#l03568">rtcp_do_debug()</a>, <a class="el" href="rtp_8c-source.html#l03525">rtcp_do_debug_ip()</a>, <a class="el" href="rtp_8c-source.html#l03581">rtcp_do_stats()</a>, <a class="el" href="rtp_8c-source.html#l03599">rtcp_no_debug()</a>, <a class="el" href="rtp_8c-source.html#l03608">rtcp_no_stats()</a>, <a class="el" href="rtp_8c-source.html#l03555">rtp_do_debug()</a>, <a class="el" href="rtp_8c-source.html#l03495">rtp_do_debug_ip()</a>, <a class="el" href="rtp_8c-source.html#l03590">rtp_no_debug()</a>, <a class="el" href="channel_8c-source.html#l00231">show_channeltype()</a>, <a class="el" href="channel_8c-source.html#l00203">show_channeltypes()</a>, <a class="el" href="frame_8c-source.html#l00671">show_codec_n()</a>, <a class="el" href="frame_8c-source.html#l00623">show_codecs()</a>, <a class="el" href="chan__misdn_8c-source.html#l00881">show_config_description()</a>, <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>, <a class="el" href="file_8c-source.html#l01127">show_file_formats()</a>, <a class="el" href="image_8c-source.html#l00183">show_image_formats()</a>, <a class="el" href="res__crypto_8c-source.html#l00518">show_keys()</a>, <a class="el" href="asterisk_8c-source.html#l01657">show_license()</a>, <a class="el" href="translate_8c-source.html#l00492">show_translation()</a>, <a class="el" href="app__voicemail_8c-source.html#l07202">show_users_realtime()</a>, <a class="el" href="asterisk_8c-source.html#l01631">show_warranty()</a>, <a class="el" href="chan__sip_8c-source.html#l11841">sip_do_debug()</a>, <a class="el" href="chan__sip_8c-source.html#l11787">sip_do_debug_ip()</a>, <a class="el" href="chan__sip_8c-source.html#l11819">sip_do_debug_peer()</a>, <a class="el" href="chan__sip_8c-source.html#l11929">sip_do_history()</a>, <a class="el" href="chan__sip_8c-source.html#l11918">sip_no_debug()</a>, <a class="el" href="chan__sip_8c-source.html#l11940">sip_no_history()</a>, <a class="el" href="chan__sip_8c-source.html#l11862">sip_notify()</a>, <a class="el" href="chan__sip_8c-source.html#l10572">sip_prune_realtime()</a>, <a class="el" href="chan__sip_8c-source.html#l11515">sip_show_channel()</a>, <a class="el" href="chan__sip_8c-source.html#l10750">sip_show_domains()</a>, <a class="el" href="chan__sip_8c-source.html#l11585">sip_show_history()</a>, <a class="el" href="chan__sip_8c-source.html#l10170">sip_show_inuse()</a>, <a class="el" href="chan__sip_8c-source.html#l10496">sip_show_objects()</a>, <a class="el" href="chan__sip_8c-source.html#l11081">sip_show_registry()</a>, <a class="el" href="chan__sip_8c-source.html#l11134">sip_show_settings()</a>, <a class="el" href="chan__sip_8c-source.html#l11026">sip_show_user()</a>, <a class="el" href="chan__sip_8c-source.html#l10270">sip_show_users()</a>, <a class="el" href="chan__sip_8c-source.html#l11115">sip_unregister()</a>, <a class="el" href="chan__skinny_8c-source.html#l01853">skinny_do_debug()</a>, <a class="el" href="chan__skinny_8c-source.html#l01863">skinny_no_debug()</a>, <a class="el" href="chan__skinny_8c-source.html#l01996">skinny_show_devices()</a>, <a class="el" href="chan__skinny_8c-source.html#l02027">skinny_show_lines()</a>, <a class="el" href="app__meetme_8c-source.html#l01097">sla_show_stations()</a>, <a class="el" href="app__meetme_8c-source.html#l01037">sla_show_trunks()</a>, <a class="el" href="rtp_8c-source.html#l03617">stun_do_debug()</a>, <a class="el" href="rtp_8c-source.html#l03626">stun_no_debug()</a>, <a class="el" href="udptl_8c-source.html#l01163">udptl_do_debug()</a>, <a class="el" href="udptl_8c-source.html#l01131">udptl_do_debug_ip()</a>, <a class="el" href="udptl_8c-source.html#l01176">udptl_nodebug()</a>, <a class="el" href="chan__zap_8c-source.html#l10886">zap_show_channel()</a>, <a class="el" href="chan__zap_8c-source.html#l10773">zap_show_channels()</a>, <a class="el" href="chan__zap_8c-source.html#l11052">zap_show_status()</a>, and <a class="el" href="chan__zap_8c-source.html#l11113">zap_show_version()</a>.<div class="fragment"><pre class="fragment"><a name="l00058"></a>00058 {
<a name="l00059"></a>00059    <span class="keywordtype">int</span> res;
<a name="l00060"></a>00060    <span class="keyword">struct </span><a class="code" href="structast__str.html">ast_str</a> *<a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>;
<a name="l00061"></a>00061    va_list ap;
<a name="l00062"></a>00062 
<a name="l00063"></a>00063    <span class="keywordflow">if</span> (!(buf = ast_str_thread_get(&amp;ast_cli_buf, <a class="code" href="cli_8c.html#1b0385fff11aaf919ffe50ed69dca7ae">AST_CLI_INITLEN</a>)))
<a name="l00064"></a>00064       <span class="keywordflow">return</span>;
<a name="l00065"></a>00065 
<a name="l00066"></a>00066    va_start(ap, <a class="code" href="manager_8h.html#7631454338ff70b1a6b1262f5f36beac">fmt</a>);
<a name="l00067"></a>00067    res = <a class="code" href="strings_8h.html#e22d33692bbb95b75e1f68a3a7f0f3d6">ast_str_set_va</a>(&amp;buf, 0, <a class="code" href="manager_8h.html#7631454338ff70b1a6b1262f5f36beac">fmt</a>, ap);
<a name="l00068"></a>00068    va_end(ap);
<a name="l00069"></a>00069 
<a name="l00070"></a>00070    <span class="keywordflow">if</span> (res != AST_DYNSTR_BUILD_FAILED)
<a name="l00071"></a>00071       <a class="code" href="utils_8c.html#ee4f9efa51266968c039e00834d32aaa">ast_carefulwrite</a>(fd, buf-&gt;<a class="code" href="structast__str.html#3929b4348d8e5ee862fd1e38834d0217">str</a>, strlen(buf-&gt;<a class="code" href="structast__str.html#3929b4348d8e5ee862fd1e38834d0217">str</a>), 100);
<a name="l00072"></a>00072 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="827723f4f6d9ba0111d178d8d931b892"></a><!-- doxytag: member="cli.c::ast_cli_command" ref="827723f4f6d9ba0111d178d8d931b892" args="(int fd, const char *s)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cli_command           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>s</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Interprets a command Interpret a command s, sending output to fd Returns 0 on succes, -1 on failure. 
<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l01681">1681</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8h-source.html#l00193">ast_cli_entry::_deprecated_by</a>, <a class="el" href="cli_8h-source.html#l00183">ast_cli_entry::_full_cmd</a>, <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="linkedlists_8h-source.html#l00038">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00104">AST_LIST_UNLOCK</a>, <a class="el" href="cli_8h-source.html#l00047">AST_MAX_ARGS</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d380457cd644023f5d9c2553c0248aeb1">CLI_HANDLER</a>, <a class="el" href="cli_8h-source.html#l00042">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h-source.html#l00041">CLI_SUCCESS</a>, <a class="el" href="cli_8h-source.html#l00191">ast_cli_entry::deprecated</a>, <a class="el" href="cli_8h-source.html#l00137">ast_cli_args::fd</a>, <a class="el" href="cli_8c-source.html#l01218">find_best()</a>, <a class="el" href="cli_8c-source.html#l01174">find_cli()</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="cli_8h-source.html#l00165">ast_cli_entry::handler</a>, <a class="el" href="cli_8h-source.html#l00181">ast_cli_entry::inuse</a>, <a class="el" href="cli_8h-source.html#l00192">ast_cli_entry::new_handler</a>, <a class="el" href="cli_8c-source.html#l01451">parse_args()</a>, <a class="el" href="cli_8h-source.html#l00039">RESULT_FAILURE</a>, <a class="el" href="cli_8h-source.html#l00038">RESULT_SHOWUSAGE</a>, <a class="el" href="cli_8h-source.html#l00037">RESULT_SUCCESS</a>, <a class="el" href="strings_8h-source.html#l00045">S_OR</a>, and <a class="el" href="cli_8h-source.html#l00168">ast_cli_entry::usage</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l01797">action_command()</a>, <a class="el" href="pbx__gtkconsole_8c-source.html#l00346">cli_activate()</a>, <a class="el" href="asterisk_8c-source.html#l01360">consolehandler()</a>, <a class="el" href="pbx__gtkconsole_8c-source.html#l00321">exit_completely()</a>, <a class="el" href="app__rpt_8c-source.html#l03296">function_cop()</a>, <a class="el" href="asterisk_8c-source.html#l00872">netconsole()</a>, and <a class="el" href="app__rpt_8c-source.html#l06656">rpt_master()</a>.<div class="fragment"><pre class="fragment"><a name="l01682"></a>01682 {
<a name="l01683"></a>01683    <span class="keywordtype">char</span> *args[<a class="code" href="cli_8h.html#351f2529f74a2d8ce79f28f3fd5b3279">AST_MAX_ARGS</a> + 1];
<a name="l01684"></a>01684    <span class="keyword">struct </span><a class="code" href="structast__cli__entry.html">ast_cli_entry</a> *e;
<a name="l01685"></a>01685    <span class="keywordtype">int</span> x;
<a name="l01686"></a>01686    <span class="keywordtype">int</span> res;
<a name="l01687"></a>01687    <span class="keywordtype">char</span> *dup = <a class="code" href="cli_8c.html#e01ab49bede0d1e1f151dc1380d1038a">parse_args</a>(<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>, &amp;x, args + 1, <a class="code" href="cli_8h.html#351f2529f74a2d8ce79f28f3fd5b3279">AST_MAX_ARGS</a>, NULL);
<a name="l01688"></a>01688 
<a name="l01689"></a>01689    <span class="keywordflow">if</span> (dup == NULL)
<a name="l01690"></a>01690       <span class="keywordflow">return</span> -1;
<a name="l01691"></a>01691 
<a name="l01692"></a>01692    <span class="keywordflow">if</span> (x &lt; 1)  <span class="comment">/* We need at least one entry, otherwise ignore */</span>
<a name="l01693"></a>01693       <span class="keywordflow">goto</span> done;
<a name="l01694"></a>01694 
<a name="l01695"></a>01695    <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;helpers);
<a name="l01696"></a>01696    e = <a class="code" href="cli_8c.html#9d007afcc7a56b4dfc5347284219a0e7">find_cli</a>(args + 1, 0);
<a name="l01697"></a>01697    <span class="keywordflow">if</span> (e)
<a name="l01698"></a>01698       ast_atomic_fetchadd_int(&amp;e-&gt;<a class="code" href="structast__cli__entry.html#9ac84af00bd68fa1e4441a101c6b6305">inuse</a>, 1);
<a name="l01699"></a>01699    <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;helpers);
<a name="l01700"></a>01700    <span class="keywordflow">if</span> (e == NULL) {
<a name="l01701"></a>01701       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"No such command '%s' (type 'help' for help)\n"</span>, <a class="code" href="cli_8c.html#5be9502d1aa1a3046aef9e97e61a1611">find_best</a>(args + 1));
<a name="l01702"></a>01702       <span class="keywordflow">goto</span> done;
<a name="l01703"></a>01703    }
<a name="l01704"></a>01704    <span class="comment">/*</span>
<a name="l01705"></a>01705 <span class="comment">    * Within the handler, argv[-1] contains a pointer to the ast_cli_entry.</span>
<a name="l01706"></a>01706 <span class="comment">    * Remember that the array returned by parse_args is NULL-terminated.</span>
<a name="l01707"></a>01707 <span class="comment">    */</span>
<a name="l01708"></a>01708    args[0] = (<span class="keywordtype">char</span> *)e;
<a name="l01709"></a>01709 
<a name="l01710"></a>01710    <span class="keywordflow">if</span> (!e-&gt;<a class="code" href="structast__cli__entry.html#944e010ea45a0ca00cbedfed82c436f4">new_handler</a>) <span class="comment">/* old style */</span>
<a name="l01711"></a>01711       res = e-&gt;<a class="code" href="structast__cli__entry.html#c1cbfe271a40788a00e8bf8574d94d4b">handler</a>(fd, x, args + 1);
<a name="l01712"></a>01712    <span class="keywordflow">else</span> {
<a name="l01713"></a>01713       <span class="keyword">struct </span><a class="code" href="structast__cli__args.html">ast_cli_args</a> a = {
<a name="l01714"></a>01714          .<a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a> = <a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a>, .argc = x, .argv = args+1 };
<a name="l01715"></a>01715       <span class="keywordtype">char</span> *retval = e-&gt;<a class="code" href="structast__cli__entry.html#944e010ea45a0ca00cbedfed82c436f4">new_handler</a>(e, <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d380457cd644023f5d9c2553c0248aeb1">CLI_HANDLER</a>, &amp;a);
<a name="l01716"></a>01716 
<a name="l01717"></a>01717       <span class="keywordflow">if</span> (retval == <a class="code" href="cli_8h.html#1feba2188d0c8b5f3bffccacea035b67">CLI_SUCCESS</a>)
<a name="l01718"></a>01718          res = <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l01719"></a>01719       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (retval == <a class="code" href="cli_8h.html#8409e2cc535711ab81e051428521a8c6">CLI_SHOWUSAGE</a>)
<a name="l01720"></a>01720          res = <a class="code" href="cli_8h.html#d7f3bcd35c16172e6fc0964a175fcadb">RESULT_SHOWUSAGE</a>;
<a name="l01721"></a>01721       <span class="keywordflow">else</span>
<a name="l01722"></a>01722          res = <a class="code" href="cli_8h.html#029ade91f74f40adbbae98503f72e91b">RESULT_FAILURE</a>;
<a name="l01723"></a>01723    }
<a name="l01724"></a>01724    <span class="keywordflow">switch</span> (res) {
<a name="l01725"></a>01725    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#d7f3bcd35c16172e6fc0964a175fcadb">RESULT_SHOWUSAGE</a>:
<a name="l01726"></a>01726       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(<a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a>, <span class="stringliteral">"%s"</span>, <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(e-&gt;<a class="code" href="structast__cli__entry.html#9366282e11c151558bdfaab4a264aa1b">usage</a>, <span class="stringliteral">"Invalid usage, but no usage information available.\n"</span>));
<a name="l01727"></a>01727       <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;helpers);
<a name="l01728"></a>01728       <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__cli__entry.html#54dac5afe1fcac2f65c059fc97b44a58">deprecated</a>)
<a name="l01729"></a>01729          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"The '%s' command is deprecated and will be removed in a future release. Please use '%s' instead.\n"</span>, e-&gt;<a class="code" href="structast__cli__entry.html#93e8a3d20be0d24b9aa32e9934e9f7b7">_full_cmd</a>, e-&gt;<a class="code" href="structast__cli__entry.html#5d12d2d33b65908e76165cc0da40bdfe">_deprecated_by</a>);
<a name="l01730"></a>01730       <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;helpers);
<a name="l01731"></a>01731       <span class="keywordflow">break</span>;
<a name="l01732"></a>01732    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#029ade91f74f40adbbae98503f72e91b">RESULT_FAILURE</a>:
<a name="l01733"></a>01733       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"Command '%s' failed.\n"</span>, <a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>);
<a name="l01734"></a>01734       <span class="comment">/* FALLTHROUGH */</span>
<a name="l01735"></a>01735    <span class="keywordflow">default</span>:
<a name="l01736"></a>01736       <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;helpers);
<a name="l01737"></a>01737       <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__cli__entry.html#54dac5afe1fcac2f65c059fc97b44a58">deprecated</a> == 1) {
<a name="l01738"></a>01738          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"The '%s' command is deprecated and will be removed in a future release. Please use '%s' instead.\n"</span>, e-&gt;<a class="code" href="structast__cli__entry.html#93e8a3d20be0d24b9aa32e9934e9f7b7">_full_cmd</a>, e-&gt;<a class="code" href="structast__cli__entry.html#5d12d2d33b65908e76165cc0da40bdfe">_deprecated_by</a>);
<a name="l01739"></a>01739          e-&gt;<a class="code" href="structast__cli__entry.html#54dac5afe1fcac2f65c059fc97b44a58">deprecated</a> = 2;
<a name="l01740"></a>01740       }
<a name="l01741"></a>01741       <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;helpers);
<a name="l01742"></a>01742       <span class="keywordflow">break</span>;
<a name="l01743"></a>01743    }
<a name="l01744"></a>01744    ast_atomic_fetchadd_int(&amp;e-&gt;<a class="code" href="structast__cli__entry.html#9ac84af00bd68fa1e4441a101c6b6305">inuse</a>, -1);
<a name="l01745"></a>01745 done:
<a name="l01746"></a>01746    <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(dup);
<a name="l01747"></a>01747    <span class="keywordflow">return</span> 0;
<a name="l01748"></a>01748 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ff4b12b0f87714d5e22fdc54065104ac"></a><!-- doxytag: member="cli.c::ast_cli_complete" ref="ff4b12b0f87714d5e22fdc54065104ac" args="(const char *word, char *const choices[], int state)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char* ast_cli_complete           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>word</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *const &nbsp;</td>
          <td class="mdname" nowrap> <em>choices</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pos</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Helper function to generate cli entries from a NULL-terminated array. Returns the n-th matching entry from the array, or NULL if not found. Can be used to implement generate() for static entries as below (in this example we complete the word in position 2): <div class="fragment"><pre class="fragment">    <span class="keywordtype">char</span> *my_generate(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="manager_8h.html#6438c669e0d0de98e6929c2cc0fac474">line</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structast__cli__args.html#c47d187067c6cf953245f128b5fde62a">word</a>, <span class="keywordtype">int</span> <a class="code" href="structast__cli__args.html#5e0bdcbddccca4d66d74ba8c1cee1a68">pos</a>, <span class="keywordtype">int</span> <a class="code" href="structast__cli__args.html#7b8b965ad4bca0e41ab51de7b31363a1">n</a>)
    {
        <span class="keyword">static</span> <span class="keywordtype">char</span> *choices = { <span class="stringliteral">"one"</span>, <span class="stringliteral">"two"</span>, <span class="stringliteral">"three"</span>, NULL };
   <span class="keywordflow">if</span> (pos == 2)
         <span class="keywordflow">return</span> <a class="code" href="cli_8c.html#ff4b12b0f87714d5e22fdc54065104ac">ast_cli_complete</a>(word, choices, n);
   <span class="keywordflow">else</span>
      <span class="keywordflow">return</span> NULL;
    }
</pre></div> 
<p>
Definition at line <a class="el" href="cli_8c-source.html#l00861">861</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, and <a class="el" href="utils_8h-source.html#l00386">len</a>.
<p>
Referenced by <a class="el" href="app__meetme_8c-source.html#l00954">complete_meetmecmd()</a>, <a class="el" href="res__clioriginate_8c-source.html#l00147">complete_orig()</a>, and <a class="el" href="pbx_8c-source.html#l03265">complete_show_applications()</a>.<div class="fragment"><pre class="fragment"><a name="l00862"></a>00862 {
<a name="l00863"></a>00863    <span class="keywordtype">int</span> i, which = 0, <a class="code" href="utils_8h.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a>;
<a name="l00864"></a>00864    <a class="code" href="utils_8h.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a> = <a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(<a class="code" href="structast__cli__args.html#c47d187067c6cf953245f128b5fde62a">word</a>) ? 0 : strlen(<a class="code" href="structast__cli__args.html#c47d187067c6cf953245f128b5fde62a">word</a>);
<a name="l00865"></a>00865 
<a name="l00866"></a>00866    <span class="keywordflow">for</span> (i = 0; choices[i]; i++) {
<a name="l00867"></a>00867       <span class="keywordflow">if</span> ((!<a class="code" href="utils_8h.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a> || !strncasecmp(<a class="code" href="structast__cli__args.html#c47d187067c6cf953245f128b5fde62a">word</a>, choices[i], <a class="code" href="utils_8h.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a>)) &amp;&amp; ++which &gt; <a class="code" href="structstate.html">state</a>)
<a name="l00868"></a>00868          <span class="keywordflow">return</span> <a class="code" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>(choices[i]);
<a name="l00869"></a>00869    }
<a name="l00870"></a>00870    <span class="keywordflow">return</span> NULL;
<a name="l00871"></a>00871 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2fa472a45042f3ae905a4fbba5677b68"></a><!-- doxytag: member="cli.c::ast_cli_completion_matches" ref="2fa472a45042f3ae905a4fbba5677b68" args="(const char *text, const char *word)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char** ast_cli_completion_matches           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Generates a NULL-terminated array of strings that 1) begin with the string in the second parameter, and 2) are valid in a command after the string in the first parameter. 
<p>
The first entry (offset 0) of the result is the longest common substring in the results, useful to extend the string that has been completed. Subsequent entries are all possible values, followe by a NULL. All strings and the array itself are malloc'ed and must be freed by the caller. 
<p>
Definition at line <a class="el" href="cli_8c-source.html#l01534">1534</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l01676">ast_cli_generator()</a>, <a class="el" href="utils_8h-source.html#l00359">ast_malloc</a>, and <a class="el" href="utils_8h.html#009723420c269c3a1ecb1953558e608d">ast_realloc</a>.
<p>
Referenced by <a class="el" href="asterisk_8c-source.html#l02054">cli_complete()</a>, and <a class="el" href="cli_8c-source.html#l00605">handle_commandmatchesarray()</a>.<div class="fragment"><pre class="fragment"><a name="l01535"></a>01535 {
<a name="l01536"></a>01536    <span class="keywordtype">char</span> **match_list = NULL, *retstr, *prevstr;
<a name="l01537"></a>01537    size_t match_list_len, max_equal, which, i;
<a name="l01538"></a>01538    <span class="keywordtype">int</span> matches = 0;
<a name="l01539"></a>01539 
<a name="l01540"></a>01540    <span class="comment">/* leave entry 0 free for the longest common substring */</span>
<a name="l01541"></a>01541    match_list_len = 1;
<a name="l01542"></a>01542    <span class="keywordflow">while</span> ((retstr = <a class="code" href="cli_8c.html#c7625505d16ef1ca9bd8837f537dfb03">ast_cli_generator</a>(<a class="code" href="app__queue_8c.html#1cb251ec0d568de6a929b520c4aed8d1">text</a>, <a class="code" href="structast__cli__args.html#c47d187067c6cf953245f128b5fde62a">word</a>, matches)) != NULL) {
<a name="l01543"></a>01543       <span class="keywordflow">if</span> (matches + 1 &gt;= match_list_len) {
<a name="l01544"></a>01544          match_list_len &lt;&lt;= 1;
<a name="l01545"></a>01545          <span class="keywordflow">if</span> (!(match_list = <a class="code" href="utils_8h.html#009723420c269c3a1ecb1953558e608d">ast_realloc</a>(match_list, match_list_len * <span class="keyword">sizeof</span>(*match_list))))
<a name="l01546"></a>01546             <span class="keywordflow">return</span> NULL;
<a name="l01547"></a>01547       }
<a name="l01548"></a>01548       match_list[++matches] = retstr;
<a name="l01549"></a>01549    }
<a name="l01550"></a>01550 
<a name="l01551"></a>01551    <span class="keywordflow">if</span> (!match_list)
<a name="l01552"></a>01552       <span class="keywordflow">return</span> match_list; <span class="comment">/* NULL */</span>
<a name="l01553"></a>01553 
<a name="l01554"></a>01554    <span class="comment">/* Find the longest substring that is common to all results</span>
<a name="l01555"></a>01555 <span class="comment">    * (it is a candidate for completion), and store a copy in entry 0.</span>
<a name="l01556"></a>01556 <span class="comment">    */</span>
<a name="l01557"></a>01557    prevstr = match_list[1];
<a name="l01558"></a>01558    max_equal = strlen(prevstr);
<a name="l01559"></a>01559    <span class="keywordflow">for</span> (which = 2; which &lt;= matches; which++) {
<a name="l01560"></a>01560       <span class="keywordflow">for</span> (i = 0; i &lt; max_equal &amp;&amp; toupper(prevstr[i]) == toupper(match_list[which][i]); i++)
<a name="l01561"></a>01561          <span class="keywordflow">continue</span>;
<a name="l01562"></a>01562       max_equal = i;
<a name="l01563"></a>01563    }
<a name="l01564"></a>01564 
<a name="l01565"></a>01565    <span class="keywordflow">if</span> (!(retstr = <a class="code" href="utils_8h.html#efc2f2f953e736b509e4a2cee96151db">ast_malloc</a>(max_equal + 1)))
<a name="l01566"></a>01566       <span class="keywordflow">return</span> NULL;
<a name="l01567"></a>01567    
<a name="l01568"></a>01568    ast_copy_string(retstr, match_list[1], max_equal + 1);
<a name="l01569"></a>01569    match_list[0] = retstr;
<a name="l01570"></a>01570 
<a name="l01571"></a>01571    <span class="comment">/* ensure that the array is NULL terminated */</span>
<a name="l01572"></a>01572    <span class="keywordflow">if</span> (matches + 1 &gt;= match_list_len) {
<a name="l01573"></a>01573       <span class="keywordflow">if</span> (!(match_list = <a class="code" href="utils_8h.html#009723420c269c3a1ecb1953558e608d">ast_realloc</a>(match_list, (match_list_len + 1) * <span class="keyword">sizeof</span>(*match_list))))
<a name="l01574"></a>01574          <span class="keywordflow">return</span> NULL;
<a name="l01575"></a>01575    }
<a name="l01576"></a>01576    match_list[matches + 1] = NULL;
<a name="l01577"></a>01577 
<a name="l01578"></a>01578    <span class="keywordflow">return</span> match_list;
<a name="l01579"></a>01579 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c7625505d16ef1ca9bd8837f537dfb03"></a><!-- doxytag: member="cli.c::ast_cli_generator" ref="c7625505d16ef1ca9bd8837f537dfb03" args="(const char *text, const char *word, int state)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char* ast_cli_generator           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>text</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>word</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>state</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Readline madness Useful for readline, that's about it Returns 0 on success, -1 on failure. 
<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l01676">1676</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l01595">__ast_cli_generator()</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l01534">ast_cli_completion_matches()</a>, and <a class="el" href="cli_8c-source.html#l01517">ast_cli_generatornummatches()</a>.<div class="fragment"><pre class="fragment"><a name="l01677"></a>01677 {
<a name="l01678"></a>01678    <span class="keywordflow">return</span> <a class="code" href="cli_8c.html#4c6099872e6a10522abb6afa7512ab3c">__ast_cli_generator</a>(<a class="code" href="app__queue_8c.html#1cb251ec0d568de6a929b520c4aed8d1">text</a>, <a class="code" href="structast__cli__args.html#c47d187067c6cf953245f128b5fde62a">word</a>, <a class="code" href="structstate.html">state</a>, 1);
<a name="l01679"></a>01679 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4c0a7fc47581d0fbc8ade249a4a021c9"></a><!-- doxytag: member="cli.c::ast_cli_generatornummatches" ref="4c0a7fc47581d0fbc8ade249a4a021c9" args="(const char *text, const char *word)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cli_generatornummatches           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>text</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>word</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return the number of unique matches for the generator. 
<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l01517">1517</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l01676">ast_cli_generator()</a>, <a class="el" href="adsistub_8c-source.html#l00065">buf</a>, and <a class="el" href="astmm_8h-source.html#l00069">free</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l00648">handle_commandnummatches()</a>.<div class="fragment"><pre class="fragment"><a name="l01518"></a>01518 {
<a name="l01519"></a>01519    <span class="keywordtype">int</span> matches = 0, i = 0;
<a name="l01520"></a>01520    <span class="keywordtype">char</span> *<a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a> = NULL, *oldbuf = NULL;
<a name="l01521"></a>01521 
<a name="l01522"></a>01522    <span class="keywordflow">while</span> ((buf = <a class="code" href="cli_8c.html#c7625505d16ef1ca9bd8837f537dfb03">ast_cli_generator</a>(<a class="code" href="app__queue_8c.html#1cb251ec0d568de6a929b520c4aed8d1">text</a>, <a class="code" href="structast__cli__args.html#c47d187067c6cf953245f128b5fde62a">word</a>, i++))) {
<a name="l01523"></a>01523       <span class="keywordflow">if</span> (!oldbuf || strcmp(buf,oldbuf))
<a name="l01524"></a>01524          matches++;
<a name="l01525"></a>01525       <span class="keywordflow">if</span> (oldbuf)
<a name="l01526"></a>01526          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(oldbuf);
<a name="l01527"></a>01527       oldbuf = buf;
<a name="l01528"></a>01528    }
<a name="l01529"></a>01529    <span class="keywordflow">if</span> (oldbuf)
<a name="l01530"></a>01530       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(oldbuf);
<a name="l01531"></a>01531    <span class="keywordflow">return</span> matches;
<a name="l01532"></a>01532 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="63b8a59f72a7d4f5f3cdef8190057349"></a><!-- doxytag: member="cli.c::ast_cli_register" ref="63b8a59f72a7d4f5f3cdef8190057349" args="(struct ast_cli_entry *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cli_register           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Registers a command or an array of commands. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>e</em>&nbsp;</td><td>which cli entry to register Register your own command Returns 0 on success, -1 on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l01344">1344</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l01261">__ast_cli_register()</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l01341">ast_cdr_engine_init()</a>, <a class="el" href="cli_8c-source.html#l01352">ast_cli_register_multiple()</a>, <a class="el" href="dnsmgr_8c-source.html#l00336">dnsmgr_init()</a>, <a class="el" href="cdr_8c-source.html#l01229">do_reload()</a>, and <a class="el" href="chan__h323_8c-source.html#l03189">load_module()</a>.<div class="fragment"><pre class="fragment"><a name="l01345"></a>01345 {
<a name="l01346"></a>01346    <span class="keywordflow">return</span> <a class="code" href="cli_8c.html#e4bb643cb59964a3189cf73e3018dfa9">__ast_cli_register</a>(e, NULL);
<a name="l01347"></a>01347 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a334dfd903e83eea3729ff37aa372781"></a><!-- doxytag: member="cli.c::ast_cli_register_multiple" ref="a334dfd903e83eea3729ff37aa372781" args="(struct ast_cli_entry *e, int len)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cli_register_multiple           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Register multiple commands. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>e</em>&nbsp;</td><td>pointer to first cli entry to register </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>number of entries to register </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l01352">1352</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l01344">ast_cli_register()</a>.
<p>
Referenced by <a class="el" href="translate_8c-source.html#l00574">__ast_register_translator()</a>, <a class="el" href="cli_8c-source.html#l01041">ast_builtins_init()</a>, <a class="el" href="channel_8c-source.html#l04455">ast_channels_init()</a>, <a class="el" href="file_8c-source.html#l01160">ast_file_init()</a>, <a class="el" href="http_8c-source.html#l01318">ast_http_init()</a>, <a class="el" href="image_8c-source.html#l00206">ast_image_init()</a>, <a class="el" href="rtp_8c-source.html#l03774">ast_rtp_init()</a>, <a class="el" href="udptl_8c-source.html#l01283">ast_udptl_init()</a>, <a class="el" href="db_8c-source.html#l00643">astdb_init()</a>, <a class="el" href="res__crypto_8c-source.html#l00579">crypto_init()</a>, <a class="el" href="iax2-provision_8c-source.html#l00475">iax_provision_init()</a>, <a class="el" href="frame_8c-source.html#l00930">init_framer()</a>, <a class="el" href="logger_8c-source.html#l00781">init_logger()</a>, <a class="el" href="manager_8c-source.html#l03215">init_manager()</a>, <a class="el" href="app__meetme_8c-source.html#l04847">load_module()</a>, <a class="el" href="pbx_8c-source.html#l06035">load_pbx()</a>, <a class="el" href="asterisk_8c-source.html#l02570">main()</a>, and <a class="el" href="config_8c-source.html#l01482">register_config_cli()</a>.<div class="fragment"><pre class="fragment"><a name="l01353"></a>01353 {
<a name="l01354"></a>01354    <span class="keywordtype">int</span> i, res = 0;
<a name="l01355"></a>01355 
<a name="l01356"></a>01356    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="utils_8h.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a>; i++)
<a name="l01357"></a>01357       res |= <a class="code" href="cli_8c.html#63b8a59f72a7d4f5f3cdef8190057349">ast_cli_register</a>(e + i);
<a name="l01358"></a>01358 
<a name="l01359"></a>01359    <span class="keywordflow">return</span> res;
<a name="l01360"></a>01360 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b895af7894fd3ae1f535f8e84811b2ea"></a><!-- doxytag: member="cli.c::ast_cli_unregister" ref="b895af7894fd3ae1f535f8e84811b2ea" args="(struct ast_cli_entry *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cli_unregister           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unregisters a command or an array of commands. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>e</em>&nbsp;</td><td>which cli entry to unregister Unregister your own command. You must pass a completed <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> structure Returns 0. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l01338">1338</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l01237">__ast_cli_unregister()</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l01362">ast_cli_unregister_multiple()</a>, <a class="el" href="cdr_8c-source.html#l01229">do_reload()</a>, <a class="el" href="chan__h323_8c-source.html#l03189">load_module()</a>, and <a class="el" href="chan__h323_8c-source.html#l03292">unload_module()</a>.<div class="fragment"><pre class="fragment"><a name="l01339"></a>01339 {
<a name="l01340"></a>01340    <span class="keywordflow">return</span> <a class="code" href="cli_8c.html#de4510810e9e4bf8ce8168b412617e37">__ast_cli_unregister</a>(e, NULL);
<a name="l01341"></a>01341 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="321c001e02fcba48873965ff141ff29b"></a><!-- doxytag: member="cli.c::ast_cli_unregister_multiple" ref="321c001e02fcba48873965ff141ff29b" args="(struct ast_cli_entry *e, int len)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cli_unregister_multiple           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unregister multiple commands. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>e</em>&nbsp;</td><td>pointer to first cli entry to unregister </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>number of entries to unregister </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l01362">1362</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l01338">ast_cli_unregister()</a>.
<p>
Referenced by <a class="el" href="chan__iax2_8c-source.html#l10340">__unload_module()</a>, <a class="el" href="iax2-provision_8c-source.html#l00482">iax_provision_unload()</a>, <a class="el" href="chan__h323_8c-source.html#l03189">load_module()</a>, and <a class="el" href="app__meetme_8c-source.html#l04823">unload_module()</a>.<div class="fragment"><pre class="fragment"><a name="l01363"></a>01363 {
<a name="l01364"></a>01364    <span class="keywordtype">int</span> i, res = 0;
<a name="l01365"></a>01365 
<a name="l01366"></a>01366    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="utils_8h.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a>; i++)
<a name="l01367"></a>01367       res |= <a class="code" href="cli_8c.html#b895af7894fd3ae1f535f8e84811b2ea">ast_cli_unregister</a>(e + i);
<a name="l01368"></a>01368 
<a name="l01369"></a>01369    <span class="keywordflow">return</span> res;
<a name="l01370"></a>01370 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="5230ec2c08f6ec3f2c5b34af707e6743"></a><!-- doxytag: member="cli.c::ast_complete_channels" ref="5230ec2c08f6ec3f2c5b34af707e6743" args="(const char *line, const char *word, int pos, int state, int rpos)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char* ast_complete_channels           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>line</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>word</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pos</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>state</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>rpos</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Command completion for the list of active channels. 
<p>
This can be called from a CLI command completion function that wants to complete from the list of active channels. 'rpos' is the required position in the command. This function will return NULL immediately if 'rpos' is not the same as the current position, 'pos'. 
<p>
Definition at line <a class="el" href="cli_8c-source.html#l00873">873</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="channel_8c-source.html#l00989">ast_channel_walk_locked()</a>, and <a class="el" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l00894">complete_ch_3()</a>, <a class="el" href="cli_8c-source.html#l00899">complete_ch_4()</a>, <a class="el" href="app__mixmonitor_8c-source.html#l00421">complete_mixmonitor_cli()</a>, and <a class="el" href="cli_8c-source.html#l00677">handle_core_set_debug_channel()</a>.<div class="fragment"><pre class="fragment"><a name="l00874"></a>00874 {
<a name="l00875"></a>00875    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *c = NULL;
<a name="l00876"></a>00876    <span class="keywordtype">int</span> which = 0;
<a name="l00877"></a>00877    <span class="keywordtype">int</span> wordlen;
<a name="l00878"></a>00878    <span class="keywordtype">char</span> notfound = <span class="charliteral">'\0'</span>;
<a name="l00879"></a>00879    <span class="keywordtype">char</span> *ret = &amp;notfound; <span class="comment">/* so NULL can break the loop */</span>
<a name="l00880"></a>00880 
<a name="l00881"></a>00881    <span class="keywordflow">if</span> (pos != rpos)
<a name="l00882"></a>00882       <span class="keywordflow">return</span> NULL;
<a name="l00883"></a>00883 
<a name="l00884"></a>00884    wordlen = strlen(word); 
<a name="l00885"></a>00885 
<a name="l00886"></a>00886    <span class="keywordflow">while</span> (ret == &amp;notfound &amp;&amp; (c = <a class="code" href="channel_8c.html#8ada12445e0d71c8bcd465f6838bf4e5">ast_channel_walk_locked</a>(c))) {
<a name="l00887"></a>00887       <span class="keywordflow">if</span> (!strncasecmp(word, c-&gt;name, wordlen) &amp;&amp; ++which &gt; <a class="code" href="structstate.html">state</a>)
<a name="l00888"></a>00888          ret = <a class="code" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>(c-&gt;name);
<a name="l00889"></a>00889       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(c);
<a name="l00890"></a>00890    }
<a name="l00891"></a>00891    <span class="keywordflow">return</span> ret == &amp;notfound ? NULL : ret;
<a name="l00892"></a>00892 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1064725b406359ec508e5d90aae9f192"></a><!-- doxytag: member="cli.c::AST_LIST_HEAD_STATIC" ref="1064725b406359ec508e5d90aae9f192" args="(helpers, ast_cli_entry)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static AST_LIST_HEAD_STATIC           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">helpers&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structast__cli__entry.html">ast_cli_entry</a>&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="fa4c13809b857ee94e6a0c5404e23deb"></a><!-- doxytag: member="cli.c::AST_MUTEX_DEFINE_STATIC" ref="fa4c13809b857ee94e6a0c5404e23deb" args="(climodentrylock)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">AST_MUTEX_DEFINE_STATIC           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">climodentrylock&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d8152a07f15c77af14fe2fb4f7baf7e1"></a><!-- doxytag: member="cli.c::AST_THREADSTORAGE" ref="d8152a07f15c77af14fe2fb4f7baf7e1" args="(ast_cli_buf)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">AST_THREADSTORAGE           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ast_cli_buf&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="e1ad08e15725db1ff280b812a583b4a2"></a><!-- doxytag: member="cli.c::cli_next" ref="e1ad08e15725db1ff280b812a583b4a2" args="(struct cli_iterator *i)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a>* cli_next           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structcli__iterator.html">cli_iterator</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>i</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l01065">1065</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8h-source.html#l00183">ast_cli_entry::_full_cmd</a>, <a class="el" href="linkedlists_8h-source.html#l00385">AST_LIST_FIRST</a>, <a class="el" href="linkedlists_8h-source.html#l00403">AST_LIST_NEXT</a>, <a class="el" href="cli_8c-source.html#l01061">cli_iterator::builtins</a>, <a class="el" href="cli_8h-source.html#l00154">ast_cli_entry::cmda</a>, and <a class="el" href="cli_8c-source.html#l01062">cli_iterator::helpers</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l01595">__ast_cli_generator()</a>, <a class="el" href="cli_8c-source.html#l01174">find_cli()</a>, and <a class="el" href="cli_8c-source.html#l01378">help1()</a>.<div class="fragment"><pre class="fragment"><a name="l01066"></a>01066 {
<a name="l01067"></a>01067    <span class="keyword">struct </span><a class="code" href="structast__cli__entry.html">ast_cli_entry</a> *e;
<a name="l01068"></a>01068 
<a name="l01069"></a>01069    <span class="keywordflow">if</span> (i-&gt;<a class="code" href="structcli__iterator.html#a69ecad8d4c393f07611b4a373a17690">builtins</a> == NULL &amp;&amp; i-&gt;<a class="code" href="structcli__iterator.html#c2c3081275569a523f7b887c77722c5b">helpers</a> == NULL) {
<a name="l01070"></a>01070       <span class="comment">/* initialize */</span>
<a name="l01071"></a>01071       i-&gt;<a class="code" href="structcli__iterator.html#a69ecad8d4c393f07611b4a373a17690">builtins</a> = <a class="code" href="cli_8c.html#7b94c2c41ed9fd600b9a19bb54467397">builtins</a>;
<a name="l01072"></a>01072       i-&gt;<a class="code" href="structcli__iterator.html#c2c3081275569a523f7b887c77722c5b">helpers</a> = <a class="code" href="linkedlists_8h.html#e4deb7f32ef480cbc3b2e9b7e4ceff6c">AST_LIST_FIRST</a>(&amp;helpers);
<a name="l01073"></a>01073    }
<a name="l01074"></a>01074    e = i-&gt;<a class="code" href="structcli__iterator.html#a69ecad8d4c393f07611b4a373a17690">builtins</a>; <span class="comment">/* temporary */</span>
<a name="l01075"></a>01075    <span class="keywordflow">if</span> (!e-&gt;<a class="code" href="structast__cli__entry.html#ec27655330419638d73b5c69b3f1168e">cmda</a>[0] || (i-&gt;<a class="code" href="structcli__iterator.html#c2c3081275569a523f7b887c77722c5b">helpers</a> &amp;&amp;
<a name="l01076"></a>01076           strcmp(i-&gt;<a class="code" href="structcli__iterator.html#c2c3081275569a523f7b887c77722c5b">helpers</a>-&gt;<a class="code" href="structast__cli__entry.html#93e8a3d20be0d24b9aa32e9934e9f7b7">_full_cmd</a>, e-&gt;<a class="code" href="structast__cli__entry.html#93e8a3d20be0d24b9aa32e9934e9f7b7">_full_cmd</a>) &lt; 0)) {
<a name="l01077"></a>01077       <span class="comment">/* Use helpers */</span>
<a name="l01078"></a>01078       e = i-&gt;<a class="code" href="structcli__iterator.html#c2c3081275569a523f7b887c77722c5b">helpers</a>;
<a name="l01079"></a>01079       <span class="keywordflow">if</span> (e)
<a name="l01080"></a>01080          i-&gt;<a class="code" href="structcli__iterator.html#c2c3081275569a523f7b887c77722c5b">helpers</a> = <a class="code" href="linkedlists_8h.html#ab7d30c78fda9982ddc59f746adf8a69">AST_LIST_NEXT</a>(e, list);
<a name="l01081"></a>01081    } <span class="keywordflow">else</span> { <span class="comment">/* use builtin. e is already set  */</span>
<a name="l01082"></a>01082       (i-&gt;<a class="code" href="structcli__iterator.html#a69ecad8d4c393f07611b4a373a17690">builtins</a>)++;  <span class="comment">/* move to next */</span>
<a name="l01083"></a>01083    }
<a name="l01084"></a>01084    <span class="keywordflow">return</span> e;
<a name="l01085"></a>01085 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="5147e4d3b9a175552d6c9501e3af2695"></a><!-- doxytag: member="cli.c::complete_ch_3" ref="5147e4d3b9a175552d6c9501e3af2695" args="(const char *line, const char *word, int pos, int state)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* complete_ch_3           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>line</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>word</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pos</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>state</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00894">894</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l00873">ast_complete_channels()</a>.<div class="fragment"><pre class="fragment"><a name="l00895"></a>00895 {
<a name="l00896"></a>00896    <span class="keywordflow">return</span> <a class="code" href="cli_8c.html#5230ec2c08f6ec3f2c5b34af707e6743">ast_complete_channels</a>(<a class="code" href="manager_8h.html#6438c669e0d0de98e6929c2cc0fac474">line</a>, word, pos, <a class="code" href="structstate.html">state</a>, 2);
<a name="l00897"></a>00897 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="404b357a0aeee57c0d883de95de7f786"></a><!-- doxytag: member="cli.c::complete_ch_4" ref="404b357a0aeee57c0d883de95de7f786" args="(const char *line, const char *word, int pos, int state)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* complete_ch_4           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>line</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>word</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pos</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>state</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00899">899</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l00873">ast_complete_channels()</a>.<div class="fragment"><pre class="fragment"><a name="l00900"></a>00900 {
<a name="l00901"></a>00901    <span class="keywordflow">return</span> <a class="code" href="cli_8c.html#5230ec2c08f6ec3f2c5b34af707e6743">ast_complete_channels</a>(<a class="code" href="manager_8h.html#6438c669e0d0de98e6929c2cc0fac474">line</a>, word, pos, <a class="code" href="structstate.html">state</a>, 3);
<a name="l00902"></a>00902 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ba0491f78f8468eb18f46c4a799627e0"></a><!-- doxytag: member="cli.c::complete_fn" ref="ba0491f78f8468eb18f46c4a799627e0" args="(const char *word, int state)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* complete_fn           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>word</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>state</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00092">92</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="asterisk_8c-source.html#l00212">ast_config_AST_MODULE_DIR</a>, and <a class="el" href="astmm_8h-source.html#l00075">strdup</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l00111">handle_load()</a>.<div class="fragment"><pre class="fragment"><a name="l00093"></a>00093 {
<a name="l00094"></a>00094    <span class="keywordtype">char</span> *c;
<a name="l00095"></a>00095    <span class="keywordtype">char</span> filename[256];
<a name="l00096"></a>00096 
<a name="l00097"></a>00097    <span class="keywordflow">if</span> (word[0] == <span class="charliteral">'/'</span>)
<a name="l00098"></a>00098       ast_copy_string(filename, word, <span class="keyword">sizeof</span>(filename));
<a name="l00099"></a>00099    <span class="keywordflow">else</span>
<a name="l00100"></a>00100       snprintf(filename, <span class="keyword">sizeof</span>(filename), <span class="stringliteral">"%s/%s"</span>, <a class="code" href="asterisk_8c.html#0c9ed5029117c0cc03a5acb9e5ff967f">ast_config_AST_MODULE_DIR</a>, word);
<a name="l00101"></a>00101 
<a name="l00102"></a>00102    <span class="comment">/* XXX the following function is not reentrant, so we better not use it */</span>
<a name="l00103"></a>00103    c = filename_completion_function(filename, <a class="code" href="structstate.html">state</a>);
<a name="l00104"></a>00104    
<a name="l00105"></a>00105    <span class="keywordflow">if</span> (c &amp;&amp; word[0] != <span class="charliteral">'/'</span>)
<a name="l00106"></a>00106       c += (strlen(<a class="code" href="asterisk_8c.html#0c9ed5029117c0cc03a5acb9e5ff967f">ast_config_AST_MODULE_DIR</a>) + 1);
<a name="l00107"></a>00107    
<a name="l00108"></a>00108    <span class="keywordflow">return</span> c ? <a class="code" href="astmm_8h.html#17881997a89ddffd239268f0476567d0">strdup</a>(c) : c;
<a name="l00109"></a>00109 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="5be9502d1aa1a3046aef9e97e61a1611"></a><!-- doxytag: member="cli.c::find_best" ref="5be9502d1aa1a3046aef9e97e61a1611" args="(char *argv[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* find_best           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>argv</em>[]          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l01218">1218</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="utils_8c-source.html#l00849">ast_join()</a>, <a class="el" href="linkedlists_8h-source.html#l00038">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00104">AST_LIST_UNLOCK</a>, <a class="el" href="cli_8h-source.html#l00045">AST_MAX_CMD_LEN</a>, <a class="el" href="cli_8c-source.html#l01174">find_cli()</a>, and <a class="el" href="cli_8c-source.html#l01062">cli_iterator::helpers</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l01681">ast_cli_command()</a>, <a class="el" href="app__queue_8c-source.html#l01797">ring_one()</a>, and <a class="el" href="app__queue_8c-source.html#l01831">store_next()</a>.<div class="fragment"><pre class="fragment"><a name="l01219"></a>01219 {
<a name="l01220"></a>01220    <span class="keyword">static</span> <span class="keywordtype">char</span> cmdline[80];
<a name="l01221"></a>01221    <span class="keywordtype">int</span> x;
<a name="l01222"></a>01222    <span class="comment">/* See how close we get, then print the candidate */</span>
<a name="l01223"></a>01223    <span class="keywordtype">char</span> *myargv[<a class="code" href="cli_8h.html#186773f13453a244aefe55221e197cf0">AST_MAX_CMD_LEN</a>];
<a name="l01224"></a>01224    <span class="keywordflow">for</span> (x=0;x&lt;<a class="code" href="cli_8h.html#186773f13453a244aefe55221e197cf0">AST_MAX_CMD_LEN</a>;x++)
<a name="l01225"></a>01225       myargv[x]=NULL;
<a name="l01226"></a>01226    <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;helpers);
<a name="l01227"></a>01227    <span class="keywordflow">for</span> (x=0;argv[x];x++) {
<a name="l01228"></a>01228       myargv[x] = argv[x];
<a name="l01229"></a>01229       <span class="keywordflow">if</span> (!<a class="code" href="cli_8c.html#9d007afcc7a56b4dfc5347284219a0e7">find_cli</a>(myargv, -1))
<a name="l01230"></a>01230          <span class="keywordflow">break</span>;
<a name="l01231"></a>01231    }
<a name="l01232"></a>01232    <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;helpers);
<a name="l01233"></a>01233    <a class="code" href="utils_8c.html#33e7834c0d3de361f490e1c744011610">ast_join</a>(cmdline, <span class="keyword">sizeof</span>(cmdline), myargv);
<a name="l01234"></a>01234    <span class="keywordflow">return</span> cmdline;
<a name="l01235"></a>01235 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="9d007afcc7a56b4dfc5347284219a0e7"></a><!-- doxytag: member="cli.c::find_cli" ref="9d007afcc7a56b4dfc5347284219a0e7" args="(char *const cmds[], int match_type)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a>* find_cli           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *const &nbsp;</td>
          <td class="mdname" nowrap> <em>cmds</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>match_type</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
locate a cli command in the 'helpers' list (which must be locked). exact has 3 values: 0 returns if the search key is equal or longer than the entry. note that trailing optional arguments are skipped. -1 true if the mismatch is on the last word XXX not true! 1 true only on complete, exact match. 
<p>
The search compares word by word taking care of regexps in e-&gt;cmda 
<p>
Definition at line <a class="el" href="cli_8c-source.html#l01174">1174</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="cli_8c-source.html#l01065">cli_next()</a>, and <a class="el" href="cli_8c-source.html#l01098">word_match()</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l01261">__ast_cli_register()</a>, <a class="el" href="cli_8c-source.html#l01681">ast_cli_command()</a>, <a class="el" href="cli_8c-source.html#l01218">find_best()</a>, and <a class="el" href="cli_8c-source.html#l01411">handle_help()</a>.<div class="fragment"><pre class="fragment"><a name="l01175"></a>01175 {
<a name="l01176"></a>01176    <span class="keywordtype">int</span> matchlen = -1;   <span class="comment">/* length of longest match so far */</span>
<a name="l01177"></a>01177    <span class="keyword">struct </span><a class="code" href="structast__cli__entry.html">ast_cli_entry</a> *cand = NULL, *e=NULL;
<a name="l01178"></a>01178    <span class="keyword">struct </span><a class="code" href="structcli__iterator.html">cli_iterator</a> i = { NULL, NULL};
<a name="l01179"></a>01179 
<a name="l01180"></a>01180    <span class="keywordflow">while</span> ( (e = <a class="code" href="cli_8c.html#e1ad08e15725db1ff280b812a583b4a2">cli_next</a>(&amp;i)) ) {
<a name="l01181"></a>01181       <span class="comment">/* word-by word regexp comparison */</span>
<a name="l01182"></a>01182       <span class="keywordtype">char</span> * <span class="keyword">const</span> *src = cmds;
<a name="l01183"></a>01183       <span class="keywordtype">char</span> * <span class="keyword">const</span> *dst = e-&gt;cmda;
<a name="l01184"></a>01184       <span class="keywordtype">int</span> n = 0;
<a name="l01185"></a>01185       <span class="keywordflow">for</span> (;; dst++, src += n) {
<a name="l01186"></a>01186          n = <a class="code" href="cli_8c.html#7f0fe151009e2ab5ebaff4ed0c0b3594">word_match</a>(*src, *dst);
<a name="l01187"></a>01187          <span class="keywordflow">if</span> (n &lt; 0)
<a name="l01188"></a>01188             <span class="keywordflow">break</span>;
<a name="l01189"></a>01189       }
<a name="l01190"></a>01190       <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(*dst) || ((*dst)[0] == <span class="charliteral">'['</span> &amp;&amp; <a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(dst[1]))) {
<a name="l01191"></a>01191          <span class="comment">/* no more words in 'e' */</span>
<a name="l01192"></a>01192          <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(*src)) <span class="comment">/* exact match, cannot do better */</span>
<a name="l01193"></a>01193             <span class="keywordflow">break</span>;
<a name="l01194"></a>01194          <span class="comment">/* Here, cmds has more words than the entry 'e' */</span>
<a name="l01195"></a>01195          <span class="keywordflow">if</span> (match_type != 0) <span class="comment">/* but we look for almost exact match... */</span>
<a name="l01196"></a>01196             <span class="keywordflow">continue</span>;   <span class="comment">/* so we skip this one. */</span>
<a name="l01197"></a>01197          <span class="comment">/* otherwise we like it (case 0) */</span>
<a name="l01198"></a>01198       } <span class="keywordflow">else</span> { <span class="comment">/* still words in 'e' */</span>
<a name="l01199"></a>01199          <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(*src))
<a name="l01200"></a>01200             <span class="keywordflow">continue</span>; <span class="comment">/* cmds is shorter than 'e', not good */</span>
<a name="l01201"></a>01201          <span class="comment">/* Here we have leftover words in cmds and 'e',</span>
<a name="l01202"></a>01202 <span class="comment">          * but there is a mismatch. We only accept this one if match_type == -1</span>
<a name="l01203"></a>01203 <span class="comment">          * and this is the last word for both.</span>
<a name="l01204"></a>01204 <span class="comment">          */</span>
<a name="l01205"></a>01205          <span class="keywordflow">if</span> (match_type != -1 || !<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(src[1]) ||
<a name="l01206"></a>01206              !<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(dst[1])) <span class="comment">/* not the one we look for */</span>
<a name="l01207"></a>01207             <span class="keywordflow">continue</span>;
<a name="l01208"></a>01208          <span class="comment">/* good, we are in case match_type == -1 and mismatch on last word */</span>
<a name="l01209"></a>01209       }
<a name="l01210"></a>01210       <span class="keywordflow">if</span> (src - cmds &gt; matchlen) {  <span class="comment">/* remember the candidate */</span>
<a name="l01211"></a>01211          matchlen = src - cmds;
<a name="l01212"></a>01212          cand = e;
<a name="l01213"></a>01213       }
<a name="l01214"></a>01214    }
<a name="l01215"></a>01215    <span class="keywordflow">return</span> e ? e : cand;
<a name="l01216"></a>01216 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ca4c598d1c26b929b56dafbb2b8c58a0"></a><!-- doxytag: member="cli.c::group_show_channels" ref="ca4c598d1c26b929b56dafbb2b8c58a0" args="(int fd, int argc, char *argv[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int group_show_channels           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00904">904</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="app_8c-source.html#l00933">ast_app_group_list_head()</a>, <a class="el" href="app_8c-source.html#l00928">ast_app_group_list_lock()</a>, <a class="el" href="app_8c-source.html#l00938">ast_app_group_list_unlock()</a>, <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="linkedlists_8h-source.html#l00403">AST_LIST_NEXT</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="app_8h-source.html#l00210">ast_group_info::category</a>, <a class="el" href="app_8h-source.html#l00209">ast_group_info::chan</a>, <a class="el" href="cli_8h-source.html#l00056">ESS</a>, <a class="el" href="cli_8c.html#f2999f6807db3259a76ab2262cfad8f8">FORMAT_STRING</a>, <a class="el" href="app_8h-source.html#l00211">ast_group_info::group</a>, <a class="el" href="cli_8h-source.html#l00038">RESULT_SHOWUSAGE</a>, and <a class="el" href="cli_8h-source.html#l00037">RESULT_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l00905"></a>00905 {
<a name="l00906"></a>00906 <span class="preprocessor">#define FORMAT_STRING  "%-25s  %-20s  %-20s\n"</span>
<a name="l00907"></a>00907 <span class="preprocessor"></span>
<a name="l00908"></a>00908    <span class="keyword">struct </span><a class="code" href="structast__group__info.html">ast_group_info</a> *gi = NULL;
<a name="l00909"></a>00909    <span class="keywordtype">int</span> numchans = 0;
<a name="l00910"></a>00910    regex_t regexbuf;
<a name="l00911"></a>00911    <span class="keywordtype">int</span> havepattern = 0;
<a name="l00912"></a>00912 
<a name="l00913"></a>00913    <span class="keywordflow">if</span> (argc &lt; 3 || argc &gt; 4)
<a name="l00914"></a>00914       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d7f3bcd35c16172e6fc0964a175fcadb">RESULT_SHOWUSAGE</a>;
<a name="l00915"></a>00915    
<a name="l00916"></a>00916    <span class="keywordflow">if</span> (argc == 4) {
<a name="l00917"></a>00917       <span class="keywordflow">if</span> (regcomp(&amp;regexbuf, argv[3], REG_EXTENDED | REG_NOSUB))
<a name="l00918"></a>00918          <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d7f3bcd35c16172e6fc0964a175fcadb">RESULT_SHOWUSAGE</a>;
<a name="l00919"></a>00919       havepattern = 1;
<a name="l00920"></a>00920    }
<a name="l00921"></a>00921 
<a name="l00922"></a>00922    <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, FORMAT_STRING, <span class="stringliteral">"Channel"</span>, <span class="stringliteral">"Group"</span>, <span class="stringliteral">"Category"</span>);
<a name="l00923"></a>00923 
<a name="l00924"></a>00924    <a class="code" href="app_8c.html#6ca2f3db40c08ed48914528a3b99bfda">ast_app_group_list_lock</a>();
<a name="l00925"></a>00925    
<a name="l00926"></a>00926    gi = <a class="code" href="app_8c.html#11081b119847f9a2ea3507be2bfab22c">ast_app_group_list_head</a>();
<a name="l00927"></a>00927    <span class="keywordflow">while</span> (gi) {
<a name="l00928"></a>00928       <span class="keywordflow">if</span> (!havepattern || !regexec(&amp;regexbuf, gi-&gt;<a class="code" href="structast__group__info.html#db0f6f37ebeb6ea09489124345af2a45">group</a>, 0, NULL, 0)) {
<a name="l00929"></a>00929          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, FORMAT_STRING, gi-&gt;<a class="code" href="structast__group__info.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;name, gi-&gt;<a class="code" href="structast__group__info.html#db0f6f37ebeb6ea09489124345af2a45">group</a>, (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(gi-&gt;<a class="code" href="structast__group__info.html#c4ef352f74e502ef5e7bc98e6f4e493d">category</a>) ? <span class="stringliteral">"(default)"</span> : gi-&gt;<a class="code" href="structast__group__info.html#c4ef352f74e502ef5e7bc98e6f4e493d">category</a>));
<a name="l00930"></a>00930          numchans++;
<a name="l00931"></a>00931       }
<a name="l00932"></a>00932       gi = <a class="code" href="linkedlists_8h.html#ab7d30c78fda9982ddc59f746adf8a69">AST_LIST_NEXT</a>(gi, list);
<a name="l00933"></a>00933    }
<a name="l00934"></a>00934    
<a name="l00935"></a>00935    <a class="code" href="app_8c.html#a7941c61f12b3511cfdf409622588a37">ast_app_group_list_unlock</a>();
<a name="l00936"></a>00936    
<a name="l00937"></a>00937    <span class="keywordflow">if</span> (havepattern)
<a name="l00938"></a>00938       regfree(&amp;regexbuf);
<a name="l00939"></a>00939 
<a name="l00940"></a>00940    <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"%d active channel%s\n"</span>, numchans, <a class="code" href="cli_8h.html#9f130886d424a4c673e63f0d0f3b0086">ESS</a>(numchans));
<a name="l00941"></a>00941    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l00942"></a>00942 <span class="preprocessor">#undef FORMAT_STRING</span>
<a name="l00943"></a>00943 <span class="preprocessor"></span>}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="7a6f1b84d95ef6315d384f55e84f07f9"></a><!-- doxytag: member="cli.c::handle_chanlist" ref="7a6f1b84d95ef6315d384f55e84f07f9" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* handle_chanlist           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00452">452</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00435">ast_channel::_state</a>, <a class="el" href="channel_8h-source.html#l00450">ast_channel::amaflags</a>, <a class="el" href="channel_8h-source.html#l00421">ast_channel::appl</a>, <a class="el" href="cli_8h-source.html#l00138">ast_cli_args::argc</a>, <a class="el" href="cli_8h-source.html#l00189">ast_cli_entry::args</a>, <a class="el" href="cli_8h-source.html#l00139">ast_cli_args::argv</a>, <a class="el" href="pbx_8c-source.html#l02585">ast_active_calls()</a>, <a class="el" href="channel_8c-source.html#l03754">ast_bridged_channel()</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="channel_8c-source.html#l00989">ast_channel_walk_locked()</a>, <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="channel_8c-source.html#l00523">ast_state2str()</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, <a class="el" href="channel_8h-source.html#l00437">ast_channel::cid</a>, <a class="el" href="channel_8h-source.html#l00212">ast_callerid::cid_num</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d2f4c807e7bc4e767d91adc6ee3e8869e">CLI_GENERATE</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>, <a class="el" href="cli_8h-source.html#l00042">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h-source.html#l00041">CLI_SUCCESS</a>, <a class="el" href="cli_8h-source.html#l00190">ast_cli_entry::command</a>, <a class="el" href="cli_8c.html#1b39a0e2c1f2a708bbbefd7121cc4e50">CONCISE_FORMAT_STRING</a>, <a class="el" href="channel_8h-source.html#l00441">ast_channel::context</a>, <a class="el" href="channel_8h-source.html#l00422">ast_channel::data</a>, <a class="el" href="cli_8h-source.html#l00056">ESS</a>, <a class="el" href="channel_8h-source.html#l00442">ast_channel::exten</a>, <a class="el" href="cli_8h-source.html#l00137">ast_cli_args::fd</a>, <a class="el" href="cli_8c.html#f2999f6807db3259a76ab2262cfad8f8">FORMAT_STRING</a>, <a class="el" href="cli_8c.html#cd1a3f1e21f1f2590757b0869d8aa143">FORMAT_STRING2</a>, <a class="el" href="asterisk_8c-source.html#l00167">option_maxcalls</a>, <a class="el" href="channel_8h-source.html#l00443">ast_channel::priority</a>, <a class="el" href="strings_8h-source.html#l00045">S_OR</a>, <a class="el" href="cdr_8h-source.html#l00070">ast_cdr::start</a>, <a class="el" href="cli_8h-source.html#l00168">ast_cli_entry::usage</a>, <a class="el" href="cli_8c.html#2dc5124f4b3587e50079582cfb00c3ce">VERBOSE_FORMAT_STRING</a>, and <a class="el" href="cli_8c.html#c6c834d875c9525f400abf5c3bc8f4a5">VERBOSE_FORMAT_STRING2</a>.<div class="fragment"><pre class="fragment"><a name="l00453"></a>00453 {
<a name="l00454"></a>00454 <span class="preprocessor">#define FORMAT_STRING  "%-20.20s %-20.20s %-7.7s %-30.30s\n"</span>
<a name="l00455"></a>00455 <span class="preprocessor"></span><span class="preprocessor">#define FORMAT_STRING2 "%-20.20s %-20.20s %-7.7s %-30.30s\n"</span>
<a name="l00456"></a>00456 <span class="preprocessor"></span><span class="preprocessor">#define CONCISE_FORMAT_STRING  "%s!%s!%s!%d!%s!%s!%s!%s!%s!%d!%s!%s\n"</span>
<a name="l00457"></a>00457 <span class="preprocessor"></span><span class="preprocessor">#define VERBOSE_FORMAT_STRING  "%-20.20s %-20.20s %-16.16s %4d %-7.7s %-12.12s %-25.25s %-15.15s %8.8s %-11.11s %-20.20s\n"</span>
<a name="l00458"></a>00458 <span class="preprocessor"></span><span class="preprocessor">#define VERBOSE_FORMAT_STRING2 "%-20.20s %-20.20s %-16.16s %-4.4s %-7.7s %-12.12s %-25.25s %-15.15s %8.8s %-11.11s %-20.20s\n"</span>
<a name="l00459"></a>00459 <span class="preprocessor"></span>
<a name="l00460"></a>00460    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *c = NULL;
<a name="l00461"></a>00461    <span class="keywordtype">int</span> numchans = 0, concise = 0, verbose = 0, count = 0;
<a name="l00462"></a>00462    <span class="keywordtype">int</span> fd, argc;
<a name="l00463"></a>00463    <span class="keywordtype">char</span> **argv;
<a name="l00464"></a>00464 
<a name="l00465"></a>00465    <span class="keywordflow">switch</span> (cmd) {
<a name="l00466"></a>00466    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>:
<a name="l00467"></a>00467       e-&gt;<a class="code" href="structast__cli__entry.html#1dccadfed7bcbb036c56a4afb97e906f">command</a> = <span class="stringliteral">"core show channels [concise|verbose|count]"</span>;
<a name="l00468"></a>00468       e-&gt;<a class="code" href="structast__cli__entry.html#9366282e11c151558bdfaab4a264aa1b">usage</a> =
<a name="l00469"></a>00469          <span class="stringliteral">"Usage: core show channels [concise|verbose|count]\n"</span>
<a name="l00470"></a>00470          <span class="stringliteral">"       Lists currently defined channels and some information about them. If\n"</span>
<a name="l00471"></a>00471          <span class="stringliteral">"       'concise' is specified, the format is abridged and in a more easily\n"</span>
<a name="l00472"></a>00472          <span class="stringliteral">"       machine parsable format. If 'verbose' is specified, the output includes\n"</span>
<a name="l00473"></a>00473          <span class="stringliteral">"       more and longer fields. If 'count' is specified only the channel and call\n"</span>
<a name="l00474"></a>00474          <span class="stringliteral">"       count is output.\n"</span>;
<a name="l00475"></a>00475       <span class="keywordflow">return</span> NULL;
<a name="l00476"></a>00476 
<a name="l00477"></a>00477    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d2f4c807e7bc4e767d91adc6ee3e8869e">CLI_GENERATE</a>:
<a name="l00478"></a>00478       <span class="keywordflow">return</span> NULL;
<a name="l00479"></a>00479    }
<a name="l00480"></a>00480    fd = a-&gt;<a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a>;
<a name="l00481"></a>00481    argc = a-&gt;<a class="code" href="structast__cli__args.html#212be369d46788be295dbb6516442fee">argc</a>;
<a name="l00482"></a>00482    argv = a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a>;
<a name="l00483"></a>00483 
<a name="l00484"></a>00484    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#212be369d46788be295dbb6516442fee">argc</a> == e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>) {
<a name="l00485"></a>00485       <span class="keywordflow">if</span> (!strcasecmp(argv[e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>-1],<span class="stringliteral">"concise"</span>))
<a name="l00486"></a>00486          concise = 1;
<a name="l00487"></a>00487       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(argv[e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>-1],<span class="stringliteral">"verbose"</span>))
<a name="l00488"></a>00488          verbose = 1;
<a name="l00489"></a>00489       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(argv[e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>-1],<span class="stringliteral">"count"</span>))
<a name="l00490"></a>00490          count = 1;
<a name="l00491"></a>00491       <span class="keywordflow">else</span>
<a name="l00492"></a>00492          <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#8409e2cc535711ab81e051428521a8c6">CLI_SHOWUSAGE</a>;
<a name="l00493"></a>00493    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#212be369d46788be295dbb6516442fee">argc</a> != e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a> - 1)
<a name="l00494"></a>00494       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#8409e2cc535711ab81e051428521a8c6">CLI_SHOWUSAGE</a>;
<a name="l00495"></a>00495 
<a name="l00496"></a>00496    <span class="keywordflow">if</span> (!count) {
<a name="l00497"></a>00497       <span class="keywordflow">if</span> (!concise &amp;&amp; !verbose)
<a name="l00498"></a>00498          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, FORMAT_STRING2, <span class="stringliteral">"Channel"</span>, <span class="stringliteral">"Location"</span>, <span class="stringliteral">"State"</span>, <span class="stringliteral">"Application(Data)"</span>);
<a name="l00499"></a>00499       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (verbose)
<a name="l00500"></a>00500          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, VERBOSE_FORMAT_STRING2, <span class="stringliteral">"Channel"</span>, <span class="stringliteral">"Context"</span>, <span class="stringliteral">"Extension"</span>, <span class="stringliteral">"Priority"</span>, <span class="stringliteral">"State"</span>, <span class="stringliteral">"Application"</span>, <span class="stringliteral">"Data"</span>, 
<a name="l00501"></a>00501             <span class="stringliteral">"CallerID"</span>, <span class="stringliteral">"Duration"</span>, <span class="stringliteral">"Accountcode"</span>, <span class="stringliteral">"BridgedTo"</span>);
<a name="l00502"></a>00502    }
<a name="l00503"></a>00503 
<a name="l00504"></a>00504    <span class="keywordflow">while</span> ((c = <a class="code" href="channel_8c.html#8ada12445e0d71c8bcd465f6838bf4e5">ast_channel_walk_locked</a>(c)) != NULL) {
<a name="l00505"></a>00505       <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *bc = <a class="code" href="channel_8c.html#8f80b59690710acfe4fc82cfcbbf9ee9">ast_bridged_channel</a>(c);
<a name="l00506"></a>00506       <span class="keywordtype">char</span> durbuf[10] = <span class="stringliteral">"-"</span>;
<a name="l00507"></a>00507 
<a name="l00508"></a>00508       <span class="keywordflow">if</span> (!count) {
<a name="l00509"></a>00509          <span class="keywordflow">if</span> ((concise || verbose)  &amp;&amp; c-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a> &amp;&amp; !ast_tvzero(c-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a>)) {
<a name="l00510"></a>00510             <span class="keywordtype">int</span> duration = (int)(ast_tvdiff_ms(ast_tvnow(), c-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a>) / 1000);
<a name="l00511"></a>00511             <span class="keywordflow">if</span> (verbose) {
<a name="l00512"></a>00512                <span class="keywordtype">int</span> durh = duration / 3600;
<a name="l00513"></a>00513                <span class="keywordtype">int</span> durm = (duration % 3600) / 60;
<a name="l00514"></a>00514                <span class="keywordtype">int</span> durs = duration % 60;
<a name="l00515"></a>00515                snprintf(durbuf, <span class="keyword">sizeof</span>(durbuf), <span class="stringliteral">"%02d:%02d:%02d"</span>, durh, durm, durs);
<a name="l00516"></a>00516             } <span class="keywordflow">else</span> {
<a name="l00517"></a>00517                snprintf(durbuf, <span class="keyword">sizeof</span>(durbuf), <span class="stringliteral">"%d"</span>, duration);
<a name="l00518"></a>00518             }           
<a name="l00519"></a>00519          }
<a name="l00520"></a>00520          <span class="keywordflow">if</span> (concise) {
<a name="l00521"></a>00521             <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, CONCISE_FORMAT_STRING, c-&gt;name, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, c-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>, <a class="code" href="channel_8c.html#1c242fd13329f5600ccd56263aba7272">ast_state2str</a>(c-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a>),
<a name="l00522"></a>00522                c-&gt;<a class="code" href="structast__channel.html#63469c3c4f19f07c737127a117296de4">appl</a> ? c-&gt;<a class="code" href="structast__channel.html#63469c3c4f19f07c737127a117296de4">appl</a> : <span class="stringliteral">"(None)"</span>,
<a name="l00523"></a>00523                <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(c-&gt;<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a>, <span class="stringliteral">""</span>),   <span class="comment">/* XXX different from verbose ? */</span>
<a name="l00524"></a>00524                <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>, <span class="stringliteral">""</span>),
<a name="l00525"></a>00525                <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(c-&gt;accountcode, <span class="stringliteral">""</span>),
<a name="l00526"></a>00526                c-&gt;<a class="code" href="structast__channel.html#d5aa4bb1461fe3d863bd95fb137e2284">amaflags</a>, 
<a name="l00527"></a>00527                durbuf,
<a name="l00528"></a>00528                bc ? bc-&gt;name : <span class="stringliteral">"(None)"</span>);
<a name="l00529"></a>00529          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (verbose) {
<a name="l00530"></a>00530             <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, VERBOSE_FORMAT_STRING, c-&gt;name, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, c-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>, <a class="code" href="channel_8c.html#1c242fd13329f5600ccd56263aba7272">ast_state2str</a>(c-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a>),
<a name="l00531"></a>00531                c-&gt;<a class="code" href="structast__channel.html#63469c3c4f19f07c737127a117296de4">appl</a> ? c-&gt;<a class="code" href="structast__channel.html#63469c3c4f19f07c737127a117296de4">appl</a> : <span class="stringliteral">"(None)"</span>,
<a name="l00532"></a>00532                c-&gt;<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a> ? <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(c-&gt;<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a>, <span class="stringliteral">"(Empty)"</span> ): <span class="stringliteral">"(None)"</span>,
<a name="l00533"></a>00533                <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>, <span class="stringliteral">""</span>),
<a name="l00534"></a>00534                durbuf,
<a name="l00535"></a>00535                <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(c-&gt;accountcode, <span class="stringliteral">""</span>),
<a name="l00536"></a>00536                bc ? bc-&gt;name : <span class="stringliteral">"(None)"</span>);
<a name="l00537"></a>00537          } <span class="keywordflow">else</span> {
<a name="l00538"></a>00538             <span class="keywordtype">char</span> locbuf[40] = <span class="stringliteral">"(None)"</span>;
<a name="l00539"></a>00539             <span class="keywordtype">char</span> appdata[40] = <span class="stringliteral">"(None)"</span>;
<a name="l00540"></a>00540             
<a name="l00541"></a>00541             <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>) &amp;&amp; !<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>)) 
<a name="l00542"></a>00542                snprintf(locbuf, <span class="keyword">sizeof</span>(locbuf), <span class="stringliteral">"%s@%s:%d"</span>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, c-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>);
<a name="l00543"></a>00543             <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structast__channel.html#63469c3c4f19f07c737127a117296de4">appl</a>)
<a name="l00544"></a>00544                snprintf(appdata, <span class="keyword">sizeof</span>(appdata), <span class="stringliteral">"%s(%s)"</span>, c-&gt;<a class="code" href="structast__channel.html#63469c3c4f19f07c737127a117296de4">appl</a>, <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(c-&gt;<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a>, <span class="stringliteral">""</span>));
<a name="l00545"></a>00545             <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, FORMAT_STRING, c-&gt;name, locbuf, <a class="code" href="channel_8c.html#1c242fd13329f5600ccd56263aba7272">ast_state2str</a>(c-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a>), appdata);
<a name="l00546"></a>00546          }
<a name="l00547"></a>00547       }
<a name="l00548"></a>00548       numchans++;
<a name="l00549"></a>00549       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(c);
<a name="l00550"></a>00550    }
<a name="l00551"></a>00551    <span class="keywordflow">if</span> (!concise) {
<a name="l00552"></a>00552       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"%d active channel%s\n"</span>, numchans, <a class="code" href="cli_8h.html#9f130886d424a4c673e63f0d0f3b0086">ESS</a>(numchans));
<a name="l00553"></a>00553       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g367972f6fd289cfd0361f9f8292dd597">option_maxcalls</a>)
<a name="l00554"></a>00554          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"%d of %d max active call%s (%5.2f%% of capacity)\n"</span>,
<a name="l00555"></a>00555             <a class="code" href="pbx_8c.html#12b93bee10e4fd5d30576d7a6877e12b">ast_active_calls</a>(), <a class="code" href="group__main__options.html#g367972f6fd289cfd0361f9f8292dd597">option_maxcalls</a>, <a class="code" href="cli_8h.html#9f130886d424a4c673e63f0d0f3b0086">ESS</a>(<a class="code" href="pbx_8c.html#12b93bee10e4fd5d30576d7a6877e12b">ast_active_calls</a>()),
<a name="l00556"></a>00556             ((<span class="keywordtype">double</span>)<a class="code" href="pbx_8c.html#12b93bee10e4fd5d30576d7a6877e12b">ast_active_calls</a>() / (<span class="keywordtype">double</span>)<a class="code" href="group__main__options.html#g367972f6fd289cfd0361f9f8292dd597">option_maxcalls</a>) * 100.0);
<a name="l00557"></a>00557       <span class="keywordflow">else</span>
<a name="l00558"></a>00558          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"%d active call%s\n"</span>, <a class="code" href="pbx_8c.html#12b93bee10e4fd5d30576d7a6877e12b">ast_active_calls</a>(), <a class="code" href="cli_8h.html#9f130886d424a4c673e63f0d0f3b0086">ESS</a>(<a class="code" href="pbx_8c.html#12b93bee10e4fd5d30576d7a6877e12b">ast_active_calls</a>()));
<a name="l00559"></a>00559    }
<a name="l00560"></a>00560    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#1feba2188d0c8b5f3bffccacea035b67">CLI_SUCCESS</a>;
<a name="l00561"></a>00561    
<a name="l00562"></a>00562 <span class="preprocessor">#undef FORMAT_STRING</span>
<a name="l00563"></a>00563 <span class="preprocessor"></span><span class="preprocessor">#undef FORMAT_STRING2</span>
<a name="l00564"></a>00564 <span class="preprocessor"></span><span class="preprocessor">#undef CONCISE_FORMAT_STRING</span>
<a name="l00565"></a>00565 <span class="preprocessor"></span><span class="preprocessor">#undef VERBOSE_FORMAT_STRING</span>
<a name="l00566"></a>00566 <span class="preprocessor"></span><span class="preprocessor">#undef VERBOSE_FORMAT_STRING2</span>
<a name="l00567"></a>00567 <span class="preprocessor"></span>}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="00f7c0106ba490e6e968a222fe99ed0b"></a><!-- doxytag: member="cli.c::handle_commandcomplete" ref="00f7c0106ba490e6e968a222fe99ed0b" args="(int fd, int argc, char *argv[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int handle_commandcomplete           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00662">662</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l01595">__ast_cli_generator()</a>, <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="adsistub_8c-source.html#l00065">buf</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="cli_8h-source.html#l00038">RESULT_SHOWUSAGE</a>, and <a class="el" href="cli_8h-source.html#l00037">RESULT_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l00663"></a>00663 {
<a name="l00664"></a>00664    <span class="keywordtype">char</span> *<a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>;
<a name="l00665"></a>00665 
<a name="l00666"></a>00666    <span class="keywordflow">if</span> (argc != 5)
<a name="l00667"></a>00667       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d7f3bcd35c16172e6fc0964a175fcadb">RESULT_SHOWUSAGE</a>;
<a name="l00668"></a>00668    buf = <a class="code" href="cli_8c.html#4c6099872e6a10522abb6afa7512ab3c">__ast_cli_generator</a>(argv[2], argv[3], atoi(argv[4]), 0);
<a name="l00669"></a>00669    <span class="keywordflow">if</span> (buf) {
<a name="l00670"></a>00670       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, buf);
<a name="l00671"></a>00671       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(buf);
<a name="l00672"></a>00672    } <span class="keywordflow">else</span>
<a name="l00673"></a>00673       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"NULL\n"</span>);
<a name="l00674"></a>00674    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l00675"></a>00675 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d4b55bb7714193fae722ea2f0c4e4425"></a><!-- doxytag: member="cli.c::handle_commandmatchesarray" ref="d4b55bb7714193fae722ea2f0c4e4425" args="(int fd, int argc, char *argv[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int handle_commandmatchesarray           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00605">605</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="cli_8h-source.html#l00049">AST_CLI_COMPLETE_EOF</a>, <a class="el" href="cli_8c-source.html#l01534">ast_cli_completion_matches()</a>, <a class="el" href="utils_8h-source.html#l00359">ast_malloc</a>, <a class="el" href="utils_8h.html#009723420c269c3a1ecb1953558e608d">ast_realloc</a>, <a class="el" href="adsistub_8c-source.html#l00065">buf</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="utils_8h-source.html#l00386">len</a>, <a class="el" href="cli_8h-source.html#l00039">RESULT_FAILURE</a>, <a class="el" href="cli_8h-source.html#l00038">RESULT_SHOWUSAGE</a>, and <a class="el" href="cli_8h-source.html#l00037">RESULT_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l00606"></a>00606 {
<a name="l00607"></a>00607    <span class="keywordtype">char</span> *<a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>, *obuf;
<a name="l00608"></a>00608    <span class="keywordtype">int</span> buflen = 2048;
<a name="l00609"></a>00609    <span class="keywordtype">int</span> <a class="code" href="utils_8h.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a> = 0;
<a name="l00610"></a>00610    <span class="keywordtype">char</span> **matches;
<a name="l00611"></a>00611    <span class="keywordtype">int</span> x, matchlen;
<a name="l00612"></a>00612 
<a name="l00613"></a>00613    <span class="keywordflow">if</span> (argc != 4)
<a name="l00614"></a>00614       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d7f3bcd35c16172e6fc0964a175fcadb">RESULT_SHOWUSAGE</a>;
<a name="l00615"></a>00615    <span class="keywordflow">if</span> (!(buf = <a class="code" href="utils_8h.html#efc2f2f953e736b509e4a2cee96151db">ast_malloc</a>(buflen)))
<a name="l00616"></a>00616       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#029ade91f74f40adbbae98503f72e91b">RESULT_FAILURE</a>;
<a name="l00617"></a>00617    buf[len] = <span class="charliteral">'\0'</span>;
<a name="l00618"></a>00618    matches = <a class="code" href="cli_8c.html#2fa472a45042f3ae905a4fbba5677b68">ast_cli_completion_matches</a>(argv[2], argv[3]);
<a name="l00619"></a>00619    <span class="keywordflow">if</span> (matches) {
<a name="l00620"></a>00620       <span class="keywordflow">for</span> (x=0; matches[x]; x++) {
<a name="l00621"></a>00621          matchlen = strlen(matches[x]) + 1;
<a name="l00622"></a>00622          <span class="keywordflow">if</span> (len + matchlen &gt;= buflen) {
<a name="l00623"></a>00623             buflen += matchlen * 3;
<a name="l00624"></a>00624             obuf = buf;
<a name="l00625"></a>00625             <span class="keywordflow">if</span> (!(buf = <a class="code" href="utils_8h.html#009723420c269c3a1ecb1953558e608d">ast_realloc</a>(obuf, buflen))) 
<a name="l00626"></a>00626                <span class="comment">/* Memory allocation failure...  Just free old buffer and be done */</span>
<a name="l00627"></a>00627                <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(obuf);
<a name="l00628"></a>00628          }
<a name="l00629"></a>00629          <span class="keywordflow">if</span> (buf)
<a name="l00630"></a>00630             len += sprintf( buf + len, <span class="stringliteral">"%s "</span>, matches[x]);
<a name="l00631"></a>00631          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(matches[x]);
<a name="l00632"></a>00632          matches[x] = NULL;
<a name="l00633"></a>00633       }
<a name="l00634"></a>00634       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(matches);
<a name="l00635"></a>00635    }
<a name="l00636"></a>00636 
<a name="l00637"></a>00637    <span class="keywordflow">if</span> (buf) {
<a name="l00638"></a>00638       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"%s%s"</span>,buf, <a class="code" href="cli_8h.html#bfd6f988e27c644acace102ba46b512c">AST_CLI_COMPLETE_EOF</a>);
<a name="l00639"></a>00639       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(buf);
<a name="l00640"></a>00640    } <span class="keywordflow">else</span>
<a name="l00641"></a>00641       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"NULL\n"</span>);
<a name="l00642"></a>00642 
<a name="l00643"></a>00643    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l00644"></a>00644 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ecba7cdd68efeebd23b52a75848aa903"></a><!-- doxytag: member="cli.c::handle_commandnummatches" ref="ecba7cdd68efeebd23b52a75848aa903" args="(int fd, int argc, char *argv[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int handle_commandnummatches           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00648">648</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="cli_8c-source.html#l01517">ast_cli_generatornummatches()</a>, <a class="el" href="cli_8h-source.html#l00038">RESULT_SHOWUSAGE</a>, and <a class="el" href="cli_8h-source.html#l00037">RESULT_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l00649"></a>00649 {
<a name="l00650"></a>00650    <span class="keywordtype">int</span> matches = 0;
<a name="l00651"></a>00651 
<a name="l00652"></a>00652    <span class="keywordflow">if</span> (argc != 4)
<a name="l00653"></a>00653       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d7f3bcd35c16172e6fc0964a175fcadb">RESULT_SHOWUSAGE</a>;
<a name="l00654"></a>00654 
<a name="l00655"></a>00655    matches = <a class="code" href="cli_8c.html#4c0a7fc47581d0fbc8ade249a4a021c9">ast_cli_generatornummatches</a>(argv[2], argv[3]);
<a name="l00656"></a>00656 
<a name="l00657"></a>00657    <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"%d"</span>, matches);
<a name="l00658"></a>00658 
<a name="l00659"></a>00659    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l00660"></a>00660 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b8d4ee33a1af5803a686d86778c813a1"></a><!-- doxytag: member="cli.c::handle_core_set_debug_channel" ref="b8d4ee33a1af5803a686d86778c813a1" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* handle_core_set_debug_channel           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00677">677</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8h-source.html#l00138">ast_cli_args::argc</a>, <a class="el" href="cli_8h-source.html#l00189">ast_cli_entry::args</a>, <a class="el" href="cli_8h-source.html#l00139">ast_cli_args::argv</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="channel_8c-source.html#l00989">ast_channel_walk_locked()</a>, <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="cli_8c-source.html#l00873">ast_complete_channels()</a>, <a class="el" href="channel_8c-source.html#l00995">ast_get_channel_by_name_locked()</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d2f4c807e7bc4e767d91adc6ee3e8869e">CLI_GENERATE</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>, <a class="el" href="cli_8h-source.html#l00042">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h-source.html#l00190">ast_cli_entry::command</a>, <a class="el" href="channel_8h-source.html#l00327">DEBUGCHAN_FLAG</a>, <a class="el" href="cli_8h-source.html#l00137">ast_cli_args::fd</a>, <a class="el" href="channel_8h-source.html#l00462">ast_channel::fin</a>, <a class="el" href="channel_8h-source.html#l00464">ast_channel::fout</a>, <a class="el" href="channel_8c-source.html#l00102">global_fin</a>, <a class="el" href="channel_8c-source.html#l00102">global_fout</a>, <a class="el" href="cli_8h-source.html#l00140">ast_cli_args::line</a>, <a class="el" href="cli_8h-source.html#l00143">ast_cli_args::n</a>, <a class="el" href="cli_8h-source.html#l00142">ast_cli_args::pos</a>, <a class="el" href="cli_8h-source.html#l00037">RESULT_SUCCESS</a>, <a class="el" href="astmm_8h-source.html#l00075">strdup</a>, <a class="el" href="cli_8h-source.html#l00168">ast_cli_entry::usage</a>, and <a class="el" href="cli_8h-source.html#l00141">ast_cli_args::word</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l00740">handle_debugchan_deprecated()</a>, and <a class="el" href="cli_8c-source.html#l00752">handle_nodebugchan_deprecated()</a>.<div class="fragment"><pre class="fragment"><a name="l00678"></a>00678 {
<a name="l00679"></a>00679    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *c = NULL;
<a name="l00680"></a>00680    <span class="keywordtype">int</span> is_all, is_off = 0;
<a name="l00681"></a>00681 
<a name="l00682"></a>00682    <span class="keywordflow">switch</span> (cmd) {
<a name="l00683"></a>00683    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>:
<a name="l00684"></a>00684       e-&gt;<a class="code" href="structast__cli__entry.html#1dccadfed7bcbb036c56a4afb97e906f">command</a> = <span class="stringliteral">"core set debug channel"</span>;
<a name="l00685"></a>00685       e-&gt;<a class="code" href="structast__cli__entry.html#9366282e11c151558bdfaab4a264aa1b">usage</a> =
<a name="l00686"></a>00686          <span class="stringliteral">"Usage: core set debug channel &lt;all|channel&gt; [off]\n"</span>
<a name="l00687"></a>00687          <span class="stringliteral">"       Enables/disables debugging on all or on a specific channel.\n"</span>;
<a name="l00688"></a>00688       <span class="keywordflow">return</span> NULL;
<a name="l00689"></a>00689 
<a name="l00690"></a>00690    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d2f4c807e7bc4e767d91adc6ee3e8869e">CLI_GENERATE</a>:
<a name="l00691"></a>00691       <span class="comment">/* XXX remember to handle the optional "off" */</span>
<a name="l00692"></a>00692       <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#5e0bdcbddccca4d66d74ba8c1cee1a68">pos</a> != e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>)
<a name="l00693"></a>00693          <span class="keywordflow">return</span> NULL;
<a name="l00694"></a>00694       <span class="keywordflow">return</span> a-&gt;<a class="code" href="structast__cli__args.html#7b8b965ad4bca0e41ab51de7b31363a1">n</a> == 0 ? <a class="code" href="astmm_8h.html#17881997a89ddffd239268f0476567d0">strdup</a>(<span class="stringliteral">"all"</span>) : <a class="code" href="cli_8c.html#5230ec2c08f6ec3f2c5b34af707e6743">ast_complete_channels</a>(a-&gt;<a class="code" href="manager_8h.html#6438c669e0d0de98e6929c2cc0fac474">line</a>, a-&gt;word, a-&gt;pos, a-&gt;n - 1, e-&gt;args);
<a name="l00695"></a>00695    }
<a name="l00696"></a>00696    <span class="comment">/* 'core set debug channel {all|chan_id}' */</span>
<a name="l00697"></a>00697    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#212be369d46788be295dbb6516442fee">argc</a> == e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a> + 2) {
<a name="l00698"></a>00698       <span class="keywordflow">if</span> (!strcasecmp(a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a>[e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a> + 1], <span class="stringliteral">"off"</span>))
<a name="l00699"></a>00699          is_off = 1;
<a name="l00700"></a>00700       <span class="keywordflow">else</span>
<a name="l00701"></a>00701          <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#8409e2cc535711ab81e051428521a8c6">CLI_SHOWUSAGE</a>;
<a name="l00702"></a>00702    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#212be369d46788be295dbb6516442fee">argc</a> != e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a> + 1)
<a name="l00703"></a>00703       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#8409e2cc535711ab81e051428521a8c6">CLI_SHOWUSAGE</a>;
<a name="l00704"></a>00704 
<a name="l00705"></a>00705    is_all = !strcasecmp(<span class="stringliteral">"all"</span>, a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a>[e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>]);
<a name="l00706"></a>00706    <span class="keywordflow">if</span> (is_all) {
<a name="l00707"></a>00707       <span class="keywordflow">if</span> (is_off) {
<a name="l00708"></a>00708          <a class="code" href="channel_8c.html#fb1a13eb3cfac4d9cfb7c4b0d2865bde">global_fin</a> &amp;= ~<a class="code" href="channel_8h.html#121c28674a9262e968ca5860c9f3e511">DEBUGCHAN_FLAG</a>;
<a name="l00709"></a>00709          <a class="code" href="channel_8c.html#2173c5282c13757472cb6ac76d8ecdad">global_fout</a> &amp;= ~<a class="code" href="channel_8h.html#121c28674a9262e968ca5860c9f3e511">DEBUGCHAN_FLAG</a>;
<a name="l00710"></a>00710       } <span class="keywordflow">else</span> {
<a name="l00711"></a>00711          <a class="code" href="channel_8c.html#fb1a13eb3cfac4d9cfb7c4b0d2865bde">global_fin</a> |= <a class="code" href="channel_8h.html#121c28674a9262e968ca5860c9f3e511">DEBUGCHAN_FLAG</a>;
<a name="l00712"></a>00712          <a class="code" href="channel_8c.html#2173c5282c13757472cb6ac76d8ecdad">global_fout</a> |= <a class="code" href="channel_8h.html#121c28674a9262e968ca5860c9f3e511">DEBUGCHAN_FLAG</a>;
<a name="l00713"></a>00713       }
<a name="l00714"></a>00714       c = <a class="code" href="channel_8c.html#8ada12445e0d71c8bcd465f6838bf4e5">ast_channel_walk_locked</a>(NULL);
<a name="l00715"></a>00715    } <span class="keywordflow">else</span> {
<a name="l00716"></a>00716       c = <a class="code" href="channel_8c.html#e01fecb172f34785571d94adbc5c6558">ast_get_channel_by_name_locked</a>(a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a>[e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>]);
<a name="l00717"></a>00717       <span class="keywordflow">if</span> (c == NULL)
<a name="l00718"></a>00718          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a>, <span class="stringliteral">"No such channel %s\n"</span>, a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a>[e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>]);
<a name="l00719"></a>00719    }
<a name="l00720"></a>00720    <span class="keywordflow">while</span> (c) {
<a name="l00721"></a>00721       <span class="keywordflow">if</span> (!(c-&gt;<a class="code" href="structast__channel.html#d79695776a5b40f7cadbee1f91a85c82">fin</a> &amp; <a class="code" href="channel_8h.html#121c28674a9262e968ca5860c9f3e511">DEBUGCHAN_FLAG</a>) || !(c-&gt;<a class="code" href="structast__channel.html#048e72dbb3bdc2353732740741a72fe4">fout</a> &amp; <a class="code" href="channel_8h.html#121c28674a9262e968ca5860c9f3e511">DEBUGCHAN_FLAG</a>)) {
<a name="l00722"></a>00722          <span class="keywordflow">if</span> (is_off) {
<a name="l00723"></a>00723             c-&gt;<a class="code" href="structast__channel.html#d79695776a5b40f7cadbee1f91a85c82">fin</a> &amp;= ~<a class="code" href="channel_8h.html#121c28674a9262e968ca5860c9f3e511">DEBUGCHAN_FLAG</a>;
<a name="l00724"></a>00724             c-&gt;<a class="code" href="structast__channel.html#048e72dbb3bdc2353732740741a72fe4">fout</a> &amp;= ~<a class="code" href="channel_8h.html#121c28674a9262e968ca5860c9f3e511">DEBUGCHAN_FLAG</a>;
<a name="l00725"></a>00725          } <span class="keywordflow">else</span> {
<a name="l00726"></a>00726             c-&gt;<a class="code" href="structast__channel.html#d79695776a5b40f7cadbee1f91a85c82">fin</a> |= <a class="code" href="channel_8h.html#121c28674a9262e968ca5860c9f3e511">DEBUGCHAN_FLAG</a>;
<a name="l00727"></a>00727             c-&gt;<a class="code" href="structast__channel.html#048e72dbb3bdc2353732740741a72fe4">fout</a> |= <a class="code" href="channel_8h.html#121c28674a9262e968ca5860c9f3e511">DEBUGCHAN_FLAG</a>;
<a name="l00728"></a>00728          }
<a name="l00729"></a>00729          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a>, <span class="stringliteral">"Debugging %s on channel %s\n"</span>, is_off ? <span class="stringliteral">"disabled"</span> : <span class="stringliteral">"enabled"</span>, c-&gt;name);
<a name="l00730"></a>00730       }
<a name="l00731"></a>00731       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(c);
<a name="l00732"></a>00732       <span class="keywordflow">if</span> (!is_all)
<a name="l00733"></a>00733          <span class="keywordflow">break</span>;
<a name="l00734"></a>00734       c = <a class="code" href="channel_8c.html#8ada12445e0d71c8bcd465f6838bf4e5">ast_channel_walk_locked</a>(c);
<a name="l00735"></a>00735    }
<a name="l00736"></a>00736    <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a>, <span class="stringliteral">"Debugging on new channels is %s\n"</span>, is_off ? <span class="stringliteral">"disabled"</span> : <span class="stringliteral">"enabled"</span>);
<a name="l00737"></a>00737    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l00738"></a>00738 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1360a55b26d6753211dc6654c0b1a308"></a><!-- doxytag: member="cli.c::handle_debugchan_deprecated" ref="1360a55b26d6753211dc6654c0b1a308" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* handle_debugchan_deprecated           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00740">740</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8h-source.html#l00138">ast_cli_args::argc</a>, <a class="el" href="cli_8h-source.html#l00189">ast_cli_entry::args</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d380457cd644023f5d9c2553c0248aeb1">CLI_HANDLER</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>, <a class="el" href="cli_8h-source.html#l00042">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h-source.html#l00190">ast_cli_entry::command</a>, and <a class="el" href="cli_8c-source.html#l00677">handle_core_set_debug_channel()</a>.<div class="fragment"><pre class="fragment"><a name="l00741"></a>00741 {
<a name="l00742"></a>00742    <span class="keywordtype">char</span> *res;
<a name="l00743"></a>00743 
<a name="l00744"></a>00744    <span class="keywordflow">if</span> (cmd == <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d380457cd644023f5d9c2553c0248aeb1">CLI_HANDLER</a> &amp;&amp; a-&gt;<a class="code" href="structast__cli__args.html#212be369d46788be295dbb6516442fee">argc</a> != e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a> + 1)
<a name="l00745"></a>00745       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#8409e2cc535711ab81e051428521a8c6">CLI_SHOWUSAGE</a>;
<a name="l00746"></a>00746    res = <a class="code" href="cli_8c.html#b8d4ee33a1af5803a686d86778c813a1">handle_core_set_debug_channel</a>(e, cmd, a);
<a name="l00747"></a>00747    <span class="keywordflow">if</span> (cmd == <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>)
<a name="l00748"></a>00748       e-&gt;<a class="code" href="structast__cli__entry.html#1dccadfed7bcbb036c56a4afb97e906f">command</a> = <span class="stringliteral">"debug channel"</span>;
<a name="l00749"></a>00749    <span class="keywordflow">return</span> res;
<a name="l00750"></a>00750 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2bf09d536da04e857543470a94ea5da9"></a><!-- doxytag: member="cli.c::handle_help" ref="2bf09d536da04e857543470a94ea5da9" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char * handle_help           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l01411">1411</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l01595">__ast_cli_generator()</a>, <a class="el" href="cli_8h-source.html#l00138">ast_cli_args::argc</a>, <a class="el" href="cli_8h-source.html#l00139">ast_cli_args::argv</a>, <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="utils_8c-source.html#l00849">ast_join()</a>, <a class="el" href="linkedlists_8h-source.html#l00038">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00104">AST_LIST_UNLOCK</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d2f4c807e7bc4e767d91adc6ee3e8869e">CLI_GENERATE</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>, <a class="el" href="cli_8h-source.html#l00190">ast_cli_entry::command</a>, <a class="el" href="cli_8h-source.html#l00137">ast_cli_args::fd</a>, <a class="el" href="cli_8c-source.html#l01174">find_cli()</a>, <a class="el" href="cli_8c-source.html#l01378">help1()</a>, <a class="el" href="cli_8h-source.html#l00140">ast_cli_args::line</a>, <a class="el" href="cli_8h-source.html#l00143">ast_cli_args::n</a>, <a class="el" href="cli_8h-source.html#l00037">RESULT_SUCCESS</a>, <a class="el" href="cli_8h-source.html#l00168">ast_cli_entry::usage</a>, and <a class="el" href="cli_8h-source.html#l00141">ast_cli_args::word</a>.<div class="fragment"><pre class="fragment"><a name="l01412"></a>01412 {
<a name="l01413"></a>01413    <span class="keywordtype">char</span> fullcmd[80];
<a name="l01414"></a>01414    <span class="keyword">struct </span><a class="code" href="structast__cli__entry.html">ast_cli_entry</a> *my_e;
<a name="l01415"></a>01415 
<a name="l01416"></a>01416    <span class="keywordflow">if</span> (cmd == <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>) {
<a name="l01417"></a>01417       e-&gt;<a class="code" href="structast__cli__entry.html#1dccadfed7bcbb036c56a4afb97e906f">command</a> = <span class="stringliteral">"help"</span>;
<a name="l01418"></a>01418       e-&gt;<a class="code" href="structast__cli__entry.html#9366282e11c151558bdfaab4a264aa1b">usage</a> =
<a name="l01419"></a>01419          <span class="stringliteral">"Usage: help [topic]\n"</span>
<a name="l01420"></a>01420          <span class="stringliteral">"       When called with a topic as an argument, displays usage\n"</span>
<a name="l01421"></a>01421          <span class="stringliteral">"       information on the given command. If called without a\n"</span>
<a name="l01422"></a>01422          <span class="stringliteral">"       topic, it provides a list of commands.\n"</span>;
<a name="l01423"></a>01423       <span class="keywordflow">return</span> NULL;
<a name="l01424"></a>01424 
<a name="l01425"></a>01425    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cmd == <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d2f4c807e7bc4e767d91adc6ee3e8869e">CLI_GENERATE</a>) {
<a name="l01426"></a>01426       <span class="comment">/* skip first 4 or 5 chars, "help " */</span>
<a name="l01427"></a>01427       <span class="keywordtype">int</span> l = strlen(a-&gt;<a class="code" href="structast__cli__args.html#6438c669e0d0de98e6929c2cc0fac474">line</a>);
<a name="l01428"></a>01428 
<a name="l01429"></a>01429       <span class="keywordflow">if</span> (l &gt; 5)
<a name="l01430"></a>01430          l = 5;
<a name="l01431"></a>01431       <span class="comment">/* XXX watch out, should stop to the non-generator parts */</span>
<a name="l01432"></a>01432       <span class="keywordflow">return</span> <a class="code" href="cli_8c.html#4c6099872e6a10522abb6afa7512ab3c">__ast_cli_generator</a>(a-&gt;<a class="code" href="structast__cli__args.html#6438c669e0d0de98e6929c2cc0fac474">line</a> + l, a-&gt;<a class="code" href="structast__cli__args.html#c47d187067c6cf953245f128b5fde62a">word</a>, a-&gt;<a class="code" href="structast__cli__args.html#7b8b965ad4bca0e41ab51de7b31363a1">n</a>, 0);
<a name="l01433"></a>01433    }
<a name="l01434"></a>01434    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#212be369d46788be295dbb6516442fee">argc</a> == 1)
<a name="l01435"></a>01435       <span class="keywordflow">return</span> <a class="code" href="cli_8c.html#b32b4e17f86c7b90f20d9cfcc999a92b">help1</a>(a-&gt;<a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a>, NULL, 0);
<a name="l01436"></a>01436 
<a name="l01437"></a>01437    <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;helpers);
<a name="l01438"></a>01438    my_e = <a class="code" href="cli_8c.html#9d007afcc7a56b4dfc5347284219a0e7">find_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a> + 1, 1); <span class="comment">/* try exact match first */</span>
<a name="l01439"></a>01439    <span class="keywordflow">if</span> (!my_e)
<a name="l01440"></a>01440       <span class="keywordflow">return</span> <a class="code" href="cli_8c.html#b32b4e17f86c7b90f20d9cfcc999a92b">help1</a>(a-&gt;<a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a>, a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a> + 1, 1 <span class="comment">/* locked */</span>);
<a name="l01441"></a>01441    <span class="keywordflow">if</span> (my_e-&gt;<a class="code" href="structast__cli__entry.html#9366282e11c151558bdfaab4a264aa1b">usage</a>)
<a name="l01442"></a>01442       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a>, <span class="stringliteral">"%s"</span>, my_e-&gt;<a class="code" href="structast__cli__entry.html#9366282e11c151558bdfaab4a264aa1b">usage</a>);
<a name="l01443"></a>01443    <span class="keywordflow">else</span> {
<a name="l01444"></a>01444       <a class="code" href="utils_8c.html#33e7834c0d3de361f490e1c744011610">ast_join</a>(fullcmd, <span class="keyword">sizeof</span>(fullcmd), a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a>+1);
<a name="l01445"></a>01445       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a>, <span class="stringliteral">"No help text available for '%s'.\n"</span>, fullcmd);
<a name="l01446"></a>01446    }
<a name="l01447"></a>01447    <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;helpers);
<a name="l01448"></a>01448    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l01449"></a>01449 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6eee8b4857c6755de398bd3918c47d38"></a><!-- doxytag: member="cli.c::handle_load" ref="6eee8b4857c6755de398bd3918c47d38" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* handle_load           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00111">111</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8h-source.html#l00138">ast_cli_args::argc</a>, <a class="el" href="cli_8h-source.html#l00189">ast_cli_entry::args</a>, <a class="el" href="cli_8h-source.html#l00139">ast_cli_args::argv</a>, <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="loader_8c-source.html#l00670">ast_load_resource()</a>, <a class="el" href="cli_8h-source.html#l00043">CLI_FAILURE</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d2f4c807e7bc4e767d91adc6ee3e8869e">CLI_GENERATE</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>, <a class="el" href="cli_8h-source.html#l00042">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h-source.html#l00041">CLI_SUCCESS</a>, <a class="el" href="cli_8h-source.html#l00190">ast_cli_entry::command</a>, <a class="el" href="cli_8c-source.html#l00092">complete_fn()</a>, <a class="el" href="cli_8h-source.html#l00137">ast_cli_args::fd</a>, <a class="el" href="cli_8h-source.html#l00143">ast_cli_args::n</a>, <a class="el" href="cli_8h-source.html#l00142">ast_cli_args::pos</a>, <a class="el" href="cli_8h-source.html#l00168">ast_cli_entry::usage</a>, and <a class="el" href="cli_8h-source.html#l00141">ast_cli_args::word</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l00136">handle_load_deprecated()</a>.<div class="fragment"><pre class="fragment"><a name="l00112"></a>00112 {
<a name="l00113"></a>00113    <span class="comment">/* "module load &lt;mod&gt;" */</span>
<a name="l00114"></a>00114    <span class="keywordflow">switch</span> (cmd) {
<a name="l00115"></a>00115    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>:
<a name="l00116"></a>00116       e-&gt;<a class="code" href="structast__cli__entry.html#1dccadfed7bcbb036c56a4afb97e906f">command</a> = <span class="stringliteral">"module load"</span>;
<a name="l00117"></a>00117       e-&gt;<a class="code" href="structast__cli__entry.html#9366282e11c151558bdfaab4a264aa1b">usage</a> =
<a name="l00118"></a>00118          <span class="stringliteral">"Usage: module load &lt;module name&gt;\n"</span>
<a name="l00119"></a>00119          <span class="stringliteral">"       Loads the specified module into Asterisk.\n"</span>;
<a name="l00120"></a>00120       <span class="keywordflow">return</span> NULL;
<a name="l00121"></a>00121 
<a name="l00122"></a>00122    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d2f4c807e7bc4e767d91adc6ee3e8869e">CLI_GENERATE</a>:
<a name="l00123"></a>00123       <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#5e0bdcbddccca4d66d74ba8c1cee1a68">pos</a> != e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>)
<a name="l00124"></a>00124          <span class="keywordflow">return</span> NULL;
<a name="l00125"></a>00125       <span class="keywordflow">return</span> <a class="code" href="cli_8c.html#ba0491f78f8468eb18f46c4a799627e0">complete_fn</a>(a-&gt;<a class="code" href="structast__cli__args.html#c47d187067c6cf953245f128b5fde62a">word</a>, a-&gt;<a class="code" href="structast__cli__args.html#7b8b965ad4bca0e41ab51de7b31363a1">n</a>);
<a name="l00126"></a>00126    }
<a name="l00127"></a>00127    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#212be369d46788be295dbb6516442fee">argc</a> != e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a> + 1)
<a name="l00128"></a>00128       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#8409e2cc535711ab81e051428521a8c6">CLI_SHOWUSAGE</a>;
<a name="l00129"></a>00129    <span class="keywordflow">if</span> (<a class="code" href="loader_8c.html#0b433ec2b68daca76aba804442b86ea0">ast_load_resource</a>(a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a>[e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>])) {
<a name="l00130"></a>00130       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a>, <span class="stringliteral">"Unable to load module %s\n"</span>, a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a>[e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>]);
<a name="l00131"></a>00131       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#3478ef2d2b9cd0c577ca5ef5e22024af">CLI_FAILURE</a>;
<a name="l00132"></a>00132    }
<a name="l00133"></a>00133    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#1feba2188d0c8b5f3bffccacea035b67">CLI_SUCCESS</a>;
<a name="l00134"></a>00134 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="476caeae500e88220908a4aa6fe8d18d"></a><!-- doxytag: member="cli.c::handle_load_deprecated" ref="476caeae500e88220908a4aa6fe8d18d" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* handle_load_deprecated           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00136">136</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>, <a class="el" href="cli_8h-source.html#l00190">ast_cli_entry::command</a>, and <a class="el" href="cli_8c-source.html#l00111">handle_load()</a>.<div class="fragment"><pre class="fragment"><a name="l00137"></a>00137 {
<a name="l00138"></a>00138    <span class="keywordtype">char</span> *res = <a class="code" href="cli_8c.html#6eee8b4857c6755de398bd3918c47d38">handle_load</a>(e, cmd, a);
<a name="l00139"></a>00139    <span class="keywordflow">if</span> (cmd == <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>)
<a name="l00140"></a>00140       e-&gt;<a class="code" href="structast__cli__entry.html#1dccadfed7bcbb036c56a4afb97e906f">command</a> = <span class="stringliteral">"load"</span>;
<a name="l00141"></a>00141    <span class="keywordflow">return</span> res;
<a name="l00142"></a>00142 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="21ab2bb3a92ceb331027f5e0dc4a16db"></a><!-- doxytag: member="cli.c::handle_logger_mute" ref="21ab2bb3a92ceb331027f5e0dc4a16db" args="(int fd, int argc, char *argv[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int handle_logger_mute           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00251">251</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="asterisk_8c-source.html#l00800">ast_console_toggle_mute()</a>, <a class="el" href="cli_8h-source.html#l00038">RESULT_SHOWUSAGE</a>, and <a class="el" href="cli_8h-source.html#l00037">RESULT_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l00252"></a>00252 {
<a name="l00253"></a>00253    <span class="keywordflow">if</span> (argc != 2)
<a name="l00254"></a>00254       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d7f3bcd35c16172e6fc0964a175fcadb">RESULT_SHOWUSAGE</a>;
<a name="l00255"></a>00255    <a class="code" href="asterisk_8c.html#d7c343a21dfa2d2acb22ddc9f890f65b">ast_console_toggle_mute</a>(fd);
<a name="l00256"></a>00256    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l00257"></a>00257 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6d6dab8b514eaacf1bad061fa8658ab4"></a><!-- doxytag: member="cli.c::handle_modlist" ref="6d6dab8b514eaacf1bad061fa8658ab4" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* handle_modlist           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00413">413</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8h-source.html#l00138">ast_cli_args::argc</a>, <a class="el" href="cli_8h-source.html#l00189">ast_cli_entry::args</a>, <a class="el" href="cli_8h-source.html#l00139">ast_cli_args::argv</a>, <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="loader_8c-source.html#l00490">ast_module_helper()</a>, <a class="el" href="lock_8h-source.html#l00530">ast_mutex_lock()</a>, <a class="el" href="lock_8h-source.html#l00520">ast_mutex_unlock()</a>, <a class="el" href="loader_8c-source.html#l00873">ast_update_module_list()</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d2f4c807e7bc4e767d91adc6ee3e8869e">CLI_GENERATE</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>, <a class="el" href="cli_8h-source.html#l00042">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8c-source.html#l00318">climodentryfd</a>, <a class="el" href="cli_8h-source.html#l00190">ast_cli_entry::command</a>, <a class="el" href="cli_8h-source.html#l00137">ast_cli_args::fd</a>, <a class="el" href="cli_8h-source.html#l00140">ast_cli_args::line</a>, <a class="el" href="cli_8c-source.html#l00315">MODLIST_FORMAT2</a>, <a class="el" href="cli_8c-source.html#l00320">modlist_modentry()</a>, <a class="el" href="cli_8h-source.html#l00143">ast_cli_args::n</a>, <a class="el" href="cli_8h-source.html#l00142">ast_cli_args::pos</a>, <a class="el" href="cli_8h-source.html#l00037">RESULT_SUCCESS</a>, <a class="el" href="cli_8h-source.html#l00168">ast_cli_entry::usage</a>, and <a class="el" href="cli_8h-source.html#l00141">ast_cli_args::word</a>.<div class="fragment"><pre class="fragment"><a name="l00414"></a>00414 {
<a name="l00415"></a>00415    <span class="keywordtype">char</span> *like;
<a name="l00416"></a>00416 
<a name="l00417"></a>00417    <span class="keywordflow">switch</span> (cmd) {
<a name="l00418"></a>00418    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>:
<a name="l00419"></a>00419       e-&gt;<a class="code" href="structast__cli__entry.html#1dccadfed7bcbb036c56a4afb97e906f">command</a> = <span class="stringliteral">"module show [like]"</span>;
<a name="l00420"></a>00420       e-&gt;<a class="code" href="structast__cli__entry.html#9366282e11c151558bdfaab4a264aa1b">usage</a> =
<a name="l00421"></a>00421          <span class="stringliteral">"Usage: module show [like keyword]\n"</span>
<a name="l00422"></a>00422          <span class="stringliteral">"       Shows Asterisk modules currently in use, and usage statistics.\n"</span>;
<a name="l00423"></a>00423       <span class="keywordflow">return</span> NULL;
<a name="l00424"></a>00424 
<a name="l00425"></a>00425    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d2f4c807e7bc4e767d91adc6ee3e8869e">CLI_GENERATE</a>:
<a name="l00426"></a>00426       <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#5e0bdcbddccca4d66d74ba8c1cee1a68">pos</a> == e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>)
<a name="l00427"></a>00427          <span class="keywordflow">return</span> <a class="code" href="loader_8c.html#35dec328d257abc218594c71f6ee2855">ast_module_helper</a>(a-&gt;<a class="code" href="structast__cli__args.html#6438c669e0d0de98e6929c2cc0fac474">line</a>, a-&gt;<a class="code" href="structast__cli__args.html#c47d187067c6cf953245f128b5fde62a">word</a>, a-&gt;<a class="code" href="structast__cli__args.html#5e0bdcbddccca4d66d74ba8c1cee1a68">pos</a>, a-&gt;<a class="code" href="structast__cli__args.html#7b8b965ad4bca0e41ab51de7b31363a1">n</a>, a-&gt;<a class="code" href="structast__cli__args.html#5e0bdcbddccca4d66d74ba8c1cee1a68">pos</a>, 0);
<a name="l00428"></a>00428       <span class="keywordflow">else</span>
<a name="l00429"></a>00429          <span class="keywordflow">return</span> NULL;
<a name="l00430"></a>00430    }
<a name="l00431"></a>00431    <span class="comment">/* all the above return, so we proceed with the handler.</span>
<a name="l00432"></a>00432 <span class="comment">    * we are guaranteed to have argc &gt;= e-&gt;args</span>
<a name="l00433"></a>00433 <span class="comment">    */</span>
<a name="l00434"></a>00434    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#212be369d46788be295dbb6516442fee">argc</a> == e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a> - 1)
<a name="l00435"></a>00435       like = <span class="stringliteral">""</span>;
<a name="l00436"></a>00436    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#212be369d46788be295dbb6516442fee">argc</a> == e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a> + 1 &amp;&amp; !strcasecmp(a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a>[e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>-1], <span class="stringliteral">"like"</span>) )
<a name="l00437"></a>00437       like = a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a>[e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>];
<a name="l00438"></a>00438    <span class="keywordflow">else</span>
<a name="l00439"></a>00439       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#8409e2cc535711ab81e051428521a8c6">CLI_SHOWUSAGE</a>;
<a name="l00440"></a>00440       
<a name="l00441"></a>00441    <a class="code" href="lock_8h.html#b3c5e3093b325167f88db93c8b4b2421">ast_mutex_lock</a>(&amp;climodentrylock);
<a name="l00442"></a>00442    <a class="code" href="cli_8c.html#ade24f5837e1c073d2e7cfc2adc4073c">climodentryfd</a> = a-&gt;<a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a>; <span class="comment">/* global, protected by climodentrylock */</span>
<a name="l00443"></a>00443    <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a>, <a class="code" href="cli_8c.html#8bcd477fc94018c598cd2031822e8baf">MODLIST_FORMAT2</a>, <span class="stringliteral">"Module"</span>, <span class="stringliteral">"Description"</span>, <span class="stringliteral">"Use Count"</span>);
<a name="l00444"></a>00444    <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a>,<span class="stringliteral">"%d modules loaded\n"</span>, <a class="code" href="loader_8c.html#ce0d5fddcce98cb7d051a4058f20030e">ast_update_module_list</a>(<a class="code" href="cli_8c.html#5f26fe7300ef7f1b5efee53cc95830ad">modlist_modentry</a>, like));
<a name="l00445"></a>00445    <a class="code" href="cli_8c.html#ade24f5837e1c073d2e7cfc2adc4073c">climodentryfd</a> = -1;
<a name="l00446"></a>00446    <a class="code" href="lock_8h.html#1d33e3caf152f0901c5ebdb69c2d4d26">ast_mutex_unlock</a>(&amp;climodentrylock);
<a name="l00447"></a>00447    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l00448"></a>00448 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="27e2983e2b6b4fe55cff4f49bcc88412"></a><!-- doxytag: member="cli.c::handle_nodebugchan_deprecated" ref="27e2983e2b6b4fe55cff4f49bcc88412" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* handle_nodebugchan_deprecated           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00752">752</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8h-source.html#l00138">ast_cli_args::argc</a>, <a class="el" href="cli_8h-source.html#l00189">ast_cli_entry::args</a>, <a class="el" href="cli_8h-source.html#l00139">ast_cli_args::argv</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d380457cd644023f5d9c2553c0248aeb1">CLI_HANDLER</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>, <a class="el" href="cli_8h-source.html#l00042">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h-source.html#l00190">ast_cli_entry::command</a>, and <a class="el" href="cli_8c-source.html#l00677">handle_core_set_debug_channel()</a>.<div class="fragment"><pre class="fragment"><a name="l00753"></a>00753 {
<a name="l00754"></a>00754    <span class="keywordtype">char</span> *res;
<a name="l00755"></a>00755    <span class="keywordflow">if</span> (cmd == <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d380457cd644023f5d9c2553c0248aeb1">CLI_HANDLER</a>) {
<a name="l00756"></a>00756       <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#212be369d46788be295dbb6516442fee">argc</a> != e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a> + 1)
<a name="l00757"></a>00757          <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#8409e2cc535711ab81e051428521a8c6">CLI_SHOWUSAGE</a>;
<a name="l00758"></a>00758       <span class="comment">/* pretend we have an extra "off" at the end. We can do this as the array</span>
<a name="l00759"></a>00759 <span class="comment">       * is NULL terminated so we overwrite that entry.</span>
<a name="l00760"></a>00760 <span class="comment">       */</span>
<a name="l00761"></a>00761       a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a>[e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>+1] = <span class="stringliteral">"off"</span>;
<a name="l00762"></a>00762       a-&gt;<a class="code" href="structast__cli__args.html#212be369d46788be295dbb6516442fee">argc</a>++;
<a name="l00763"></a>00763    }
<a name="l00764"></a>00764    res = <a class="code" href="cli_8c.html#b8d4ee33a1af5803a686d86778c813a1">handle_core_set_debug_channel</a>(e, cmd, a);
<a name="l00765"></a>00765    <span class="keywordflow">if</span> (cmd == <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>)
<a name="l00766"></a>00766       e-&gt;<a class="code" href="structast__cli__entry.html#1dccadfed7bcbb036c56a4afb97e906f">command</a> = <span class="stringliteral">"no debug channel"</span>;
<a name="l00767"></a>00767    <span class="keywordflow">return</span> res;
<a name="l00768"></a>00768 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b99f0d124404a1fc4444763b26b6eabe"></a><!-- doxytag: member="cli.c::handle_reload" ref="b99f0d124404a1fc4444763b26b6eabe" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* handle_reload           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00144">144</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8h-source.html#l00138">ast_cli_args::argc</a>, <a class="el" href="cli_8h-source.html#l00189">ast_cli_entry::args</a>, <a class="el" href="cli_8h-source.html#l00139">ast_cli_args::argv</a>, <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="loader_8c-source.html#l00490">ast_module_helper()</a>, <a class="el" href="loader_8c-source.html#l00520">ast_module_reload()</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d2f4c807e7bc4e767d91adc6ee3e8869e">CLI_GENERATE</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>, <a class="el" href="cli_8h-source.html#l00041">CLI_SUCCESS</a>, <a class="el" href="cli_8h-source.html#l00190">ast_cli_entry::command</a>, <a class="el" href="cli_8h-source.html#l00137">ast_cli_args::fd</a>, <a class="el" href="cli_8h-source.html#l00140">ast_cli_args::line</a>, <a class="el" href="cli_8h-source.html#l00143">ast_cli_args::n</a>, <a class="el" href="cli_8h-source.html#l00142">ast_cli_args::pos</a>, <a class="el" href="cli_8h-source.html#l00168">ast_cli_entry::usage</a>, and <a class="el" href="cli_8h-source.html#l00141">ast_cli_args::word</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l00179">handle_reload_deprecated()</a>.<div class="fragment"><pre class="fragment"><a name="l00145"></a>00145 {
<a name="l00146"></a>00146    <span class="keywordtype">int</span> x;
<a name="l00147"></a>00147 
<a name="l00148"></a>00148    <span class="keywordflow">switch</span> (cmd) {
<a name="l00149"></a>00149    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>:
<a name="l00150"></a>00150       e-&gt;<a class="code" href="structast__cli__entry.html#1dccadfed7bcbb036c56a4afb97e906f">command</a> = <span class="stringliteral">"module reload"</span>;
<a name="l00151"></a>00151       e-&gt;<a class="code" href="structast__cli__entry.html#9366282e11c151558bdfaab4a264aa1b">usage</a> =
<a name="l00152"></a>00152          <span class="stringliteral">"Usage: module reload [module ...]\n"</span>
<a name="l00153"></a>00153          <span class="stringliteral">"       Reloads configuration files for all listed modules which support\n"</span>
<a name="l00154"></a>00154          <span class="stringliteral">"       reloading, or for all supported modules if none are listed.\n"</span>;
<a name="l00155"></a>00155       <span class="keywordflow">return</span> NULL;
<a name="l00156"></a>00156 
<a name="l00157"></a>00157    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d2f4c807e7bc4e767d91adc6ee3e8869e">CLI_GENERATE</a>:
<a name="l00158"></a>00158       <span class="keywordflow">return</span> <a class="code" href="loader_8c.html#35dec328d257abc218594c71f6ee2855">ast_module_helper</a>(a-&gt;<a class="code" href="structast__cli__args.html#6438c669e0d0de98e6929c2cc0fac474">line</a>, a-&gt;<a class="code" href="structast__cli__args.html#c47d187067c6cf953245f128b5fde62a">word</a>, a-&gt;<a class="code" href="structast__cli__args.html#5e0bdcbddccca4d66d74ba8c1cee1a68">pos</a>, a-&gt;<a class="code" href="structast__cli__args.html#7b8b965ad4bca0e41ab51de7b31363a1">n</a>, a-&gt;<a class="code" href="structast__cli__args.html#5e0bdcbddccca4d66d74ba8c1cee1a68">pos</a>, 1);
<a name="l00159"></a>00159    }
<a name="l00160"></a>00160    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#212be369d46788be295dbb6516442fee">argc</a> == e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>) {
<a name="l00161"></a>00161       <a class="code" href="loader_8c.html#12479ce54a93d95bd3c845793c3c0f19">ast_module_reload</a>(NULL);
<a name="l00162"></a>00162       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#1feba2188d0c8b5f3bffccacea035b67">CLI_SUCCESS</a>;
<a name="l00163"></a>00163    }
<a name="l00164"></a>00164    <span class="keywordflow">for</span> (x = e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>; x &lt; a-&gt;argc; x++) {
<a name="l00165"></a>00165       <span class="keywordtype">int</span> res = <a class="code" href="loader_8c.html#12479ce54a93d95bd3c845793c3c0f19">ast_module_reload</a>(a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a>[x]);
<a name="l00166"></a>00166       <span class="comment">/* XXX reload has multiple error returns, including -1 on error and 2 on success */</span>
<a name="l00167"></a>00167       <span class="keywordflow">switch</span> (res) {
<a name="l00168"></a>00168       <span class="keywordflow">case</span> 0:
<a name="l00169"></a>00169          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a>, <span class="stringliteral">"No such module '%s'\n"</span>, a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a>[x]);
<a name="l00170"></a>00170          <span class="keywordflow">break</span>;
<a name="l00171"></a>00171       <span class="keywordflow">case</span> 1:
<a name="l00172"></a>00172          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a>, <span class="stringliteral">"Module '%s' does not support reload\n"</span>, a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a>[x]);
<a name="l00173"></a>00173          <span class="keywordflow">break</span>;
<a name="l00174"></a>00174       }
<a name="l00175"></a>00175    }
<a name="l00176"></a>00176    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#1feba2188d0c8b5f3bffccacea035b67">CLI_SUCCESS</a>;
<a name="l00177"></a>00177 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="5c30d597c38a199b1268c519e65db1a6"></a><!-- doxytag: member="cli.c::handle_reload_deprecated" ref="5c30d597c38a199b1268c519e65db1a6" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* handle_reload_deprecated           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00179">179</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>, <a class="el" href="cli_8h-source.html#l00190">ast_cli_entry::command</a>, <a class="el" href="cli_8c-source.html#l00144">handle_reload()</a>, and <a class="el" href="aesopt_8h-source.html#l00399">s</a>.<div class="fragment"><pre class="fragment"><a name="l00180"></a>00180 {
<a name="l00181"></a>00181    <span class="keywordtype">char</span> *<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a> = <a class="code" href="cli_8c.html#b99f0d124404a1fc4444763b26b6eabe">handle_reload</a>(e, cmd, a);
<a name="l00182"></a>00182    <span class="keywordflow">if</span> (cmd == <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>)    <span class="comment">/* override command name */</span>
<a name="l00183"></a>00183       e-&gt;<a class="code" href="structast__cli__entry.html#1dccadfed7bcbb036c56a4afb97e906f">command</a> = <span class="stringliteral">"reload"</span>;
<a name="l00184"></a>00184    <span class="keywordflow">return</span> s;
<a name="l00185"></a>00185 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="9ce379bd32f9c4c32de954569e8d3989"></a><!-- doxytag: member="cli.c::handle_showchan" ref="9ce379bd32f9c4c32de954569e8d3989" args="(int fd, int argc, char *argv[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int handle_showchan           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00770">770</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00409">ast_channel::_bridge</a>, <a class="el" href="channel_8h-source.html#l00435">ast_channel::_state</a>, <a class="el" href="channel_8c-source.html#l03754">ast_bridged_channel()</a>, <a class="el" href="cdr_8c-source.html#l00363">ast_cdr_serialize_variables()</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>, <a class="el" href="channel_8c-source.html#l00995">ast_get_channel_by_name_locked()</a>, <a class="el" href="frame_8c-source.html#l00545">ast_getformatname_multiple()</a>, <a class="el" href="channel_8c-source.html#l00523">ast_state2str()</a>, <a class="el" href="strings_8h.html#15892382538fcffb4bd4216c8956c428">ast_str_alloca</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, <a class="el" href="channel_8h-source.html#l00437">ast_channel::cid</a>, <a class="el" href="channel_8h-source.html#l00211">ast_callerid::cid_dnid</a>, <a class="el" href="channel_8h-source.html#l00213">ast_callerid::cid_name</a>, <a class="el" href="channel_8h-source.html#l00212">ast_callerid::cid_num</a>, <a class="el" href="channel_8h-source.html#l00327">DEBUGCHAN_FLAG</a>, <a class="el" href="channel_8h-source.html#l00400">ast_channel::fds</a>, <a class="el" href="channel_8h-source.html#l00462">ast_channel::fin</a>, <a class="el" href="channel_8h-source.html#l00464">ast_channel::fout</a>, <a class="el" href="callerid_8c-source.html#l01043">name</a>, <a class="el" href="channel_8h-source.html#l00476">ast_channel::nativeformats</a>, <a class="el" href="pbx_8c-source.html#l05734">pbx_builtin_serialize_variables()</a>, <a class="el" href="channel_8h-source.html#l00477">ast_channel::readformat</a>, <a class="el" href="channel_8h-source.html#l00480">ast_channel::readtrans</a>, <a class="el" href="cli_8h-source.html#l00038">RESULT_SHOWUSAGE</a>, <a class="el" href="cli_8h-source.html#l00037">RESULT_SUCCESS</a>, <a class="el" href="channel_8h-source.html#l00436">ast_channel::rings</a>, <a class="el" href="strings_8h-source.html#l00045">S_OR</a>, <a class="el" href="adsistub_8c-source.html#l00055">sec</a>, <a class="el" href="cdr_8h-source.html#l00070">ast_cdr::start</a>, <a class="el" href="strings_8h-source.html#l00319">ast_str::str</a>, <a class="el" href="channel_8h-source.html#l00385">ast_channel::tech</a>, <a class="el" href="channel_8h-source.html#l00235">ast_channel_tech::type</a>, <a class="el" href="channel_8h-source.html#l00416">ast_channel::whentohangup</a>, <a class="el" href="channel_8h-source.html#l00478">ast_channel::writeformat</a>, and <a class="el" href="channel_8h-source.html#l00479">ast_channel::writetrans</a>.<div class="fragment"><pre class="fragment"><a name="l00771"></a>00771 {
<a name="l00772"></a>00772    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *c=NULL;
<a name="l00773"></a>00773    <span class="keyword">struct </span>timeval now;
<a name="l00774"></a>00774    <span class="keyword">struct </span><a class="code" href="structast__str.html">ast_str</a> *out = <a class="code" href="strings_8h.html#15892382538fcffb4bd4216c8956c428">ast_str_alloca</a>(2048);
<a name="l00775"></a>00775    <span class="keywordtype">char</span> cdrtime[256];
<a name="l00776"></a>00776    <span class="keywordtype">char</span> nf[256], wf[256], rf[256];
<a name="l00777"></a>00777    <span class="keywordtype">long</span> elapsed_seconds=0;
<a name="l00778"></a>00778    <span class="keywordtype">int</span> hour=0, min=0, <a class="code" href="adsistub_8c.html#74459ca3cf85a81df90da95ff6e7a207">sec</a>=0;
<a name="l00779"></a>00779    
<a name="l00780"></a>00780    <span class="keywordflow">if</span> (argc != 4)
<a name="l00781"></a>00781       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d7f3bcd35c16172e6fc0964a175fcadb">RESULT_SHOWUSAGE</a>;
<a name="l00782"></a>00782    now = ast_tvnow();
<a name="l00783"></a>00783    c = <a class="code" href="channel_8c.html#e01fecb172f34785571d94adbc5c6558">ast_get_channel_by_name_locked</a>(argv[3]);
<a name="l00784"></a>00784    <span class="keywordflow">if</span> (!c) {
<a name="l00785"></a>00785       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"%s is not a known channel\n"</span>, argv[3]);
<a name="l00786"></a>00786       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l00787"></a>00787    }
<a name="l00788"></a>00788    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>) {
<a name="l00789"></a>00789       elapsed_seconds = now.tv_sec - c-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a>.tv_sec;
<a name="l00790"></a>00790       hour = elapsed_seconds / 3600;
<a name="l00791"></a>00791       min = (elapsed_seconds % 3600) / 60;
<a name="l00792"></a>00792       <a class="code" href="adsistub_8c.html#74459ca3cf85a81df90da95ff6e7a207">sec</a> = elapsed_seconds % 60;
<a name="l00793"></a>00793       snprintf(cdrtime, <span class="keyword">sizeof</span>(cdrtime), <span class="stringliteral">"%dh%dm%ds"</span>, hour, min, <a class="code" href="adsistub_8c.html#74459ca3cf85a81df90da95ff6e7a207">sec</a>);
<a name="l00794"></a>00794    } <span class="keywordflow">else</span>
<a name="l00795"></a>00795       strcpy(cdrtime, <span class="stringliteral">"N/A"</span>);
<a name="l00796"></a>00796    <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, 
<a name="l00797"></a>00797       <span class="stringliteral">" -- General --\n"</span>
<a name="l00798"></a>00798       <span class="stringliteral">"           Name: %s\n"</span>
<a name="l00799"></a>00799       <span class="stringliteral">"           Type: %s\n"</span>
<a name="l00800"></a>00800       <span class="stringliteral">"       UniqueID: %s\n"</span>
<a name="l00801"></a>00801       <span class="stringliteral">"      Caller ID: %s\n"</span>
<a name="l00802"></a>00802       <span class="stringliteral">" Caller ID Name: %s\n"</span>
<a name="l00803"></a>00803       <span class="stringliteral">"    DNID Digits: %s\n"</span>
<a name="l00804"></a>00804       <span class="stringliteral">"       Language: %s\n"</span>
<a name="l00805"></a>00805       <span class="stringliteral">"          State: %s (%d)\n"</span>
<a name="l00806"></a>00806       <span class="stringliteral">"          Rings: %d\n"</span>
<a name="l00807"></a>00807       <span class="stringliteral">"  NativeFormats: %s\n"</span>
<a name="l00808"></a>00808       <span class="stringliteral">"    WriteFormat: %s\n"</span>
<a name="l00809"></a>00809       <span class="stringliteral">"     ReadFormat: %s\n"</span>
<a name="l00810"></a>00810       <span class="stringliteral">" WriteTranscode: %s\n"</span>
<a name="l00811"></a>00811       <span class="stringliteral">"  ReadTranscode: %s\n"</span>
<a name="l00812"></a>00812       <span class="stringliteral">"1st File Descriptor: %d\n"</span>
<a name="l00813"></a>00813       <span class="stringliteral">"      Frames in: %d%s\n"</span>
<a name="l00814"></a>00814       <span class="stringliteral">"     Frames out: %d%s\n"</span>
<a name="l00815"></a>00815       <span class="stringliteral">" Time to Hangup: %ld\n"</span>
<a name="l00816"></a>00816       <span class="stringliteral">"   Elapsed Time: %s\n"</span>
<a name="l00817"></a>00817       <span class="stringliteral">"  Direct Bridge: %s\n"</span>
<a name="l00818"></a>00818       <span class="stringliteral">"Indirect Bridge: %s\n"</span>
<a name="l00819"></a>00819       <span class="stringliteral">" --   PBX   --\n"</span>
<a name="l00820"></a>00820       <span class="stringliteral">"        Context: %s\n"</span>
<a name="l00821"></a>00821       <span class="stringliteral">"      Extension: %s\n"</span>
<a name="l00822"></a>00822       <span class="stringliteral">"       Priority: %d\n"</span>
<a name="l00823"></a>00823       <span class="stringliteral">"     Call Group: %llu\n"</span>
<a name="l00824"></a>00824       <span class="stringliteral">"   Pickup Group: %llu\n"</span>
<a name="l00825"></a>00825       <span class="stringliteral">"    Application: %s\n"</span>
<a name="l00826"></a>00826       <span class="stringliteral">"           Data: %s\n"</span>
<a name="l00827"></a>00827       <span class="stringliteral">"    Blocking in: %s\n"</span>,
<a name="l00828"></a>00828       c-&gt;name, c-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, c-&gt;uniqueid,
<a name="l00829"></a>00829       <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>, <span class="stringliteral">"(N/A)"</span>),
<a name="l00830"></a>00830       <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#51ae63e8ccffb05b130f96cc397ec7b0">cid_name</a>, <span class="stringliteral">"(N/A)"</span>),
<a name="l00831"></a>00831       <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#24ebe3d1b8eb2a6c8e3511a7a1461b75">cid_dnid</a>, <span class="stringliteral">"(N/A)"</span>), 
<a name="l00832"></a>00832       c-&gt;language,   
<a name="l00833"></a>00833       <a class="code" href="channel_8c.html#1c242fd13329f5600ccd56263aba7272">ast_state2str</a>(c-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a>), c-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a>, c-&gt;<a class="code" href="structast__channel.html#02a1b872de47268c813e94c41476f927">rings</a>, 
<a name="l00834"></a>00834       <a class="code" href="frame_8c.html#98f2e5f4c4b2d13cb63057889cc0b743">ast_getformatname_multiple</a>(nf, <span class="keyword">sizeof</span>(nf), c-&gt;<a class="code" href="structast__channel.html#adbc0bbfec600539582f92b30ed1ecd7">nativeformats</a>), 
<a name="l00835"></a>00835       <a class="code" href="frame_8c.html#98f2e5f4c4b2d13cb63057889cc0b743">ast_getformatname_multiple</a>(wf, <span class="keyword">sizeof</span>(wf), c-&gt;<a class="code" href="structast__channel.html#45a38ca474a4f1df88fe13d68bbb0b44">writeformat</a>), 
<a name="l00836"></a>00836       <a class="code" href="frame_8c.html#98f2e5f4c4b2d13cb63057889cc0b743">ast_getformatname_multiple</a>(rf, <span class="keyword">sizeof</span>(rf), c-&gt;<a class="code" href="structast__channel.html#c9d2702466074da94d21f26822247ed8">readformat</a>),
<a name="l00837"></a>00837       c-&gt;<a class="code" href="structast__channel.html#539a57bca8693e9a17639bc306123548">writetrans</a> ? <span class="stringliteral">"Yes"</span> : <span class="stringliteral">"No"</span>,
<a name="l00838"></a>00838       c-&gt;<a class="code" href="structast__channel.html#2c3e2372b54538a2ddf46c00fd6a0f8b">readtrans</a> ? <span class="stringliteral">"Yes"</span> : <span class="stringliteral">"No"</span>,
<a name="l00839"></a>00839       c-&gt;<a class="code" href="structast__channel.html#33e8e7d77d33bb6375690c9b23527f82">fds</a>[0],
<a name="l00840"></a>00840       c-&gt;<a class="code" href="structast__channel.html#d79695776a5b40f7cadbee1f91a85c82">fin</a> &amp; ~<a class="code" href="channel_8h.html#121c28674a9262e968ca5860c9f3e511">DEBUGCHAN_FLAG</a>, (c-&gt;<a class="code" href="structast__channel.html#d79695776a5b40f7cadbee1f91a85c82">fin</a> &amp; <a class="code" href="channel_8h.html#121c28674a9262e968ca5860c9f3e511">DEBUGCHAN_FLAG</a>) ? <span class="stringliteral">" (DEBUGGED)"</span> : <span class="stringliteral">""</span>,
<a name="l00841"></a>00841       c-&gt;<a class="code" href="structast__channel.html#048e72dbb3bdc2353732740741a72fe4">fout</a> &amp; ~<a class="code" href="channel_8h.html#121c28674a9262e968ca5860c9f3e511">DEBUGCHAN_FLAG</a>, (c-&gt;<a class="code" href="structast__channel.html#048e72dbb3bdc2353732740741a72fe4">fout</a> &amp; <a class="code" href="channel_8h.html#121c28674a9262e968ca5860c9f3e511">DEBUGCHAN_FLAG</a>) ? <span class="stringliteral">" (DEBUGGED)"</span> : <span class="stringliteral">""</span>,
<a name="l00842"></a>00842       (<span class="keywordtype">long</span>)c-&gt;<a class="code" href="structast__channel.html#1272db9c0584f07eb3c6bae4e21fc7c8">whentohangup</a>,
<a name="l00843"></a>00843       cdrtime, c-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a> ? c-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a>-&gt;name : <span class="stringliteral">"&lt;none&gt;"</span>, <a class="code" href="channel_8c.html#8f80b59690710acfe4fc82cfcbbf9ee9">ast_bridged_channel</a>(c) ? <a class="code" href="channel_8c.html#8f80b59690710acfe4fc82cfcbbf9ee9">ast_bridged_channel</a>(c)-&gt;<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a> : <span class="stringliteral">"&lt;none&gt;"</span>, 
<a name="l00844"></a>00844       c-&gt;context, c-&gt;exten, c-&gt;priority, c-&gt;callgroup, c-&gt;pickupgroup, ( c-&gt;appl ? c-&gt;appl : <span class="stringliteral">"(N/A)"</span> ),
<a name="l00845"></a>00845       ( c-&gt; data ? <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(c-&gt;data, <span class="stringliteral">"(Empty)"</span>) : <span class="stringliteral">"(None)"</span>),
<a name="l00846"></a>00846       (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(c, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>) ? c-&gt;blockproc : <span class="stringliteral">"(Not Blocking)"</span>));
<a name="l00847"></a>00847    
<a name="l00848"></a>00848    <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#54b5d868be87581f886aee1b5fed126a">pbx_builtin_serialize_variables</a>(c, &amp;out))
<a name="l00849"></a>00849       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd,<span class="stringliteral">"      Variables:\n%s\n"</span>, out-&gt;<a class="code" href="structast__str.html#3929b4348d8e5ee862fd1e38834d0217">str</a>);
<a name="l00850"></a>00850    <span class="keywordflow">if</span> (c-&gt;cdr &amp;&amp; <a class="code" href="cdr_8c.html#012c9aed35828d7a2bd4581c29da37e2">ast_cdr_serialize_variables</a>(c-&gt;cdr, &amp;out, <span class="charliteral">'='</span>, <span class="charliteral">'\n'</span>, 1))
<a name="l00851"></a>00851       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd,<span class="stringliteral">"  CDR Variables:\n%s\n"</span>, out-&gt;<a class="code" href="structast__str.html#3929b4348d8e5ee862fd1e38834d0217">str</a>);
<a name="l00852"></a>00852    
<a name="l00853"></a>00853    <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(c);
<a name="l00854"></a>00854    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l00855"></a>00855 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a0e77a1fd57f96117b888e8f1f020437"></a><!-- doxytag: member="cli.c::handle_showuptime" ref="a0e77a1fd57f96117b888e8f1f020437" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* handle_showuptime           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00381">381</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8h-source.html#l00138">ast_cli_args::argc</a>, <a class="el" href="cli_8h-source.html#l00189">ast_cli_entry::args</a>, <a class="el" href="cli_8h-source.html#l00139">ast_cli_args::argv</a>, <a class="el" href="asterisk_8c-source.html#l00196">ast_lastreloadtime</a>, <a class="el" href="asterisk_8c-source.html#l00195">ast_startuptime</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d2f4c807e7bc4e767d91adc6ee3e8869e">CLI_GENERATE</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>, <a class="el" href="cli_8h-source.html#l00042">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h-source.html#l00041">CLI_SUCCESS</a>, <a class="el" href="cli_8h-source.html#l00190">ast_cli_entry::command</a>, <a class="el" href="cli_8h-source.html#l00137">ast_cli_args::fd</a>, <a class="el" href="cli_8h-source.html#l00143">ast_cli_args::n</a>, <a class="el" href="cli_8h-source.html#l00142">ast_cli_args::pos</a>, <a class="el" href="cli_8c-source.html#l00330">print_uptimestr()</a>, and <a class="el" href="cli_8h-source.html#l00168">ast_cli_entry::usage</a>.<div class="fragment"><pre class="fragment"><a name="l00382"></a>00382 {
<a name="l00383"></a>00383    time_t curtime;
<a name="l00384"></a>00384    <span class="keywordtype">int</span> printsec;
<a name="l00385"></a>00385 
<a name="l00386"></a>00386    <span class="keywordflow">switch</span> (cmd) {
<a name="l00387"></a>00387         <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>:
<a name="l00388"></a>00388       e-&gt;<a class="code" href="structast__cli__entry.html#1dccadfed7bcbb036c56a4afb97e906f">command</a> = <span class="stringliteral">"core show uptime"</span>;
<a name="l00389"></a>00389       e-&gt;<a class="code" href="structast__cli__entry.html#9366282e11c151558bdfaab4a264aa1b">usage</a> =
<a name="l00390"></a>00390          <span class="stringliteral">"Usage: core show uptime [seconds]\n"</span>
<a name="l00391"></a>00391          <span class="stringliteral">"       Shows Asterisk uptime information.\n"</span>
<a name="l00392"></a>00392          <span class="stringliteral">"       The seconds word returns the uptime in seconds only.\n"</span>;
<a name="l00393"></a>00393       <span class="keywordflow">return</span> NULL;
<a name="l00394"></a>00394 
<a name="l00395"></a>00395    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d2f4c807e7bc4e767d91adc6ee3e8869e">CLI_GENERATE</a>:
<a name="l00396"></a>00396       <span class="keywordflow">return</span> (a-&gt;<a class="code" href="structast__cli__args.html#5e0bdcbddccca4d66d74ba8c1cee1a68">pos</a> &gt; e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a> || a-&gt;<a class="code" href="structast__cli__args.html#7b8b965ad4bca0e41ab51de7b31363a1">n</a> &gt; 0) ? NULL : <span class="stringliteral">"seconds"</span>;
<a name="l00397"></a>00397    }
<a name="l00398"></a>00398    <span class="comment">/* regular handler */</span>
<a name="l00399"></a>00399    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#212be369d46788be295dbb6516442fee">argc</a> == e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>+1 &amp;&amp; !strcasecmp(a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a>[e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>],<span class="stringliteral">"seconds"</span>))
<a name="l00400"></a>00400       printsec = 1;
<a name="l00401"></a>00401    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#212be369d46788be295dbb6516442fee">argc</a> == e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>)
<a name="l00402"></a>00402       printsec = 0;
<a name="l00403"></a>00403    <span class="keywordflow">else</span>
<a name="l00404"></a>00404       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#8409e2cc535711ab81e051428521a8c6">CLI_SHOWUSAGE</a>;
<a name="l00405"></a>00405    curtime = time(NULL);
<a name="l00406"></a>00406    <span class="keywordflow">if</span> (<a class="code" href="asterisk_8c.html#023ce0372dc9226210dc61a0dbbee466">ast_startuptime</a>)
<a name="l00407"></a>00407       <a class="code" href="cli_8c.html#abe9a7303debc41079df1e6c87be3401">print_uptimestr</a>(a-&gt;<a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a>, curtime - <a class="code" href="asterisk_8c.html#023ce0372dc9226210dc61a0dbbee466">ast_startuptime</a>, <span class="stringliteral">"System uptime"</span>, printsec);
<a name="l00408"></a>00408    <span class="keywordflow">if</span> (<a class="code" href="asterisk_8c.html#e6ff0fa0781fd6b2cfaac6462595ff78">ast_lastreloadtime</a>)
<a name="l00409"></a>00409       <a class="code" href="cli_8c.html#abe9a7303debc41079df1e6c87be3401">print_uptimestr</a>(a-&gt;<a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a>, curtime - <a class="code" href="asterisk_8c.html#e6ff0fa0781fd6b2cfaac6462595ff78">ast_lastreloadtime</a>, <span class="stringliteral">"Last reload"</span>, printsec);
<a name="l00410"></a>00410    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#1feba2188d0c8b5f3bffccacea035b67">CLI_SUCCESS</a>;
<a name="l00411"></a>00411 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8bc688c53d73b1057a6b9146861c6479"></a><!-- doxytag: member="cli.c::handle_softhangup" ref="8bc688c53d73b1057a6b9146861c6479" args="(int fd, int argc, char *argv[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int handle_softhangup           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00588">588</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="channel_8c-source.html#l00995">ast_get_channel_by_name_locked()</a>, <a class="el" href="channel_8c-source.html#l01456">ast_softhangup()</a>, <a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1fe8eae384d045bee039ff9140421beb8">AST_SOFTHANGUP_EXPLICIT</a>, <a class="el" href="cli_8h-source.html#l00038">RESULT_SHOWUSAGE</a>, and <a class="el" href="cli_8h-source.html#l00037">RESULT_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l00589"></a>00589 {
<a name="l00590"></a>00590    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *c=NULL;
<a name="l00591"></a>00591    <span class="keywordflow">if</span> (argc != 3)
<a name="l00592"></a>00592       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d7f3bcd35c16172e6fc0964a175fcadb">RESULT_SHOWUSAGE</a>;
<a name="l00593"></a>00593    c = <a class="code" href="channel_8c.html#e01fecb172f34785571d94adbc5c6558">ast_get_channel_by_name_locked</a>(argv[2]);
<a name="l00594"></a>00594    <span class="keywordflow">if</span> (c) {
<a name="l00595"></a>00595       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"Requested Hangup on channel '%s'\n"</span>, c-&gt;name);
<a name="l00596"></a>00596       <a class="code" href="channel_8c.html#a1a142039194e9f6dfb632b28a0c5eb5">ast_softhangup</a>(c, <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1fe8eae384d045bee039ff9140421beb8">AST_SOFTHANGUP_EXPLICIT</a>);
<a name="l00597"></a>00597       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(c);
<a name="l00598"></a>00598    } <span class="keywordflow">else</span>
<a name="l00599"></a>00599       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"%s is not a known channel\n"</span>, argv[2]);
<a name="l00600"></a>00600    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l00601"></a>00601 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3a5584424a010c12b96b841410370e2c"></a><!-- doxytag: member="cli.c::handle_unload" ref="3a5584424a010c12b96b841410370e2c" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* handle_unload           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00259">259</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8h-source.html#l00138">ast_cli_args::argc</a>, <a class="el" href="cli_8h-source.html#l00189">ast_cli_entry::args</a>, <a class="el" href="cli_8h-source.html#l00139">ast_cli_args::argv</a>, <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="module_8h.html#7f8992121648ba013497a678ccaa6269bbebb65eda949b35cc897af469927afb">AST_FORCE_FIRM</a>, <a class="el" href="module_8h.html#7f8992121648ba013497a678ccaa6269aaaa4d6677842cb350fa742106d7eb46">AST_FORCE_HARD</a>, <a class="el" href="module_8h.html#7f8992121648ba013497a678ccaa62699562c97b424aad17b52e51a3a948315f">AST_FORCE_SOFT</a>, <a class="el" href="loader_8c-source.html#l00490">ast_module_helper()</a>, <a class="el" href="loader_8c-source.html#l00431">ast_unload_resource()</a>, <a class="el" href="cli_8h-source.html#l00043">CLI_FAILURE</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d2f4c807e7bc4e767d91adc6ee3e8869e">CLI_GENERATE</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>, <a class="el" href="cli_8h-source.html#l00042">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h-source.html#l00041">CLI_SUCCESS</a>, <a class="el" href="cli_8h-source.html#l00190">ast_cli_entry::command</a>, <a class="el" href="cli_8h-source.html#l00137">ast_cli_args::fd</a>, <a class="el" href="cli_8h-source.html#l00140">ast_cli_args::line</a>, <a class="el" href="cli_8h-source.html#l00143">ast_cli_args::n</a>, <a class="el" href="cli_8h-source.html#l00142">ast_cli_args::pos</a>, <a class="el" href="aesopt_8h-source.html#l00399">s</a>, <a class="el" href="cli_8h-source.html#l00168">ast_cli_entry::usage</a>, and <a class="el" href="cli_8h-source.html#l00141">ast_cli_args::word</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l00306">handle_unload_deprecated()</a>.<div class="fragment"><pre class="fragment"><a name="l00260"></a>00260 {
<a name="l00261"></a>00261    <span class="comment">/* "module unload mod_1 [mod_2 .. mod_N]" */</span>
<a name="l00262"></a>00262    <span class="keywordtype">int</span> x;
<a name="l00263"></a>00263    <span class="keywordtype">int</span> force = <a class="code" href="module_8h.html#7f8992121648ba013497a678ccaa62699562c97b424aad17b52e51a3a948315f">AST_FORCE_SOFT</a>;
<a name="l00264"></a>00264    <span class="keywordtype">char</span> *<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>;
<a name="l00265"></a>00265 
<a name="l00266"></a>00266    <span class="keywordflow">switch</span> (cmd) {
<a name="l00267"></a>00267    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>:
<a name="l00268"></a>00268       e-&gt;<a class="code" href="structast__cli__entry.html#1dccadfed7bcbb036c56a4afb97e906f">command</a> = <span class="stringliteral">"module unload"</span>;
<a name="l00269"></a>00269       e-&gt;<a class="code" href="structast__cli__entry.html#9366282e11c151558bdfaab4a264aa1b">usage</a> =
<a name="l00270"></a>00270          <span class="stringliteral">"Usage: module unload [-f|-h] &lt;module_1&gt; [&lt;module_2&gt; ... ]\n"</span>
<a name="l00271"></a>00271          <span class="stringliteral">"       Unloads the specified module from Asterisk. The -f\n"</span>
<a name="l00272"></a>00272          <span class="stringliteral">"       option causes the module to be unloaded even if it is\n"</span>
<a name="l00273"></a>00273          <span class="stringliteral">"       in use (may cause a crash) and the -h module causes the\n"</span>
<a name="l00274"></a>00274          <span class="stringliteral">"       module to be unloaded even if the module says it cannot, \n"</span>
<a name="l00275"></a>00275          <span class="stringliteral">"       which almost always will cause a crash.\n"</span>;
<a name="l00276"></a>00276       <span class="keywordflow">return</span> NULL;
<a name="l00277"></a>00277 
<a name="l00278"></a>00278    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d2f4c807e7bc4e767d91adc6ee3e8869e">CLI_GENERATE</a>:
<a name="l00279"></a>00279       <span class="keywordflow">return</span> <a class="code" href="loader_8c.html#35dec328d257abc218594c71f6ee2855">ast_module_helper</a>(a-&gt;<a class="code" href="structast__cli__args.html#6438c669e0d0de98e6929c2cc0fac474">line</a>, a-&gt;<a class="code" href="structast__cli__args.html#c47d187067c6cf953245f128b5fde62a">word</a>, a-&gt;<a class="code" href="structast__cli__args.html#5e0bdcbddccca4d66d74ba8c1cee1a68">pos</a>, a-&gt;<a class="code" href="structast__cli__args.html#7b8b965ad4bca0e41ab51de7b31363a1">n</a>, a-&gt;<a class="code" href="structast__cli__args.html#5e0bdcbddccca4d66d74ba8c1cee1a68">pos</a>, 0);
<a name="l00280"></a>00280    }
<a name="l00281"></a>00281    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#212be369d46788be295dbb6516442fee">argc</a> &lt; e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a> + 1)
<a name="l00282"></a>00282       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#8409e2cc535711ab81e051428521a8c6">CLI_SHOWUSAGE</a>;
<a name="l00283"></a>00283    x = e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>;   <span class="comment">/* first argument */</span>
<a name="l00284"></a>00284    s = a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a>[x];
<a name="l00285"></a>00285    <span class="keywordflow">if</span> (s[0] == <span class="charliteral">'-'</span>) {
<a name="l00286"></a>00286       <span class="keywordflow">if</span> (s[1] == <span class="charliteral">'f'</span>)
<a name="l00287"></a>00287          force = <a class="code" href="module_8h.html#7f8992121648ba013497a678ccaa6269bbebb65eda949b35cc897af469927afb">AST_FORCE_FIRM</a>;
<a name="l00288"></a>00288       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (s[1] == <span class="charliteral">'h'</span>)
<a name="l00289"></a>00289          force = <a class="code" href="module_8h.html#7f8992121648ba013497a678ccaa6269aaaa4d6677842cb350fa742106d7eb46">AST_FORCE_HARD</a>;
<a name="l00290"></a>00290       <span class="keywordflow">else</span>
<a name="l00291"></a>00291          <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#8409e2cc535711ab81e051428521a8c6">CLI_SHOWUSAGE</a>;
<a name="l00292"></a>00292       <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__cli__args.html#212be369d46788be295dbb6516442fee">argc</a> &lt; e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a> + 2) <span class="comment">/* need at least one module name */</span>
<a name="l00293"></a>00293          <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#8409e2cc535711ab81e051428521a8c6">CLI_SHOWUSAGE</a>;
<a name="l00294"></a>00294       x++;  <span class="comment">/* skip this argument */</span>
<a name="l00295"></a>00295    }
<a name="l00296"></a>00296 
<a name="l00297"></a>00297    <span class="keywordflow">for</span> (; x &lt; a-&gt;argc; x++) {
<a name="l00298"></a>00298       <span class="keywordflow">if</span> (<a class="code" href="loader_8c.html#dca0e55ad72fbb1582b00b31520c393a">ast_unload_resource</a>(a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a>[x], force)) {
<a name="l00299"></a>00299          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(a-&gt;<a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a>, <span class="stringliteral">"Unable to unload resource %s\n"</span>, a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a>[x]);
<a name="l00300"></a>00300          <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#3478ef2d2b9cd0c577ca5ef5e22024af">CLI_FAILURE</a>;
<a name="l00301"></a>00301       }
<a name="l00302"></a>00302    }
<a name="l00303"></a>00303    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#1feba2188d0c8b5f3bffccacea035b67">CLI_SUCCESS</a>;
<a name="l00304"></a>00304 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="5778a6561e369daf3607fb79ee9af1be"></a><!-- doxytag: member="cli.c::handle_unload_deprecated" ref="5778a6561e369daf3607fb79ee9af1be" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* handle_unload_deprecated           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00306">306</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>, <a class="el" href="cli_8h-source.html#l00190">ast_cli_entry::command</a>, and <a class="el" href="cli_8c-source.html#l00259">handle_unload()</a>.<div class="fragment"><pre class="fragment"><a name="l00307"></a>00307 {
<a name="l00308"></a>00308    <span class="keywordtype">char</span> *res = <a class="code" href="cli_8c.html#3a5584424a010c12b96b841410370e2c">handle_unload</a>(e, cmd, a);
<a name="l00309"></a>00309    <span class="keywordflow">if</span> (cmd == <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>)
<a name="l00310"></a>00310       e-&gt;<a class="code" href="structast__cli__entry.html#1dccadfed7bcbb036c56a4afb97e906f">command</a> = <span class="stringliteral">"unload"</span>;  <span class="comment">/* XXX override */</span>
<a name="l00311"></a>00311    <span class="keywordflow">return</span> res;
<a name="l00312"></a>00312 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="41a087a72619630d56abab64d5cd459f"></a><!-- doxytag: member="cli.c::handle_verbose" ref="41a087a72619630d56abab64d5cd459f" args="(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* handle_verbose           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__cli__args.html">ast_cli_args</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00187">187</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8h-source.html#l00138">ast_cli_args::argc</a>, <a class="el" href="cli_8h-source.html#l00189">ast_cli_entry::args</a>, <a class="el" href="cli_8h-source.html#l00139">ast_cli_args::argv</a>, <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d2f4c807e7bc4e767d91adc6ee3e8869e">CLI_GENERATE</a>, <a class="el" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>, <a class="el" href="cli_8h-source.html#l00042">CLI_SHOWUSAGE</a>, <a class="el" href="cli_8h-source.html#l00041">CLI_SUCCESS</a>, <a class="el" href="cli_8h-source.html#l00190">ast_cli_entry::command</a>, <a class="el" href="cli_8h-source.html#l00137">ast_cli_args::fd</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, and <a class="el" href="cli_8h-source.html#l00168">ast_cli_entry::usage</a>.<div class="fragment"><pre class="fragment"><a name="l00188"></a>00188 {
<a name="l00189"></a>00189    <span class="keywordtype">int</span> oldval = <a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a>;
<a name="l00190"></a>00190    <span class="keywordtype">int</span> newlevel;
<a name="l00191"></a>00191    <span class="keywordtype">int</span> atleast = 0;
<a name="l00192"></a>00192    <span class="keywordtype">int</span> fd = a-&gt;<a class="code" href="structast__cli__args.html#36eba1e1e343279857ea7f69a597324e">fd</a>;
<a name="l00193"></a>00193    <span class="keywordtype">int</span> argc = a-&gt;<a class="code" href="structast__cli__args.html#212be369d46788be295dbb6516442fee">argc</a>;
<a name="l00194"></a>00194    <span class="keywordtype">char</span> **argv = a-&gt;<a class="code" href="structast__cli__args.html#b84cdd85c9e3ee904488c933ee1a3e30">argv</a>;
<a name="l00195"></a>00195    <span class="keywordtype">int</span> *dst;
<a name="l00196"></a>00196    <span class="keywordtype">char</span> *what;
<a name="l00197"></a>00197 
<a name="l00198"></a>00198    <span class="keywordflow">switch</span> (cmd) {
<a name="l00199"></a>00199    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d835e08f776c41da0075f516f0353eb56">CLI_INIT</a>:
<a name="l00200"></a>00200       e-&gt;<a class="code" href="structast__cli__entry.html#1dccadfed7bcbb036c56a4afb97e906f">command</a> = <span class="stringliteral">"core set {debug|verbose} [off|atleast]"</span>;
<a name="l00201"></a>00201       e-&gt;<a class="code" href="structast__cli__entry.html#9366282e11c151558bdfaab4a264aa1b">usage</a> =
<a name="l00202"></a>00202          <span class="stringliteral">"Usage: core set {debug|verbose} [atleast] &lt;level&gt;\n"</span>
<a name="l00203"></a>00203          <span class="stringliteral">"       core set {debug|verbose} off\n"</span>
<a name="l00204"></a>00204          <span class="stringliteral">"       Sets level of debug or verbose messages to be displayed.\n"</span>
<a name="l00205"></a>00205          <span class="stringliteral">"  0 or off means no messages should be displayed.\n"</span>
<a name="l00206"></a>00206          <span class="stringliteral">"  Equivalent to -d[d[...]] or -v[v[v...]] on startup\n"</span>;
<a name="l00207"></a>00207       <span class="keywordflow">return</span> NULL;
<a name="l00208"></a>00208 
<a name="l00209"></a>00209    <span class="keywordflow">case</span> <a class="code" href="cli_8h.html#cb9e7baa34e2b33943d2bfcc34bf340d2f4c807e7bc4e767d91adc6ee3e8869e">CLI_GENERATE</a>:
<a name="l00210"></a>00210       <span class="keywordflow">return</span> NULL;
<a name="l00211"></a>00211    }
<a name="l00212"></a>00212    <span class="comment">/* all the above return, so we proceed with the handler.</span>
<a name="l00213"></a>00213 <span class="comment">    * we are guaranteed to be called with argc &gt;= e-&gt;args;</span>
<a name="l00214"></a>00214 <span class="comment">    */</span>
<a name="l00215"></a>00215 
<a name="l00216"></a>00216    <span class="keywordflow">if</span> (argc &lt; e-&gt;args)
<a name="l00217"></a>00217       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#8409e2cc535711ab81e051428521a8c6">CLI_SHOWUSAGE</a>;
<a name="l00218"></a>00218    <span class="keywordflow">if</span> (!strcasecmp(argv[e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a> - 2], <span class="stringliteral">"debug"</span>)) {
<a name="l00219"></a>00219       dst = &amp;<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>;
<a name="l00220"></a>00220       what = <span class="stringliteral">"Core debug"</span>;
<a name="l00221"></a>00221    } <span class="keywordflow">else</span> {
<a name="l00222"></a>00222       dst = &amp;<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a>;
<a name="l00223"></a>00223       what = <span class="stringliteral">"Verbosity"</span>;
<a name="l00224"></a>00224    }
<a name="l00225"></a>00225    <span class="keywordflow">if</span> (argc == e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a> &amp;&amp; !strcasecmp(argv[e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a> - 1], <span class="stringliteral">"off"</span>)) {
<a name="l00226"></a>00226       newlevel = 0;
<a name="l00227"></a>00227       <span class="keywordflow">goto</span> done;
<a name="l00228"></a>00228    }
<a name="l00229"></a>00229    <span class="keywordflow">if</span> (!strcasecmp(argv[e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a>-1], <span class="stringliteral">"atleast"</span>))
<a name="l00230"></a>00230       atleast = 1;
<a name="l00231"></a>00231    <span class="keywordflow">if</span> (argc != e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a> + atleast)
<a name="l00232"></a>00232       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#8409e2cc535711ab81e051428521a8c6">CLI_SHOWUSAGE</a>;
<a name="l00233"></a>00233    <span class="keywordflow">if</span> (sscanf(argv[e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a> + atleast - 1], <span class="stringliteral">"%d"</span>, &amp;newlevel) != 1)
<a name="l00234"></a>00234       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#8409e2cc535711ab81e051428521a8c6">CLI_SHOWUSAGE</a>;
<a name="l00235"></a>00235 
<a name="l00236"></a>00236 done:
<a name="l00237"></a>00237    <span class="keywordflow">if</span> (!atleast || newlevel &gt; *dst)
<a name="l00238"></a>00238       *dst = newlevel;
<a name="l00239"></a>00239    <span class="keywordflow">if</span> (oldval &gt; 0 &amp;&amp; *dst == 0)
<a name="l00240"></a>00240       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"%s is now OFF\n"</span>, what);
<a name="l00241"></a>00241    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*dst &gt; 0) {
<a name="l00242"></a>00242       <span class="keywordflow">if</span> (oldval == *dst)
<a name="l00243"></a>00243          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"%s is at least %d\n"</span>, what, *dst);
<a name="l00244"></a>00244       <span class="keywordflow">else</span>
<a name="l00245"></a>00245          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"%s was %d and is now %d\n"</span>, what, oldval, *dst);
<a name="l00246"></a>00246    }
<a name="l00247"></a>00247 
<a name="l00248"></a>00248    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#1feba2188d0c8b5f3bffccacea035b67">CLI_SUCCESS</a>;
<a name="l00249"></a>00249 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b32b4e17f86c7b90f20d9cfcc999a92b"></a><!-- doxytag: member="cli.c::help1" ref="b32b4e17f86c7b90f20d9cfcc999a92b" args="(int fd, char *match[], int locked)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* help1           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>match</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>locked</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
helper for final part of handle_help. if locked = 0 it's just "help_workhorse", otherwise assume the list is already locked and print an error message if not found. 
<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l01378">1378</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8h-source.html#l00183">ast_cli_entry::_full_cmd</a>, <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="utils_8c-source.html#l00849">ast_join()</a>, <a class="el" href="linkedlists_8h-source.html#l00038">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00104">AST_LIST_UNLOCK</a>, <a class="el" href="cli_8c-source.html#l01065">cli_next()</a>, <a class="el" href="cli_8h-source.html#l00041">CLI_SUCCESS</a>, <a class="el" href="cli_8h-source.html#l00191">ast_cli_entry::deprecated</a>, <a class="el" href="cli_8c-source.html#l01062">cli_iterator::helpers</a>, <a class="el" href="utils_8h-source.html#l00386">len</a>, <a class="el" href="strings_8h-source.html#l00045">S_OR</a>, and <a class="el" href="cli_8h-source.html#l00167">ast_cli_entry::summary</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l01411">handle_help()</a>.<div class="fragment"><pre class="fragment"><a name="l01379"></a>01379 {
<a name="l01380"></a>01380    <span class="keywordtype">char</span> matchstr[80] = <span class="stringliteral">""</span>;
<a name="l01381"></a>01381    <span class="keyword">struct </span><a class="code" href="structast__cli__entry.html">ast_cli_entry</a> *e;
<a name="l01382"></a>01382    <span class="keywordtype">int</span> <a class="code" href="utils_8h.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a> = 0;
<a name="l01383"></a>01383    <span class="keywordtype">int</span> found = 0;
<a name="l01384"></a>01384    <span class="keyword">struct </span><a class="code" href="structcli__iterator.html">cli_iterator</a> i = { NULL, NULL};
<a name="l01385"></a>01385 
<a name="l01386"></a>01386    <span class="keywordflow">if</span> (<a class="code" href="chan__iax2_8c.html#b5f545ec55667a61a75dd2047251b4ac">match</a>) {
<a name="l01387"></a>01387       <a class="code" href="utils_8c.html#33e7834c0d3de361f490e1c744011610">ast_join</a>(matchstr, <span class="keyword">sizeof</span>(matchstr), <a class="code" href="chan__iax2_8c.html#b5f545ec55667a61a75dd2047251b4ac">match</a>);
<a name="l01388"></a>01388       len = strlen(matchstr);
<a name="l01389"></a>01389    }
<a name="l01390"></a>01390    <span class="keywordflow">if</span> (!locked)
<a name="l01391"></a>01391       <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;<a class="code" href="structcli__iterator.html#c2c3081275569a523f7b887c77722c5b">helpers</a>);
<a name="l01392"></a>01392    <span class="keywordflow">while</span> ( (e = <a class="code" href="cli_8c.html#e1ad08e15725db1ff280b812a583b4a2">cli_next</a>(&amp;i)) ) {
<a name="l01393"></a>01393       <span class="comment">/* Hide commands that start with '_' */</span>
<a name="l01394"></a>01394       <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__cli__entry.html#93e8a3d20be0d24b9aa32e9934e9f7b7">_full_cmd</a>[0] == <span class="charliteral">'_'</span>)
<a name="l01395"></a>01395          <span class="keywordflow">continue</span>;
<a name="l01396"></a>01396       <span class="comment">/* Hide commands that are marked as deprecated. */</span>
<a name="l01397"></a>01397       <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__cli__entry.html#54dac5afe1fcac2f65c059fc97b44a58">deprecated</a>)
<a name="l01398"></a>01398          <span class="keywordflow">continue</span>;
<a name="l01399"></a>01399       <span class="keywordflow">if</span> (<a class="code" href="chan__iax2_8c.html#b5f545ec55667a61a75dd2047251b4ac">match</a> &amp;&amp; strncasecmp(matchstr, e-&gt;<a class="code" href="structast__cli__entry.html#93e8a3d20be0d24b9aa32e9934e9f7b7">_full_cmd</a>, len))
<a name="l01400"></a>01400          <span class="keywordflow">continue</span>;
<a name="l01401"></a>01401       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"%30.30s %s\n"</span>, e-&gt;<a class="code" href="structast__cli__entry.html#93e8a3d20be0d24b9aa32e9934e9f7b7">_full_cmd</a>, <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(e-&gt;<a class="code" href="structast__cli__entry.html#a80da1282f2c775bbc5f2c92c836968b">summary</a>, <span class="stringliteral">"&lt;no description available&gt;"</span>));
<a name="l01402"></a>01402       found++;
<a name="l01403"></a>01403    }
<a name="l01404"></a>01404    <span class="keywordflow">if</span> (!locked)
<a name="l01405"></a>01405       <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;<a class="code" href="structcli__iterator.html#c2c3081275569a523f7b887c77722c5b">helpers</a>);
<a name="l01406"></a>01406    <span class="keywordflow">if</span> (!locked &amp;&amp; !found &amp;&amp; matchstr[0])
<a name="l01407"></a>01407       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"No such command '%s'.\n"</span>, matchstr);
<a name="l01408"></a>01408    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#1feba2188d0c8b5f3bffccacea035b67">CLI_SUCCESS</a>;
<a name="l01409"></a>01409 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c068114fba4aab15f80a59cda41811b4"></a><!-- doxytag: member="cli.c::is_prefix" ref="c068114fba4aab15f80a59cda41811b4" args="(const char *word, const char *token, int pos, int *actual)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* is_prefix           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>word</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>token</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pos</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>actual</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
if word is a valid prefix for token, returns the pos-th match as a malloced string, or NULL otherwise. Always tell in *actual how many matches we got. 
<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l01127">1127</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="cli_8c-source.html#l01016">cli_rsvd</a>, <a class="el" href="aesopt_8h-source.html#l00399">s</a>, <a class="el" href="astmm_8h-source.html#l00075">strdup</a>, and <a class="el" href="strcompat_8c-source.html#l00035">strsep()</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l01595">__ast_cli_generator()</a>.<div class="fragment"><pre class="fragment"><a name="l01129"></a>01129 {
<a name="l01130"></a>01130    <span class="keywordtype">int</span> lw;
<a name="l01131"></a>01131    <span class="keywordtype">char</span> *<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>, *t1;
<a name="l01132"></a>01132 
<a name="l01133"></a>01133    *actual = 0;
<a name="l01134"></a>01134    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(token))
<a name="l01135"></a>01135       <span class="keywordflow">return</span> NULL;
<a name="l01136"></a>01136    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(word))
<a name="l01137"></a>01137       word = <span class="stringliteral">""</span>;  <span class="comment">/* dummy */</span>
<a name="l01138"></a>01138    lw = strlen(word);
<a name="l01139"></a>01139    <span class="keywordflow">if</span> (strcspn(word, <a class="code" href="cli_8c.html#ec0a0fff99f9155021d653f2f1109fbc">cli_rsvd</a>) != lw)
<a name="l01140"></a>01140       <span class="keywordflow">return</span> NULL;   <span class="comment">/* no match if word has reserved chars */</span>
<a name="l01141"></a>01141    <span class="keywordflow">if</span> (strchr(<a class="code" href="cli_8c.html#ec0a0fff99f9155021d653f2f1109fbc">cli_rsvd</a>, token[0]) == NULL) { <span class="comment">/* regular match */</span>
<a name="l01142"></a>01142       <span class="keywordflow">if</span> (strncasecmp(token, word, lw))   <span class="comment">/* no match */</span>
<a name="l01143"></a>01143          <span class="keywordflow">return</span> NULL;
<a name="l01144"></a>01144       *actual = 1;
<a name="l01145"></a>01145       <span class="keywordflow">return</span> (pos != 0) ? NULL : <a class="code" href="astmm_8h.html#17881997a89ddffd239268f0476567d0">strdup</a>(token);
<a name="l01146"></a>01146    }
<a name="l01147"></a>01147    <span class="comment">/* now handle regexp match */</span>
<a name="l01148"></a>01148 
<a name="l01149"></a>01149    <span class="comment">/* Wildcard always matches, so we never do is_prefix on them */</span>
<a name="l01150"></a>01150 
<a name="l01151"></a>01151    t1 = <a class="code" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>(token + 1);  <span class="comment">/* copy, skipping first char */</span>
<a name="l01152"></a>01152    <span class="keywordflow">while</span> (pos &gt;= 0 &amp;&amp; (s = <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;t1, <a class="code" href="cli_8c.html#ec0a0fff99f9155021d653f2f1109fbc">cli_rsvd</a>)) &amp;&amp; *s) {
<a name="l01153"></a>01153       <span class="keywordflow">if</span> (*s == <span class="charliteral">'%'</span>) <span class="comment">/* wildcard */</span>
<a name="l01154"></a>01154          <span class="keywordflow">continue</span>;
<a name="l01155"></a>01155       <span class="keywordflow">if</span> (strncasecmp(s, word, lw)) <span class="comment">/* no match */</span>
<a name="l01156"></a>01156          <span class="keywordflow">continue</span>;
<a name="l01157"></a>01157       (*actual)++;
<a name="l01158"></a>01158       <span class="keywordflow">if</span> (pos-- == 0)
<a name="l01159"></a>01159          <span class="keywordflow">return</span> <a class="code" href="astmm_8h.html#17881997a89ddffd239268f0476567d0">strdup</a>(s);
<a name="l01160"></a>01160    }
<a name="l01161"></a>01161    <span class="keywordflow">return</span> NULL;
<a name="l01162"></a>01162 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="5f26fe7300ef7f1b5efee53cc95830ad"></a><!-- doxytag: member="cli.c::modlist_modentry" ref="5f26fe7300ef7f1b5efee53cc95830ad" args="(const char *module, const char *description, int usecnt, const char *like)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int modlist_modentry           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>module</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>description</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>usecnt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>like</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00320">320</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="cli_8c-source.html#l00318">climodentryfd</a>, <a class="el" href="cli_8c-source.html#l00314">MODLIST_FORMAT</a>, and <a class="el" href="strcompat_8c-source.html#l00101">strcasestr()</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l00413">handle_modlist()</a>.<div class="fragment"><pre class="fragment"><a name="l00321"></a>00321 {
<a name="l00322"></a>00322    <span class="comment">/* Comparing the like with the module */</span>
<a name="l00323"></a>00323    <span class="keywordflow">if</span> (<a class="code" href="strcompat_8c.html#4a77b3b09866eecb70e963be481fe425">strcasestr</a>(module, like) ) {
<a name="l00324"></a>00324       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(<a class="code" href="cli_8c.html#ade24f5837e1c073d2e7cfc2adc4073c">climodentryfd</a>, <a class="code" href="cli_8c.html#3f3be2b87af5e46e9b37b78b2f6f954b">MODLIST_FORMAT</a>, module, <a class="code" href="callerid_8c.html#67daf92c833c41c95db874e18fcb2786">description</a>, usecnt);
<a name="l00325"></a>00325       <span class="keywordflow">return</span> 1;
<a name="l00326"></a>00326    } 
<a name="l00327"></a>00327    <span class="keywordflow">return</span> 0;
<a name="l00328"></a>00328 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="654843d19ae0981865b6489880fb9742"></a><!-- doxytag: member="cli.c::more_words" ref="654843d19ae0981865b6489880fb9742" args="(char *const *dst)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int more_words           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *const *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dst</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
returns true if there are more words to match 
<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l01582">1582</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l01595">__ast_cli_generator()</a>.<div class="fragment"><pre class="fragment"><a name="l01583"></a>01583 {
<a name="l01584"></a>01584    <span class="keywordtype">int</span> i;
<a name="l01585"></a>01585    <span class="keywordflow">for</span> (i = 0; dst[i]; i++) {
<a name="l01586"></a>01586       <span class="keywordflow">if</span> (dst[i][0] != <span class="charliteral">'['</span>)
<a name="l01587"></a>01587          <span class="keywordflow">return</span> -1;
<a name="l01588"></a>01588    }
<a name="l01589"></a>01589    <span class="keywordflow">return</span> 0;
<a name="l01590"></a>01590 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="e01ab49bede0d1e1f151dc1380d1038a"></a><!-- doxytag: member="cli.c::parse_args" ref="e01ab49bede0d1e1f151dc1380d1038a" args="(const char *s, int *argc, char *argv[], int max, int *trailingwhitespace)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* parse_args           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>max</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>trailingwhitespace</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l01451">1451</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>, and <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l01595">__ast_cli_generator()</a>, <a class="el" href="res__agi_8c-source.html#l01801">agi_handle_command()</a>, and <a class="el" href="cli_8c-source.html#l01681">ast_cli_command()</a>.<div class="fragment"><pre class="fragment"><a name="l01452"></a>01452 {
<a name="l01453"></a>01453    <span class="keywordtype">char</span> *dup, *cur;
<a name="l01454"></a>01454    <span class="keywordtype">int</span> x = 0;
<a name="l01455"></a>01455    <span class="keywordtype">int</span> quoted = 0;
<a name="l01456"></a>01456    <span class="keywordtype">int</span> escaped = 0;
<a name="l01457"></a>01457    <span class="keywordtype">int</span> whitespace = 1;
<a name="l01458"></a>01458    <span class="keywordtype">int</span> dummy = 0;
<a name="l01459"></a>01459 
<a name="l01460"></a>01460    <span class="keywordflow">if</span> (trailingwhitespace == NULL)
<a name="l01461"></a>01461       trailingwhitespace = &amp;dummy;
<a name="l01462"></a>01462    *trailingwhitespace = 0;
<a name="l01463"></a>01463    <span class="keywordflow">if</span> (<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a> == NULL) <span class="comment">/* invalid, though! */</span>
<a name="l01464"></a>01464       <span class="keywordflow">return</span> NULL;
<a name="l01465"></a>01465    <span class="comment">/* make a copy to store the parsed string */</span>
<a name="l01466"></a>01466    <span class="keywordflow">if</span> (!(dup = <a class="code" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>(<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>)))
<a name="l01467"></a>01467       <span class="keywordflow">return</span> NULL;
<a name="l01468"></a>01468 
<a name="l01469"></a>01469    cur = dup;
<a name="l01470"></a>01470    <span class="comment">/* scan the original string copying into cur when needed */</span>
<a name="l01471"></a>01471    <span class="keywordflow">for</span> (; *<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a> ; <a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>++) {
<a name="l01472"></a>01472       <span class="keywordflow">if</span> (x &gt;= max - 1) {
<a name="l01473"></a>01473          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Too many arguments, truncating at %s\n"</span>, <a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>);
<a name="l01474"></a>01474          <span class="keywordflow">break</span>;
<a name="l01475"></a>01475       }
<a name="l01476"></a>01476       <span class="keywordflow">if</span> (*<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a> == <span class="charliteral">'"'</span> &amp;&amp; !escaped) {
<a name="l01477"></a>01477          quoted = !quoted;
<a name="l01478"></a>01478          <span class="keywordflow">if</span> (quoted &amp;&amp; whitespace) {
<a name="l01479"></a>01479             <span class="comment">/* start a quoted string from previous whitespace: new argument */</span>
<a name="l01480"></a>01480             argv[x++] = cur;
<a name="l01481"></a>01481             whitespace = 0;
<a name="l01482"></a>01482          }
<a name="l01483"></a>01483       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a> == <span class="charliteral">' '</span> || *<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a> == <span class="charliteral">'\t'</span>) &amp;&amp; !(quoted || escaped)) {
<a name="l01484"></a>01484          <span class="comment">/* If we are not already in whitespace, and not in a quoted string or</span>
<a name="l01485"></a>01485 <span class="comment">            processing an escape sequence, and just entered whitespace, then</span>
<a name="l01486"></a>01486 <span class="comment">            finalize the previous argument and remember that we are in whitespace</span>
<a name="l01487"></a>01487 <span class="comment">         */</span>
<a name="l01488"></a>01488          <span class="keywordflow">if</span> (!whitespace) {
<a name="l01489"></a>01489             *cur++ = <span class="charliteral">'\0'</span>;
<a name="l01490"></a>01490             whitespace = 1;
<a name="l01491"></a>01491          }
<a name="l01492"></a>01492       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a> == <span class="charliteral">'\\'</span> &amp;&amp; !escaped) {
<a name="l01493"></a>01493          escaped = 1;
<a name="l01494"></a>01494       } <span class="keywordflow">else</span> {
<a name="l01495"></a>01495          <span class="keywordflow">if</span> (whitespace) {
<a name="l01496"></a>01496             <span class="comment">/* we leave whitespace, and are not quoted. So it's a new argument */</span>
<a name="l01497"></a>01497             argv[x++] = cur;
<a name="l01498"></a>01498             whitespace = 0;
<a name="l01499"></a>01499          }
<a name="l01500"></a>01500          *cur++ = *<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>;
<a name="l01501"></a>01501          escaped = 0;
<a name="l01502"></a>01502       }
<a name="l01503"></a>01503    }
<a name="l01504"></a>01504    <span class="comment">/* Null terminate */</span>
<a name="l01505"></a>01505    *cur++ = <span class="charliteral">'\0'</span>;
<a name="l01506"></a>01506    <span class="comment">/* XXX put a NULL in the last argument, because some functions that take</span>
<a name="l01507"></a>01507 <span class="comment">    * the array may want a null-terminated array.</span>
<a name="l01508"></a>01508 <span class="comment">    * argc still reflects the number of non-NULL entries.</span>
<a name="l01509"></a>01509 <span class="comment">    */</span>
<a name="l01510"></a>01510    argv[x] = NULL;
<a name="l01511"></a>01511    *argc = x;
<a name="l01512"></a>01512    *trailingwhitespace = whitespace;
<a name="l01513"></a>01513    <span class="keywordflow">return</span> dup;
<a name="l01514"></a>01514 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="abe9a7303debc41079df1e6c87be3401"></a><!-- doxytag: member="cli.c::print_uptimestr" ref="abe9a7303debc41079df1e6c87be3401" args="(int fd, time_t timeval, const char *prefix, int printsec)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void print_uptimestr           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>time_t&nbsp;</td>
          <td class="mdname" nowrap> <em>timeval</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>prefix</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>printsec</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00330">330</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="strings_8h.html#15892382538fcffb4bd4216c8956c428">ast_str_alloca</a>, <a class="el" href="strings_8h.html#0c00985509b077cfe0ccdd5829342ca4">ast_str_append()</a>, <a class="el" href="cli_8c.html#5b1d59b5451c06afb65ab1bc2713cfb4">DAY</a>, <a class="el" href="cli_8h-source.html#l00056">ESS</a>, <a class="el" href="cli_8c.html#dd3f965174e8bb2f64523981626ced1a">HOUR</a>, <a class="el" href="cli_8c.html#46bda4cde2f10bdb9e51e3bbefa4a2bf">MINUTE</a>, <a class="el" href="cli_8c.html#6405020f7d805f0a0c5bf1609be3a226">NEEDCOMMA</a>, <a class="el" href="strings_8h-source.html#l00319">ast_str::str</a>, <a class="el" href="strings_8h-source.html#l00314">ast_str::used</a>, <a class="el" href="cli_8c.html#02854858ab6190b2e40f3d9b1ee16982">WEEK</a>, and <a class="el" href="cli_8c.html#d18101729d290479023d5eceeb29c9cf">YEAR</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l00381">handle_showuptime()</a>.<div class="fragment"><pre class="fragment"><a name="l00331"></a>00331 {
<a name="l00332"></a>00332    <span class="keywordtype">int</span> x; <span class="comment">/* the main part - years, weeks, etc. */</span>
<a name="l00333"></a>00333    <span class="keyword">struct </span><a class="code" href="structast__str.html">ast_str</a> *out;
<a name="l00334"></a>00334 
<a name="l00335"></a>00335 <span class="preprocessor">#define SECOND (1)</span>
<a name="l00336"></a>00336 <span class="preprocessor"></span><span class="preprocessor">#define MINUTE (SECOND*60)</span>
<a name="l00337"></a>00337 <span class="preprocessor"></span><span class="preprocessor">#define HOUR (MINUTE*60)</span>
<a name="l00338"></a>00338 <span class="preprocessor"></span><span class="preprocessor">#define DAY (HOUR*24)</span>
<a name="l00339"></a>00339 <span class="preprocessor"></span><span class="preprocessor">#define WEEK (DAY*7)</span>
<a name="l00340"></a>00340 <span class="preprocessor"></span><span class="preprocessor">#define YEAR (DAY*365)</span>
<a name="l00341"></a>00341 <span class="preprocessor"></span><span class="preprocessor">#define NEEDCOMMA(x) ((x)? ",": "") </span><span class="comment">/* define if we need a comma */</span>
<a name="l00342"></a>00342    <span class="keywordflow">if</span> (timeval &lt; 0)  <span class="comment">/* invalid, nothing to show */</span>
<a name="l00343"></a>00343       <span class="keywordflow">return</span>;
<a name="l00344"></a>00344 
<a name="l00345"></a>00345    <span class="keywordflow">if</span> (printsec)  {  <span class="comment">/* plain seconds output */</span>
<a name="l00346"></a>00346       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"%s: %lu\n"</span>, <a class="code" href="http_8c.html#93583f8993b24e7afddf9578925bd1d8">prefix</a>, (u_long)timeval);
<a name="l00347"></a>00347       <span class="keywordflow">return</span>;
<a name="l00348"></a>00348    }
<a name="l00349"></a>00349    out = <a class="code" href="strings_8h.html#15892382538fcffb4bd4216c8956c428">ast_str_alloca</a>(256);
<a name="l00350"></a>00350    <span class="keywordflow">if</span> (timeval &gt; YEAR) {
<a name="l00351"></a>00351       x = (timeval / <a class="code" href="cli_8c.html#d18101729d290479023d5eceeb29c9cf">YEAR</a>);
<a name="l00352"></a>00352       timeval -= (x * YEAR);
<a name="l00353"></a>00353       <a class="code" href="strings_8h.html#0c00985509b077cfe0ccdd5829342ca4">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">"%d year%s%s "</span>, x, <a class="code" href="cli_8h.html#9f130886d424a4c673e63f0d0f3b0086">ESS</a>(x),<a class="code" href="cli_8c.html#6405020f7d805f0a0c5bf1609be3a226">NEEDCOMMA</a>(timeval));
<a name="l00354"></a>00354    }
<a name="l00355"></a>00355    <span class="keywordflow">if</span> (timeval &gt; WEEK) {
<a name="l00356"></a>00356       x = (timeval / <a class="code" href="cli_8c.html#02854858ab6190b2e40f3d9b1ee16982">WEEK</a>);
<a name="l00357"></a>00357       timeval -= (x * WEEK);
<a name="l00358"></a>00358       <a class="code" href="strings_8h.html#0c00985509b077cfe0ccdd5829342ca4">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">"%d week%s%s "</span>, x, <a class="code" href="cli_8h.html#9f130886d424a4c673e63f0d0f3b0086">ESS</a>(x),<a class="code" href="cli_8c.html#6405020f7d805f0a0c5bf1609be3a226">NEEDCOMMA</a>(timeval));
<a name="l00359"></a>00359    }
<a name="l00360"></a>00360    <span class="keywordflow">if</span> (timeval &gt; DAY) {
<a name="l00361"></a>00361       x = (timeval / <a class="code" href="cli_8c.html#5b1d59b5451c06afb65ab1bc2713cfb4">DAY</a>);
<a name="l00362"></a>00362       timeval -= (x * DAY);
<a name="l00363"></a>00363       <a class="code" href="strings_8h.html#0c00985509b077cfe0ccdd5829342ca4">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">"%d day%s%s "</span>, x, <a class="code" href="cli_8h.html#9f130886d424a4c673e63f0d0f3b0086">ESS</a>(x),<a class="code" href="cli_8c.html#6405020f7d805f0a0c5bf1609be3a226">NEEDCOMMA</a>(timeval));
<a name="l00364"></a>00364    }
<a name="l00365"></a>00365    <span class="keywordflow">if</span> (timeval &gt; HOUR) {
<a name="l00366"></a>00366       x = (timeval / <a class="code" href="cli_8c.html#dd3f965174e8bb2f64523981626ced1a">HOUR</a>);
<a name="l00367"></a>00367       timeval -= (x * HOUR);
<a name="l00368"></a>00368       <a class="code" href="strings_8h.html#0c00985509b077cfe0ccdd5829342ca4">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">"%d hour%s%s "</span>, x, <a class="code" href="cli_8h.html#9f130886d424a4c673e63f0d0f3b0086">ESS</a>(x),<a class="code" href="cli_8c.html#6405020f7d805f0a0c5bf1609be3a226">NEEDCOMMA</a>(timeval));
<a name="l00369"></a>00369    }
<a name="l00370"></a>00370    <span class="keywordflow">if</span> (timeval &gt; MINUTE) {
<a name="l00371"></a>00371       x = (timeval / <a class="code" href="cli_8c.html#46bda4cde2f10bdb9e51e3bbefa4a2bf">MINUTE</a>);
<a name="l00372"></a>00372       timeval -= (x * MINUTE);
<a name="l00373"></a>00373       <a class="code" href="strings_8h.html#0c00985509b077cfe0ccdd5829342ca4">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">"%d minute%s%s "</span>, x, <a class="code" href="cli_8h.html#9f130886d424a4c673e63f0d0f3b0086">ESS</a>(x),<a class="code" href="cli_8c.html#6405020f7d805f0a0c5bf1609be3a226">NEEDCOMMA</a>(timeval));
<a name="l00374"></a>00374    }
<a name="l00375"></a>00375    x = timeval;
<a name="l00376"></a>00376    <span class="keywordflow">if</span> (x &gt; 0 || out-&gt;<a class="code" href="structast__str.html#1aec9c5d0644e11fd9dd0f9fb36009fb">used</a> == 0)  <span class="comment">/* if there is nothing, print 0 seconds */</span>
<a name="l00377"></a>00377       <a class="code" href="strings_8h.html#0c00985509b077cfe0ccdd5829342ca4">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">"%d second%s "</span>, x, <a class="code" href="cli_8h.html#9f130886d424a4c673e63f0d0f3b0086">ESS</a>(x));
<a name="l00378"></a>00378    <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"%s: %s\n"</span>, <a class="code" href="http_8c.html#93583f8993b24e7afddf9578925bd1d8">prefix</a>, out-&gt;<a class="code" href="structast__str.html#3929b4348d8e5ee862fd1e38834d0217">str</a>);
<a name="l00379"></a>00379 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="cbe3c5bc7c46fc8815615f69cb6d88d9"></a><!-- doxytag: member="cli.c::set_full_cmd" ref="cbe3c5bc7c46fc8815615f69cb6d88d9" args="(struct ast_cli_entry *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int set_full_cmd           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
initialize the _full_cmd string and related parameters, return 0 on success, -1 on error. 
<p>
Definition at line <a class="el" href="cli_8c-source.html#l01022">1022</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="cli_8h-source.html#l00183">ast_cli_entry::_full_cmd</a>, <a class="el" href="cli_8h-source.html#l00189">ast_cli_entry::args</a>, <a class="el" href="utils_8c-source.html#l00849">ast_join()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="adsistub_8c-source.html#l00065">buf</a>, <a class="el" href="cli_8c-source.html#l01016">cli_rsvd</a>, <a class="el" href="cli_8h-source.html#l00154">ast_cli_entry::cmda</a>, <a class="el" href="cli_8h-source.html#l00184">ast_cli_entry::cmdlen</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, and <a class="el" href="astmm_8h-source.html#l00075">strdup</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l01261">__ast_cli_register()</a>, and <a class="el" href="cli_8c-source.html#l01041">ast_builtins_init()</a>.<div class="fragment"><pre class="fragment"><a name="l01023"></a>01023 {
<a name="l01024"></a>01024    <span class="keywordtype">int</span> i;
<a name="l01025"></a>01025    <span class="keywordtype">char</span> <a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>[80];
<a name="l01026"></a>01026 
<a name="l01027"></a>01027    <a class="code" href="utils_8c.html#33e7834c0d3de361f490e1c744011610">ast_join</a>(buf, <span class="keyword">sizeof</span>(buf), e-&gt;<a class="code" href="structast__cli__entry.html#ec27655330419638d73b5c69b3f1168e">cmda</a>);
<a name="l01028"></a>01028    e-&gt;<a class="code" href="structast__cli__entry.html#93e8a3d20be0d24b9aa32e9934e9f7b7">_full_cmd</a> = <a class="code" href="astmm_8h.html#17881997a89ddffd239268f0476567d0">strdup</a>(buf);
<a name="l01029"></a>01029    <span class="keywordflow">if</span> (!e-&gt;<a class="code" href="structast__cli__entry.html#93e8a3d20be0d24b9aa32e9934e9f7b7">_full_cmd</a>) {
<a name="l01030"></a>01030       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"-- cannot allocate &lt;%s&gt;\n"</span>, buf);
<a name="l01031"></a>01031       <span class="keywordflow">return</span> -1;
<a name="l01032"></a>01032    }
<a name="l01033"></a>01033    e-&gt;<a class="code" href="structast__cli__entry.html#2eb91f3d901de6f63517d61a884caad6">cmdlen</a> = strcspn(e-&gt;<a class="code" href="structast__cli__entry.html#93e8a3d20be0d24b9aa32e9934e9f7b7">_full_cmd</a>, <a class="code" href="cli_8c.html#ec0a0fff99f9155021d653f2f1109fbc">cli_rsvd</a>);
<a name="l01034"></a>01034    <span class="keywordflow">for</span> (i = 0; e-&gt;<a class="code" href="structast__cli__entry.html#ec27655330419638d73b5c69b3f1168e">cmda</a>[i]; i++)
<a name="l01035"></a>01035       ;
<a name="l01036"></a>01036    e-&gt;<a class="code" href="structast__cli__entry.html#a956af09162870af6ce4ebe0f12ccaf8">args</a> = i;
<a name="l01037"></a>01037    <span class="keywordflow">return</span> 0;
<a name="l01038"></a>01038 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="7f0fe151009e2ab5ebaff4ed0c0b3594"></a><!-- doxytag: member="cli.c::word_match" ref="7f0fe151009e2ab5ebaff4ed0c0b3594" args="(const char *cmd, const char *cli_word)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int word_match           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cli_word</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
match a word in the CLI entry. returns -1 on mismatch, 0 on match of an optional word, 1 on match of a full word.<p>
The pattern can be any_word match for equal [foo|bar|baz] optionally, one of these words {foo|bar|baz} exactly, one of these words % any word 
<p>
Definition at line <a class="el" href="cli_8c-source.html#l01098">1098</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
References <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="cli_8c-source.html#l01016">cli_rsvd</a>, and <a class="el" href="strcompat_8c-source.html#l00101">strcasestr()</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l01595">__ast_cli_generator()</a>, and <a class="el" href="cli_8c-source.html#l01174">find_cli()</a>.<div class="fragment"><pre class="fragment"><a name="l01099"></a>01099 {
<a name="l01100"></a>01100    <span class="keywordtype">int</span> l;
<a name="l01101"></a>01101    <span class="keywordtype">char</span> *pos;
<a name="l01102"></a>01102 
<a name="l01103"></a>01103    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(cmd) || <a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(cli_word))
<a name="l01104"></a>01104       <span class="keywordflow">return</span> -1;
<a name="l01105"></a>01105    <span class="keywordflow">if</span> (!strchr(<a class="code" href="cli_8c.html#ec0a0fff99f9155021d653f2f1109fbc">cli_rsvd</a>, cli_word[0])) <span class="comment">/* normal match */</span>
<a name="l01106"></a>01106       <span class="keywordflow">return</span> (strcasecmp(cmd, cli_word) == 0) ? 1 : -1;
<a name="l01107"></a>01107    <span class="comment">/* regexp match, takes [foo|bar] or {foo|bar} */</span>
<a name="l01108"></a>01108    l = strlen(cmd);
<a name="l01109"></a>01109    <span class="comment">/* wildcard match - will extend in the future */</span>
<a name="l01110"></a>01110    <span class="keywordflow">if</span> (l &gt; 0 &amp;&amp; cli_word[0] == <span class="charliteral">'%'</span>) {
<a name="l01111"></a>01111       <span class="keywordflow">return</span> 1;   <span class="comment">/* wildcard */</span>
<a name="l01112"></a>01112    }
<a name="l01113"></a>01113    pos = <a class="code" href="strcompat_8c.html#4a77b3b09866eecb70e963be481fe425">strcasestr</a>(cli_word, cmd);
<a name="l01114"></a>01114    <span class="keywordflow">if</span> (pos == NULL) <span class="comment">/* not found, say ok if optional */</span>
<a name="l01115"></a>01115       <span class="keywordflow">return</span> cli_word[0] == <span class="charliteral">'['</span> ? 0 : -1;
<a name="l01116"></a>01116    <span class="keywordflow">if</span> (pos == cli_word) <span class="comment">/* no valid match at the beginning */</span>
<a name="l01117"></a>01117       <span class="keywordflow">return</span> -1;
<a name="l01118"></a>01118    <span class="keywordflow">if</span> (strchr(<a class="code" href="cli_8c.html#ec0a0fff99f9155021d653f2f1109fbc">cli_rsvd</a>, pos[-1]) &amp;&amp; strchr(<a class="code" href="cli_8c.html#ec0a0fff99f9155021d653f2f1109fbc">cli_rsvd</a>, pos[l]))
<a name="l01119"></a>01119       <span class="keywordflow">return</span> 1;   <span class="comment">/* valid match */</span>
<a name="l01120"></a>01120    <span class="keywordflow">return</span> -1;  <span class="comment">/* not found */</span>
<a name="l01121"></a>01121 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="7b94c2c41ed9fd600b9a19bb54467397"></a><!-- doxytag: member="cli.c::builtins" ref="7b94c2c41ed9fd600b9a19bb54467397" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> <a class="el" href="pbx__functions_8h.html#7b94c2c41ed9fd600b9a19bb54467397">builtins</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00949">949</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l06035">load_pbx()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="fb3c7b069abee786fac0195e698d4bd9"></a><!-- doxytag: member="cli.c::cli_cli" ref="fb3c7b069abee786fac0195e698d4bd9" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> <a class="el" href="cli_8c.html#fb3c7b069abee786fac0195e698d4bd9">cli_cli</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00973">973</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="08ffcfa9a09480d0d07517d7600ed61b"></a><!-- doxytag: member="cli.c::cli_debug_channel_deprecated" ref="08ffcfa9a09480d0d07517d7600ed61b" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> <a class="el" href="cli_8c.html#08ffcfa9a09480d0d07517d7600ed61b">cli_debug_channel_deprecated</a> = NEW_CLI(handle_debugchan_deprecated, &quot;Enable debugging on channel&quot;)<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00966">966</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="15dd226c7128f3f9815296162cacca68"></a><!-- doxytag: member="cli.c::cli_module_load_deprecated" ref="15dd226c7128f3f9815296162cacca68" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> <a class="el" href="cli_8c.html#15dd226c7128f3f9815296162cacca68">cli_module_load_deprecated</a> = NEW_CLI(handle_load_deprecated, &quot;Load a module&quot;)<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00967">967</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="6c494c05c3aecb8ad55097db35a2cb6f"></a><!-- doxytag: member="cli.c::cli_module_reload_deprecated" ref="6c494c05c3aecb8ad55097db35a2cb6f" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> <a class="el" href="cli_8c.html#6c494c05c3aecb8ad55097db35a2cb6f">cli_module_reload_deprecated</a> = NEW_CLI(handle_reload_deprecated, &quot;reload <a class="el" href="pbx__gtkconsole_8c.html#0eb9b3af2e4a00837a1b1a854c9ea18c">modules</a> by <a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>&quot;)<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00968">968</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="32e73832d7844e9a68d5491ee65cbe3e"></a><!-- doxytag: member="cli.c::cli_module_unload_deprecated" ref="32e73832d7844e9a68d5491ee65cbe3e" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> <a class="el" href="cli_8c.html#32e73832d7844e9a68d5491ee65cbe3e">cli_module_unload_deprecated</a> = NEW_CLI(handle_unload_deprecated, &quot;unload <a class="el" href="pbx__gtkconsole_8c.html#0eb9b3af2e4a00837a1b1a854c9ea18c">modules</a> by <a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>&quot;)<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00969">969</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="ec0a0fff99f9155021d653f2f1109fbc"></a><!-- doxytag: member="cli.c::cli_rsvd" ref="ec0a0fff99f9155021d653f2f1109fbc" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char <a class="el" href="cli_8c.html#ec0a0fff99f9155021d653f2f1109fbc">cli_rsvd</a>[] = &quot;[]{}|*%&quot;<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Some regexp characters in cli arguments are reserved and used as separators. 
<p>
Definition at line <a class="el" href="cli_8c-source.html#l01016">1016</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l01127">is_prefix()</a>, <a class="el" href="cli_8c-source.html#l01022">set_full_cmd()</a>, and <a class="el" href="cli_8c-source.html#l01098">word_match()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="ade24f5837e1c073d2e7cfc2adc4073c"></a><!-- doxytag: member="cli.c::climodentryfd" ref="ade24f5837e1c073d2e7cfc2adc4073c" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="cli_8c.html#ade24f5837e1c073d2e7cfc2adc4073c">climodentryfd</a> = -1<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cli_8c-source.html#l00318">318</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l00413">handle_modlist()</a>, and <a class="el" href="cli_8c-source.html#l00320">modlist_modentry()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="41485dee80c67f6efe342780bd239f34"></a><!-- doxytag: member="cli.c::commandcomplete_help" ref="41485dee80c67f6efe342780bd239f34" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char <a class="el" href="cli_8c.html#41485dee80c67f6efe342780bd239f34">commandcomplete_help</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> 
<span class="stringliteral">"Usage: _command complete \"&lt;line&gt;\" text state\n"</span>
<span class="stringliteral">"       This function is used internally to help with command completion and should.\n"</span>
<span class="stringliteral">"       never be called by the user directly.\n"</span>
</pre></div>
<p>
Definition at line <a class="el" href="cli_8c-source.html#l00573">573</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="613059ef43215b5ccff9f74e8534ebac"></a><!-- doxytag: member="cli.c::commandmatchesarray_help" ref="613059ef43215b5ccff9f74e8534ebac" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char <a class="el" href="cli_8c.html#613059ef43215b5ccff9f74e8534ebac">commandmatchesarray_help</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> 
<span class="stringliteral">"Usage: _command matchesarray \"&lt;line&gt;\" text \n"</span>
<span class="stringliteral">"       This function is used internally to help with command completion and should.\n"</span>
<span class="stringliteral">"       never be called by the user directly.\n"</span>
</pre></div>
<p>
Definition at line <a class="el" href="cli_8c-source.html#l00583">583</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="b42edb1b1bf15c462f8db1b721930ac5"></a><!-- doxytag: member="cli.c::commandnummatches_help" ref="b42edb1b1bf15c462f8db1b721930ac5" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char <a class="el" href="cli_8c.html#b42edb1b1bf15c462f8db1b721930ac5">commandnummatches_help</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> 
<span class="stringliteral">"Usage: _command nummatches \"&lt;line&gt;\" text \n"</span>
<span class="stringliteral">"       This function is used internally to help with command completion and should.\n"</span>
<span class="stringliteral">"       never be called by the user directly.\n"</span>
</pre></div>
<p>
Definition at line <a class="el" href="cli_8c-source.html#l00578">578</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="7cde9a0914613eb0fbded6201fc9ccb6"></a><!-- doxytag: member="cli.c::group_show_channels_help" ref="7cde9a0914613eb0fbded6201fc9ccb6" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char <a class="el" href="cli_8c.html#7cde9a0914613eb0fbded6201fc9ccb6">group_show_channels_help</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> 
<span class="stringliteral">"Usage: group show channels [pattern]\n"</span>
<span class="stringliteral">"       Lists all currently active channels with channel group(s) specified.\n"</span>
<span class="stringliteral">"       Optional regular expression pattern is matched to group names for each\n"</span>
<span class="stringliteral">"       channel.\n"</span>
</pre></div>
<p>
Definition at line <a class="el" href="cli_8c-source.html#l00086">86</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="80bbfb4f5eca7598f139bef36cd1e452"></a><!-- doxytag: member="cli.c::logger_mute_help" ref="80bbfb4f5eca7598f139bef36cd1e452" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char <a class="el" href="cli_8c.html#80bbfb4f5eca7598f139bef36cd1e452">logger_mute_help</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> 
<span class="stringliteral">"Usage: logger mute\n"</span>
<span class="stringliteral">"       Disables logging output to the current console, making it possible to\n"</span>
<span class="stringliteral">"       gather information without being disturbed by scrolling lines.\n"</span>
</pre></div>
<p>
Definition at line <a class="el" href="cli_8c-source.html#l00076">76</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="48a9bfdf23414caddbcb373a4366ba5d"></a><!-- doxytag: member="cli.c::showchan_help" ref="48a9bfdf23414caddbcb373a4366ba5d" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char <a class="el" href="cli_8c.html#48a9bfdf23414caddbcb373a4366ba5d">showchan_help</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> 
<span class="stringliteral">"Usage: core show channel &lt;channel&gt;\n"</span>
<span class="stringliteral">"       Shows lots of information about the specified channel.\n"</span>
</pre></div>
<p>
Definition at line <a class="el" href="cli_8c-source.html#l00569">569</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="9b0ab32fcf13cf20985eb791a90fd769"></a><!-- doxytag: member="cli.c::softhangup_help" ref="9b0ab32fcf13cf20985eb791a90fd769" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char <a class="el" href="cli_8c.html#9b0ab32fcf13cf20985eb791a90fd769">softhangup_help</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment">
<span class="stringliteral">"Usage: soft hangup &lt;channel&gt;\n"</span>
<span class="stringliteral">"       Request that a channel be hung up. The hangup takes effect\n"</span>
<span class="stringliteral">"       the next time the driver reads or writes from the channel\n"</span>
</pre></div>
<p>
Definition at line <a class="el" href="cli_8c-source.html#l00081">81</a> of file <a class="el" href="cli_8c-source.html">cli.c</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Thu May 24 22:27:25 2007 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.5 </small></address>
</body>
</html>
