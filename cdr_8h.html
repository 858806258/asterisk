<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (24 May 2007)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Thu May 24 22:27:05 2007</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir__2Fusr_2Flocal_2Fsrc_2Fasterisk_2Esvn_2Fastum_2Finclude_2F.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir__2Fusr_2Flocal_2Fsrc_2Fasterisk_2Esvn_2Fastum_2Finclude_2Fasterisk_2F.html">asterisk</a></div>
<h1>cdr.h File Reference</h1>Call Detail Record API. <a href="#_details">More...</a>
<p>
<code>#include &lt;sys/time.h&gt;</code><br>
<code>#include &quot;<a class="el" href="channel_8h-source.html">asterisk/channel.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="utils_8h-source.html">asterisk/utils.h</a>&quot;</code><br>

<p>
<a href="cdr_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__cdr.html">ast_cdr</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#a59fc2b798f793108e7aaa9336a2bdca">AST_CDR_ANSWERED</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 3)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#14e22de39a376518640e186e30771448">AST_CDR_BILLING</a>&nbsp;&nbsp;&nbsp;(2)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#b837fb3660bc208d03a6465977c69569">AST_CDR_BUSY</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#cf90483acda7d67a0e9dec8a639189a9">AST_CDR_DOCUMENTATION</a>&nbsp;&nbsp;&nbsp;(3)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#3620f370e858ef80414c7e7c6c2ac466">AST_CDR_FAILED</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#975bd6a62384980a402ff1093dde3fd3">AST_CDR_FLAG_CHILD</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 3)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#2c2a1ca2e0c5a764d651abf71b35a520">AST_CDR_FLAG_KEEP_VARS</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#372c8464bd559bdb42452d12d39457e4">AST_CDR_FLAG_LOCKED</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 2)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#afadf88618596cfa2690f6704c45ff3f">AST_CDR_FLAG_POST_DISABLED</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 4)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#12df3b2bc8941512329b4cf3f2019a11">AST_CDR_FLAG_POSTED</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#156b91b117f2b53d1a18200fe726fbbc">AST_CDR_NOANSWER</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 2)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#25213252a0ee6b57d3e5d58dfea1b2b8">AST_CDR_NULL</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#bda2560fadee8446e4d5f878ab0c7fe2">AST_CDR_OMIT</a>&nbsp;&nbsp;&nbsp;(1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#d8d4da3f29223013ea5caf3addc18000">AST_MAX_ACCOUNT_CODE</a>&nbsp;&nbsp;&nbsp;20</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#6e268c01e8222fa4b88f10a767ff678b">AST_MAX_USER_FIELD</a>&nbsp;&nbsp;&nbsp;256</td></tr>

<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef int(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#14a5f088dfa645e72346b9311ecb146b">ast_cdrbe</a> )(struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr)</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#0dd431954a27c67f78c6e13be8a0b136">ast_cdr_alloc</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allocate a CDR record Returns a malloc'd <a class="el" href="structast__cdr.html">ast_cdr</a> structure, returns NULL on error (malloc failure).  <a href="#0dd431954a27c67f78c6e13be8a0b136"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#3b703edfed7ece1e9f55e5a31fcec203">ast_cdr_amaflags2int</a> (const char *flag)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#aa59616c49400bc9f58095b2b3f73781">ast_cdr_answer</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#45f0cb9bdab7262e5e359e8b722ea3e7">ast_cdr_append</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr, struct <a class="el" href="structast__cdr.html">ast_cdr</a> *newcdr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#4ba69b96a8d7733c5e70a5555e94306f">ast_cdr_appenduserfield</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *userfield)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#c18f3563260674ed152b367fcb7a12b1">ast_cdr_busy</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#497a3c154e778ee54e2bbc27f0219bcb">ast_cdr_copy_vars</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *to_cdr, struct <a class="el" href="structast__cdr.html">ast_cdr</a> *from_cdr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#b20947a5170d08a12a3cee0498e07614">ast_cdr_detach</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#46e80e6b7ec200439ddd4fc6bdea4f5b">ast_cdr_discard</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Discard and free a CDR record.  <a href="#46e80e6b7ec200439ddd4fc6bdea4f5b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#75620a3cdcb74f7f7c74ac183f0db801">ast_cdr_disp2str</a> (int disposition)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#995ca95113dc7070faca1a0969a72eb9">ast_cdr_disposition</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr, int cause)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#8538ec9cb930d571cf367e372726d706">ast_cdr_dup</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Duplicate a record Returns a malloc'd <a class="el" href="structast__cdr.html">ast_cdr</a> structure, returns NULL on error (malloc failure).  <a href="#8538ec9cb930d571cf367e372726d706"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#545d0bb7a87e9317b6eb3ce2245145cc">ast_cdr_end</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#48500564f37446080efea14e1020c3bb">ast_cdr_engine_init</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#60593c449a8a3978fbf48cba7f2459ed">ast_cdr_engine_reload</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#4e0ac05663cd08d6d25819f703463d7f">ast_cdr_engine_term</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#3f2e573eb7fde7a250ca8aa95a0d367d">ast_cdr_failed</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#265bbad802c844fbbc72fb5bfc1d096a">ast_cdr_flags2str</a> (int flags)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#c8ac6bad318e1e800b23bf62e33ee775">ast_cdr_free</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free a CDR record.  <a href="#c8ac6bad318e1e800b23bf62e33ee775"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#79c41fd063e958a3702a0773190dbf58">ast_cdr_free_vars</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr, int recur)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#9e9ccbed2b4365369048829d27fad973">ast_cdr_getvar</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr, const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, char **ret, char *workspace, int workspacelen, int recur, int raw)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#6ae0d5a38580d55c275752bc7357f228">ast_cdr_init</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr, struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize based on a channel.  <a href="#6ae0d5a38580d55c275752bc7357f228"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#b7fa0bd117aed5d3693e653d00985aa0">ast_cdr_merge</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *to, struct <a class="el" href="structast__cdr.html">ast_cdr</a> *from)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#b25a58ff542a14baeb012c2728b174c8">ast_cdr_noanswer</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#ccdb62d8fe6850e472a58bada0aa23b1">ast_cdr_register</a> (const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, const char *<a class="el" href="cdr__sqlite3__custom_8c.html#1dee80c7d5ab2c1c90aa8d2f7dd47256">desc</a>, <a class="el" href="cdr_8h.html#14a5f088dfa645e72346b9311ecb146b">ast_cdrbe</a> be)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#a6a3c56be870fddae262b46a6107107f">ast_cdr_reset</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr, struct <a class="el" href="structast__flags.html">ast_flags</a> *flags)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#012c9aed35828d7a2bd4581c29da37e2">ast_cdr_serialize_variables</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr, struct <a class="el" href="structast__str.html">ast_str</a> **<a class="el" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>, char delim, char sep, int recur)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#8aa58d36e6bd15ba7d10e367d9870e60">ast_cdr_setaccount</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *account)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#fc85f2cc535a9122f7d6ecd3fc7b109a">ast_cdr_setamaflags</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="chan__skinny_8c.html#d5aa4bb1461fe3d863bd95fb137e2284">amaflags</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#018b6c8a00209b6cf1fd7386b493f930">ast_cdr_setapp</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr, char *<a class="el" href="res__agi_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>, char *data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#f0b0c703dd296420e2be0b33938fa1e6">ast_cdr_setcid</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr, struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#b4a7713b2ae462d79a380623ed2f4e21">ast_cdr_setdestchan</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr, const char *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#7faf485af47fef9299ce51da70c13c8b">ast_cdr_setuserfield</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *userfield)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#5f441d69a57278fe59d34458e215fae5">ast_cdr_setvar</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr, const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, const char *value, int recur)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#56e1b7b9d5acada4d22d345813710582">ast_cdr_start</a> (struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#b77b4351337e066e9c9e97e5f528d46a">ast_cdr_submit_batch</a> (int shutdown)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#96eff2f7a72924e9ce8a342824e00465">ast_cdr_unregister</a> (const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#93884b34915ee737f1a050ba33744fea">ast_cdr_update</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#26604a41e0aec0115baed803201cd74b">check_cdr_enabled</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return TRUE if CDR subsystem is enabled.  <a href="#26604a41e0aec0115baed803201cd74b"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#77219a32a253309bd3900aedd6cf8d07">ast_default_accountcode</a> [AST_MAX_ACCOUNT_CODE]</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cdr_8h.html#d5268e5dc9c134f0ce5f28da7a447335">ast_default_amaflags</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Call Detail Record API. 
<p>

<p>
Definition in file <a class="el" href="cdr_8h-source.html">cdr.h</a>.<hr><h2>Define Documentation</h2>
<a class="anchor" name="a59fc2b798f793108e7aaa9336a2bdca"></a><!-- doxytag: member="cdr.h::AST_CDR_ANSWERED" ref="a59fc2b798f793108e7aaa9336a2bdca" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_CDR_ANSWERED&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 3)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8h-source.html#l00037">37</a> of file <a class="el" href="cdr_8h-source.html">cdr.h</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l00633">ast_cdr_answer()</a>, <a class="el" href="cdr_8c-source.html#l00803">ast_cdr_disp2str()</a>, and <a class="el" href="cdr_8c-source.html#l00763">ast_cdr_init()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="14e22de39a376518640e186e30771448"></a><!-- doxytag: member="cdr.h::AST_CDR_BILLING" ref="14e22de39a376518640e186e30771448" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_CDR_BILLING&nbsp;&nbsp;&nbsp;(2)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8h-source.html#l00041">41</a> of file <a class="el" href="cdr_8h-source.html">cdr.h</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l00906">ast_cdr_amaflags2int()</a>, and <a class="el" href="cdr_8c-source.html#l00821">ast_cdr_flags2str()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="b837fb3660bc208d03a6465977c69569"></a><!-- doxytag: member="cdr.h::AST_CDR_BUSY" ref="b837fb3660bc208d03a6465977c69569" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_CDR_BUSY&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 1)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8h-source.html#l00035">35</a> of file <a class="el" href="cdr_8h-source.html">cdr.h</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l00645">ast_cdr_busy()</a>, and <a class="el" href="cdr_8c-source.html#l00803">ast_cdr_disp2str()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="cf90483acda7d67a0e9dec8a639189a9"></a><!-- doxytag: member="cdr.h::AST_CDR_DOCUMENTATION" ref="cf90483acda7d67a0e9dec8a639189a9" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_CDR_DOCUMENTATION&nbsp;&nbsp;&nbsp;(3)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8h-source.html#l00042">42</a> of file <a class="el" href="cdr_8h-source.html">cdr.h</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l00906">ast_cdr_amaflags2int()</a>, and <a class="el" href="cdr_8c-source.html#l00821">ast_cdr_flags2str()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="3620f370e858ef80414c7e7c6c2ac466"></a><!-- doxytag: member="cdr.h::AST_CDR_FAILED" ref="3620f370e858ef80414c7e7c6c2ac466" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_CDR_FAILED&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8h-source.html#l00034">34</a> of file <a class="el" href="cdr_8h-source.html">cdr.h</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l00803">ast_cdr_disp2str()</a>, <a class="el" href="cdr_8c-source.html#l00788">ast_cdr_end()</a>, and <a class="el" href="cdr_8c-source.html#l00657">ast_cdr_failed()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="975bd6a62384980a402ff1093dde3fd3"></a><!-- doxytag: member="cdr.h::AST_CDR_FLAG_CHILD" ref="975bd6a62384980a402ff1093dde3fd3" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_CDR_FLAG_CHILD&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 3)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8h-source.html#l00030">30</a> of file <a class="el" href="cdr_8h-source.html">cdr.h</a>.
<p>
Referenced by <a class="el" href="app__forkcdr_8c-source.html#l00054">ast_cdr_fork()</a>, and <a class="el" href="cdr_8c-source.html#l00504">ast_cdr_merge()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="2c2a1ca2e0c5a764d651abf71b35a520"></a><!-- doxytag: member="cdr.h::AST_CDR_FLAG_KEEP_VARS" ref="2c2a1ca2e0c5a764d651abf71b35a520" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_CDR_FLAG_KEEP_VARS&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8h-source.html#l00027">27</a> of file <a class="el" href="cdr_8h-source.html">cdr.h</a>.
<p>
Referenced by <a class="el" href="app__forkcdr_8c-source.html#l00054">ast_cdr_fork()</a>, <a class="el" href="cdr_8c-source.html#l00504">ast_cdr_merge()</a>, <a class="el" href="cdr_8c-source.html#l00942">ast_cdr_reset()</a>, and <a class="el" href="app__forkcdr_8c-source.html#l00077">forkcdr_exec()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="372c8464bd559bdb42452d12d39457e4"></a><!-- doxytag: member="cdr.h::AST_CDR_FLAG_LOCKED" ref="372c8464bd559bdb42452d12d39457e4" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_CDR_FLAG_LOCKED&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 2)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8h-source.html#l00029">29</a> of file <a class="el" href="cdr_8h-source.html">cdr.h</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l00871">ast_cdr_appenduserfield()</a>, <a class="el" href="cdr_8c-source.html#l00645">ast_cdr_busy()</a>, <a class="el" href="cdr_8c-source.html#l00657">ast_cdr_failed()</a>, <a class="el" href="app__forkcdr_8c-source.html#l00054">ast_cdr_fork()</a>, <a class="el" href="cdr_8c-source.html#l00763">ast_cdr_init()</a>, <a class="el" href="cdr_8c-source.html#l00504">ast_cdr_merge()</a>, <a class="el" href="cdr_8c-source.html#l00668">ast_cdr_noanswer()</a>, <a class="el" href="cdr_8c-source.html#l00942">ast_cdr_reset()</a>, <a class="el" href="cdr_8c-source.html#l00834">ast_cdr_setaccount()</a>, <a class="el" href="cdr_8c-source.html#l00718">ast_cdr_setapp()</a>, <a class="el" href="cdr_8c-source.html#l00754">ast_cdr_setcid()</a>, <a class="el" href="cdr_8c-source.html#l00709">ast_cdr_setdestchan()</a>, <a class="el" href="cdr_8c-source.html#l00859">ast_cdr_setuserfield()</a>, <a class="el" href="cdr_8c-source.html#l00620">ast_cdr_start()</a>, and <a class="el" href="cdr_8c-source.html#l00885">ast_cdr_update()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="afadf88618596cfa2690f6704c45ff3f"></a><!-- doxytag: member="cdr.h::AST_CDR_FLAG_POST_DISABLED" ref="afadf88618596cfa2690f6704c45ff3f" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_CDR_FLAG_POST_DISABLED&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 4)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8h-source.html#l00031">31</a> of file <a class="el" href="cdr_8h-source.html">cdr.h</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l01087">ast_cdr_detach()</a>, <a class="el" href="cdr_8c-source.html#l00429">ast_cdr_free()</a>, <a class="el" href="cdr_8c-source.html#l00504">ast_cdr_merge()</a>, <a class="el" href="app__cdr_8c-source.html#l00047">nocdr_exec()</a>, and <a class="el" href="cdr_8c-source.html#l00919">post_cdr()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="12df3b2bc8941512329b4cf3f2019a11"></a><!-- doxytag: member="cdr.h::AST_CDR_FLAG_POSTED" ref="12df3b2bc8941512329b4cf3f2019a11" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_CDR_FLAG_POSTED&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 1)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8h-source.html#l00028">28</a> of file <a class="el" href="cdr_8h-source.html">cdr.h</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l00429">ast_cdr_free()</a>, <a class="el" href="cdr_8c-source.html#l00504">ast_cdr_merge()</a>, <a class="el" href="cdr_8c-source.html#l00668">ast_cdr_noanswer()</a>, <a class="el" href="cdr_8c-source.html#l00942">ast_cdr_reset()</a>, <a class="el" href="cdr_8c-source.html#l00421">check_post()</a>, and <a class="el" href="cdr_8c-source.html#l00919">post_cdr()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="156b91b117f2b53d1a18200fe726fbbc"></a><!-- doxytag: member="cdr.h::AST_CDR_NOANSWER" ref="156b91b117f2b53d1a18200fe726fbbc" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_CDR_NOANSWER&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 2)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8h-source.html#l00036">36</a> of file <a class="el" href="cdr_8h-source.html">cdr.h</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l00803">ast_cdr_disp2str()</a>, <a class="el" href="cdr_8c-source.html#l00504">ast_cdr_merge()</a>, and <a class="el" href="cdr_8c-source.html#l00668">ast_cdr_noanswer()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="25213252a0ee6b57d3e5d58dfea1b2b8"></a><!-- doxytag: member="cdr.h::AST_CDR_NULL" ref="25213252a0ee6b57d3e5d58dfea1b2b8" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_CDR_NULL&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8h-source.html#l00033">33</a> of file <a class="el" href="cdr_8h-source.html">cdr.h</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l00803">ast_cdr_disp2str()</a>, <a class="el" href="cdr_8c-source.html#l00763">ast_cdr_init()</a>, and <a class="el" href="cdr_8c-source.html#l00942">ast_cdr_reset()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="bda2560fadee8446e4d5f878ab0c7fe2"></a><!-- doxytag: member="cdr.h::AST_CDR_OMIT" ref="bda2560fadee8446e4d5f878ab0c7fe2" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_CDR_OMIT&nbsp;&nbsp;&nbsp;(1)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
AMA Flags 
<p>
Definition at line <a class="el" href="cdr_8h-source.html#l00040">40</a> of file <a class="el" href="cdr_8h-source.html">cdr.h</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l00906">ast_cdr_amaflags2int()</a>, and <a class="el" href="cdr_8c-source.html#l00821">ast_cdr_flags2str()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="d8d4da3f29223013ea5caf3addc18000"></a><!-- doxytag: member="cdr.h::AST_MAX_ACCOUNT_CODE" ref="d8d4da3f29223013ea5caf3addc18000" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_MAX_ACCOUNT_CODE&nbsp;&nbsp;&nbsp;20          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8h-source.html#l00045">45</a> of file <a class="el" href="cdr_8h-source.html">cdr.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="6e268c01e8222fa4b88f10a767ff678b"></a><!-- doxytag: member="cdr.h::AST_MAX_USER_FIELD" ref="6e268c01e8222fa4b88f10a767ff678b" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_MAX_USER_FIELD&nbsp;&nbsp;&nbsp;256          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8h-source.html#l00044">44</a> of file <a class="el" href="cdr_8h-source.html">cdr.h</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="14a5f088dfa645e72346b9311ecb146b"></a><!-- doxytag: member="cdr.h::ast_cdrbe" ref="14a5f088dfa645e72346b9311ecb146b" args=")(struct ast_cdr *cdr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">typedef int(* <a class="el" href="cdr_8h.html#14a5f088dfa645e72346b9311ecb146b">ast_cdrbe</a>)(struct <a class="el" href="structast__cdr.html">ast_cdr</a> *cdr)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8h-source.html#l00104">104</a> of file <a class="el" href="cdr_8h-source.html">cdr.h</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="0dd431954a27c67f78c6e13be8a0b136"></a><!-- doxytag: member="cdr.h::ast_cdr_alloc" ref="0dd431954a27c67f78c6e13be8a0b136" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a>* ast_cdr_alloc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Allocate a CDR record Returns a malloc'd <a class="el" href="structast__cdr.html">ast_cdr</a> structure, returns NULL on error (malloc failure). 
<p>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00460">460</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, and <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>.
<p>
Referenced by <a class="el" href="chan__agent_8c-source.html#l00394">__agent_start_monitoring()</a>, <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>, <a class="el" href="channel_8c-source.html#l02060">__ast_read()</a>, <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="cdr_8c-source.html#l00171">ast_cdr_dup()</a>, <a class="el" href="channel_8c-source.html#l00632">ast_channel_alloc()</a>, <a class="el" href="res__features_8c-source.html#l01295">ast_feature_request_and_dial()</a>, <a class="el" href="pbx_8c-source.html#l05150">ast_pbx_outgoing_app()</a>, <a class="el" href="res__features_8c-source.html#l00673">builtin_blindtransfer()</a>, <a class="el" href="app__followme_8c-source.html#l00428">clear_caller()</a>, <a class="el" href="app__followme_8c-source.html#l00763">findmeexec()</a>, and <a class="el" href="res__monitor_8c-source.html#l00389">start_monitor_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l00461"></a>00461 {
<a name="l00462"></a>00462    <span class="keyword">struct </span><a class="code" href="structast__cdr.html">ast_cdr</a> *x = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structast__cdr.html">ast_cdr</a>));
<a name="l00463"></a>00463    <span class="keywordflow">if</span> (!x)
<a name="l00464"></a>00464       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>,<span class="stringliteral">"Allocation Failure for a CDR!\n"</span>);
<a name="l00465"></a>00465    <span class="keywordflow">return</span> x;
<a name="l00466"></a>00466 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3b703edfed7ece1e9f55e5a31fcec203"></a><!-- doxytag: member="cdr.h::ast_cdr_amaflags2int" ref="3b703edfed7ece1e9f55e5a31fcec203" args="(const char *flag)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cdr_amaflags2int           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>flag</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>flag</em>&nbsp;</td><td>string form of flag Converts the string form of the flag to the binary form. Returns the binary form of the flag </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00906">906</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00041">AST_CDR_BILLING</a>, <a class="el" href="cdr_8h-source.html#l00042">AST_CDR_DOCUMENTATION</a>, and <a class="el" href="cdr_8h-source.html#l00040">AST_CDR_OMIT</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l00847">ast_cdr_setamaflags()</a>, <a class="el" href="chan__skinny_8c-source.html#l02102">build_device()</a>, <a class="el" href="chan__mgcp_8c-source.html#l03593">build_gateway()</a>, <a class="el" href="chan__sip_8c-source.html#l16894">build_peer()</a>, <a class="el" href="chan__h323_8c-source.html#l01370">build_user()</a>, and <a class="el" href="chan__zap_8c-source.html#l11882">process_zap()</a>.<div class="fragment"><pre class="fragment"><a name="l00907"></a>00907 {
<a name="l00908"></a>00908    <span class="keywordflow">if</span> (!strcasecmp(flag, <span class="stringliteral">"default"</span>))
<a name="l00909"></a>00909       <span class="keywordflow">return</span> 0;
<a name="l00910"></a>00910    <span class="keywordflow">if</span> (!strcasecmp(flag, <span class="stringliteral">"omit"</span>))
<a name="l00911"></a>00911       <span class="keywordflow">return</span> <a class="code" href="cdr_8h.html#bda2560fadee8446e4d5f878ab0c7fe2">AST_CDR_OMIT</a>;
<a name="l00912"></a>00912    <span class="keywordflow">if</span> (!strcasecmp(flag, <span class="stringliteral">"billing"</span>))
<a name="l00913"></a>00913       <span class="keywordflow">return</span> <a class="code" href="cdr_8h.html#14e22de39a376518640e186e30771448">AST_CDR_BILLING</a>;
<a name="l00914"></a>00914    <span class="keywordflow">if</span> (!strcasecmp(flag, <span class="stringliteral">"documentation"</span>))
<a name="l00915"></a>00915       <span class="keywordflow">return</span> <a class="code" href="cdr_8h.html#cf90483acda7d67a0e9dec8a639189a9">AST_CDR_DOCUMENTATION</a>;
<a name="l00916"></a>00916    <span class="keywordflow">return</span> -1;
<a name="l00917"></a>00917 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="aa59616c49400bc9f58095b2b3f73781"></a><!-- doxytag: member="cdr.h::ast_cdr_answer" ref="aa59616c49400bc9f58095b2b3f73781" args="(struct ast_cdr *cdr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_cdr_answer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>cdr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cdr</em>&nbsp;</td><td>the cdr you wish to associate with the call Starts all CDR stuff necessary for doing CDR when answering a call NULL argument is just fine. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00633">633</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00072">ast_cdr::answer</a>, <a class="el" href="cdr_8h-source.html#l00037">AST_CDR_ANSWERED</a>, <a class="el" href="cdr_8c-source.html#l00421">check_post()</a>, <a class="el" href="cdr_8h-source.html#l00080">ast_cdr::disposition</a>, and <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l01682">__ast_answer()</a>, and <a class="el" href="channel_8c-source.html#l02060">__ast_read()</a>.<div class="fragment"><pre class="fragment"><a name="l00634"></a>00634 {
<a name="l00635"></a>00635 
<a name="l00636"></a>00636    <span class="keywordflow">for</span> (; cdr; cdr = cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l00637"></a>00637       <a class="code" href="cdr_8c.html#5b89f2cf8a1628735231e82ad14e36d3">check_post</a>(cdr);
<a name="l00638"></a>00638       <span class="keywordflow">if</span> (cdr-&gt;<a class="code" href="structast__cdr.html#6cfe0c68cd195b63c8486325b447b1c7">disposition</a> &lt; <a class="code" href="cdr_8h.html#a59fc2b798f793108e7aaa9336a2bdca">AST_CDR_ANSWERED</a>)
<a name="l00639"></a>00639          cdr-&gt;<a class="code" href="structast__cdr.html#6cfe0c68cd195b63c8486325b447b1c7">disposition</a> = <a class="code" href="cdr_8h.html#a59fc2b798f793108e7aaa9336a2bdca">AST_CDR_ANSWERED</a>;
<a name="l00640"></a>00640       <span class="keywordflow">if</span> (ast_tvzero(cdr-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a>))
<a name="l00641"></a>00641          cdr-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a> = ast_tvnow();
<a name="l00642"></a>00642    }
<a name="l00643"></a>00643 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="45f0cb9bdab7262e5e359e8b722ea3e7"></a><!-- doxytag: member="cdr.h::ast_cdr_append" ref="45f0cb9bdab7262e5e359e8b722ea3e7" args="(struct ast_cdr *cdr, struct ast_cdr *newcdr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a>* ast_cdr_append           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>cdr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>newcdr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00979">979</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>.
<p>
Referenced by <a class="el" href="app__forkcdr_8c-source.html#l00054">ast_cdr_fork()</a>, <a class="el" href="cdr_8c-source.html#l00504">ast_cdr_merge()</a>, and <a class="el" href="chan__sip_8c-source.html#l13672">attempt_transfer()</a>.<div class="fragment"><pre class="fragment"><a name="l00980"></a>00980 {
<a name="l00981"></a>00981    <span class="keyword">struct </span><a class="code" href="structast__cdr.html">ast_cdr</a> *ret;
<a name="l00982"></a>00982 
<a name="l00983"></a>00983    <span class="keywordflow">if</span> (cdr) {
<a name="l00984"></a>00984       ret = cdr;
<a name="l00985"></a>00985 
<a name="l00986"></a>00986       <span class="keywordflow">while</span> (cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>)
<a name="l00987"></a>00987          cdr = cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l00988"></a>00988       cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = newcdr;
<a name="l00989"></a>00989    } <span class="keywordflow">else</span> {
<a name="l00990"></a>00990       ret = newcdr;
<a name="l00991"></a>00991    }
<a name="l00992"></a>00992 
<a name="l00993"></a>00993    <span class="keywordflow">return</span> ret;
<a name="l00994"></a>00994 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4ba69b96a8d7733c5e70a5555e94306f"></a><!-- doxytag: member="cdr.h::ast_cdr_appenduserfield" ref="4ba69b96a8d7733c5e70a5555e94306f" args="(struct ast_channel *chan, const char *userfield)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cdr_appenduserfield           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>userfield</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00871">871</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00029">AST_CDR_FLAG_LOCKED</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, <a class="el" href="utils_8h-source.html#l00386">len</a>, <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>, and <a class="el" href="cdr_8h-source.html#l00090">ast_cdr::userfield</a>.
<p>
Referenced by <a class="el" href="res__features_8c-source.html#l01478">ast_bridge_call()</a>.<div class="fragment"><pre class="fragment"><a name="l00872"></a>00872 {
<a name="l00873"></a>00873    <span class="keyword">struct </span><a class="code" href="structast__cdr.html">ast_cdr</a> *cdr = chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>;
<a name="l00874"></a>00874 
<a name="l00875"></a>00875    <span class="keywordflow">for</span> ( ; cdr ; cdr = cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l00876"></a>00876       <span class="keywordtype">int</span> <a class="code" href="utils_8h.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a> = strlen(cdr-&gt;<a class="code" href="structast__cdr.html#07c0f6b6a5bf53c1c68383f1f0c9398e">userfield</a>);
<a name="l00877"></a>00877 
<a name="l00878"></a>00878       <span class="keywordflow">if</span> (!<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(cdr, <a class="code" href="cdr_8h.html#372c8464bd559bdb42452d12d39457e4">AST_CDR_FLAG_LOCKED</a>))
<a name="l00879"></a>00879          ast_copy_string(cdr-&gt;<a class="code" href="structast__cdr.html#07c0f6b6a5bf53c1c68383f1f0c9398e">userfield</a> + len, <a class="code" href="structast__cdr.html#07c0f6b6a5bf53c1c68383f1f0c9398e">userfield</a>, <span class="keyword">sizeof</span>(cdr-&gt;<a class="code" href="structast__cdr.html#07c0f6b6a5bf53c1c68383f1f0c9398e">userfield</a>) - len);
<a name="l00880"></a>00880    }
<a name="l00881"></a>00881 
<a name="l00882"></a>00882    <span class="keywordflow">return</span> 0;
<a name="l00883"></a>00883 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c18f3563260674ed152b367fcb7a12b1"></a><!-- doxytag: member="cdr.h::ast_cdr_busy" ref="c18f3563260674ed152b367fcb7a12b1" args="(struct ast_cdr *cdr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_cdr_busy           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>cdr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cdr</em>&nbsp;</td><td>the cdr you wish to associate with the call Returns nothing </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00645">645</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00035">AST_CDR_BUSY</a>, <a class="el" href="cdr_8h-source.html#l00029">AST_CDR_FLAG_LOCKED</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="cdr_8c-source.html#l00421">check_post()</a>, and <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l00684">ast_cdr_disposition()</a>, <a class="el" href="app__dial_8c-source.html#l00333">handle_cause()</a>, <a class="el" href="app__queue_8c-source.html#l01660">ring_entry()</a>, and <a class="el" href="app__queue_8c-source.html#l01950">wait_for_answer()</a>.<div class="fragment"><pre class="fragment"><a name="l00646"></a>00646 {
<a name="l00647"></a>00647 
<a name="l00648"></a>00648    <span class="keywordflow">for</span> (; cdr; cdr = cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l00649"></a>00649       <span class="keywordflow">if</span> (!<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(cdr, <a class="code" href="cdr_8h.html#372c8464bd559bdb42452d12d39457e4">AST_CDR_FLAG_LOCKED</a>)) {
<a name="l00650"></a>00650          <a class="code" href="cdr_8c.html#5b89f2cf8a1628735231e82ad14e36d3">check_post</a>(cdr);
<a name="l00651"></a>00651          <span class="keywordflow">if</span> (cdr-&gt;<a class="code" href="structast__cdr.html#6cfe0c68cd195b63c8486325b447b1c7">disposition</a> &lt; <a class="code" href="cdr_8h.html#b837fb3660bc208d03a6465977c69569">AST_CDR_BUSY</a>)
<a name="l00652"></a>00652             cdr-&gt;<a class="code" href="structast__cdr.html#6cfe0c68cd195b63c8486325b447b1c7">disposition</a> = <a class="code" href="cdr_8h.html#b837fb3660bc208d03a6465977c69569">AST_CDR_BUSY</a>;
<a name="l00653"></a>00653       }
<a name="l00654"></a>00654    }
<a name="l00655"></a>00655 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="497a3c154e778ee54e2bbc27f0219bcb"></a><!-- doxytag: member="cdr.h::ast_cdr_copy_vars" ref="497a3c154e778ee54e2bbc27f0219bcb" args="(struct ast_cdr *to_cdr, struct ast_cdr *from_cdr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cdr_copy_vars           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>to_cdr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>from_cdr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00337">337</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00650">AST_LIST_INSERT_HEAD</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="chanvars_8c-source.html#l00039">ast_var_assign()</a>, <a class="el" href="chanvars_8c-source.html#l00062">ast_var_name()</a>, <a class="el" href="chanvars_8c-source.html#l00082">ast_var_value()</a>, <a class="el" href="ast__expr2f_8c-source.html#l01417">var</a>, and <a class="el" href="cdr_8h-source.html#l00093">ast_cdr::varshead</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l00171">ast_cdr_dup()</a>.<div class="fragment"><pre class="fragment"><a name="l00338"></a>00338 {
<a name="l00339"></a>00339    <span class="keyword">struct </span><a class="code" href="structast__var__t.html">ast_var_t</a> *variables, *newvariable = NULL;
<a name="l00340"></a>00340    <span class="keyword">struct </span>varshead *headpa, *headpb;
<a name="l00341"></a>00341    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, *<a class="code" href="structval.html">val</a>;
<a name="l00342"></a>00342    <span class="keywordtype">int</span> x = 0;
<a name="l00343"></a>00343 
<a name="l00344"></a>00344    <span class="keywordflow">if</span> (!to_cdr || !from_cdr) <span class="comment">/* don't die if one of the pointers is null */</span>
<a name="l00345"></a>00345       <span class="keywordflow">return</span> 0;
<a name="l00346"></a>00346 
<a name="l00347"></a>00347    headpa = &amp;from_cdr-&gt;<a class="code" href="structast__cdr.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>;
<a name="l00348"></a>00348    headpb = &amp;to_cdr-&gt;<a class="code" href="structast__cdr.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>;
<a name="l00349"></a>00349 
<a name="l00350"></a>00350    <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(headpa,variables,entries) {
<a name="l00351"></a>00351       <span class="keywordflow">if</span> (variables &amp;&amp;
<a name="l00352"></a>00352           (var = <a class="code" href="chanvars_8c.html#29d40dfad3c6b59de315b3a0d2ed0a23">ast_var_name</a>(variables)) &amp;&amp; (val = <a class="code" href="chanvars_8c.html#6aa089cff5424a26ade21a520e443f82">ast_var_value</a>(variables)) &amp;&amp;
<a name="l00353"></a>00353           !<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(var) &amp;&amp; !<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(val)) {
<a name="l00354"></a>00354          newvariable = <a class="code" href="chanvars_8c.html#4d0028e2dbd755ae38d2fe4204ad9071">ast_var_assign</a>(var, val);
<a name="l00355"></a>00355          <a class="code" href="linkedlists_8h.html#5df56040a8838bdc841ef8eb179b7609">AST_LIST_INSERT_HEAD</a>(headpb, newvariable, entries);
<a name="l00356"></a>00356          x++;
<a name="l00357"></a>00357       }
<a name="l00358"></a>00358    }
<a name="l00359"></a>00359 
<a name="l00360"></a>00360    <span class="keywordflow">return</span> x;
<a name="l00361"></a>00361 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b20947a5170d08a12a3cee0498e07614"></a><!-- doxytag: member="cdr.h::ast_cdr_detach" ref="b20947a5170d08a12a3cee0498e07614" args="(struct ast_cdr *cdr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_cdr_detach           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>cdr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cdr</em>&nbsp;</td><td>Which CDR to detach from the channel thread Prevents the channel thread from blocking on the CDR handling Returns nothing </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l01087">1087</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="cdr_8h-source.html#l00031">AST_CDR_FLAG_POST_DISABLED</a>, <a class="el" href="cdr_8c-source.html#l00429">ast_cdr_free()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="lock_8h-source.html#l00530">ast_mutex_lock()</a>, <a class="el" href="lock_8h-source.html#l00520">ast_mutex_unlock()</a>, <a class="el" href="utils_8h-source.html#l00074">ast_set_flag</a>, <a class="el" href="cdr_8c.html#d265aed699f7409ac0ec6fe07ee9cb11">batch</a>, <a class="el" href="cdr_8c-source.html#l00092">batchmode</a>, <a class="el" href="cdr_8c-source.html#l00093">batchsize</a>, <a class="el" href="cdr_8c-source.html#l00072">ast_cdr_batch_item::cdr</a>, <a class="el" href="cdr_8c-source.html#l00091">enabled</a>, <a class="el" href="cdr_8c-source.html#l00078">ast_cdr_batch::head</a>, <a class="el" href="cdr_8c-source.html#l01005">init_batch()</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="cdr_8c-source.html#l00073">ast_cdr_batch_item::next</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="cdr_8c-source.html#l00919">post_cdr()</a>, <a class="el" href="cdr_8c-source.html#l00077">ast_cdr_batch::size</a>, <a class="el" href="cdr_8c-source.html#l01074">submit_unscheduled_batch()</a>, and <a class="el" href="cdr_8c-source.html#l00079">ast_cdr_batch::tail</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l00942">ast_cdr_reset()</a>, <a class="el" href="channel_8c-source.html#l01598">ast_hangup()</a>, and <a class="el" href="pbx_8c-source.html#l04966">ast_pbx_outgoing_cdr_failed()</a>.<div class="fragment"><pre class="fragment"><a name="l01088"></a>01088 {
<a name="l01089"></a>01089    <span class="keyword">struct </span><a class="code" href="structast__cdr__batch__item.html">ast_cdr_batch_item</a> *newtail;
<a name="l01090"></a>01090    <span class="keywordtype">int</span> curr;
<a name="l01091"></a>01091 
<a name="l01092"></a>01092    <span class="keywordflow">if</span> (!cdr)
<a name="l01093"></a>01093       <span class="keywordflow">return</span>;
<a name="l01094"></a>01094 
<a name="l01095"></a>01095    <span class="comment">/* maybe they disabled CDR stuff completely, so just drop it */</span>
<a name="l01096"></a>01096    <span class="keywordflow">if</span> (!<a class="code" href="cdr_8c.html#a10311459433adf322f2590a4987c423">enabled</a>) {
<a name="l01097"></a>01097       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l01098"></a>01098          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Dropping CDR !\n"</span>);
<a name="l01099"></a>01099       <a class="code" href="utils_8h.html#3208623241ff7b4c93907944487502a1">ast_set_flag</a>(cdr, <a class="code" href="cdr_8h.html#afadf88618596cfa2690f6704c45ff3f">AST_CDR_FLAG_POST_DISABLED</a>);
<a name="l01100"></a>01100       <a class="code" href="cdr_8c.html#c8ac6bad318e1e800b23bf62e33ee775">ast_cdr_free</a>(cdr);
<a name="l01101"></a>01101       <span class="keywordflow">return</span>;
<a name="l01102"></a>01102    }
<a name="l01103"></a>01103 
<a name="l01104"></a>01104    <span class="comment">/* post stuff immediately if we are not in batch mode, this is legacy behaviour */</span>
<a name="l01105"></a>01105    <span class="keywordflow">if</span> (!<a class="code" href="cdr_8c.html#92d0cb9e5ddcae590fd0cae4e2eae00c">batchmode</a>) {
<a name="l01106"></a>01106       <a class="code" href="cdr_8c.html#b97135f902c6646303a0b698c63fe4d6">post_cdr</a>(cdr);
<a name="l01107"></a>01107       <a class="code" href="cdr_8c.html#c8ac6bad318e1e800b23bf62e33ee775">ast_cdr_free</a>(cdr);
<a name="l01108"></a>01108       <span class="keywordflow">return</span>;
<a name="l01109"></a>01109    }
<a name="l01110"></a>01110 
<a name="l01111"></a>01111    <span class="comment">/* otherwise, each CDR gets put into a batch list (at the end) */</span>
<a name="l01112"></a>01112    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l01113"></a>01113       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"CDR detaching from this thread\n"</span>);
<a name="l01114"></a>01114 
<a name="l01115"></a>01115    <span class="comment">/* we'll need a new tail for every CDR */</span>
<a name="l01116"></a>01116    <span class="keywordflow">if</span> (!(newtail = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*newtail)))) {
<a name="l01117"></a>01117       <a class="code" href="cdr_8c.html#b97135f902c6646303a0b698c63fe4d6">post_cdr</a>(cdr);
<a name="l01118"></a>01118       <a class="code" href="cdr_8c.html#c8ac6bad318e1e800b23bf62e33ee775">ast_cdr_free</a>(cdr);
<a name="l01119"></a>01119       <span class="keywordflow">return</span>;
<a name="l01120"></a>01120    }
<a name="l01121"></a>01121 
<a name="l01122"></a>01122    <span class="comment">/* don't traverse a whole list (just keep track of the tail) */</span>
<a name="l01123"></a>01123    <a class="code" href="lock_8h.html#b3c5e3093b325167f88db93c8b4b2421">ast_mutex_lock</a>(&amp;cdr_batch_lock);
<a name="l01124"></a>01124    <span class="keywordflow">if</span> (!<a class="code" href="cdr_8c.html#d265aed699f7409ac0ec6fe07ee9cb11">batch</a>)
<a name="l01125"></a>01125       <a class="code" href="cdr_8c.html#f368c2ae653946812707d973ee84cca6">init_batch</a>();
<a name="l01126"></a>01126    <span class="keywordflow">if</span> (!<a class="code" href="cdr_8c.html#d265aed699f7409ac0ec6fe07ee9cb11">batch</a>-&gt;<a class="code" href="structast__cdr__batch.html#96e89a298e0a9f469b9ae458d6afae9f">head</a>) {
<a name="l01127"></a>01127       <span class="comment">/* new batch is empty, so point the head at the new tail */</span>
<a name="l01128"></a>01128       <a class="code" href="cdr_8c.html#d265aed699f7409ac0ec6fe07ee9cb11">batch</a>-&gt;<a class="code" href="structast__cdr__batch.html#96e89a298e0a9f469b9ae458d6afae9f">head</a> = newtail;
<a name="l01129"></a>01129    } <span class="keywordflow">else</span> {
<a name="l01130"></a>01130       <span class="comment">/* already got a batch with something in it, so just append a new tail */</span>
<a name="l01131"></a>01131       <a class="code" href="cdr_8c.html#d265aed699f7409ac0ec6fe07ee9cb11">batch</a>-&gt;<a class="code" href="structast__cdr__batch.html#7aea2552dfe7eb84b9443b6fc9ba6e01">tail</a>-&gt;<a class="code" href="structast__cdr__batch__item.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = newtail;
<a name="l01132"></a>01132    }
<a name="l01133"></a>01133    newtail-&gt;<a class="code" href="structast__cdr__batch__item.html#30491931d0d510243046864dbc71a8c9">cdr</a> = cdr;
<a name="l01134"></a>01134    <a class="code" href="cdr_8c.html#d265aed699f7409ac0ec6fe07ee9cb11">batch</a>-&gt;<a class="code" href="structast__cdr__batch.html#7aea2552dfe7eb84b9443b6fc9ba6e01">tail</a> = newtail;
<a name="l01135"></a>01135    curr = <a class="code" href="cdr_8c.html#d265aed699f7409ac0ec6fe07ee9cb11">batch</a>-&gt;<a class="code" href="structast__cdr__batch.html#f7bd60b75b29d79b660a2859395c1a24">size</a>++;
<a name="l01136"></a>01136    <a class="code" href="lock_8h.html#1d33e3caf152f0901c5ebdb69c2d4d26">ast_mutex_unlock</a>(&amp;cdr_batch_lock);
<a name="l01137"></a>01137 
<a name="l01138"></a>01138    <span class="comment">/* if we have enough stuff to post, then do it */</span>
<a name="l01139"></a>01139    <span class="keywordflow">if</span> (curr &gt;= (<a class="code" href="cdr_8c.html#aee8b822b52ebd9685d6c92dc7e8a66a">batchsize</a> - 1))
<a name="l01140"></a>01140       <a class="code" href="cdr_8c.html#8210056df66bac361733156aac05fbb4">submit_unscheduled_batch</a>();
<a name="l01141"></a>01141 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="46e80e6b7ec200439ddd4fc6bdea4f5b"></a><!-- doxytag: member="cdr.h::ast_cdr_discard" ref="46e80e6b7ec200439ddd4fc6bdea4f5b" args="(struct ast_cdr *cdr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_cdr_discard           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>cdr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Discard and free a CDR record. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cdr</em>&nbsp;</td><td><a class="el" href="structast__cdr.html">ast_cdr</a> structure to free Returns nothing -- same as free, but no checks or complaints </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00449">449</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8c-source.html#l00408">ast_cdr_free_vars()</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, and <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>.<div class="fragment"><pre class="fragment"><a name="l00450"></a>00450 {
<a name="l00451"></a>00451    <span class="keywordflow">while</span> (cdr) {
<a name="l00452"></a>00452       <span class="keyword">struct </span><a class="code" href="structast__cdr.html">ast_cdr</a> *<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l00453"></a>00453 
<a name="l00454"></a>00454       <a class="code" href="cdr_8c.html#79c41fd063e958a3702a0773190dbf58">ast_cdr_free_vars</a>(cdr, 0);
<a name="l00455"></a>00455       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(cdr);
<a name="l00456"></a>00456       cdr = next;
<a name="l00457"></a>00457    }
<a name="l00458"></a>00458 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="75620a3cdcb74f7f7c74ac183f0db801"></a><!-- doxytag: member="cdr.h::ast_cdr_disp2str" ref="75620a3cdcb74f7f7c74ac183f0db801" args="(int disposition)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char* ast_cdr_disp2str           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>disposition</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>disposition</em>&nbsp;</td><td>input binary form Converts the binary form of a disposition to string form. Returns a pointer to the string form </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00803">803</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00037">AST_CDR_ANSWERED</a>, <a class="el" href="cdr_8h-source.html#l00035">AST_CDR_BUSY</a>, <a class="el" href="cdr_8h-source.html#l00034">AST_CDR_FAILED</a>, <a class="el" href="cdr_8h-source.html#l00036">AST_CDR_NOANSWER</a>, and <a class="el" href="cdr_8h-source.html#l00033">AST_CDR_NULL</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l00222">ast_cdr_getvar()</a>, <a class="el" href="cdr__csv_8c-source.html#l00212">build_csv_record()</a>, <a class="el" href="cdr__radius_8c-source.html#l00098">build_radius_record()</a>, <a class="el" href="cdr__csv_8c-source.html#l00283">csv_log()</a>, <a class="el" href="cdr__manager_8c-source.html#l00086">manager_log()</a>, <a class="el" href="cdr__odbc_8c-source.html#l00092">odbc_log()</a>, <a class="el" href="cdr__pgsql_8c-source.html#l00073">pgsql_log()</a>, and <a class="el" href="cdr__tds_8c-source.html#l00111">tds_log()</a>.<div class="fragment"><pre class="fragment"><a name="l00804"></a>00804 {
<a name="l00805"></a>00805    <span class="keywordflow">switch</span> (<a class="code" href="structast__cdr.html#6cfe0c68cd195b63c8486325b447b1c7">disposition</a>) {
<a name="l00806"></a>00806    <span class="keywordflow">case</span> <a class="code" href="cdr_8h.html#25213252a0ee6b57d3e5d58dfea1b2b8">AST_CDR_NULL</a>:
<a name="l00807"></a>00807       <span class="keywordflow">return</span> <span class="stringliteral">"NO ANSWER"</span>; <span class="comment">/* by default, for backward compatibility */</span>
<a name="l00808"></a>00808    <span class="keywordflow">case</span> <a class="code" href="cdr_8h.html#156b91b117f2b53d1a18200fe726fbbc">AST_CDR_NOANSWER</a>:
<a name="l00809"></a>00809       <span class="keywordflow">return</span> <span class="stringliteral">"NO ANSWER"</span>;
<a name="l00810"></a>00810    <span class="keywordflow">case</span> <a class="code" href="cdr_8h.html#3620f370e858ef80414c7e7c6c2ac466">AST_CDR_FAILED</a>:
<a name="l00811"></a>00811       <span class="keywordflow">return</span> <span class="stringliteral">"FAILED"</span>;     
<a name="l00812"></a>00812    <span class="keywordflow">case</span> <a class="code" href="cdr_8h.html#b837fb3660bc208d03a6465977c69569">AST_CDR_BUSY</a>:
<a name="l00813"></a>00813       <span class="keywordflow">return</span> <span class="stringliteral">"BUSY"</span>;    
<a name="l00814"></a>00814    <span class="keywordflow">case</span> <a class="code" href="cdr_8h.html#a59fc2b798f793108e7aaa9336a2bdca">AST_CDR_ANSWERED</a>:
<a name="l00815"></a>00815       <span class="keywordflow">return</span> <span class="stringliteral">"ANSWERED"</span>;
<a name="l00816"></a>00816    }
<a name="l00817"></a>00817    <span class="keywordflow">return</span> <span class="stringliteral">"UNKNOWN"</span>;
<a name="l00818"></a>00818 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="995ca95113dc7070faca1a0969a72eb9"></a><!-- doxytag: member="cdr.h::ast_cdr_disposition" ref="995ca95113dc7070faca1a0969a72eb9" args="(struct ast_cdr *cdr, int cause)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cdr_disposition           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>cdr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cause</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cdr</em>&nbsp;</td><td>the cdr you wish to associate with the call Returns nothing </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cause</em>&nbsp;</td><td>the AST_CAUSE_* </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00684">684</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="causes_8h-source.html#l00135">AST_CAUSE_BUSY</a>, <a class="el" href="causes_8h-source.html#l00136">AST_CAUSE_FAILURE</a>, <a class="el" href="causes_8h-source.html#l00137">AST_CAUSE_NORMAL</a>, <a class="el" href="causes_8h-source.html#l00141">AST_CAUSE_NOTDEFINED</a>, <a class="el" href="cdr_8c-source.html#l00645">ast_cdr_busy()</a>, <a class="el" href="cdr_8c-source.html#l00657">ast_cdr_failed()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, and <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="pbx_8c-source.html#l05150">ast_pbx_outgoing_app()</a>, <a class="el" href="pbx_8c-source.html#l04991">ast_pbx_outgoing_exten()</a>, <a class="el" href="app__followme_8c-source.html#l00428">clear_caller()</a>, and <a class="el" href="app__followme_8c-source.html#l00763">findmeexec()</a>.<div class="fragment"><pre class="fragment"><a name="l00685"></a>00685 {
<a name="l00686"></a>00686    <span class="keywordtype">int</span> res = 0;
<a name="l00687"></a>00687 
<a name="l00688"></a>00688    <span class="keywordflow">for</span> (; cdr; cdr = cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l00689"></a>00689       <span class="keywordflow">switch</span> (cause) {
<a name="l00690"></a>00690       <span class="keywordflow">case</span> <a class="code" href="causes_8h.html#e8b101dee08334fa50ac3eceb4261151">AST_CAUSE_BUSY</a>:
<a name="l00691"></a>00691          <a class="code" href="cdr_8c.html#c18f3563260674ed152b367fcb7a12b1">ast_cdr_busy</a>(cdr);
<a name="l00692"></a>00692          <span class="keywordflow">break</span>;
<a name="l00693"></a>00693       <span class="keywordflow">case</span> <a class="code" href="causes_8h.html#d96ca89a704398d1117d9e6e07d24a04">AST_CAUSE_FAILURE</a>:
<a name="l00694"></a>00694          <a class="code" href="cdr_8c.html#3f2e573eb7fde7a250ca8aa95a0d367d">ast_cdr_failed</a>(cdr);
<a name="l00695"></a>00695          <span class="keywordflow">break</span>;
<a name="l00696"></a>00696       <span class="keywordflow">case</span> <a class="code" href="causes_8h.html#ac59b0d12608ff2ed9f657ec891b1ea4">AST_CAUSE_NORMAL</a>:
<a name="l00697"></a>00697          <span class="keywordflow">break</span>;
<a name="l00698"></a>00698       <span class="keywordflow">case</span> <a class="code" href="causes_8h.html#26616baee17891fc7244df139b296b4d">AST_CAUSE_NOTDEFINED</a>:
<a name="l00699"></a>00699          res = -1;
<a name="l00700"></a>00700          <span class="keywordflow">break</span>;
<a name="l00701"></a>00701       <span class="keywordflow">default</span>:
<a name="l00702"></a>00702          res = -1;
<a name="l00703"></a>00703          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Cause not handled\n"</span>);
<a name="l00704"></a>00704       }
<a name="l00705"></a>00705    }
<a name="l00706"></a>00706    <span class="keywordflow">return</span> res;
<a name="l00707"></a>00707 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8538ec9cb930d571cf367e372726d706"></a><!-- doxytag: member="cdr.h::ast_cdr_dup" ref="8538ec9cb930d571cf367e372726d706" args="(struct ast_cdr *cdr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a>* ast_cdr_dup           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>cdr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Duplicate a record Returns a malloc'd <a class="el" href="structast__cdr.html">ast_cdr</a> structure, returns NULL on error (malloc failure). 
<p>
Duplicate a CDR record <dl compact><dt><b>Returns:</b></dt><dd>Pointer to new CDR record </dd></dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00171">171</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8c-source.html#l00460">ast_cdr_alloc()</a>, and <a class="el" href="cdr_8c-source.html#l00337">ast_cdr_copy_vars()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04595">ast_async_goto()</a>, <a class="el" href="app__forkcdr_8c-source.html#l00054">ast_cdr_fork()</a>, and <a class="el" href="cdr_8c-source.html#l00942">ast_cdr_reset()</a>.<div class="fragment"><pre class="fragment"><a name="l00172"></a>00172 {
<a name="l00173"></a>00173    <span class="keyword">struct </span><a class="code" href="structast__cdr.html">ast_cdr</a> *newcdr;
<a name="l00174"></a>00174    
<a name="l00175"></a>00175    <span class="keywordflow">if</span> (!cdr) <span class="comment">/* don't die if we get a null cdr pointer */</span>
<a name="l00176"></a>00176       <span class="keywordflow">return</span> NULL;
<a name="l00177"></a>00177    newcdr = <a class="code" href="cdr_8c.html#0dd431954a27c67f78c6e13be8a0b136">ast_cdr_alloc</a>();
<a name="l00178"></a>00178    <span class="keywordflow">if</span> (!newcdr)
<a name="l00179"></a>00179       <span class="keywordflow">return</span> NULL;
<a name="l00180"></a>00180 
<a name="l00181"></a>00181    memcpy(newcdr, cdr, <span class="keyword">sizeof</span>(*newcdr));
<a name="l00182"></a>00182    <span class="comment">/* The varshead is unusable, volatile even, after the memcpy so we take care of that here */</span>
<a name="l00183"></a>00183    memset(&amp;newcdr-&gt;<a class="code" href="structast__cdr.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>, 0, <span class="keyword">sizeof</span>(newcdr-&gt;<a class="code" href="structast__cdr.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>));
<a name="l00184"></a>00184    <a class="code" href="cdr_8c.html#497a3c154e778ee54e2bbc27f0219bcb">ast_cdr_copy_vars</a>(newcdr, cdr);
<a name="l00185"></a>00185    newcdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = NULL;
<a name="l00186"></a>00186 
<a name="l00187"></a>00187    <span class="keywordflow">return</span> newcdr;
<a name="l00188"></a>00188 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="545d0bb7a87e9317b6eb3ce2245145cc"></a><!-- doxytag: member="cdr.h::ast_cdr_end" ref="545d0bb7a87e9317b6eb3ce2245145cc" args="(struct ast_cdr *cdr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_cdr_end           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>cdr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cdr</em>&nbsp;</td><td>the cdr you have associated the call with Registers the end of call time in the cdr structure. Returns nothing </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00788">788</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00072">ast_cdr::answer</a>, <a class="el" href="cdr_8h-source.html#l00034">AST_CDR_FAILED</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="cdr_8h-source.html#l00078">ast_cdr::billsec</a>, <a class="el" href="cdr_8h-source.html#l00062">ast_cdr::channel</a>, <a class="el" href="cdr_8c-source.html#l00421">check_post()</a>, <a class="el" href="cdr_8h-source.html#l00080">ast_cdr::disposition</a>, <a class="el" href="cdr_8h-source.html#l00076">ast_cdr::duration</a>, <a class="el" href="cdr_8h-source.html#l00074">ast_cdr::end</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>, <a class="el" href="strings_8h-source.html#l00045">S_OR</a>, and <a class="el" href="cdr_8h-source.html#l00070">ast_cdr::start</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>, <a class="el" href="channel_8c-source.html#l02060">__ast_read()</a>, <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="cdr_8c-source.html#l00942">ast_cdr_reset()</a>, <a class="el" href="channel_8c-source.html#l01598">ast_hangup()</a>, <a class="el" href="pbx_8c-source.html#l04966">ast_pbx_outgoing_cdr_failed()</a>, <a class="el" href="app__followme_8c-source.html#l00428">clear_caller()</a>, and <a class="el" href="app__followme_8c-source.html#l00763">findmeexec()</a>.<div class="fragment"><pre class="fragment"><a name="l00789"></a>00789 {
<a name="l00790"></a>00790    <span class="keywordflow">for</span> ( ; cdr ; cdr = cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l00791"></a>00791       <a class="code" href="cdr_8c.html#5b89f2cf8a1628735231e82ad14e36d3">check_post</a>(cdr);
<a name="l00792"></a>00792       <span class="keywordflow">if</span> (ast_tvzero(cdr-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a>))
<a name="l00793"></a>00793          cdr-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a> = ast_tvnow();
<a name="l00794"></a>00794       <span class="keywordflow">if</span> (ast_tvzero(cdr-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a>)) {
<a name="l00795"></a>00795          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"CDR on channel '%s' has not started\n"</span>, <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(cdr-&gt;<a class="code" href="structast__cdr.html#53688148c71d0e0eb1072fed5c2ea24a">channel</a>, <span class="stringliteral">"&lt;unknown&gt;"</span>));
<a name="l00796"></a>00796          cdr-&gt;<a class="code" href="structast__cdr.html#6cfe0c68cd195b63c8486325b447b1c7">disposition</a> = <a class="code" href="cdr_8h.html#3620f370e858ef80414c7e7c6c2ac466">AST_CDR_FAILED</a>;
<a name="l00797"></a>00797       } <span class="keywordflow">else</span>
<a name="l00798"></a>00798          cdr-&gt;<a class="code" href="structast__cdr.html#b85ec314bf443b797ef8a66b3b03f8a4">duration</a> = cdr-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a>.tv_sec - cdr-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a>.tv_sec;
<a name="l00799"></a>00799       cdr-&gt;<a class="code" href="structast__cdr.html#205d09422705d593761768e5281bf960">billsec</a> = ast_tvzero(cdr-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a>) ? 0 : cdr-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a>.tv_sec - cdr-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a>.tv_sec;
<a name="l00800"></a>00800    }
<a name="l00801"></a>00801 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="48500564f37446080efea14e1020c3bb"></a><!-- doxytag: member="cdr.h::ast_cdr_engine_init" ref="48500564f37446080efea14e1020c3bb" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cdr_engine_init           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Load the configuration file cdr.conf and possibly start the CDR scheduling thread 
<p>
Definition at line <a class="el" href="cdr_8c-source.html#l01341">1341</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l01344">ast_cli_register()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="lock_8h-source.html#l00530">ast_mutex_lock()</a>, <a class="el" href="lock_8h-source.html#l00520">ast_mutex_unlock()</a>, <a class="el" href="cdr_8c-source.html#l01229">do_reload()</a>, <a class="el" href="cdr_8c-source.html#l01005">init_batch()</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, and <a class="el" href="sched_8c-source.html#l00075">sched_context_create()</a>.
<p>
Referenced by <a class="el" href="asterisk_8c-source.html#l02570">main()</a>.<div class="fragment"><pre class="fragment"><a name="l01342"></a>01342 {
<a name="l01343"></a>01343    <span class="keywordtype">int</span> res;
<a name="l01344"></a>01344 
<a name="l01345"></a>01345    <a class="code" href="structsched.html">sched</a> = <a class="code" href="sched_8c.html#4326fa64fd840788d03093b9931bb1fb">sched_context_create</a>();
<a name="l01346"></a>01346    <span class="keywordflow">if</span> (!<a class="code" href="structsched.html">sched</a>) {
<a name="l01347"></a>01347       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Unable to create schedule context.\n"</span>);
<a name="l01348"></a>01348       <span class="keywordflow">return</span> -1;
<a name="l01349"></a>01349    }
<a name="l01350"></a>01350 
<a name="l01351"></a>01351    <a class="code" href="cli_8c.html#63b8a59f72a7d4f5f3cdef8190057349">ast_cli_register</a>(&amp;<a class="code" href="cdr_8c.html#a43065b204561baf7f5ea3fafc435672">cli_status</a>);
<a name="l01352"></a>01352 
<a name="l01353"></a>01353    res = <a class="code" href="cdr_8c.html#398d4ec50a0d5be51afce0244d30f16d">do_reload</a>();
<a name="l01354"></a>01354    <span class="keywordflow">if</span> (res) {
<a name="l01355"></a>01355       <a class="code" href="lock_8h.html#b3c5e3093b325167f88db93c8b4b2421">ast_mutex_lock</a>(&amp;cdr_batch_lock);
<a name="l01356"></a>01356       res = <a class="code" href="cdr_8c.html#f368c2ae653946812707d973ee84cca6">init_batch</a>();
<a name="l01357"></a>01357       <a class="code" href="lock_8h.html#1d33e3caf152f0901c5ebdb69c2d4d26">ast_mutex_unlock</a>(&amp;cdr_batch_lock);
<a name="l01358"></a>01358    }
<a name="l01359"></a>01359 
<a name="l01360"></a>01360    <span class="keywordflow">return</span> res;
<a name="l01361"></a>01361 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="60593c449a8a3978fbf48cba7f2459ed"></a><!-- doxytag: member="cdr.h::ast_cdr_engine_reload" ref="60593c449a8a3978fbf48cba7f2459ed" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cdr_engine_reload           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Reload the configuration file cdr.conf and start/stop CDR scheduling thread 
<p>
Definition at line <a class="el" href="cdr_8c-source.html#l01370">1370</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8c-source.html#l01229">do_reload()</a>.<div class="fragment"><pre class="fragment"><a name="l01371"></a>01371 {
<a name="l01372"></a>01372    <span class="keywordflow">return</span> <a class="code" href="cdr_8c.html#398d4ec50a0d5be51afce0244d30f16d">do_reload</a>();
<a name="l01373"></a>01373 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4e0ac05663cd08d6d25819f703463d7f"></a><!-- doxytag: member="cdr.h::ast_cdr_engine_term" ref="4e0ac05663cd08d6d25819f703463d7f" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_cdr_engine_term           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Submit any remaining CDRs and prepare for shutdown 
<p>
Definition at line <a class="el" href="cdr_8c-source.html#l01365">1365</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8c-source.html#l01033">ast_cdr_submit_batch()</a>, and <a class="el" href="cdr_8c-source.html#l00096">batchsafeshutdown</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l01229">do_reload()</a>, and <a class="el" href="asterisk_8c-source.html#l01201">quit_handler()</a>.<div class="fragment"><pre class="fragment"><a name="l01366"></a>01366 {
<a name="l01367"></a>01367    <a class="code" href="cdr_8c.html#b77b4351337e066e9c9e97e5f528d46a">ast_cdr_submit_batch</a>(<a class="code" href="cdr_8c.html#2241e95fc4180f58ee7f67e2967685a3">batchsafeshutdown</a>);
<a name="l01368"></a>01368 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3f2e573eb7fde7a250ca8aa95a0d367d"></a><!-- doxytag: member="cdr.h::ast_cdr_failed" ref="3f2e573eb7fde7a250ca8aa95a0d367d" args="(struct ast_cdr *cdr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_cdr_failed           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>cdr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cdr</em>&nbsp;</td><td>the cdr you wish to associate with the call Returns nothing </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00657">657</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00034">AST_CDR_FAILED</a>, <a class="el" href="cdr_8h-source.html#l00029">AST_CDR_FLAG_LOCKED</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="cdr_8c-source.html#l00421">check_post()</a>, <a class="el" href="cdr_8h-source.html#l00080">ast_cdr::disposition</a>, and <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="cdr_8c-source.html#l00684">ast_cdr_disposition()</a>, <a class="el" href="pbx_8c-source.html#l05150">ast_pbx_outgoing_app()</a>, <a class="el" href="pbx_8c-source.html#l04966">ast_pbx_outgoing_cdr_failed()</a>, <a class="el" href="pbx_8c-source.html#l04991">ast_pbx_outgoing_exten()</a>, <a class="el" href="app__followme_8c-source.html#l00428">clear_caller()</a>, <a class="el" href="app__followme_8c-source.html#l00763">findmeexec()</a>, and <a class="el" href="app__dial_8c-source.html#l00333">handle_cause()</a>.<div class="fragment"><pre class="fragment"><a name="l00658"></a>00658 {
<a name="l00659"></a>00659    <span class="keywordflow">for</span> (; cdr; cdr = cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l00660"></a>00660       <a class="code" href="cdr_8c.html#5b89f2cf8a1628735231e82ad14e36d3">check_post</a>(cdr);
<a name="l00661"></a>00661       <span class="keywordflow">if</span> (!<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(cdr, <a class="code" href="cdr_8h.html#372c8464bd559bdb42452d12d39457e4">AST_CDR_FLAG_LOCKED</a>)) {
<a name="l00662"></a>00662          <span class="keywordflow">if</span> (cdr-&gt;<a class="code" href="structast__cdr.html#6cfe0c68cd195b63c8486325b447b1c7">disposition</a> &lt; <a class="code" href="cdr_8h.html#3620f370e858ef80414c7e7c6c2ac466">AST_CDR_FAILED</a>)
<a name="l00663"></a>00663             cdr-&gt;<a class="code" href="structast__cdr.html#6cfe0c68cd195b63c8486325b447b1c7">disposition</a> = <a class="code" href="cdr_8h.html#3620f370e858ef80414c7e7c6c2ac466">AST_CDR_FAILED</a>;
<a name="l00664"></a>00664       }
<a name="l00665"></a>00665    }
<a name="l00666"></a>00666 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="265bbad802c844fbbc72fb5bfc1d096a"></a><!-- doxytag: member="cdr.h::ast_cdr_flags2str" ref="265bbad802c844fbbc72fb5bfc1d096a" args="(int flags)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char* ast_cdr_flags2str           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>flag</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Converts AMA flag to printable string 
<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00821">821</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00041">AST_CDR_BILLING</a>, <a class="el" href="cdr_8h-source.html#l00042">AST_CDR_DOCUMENTATION</a>, and <a class="el" href="cdr_8h-source.html#l00040">AST_CDR_OMIT</a>.
<p>
Referenced by <a class="el" href="chan__sip_8c-source.html#l10808">_sip_show_peer()</a>, <a class="el" href="cdr_8c-source.html#l00222">ast_cdr_getvar()</a>, <a class="el" href="cdr__csv_8c-source.html#l00212">build_csv_record()</a>, <a class="el" href="cdr__radius_8c-source.html#l00098">build_radius_record()</a>, <a class="el" href="cdr__csv_8c-source.html#l00283">csv_log()</a>, <a class="el" href="cdr__manager_8c-source.html#l00086">manager_log()</a>, <a class="el" href="chan__sip_8c-source.html#l11026">sip_show_user()</a>, and <a class="el" href="cdr__tds_8c-source.html#l00111">tds_log()</a>.<div class="fragment"><pre class="fragment"><a name="l00822"></a>00822 {
<a name="l00823"></a>00823    <span class="keywordflow">switch</span> (flag) {
<a name="l00824"></a>00824    <span class="keywordflow">case</span> <a class="code" href="cdr_8h.html#bda2560fadee8446e4d5f878ab0c7fe2">AST_CDR_OMIT</a>:
<a name="l00825"></a>00825       <span class="keywordflow">return</span> <span class="stringliteral">"OMIT"</span>;
<a name="l00826"></a>00826    <span class="keywordflow">case</span> <a class="code" href="cdr_8h.html#14e22de39a376518640e186e30771448">AST_CDR_BILLING</a>:
<a name="l00827"></a>00827       <span class="keywordflow">return</span> <span class="stringliteral">"BILLING"</span>;
<a name="l00828"></a>00828    <span class="keywordflow">case</span> <a class="code" href="cdr_8h.html#cf90483acda7d67a0e9dec8a639189a9">AST_CDR_DOCUMENTATION</a>:
<a name="l00829"></a>00829       <span class="keywordflow">return</span> <span class="stringliteral">"DOCUMENTATION"</span>;
<a name="l00830"></a>00830    }
<a name="l00831"></a>00831    <span class="keywordflow">return</span> <span class="stringliteral">"Unknown"</span>;
<a name="l00832"></a>00832 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c8ac6bad318e1e800b23bf62e33ee775"></a><!-- doxytag: member="cdr.h::ast_cdr_free" ref="c8ac6bad318e1e800b23bf62e33ee775" args="(struct ast_cdr *cdr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_cdr_free           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>cdr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Free a CDR record. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cdr</em>&nbsp;</td><td><a class="el" href="structast__cdr.html">ast_cdr</a> structure to free Returns nothing </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00429">429</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00031">AST_CDR_FLAG_POST_DISABLED</a>, <a class="el" href="cdr_8h-source.html#l00028">AST_CDR_FLAG_POSTED</a>, <a class="el" href="cdr_8c-source.html#l00408">ast_cdr_free_vars()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="adsistub_8c-source.html#l00055">chan</a>, <a class="el" href="cdr_8h-source.html#l00062">ast_cdr::channel</a>, <a class="el" href="cdr_8h-source.html#l00074">ast_cdr::end</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="logger_8h-source.html#l00106">LOG_NOTICE</a>, <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>, <a class="el" href="strings_8h-source.html#l00045">S_OR</a>, and <a class="el" href="cdr_8h-source.html#l00070">ast_cdr::start</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l01087">ast_cdr_detach()</a>, and <a class="el" href="cdr_8c-source.html#l01016">do_batch_backend_process()</a>.<div class="fragment"><pre class="fragment"><a name="l00430"></a>00430 {
<a name="l00431"></a>00431 
<a name="l00432"></a>00432    <span class="keywordflow">while</span> (cdr) {
<a name="l00433"></a>00433       <span class="keyword">struct </span><a class="code" href="structast__cdr.html">ast_cdr</a> *<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l00434"></a>00434       <span class="keywordtype">char</span> *<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a> = <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(cdr-&gt;channel, <span class="stringliteral">"&lt;unknown&gt;"</span>);
<a name="l00435"></a>00435       <span class="keywordflow">if</span> (!<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(cdr, <a class="code" href="cdr_8h.html#12df3b2bc8941512329b4cf3f2019a11">AST_CDR_FLAG_POSTED</a>) &amp;&amp; !<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(cdr, <a class="code" href="cdr_8h.html#afadf88618596cfa2690f6704c45ff3f">AST_CDR_FLAG_POST_DISABLED</a>))
<a name="l00436"></a>00436          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#bbf95aad74d847cd4bcb129604f798cd">LOG_NOTICE</a>, <span class="stringliteral">"CDR on channel '%s' not posted\n"</span>, chan);
<a name="l00437"></a>00437       <span class="keywordflow">if</span> (ast_tvzero(cdr-&gt;end))
<a name="l00438"></a>00438          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#bbf95aad74d847cd4bcb129604f798cd">LOG_NOTICE</a>, <span class="stringliteral">"CDR on channel '%s' lacks end\n"</span>, chan);
<a name="l00439"></a>00439       <span class="keywordflow">if</span> (ast_tvzero(cdr-&gt;start))
<a name="l00440"></a>00440          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#bbf95aad74d847cd4bcb129604f798cd">LOG_NOTICE</a>, <span class="stringliteral">"CDR on channel '%s' lacks start\n"</span>, chan);
<a name="l00441"></a>00441 
<a name="l00442"></a>00442       <a class="code" href="cdr_8c.html#79c41fd063e958a3702a0773190dbf58">ast_cdr_free_vars</a>(cdr, 0);
<a name="l00443"></a>00443       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(cdr);
<a name="l00444"></a>00444       cdr = next;
<a name="l00445"></a>00445    }
<a name="l00446"></a>00446 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="79c41fd063e958a3702a0773190dbf58"></a><!-- doxytag: member="cdr.h::ast_cdr_free_vars" ref="79c41fd063e958a3702a0773190dbf58" args="(struct ast_cdr *cdr, int recur)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_cdr_free_vars           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>cdr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>recur</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00408">408</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00710">AST_LIST_REMOVE_HEAD</a>, <a class="el" href="chanvars_8c-source.html#l00056">ast_var_delete()</a>, <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>, and <a class="el" href="cdr_8h-source.html#l00093">ast_cdr::varshead</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l00449">ast_cdr_discard()</a>, <a class="el" href="app__forkcdr_8c-source.html#l00054">ast_cdr_fork()</a>, <a class="el" href="cdr_8c-source.html#l00429">ast_cdr_free()</a>, and <a class="el" href="cdr_8c-source.html#l00942">ast_cdr_reset()</a>.<div class="fragment"><pre class="fragment"><a name="l00409"></a>00409 {
<a name="l00410"></a>00410 
<a name="l00411"></a>00411    <span class="comment">/* clear variables */</span>
<a name="l00412"></a>00412    <span class="keywordflow">for</span> (; cdr; cdr = recur ? cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> : NULL) {
<a name="l00413"></a>00413       <span class="keyword">struct </span><a class="code" href="structast__var__t.html">ast_var_t</a> *vardata;
<a name="l00414"></a>00414       <span class="keyword">struct </span>varshead *headp = &amp;cdr-&gt;<a class="code" href="structast__cdr.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>;
<a name="l00415"></a>00415       <span class="keywordflow">while</span> ((vardata = <a class="code" href="linkedlists_8h.html#beec347da29fe6b0d7fdb3e80b851f90">AST_LIST_REMOVE_HEAD</a>(headp, entries)))
<a name="l00416"></a>00416          <a class="code" href="chanvars_8c.html#32e018d32324bab845a9cac601c175d8">ast_var_delete</a>(vardata);
<a name="l00417"></a>00417    }
<a name="l00418"></a>00418 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="9e9ccbed2b4365369048829d27fad973"></a><!-- doxytag: member="cdr.h::ast_cdr_getvar" ref="9e9ccbed2b4365369048829d27fad973" args="(struct ast_cdr *cdr, const char *name, char **ret, char *workspace, int workspacelen, int recur, int raw)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_cdr_getvar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>cdr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char **&nbsp;</td>
          <td class="mdname" nowrap> <em>ret</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>workspace</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>workspacelen</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>recur</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>raw</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
CDR channel variable retrieval 
<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00222">222</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00084">ast_cdr::accountcode</a>, <a class="el" href="cdr_8h-source.html#l00082">ast_cdr::amaflags</a>, <a class="el" href="cdr_8h-source.html#l00072">ast_cdr::answer</a>, <a class="el" href="cdr_8c-source.html#l00803">ast_cdr_disp2str()</a>, <a class="el" href="cdr_8c-source.html#l00821">ast_cdr_flags2str()</a>, <a class="el" href="cdr_8c-source.html#l00190">ast_cdr_getvar_internal()</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="cdr_8h-source.html#l00078">ast_cdr::billsec</a>, <a class="el" href="cdr_8c-source.html#l00207">cdr_get_tv()</a>, <a class="el" href="cdr_8h-source.html#l00062">ast_cdr::channel</a>, <a class="el" href="cdr_8h-source.html#l00054">ast_cdr::clid</a>, <a class="el" href="cdr_8h-source.html#l00060">ast_cdr::dcontext</a>, <a class="el" href="cdr_8h-source.html#l00080">ast_cdr::disposition</a>, <a class="el" href="cdr_8h-source.html#l00058">ast_cdr::dst</a>, <a class="el" href="cdr_8h-source.html#l00064">ast_cdr::dstchannel</a>, <a class="el" href="cdr_8h-source.html#l00076">ast_cdr::duration</a>, <a class="el" href="cdr_8h-source.html#l00074">ast_cdr::end</a>, <a class="el" href="manager_8h-source.html#l00182">fmt</a>, <a class="el" href="cdr_8h-source.html#l00066">ast_cdr::lastapp</a>, <a class="el" href="cdr_8h-source.html#l00068">ast_cdr::lastdata</a>, <a class="el" href="cdr_8h-source.html#l00056">ast_cdr::src</a>, <a class="el" href="cdr_8h-source.html#l00070">ast_cdr::start</a>, <a class="el" href="cdr_8h-source.html#l00088">ast_cdr::uniqueid</a>, and <a class="el" href="cdr_8h-source.html#l00090">ast_cdr::userfield</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l00363">ast_cdr_serialize_variables()</a>, <a class="el" href="func__cdr_8c-source.html#l00057">cdr_read()</a>, and <a class="el" href="cdr__adaptive__odbc_8c-source.html#l00299">odbc_log()</a>.<div class="fragment"><pre class="fragment"><a name="l00223"></a>00223 {
<a name="l00224"></a>00224    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="manager_8h.html#7631454338ff70b1a6b1262f5f36beac">fmt</a> = <span class="stringliteral">"%Y-%m-%d %T"</span>;
<a name="l00225"></a>00225    <span class="keyword">const</span> <span class="keywordtype">char</span> *varbuf;
<a name="l00226"></a>00226 
<a name="l00227"></a>00227    <span class="keywordflow">if</span> (!cdr)  <span class="comment">/* don't die if the cdr is null */</span>
<a name="l00228"></a>00228       <span class="keywordflow">return</span>;
<a name="l00229"></a>00229 
<a name="l00230"></a>00230    *ret = NULL;
<a name="l00231"></a>00231    <span class="comment">/* special vars (the ones from the struct ast_cdr when requested by name) </span>
<a name="l00232"></a>00232 <span class="comment">      I'd almost say we should convert all the stringed vals to vars */</span>
<a name="l00233"></a>00233 
<a name="l00234"></a>00234    <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"clid"</span>))
<a name="l00235"></a>00235       ast_copy_string(workspace, cdr-&gt;<a class="code" href="structast__cdr.html#79d79e0fba7b2465154797332f9a1619">clid</a>, workspacelen);
<a name="l00236"></a>00236    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"src"</span>))
<a name="l00237"></a>00237       ast_copy_string(workspace, cdr-&gt;<a class="code" href="structast__cdr.html#93e647b3c41f5f86b9db921d639a1538">src</a>, workspacelen);
<a name="l00238"></a>00238    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"dst"</span>))
<a name="l00239"></a>00239       ast_copy_string(workspace, cdr-&gt;<a class="code" href="structast__cdr.html#a476c1bc0b4765c02b33e33730740691">dst</a>, workspacelen);
<a name="l00240"></a>00240    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"dcontext"</span>))
<a name="l00241"></a>00241       ast_copy_string(workspace, cdr-&gt;<a class="code" href="structast__cdr.html#c51661c78ed2588eff211c9e29718fc5">dcontext</a>, workspacelen);
<a name="l00242"></a>00242    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"channel"</span>))
<a name="l00243"></a>00243       ast_copy_string(workspace, cdr-&gt;<a class="code" href="structast__cdr.html#53688148c71d0e0eb1072fed5c2ea24a">channel</a>, workspacelen);
<a name="l00244"></a>00244    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"dstchannel"</span>))
<a name="l00245"></a>00245       ast_copy_string(workspace, cdr-&gt;<a class="code" href="structast__cdr.html#9ff13b69b0f16b02154ada5fb39a0845">dstchannel</a>, workspacelen);
<a name="l00246"></a>00246    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"lastapp"</span>))
<a name="l00247"></a>00247       ast_copy_string(workspace, cdr-&gt;<a class="code" href="structast__cdr.html#d25b12f576ea83fb63d766ba441118ec">lastapp</a>, workspacelen);
<a name="l00248"></a>00248    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"lastdata"</span>))
<a name="l00249"></a>00249       ast_copy_string(workspace, cdr-&gt;<a class="code" href="structast__cdr.html#4fbefaf41bef377eb6daf5ffad10df62">lastdata</a>, workspacelen);
<a name="l00250"></a>00250    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"start"</span>))
<a name="l00251"></a>00251       <a class="code" href="cdr_8c.html#6ac2d66cd793a681a2c275e056f39617">cdr_get_tv</a>(cdr-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a>, raw ? NULL : fmt, workspace, workspacelen);
<a name="l00252"></a>00252    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"answer"</span>))
<a name="l00253"></a>00253       <a class="code" href="cdr_8c.html#6ac2d66cd793a681a2c275e056f39617">cdr_get_tv</a>(cdr-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a>, raw ? NULL : fmt, workspace, workspacelen);
<a name="l00254"></a>00254    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"end"</span>))
<a name="l00255"></a>00255       <a class="code" href="cdr_8c.html#6ac2d66cd793a681a2c275e056f39617">cdr_get_tv</a>(cdr-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a>, raw ? NULL : fmt, workspace, workspacelen);
<a name="l00256"></a>00256    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"duration"</span>))
<a name="l00257"></a>00257       snprintf(workspace, workspacelen, <span class="stringliteral">"%ld"</span>, cdr-&gt;<a class="code" href="structast__cdr.html#b85ec314bf443b797ef8a66b3b03f8a4">duration</a>);
<a name="l00258"></a>00258    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"billsec"</span>))
<a name="l00259"></a>00259       snprintf(workspace, workspacelen, <span class="stringliteral">"%ld"</span>, cdr-&gt;<a class="code" href="structast__cdr.html#205d09422705d593761768e5281bf960">billsec</a>);
<a name="l00260"></a>00260    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"disposition"</span>)) {
<a name="l00261"></a>00261       <span class="keywordflow">if</span> (raw) {
<a name="l00262"></a>00262          snprintf(workspace, workspacelen, <span class="stringliteral">"%ld"</span>, cdr-&gt;<a class="code" href="structast__cdr.html#6cfe0c68cd195b63c8486325b447b1c7">disposition</a>);
<a name="l00263"></a>00263       } <span class="keywordflow">else</span> {
<a name="l00264"></a>00264          ast_copy_string(workspace, <a class="code" href="cdr_8c.html#75620a3cdcb74f7f7c74ac183f0db801">ast_cdr_disp2str</a>(cdr-&gt;<a class="code" href="structast__cdr.html#6cfe0c68cd195b63c8486325b447b1c7">disposition</a>), workspacelen);
<a name="l00265"></a>00265       }
<a name="l00266"></a>00266    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"amaflags"</span>)) {
<a name="l00267"></a>00267       <span class="keywordflow">if</span> (raw) {
<a name="l00268"></a>00268          snprintf(workspace, workspacelen, <span class="stringliteral">"%ld"</span>, cdr-&gt;<a class="code" href="structast__cdr.html#d5aa4bb1461fe3d863bd95fb137e2284">amaflags</a>);
<a name="l00269"></a>00269       } <span class="keywordflow">else</span> {
<a name="l00270"></a>00270          ast_copy_string(workspace, <a class="code" href="cdr_8c.html#281f2ae52f80ba6a5305cad35d88fda5">ast_cdr_flags2str</a>(cdr-&gt;<a class="code" href="structast__cdr.html#d5aa4bb1461fe3d863bd95fb137e2284">amaflags</a>), workspacelen);
<a name="l00271"></a>00271       }
<a name="l00272"></a>00272    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"accountcode"</span>))
<a name="l00273"></a>00273       ast_copy_string(workspace, cdr-&gt;<a class="code" href="structast__cdr.html#6c4d520c88ca77ed2acc04ae1add9f8e">accountcode</a>, workspacelen);
<a name="l00274"></a>00274    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"uniqueid"</span>))
<a name="l00275"></a>00275       ast_copy_string(workspace, cdr-&gt;<a class="code" href="structast__cdr.html#26f0ec0196ac1494aa248fb3d2d608cc">uniqueid</a>, workspacelen);
<a name="l00276"></a>00276    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"userfield"</span>))
<a name="l00277"></a>00277       ast_copy_string(workspace, cdr-&gt;<a class="code" href="structast__cdr.html#07c0f6b6a5bf53c1c68383f1f0c9398e">userfield</a>, workspacelen);
<a name="l00278"></a>00278    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((varbuf = <a class="code" href="cdr_8c.html#245cb02d431361ecf966ce4b31f591a5">ast_cdr_getvar_internal</a>(cdr, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, recur)))
<a name="l00279"></a>00279       ast_copy_string(workspace, varbuf, workspacelen);
<a name="l00280"></a>00280    <span class="keywordflow">else</span>
<a name="l00281"></a>00281       workspace[0] = <span class="charliteral">'\0'</span>;
<a name="l00282"></a>00282 
<a name="l00283"></a>00283    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(workspace))
<a name="l00284"></a>00284       *ret = workspace;
<a name="l00285"></a>00285 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6ae0d5a38580d55c275752bc7357f228"></a><!-- doxytag: member="cdr.h::ast_cdr_init" ref="6ae0d5a38580d55c275752bc7357f228" args="(struct ast_cdr *cdr, struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cdr_init           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>cdr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initialize based on a channel. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cdr</em>&nbsp;</td><td>Call Detail Record to use for channel </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>Channel to bind CDR with Initializes a CDR and associates it with a particular channel Return is negligible. (returns 0 by default) </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00763">763</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00435">ast_channel::_state</a>, <a class="el" href="cdr_8h-source.html#l00084">ast_cdr::accountcode</a>, <a class="el" href="channel_8h-source.html#l00450">ast_channel::amaflags</a>, <a class="el" href="cdr_8h-source.html#l00082">ast_cdr::amaflags</a>, <a class="el" href="cdr_8h-source.html#l00037">AST_CDR_ANSWERED</a>, <a class="el" href="cdr_8h-source.html#l00029">AST_CDR_FLAG_LOCKED</a>, <a class="el" href="cdr_8h-source.html#l00033">AST_CDR_NULL</a>, <a class="el" href="cdr_8c-source.html#l00059">ast_default_amaflags</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="adsistub_8c-source.html#l00055">chan</a>, <a class="el" href="cdr_8h-source.html#l00062">ast_cdr::channel</a>, <a class="el" href="channel_8h-source.html#l00441">ast_channel::context</a>, <a class="el" href="cdr_8h-source.html#l00060">ast_cdr::dcontext</a>, <a class="el" href="cdr_8h-source.html#l00080">ast_cdr::disposition</a>, <a class="el" href="cdr_8h-source.html#l00058">ast_cdr::dst</a>, <a class="el" href="channel_8h-source.html#l00442">ast_channel::exten</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>, <a class="el" href="strings_8h-source.html#l00045">S_OR</a>, <a class="el" href="cdr_8c-source.html#l00735">set_one_cid()</a>, and <a class="el" href="cdr_8h-source.html#l00088">ast_cdr::uniqueid</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>, <a class="el" href="channel_8c-source.html#l02060">__ast_read()</a>, <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="channel_8c-source.html#l00632">ast_channel_alloc()</a>, <a class="el" href="res__features_8c-source.html#l01295">ast_feature_request_and_dial()</a>, <a class="el" href="pbx_8c-source.html#l05150">ast_pbx_outgoing_app()</a>, <a class="el" href="pbx_8c-source.html#l04966">ast_pbx_outgoing_cdr_failed()</a>, <a class="el" href="res__features_8c-source.html#l00673">builtin_blindtransfer()</a>, <a class="el" href="app__followme_8c-source.html#l00428">clear_caller()</a>, and <a class="el" href="app__followme_8c-source.html#l00763">findmeexec()</a>.<div class="fragment"><pre class="fragment"><a name="l00764"></a>00764 {
<a name="l00765"></a>00765    <span class="keywordtype">char</span> *chan;
<a name="l00766"></a>00766 
<a name="l00767"></a>00767    <span class="keywordflow">for</span> ( ; cdr ; cdr = cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l00768"></a>00768       <span class="keywordflow">if</span> (!<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(cdr, <a class="code" href="cdr_8h.html#372c8464bd559bdb42452d12d39457e4">AST_CDR_FLAG_LOCKED</a>)) {
<a name="l00769"></a>00769          chan = <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(cdr-&gt;<a class="code" href="structast__cdr.html#53688148c71d0e0eb1072fed5c2ea24a">channel</a>, <span class="stringliteral">"&lt;unknown&gt;"</span>);
<a name="l00770"></a>00770          <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(cdr-&gt;<a class="code" href="structast__cdr.html#53688148c71d0e0eb1072fed5c2ea24a">channel</a>)) 
<a name="l00771"></a>00771             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"CDR already initialized on '%s'\n"</span>, chan); 
<a name="l00772"></a>00772          ast_copy_string(cdr-&gt;<a class="code" href="structast__cdr.html#53688148c71d0e0eb1072fed5c2ea24a">channel</a>, c-&gt;name, <span class="keyword">sizeof</span>(cdr-&gt;<a class="code" href="structast__cdr.html#53688148c71d0e0eb1072fed5c2ea24a">channel</a>));
<a name="l00773"></a>00773          <a class="code" href="cdr_8c.html#e09dbd75e437418aa84bcc25040ec73d">set_one_cid</a>(cdr, c);
<a name="l00774"></a>00774 
<a name="l00775"></a>00775          cdr-&gt;<a class="code" href="structast__cdr.html#6cfe0c68cd195b63c8486325b447b1c7">disposition</a> = (c-&gt;_state == <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>) ?  <a class="code" href="cdr_8h.html#a59fc2b798f793108e7aaa9336a2bdca">AST_CDR_ANSWERED</a> : <a class="code" href="cdr_8h.html#25213252a0ee6b57d3e5d58dfea1b2b8">AST_CDR_NULL</a>;
<a name="l00776"></a>00776          cdr-&gt;<a class="code" href="structast__cdr.html#d5aa4bb1461fe3d863bd95fb137e2284">amaflags</a> = c-&gt;amaflags ? c-&gt;amaflags :  <a class="code" href="cdr_8c.html#d5268e5dc9c134f0ce5f28da7a447335">ast_default_amaflags</a>;
<a name="l00777"></a>00777          ast_copy_string(cdr-&gt;<a class="code" href="structast__cdr.html#6c4d520c88ca77ed2acc04ae1add9f8e">accountcode</a>, c-&gt;accountcode, <span class="keyword">sizeof</span>(cdr-&gt;<a class="code" href="structast__cdr.html#6c4d520c88ca77ed2acc04ae1add9f8e">accountcode</a>));
<a name="l00778"></a>00778          <span class="comment">/* Destination information */</span>
<a name="l00779"></a>00779          ast_copy_string(cdr-&gt;<a class="code" href="structast__cdr.html#a476c1bc0b4765c02b33e33730740691">dst</a>, c-&gt;exten, <span class="keyword">sizeof</span>(cdr-&gt;<a class="code" href="structast__cdr.html#a476c1bc0b4765c02b33e33730740691">dst</a>));
<a name="l00780"></a>00780          ast_copy_string(cdr-&gt;<a class="code" href="structast__cdr.html#c51661c78ed2588eff211c9e29718fc5">dcontext</a>, c-&gt;context, <span class="keyword">sizeof</span>(cdr-&gt;<a class="code" href="structast__cdr.html#c51661c78ed2588eff211c9e29718fc5">dcontext</a>));
<a name="l00781"></a>00781          <span class="comment">/* Unique call identifier */</span>
<a name="l00782"></a>00782          ast_copy_string(cdr-&gt;<a class="code" href="structast__cdr.html#26f0ec0196ac1494aa248fb3d2d608cc">uniqueid</a>, c-&gt;uniqueid, <span class="keyword">sizeof</span>(cdr-&gt;<a class="code" href="structast__cdr.html#26f0ec0196ac1494aa248fb3d2d608cc">uniqueid</a>));
<a name="l00783"></a>00783       }
<a name="l00784"></a>00784    }
<a name="l00785"></a>00785    <span class="keywordflow">return</span> 0;
<a name="l00786"></a>00786 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b7fa0bd117aed5d3693e653d00985aa0"></a><!-- doxytag: member="cdr.h::ast_cdr_merge" ref="b7fa0bd117aed5d3693e653d00985aa0" args="(struct ast_cdr *to, struct ast_cdr *from)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_cdr_merge           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>to</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>from</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Move the non-null data from the "from" cdr to the "to" cdr <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>to</em>&nbsp;</td><td>the cdr to get the goodies </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>from</em>&nbsp;</td><td>the cdr to give the goodies </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00504">504</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00084">ast_cdr::accountcode</a>, <a class="el" href="cdr_8h-source.html#l00082">ast_cdr::amaflags</a>, <a class="el" href="cdr_8h-source.html#l00072">ast_cdr::answer</a>, <a class="el" href="cdr_8c-source.html#l00979">ast_cdr_append()</a>, <a class="el" href="cdr_8h-source.html#l00030">AST_CDR_FLAG_CHILD</a>, <a class="el" href="cdr_8h-source.html#l00027">AST_CDR_FLAG_KEEP_VARS</a>, <a class="el" href="cdr_8h-source.html#l00029">AST_CDR_FLAG_LOCKED</a>, <a class="el" href="cdr_8h-source.html#l00031">AST_CDR_FLAG_POST_DISABLED</a>, <a class="el" href="cdr_8h-source.html#l00028">AST_CDR_FLAG_POSTED</a>, <a class="el" href="cdr_8h-source.html#l00036">AST_CDR_NOANSWER</a>, <a class="el" href="utils_8h-source.html#l00074">ast_set_flag</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="cdr_8h-source.html#l00078">ast_cdr::billsec</a>, <a class="el" href="cdr_8c-source.html#l00468">cdr_merge_vars()</a>, <a class="el" href="cdr_8h-source.html#l00062">ast_cdr::channel</a>, <a class="el" href="cdr_8h-source.html#l00060">ast_cdr::dcontext</a>, <a class="el" href="cdr_8h-source.html#l00080">ast_cdr::disposition</a>, <a class="el" href="cdr_8h-source.html#l00058">ast_cdr::dst</a>, <a class="el" href="cdr_8h-source.html#l00064">ast_cdr::dstchannel</a>, <a class="el" href="cdr_8h-source.html#l00076">ast_cdr::duration</a>, <a class="el" href="cdr_8h-source.html#l00074">ast_cdr::end</a>, <a class="el" href="cdr_8h-source.html#l00066">ast_cdr::lastapp</a>, <a class="el" href="cdr_8h-source.html#l00068">ast_cdr::lastdata</a>, <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>, <a class="el" href="cdr_8h-source.html#l00056">ast_cdr::src</a>, <a class="el" href="cdr_8h-source.html#l00070">ast_cdr::start</a>, and <a class="el" href="cdr_8h-source.html#l00090">ast_cdr::userfield</a>.<div class="fragment"><pre class="fragment"><a name="l00505"></a>00505 {
<a name="l00506"></a>00506    <span class="keyword">struct </span><a class="code" href="structast__cdr.html">ast_cdr</a> *tcdr;
<a name="l00507"></a>00507    
<a name="l00508"></a>00508    <span class="keywordflow">if</span> (!to || !from)
<a name="l00509"></a>00509       <span class="keywordflow">return</span>;
<a name="l00510"></a>00510    
<a name="l00511"></a>00511    <span class="keywordflow">if</span> (!ast_tvzero(from-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a>)) {
<a name="l00512"></a>00512       <span class="keywordflow">if</span> (!ast_tvzero(to-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a>)) {
<a name="l00513"></a>00513          <span class="keywordflow">if</span> (ast_tvcmp(to-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a>, from-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a>) &gt; 0 ) {
<a name="l00514"></a>00514             to-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a> = from-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a>; <span class="comment">/* use the earliest time */</span>
<a name="l00515"></a>00515             from-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a> = ast_tv(0,0); <span class="comment">/* we actively "steal" these values */</span>
<a name="l00516"></a>00516          }
<a name="l00517"></a>00517          <span class="comment">/* else nothing to do */</span>
<a name="l00518"></a>00518       } <span class="keywordflow">else</span> {
<a name="l00519"></a>00519          to-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a> = from-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a>;
<a name="l00520"></a>00520          from-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a> = ast_tv(0,0); <span class="comment">/* we actively "steal" these values */</span>
<a name="l00521"></a>00521       }
<a name="l00522"></a>00522    }
<a name="l00523"></a>00523    <span class="keywordflow">if</span> (!ast_tvzero(from-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a>)) {
<a name="l00524"></a>00524       <span class="keywordflow">if</span> (!ast_tvzero(to-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a>)) {
<a name="l00525"></a>00525          <span class="keywordflow">if</span> (ast_tvcmp(to-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a>, from-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a>) &gt; 0 ) {
<a name="l00526"></a>00526             to-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a> = from-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a>; <span class="comment">/* use the earliest time */</span>
<a name="l00527"></a>00527             from-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a> = ast_tv(0,0); <span class="comment">/* we actively "steal" these values */</span>
<a name="l00528"></a>00528          }
<a name="l00529"></a>00529          <span class="comment">/* we got the earliest answer time, so we'll settle for that? */</span>
<a name="l00530"></a>00530       } <span class="keywordflow">else</span> {
<a name="l00531"></a>00531          to-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a> = from-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a>;
<a name="l00532"></a>00532          from-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a> = ast_tv(0,0); <span class="comment">/* we actively "steal" these values */</span>
<a name="l00533"></a>00533       }
<a name="l00534"></a>00534    }
<a name="l00535"></a>00535    <span class="keywordflow">if</span> (!ast_tvzero(from-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a>)) {
<a name="l00536"></a>00536       <span class="keywordflow">if</span> (!ast_tvzero(to-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a>)) {
<a name="l00537"></a>00537          <span class="keywordflow">if</span> (ast_tvcmp(to-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a>, from-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a>) &lt; 0 ) {
<a name="l00538"></a>00538             to-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a> = from-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a>; <span class="comment">/* use the latest time */</span>
<a name="l00539"></a>00539             from-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a> = ast_tv(0,0); <span class="comment">/* we actively "steal" these values */</span>
<a name="l00540"></a>00540             to-&gt;<a class="code" href="structast__cdr.html#b85ec314bf443b797ef8a66b3b03f8a4">duration</a> = to-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a>.tv_sec - to-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a>.tv_sec;  <span class="comment">/* don't forget to update the duration, billsec, when we set end */</span>
<a name="l00541"></a>00541             to-&gt;<a class="code" href="structast__cdr.html#205d09422705d593761768e5281bf960">billsec</a> = ast_tvzero(to-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a>) ? 0 : to-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a>.tv_sec - to-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a>.tv_sec;
<a name="l00542"></a>00542          }
<a name="l00543"></a>00543          <span class="comment">/* else, nothing to do */</span>
<a name="l00544"></a>00544       } <span class="keywordflow">else</span> {
<a name="l00545"></a>00545          to-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a> = from-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a>;
<a name="l00546"></a>00546          from-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a> = ast_tv(0,0); <span class="comment">/* we actively "steal" these values */</span>
<a name="l00547"></a>00547          to-&gt;<a class="code" href="structast__cdr.html#b85ec314bf443b797ef8a66b3b03f8a4">duration</a> = to-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a>.tv_sec - to-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a>.tv_sec;
<a name="l00548"></a>00548          to-&gt;<a class="code" href="structast__cdr.html#205d09422705d593761768e5281bf960">billsec</a> = ast_tvzero(to-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a>) ? 0 : to-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a>.tv_sec - to-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a>.tv_sec;
<a name="l00549"></a>00549       }
<a name="l00550"></a>00550    }
<a name="l00551"></a>00551    <span class="keywordflow">if</span> (to-&gt;<a class="code" href="structast__cdr.html#6cfe0c68cd195b63c8486325b447b1c7">disposition</a> &lt; from-&gt;<a class="code" href="structast__cdr.html#6cfe0c68cd195b63c8486325b447b1c7">disposition</a>) {
<a name="l00552"></a>00552       to-&gt;<a class="code" href="structast__cdr.html#6cfe0c68cd195b63c8486325b447b1c7">disposition</a> = from-&gt;<a class="code" href="structast__cdr.html#6cfe0c68cd195b63c8486325b447b1c7">disposition</a>;
<a name="l00553"></a>00553       from-&gt;<a class="code" href="structast__cdr.html#6cfe0c68cd195b63c8486325b447b1c7">disposition</a> = <a class="code" href="cdr_8h.html#156b91b117f2b53d1a18200fe726fbbc">AST_CDR_NOANSWER</a>;
<a name="l00554"></a>00554    }
<a name="l00555"></a>00555    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(to-&gt;<a class="code" href="structast__cdr.html#d25b12f576ea83fb63d766ba441118ec">lastapp</a>) &amp;&amp; !<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(from-&gt;<a class="code" href="structast__cdr.html#d25b12f576ea83fb63d766ba441118ec">lastapp</a>)) {
<a name="l00556"></a>00556       ast_copy_string(to-&gt;<a class="code" href="structast__cdr.html#d25b12f576ea83fb63d766ba441118ec">lastapp</a>, from-&gt;<a class="code" href="structast__cdr.html#d25b12f576ea83fb63d766ba441118ec">lastapp</a>, <span class="keyword">sizeof</span>(to-&gt;<a class="code" href="structast__cdr.html#d25b12f576ea83fb63d766ba441118ec">lastapp</a>));
<a name="l00557"></a>00557       from-&gt;<a class="code" href="structast__cdr.html#d25b12f576ea83fb63d766ba441118ec">lastapp</a>[0] = 0; <span class="comment">/* theft */</span>
<a name="l00558"></a>00558    }
<a name="l00559"></a>00559    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(to-&gt;<a class="code" href="structast__cdr.html#4fbefaf41bef377eb6daf5ffad10df62">lastdata</a>) &amp;&amp; !<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(from-&gt;<a class="code" href="structast__cdr.html#4fbefaf41bef377eb6daf5ffad10df62">lastdata</a>)) {
<a name="l00560"></a>00560       ast_copy_string(to-&gt;<a class="code" href="structast__cdr.html#4fbefaf41bef377eb6daf5ffad10df62">lastdata</a>, from-&gt;<a class="code" href="structast__cdr.html#4fbefaf41bef377eb6daf5ffad10df62">lastdata</a>, <span class="keyword">sizeof</span>(to-&gt;<a class="code" href="structast__cdr.html#4fbefaf41bef377eb6daf5ffad10df62">lastdata</a>));
<a name="l00561"></a>00561       from-&gt;<a class="code" href="structast__cdr.html#4fbefaf41bef377eb6daf5ffad10df62">lastdata</a>[0] = 0; <span class="comment">/* theft */</span>
<a name="l00562"></a>00562    }
<a name="l00563"></a>00563    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(to-&gt;<a class="code" href="structast__cdr.html#c51661c78ed2588eff211c9e29718fc5">dcontext</a>) &amp;&amp; !<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(from-&gt;<a class="code" href="structast__cdr.html#c51661c78ed2588eff211c9e29718fc5">dcontext</a>)) {
<a name="l00564"></a>00564       ast_copy_string(to-&gt;<a class="code" href="structast__cdr.html#c51661c78ed2588eff211c9e29718fc5">dcontext</a>, from-&gt;<a class="code" href="structast__cdr.html#c51661c78ed2588eff211c9e29718fc5">dcontext</a>, <span class="keyword">sizeof</span>(to-&gt;<a class="code" href="structast__cdr.html#c51661c78ed2588eff211c9e29718fc5">dcontext</a>));
<a name="l00565"></a>00565       from-&gt;<a class="code" href="structast__cdr.html#c51661c78ed2588eff211c9e29718fc5">dcontext</a>[0] = 0; <span class="comment">/* theft */</span>
<a name="l00566"></a>00566    }
<a name="l00567"></a>00567    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(to-&gt;<a class="code" href="structast__cdr.html#9ff13b69b0f16b02154ada5fb39a0845">dstchannel</a>) &amp;&amp; !<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(from-&gt;<a class="code" href="structast__cdr.html#9ff13b69b0f16b02154ada5fb39a0845">dstchannel</a>)) {
<a name="l00568"></a>00568       ast_copy_string(to-&gt;<a class="code" href="structast__cdr.html#9ff13b69b0f16b02154ada5fb39a0845">dstchannel</a>, from-&gt;<a class="code" href="structast__cdr.html#9ff13b69b0f16b02154ada5fb39a0845">dstchannel</a>, <span class="keyword">sizeof</span>(to-&gt;<a class="code" href="structast__cdr.html#9ff13b69b0f16b02154ada5fb39a0845">dstchannel</a>));
<a name="l00569"></a>00569       from-&gt;<a class="code" href="structast__cdr.html#9ff13b69b0f16b02154ada5fb39a0845">dstchannel</a>[0] = 0; <span class="comment">/* theft */</span>
<a name="l00570"></a>00570    }
<a name="l00571"></a>00571    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(to-&gt;<a class="code" href="structast__cdr.html#53688148c71d0e0eb1072fed5c2ea24a">channel</a>) &amp;&amp; !<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(from-&gt;<a class="code" href="structast__cdr.html#53688148c71d0e0eb1072fed5c2ea24a">channel</a>)) {
<a name="l00572"></a>00572       ast_copy_string(to-&gt;<a class="code" href="structast__cdr.html#53688148c71d0e0eb1072fed5c2ea24a">channel</a>, from-&gt;<a class="code" href="structast__cdr.html#53688148c71d0e0eb1072fed5c2ea24a">channel</a>, <span class="keyword">sizeof</span>(to-&gt;<a class="code" href="structast__cdr.html#53688148c71d0e0eb1072fed5c2ea24a">channel</a>));
<a name="l00573"></a>00573       from-&gt;<a class="code" href="structast__cdr.html#53688148c71d0e0eb1072fed5c2ea24a">channel</a>[0] = 0; <span class="comment">/* theft */</span>
<a name="l00574"></a>00574    }
<a name="l00575"></a>00575    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(to-&gt;<a class="code" href="structast__cdr.html#93e647b3c41f5f86b9db921d639a1538">src</a>) &amp;&amp; !<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(from-&gt;<a class="code" href="structast__cdr.html#93e647b3c41f5f86b9db921d639a1538">src</a>)) {
<a name="l00576"></a>00576       ast_copy_string(to-&gt;<a class="code" href="structast__cdr.html#93e647b3c41f5f86b9db921d639a1538">src</a>, from-&gt;<a class="code" href="structast__cdr.html#93e647b3c41f5f86b9db921d639a1538">src</a>, <span class="keyword">sizeof</span>(to-&gt;<a class="code" href="structast__cdr.html#93e647b3c41f5f86b9db921d639a1538">src</a>));
<a name="l00577"></a>00577       from-&gt;<a class="code" href="structast__cdr.html#93e647b3c41f5f86b9db921d639a1538">src</a>[0] = 0; <span class="comment">/* theft */</span>
<a name="l00578"></a>00578    }
<a name="l00579"></a>00579    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(to-&gt;<a class="code" href="structast__cdr.html#a476c1bc0b4765c02b33e33730740691">dst</a>) &amp;&amp; !<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(from-&gt;<a class="code" href="structast__cdr.html#a476c1bc0b4765c02b33e33730740691">dst</a>)) {
<a name="l00580"></a>00580       ast_copy_string(to-&gt;<a class="code" href="structast__cdr.html#a476c1bc0b4765c02b33e33730740691">dst</a>, from-&gt;<a class="code" href="structast__cdr.html#a476c1bc0b4765c02b33e33730740691">dst</a>, <span class="keyword">sizeof</span>(to-&gt;<a class="code" href="structast__cdr.html#a476c1bc0b4765c02b33e33730740691">dst</a>));
<a name="l00581"></a>00581       from-&gt;<a class="code" href="structast__cdr.html#a476c1bc0b4765c02b33e33730740691">dst</a>[0] = 0; <span class="comment">/* theft */</span>
<a name="l00582"></a>00582    }
<a name="l00583"></a>00583    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(from, <a class="code" href="cdr_8h.html#372c8464bd559bdb42452d12d39457e4">AST_CDR_FLAG_LOCKED</a>) || (!to-&gt;<a class="code" href="structast__cdr.html#d5aa4bb1461fe3d863bd95fb137e2284">amaflags</a> &amp;&amp; from-&gt;<a class="code" href="structast__cdr.html#d5aa4bb1461fe3d863bd95fb137e2284">amaflags</a>)) {
<a name="l00584"></a>00584       to-&gt;<a class="code" href="structast__cdr.html#d5aa4bb1461fe3d863bd95fb137e2284">amaflags</a> = from-&gt;<a class="code" href="structast__cdr.html#d5aa4bb1461fe3d863bd95fb137e2284">amaflags</a>;
<a name="l00585"></a>00585       from-&gt;<a class="code" href="structast__cdr.html#d5aa4bb1461fe3d863bd95fb137e2284">amaflags</a> = 0; <span class="comment">/* theft */</span>
<a name="l00586"></a>00586    }
<a name="l00587"></a>00587    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(from, <a class="code" href="cdr_8h.html#372c8464bd559bdb42452d12d39457e4">AST_CDR_FLAG_LOCKED</a>) || (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(to-&gt;<a class="code" href="structast__cdr.html#6c4d520c88ca77ed2acc04ae1add9f8e">accountcode</a>) &amp;&amp; !<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(from-&gt;<a class="code" href="structast__cdr.html#6c4d520c88ca77ed2acc04ae1add9f8e">accountcode</a>))) {
<a name="l00588"></a>00588       ast_copy_string(to-&gt;<a class="code" href="structast__cdr.html#6c4d520c88ca77ed2acc04ae1add9f8e">accountcode</a>, from-&gt;<a class="code" href="structast__cdr.html#6c4d520c88ca77ed2acc04ae1add9f8e">accountcode</a>, <span class="keyword">sizeof</span>(to-&gt;<a class="code" href="structast__cdr.html#6c4d520c88ca77ed2acc04ae1add9f8e">accountcode</a>));
<a name="l00589"></a>00589       from-&gt;<a class="code" href="structast__cdr.html#6c4d520c88ca77ed2acc04ae1add9f8e">accountcode</a>[0] = 0; <span class="comment">/* theft */</span>
<a name="l00590"></a>00590    }
<a name="l00591"></a>00591    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(from, <a class="code" href="cdr_8h.html#372c8464bd559bdb42452d12d39457e4">AST_CDR_FLAG_LOCKED</a>) || (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(to-&gt;<a class="code" href="structast__cdr.html#07c0f6b6a5bf53c1c68383f1f0c9398e">userfield</a>) &amp;&amp; !<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(from-&gt;<a class="code" href="structast__cdr.html#07c0f6b6a5bf53c1c68383f1f0c9398e">userfield</a>))) {
<a name="l00592"></a>00592       ast_copy_string(to-&gt;<a class="code" href="structast__cdr.html#07c0f6b6a5bf53c1c68383f1f0c9398e">userfield</a>, from-&gt;<a class="code" href="structast__cdr.html#07c0f6b6a5bf53c1c68383f1f0c9398e">userfield</a>, <span class="keyword">sizeof</span>(to-&gt;<a class="code" href="structast__cdr.html#07c0f6b6a5bf53c1c68383f1f0c9398e">userfield</a>));
<a name="l00593"></a>00593       from-&gt;<a class="code" href="structast__cdr.html#07c0f6b6a5bf53c1c68383f1f0c9398e">userfield</a>[0] = 0; <span class="comment">/* theft */</span>
<a name="l00594"></a>00594    }
<a name="l00595"></a>00595    <span class="comment">/* flags, varsead, ? */</span>
<a name="l00596"></a>00596    <a class="code" href="cdr_8c.html#14951cce2698a4c1ad1f552edadbb346">cdr_merge_vars</a>(from, to);
<a name="l00597"></a>00597 
<a name="l00598"></a>00598    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(from, <a class="code" href="cdr_8h.html#2c2a1ca2e0c5a764d651abf71b35a520">AST_CDR_FLAG_KEEP_VARS</a>))
<a name="l00599"></a>00599       <a class="code" href="utils_8h.html#3208623241ff7b4c93907944487502a1">ast_set_flag</a>(to, <a class="code" href="cdr_8h.html#2c2a1ca2e0c5a764d651abf71b35a520">AST_CDR_FLAG_KEEP_VARS</a>);
<a name="l00600"></a>00600    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(from, <a class="code" href="cdr_8h.html#12df3b2bc8941512329b4cf3f2019a11">AST_CDR_FLAG_POSTED</a>))
<a name="l00601"></a>00601       <a class="code" href="utils_8h.html#3208623241ff7b4c93907944487502a1">ast_set_flag</a>(to, <a class="code" href="cdr_8h.html#12df3b2bc8941512329b4cf3f2019a11">AST_CDR_FLAG_POSTED</a>);
<a name="l00602"></a>00602    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(from, <a class="code" href="cdr_8h.html#372c8464bd559bdb42452d12d39457e4">AST_CDR_FLAG_LOCKED</a>))
<a name="l00603"></a>00603       <a class="code" href="utils_8h.html#3208623241ff7b4c93907944487502a1">ast_set_flag</a>(to, <a class="code" href="cdr_8h.html#372c8464bd559bdb42452d12d39457e4">AST_CDR_FLAG_LOCKED</a>);
<a name="l00604"></a>00604    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(from, <a class="code" href="cdr_8h.html#975bd6a62384980a402ff1093dde3fd3">AST_CDR_FLAG_CHILD</a>))
<a name="l00605"></a>00605       <a class="code" href="utils_8h.html#3208623241ff7b4c93907944487502a1">ast_set_flag</a>(to, <a class="code" href="cdr_8h.html#975bd6a62384980a402ff1093dde3fd3">AST_CDR_FLAG_CHILD</a>);
<a name="l00606"></a>00606    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(from, <a class="code" href="cdr_8h.html#afadf88618596cfa2690f6704c45ff3f">AST_CDR_FLAG_POST_DISABLED</a>))
<a name="l00607"></a>00607       <a class="code" href="utils_8h.html#3208623241ff7b4c93907944487502a1">ast_set_flag</a>(to, <a class="code" href="cdr_8h.html#afadf88618596cfa2690f6704c45ff3f">AST_CDR_FLAG_POST_DISABLED</a>);
<a name="l00608"></a>00608 
<a name="l00609"></a>00609    <span class="comment">/* last, but not least, we need to merge any forked CDRs to the 'to' cdr */</span>
<a name="l00610"></a>00610    <span class="keywordflow">while</span> (from-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l00611"></a>00611       <span class="comment">/* just rip 'em off the 'from' and insert them on the 'to' */</span>
<a name="l00612"></a>00612       tcdr = from-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l00613"></a>00613       from-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = tcdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l00614"></a>00614       tcdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = NULL;
<a name="l00615"></a>00615       <span class="comment">/* tcdr is now ripped from the current list; */</span>
<a name="l00616"></a>00616       <a class="code" href="cdr_8c.html#45f0cb9bdab7262e5e359e8b722ea3e7">ast_cdr_append</a>(to, tcdr);
<a name="l00617"></a>00617    }
<a name="l00618"></a>00618 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b25a58ff542a14baeb012c2728b174c8"></a><!-- doxytag: member="cdr.h::ast_cdr_noanswer" ref="b25a58ff542a14baeb012c2728b174c8" args="(struct ast_cdr *cdr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_cdr_noanswer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>cdr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cdr</em>&nbsp;</td><td>the cdr you wish to associate with the call Marks the channel disposition as "NO ANSWER" </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00668">668</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00029">AST_CDR_FLAG_LOCKED</a>, <a class="el" href="cdr_8h-source.html#l00028">AST_CDR_FLAG_POSTED</a>, <a class="el" href="cdr_8h-source.html#l00036">AST_CDR_NOANSWER</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="adsistub_8c-source.html#l00055">chan</a>, <a class="el" href="cdr_8h-source.html#l00062">ast_cdr::channel</a>, <a class="el" href="cdr_8h-source.html#l00080">ast_cdr::disposition</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, and <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>.
<p>
Referenced by <a class="el" href="app__dial_8c-source.html#l00532">wait_for_answer()</a>.<div class="fragment"><pre class="fragment"><a name="l00669"></a>00669 {
<a name="l00670"></a>00670    <span class="keywordtype">char</span> *<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>; 
<a name="l00671"></a>00671 
<a name="l00672"></a>00672    <span class="keywordflow">while</span> (cdr) {
<a name="l00673"></a>00673       chan = !<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(cdr-&gt;<a class="code" href="structast__cdr.html#53688148c71d0e0eb1072fed5c2ea24a">channel</a>) ? cdr-&gt;<a class="code" href="structast__cdr.html#53688148c71d0e0eb1072fed5c2ea24a">channel</a> : <span class="stringliteral">"&lt;unknown&gt;"</span>;
<a name="l00674"></a>00674       <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(cdr, <a class="code" href="cdr_8h.html#12df3b2bc8941512329b4cf3f2019a11">AST_CDR_FLAG_POSTED</a>))
<a name="l00675"></a>00675          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"CDR on channel '%s' already posted\n"</span>, chan);
<a name="l00676"></a>00676       <span class="keywordflow">if</span> (!<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(cdr, <a class="code" href="cdr_8h.html#372c8464bd559bdb42452d12d39457e4">AST_CDR_FLAG_LOCKED</a>)) {
<a name="l00677"></a>00677          <span class="keywordflow">if</span> (cdr-&gt;<a class="code" href="structast__cdr.html#6cfe0c68cd195b63c8486325b447b1c7">disposition</a> &lt; <a class="code" href="cdr_8h.html#156b91b117f2b53d1a18200fe726fbbc">AST_CDR_NOANSWER</a>)
<a name="l00678"></a>00678             cdr-&gt;<a class="code" href="structast__cdr.html#6cfe0c68cd195b63c8486325b447b1c7">disposition</a> = <a class="code" href="cdr_8h.html#156b91b117f2b53d1a18200fe726fbbc">AST_CDR_NOANSWER</a>;
<a name="l00679"></a>00679       }
<a name="l00680"></a>00680       cdr = cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l00681"></a>00681    }
<a name="l00682"></a>00682 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ccdb62d8fe6850e472a58bada0aa23b1"></a><!-- doxytag: member="cdr.h::ast_cdr_register" ref="ccdb62d8fe6850e472a58bada0aa23b1" args="(const char *name, const char *desc, ast_cdrbe be)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cdr_register           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="cdr_8h.html#14a5f088dfa645e72346b9311ecb146b">ast_cdrbe</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>be</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Register a CDR driver. Each registered CDR driver generates a CDR <dl compact><dt><b>Returns:</b></dt><dd>0 on success, -1 on failure </dd></dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00112">112</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="linkedlists_8h-source.html#l00650">AST_LIST_INSERT_HEAD</a>, <a class="el" href="linkedlists_8h-source.html#l00038">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00104">AST_LIST_UNLOCK</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, and <a class="el" href="cdr_8c-source.html#l00063">ast_cdr_beitem::name</a>.
<p>
Referenced by <a class="el" href="cdr__adaptive__odbc_8c-source.html#l00590">load_module()</a>, <a class="el" href="cdr__odbc_8c-source.html#l00244">odbc_load_module()</a>, <a class="el" href="cdr__pgsql_8c-source.html#l00202">process_my_load_module()</a>, <a class="el" href="cdr__tds_8c-source.html#l00427">tds_load_module()</a>, and <a class="el" href="cdr__adaptive__odbc_8c-source.html#l00575">unload_module()</a>.<div class="fragment"><pre class="fragment"><a name="l00113"></a>00113 {
<a name="l00114"></a>00114    <span class="keyword">struct </span><a class="code" href="structast__cdr__beitem.html">ast_cdr_beitem</a> *i;
<a name="l00115"></a>00115 
<a name="l00116"></a>00116    <span class="keywordflow">if</span> (!<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>)
<a name="l00117"></a>00117       <span class="keywordflow">return</span> -1;
<a name="l00118"></a>00118    <span class="keywordflow">if</span> (!<a class="code" href="structast__cdr__beitem.html#910955a907e739b81ec8855763108a29">be</a>) {
<a name="l00119"></a>00119       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"CDR engine '%s' lacks backend\n"</span>, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l00120"></a>00120       <span class="keywordflow">return</span> -1;
<a name="l00121"></a>00121    }
<a name="l00122"></a>00122 
<a name="l00123"></a>00123    <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;be_list);
<a name="l00124"></a>00124    <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;be_list, i, list) {
<a name="l00125"></a>00125       <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, i-&gt;<a class="code" href="structast__cdr__beitem.html#8c9c7bab06d31b05557f3a0f229239e1">name</a>))
<a name="l00126"></a>00126          <span class="keywordflow">break</span>;
<a name="l00127"></a>00127    }
<a name="l00128"></a>00128    <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;be_list);
<a name="l00129"></a>00129 
<a name="l00130"></a>00130    <span class="keywordflow">if</span> (i) {
<a name="l00131"></a>00131       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Already have a CDR backend called '%s'\n"</span>, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l00132"></a>00132       <span class="keywordflow">return</span> -1;
<a name="l00133"></a>00133    }
<a name="l00134"></a>00134 
<a name="l00135"></a>00135    <span class="keywordflow">if</span> (!(i = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*i))))  
<a name="l00136"></a>00136       <span class="keywordflow">return</span> -1;
<a name="l00137"></a>00137 
<a name="l00138"></a>00138    i-&gt;be = <a class="code" href="structast__cdr__beitem.html#910955a907e739b81ec8855763108a29">be</a>;
<a name="l00139"></a>00139    ast_copy_string(i-&gt;name, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="keyword">sizeof</span>(i-&gt;name));
<a name="l00140"></a>00140    ast_copy_string(i-&gt;desc, <a class="code" href="chan__gtalk_8c.html#45c085ae9b1d6f46cf9e03f75b76fd83">desc</a>, <span class="keyword">sizeof</span>(i-&gt;desc));
<a name="l00141"></a>00141 
<a name="l00142"></a>00142    <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;be_list);
<a name="l00143"></a>00143    <a class="code" href="linkedlists_8h.html#5df56040a8838bdc841ef8eb179b7609">AST_LIST_INSERT_HEAD</a>(&amp;be_list, i, list);
<a name="l00144"></a>00144    <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;be_list);
<a name="l00145"></a>00145 
<a name="l00146"></a>00146    <span class="keywordflow">return</span> 0;
<a name="l00147"></a>00147 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a6a3c56be870fddae262b46a6107107f"></a><!-- doxytag: member="cdr.h::ast_cdr_reset" ref="a6a3c56be870fddae262b46a6107107f" args="(struct ast_cdr *cdr, struct ast_flags *flags)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_cdr_reset           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>cdr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__flags.html">ast_flags</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>flags</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cdr</em>&nbsp;</td><td>which cdr to act upon </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flags</em>&nbsp;</td><td>|AST_CDR_FLAG_POSTED whether or not to post the cdr first before resetting it |AST_CDR_FLAG_LOCKED whether or not to reset locked CDR's </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00942">942</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00072">ast_cdr::answer</a>, <a class="el" href="cdr_8c-source.html#l01087">ast_cdr_detach()</a>, <a class="el" href="cdr_8c-source.html#l00171">ast_cdr_dup()</a>, <a class="el" href="cdr_8c-source.html#l00788">ast_cdr_end()</a>, <a class="el" href="cdr_8h-source.html#l00027">AST_CDR_FLAG_KEEP_VARS</a>, <a class="el" href="cdr_8h-source.html#l00029">AST_CDR_FLAG_LOCKED</a>, <a class="el" href="cdr_8h-source.html#l00028">AST_CDR_FLAG_POSTED</a>, <a class="el" href="cdr_8c-source.html#l00408">ast_cdr_free_vars()</a>, <a class="el" href="cdr_8h-source.html#l00033">AST_CDR_NULL</a>, <a class="el" href="cdr_8c-source.html#l00620">ast_cdr_start()</a>, <a class="el" href="utils_8h-source.html#l00081">ast_clear_flag</a>, <a class="el" href="utils_8h-source.html#l00088">ast_copy_flags</a>, <a class="el" href="utils_8h-source.html#l00142">AST_FLAGS_ALL</a>, <a class="el" href="utils_8h-source.html#l00074">ast_set_flag</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="cdr_8h-source.html#l00078">ast_cdr::billsec</a>, <a class="el" href="cdr_8h-source.html#l00080">ast_cdr::disposition</a>, <a class="el" href="cdr_8h-source.html#l00076">ast_cdr::duration</a>, <a class="el" href="cdr_8h-source.html#l00074">ast_cdr::end</a>, <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>, and <a class="el" href="cdr_8h-source.html#l00070">ast_cdr::start</a>.
<p>
Referenced by <a class="el" href="res__features_8c-source.html#l00231">ast_bridge_call_thread()</a>, <a class="el" href="app__forkcdr_8c-source.html#l00054">ast_cdr_fork()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, and <a class="el" href="pbx_8c-source.html#l05441">pbx_builtin_resetcdr()</a>.<div class="fragment"><pre class="fragment"><a name="l00943"></a>00943 {
<a name="l00944"></a>00944    <span class="keyword">struct </span><a class="code" href="structast__cdr.html">ast_cdr</a> *dup;
<a name="l00945"></a>00945    <span class="keyword">struct </span><a class="code" href="structast__flags.html">ast_flags</a> flags = { 0 };
<a name="l00946"></a>00946 
<a name="l00947"></a>00947    <span class="keywordflow">if</span> (_flags)
<a name="l00948"></a>00948       <a class="code" href="utils_8h.html#7963ad5058a8544f02f00fc94199cbc3">ast_copy_flags</a>(&amp;flags, _flags, <a class="code" href="utils_8h.html#c07aaa6d930db5c5594b7f4813d75982">AST_FLAGS_ALL</a>);
<a name="l00949"></a>00949 
<a name="l00950"></a>00950    <span class="keywordflow">for</span> ( ; cdr ; cdr = cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l00951"></a>00951       <span class="comment">/* Detach if post is requested */</span>
<a name="l00952"></a>00952       <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(&amp;flags, <a class="code" href="cdr_8h.html#372c8464bd559bdb42452d12d39457e4">AST_CDR_FLAG_LOCKED</a>) || !<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(cdr, <a class="code" href="cdr_8h.html#372c8464bd559bdb42452d12d39457e4">AST_CDR_FLAG_LOCKED</a>)) {
<a name="l00953"></a>00953          <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(&amp;flags, <a class="code" href="cdr_8h.html#12df3b2bc8941512329b4cf3f2019a11">AST_CDR_FLAG_POSTED</a>)) {
<a name="l00954"></a>00954             <a class="code" href="cdr_8c.html#545d0bb7a87e9317b6eb3ce2245145cc">ast_cdr_end</a>(cdr);
<a name="l00955"></a>00955             <span class="keywordflow">if</span> ((dup = <a class="code" href="cdr_8c.html#8538ec9cb930d571cf367e372726d706">ast_cdr_dup</a>(cdr))) {
<a name="l00956"></a>00956                <a class="code" href="cdr_8c.html#b20947a5170d08a12a3cee0498e07614">ast_cdr_detach</a>(dup);
<a name="l00957"></a>00957             }
<a name="l00958"></a>00958             <a class="code" href="utils_8h.html#3208623241ff7b4c93907944487502a1">ast_set_flag</a>(cdr, <a class="code" href="cdr_8h.html#12df3b2bc8941512329b4cf3f2019a11">AST_CDR_FLAG_POSTED</a>);
<a name="l00959"></a>00959          }
<a name="l00960"></a>00960 
<a name="l00961"></a>00961          <span class="comment">/* clear variables */</span>
<a name="l00962"></a>00962          <span class="keywordflow">if</span> (!<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(&amp;flags, <a class="code" href="cdr_8h.html#2c2a1ca2e0c5a764d651abf71b35a520">AST_CDR_FLAG_KEEP_VARS</a>)) {
<a name="l00963"></a>00963             <a class="code" href="cdr_8c.html#79c41fd063e958a3702a0773190dbf58">ast_cdr_free_vars</a>(cdr, 0);
<a name="l00964"></a>00964          }
<a name="l00965"></a>00965 
<a name="l00966"></a>00966          <span class="comment">/* Reset to initial state */</span>
<a name="l00967"></a>00967          <a class="code" href="utils_8h.html#c2399a33be6ffb658bcf7c6a35531732">ast_clear_flag</a>(cdr, <a class="code" href="utils_8h.html#c07aaa6d930db5c5594b7f4813d75982">AST_FLAGS_ALL</a>); 
<a name="l00968"></a>00968          memset(&amp;cdr-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a>, 0, <span class="keyword">sizeof</span>(cdr-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a>));
<a name="l00969"></a>00969          memset(&amp;cdr-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a>, 0, <span class="keyword">sizeof</span>(cdr-&gt;<a class="code" href="structast__cdr.html#7f021a1415b86f2d013b2618fb31ae53">end</a>));
<a name="l00970"></a>00970          memset(&amp;cdr-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a>, 0, <span class="keyword">sizeof</span>(cdr-&gt;<a class="code" href="structast__cdr.html#a363b8d13575101a0226e8d0d054f2e7">answer</a>));
<a name="l00971"></a>00971          cdr-&gt;<a class="code" href="structast__cdr.html#205d09422705d593761768e5281bf960">billsec</a> = 0;
<a name="l00972"></a>00972          cdr-&gt;<a class="code" href="structast__cdr.html#b85ec314bf443b797ef8a66b3b03f8a4">duration</a> = 0;
<a name="l00973"></a>00973          <a class="code" href="cdr_8c.html#56e1b7b9d5acada4d22d345813710582">ast_cdr_start</a>(cdr);
<a name="l00974"></a>00974          cdr-&gt;<a class="code" href="structast__cdr.html#6cfe0c68cd195b63c8486325b447b1c7">disposition</a> = <a class="code" href="cdr_8h.html#25213252a0ee6b57d3e5d58dfea1b2b8">AST_CDR_NULL</a>;
<a name="l00975"></a>00975       }
<a name="l00976"></a>00976    }
<a name="l00977"></a>00977 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="012c9aed35828d7a2bd4581c29da37e2"></a><!-- doxytag: member="cdr.h::ast_cdr_serialize_variables" ref="012c9aed35828d7a2bd4581c29da37e2" args="(struct ast_cdr *cdr, struct ast_str **buf, char delim, char sep, int recur)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cdr_serialize_variables           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>cdr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__str.html">ast_str</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char&nbsp;</td>
          <td class="mdname" nowrap> <em>delim</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char&nbsp;</td>
          <td class="mdname" nowrap> <em>sep</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>recur</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00363">363</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8c-source.html#l00222">ast_cdr_getvar()</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="strings_8h.html#0c00985509b077cfe0ccdd5829342ca4">ast_str_append()</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="chanvars_8c-source.html#l00062">ast_var_name()</a>, <a class="el" href="chanvars_8c-source.html#l00082">ast_var_value()</a>, <a class="el" href="cdr_8c-source.html#l00288">cdr_readonly_vars</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>, <a class="el" href="res__adsi_8c-source.html#l00943">total</a>, <a class="el" href="ast__expr2f_8c-source.html#l01417">var</a>, and <a class="el" href="cdr_8h-source.html#l00093">ast_cdr::varshead</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l00770">handle_showchan()</a>.<div class="fragment"><pre class="fragment"><a name="l00364"></a>00364 {
<a name="l00365"></a>00365    <span class="keyword">struct </span><a class="code" href="structast__var__t.html">ast_var_t</a> *variables;
<a name="l00366"></a>00366    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, *<a class="code" href="structval.html">val</a>;
<a name="l00367"></a>00367    <span class="keywordtype">char</span> *tmp;
<a name="l00368"></a>00368    <span class="keywordtype">char</span> workspace[256];
<a name="l00369"></a>00369    <span class="keywordtype">int</span> <a class="code" href="res__adsi_8c.html#fbb44b4487415b134bce9c790a27fe5e">total</a> = 0, x = 0, i;
<a name="l00370"></a>00370 
<a name="l00371"></a>00371    (*buf)-&gt;used = 0;
<a name="l00372"></a>00372    (*buf)-&gt;str[0] = <span class="charliteral">'\0'</span>;
<a name="l00373"></a>00373 
<a name="l00374"></a>00374    <span class="keywordflow">for</span> (; cdr; cdr = recur ? cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> : NULL) {
<a name="l00375"></a>00375       <span class="keywordflow">if</span> (++x &gt; 1)
<a name="l00376"></a>00376          <a class="code" href="strings_8h.html#0c00985509b077cfe0ccdd5829342ca4">ast_str_append</a>(buf, 0, <span class="stringliteral">"\n"</span>);
<a name="l00377"></a>00377 
<a name="l00378"></a>00378       <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;cdr-&gt;<a class="code" href="structast__cdr.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>, variables, entries) {
<a name="l00379"></a>00379          <span class="keywordflow">if</span> (variables &amp;&amp;
<a name="l00380"></a>00380              (var = <a class="code" href="chanvars_8c.html#29d40dfad3c6b59de315b3a0d2ed0a23">ast_var_name</a>(variables)) &amp;&amp; (val = <a class="code" href="chanvars_8c.html#6aa089cff5424a26ade21a520e443f82">ast_var_value</a>(variables)) &amp;&amp;
<a name="l00381"></a>00381              !<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(var) &amp;&amp; !<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(val)) {
<a name="l00382"></a>00382             <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#0c00985509b077cfe0ccdd5829342ca4">ast_str_append</a>(buf, 0, <span class="stringliteral">"level %d: %s%c%s%c"</span>, x, var, delim, val, sep) &lt; 0) {
<a name="l00383"></a>00383                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Data Buffer Size Exceeded!\n"</span>);
<a name="l00384"></a>00384                <span class="keywordflow">break</span>;
<a name="l00385"></a>00385             } <span class="keywordflow">else</span>
<a name="l00386"></a>00386                total++;
<a name="l00387"></a>00387          } <span class="keywordflow">else</span> 
<a name="l00388"></a>00388             <span class="keywordflow">break</span>;
<a name="l00389"></a>00389       }
<a name="l00390"></a>00390 
<a name="l00391"></a>00391       <span class="keywordflow">for</span> (i = 0; <a class="code" href="cdr_8c.html#1f96fa39c256ac26c81d8e7b53765f24">cdr_readonly_vars</a>[i]; i++) {
<a name="l00392"></a>00392          <a class="code" href="cdr_8c.html#9e9ccbed2b4365369048829d27fad973">ast_cdr_getvar</a>(cdr, <a class="code" href="cdr_8c.html#1f96fa39c256ac26c81d8e7b53765f24">cdr_readonly_vars</a>[i], &amp;tmp, workspace, <span class="keyword">sizeof</span>(workspace), 0, 0);
<a name="l00393"></a>00393          <span class="keywordflow">if</span> (!tmp)
<a name="l00394"></a>00394             <span class="keywordflow">continue</span>;
<a name="l00395"></a>00395          
<a name="l00396"></a>00396          <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#0c00985509b077cfe0ccdd5829342ca4">ast_str_append</a>(buf, 0, <span class="stringliteral">"level %d: %s%c%s%c"</span>, x, <a class="code" href="cdr_8c.html#1f96fa39c256ac26c81d8e7b53765f24">cdr_readonly_vars</a>[i], delim, tmp, sep) &lt; 0) {
<a name="l00397"></a>00397             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Data Buffer Size Exceeded!\n"</span>);
<a name="l00398"></a>00398             <span class="keywordflow">break</span>;
<a name="l00399"></a>00399          } <span class="keywordflow">else</span>
<a name="l00400"></a>00400             total++;
<a name="l00401"></a>00401       }
<a name="l00402"></a>00402    }
<a name="l00403"></a>00403 
<a name="l00404"></a>00404    <span class="keywordflow">return</span> total;
<a name="l00405"></a>00405 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8aa58d36e6bd15ba7d10e367d9870e60"></a><!-- doxytag: member="cdr.h::ast_cdr_setaccount" ref="8aa58d36e6bd15ba7d10e367d9870e60" args="(struct ast_channel *chan, const char *account)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cdr_setaccount           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>account</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00834">834</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00084">ast_cdr::accountcode</a>, <a class="el" href="chan__iax2_8c-source.html#l00235">accountcode</a>, <a class="el" href="cdr_8h-source.html#l00029">AST_CDR_FLAG_LOCKED</a>, <a class="el" href="stringfields_8h-source.html#l00275">ast_string_field_set</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, and <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="pbx_8c-source.html#l05150">ast_pbx_outgoing_app()</a>, <a class="el" href="pbx_8c-source.html#l04991">ast_pbx_outgoing_exten()</a>, <a class="el" href="app__authenticate_8c-source.html#l00094">auth_exec()</a>, and <a class="el" href="func__cdr_8c-source.html#l00090">cdr_write()</a>.<div class="fragment"><pre class="fragment"><a name="l00835"></a>00835 {
<a name="l00836"></a>00836    <span class="keyword">struct </span><a class="code" href="structast__cdr.html">ast_cdr</a> *cdr = chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>;
<a name="l00837"></a>00837 
<a name="l00838"></a>00838    <a class="code" href="stringfields_8h.html#af456e04e9e17dd8a300d1d3cd75b65a">ast_string_field_set</a>(chan, <a class="code" href="chan__iax2_8c.html#6c4d520c88ca77ed2acc04ae1add9f8e">accountcode</a>, account);
<a name="l00839"></a>00839    <span class="keywordflow">for</span> ( ; cdr ; cdr = cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l00840"></a>00840       <span class="keywordflow">if</span> (!<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(cdr, <a class="code" href="cdr_8h.html#372c8464bd559bdb42452d12d39457e4">AST_CDR_FLAG_LOCKED</a>)) {
<a name="l00841"></a>00841          ast_copy_string(cdr-&gt;<a class="code" href="structast__cdr.html#6c4d520c88ca77ed2acc04ae1add9f8e">accountcode</a>, chan-&gt;accountcode, <span class="keyword">sizeof</span>(cdr-&gt;<a class="code" href="structast__cdr.html#6c4d520c88ca77ed2acc04ae1add9f8e">accountcode</a>));
<a name="l00842"></a>00842       }
<a name="l00843"></a>00843    }
<a name="l00844"></a>00844    <span class="keywordflow">return</span> 0;
<a name="l00845"></a>00845 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="fc85f2cc535a9122f7d6ecd3fc7b109a"></a><!-- doxytag: member="cdr.h::ast_cdr_setamaflags" ref="fc85f2cc535a9122f7d6ecd3fc7b109a" args="(struct ast_channel *chan, const char *amaflags)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cdr_setamaflags           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>amaflags</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00847">847</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00082">ast_cdr::amaflags</a>, <a class="el" href="cdr_8c-source.html#l00906">ast_cdr_amaflags2int()</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, and <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>.
<p>
Referenced by <a class="el" href="func__cdr_8c-source.html#l00090">cdr_write()</a>, and <a class="el" href="pbx_8c-source.html#l05459">pbx_builtin_setamaflags()</a>.<div class="fragment"><pre class="fragment"><a name="l00848"></a>00848 {
<a name="l00849"></a>00849    <span class="keyword">struct </span><a class="code" href="structast__cdr.html">ast_cdr</a> *cdr;
<a name="l00850"></a>00850    <span class="keywordtype">int</span> newflag = <a class="code" href="cdr_8c.html#3b703edfed7ece1e9f55e5a31fcec203">ast_cdr_amaflags2int</a>(flag);
<a name="l00851"></a>00851    <span class="keywordflow">if</span> (newflag) {
<a name="l00852"></a>00852       <span class="keywordflow">for</span> (cdr = chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>; cdr; cdr = cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>)
<a name="l00853"></a>00853          cdr-&gt;<a class="code" href="structast__cdr.html#d5aa4bb1461fe3d863bd95fb137e2284">amaflags</a> = newflag;
<a name="l00854"></a>00854    }
<a name="l00855"></a>00855 
<a name="l00856"></a>00856    <span class="keywordflow">return</span> 0;
<a name="l00857"></a>00857 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="018b6c8a00209b6cf1fd7386b493f930"></a><!-- doxytag: member="cdr.h::ast_cdr_setapp" ref="018b6c8a00209b6cf1fd7386b493f930" args="(struct ast_cdr *cdr, char *app, char *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_cdr_setapp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>cdr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>app</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cdr</em>&nbsp;</td><td>which cdr to act upon </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>app</em>&nbsp;</td><td>the name of the app you wish to change it to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>the data you want in the data field of app you set it to Changes the value of the last executed app Returns nothing </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00718">718</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00029">AST_CDR_FLAG_LOCKED</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="cdr_8c-source.html#l00421">check_post()</a>, and <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="res__features_8c-source.html#l00673">builtin_blindtransfer()</a>, <a class="el" href="app__followme_8c-source.html#l00428">clear_caller()</a>, <a class="el" href="app__followme_8c-source.html#l00763">findmeexec()</a>, and <a class="el" href="pbx_8c-source.html#l00509">pbx_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l00719"></a>00719 {
<a name="l00720"></a>00720 
<a name="l00721"></a>00721    <span class="keywordflow">for</span> (; cdr; cdr = cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l00722"></a>00722       <span class="keywordflow">if</span> (!<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(cdr, <a class="code" href="cdr_8h.html#372c8464bd559bdb42452d12d39457e4">AST_CDR_FLAG_LOCKED</a>)) {
<a name="l00723"></a>00723          <a class="code" href="cdr_8c.html#5b89f2cf8a1628735231e82ad14e36d3">check_post</a>(cdr);
<a name="l00724"></a>00724          <span class="keywordflow">if</span> (!<a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>)
<a name="l00725"></a>00725             <a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a> = <span class="stringliteral">""</span>;
<a name="l00726"></a>00726          ast_copy_string(cdr-&gt;<a class="code" href="structast__cdr.html#d25b12f576ea83fb63d766ba441118ec">lastapp</a>, <a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>, <span class="keyword">sizeof</span>(cdr-&gt;<a class="code" href="structast__cdr.html#d25b12f576ea83fb63d766ba441118ec">lastapp</a>));
<a name="l00727"></a>00727          <span class="keywordflow">if</span> (!data)
<a name="l00728"></a>00728             data = <span class="stringliteral">""</span>;
<a name="l00729"></a>00729          ast_copy_string(cdr-&gt;<a class="code" href="structast__cdr.html#4fbefaf41bef377eb6daf5ffad10df62">lastdata</a>, data, <span class="keyword">sizeof</span>(cdr-&gt;<a class="code" href="structast__cdr.html#4fbefaf41bef377eb6daf5ffad10df62">lastdata</a>));
<a name="l00730"></a>00730       }
<a name="l00731"></a>00731    }
<a name="l00732"></a>00732 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="f0b0c703dd296420e2be0b33938fa1e6"></a><!-- doxytag: member="cdr.h::ast_cdr_setcid" ref="f0b0c703dd296420e2be0b33938fa1e6" args="(struct ast_cdr *cdr, struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cdr_setcid           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>cdr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cdr</em>&nbsp;</td><td>Call Detail Record to use for channel </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>Channel to bind CDR with Initializes a CDR and associates it with a particular channel Return is negligible. (returns 0 by default) </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00754">754</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00029">AST_CDR_FLAG_LOCKED</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>, and <a class="el" href="cdr_8c-source.html#l00735">set_one_cid()</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l03694">ast_set_callerid()</a>.<div class="fragment"><pre class="fragment"><a name="l00755"></a>00755 {
<a name="l00756"></a>00756    <span class="keywordflow">for</span> (; cdr; cdr = cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l00757"></a>00757       <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(cdr, <a class="code" href="cdr_8h.html#372c8464bd559bdb42452d12d39457e4">AST_CDR_FLAG_LOCKED</a>))
<a name="l00758"></a>00758          <a class="code" href="cdr_8c.html#e09dbd75e437418aa84bcc25040ec73d">set_one_cid</a>(cdr, c);
<a name="l00759"></a>00759    }
<a name="l00760"></a>00760    <span class="keywordflow">return</span> 0;
<a name="l00761"></a>00761 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b4a7713b2ae462d79a380623ed2f4e21"></a><!-- doxytag: member="cdr.h::ast_cdr_setdestchan" ref="b4a7713b2ae462d79a380623ed2f4e21" args="(struct ast_cdr *cdr, const char *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_cdr_setdestchan           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>cdr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cdr</em>&nbsp;</td><td>Which cdr it's applied to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>Channel to which dest will be Sets the destination channel the CDR is applied to Returns nothing </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00709">709</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00029">AST_CDR_FLAG_LOCKED</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="cdr_8c-source.html#l00421">check_post()</a>, <a class="el" href="cdr_8h-source.html#l00064">ast_cdr::dstchannel</a>, and <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>.
<p>
Referenced by <a class="el" href="res__features_8c-source.html#l00231">ast_bridge_call_thread()</a>, <a class="el" href="res__features_8c-source.html#l00673">builtin_blindtransfer()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, and <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>.<div class="fragment"><pre class="fragment"><a name="l00710"></a>00710 {
<a name="l00711"></a>00711    <span class="keywordflow">for</span> (; cdr; cdr = cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l00712"></a>00712       <a class="code" href="cdr_8c.html#5b89f2cf8a1628735231e82ad14e36d3">check_post</a>(cdr);
<a name="l00713"></a>00713       <span class="keywordflow">if</span> (!<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(cdr, <a class="code" href="cdr_8h.html#372c8464bd559bdb42452d12d39457e4">AST_CDR_FLAG_LOCKED</a>))
<a name="l00714"></a>00714          ast_copy_string(cdr-&gt;<a class="code" href="structast__cdr.html#9ff13b69b0f16b02154ada5fb39a0845">dstchannel</a>, chann, <span class="keyword">sizeof</span>(cdr-&gt;<a class="code" href="structast__cdr.html#9ff13b69b0f16b02154ada5fb39a0845">dstchannel</a>));
<a name="l00715"></a>00715    }
<a name="l00716"></a>00716 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="7faf485af47fef9299ce51da70c13c8b"></a><!-- doxytag: member="cdr.h::ast_cdr_setuserfield" ref="7faf485af47fef9299ce51da70c13c8b" args="(struct ast_channel *chan, const char *userfield)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cdr_setuserfield           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>userfield</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00859">859</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00029">AST_CDR_FLAG_LOCKED</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>, and <a class="el" href="cdr_8h-source.html#l00090">ast_cdr::userfield</a>.
<p>
Referenced by <a class="el" href="chan__agent_8c-source.html#l00394">__agent_start_monitoring()</a>, <a class="el" href="res__features_8c-source.html#l01478">ast_bridge_call()</a>, <a class="el" href="func__cdr_8c-source.html#l00090">cdr_write()</a>, <a class="el" href="chan__sip_8c-source.html#l11655">handle_request_info()</a>, and <a class="el" href="res__monitor_8c-source.html#l00389">start_monitor_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l00860"></a>00860 {
<a name="l00861"></a>00861    <span class="keyword">struct </span><a class="code" href="structast__cdr.html">ast_cdr</a> *cdr = chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>;
<a name="l00862"></a>00862 
<a name="l00863"></a>00863    <span class="keywordflow">for</span> ( ; cdr ; cdr = cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l00864"></a>00864       <span class="keywordflow">if</span> (!<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(cdr, <a class="code" href="cdr_8h.html#372c8464bd559bdb42452d12d39457e4">AST_CDR_FLAG_LOCKED</a>)) 
<a name="l00865"></a>00865          ast_copy_string(cdr-&gt;<a class="code" href="structast__cdr.html#07c0f6b6a5bf53c1c68383f1f0c9398e">userfield</a>, <a class="code" href="structast__cdr.html#07c0f6b6a5bf53c1c68383f1f0c9398e">userfield</a>, <span class="keyword">sizeof</span>(cdr-&gt;<a class="code" href="structast__cdr.html#07c0f6b6a5bf53c1c68383f1f0c9398e">userfield</a>));
<a name="l00866"></a>00866    }
<a name="l00867"></a>00867 
<a name="l00868"></a>00868    <span class="keywordflow">return</span> 0;
<a name="l00869"></a>00869 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="5f441d69a57278fe59d34458e215fae5"></a><!-- doxytag: member="cdr.h::ast_cdr_setvar" ref="5f441d69a57278fe59d34458e215fae5" args="(struct ast_cdr *cdr, const char *name, const char *value, int recur)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cdr_setvar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>cdr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>recur</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set a CDR channel variable <dl compact><dt><b>Note:</b></dt><dd>You can't set the CDR variables that belong to the actual CDR record, like "billsec". </dd></dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00295">295</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00650">AST_LIST_INSERT_HEAD</a>, <a class="el" href="linkedlists_8h-source.html#l00516">AST_LIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h-source.html#l00491">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h-source.html#l00554">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="chanvars_8c-source.html#l00039">ast_var_assign()</a>, <a class="el" href="chanvars_8c-source.html#l00056">ast_var_delete()</a>, <a class="el" href="chanvars_8c-source.html#l00062">ast_var_name()</a>, <a class="el" href="cdr_8c-source.html#l00288">cdr_readonly_vars</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>, and <a class="el" href="cdr_8h-source.html#l00093">ast_cdr::varshead</a>.
<p>
Referenced by <a class="el" href="func__cdr_8c-source.html#l00090">cdr_write()</a>.<div class="fragment"><pre class="fragment"><a name="l00296"></a>00296 {
<a name="l00297"></a>00297    <span class="keyword">struct </span><a class="code" href="structast__var__t.html">ast_var_t</a> *newvariable;
<a name="l00298"></a>00298    <span class="keyword">struct </span>varshead *headp;
<a name="l00299"></a>00299    <span class="keywordtype">int</span> x;
<a name="l00300"></a>00300    
<a name="l00301"></a>00301    <span class="keywordflow">if</span> (!cdr)  <span class="comment">/* don't die if the cdr is null */</span>
<a name="l00302"></a>00302       <span class="keywordflow">return</span> -1;
<a name="l00303"></a>00303    
<a name="l00304"></a>00304    <span class="keywordflow">for</span> (x = 0; <a class="code" href="cdr_8c.html#1f96fa39c256ac26c81d8e7b53765f24">cdr_readonly_vars</a>[x]; x++) {
<a name="l00305"></a>00305       <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <a class="code" href="cdr_8c.html#1f96fa39c256ac26c81d8e7b53765f24">cdr_readonly_vars</a>[x])) {
<a name="l00306"></a>00306          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Attempt to set the '%s' read-only variable!.\n"</span>, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l00307"></a>00307          <span class="keywordflow">return</span> -1;
<a name="l00308"></a>00308       }
<a name="l00309"></a>00309    }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311    <span class="keywordflow">if</span> (!cdr) {
<a name="l00312"></a>00312       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Attempt to set a variable on a nonexistent CDR record.\n"</span>);
<a name="l00313"></a>00313       <span class="keywordflow">return</span> -1;
<a name="l00314"></a>00314    }
<a name="l00315"></a>00315 
<a name="l00316"></a>00316    <span class="keywordflow">for</span> (; cdr; cdr = recur ? cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> : NULL) {
<a name="l00317"></a>00317       headp = &amp;cdr-&gt;<a class="code" href="structast__cdr.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>;
<a name="l00318"></a>00318       <a class="code" href="linkedlists_8h.html#915e438a9528c8d6316c617b5bd84487">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(headp, newvariable, entries) {
<a name="l00319"></a>00319          <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="chanvars_8c.html#29d40dfad3c6b59de315b3a0d2ed0a23">ast_var_name</a>(newvariable), <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>)) {
<a name="l00320"></a>00320             <span class="comment">/* there is already such a variable, delete it */</span>
<a name="l00321"></a>00321             <a class="code" href="linkedlists_8h.html#37f99379dafa45c921f95bf7235eb91d">AST_LIST_REMOVE_CURRENT</a>(headp, entries);
<a name="l00322"></a>00322             <a class="code" href="chanvars_8c.html#32e018d32324bab845a9cac601c175d8">ast_var_delete</a>(newvariable);
<a name="l00323"></a>00323             <span class="keywordflow">break</span>;
<a name="l00324"></a>00324          }
<a name="l00325"></a>00325       }
<a name="l00326"></a>00326       <a class="code" href="linkedlists_8h.html#a93fdadc00a2a090968004b7d9c79630">AST_LIST_TRAVERSE_SAFE_END</a>;
<a name="l00327"></a>00327 
<a name="l00328"></a>00328       <span class="keywordflow">if</span> (value) {
<a name="l00329"></a>00329          newvariable = <a class="code" href="chanvars_8c.html#4d0028e2dbd755ae38d2fe4204ad9071">ast_var_assign</a>(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, value);
<a name="l00330"></a>00330          <a class="code" href="linkedlists_8h.html#5df56040a8838bdc841ef8eb179b7609">AST_LIST_INSERT_HEAD</a>(headp, newvariable, entries);
<a name="l00331"></a>00331       }
<a name="l00332"></a>00332    }
<a name="l00333"></a>00333 
<a name="l00334"></a>00334    <span class="keywordflow">return</span> 0;
<a name="l00335"></a>00335 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="56e1b7b9d5acada4d22d345813710582"></a><!-- doxytag: member="cdr.h::ast_cdr_start" ref="56e1b7b9d5acada4d22d345813710582" args="(struct ast_cdr *cdr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_cdr_start           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cdr.html">ast_cdr</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>cdr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cdr</em>&nbsp;</td><td>the cdr you wish to associate with the call Starts all CDR stuff necessary for monitoring a call Returns nothing </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00620">620</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00029">AST_CDR_FLAG_LOCKED</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="adsistub_8c-source.html#l00055">chan</a>, <a class="el" href="cdr_8h-source.html#l00062">ast_cdr::channel</a>, <a class="el" href="cdr_8c-source.html#l00421">check_post()</a>, <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>, <a class="el" href="strings_8h-source.html#l00045">S_OR</a>, and <a class="el" href="cdr_8h-source.html#l00070">ast_cdr::start</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>, <a class="el" href="channel_8c-source.html#l02060">__ast_read()</a>, <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="cdr_8c-source.html#l00942">ast_cdr_reset()</a>, <a class="el" href="channel_8c-source.html#l00632">ast_channel_alloc()</a>, <a class="el" href="res__features_8c-source.html#l01295">ast_feature_request_and_dial()</a>, <a class="el" href="pbx_8c-source.html#l05150">ast_pbx_outgoing_app()</a>, <a class="el" href="pbx_8c-source.html#l04966">ast_pbx_outgoing_cdr_failed()</a>, <a class="el" href="res__features_8c-source.html#l00673">builtin_blindtransfer()</a>, <a class="el" href="app__followme_8c-source.html#l00428">clear_caller()</a>, and <a class="el" href="app__followme_8c-source.html#l00763">findmeexec()</a>.<div class="fragment"><pre class="fragment"><a name="l00621"></a>00621 {
<a name="l00622"></a>00622    <span class="keywordtype">char</span> *<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>; 
<a name="l00623"></a>00623 
<a name="l00624"></a>00624    <span class="keywordflow">for</span> (; cdr; cdr = cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l00625"></a>00625       <span class="keywordflow">if</span> (!<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(cdr, <a class="code" href="cdr_8h.html#372c8464bd559bdb42452d12d39457e4">AST_CDR_FLAG_LOCKED</a>)) {
<a name="l00626"></a>00626          chan = <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(cdr-&gt;<a class="code" href="structast__cdr.html#53688148c71d0e0eb1072fed5c2ea24a">channel</a>, <span class="stringliteral">"&lt;unknown&gt;"</span>);
<a name="l00627"></a>00627          <a class="code" href="cdr_8c.html#5b89f2cf8a1628735231e82ad14e36d3">check_post</a>(cdr);
<a name="l00628"></a>00628          cdr-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a> = ast_tvnow();
<a name="l00629"></a>00629       }
<a name="l00630"></a>00630    }
<a name="l00631"></a>00631 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b77b4351337e066e9c9e97e5f528d46a"></a><!-- doxytag: member="cdr.h::ast_cdr_submit_batch" ref="b77b4351337e066e9c9e97e5f528d46a" args="(int shutdown)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_cdr_submit_batch           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>shutdown</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>shutdown</em>&nbsp;</td><td>Whether or not we are shutting down Blocks the asterisk shutdown procedures until the CDR data is submitted. Returns nothing </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l01033">1033</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="lock_8h-source.html#l00530">ast_mutex_lock()</a>, <a class="el" href="lock_8h-source.html#l00520">ast_mutex_unlock()</a>, <a class="el" href="utils_8h-source.html#l00312">ast_pthread_create_detached_background</a>, <a class="el" href="lock_8h-source.html#l00074">AST_PTHREADT_NULL</a>, <a class="el" href="cdr_8c.html#d265aed699f7409ac0ec6fe07ee9cb11">batch</a>, <a class="el" href="cdr_8c-source.html#l00095">batchscheduleronly</a>, <a class="el" href="cdr_8c-source.html#l01016">do_batch_backend_process()</a>, <a class="el" href="cdr_8c-source.html#l00078">ast_cdr_batch::head</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, and <a class="el" href="cdr_8c-source.html#l00997">reset_batch()</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l01365">ast_cdr_engine_term()</a>, and <a class="el" href="cdr_8c-source.html#l01065">submit_scheduled_batch()</a>.<div class="fragment"><pre class="fragment"><a name="l01034"></a>01034 {
<a name="l01035"></a>01035    <span class="keyword">struct </span><a class="code" href="structast__cdr__batch__item.html">ast_cdr_batch_item</a> *oldbatchitems = NULL;
<a name="l01036"></a>01036    pthread_t batch_post_thread = <a class="code" href="lock_8h.html#84e4b34008de83ea9d1fa44057758022">AST_PTHREADT_NULL</a>;
<a name="l01037"></a>01037 
<a name="l01038"></a>01038    <span class="comment">/* if there's no batch, or no CDRs in the batch, then there's nothing to do */</span>
<a name="l01039"></a>01039    <span class="keywordflow">if</span> (!<a class="code" href="cdr_8c.html#d265aed699f7409ac0ec6fe07ee9cb11">batch</a> || !<a class="code" href="cdr_8c.html#d265aed699f7409ac0ec6fe07ee9cb11">batch</a>-&gt;<a class="code" href="structast__cdr__batch.html#96e89a298e0a9f469b9ae458d6afae9f">head</a>)
<a name="l01040"></a>01040       <span class="keywordflow">return</span>;
<a name="l01041"></a>01041 
<a name="l01042"></a>01042    <span class="comment">/* move the old CDRs aside, and prepare a new CDR batch */</span>
<a name="l01043"></a>01043    <a class="code" href="lock_8h.html#b3c5e3093b325167f88db93c8b4b2421">ast_mutex_lock</a>(&amp;cdr_batch_lock);
<a name="l01044"></a>01044    oldbatchitems = <a class="code" href="cdr_8c.html#d265aed699f7409ac0ec6fe07ee9cb11">batch</a>-&gt;<a class="code" href="structast__cdr__batch.html#96e89a298e0a9f469b9ae458d6afae9f">head</a>;
<a name="l01045"></a>01045    <a class="code" href="cdr_8c.html#fe8968a1b87d45651856ae294930ba11">reset_batch</a>();
<a name="l01046"></a>01046    <a class="code" href="lock_8h.html#1d33e3caf152f0901c5ebdb69c2d4d26">ast_mutex_unlock</a>(&amp;cdr_batch_lock);
<a name="l01047"></a>01047 
<a name="l01048"></a>01048    <span class="comment">/* if configured, spawn a new thread to post these CDRs,</span>
<a name="l01049"></a>01049 <span class="comment">      also try to save as much as possible if we are shutting down safely */</span>
<a name="l01050"></a>01050    <span class="keywordflow">if</span> (<a class="code" href="cdr_8c.html#92952b8e3528c5da0ff4e5924f57e31c">batchscheduleronly</a> || shutdown) {
<a name="l01051"></a>01051       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l01052"></a>01052          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"CDR single-threaded batch processing begins now\n"</span>);
<a name="l01053"></a>01053       <a class="code" href="cdr_8c.html#ae6eb32ef28318012515bfbd35cf0cae">do_batch_backend_process</a>(oldbatchitems);
<a name="l01054"></a>01054    } <span class="keywordflow">else</span> {
<a name="l01055"></a>01055       <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#ca64243ae8a976c50a48a88de8eea818">ast_pthread_create_detached_background</a>(&amp;batch_post_thread, NULL, <a class="code" href="cdr_8c.html#ae6eb32ef28318012515bfbd35cf0cae">do_batch_backend_process</a>, oldbatchitems)) {
<a name="l01056"></a>01056          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"CDR processing thread could not detach, now trying in this thread\n"</span>);
<a name="l01057"></a>01057          <a class="code" href="cdr_8c.html#ae6eb32ef28318012515bfbd35cf0cae">do_batch_backend_process</a>(oldbatchitems);
<a name="l01058"></a>01058       } <span class="keywordflow">else</span> {
<a name="l01059"></a>01059          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l01060"></a>01060             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"CDR multi-threaded batch processing begins now\n"</span>);
<a name="l01061"></a>01061       }
<a name="l01062"></a>01062    }
<a name="l01063"></a>01063 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="96eff2f7a72924e9ce8a342824e00465"></a><!-- doxytag: member="cdr.h::ast_cdr_unregister" ref="96eff2f7a72924e9ce8a342824e00465" args="(const char *name)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_cdr_unregister           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>name</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
unregister a CDR driver 
<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00150">150</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00038">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00516">AST_LIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h-source.html#l00491">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h-source.html#l00554">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h-source.html#l00104">AST_LIST_UNLOCK</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="cdr_8c-source.html#l00063">ast_cdr_beitem::name</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, and <a class="el" href="logger_8h-source.html#l00044">VERBOSE_PREFIX_2</a>.
<p>
Referenced by <a class="el" href="cdr__pgsql_8c-source.html#l00182">my_unload_module()</a>, <a class="el" href="cdr__odbc_8c-source.html#l00209">odbc_unload_module()</a>, <a class="el" href="cdr__tds_8c-source.html#l00410">tds_unload_module()</a>, and <a class="el" href="cdr__adaptive__odbc_8c-source.html#l00575">unload_module()</a>.<div class="fragment"><pre class="fragment"><a name="l00151"></a>00151 {
<a name="l00152"></a>00152    <span class="keyword">struct </span><a class="code" href="structast__cdr__beitem.html">ast_cdr_beitem</a> *i = NULL;
<a name="l00153"></a>00153 
<a name="l00154"></a>00154    <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;be_list);
<a name="l00155"></a>00155    <a class="code" href="linkedlists_8h.html#915e438a9528c8d6316c617b5bd84487">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;be_list, i, list) {
<a name="l00156"></a>00156       <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, i-&gt;<a class="code" href="structast__cdr__beitem.html#8c9c7bab06d31b05557f3a0f229239e1">name</a>)) {
<a name="l00157"></a>00157          <a class="code" href="linkedlists_8h.html#37f99379dafa45c921f95bf7235eb91d">AST_LIST_REMOVE_CURRENT</a>(&amp;be_list, list);
<a name="l00158"></a>00158          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 1)
<a name="l00159"></a>00159             <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Unregistered '%s' CDR backend\n"</span>, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l00160"></a>00160          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(i);
<a name="l00161"></a>00161          <span class="keywordflow">break</span>;
<a name="l00162"></a>00162       }
<a name="l00163"></a>00163    }
<a name="l00164"></a>00164    <a class="code" href="linkedlists_8h.html#a93fdadc00a2a090968004b7d9c79630">AST_LIST_TRAVERSE_SAFE_END</a>;
<a name="l00165"></a>00165    <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;be_list);
<a name="l00166"></a>00166 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="93884b34915ee737f1a050ba33744fea"></a><!-- doxytag: member="cdr.h::ast_cdr_update" ref="93884b34915ee737f1a050ba33744fea" args="(struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_cdr_update           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chan</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00885">885</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8h-source.html#l00029">AST_CDR_FLAG_LOCKED</a>, <a class="el" href="channel_8c-source.html#l00325">ast_check_hangup()</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, <a class="el" href="channel_8h-source.html#l00441">ast_channel::context</a>, <a class="el" href="channel_8h-source.html#l00442">ast_channel::exten</a>, <a class="el" href="channel_8h-source.html#l00444">ast_channel::macrocontext</a>, <a class="el" href="channel_8h-source.html#l00445">ast_channel::macroexten</a>, <a class="el" href="cdr_8h-source.html#l00095">ast_cdr::next</a>, <a class="el" href="strings_8h-source.html#l00045">S_OR</a>, and <a class="el" href="cdr_8c-source.html#l00735">set_one_cid()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>, <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="pbx_8c-source.html#l06287">ast_parseable_goto()</a>, <a class="el" href="app__followme_8c-source.html#l00428">clear_caller()</a>, and <a class="el" href="app__followme_8c-source.html#l00763">findmeexec()</a>.<div class="fragment"><pre class="fragment"><a name="l00886"></a>00886 {
<a name="l00887"></a>00887    <span class="keyword">struct </span><a class="code" href="structast__cdr.html">ast_cdr</a> *cdr = c-&gt;cdr;
<a name="l00888"></a>00888 
<a name="l00889"></a>00889    <span class="keywordflow">for</span> ( ; cdr ; cdr = cdr-&gt;<a class="code" href="structast__cdr.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l00890"></a>00890       <span class="keywordflow">if</span> (!<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(cdr, <a class="code" href="cdr_8h.html#372c8464bd559bdb42452d12d39457e4">AST_CDR_FLAG_LOCKED</a>)) {
<a name="l00891"></a>00891          <a class="code" href="cdr_8c.html#e09dbd75e437418aa84bcc25040ec73d">set_one_cid</a>(cdr, c);
<a name="l00892"></a>00892 
<a name="l00893"></a>00893          <span class="comment">/* Copy account code et-al */</span> 
<a name="l00894"></a>00894          ast_copy_string(cdr-&gt;<a class="code" href="structast__cdr.html#6c4d520c88ca77ed2acc04ae1add9f8e">accountcode</a>, c-&gt;accountcode, <span class="keyword">sizeof</span>(cdr-&gt;<a class="code" href="structast__cdr.html#6c4d520c88ca77ed2acc04ae1add9f8e">accountcode</a>));
<a name="l00895"></a>00895          <span class="keywordflow">if</span> (!<a class="code" href="channel_8c.html#042e64a8d465783855a52ec8c56a9373">ast_check_hangup</a>(c)) {
<a name="l00896"></a>00896             <span class="comment">/* Destination information */</span> <span class="comment">/* XXX privilege macro* ? */</span>
<a name="l00897"></a>00897             ast_copy_string(cdr-&gt;<a class="code" href="structast__cdr.html#a476c1bc0b4765c02b33e33730740691">dst</a>, <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(c-&gt;macroexten, c-&gt;exten), <span class="keyword">sizeof</span>(cdr-&gt;<a class="code" href="structast__cdr.html#a476c1bc0b4765c02b33e33730740691">dst</a>));
<a name="l00898"></a>00898             ast_copy_string(cdr-&gt;<a class="code" href="structast__cdr.html#c51661c78ed2588eff211c9e29718fc5">dcontext</a>, <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(c-&gt;macrocontext, c-&gt;context), <span class="keyword">sizeof</span>(cdr-&gt;<a class="code" href="structast__cdr.html#c51661c78ed2588eff211c9e29718fc5">dcontext</a>));
<a name="l00899"></a>00899          }
<a name="l00900"></a>00900       }
<a name="l00901"></a>00901    }
<a name="l00902"></a>00902 
<a name="l00903"></a>00903    <span class="keywordflow">return</span> 0;
<a name="l00904"></a>00904 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="26604a41e0aec0115baed803201cd74b"></a><!-- doxytag: member="cdr.h::check_cdr_enabled" ref="26604a41e0aec0115baed803201cd74b" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int check_cdr_enabled           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return TRUE if CDR subsystem is enabled. 
<p>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00104">104</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
References <a class="el" href="cdr_8c-source.html#l00091">enabled</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l02200">action_coresettings()</a>, and <a class="el" href="asterisk_8c-source.html#l00344">handle_show_settings()</a>.<div class="fragment"><pre class="fragment"><a name="l00105"></a>00105 {
<a name="l00106"></a>00106    <span class="keywordflow">return</span> <a class="code" href="cdr_8c.html#a10311459433adf322f2590a4987c423">enabled</a>;
<a name="l00107"></a>00107 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="77219a32a253309bd3900aedd6cf8d07"></a><!-- doxytag: member="cdr.h::ast_default_accountcode" ref="77219a32a253309bd3900aedd6cf8d07" args="[AST_MAX_ACCOUNT_CODE]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char <a class="el" href="cdr_8h.html#77219a32a253309bd3900aedd6cf8d07">ast_default_accountcode</a>[AST_MAX_ACCOUNT_CODE]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00060">60</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l00632">ast_channel_alloc()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="d5268e5dc9c134f0ce5f28da7a447335"></a><!-- doxytag: member="cdr.h::ast_default_amaflags" ref="d5268e5dc9c134f0ce5f28da7a447335" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="cdr_8h.html#d5268e5dc9c134f0ce5f28da7a447335">ast_default_amaflags</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Default AMA flag for billing records (CDR's) 
<p>
Definition at line <a class="el" href="cdr_8c-source.html#l00059">59</a> of file <a class="el" href="cdr_8c-source.html">cdr.c</a>.
<p>
Referenced by <a class="el" href="cdr_8c-source.html#l00763">ast_cdr_init()</a>, and <a class="el" href="channel_8c-source.html#l00632">ast_channel_alloc()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Thu May 24 22:27:05 2007 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.5 </small></address>
</body>
</html>
