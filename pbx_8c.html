<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (24 May 2007)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Thu May 24 22:27:37 2007</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir__2Fusr_2Flocal_2Fsrc_2Fasterisk_2Esvn_2Fastum_2Fmain_2F.html">main</a></div>
<h1>pbx.c File Reference</h1>Core PBX routines. <a href="#_details">More...</a>
<p>
<code>#include &quot;<a class="el" href="asterisk_8h-source.html">asterisk.h</a>&quot;</code><br>
<code>#include &lt;sys/types.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;unistd.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;ctype.h&gt;</code><br>
<code>#include &lt;errno.h&gt;</code><br>
<code>#include &lt;<a class="el" href="time_8h-source.html">time.h</a>&gt;</code><br>
<code>#include &lt;sys/time.h&gt;</code><br>
<code>#include &lt;limits.h&gt;</code><br>
<code>#include &quot;<a class="el" href="lock_8h-source.html">asterisk/lock.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="cli_8h-source.html">asterisk/cli.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="pbx_8h-source.html">asterisk/pbx.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="channel_8h-source.html">asterisk/channel.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="options_8h-source.html">asterisk/options.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="logger_8h-source.html">asterisk/logger.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="file_8h-source.html">asterisk/file.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="callerid_8h-source.html">asterisk/callerid.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="cdr_8h-source.html">asterisk/cdr.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="config_8h-source.html">asterisk/config.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="term_8h-source.html">asterisk/term.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="manager_8h-source.html">asterisk/manager.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="ast__expr_8h-source.html">asterisk/ast_expr.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="linkedlists_8h-source.html">asterisk/linkedlists.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="say_8h-source.html">asterisk/say.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="utils_8h-source.html">asterisk/utils.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="causes_8h-source.html">asterisk/causes.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="musiconhold_8h-source.html">asterisk/musiconhold.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="app_8h-source.html">asterisk/app.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="devicestate_8h-source.html">asterisk/devicestate.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="stringfields_8h-source.html">asterisk/stringfields.h</a>&quot;</code><br>

<p>
<a href="pbx_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structapp__tmp.html">app_tmp</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__app.html">ast_app</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ast_app: A registered application  <a href="structast__app.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__context.html">ast_context</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ast_context: An extension context  <a href="structast__context.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__exten.html">ast_exten</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ast_exten: An extension The dialplan is saved as a linked list with each context having it's own linked list of extensions - one item per priority.  <a href="structast__exten.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__hint.html">ast_hint</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Structure for dial plan hints.  <a href="structast__hint.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__ignorepat.html">ast_ignorepat</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ast_ignorepat: Ignore patterns in dial plan  <a href="structast__ignorepat.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__include.html">ast_include</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ast_include: include= support in extensions.conf  <a href="structast__include.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__state__cb.html">ast_state_cb</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ast_state_cb: An extension state notify register item  <a href="structast__state__cb.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__sw.html">ast_sw</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ast_sw: Switch statement in extensions.conf  <a href="structast__sw.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structasync__stat.html">async_stat</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcfextension__states.html">cfextension_states</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdialplan__counters.html">dialplan_counters</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Counters for the show dialplan manager command.  <a href="structdialplan__counters.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpbx__builtin.html">pbx_builtin</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Declaration of builtin applications.  <a href="structpbx__builtin.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpbx__find__info.html">pbx_find_info</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstore__hint.html">store_hint</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#249ae5f11bddff7a9bda62683881685d">AST_PBX_MAX_STACK</a>&nbsp;&nbsp;&nbsp;128</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#a0215904ef3bd64698051c47911b09e8">BACKGROUND_MATCHEXTEN</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 2)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#c178c7499d370e08f7562414095a17fc">BACKGROUND_NOANSWER</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#f26f6fb0e3fec99d25e1193b93b50e7e">BACKGROUND_PLAYBACK</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 3)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#47b32a985ce6a66e0eec79f36b8e34db">BACKGROUND_SKIP</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#28f9e18bd04fd180975e7c0b090950a2">EXT_DATA_SIZE</a>&nbsp;&nbsp;&nbsp;8192</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#765461194756cf310d974e5e4d5c3de8">SAY_STUBS</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#04069b8c4c23b1436ecbd5daea064e7d">STATUS_NO_CONTEXT</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#1ed8706992a31b08f995af6dd5c78c39">STATUS_NO_EXTENSION</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#a614994b37f867365ca54ec3a75b7f1b">STATUS_NO_LABEL</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#92658abbaf41e9115ce5d413ccc7ee1d">STATUS_NO_PRIORITY</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#47768f6d3d56f8455845fb093ab0cf0e">STATUS_SUCCESS</a>&nbsp;&nbsp;&nbsp;5</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#27dc176701e9014e219fe586c4f546e5">SWITCH_DATA_LENGTH</a>&nbsp;&nbsp;&nbsp;256</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#970eeb66b59dcceec190d4d3147cb12f">VAR_BUF_SIZE</a>&nbsp;&nbsp;&nbsp;4096</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#9edf59ee06e97212a06f9b1cfd809a0d">VAR_HARDTRAN</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#2f935a5d3016e990bb3e97e810132d21">VAR_NORMAL</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#cc14ef5a8775ee40c7a3df88c7a2cc60">VAR_SOFTTRAN</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#6e4590710fad4ff778fdd12b9ee916d2">WAITEXTEN_MOH</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)</td></tr>

<tr><td colspan="2"><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe">ext_match_t</a> { <br>
&nbsp;&nbsp;<a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824febb13020eaa30c314c1bff110026a7cd2">E_MATCHMORE</a> =  0x00, 
<a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fee9684886238bd81a61f3358030326178">E_CANMATCH</a> =  0x01, 
<a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe437691af9bdd09d1ad4c2e5b087d5717">E_MATCH</a> =  0x02, 
<a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe548e6fa5f2ee06c5a9a3a193414cf29c">E_MATCH_MASK</a> =  0x03, 
<br>
&nbsp;&nbsp;<a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe216abbac78adc685e53502161a311679">E_SPAWN</a> =  0x12, 
<a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe1bb8d310644e3f6e2603d80f8464bdda">E_FINDLABEL</a> =  0x22
<br>
 }</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#04aa8a1856d1ec89ebff7bd112b037eb">__ast_context_create</a> (struct <a class="el" href="structast__context.html">ast_context</a> **extcontexts, const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>, int existsokay)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#e2faf43e79194dd93e6200a86f08d563">__ast_context_destroy</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#ea67e0eddc31f7145c5c9c7991255636">__ast_goto_if_exists</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority, int async)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#d6a76cc38fc49b50acb5368a81899555">__ast_pbx_run</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#db697281f06d30c766c4af8b5bf48199">_extension_match_core</a> (const char *pattern, const char *data, enum <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe">ext_match_t</a> mode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#2a729b6bbfa875032679e02260957526">add_pri</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, struct <a class="el" href="structast__exten.html">ast_exten</a> *tmp, struct <a class="el" href="structast__exten.html">ast_exten</a> *<a class="el" href="asterisk_8c.html#65c10911d8b8591219a21ebacf46da01">el</a>, struct <a class="el" href="structast__exten.html">ast_exten</a> *e, int replace)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">add the extension in the priority chain. returns 0 on success, -1 on failure  <a href="#2a729b6bbfa875032679e02260957526"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#12b93bee10e4fd5d30576d7a6877e12b">ast_active_calls</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve the number of active calls.  <a href="#12b93bee10e4fd5d30576d7a6877e12b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#b77a5344eb4a1e2404c81a2a593deff5">ast_add_extension</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, int replace, const char *extension, int priority, const char *label, const char *callerid, const char *application, void *data, void(*datad)(void *), const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add and extension to an extension context.  <a href="#b77a5344eb4a1e2404c81a2a593deff5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#0985a9a977ba8aa4f370da3a495437ae">ast_add_extension2</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, int replace, const char *extension, int priority, const char *label, const char *callerid, const char *application, void *data, void(*datad)(void *), const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add an extension to an extension context, this time with an <a class="el" href="structast__context.html">ast_context</a> *.  <a href="#0985a9a977ba8aa4f370da3a495437ae"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#b1882754d395928d10d8d94200dfffd1">ast_add_hint</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *e)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ast_add_hint: Add hint to hint list, check initial extension state  <a href="#b1882754d395928d10d8d94200dfffd1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#c9005802f33040d1cab7c4b3588b1b81">AST_APP_OPTIONS</a> (resetcdr_opts,{AST_APP_OPTION('w', AST_CDR_FLAG_POSTED), AST_APP_OPTION('a', AST_CDR_FLAG_LOCKED), AST_APP_OPTION('v', AST_CDR_FLAG_KEEP_VARS),})</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#4c54d9fbb24b1a0a21a2c66428923224">AST_APP_OPTIONS</a> (waitexten_opts,{AST_APP_OPTION_ARG('m', WAITEXTEN_MOH, 0),})</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#1436455fa6ff2a19f5bc8c20d6eab6c0">AST_APP_OPTIONS</a> (background_opts,{AST_APP_OPTION('s', BACKGROUND_SKIP), AST_APP_OPTION('n', BACKGROUND_NOANSWER), AST_APP_OPTION('m', BACKGROUND_MATCHEXTEN), AST_APP_OPTION('p', BACKGROUND_PLAYBACK),})</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#563b92a651459898f8ccfdc367746147">ast_async_goto</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#b1007dfd72dec414ba71a3e5e00cf524">ast_async_goto_by_name</a> (const char *channame, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#26ff43c7d96ccf5b00248d0793ce93f5">ast_async_goto_if_exists</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#b45b278cc04e70970e83433d6e9c60a8">ast_build_timing</a> (struct <a class="el" href="structast__timing.html">ast_timing</a> *i, const char *info_in)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#8cdcfc880eae31c1eaa91e154491b5bc">ast_canmatch_extension</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority, const char *callerid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Looks for a valid matching extension.  <a href="#8cdcfc880eae31c1eaa91e154491b5bc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#89778ddb1deedf256115e0110daf3e19">ast_change_hint</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *oe, struct <a class="el" href="structast__exten.html">ast_exten</a> *ne)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ast_change_hint: Change hint for an extension  <a href="#89778ddb1deedf256115e0110daf3e19"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#4dee27d639900ebea4f8b3c0366a197f">ast_check_timing</a> (const struct <a class="el" href="structast__timing.html">ast_timing</a> *i)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#00091c0d2706ab2a3132189402df5c48">ast_context_add_ignorepat</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *value, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add an ignorepat.  <a href="#00091c0d2706ab2a3132189402df5c48"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#8837e61e90b56e79023e89ddb6b26fb1">ast_context_add_ignorepat2</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, const char *value, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#ccdd98c0e8816634393437aad7cc5e01">ast_context_add_include</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *include, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a context include.  <a href="#ccdd98c0e8816634393437aad7cc5e01"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#b594e19215ace51bec1a5726a0801d07">ast_context_add_include2</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, const char *value, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a context include.  <a href="#b594e19215ace51bec1a5726a0801d07"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#afa734254246b0a5d03b045767bf645c">ast_context_add_switch</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *sw, const char *data, int eval, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a switch.  <a href="#afa734254246b0a5d03b045767bf645c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#6fae5ece5f5f729b48d4a8e0bd73b642">ast_context_add_switch2</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, const char *value, const char *data, int eval, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds a switch (first param is a <a class="el" href="structast__context.html">ast_context</a>).  <a href="#6fae5ece5f5f729b48d4a8e0bd73b642"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#9b7261abb02956903bb17c5bf8af265a">ast_context_create</a> (struct <a class="el" href="structast__context.html">ast_context</a> **extcontexts, const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Register a new context.  <a href="#9b7261abb02956903bb17c5bf8af265a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#ac0d672d0448b82e3b3eac25b400d4d2">ast_context_destroy</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destroy a context (matches the specified context (or ANY context if NULL).  <a href="#ac0d672d0448b82e3b3eac25b400d4d2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#f8c5b4e7d06b7aff72707b5d7d7c94e1">ast_context_find</a> (const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find a context.  <a href="#f8c5b4e7d06b7aff72707b5d7d7c94e1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#773dc5d298a6de227dfddae824e996d7">ast_context_find_or_create</a> (struct <a class="el" href="structast__context.html">ast_context</a> **extcontexts, const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Register a new context or find an existing one.  <a href="#773dc5d298a6de227dfddae824e996d7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#cf90385c0515753c76020cd48fe98c05">ast_context_lockmacro</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">locks the macrolock in the given given context  <a href="#cf90385c0515753c76020cd48fe98c05"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#ed70bf6c908a1c70415454997c0d7902">ast_context_remove_extension</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *extension, int priority, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Simply remove extension from context.  <a href="#ed70bf6c908a1c70415454997c0d7902"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#c1d85c0d2ff75a7c476fa8379affd931">ast_context_remove_extension2</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, const char *extension, int priority, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This functionc locks given context, search for the right extension and fires out all peer in this extensions with given priority. If priority is set to 0, all peers are removed. After that, unlock context and return.  <a href="#c1d85c0d2ff75a7c476fa8379affd931"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#041875d3b92a3d0f748b8a0203e042a0">ast_context_remove_ignorepat</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *ignorepat, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#ad389cee2e8dda09b52d35340ddd294b">ast_context_remove_ignorepat2</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, const char *ignorepat, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#4318ec7b57c8064d746a1a395b5459bb">ast_context_remove_include</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *include, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove a context include.  <a href="#4318ec7b57c8064d746a1a395b5459bb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#c9afd67fae6ebbdc4e991024f69cff82">ast_context_remove_include2</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, const char *include, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Removes an include by an <a class="el" href="structast__context.html">ast_context</a> structure.  <a href="#c9afd67fae6ebbdc4e991024f69cff82"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#2db384d8d5d6a3155584ba62248a466a">ast_context_remove_switch</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *sw, const char *data, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove a switch.  <a href="#2db384d8d5d6a3155584ba62248a466a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#70c9b3efb9b5ad9ac26580cc90536fff">ast_context_remove_switch2</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, const char *sw, const char *data, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function locks given context, removes switch, unlock context and return.  <a href="#70c9b3efb9b5ad9ac26580cc90536fff"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#577525a2317386a87ee26f89c0bd3cdc">ast_context_unlockmacro</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unlocks the macrolock in the given context.  <a href="#577525a2317386a87ee26f89c0bd3cdc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#d08532bf153875f677d2d3c59b13397f">ast_context_verify_includes</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Verifies includes in an ast_contect structure.  <a href="#d08532bf153875f677d2d3c59b13397f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__custom__function.html">ast_custom_function</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#2f6033daa3dd2a6a51ee380a86a783ba">ast_custom_function_find</a> (const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#93b5bf1865d6f3290372ca5ee3274391">ast_custom_function_register</a> (struct <a class="el" href="structast__custom__function.html">ast_custom_function</a> *acf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reigster a custom function.  <a href="#93b5bf1865d6f3290372ca5ee3274391"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#cfc1bbe0fad0bcf852611eaee79b2d03">ast_custom_function_unregister</a> (struct <a class="el" href="structast__custom__function.html">ast_custom_function</a> *acf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unregister a custom function.  <a href="#cfc1bbe0fad0bcf852611eaee79b2d03"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#90b58be34145fcfd99652f0c3ae7377d">ast_exists_extension</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority, const char *callerid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Determine whether an extension exists.  <a href="#90b58be34145fcfd99652f0c3ae7377d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#1e0079c7f2934dd7ebe801fefe4057da">ast_explicit_goto</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#a82c6deae96c20bc56e29d921d6e036f">ast_extension_close</a> (const char *pattern, const char *data, int needmore)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#fee4ebd3f1d86114fe9bb33931f9a6cf">ast_extension_match</a> (const char *pattern, const char *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Determine if a given extension matches a given pattern (in NXX format).  <a href="#fee4ebd3f1d86114fe9bb33931f9a6cf"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#16769dc669e528ae10a063594fb7f4ae">ast_extension_state</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Uses hint and devicestate callback to get the state of an extension.  <a href="#16769dc669e528ae10a063594fb7f4ae"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#6aecfed8ee63e22940bc2d842f0a536c">ast_extension_state2</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *e)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ast_extensions_state2: Check state of extension by using hints  <a href="#6aecfed8ee63e22940bc2d842f0a536c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#c4e2c1f2a0862db3fb3faa3d5dd9350c">ast_extension_state2str</a> (int extension_state)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return string representation of the state of an extension.  <a href="#c4e2c1f2a0862db3fb3faa3d5dd9350c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#14f63100164300fc4b55b09d6c3474fd">ast_extension_state_add</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="el" href="pbx_8h.html#a083658b5411c328227915675531df43">ast_state_cb_type</a> callback, void *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Registers a state change callback.  <a href="#14f63100164300fc4b55b09d6c3474fd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#2eee51fa21b14e53302712d806421fbb">ast_extension_state_del</a> (int <a class="el" href="app__queue_8c.html#b80bb7740288fda1f201890375a60c8f">id</a>, <a class="el" href="pbx_8h.html#a083658b5411c328227915675531df43">ast_state_cb_type</a> callback)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deletes a registered state change callback by ID.  <a href="#2eee51fa21b14e53302712d806421fbb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#6f1b63f69b489517c49ccfecdbe1642e">ast_findlabel_extension</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, const char *label, const char *callerid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find the priority of an extension that has the specified label.  <a href="#6f1b63f69b489517c49ccfecdbe1642e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#7139f616e9b477dc630ba7cec0c22df4">ast_findlabel_extension2</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, struct <a class="el" href="structast__context.html">ast_context</a> *con, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, const char *label, const char *callerid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find the priority of an extension that has the specified label.  <a href="#7139f616e9b477dc630ba7cec0c22df4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#fc067f1890b3fdeeacbc538e92a39fbd">ast_func_read</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *function, char *workspace, size_t len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">executes a read operation on a function  <a href="#fc067f1890b3fdeeacbc538e92a39fbd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#2432c0e88181cb3ba2c1a2764b0a6238">ast_func_write</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *function, const char *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">executes a write operation on a function  <a href="#2432c0e88181cb3ba2c1a2764b0a6238"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#76308d8bcceb0331e0d4736df41b1412">ast_get_context_registrar</a> (struct <a class="el" href="structast__context.html">ast_context</a> *c)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#c8eaa4fc248390fee258e7d2b2ff3490">ast_get_extension_app</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *e)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#4a723bd9d782fe0a3fb16d00268ec5a4">ast_get_extension_app_data</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *e)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#05032ac07f5935587193e7da044e30de">ast_get_extension_cidmatch</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *e)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#61636cd55acce8616de92323b8a427b9">ast_get_extension_context</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#6647bb905ee41ab599c1e9bfe5f086de">ast_get_extension_label</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#8c7f1a8dd6fbdb6df987ac164ef7fdfc">ast_get_extension_matchcid</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *e)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#4318ec15d92ac47de94902f6aba4c114">ast_get_extension_name</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#ecebedf381a09dd2630dc03e49b83112">ast_get_extension_priority</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#20537e2517918a112d0b738d8c70cae2">ast_get_extension_registrar</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *e)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#b654f3264742a57f212c38761672a6c0">ast_get_hint</a> (char *hint, int hintsize, char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, int namesize, struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">If an extension hint exists, return non-zero.  <a href="#b654f3264742a57f212c38761672a6c0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#8362b5fbecbf06d68596f1361a817971">ast_get_ignorepat_name</a> (struct <a class="el" href="structast__ignorepat.html">ast_ignorepat</a> *ip)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#ecf759381e5bb2d13dbf2188d6728217">ast_get_ignorepat_registrar</a> (struct <a class="el" href="structast__ignorepat.html">ast_ignorepat</a> *ip)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#04500f482fe3f27ee84f53c832f49c92">ast_get_include_name</a> (struct <a class="el" href="structast__include.html">ast_include</a> *inc)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#a10e2a34982bf1e3c4df8fbf94a8f858">ast_get_include_registrar</a> (struct <a class="el" href="structast__include.html">ast_include</a> *i)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#ee960249076eea022f3aaa855b0a2475">ast_get_switch_data</a> (struct <a class="el" href="structast__sw.html">ast_sw</a> *sw)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#e78e1da5bf7f86cd550128a0cc440658">ast_get_switch_name</a> (struct <a class="el" href="structast__sw.html">ast_sw</a> *sw)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#6e9fbaaa189820f4a0c36a1ad4dfca6d">ast_get_switch_registrar</a> (struct <a class="el" href="structast__sw.html">ast_sw</a> *sw)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#66e271b78f5b09452a521e220c223e1e">ast_goto_if_exists</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#a4691f6ae9689498c10c695381f36103">ast_hint_extension</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ast_hint_extension: Find hint for given extension in context  <a href="#a4691f6ae9689498c10c695381f36103"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#5bc7455c31be4c32a90e55a101009fdf">ast_hint_state_changed</a> (const char *device)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#3c8a7255ea36a7270c24fd5ccccc56f6">ast_ignore_pattern</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *pattern)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Checks to see if a number should be ignored.  <a href="#3c8a7255ea36a7270c24fd5ccccc56f6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#16620a4fec6f26db370f97db3c778b05">AST_LIST_HEAD</a> (store_hints, <a class="el" href="structstore__hint.html">store_hint</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#6e9c6f3a112b82510968f729fa3765bc">ast_matchmore_extension</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority, const char *callerid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Looks to see if adding anything to this extension might match something. (exists ^ canmatch).  <a href="#6e9c6f3a112b82510968f729fa3765bc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#6a86443aa2d56a55b117b3f985565bcb">ast_merge_contexts_and_delete</a> (struct <a class="el" href="structast__context.html">ast_context</a> **extcontexts, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Merge the temporary contexts into a global contexts list and delete from the global list the ones that are being added.  <a href="#6a86443aa2d56a55b117b3f985565bcb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#ac3097f3dd8ef4fb7e1468f589b42c57">AST_MUTEX_DEFINE_STATIC</a> (maxcalllock)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#86eba1ec3178373f61c082e1f1f12b68">ast_parseable_goto</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *goto_string)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#8bd05d7cdf218eaecfb4a33dd0eb32d8">ast_pbx_outgoing_app</a> (const char *<a class="el" href="chan__nbs_8c.html#a73364531569a868150462e5a44f29c8">type</a>, int <a class="el" href="cdr__custom_8c.html#b954976e6264c40232046aacb5b7c390">format</a>, void *data, int timeout, const char *<a class="el" href="res__agi_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>, const char *appdata, int *reason, int sync, const char *<a class="el" href="chan__skinny_8c.html#ca3c0eb6b6e898f3a32aed5de1320774">cid_num</a>, const char *<a class="el" href="chan__skinny_8c.html#70f178a59d8df82fe5e107da71415b9b">cid_name</a>, struct <a class="el" href="structast__variable.html">ast_variable</a> *vars, const char *account, struct <a class="el" href="structast__channel.html">ast_channel</a> **locked_channel)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#09a9b482db62db9b75905bfad1c77ef1">ast_pbx_outgoing_cdr_failed</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#1b1911a618935b371e69b60c66cf6221">ast_pbx_outgoing_exten</a> (const char *<a class="el" href="chan__nbs_8c.html#a73364531569a868150462e5a44f29c8">type</a>, int <a class="el" href="cdr__custom_8c.html#b954976e6264c40232046aacb5b7c390">format</a>, void *data, int timeout, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority, int *reason, int sync, const char *<a class="el" href="chan__skinny_8c.html#ca3c0eb6b6e898f3a32aed5de1320774">cid_num</a>, const char *<a class="el" href="chan__skinny_8c.html#70f178a59d8df82fe5e107da71415b9b">cid_name</a>, struct <a class="el" href="structast__variable.html">ast_variable</a> *vars, const char *account, struct <a class="el" href="structast__channel.html">ast_channel</a> **channel)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">enum <a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912">ast_pbx_result</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#235c18a381a9501a4dc41b06b080c24f">ast_pbx_run</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Execute the PBX in the current thread.  <a href="#235c18a381a9501a4dc41b06b080c24f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#38fb34f5a491b6b51279535ef9ba6620">ast_pbx_run_app</a> (void *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">run the application and free the descriptor once done  <a href="#38fb34f5a491b6b51279535ef9ba6620"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum <a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912">ast_pbx_result</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#c55e82ff3dabed89efd77f20209b1006">ast_pbx_start</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a new thread and start the PBX.  <a href="#c55e82ff3dabed89efd77f20209b1006"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#a09f0d0ac316a1ae5c74d6958d2b913e">ast_rdlock_context</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read locks a given context.  <a href="#a09f0d0ac316a1ae5c74d6958d2b913e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#1b60f4b570102084989c86fd02ca6536">ast_rdlock_contexts</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read locks the context list.  <a href="#1b60f4b570102084989c86fd02ca6536"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#f8e9b339fed38c405332f222cceeec40">ast_register_application</a> (const char *<a class="el" href="res__agi_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>, int(*execute)(struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *), const char *<a class="el" href="res__features_8c.html#512fbb4e7b617c04031f58b631f2b05d">synopsis</a>, const char *description)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Register an application.  <a href="#f8e9b339fed38c405332f222cceeec40"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#ce9b1b9b9951df409f13e9c6c9a94d71">ast_register_switch</a> (struct <a class="el" href="structast__switch.html">ast_switch</a> *sw)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Register an alternative dialplan switch.  <a href="#ce9b1b9b9951df409f13e9c6c9a94d71"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#1b7cfd3851ae1fbfaf60fef51c4756f2">ast_remove_hint</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *e)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ast_remove_hint: Remove hint from extension  <a href="#1b7cfd3851ae1fbfaf60fef51c4756f2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#027c81114f7c33b0761f8738aa848686">AST_RWLIST_HEAD_STATIC</a> (hints, <a class="el" href="structast__hint.html">ast_hint</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#1514e136859b9d9743a2e119aa0a338a">AST_RWLIST_HEAD_STATIC</a> (switches, <a class="el" href="structast__switch.html">ast_switch</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#5d937a850fe80d246dbb85200c152a2f">AST_RWLIST_HEAD_STATIC</a> (apps, <a class="el" href="structast__app.html">ast_app</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#c0487194302197a978dc0c1f7f0abfb5">AST_RWLIST_HEAD_STATIC</a> (acf_root, <a class="el" href="structast__custom__function.html">ast_custom_function</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#1d2c53e09ab41536a967ee69814e3c87">AST_RWLOCK_DEFINE_STATIC</a> (conlock)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#03bd27a9311428cc3704f560c5c5f623">AST_RWLOCK_DEFINE_STATIC</a> (globalslock)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#63a99eec1b6004791bd2013ad855eea8">ast_spawn_extension</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority, const char *callerid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Launch a new extension (i.e. new stack).  <a href="#63a99eec1b6004791bd2013ad855eea8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unlocks contexts.  <a href="#dc1d3ecafa5a93767dd4ed321ed91d10"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#4fc9ac8a7093a1f73637df0b9d6d6de9">ast_unregister_application</a> (const char *<a class="el" href="res__agi_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unregister an application.  <a href="#4fc9ac8a7093a1f73637df0b9d6d6de9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#dfce547713eae00cf11fd0b876adb7f7">ast_unregister_switch</a> (struct <a class="el" href="structast__switch.html">ast_switch</a> *sw)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unregister an alternative switch.  <a href="#dfce547713eae00cf11fd0b876adb7f7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#b3b7bf8e22da60a0df718a52f3424b79">ast_walk_context_extensions</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, struct <a class="el" href="structast__exten.html">ast_exten</a> *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__ignorepat.html">ast_ignorepat</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#78f92771f39acc0696f7d12053ff4304">ast_walk_context_ignorepats</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, struct <a class="el" href="structast__ignorepat.html">ast_ignorepat</a> *ip)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__include.html">ast_include</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#ff52371424397442d32568beb910e153">ast_walk_context_includes</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, struct <a class="el" href="structast__include.html">ast_include</a> *inc)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__sw.html">ast_sw</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#6cbdae284c7bcff5b16d687a1f60b61b">ast_walk_context_switches</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, struct <a class="el" href="structast__sw.html">ast_sw</a> *sw)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#709c9b64f2da1eaace237db32a5e1445">ast_walk_contexts</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#2ae60ad33dfd510584655331ac42b890">ast_walk_extension_priorities</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, struct <a class="el" href="structast__exten.html">ast_exten</a> *priority)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#18884df37a7c36a24fd0b5f4225d1112">ast_wrlock_context</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write locks a given context.  <a href="#18884df37a7c36a24fd0b5f4225d1112"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#6f41efd0c2fa84486ef11fef33681139">ast_wrlock_contexts</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write locks the context list.  <a href="#6f41efd0c2fa84486ef11fef33681139"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#23af98d69a15a8250c44aaea18d487af">async_wait</a> (void *data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#56ac9c8dffe6fb673e5c26f2b706777b">collect_digits</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, int waittime, char *<a class="el" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>, int buflen, int pos)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">collect digits from the channel into the buffer, return -1 on error, 0 on timeout or done.  <a href="#56ac9c8dffe6fb673e5c26f2b706777b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#54f047831976b704c2fe17e388f6e79e">complete_show_application</a> (const char *<a class="el" href="manager_8h.html#6438c669e0d0de98e6929c2cc0fac474">line</a>, const char *word, int pos, int <a class="el" href="structstate.html">state</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#4a465aef0f262af46a537ff2d1966732">complete_show_applications</a> (const char *<a class="el" href="manager_8h.html#6438c669e0d0de98e6929c2cc0fac474">line</a>, const char *word, int pos, int <a class="el" href="structstate.html">state</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#6c63ff167234692e52eaa6d19856317c">complete_show_dialplan_context</a> (const char *<a class="el" href="manager_8h.html#6438c669e0d0de98e6929c2cc0fac474">line</a>, const char *word, int pos, int <a class="el" href="structstate.html">state</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#06132b1a307c8696f30585c776f764f5">complete_show_function</a> (const char *<a class="el" href="manager_8h.html#6438c669e0d0de98e6929c2cc0fac474">line</a>, const char *word, int pos, int <a class="el" href="structstate.html">state</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#2cf1332e5b45c96d7508015a47e21b84">decrease_call_count</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#c7a22bae87915c24108c7304264b78c8">destroy_exten</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *e)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#fa125f786a7a85619f88c85292d5412f">ext_cmp</a> (const char *a, const char *b)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">the full routine to compare extensions in rules.  <a href="#fa125f786a7a85619f88c85292d5412f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#48c405f7522d6b169f7e80c09f2acdb5">ext_cmp1</a> (const char **p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">helper functions to sort extensions and patterns in the desired way, so that more specific patterns appear first.  <a href="#48c405f7522d6b169f7e80c09f2acdb5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#34cd75f9b635d6fb74649e8e456dcef9">ext_strncpy</a> (char *dst, const char *src, int len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">copy a string skipping whitespace  <a href="#34cd75f9b635d6fb74649e8e456dcef9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#489ae231aa1cc1031dcfd0adc1cc4600">extension_match_core</a> (const char *pattern, const char *data, enum <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe">ext_match_t</a> mode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#4669bd753e060c6bb15a0c63c4e3785a">find_context_locked</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#3d2c812ce63291930182ea8c9edb17b8">func_args</a> (char *function)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">return a pointer to the arguments of the function, and terminates the function name with '\0'  <a href="#3d2c812ce63291930182ea8c9edb17b8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#1d96b045db44a1d8881f22cd211d4099">get_range</a> (char *src, int max, char *const names[], const char *<a class="el" href="adsistub_8c.html#6e2baaf3b97dbeef01c0043275f9a0e7">msg</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">helper function to return a range up to max (7, 12, 31 respectively). names, if supplied, is an array of names that should be mapped to numbers.  <a href="#1d96b045db44a1d8881f22cd211d4099"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#997d3ca719932cc6dbf54c26337a0b3c">get_timerange</a> (struct <a class="el" href="structast__timing.html">ast_timing</a> *i, char *times)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">store a bitmask of valid times, one bit each 2 minute  <a href="#997d3ca719932cc6dbf54c26337a0b3c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#5272725c34363168c9deab9dd6640200">handle_set_global</a> (int fd, int argc, char *argv[])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#6f8de0cd01e797a4fb1d35fe54b4d76e">handle_show_application</a> (int fd, int argc, char *argv[])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#6a58cc0389a0a88bf6b4d1507cbe43ee">handle_show_applications</a> (int fd, int argc, char *argv[])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#bdad08d2759df1713bf4c15b39be4893">handle_show_dialplan</a> (int fd, int argc, char *argv[])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#524ad80b6c4f0d68e6552e45cf4a18ba">handle_show_function</a> (int fd, int argc, char *argv[])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#4777aaf3739c0e3a6979ebb5e9eb221d">handle_show_functions</a> (int fd, int argc, char *argv[])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#23311d60c2977067b7a13a76e575116f">handle_show_globals</a> (int fd, int argc, char *argv[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">CLI support for listing global variables in a parseable way.  <a href="#23311d60c2977067b7a13a76e575116f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#373673c4f54bbeb1b4e6f3e02a1b1206">handle_show_hints</a> (int fd, int argc, char *argv[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">handle_show_hints: CLI support for listing registered dial plan hints  <a href="#373673c4f54bbeb1b4e6f3e02a1b1206"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#b34567b1f69cf39a5506464a4d407346">handle_show_switches</a> (int fd, int argc, char *argv[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">handle_show_switches: CLI support for listing registered dial plan switches  <a href="#b34567b1f69cf39a5506464a4d407346"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#355ea768230f2ab2299d8eea050b674c">include_valid</a> (struct <a class="el" href="structast__include.html">ast_include</a> *i)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#98ddc357b5ac13bfaa71167740ecc75a">increase_call_count</a> (const struct <a class="el" href="structast__channel.html">ast_channel</a> *c)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#1123cfede7379bd2813e1b4306327c10">load_pbx</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#37c96c5787cdf4375b2e683139ce9a87">lookup_name</a> (const char *s, char *const names[], int max)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Helper for get_range. return the index of the matching entry, starting from 1. If names is not supplied, try numeric values.  <a href="#37c96c5787cdf4375b2e683139ce9a87"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#5d6b6ee3b52cfcfe8a3a6d88564dc768">manager_dpsendack</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send ack once.  <a href="#5d6b6ee3b52cfcfe8a3a6d88564dc768"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#f6b8ea6835408c7f6c5a42d5a7502c03">manager_show_dialplan</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Manager listing of dial plan.  <a href="#f6b8ea6835408c7f6c5a42d5a7502c03"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#1c7815f40dc8d76231a9aaa789b60de0">manager_show_dialplan_helper</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m, const char *actionidtext, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, struct <a class="el" href="structdialplan__counters.html">dialplan_counters</a> *dpc, struct <a class="el" href="structast__include.html">ast_include</a> *rinclude)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Show dialplan extensions XXX this function is similar but not exactly the same as the CLI's show dialplan. Must check whether the difference is intentional or not.  <a href="#1c7815f40dc8d76231a9aaa789b60de0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#fba0369f208e3a6a1ae37ed883985304">matchcid</a> (const char *cidpattern, const char *callerid)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#1f596dad2120f1ef7d9cceea084686cc">parse_variable_name</a> (char *var, int *<a class="el" href="chan__alsa_8c.html#7a86c157ee9713c34fbd7a1ee40f0c5a">offset</a>, int *length, int *isfunc)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">extract offset:length from variable name. Returns 1 if there is a offset:length part, which is trimmed off (values go into variables)  <a href="#1f596dad2120f1ef7d9cceea084686cc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#g9e8b90360b71c32339740438dadbc9b7">pbx_builtin_answer</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#gd4c3c76462c301612abf961fb2610a87">pbx_builtin_background</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#g8224c9f80e837c7f2f815ddd5b18aee6">pbx_builtin_busy</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#70b34943ce7b4a596f724e9d2e5463f6">pbx_builtin_clear_globals</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#gba7a6211f869def5ad321c8c89825e82">pbx_builtin_congestion</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#ga8b2a99ff270289f2f4bd7b800d945bc">pbx_builtin_execiftime</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#944d18aa90701f025b30e63d9644e448">pbx_builtin_getvar_helper</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#g810e6cb9f297016b6c6e22171fba4458">pbx_builtin_goto</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#f817fed49da112575f6b5e0c39a386fc">pbx_builtin_gotoif</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#ga7c5739e43ec98bbb1df5e22a3d9fcda">pbx_builtin_gotoiftime</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#g048e8de501777ba14f7528f09d4cc9aa">pbx_builtin_hangup</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#9072e12e84cb5f0e0377791e417a6ee6">pbx_builtin_importvar</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#63e6b36cd0848b527b0f14db5dd8d3e4">pbx_builtin_noop</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#ge86c7e57c3acc2b6caee0443da456f95">pbx_builtin_progress</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#314bde51a938aa39daab1c3379eed3c7">pbx_builtin_pushvar_helper</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, const char *value)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#gabae899e725428c8520f8c9dea9dc5fd">pbx_builtin_resetcdr</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#gbff0064869864e134fce7646a4c60c41">pbx_builtin_ringing</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#3e3753e8824cad0efc44f031897f3bae">pbx_builtin_saycharacters</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#f76465f331191d8cea145d9882cad42b">pbx_builtin_saydigits</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#eb3b4ee4e253d22d78e69093838bbb6f">pbx_builtin_saynumber</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#d8962c3a5e8b928f83bbe27e1af89433">pbx_builtin_sayphonetic</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#54b5d868be87581f886aee1b5fed126a">pbx_builtin_serialize_variables</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, struct <a class="el" href="structast__str.html">ast_str</a> **<a class="el" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#gbe127431377bef549315ff7f89087767">pbx_builtin_setamaflags</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#1fd124882bb88b58dd9474ac0c5f6c4e">pbx_builtin_setvar</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#64407c916a2de6ae3f0efeca471c1b1d">pbx_builtin_setvar_helper</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, const char *value)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#gdee0c48cbf7f9525689d12c23452752c">pbx_builtin_wait</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__applications.html#g15e89afaf5b7b1ccfc3ffe71892508ef">pbx_builtin_waitexten</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#356fc557c1fe7c36e2773ba403e7625a">pbx_checkcondition</a> (const char *condition)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Evaluate a condition.  <a href="#356fc557c1fe7c36e2773ba403e7625a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#3f3f421aab3b84db6bcebc624d6c1426">pbx_destroy</a> (struct <a class="el" href="structast__pbx.html">ast_pbx</a> *p)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#5970fbcb6a776848d11bf1c8ddb1c948">pbx_exec</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, struct <a class="el" href="structast__app.html">ast_app</a> *<a class="el" href="res__agi_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>, void *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Execute an application.  <a href="#5970fbcb6a776848d11bf1c8ddb1c948"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#2377c7b979811bdd54ebf819e5d2037b">pbx_extension_helper</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, struct <a class="el" href="structast__context.html">ast_context</a> *con, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority, const char *label, const char *callerid, enum <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe">ext_match_t</a> action)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The return value depends on the action:.  <a href="#2377c7b979811bdd54ebf819e5d2037b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#b3ba8b98731731a7e47467140cc6a6a3">pbx_find_extension</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, struct <a class="el" href="structast__context.html">ast_context</a> *bypass, struct <a class="el" href="structpbx__find__info.html">pbx_find_info</a> *q, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority, const char *label, const char *callerid, enum <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe">ext_match_t</a> action)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__app.html">ast_app</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#d407cf204ec8fc50e5a578c8c17e0cb5">pbx_findapp</a> (const char *<a class="el" href="res__agi_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Look up an application.  <a href="#d407cf204ec8fc50e5a578c8c17e0cb5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct <a class="el" href="structast__switch.html">ast_switch</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#877982a93293a50800c723f2d6a076b8">pbx_findswitch</a> (const char *sw)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#2753b759766c3d305e2551f63e403677">pbx_retrieve_variable</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *var, char **ret, char *workspace, int workspacelen, struct varshead *headp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Support for Asterisk built-in variables in the dialplan.  <a href="#2753b759766c3d305e2551f63e403677"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#ea7c4ebeb23de4a6efa64ef901058db6">pbx_set_autofallthrough</a> (int newval)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#120f5033eea8bea86259e519eefbbfe2">pbx_substitute_variables</a> (char *passdata, int datalen, struct <a class="el" href="structast__channel.html">ast_channel</a> *c, struct <a class="el" href="structast__exten.html">ast_exten</a> *e)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#7f62e5d5f926a2eeedb559b6afd3d80a">pbx_substitute_variables_helper</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *cp1, char *cp2, int count)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#8055099d4774142bb312da4f1e35be1e">pbx_substitute_variables_helper_full</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, struct varshead *headp, const char *cp1, char *cp2, int count)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#9c87adf1e75b8a9298ffc59378531172">pbx_substitute_variables_varshead</a> (struct varshead *headp, const char *cp1, char *cp2, int count)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#b3150b6a7a36bf2a840a8d53b01a36c9">pbx_thread</a> (void *data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#cadc5d14cfbc397e43547db54a585a56">print_ext</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *e, char *<a class="el" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>, int buflen)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">helper function to print an extension  <a href="#cadc5d14cfbc397e43547db54a585a56"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#09e258d284c6e074e06ec6e73fb5886e">set_ext_pri</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int pri)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#493e8914a452df695fe1e0ac69d6aca3">show_dialplan_helper</a> (int fd, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, struct <a class="el" href="structdialplan__counters.html">dialplan_counters</a> *dpc, struct <a class="el" href="structast__include.html">ast_include</a> *rinclude, int includecount, const char *includes[])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#04e7768e5fe29c8e12f2f22671d1b63d">substring</a> (const char *value, int <a class="el" href="chan__alsa_8c.html#7a86c157ee9713c34fbd7a1ee40f0c5a">offset</a>, int length, char *workspace, size_t workspace_len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">takes a substring. It is ok to call with value == workspace.  <a href="#04e7768e5fe29c8e12f2f22671d1b63d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#de5c3078bd604949446521990a001661">unreference_cached_app</a> (struct <a class="el" href="structast__app.html">ast_app</a> *<a class="el" href="res__agi_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#b69d22624170b4f0d028586dceca5c98">wait_for_hangup</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, void *data)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#509cd842fa6ca4f1b6be7d908dbedf09">autofallthrough</a> = 1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct <a class="el" href="structpbx__builtin.html">pbx_builtin</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#7b94c2c41ed9fd600b9a19bb54467397">builtins</a> []</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Declaration of builtin applications.  <a href="#7b94c2c41ed9fd600b9a19bb54467397"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#9be90dc64c1f5b5c993ff11d732a8da0">contexts</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#a3a9f90f51c55c02ddf6ad8e26249341">countcalls</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#b926d07cd15d8fd1bdf2ab377f30ee25">days</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const struct <a class="el" href="structcfextension__states.html">cfextension_states</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#63938e196e95ba3f1d098ec3884aca3a">extension_states</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct varshead&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a> = AST_LIST_HEAD_NOLOCK_INIT_VALUE</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#120b7e9b0d3b3902740d7fa84fc826e0">mandescr_show_dialplan</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#aab8c6e8889bb80d928fd716f4406fe7">months</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#886f64036bf3be08de3c6f7561b0a8a9">pbx_cli</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#586c6f775ee412d509eb3cb70d6eac05">set_global_help</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#a728f41d27e67a35e149551889efef83">show_application_help</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#acb375c2b811bbaa2cdf4f1f2e22a3f8">show_applications_help</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#caed5cd8779909df29243c5312745a93">show_dialplan_help</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#aebbde3b9bb1f2fec03df913f71462d4">show_function_help</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#8c2e1c611eb7455205f1841d4c163736">show_functions_help</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#ae50456a8bbe9c4f57a1ce1619aa8843">show_globals_help</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#d2211cce31f9bfb73227bcf61c8c6d45">show_hints_help</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#a01f140e49f6f8007121696c6036365a">show_switches_help</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__state__cb.html">ast_state_cb</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#3b088b468374b928f6ab90bfe5db48bf">statecbs</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8c.html#2749ddcba583cf049c6034826528c0a4">stateid</a> = 1</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Core PBX routines. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Mark Spencer &lt;<a href="mailto:markster@digium.com">markster@digium.com</a>&gt; </dd></dl>

<p>
Definition in file <a class="el" href="pbx_8c-source.html">pbx.c</a>.<hr><h2>Define Documentation</h2>
<a class="anchor" name="249ae5f11bddff7a9bda62683881685d"></a><!-- doxytag: member="pbx.c::AST_PBX_MAX_STACK" ref="249ae5f11bddff7a9bda62683881685d" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_PBX_MAX_STACK&nbsp;&nbsp;&nbsp;128          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Go no deeper than this through includes (not counting loops) 
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00543">543</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03480">handle_show_dialplan()</a>, <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0215904ef3bd64698051c47911b09e8"></a><!-- doxytag: member="pbx.c::BACKGROUND_MATCHEXTEN" ref="a0215904ef3bd64698051c47911b09e8" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define BACKGROUND_MATCHEXTEN&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 2)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00093">93</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l05642">pbx_builtin_background()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="c178c7499d370e08f7562414095a17fc"></a><!-- doxytag: member="pbx.c::BACKGROUND_NOANSWER" ref="c178c7499d370e08f7562414095a17fc" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define BACKGROUND_NOANSWER&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 1)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00092">92</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l05642">pbx_builtin_background()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="f26f6fb0e3fec99d25e1193b93b50e7e"></a><!-- doxytag: member="pbx.c::BACKGROUND_PLAYBACK" ref="f26f6fb0e3fec99d25e1193b93b50e7e" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define BACKGROUND_PLAYBACK&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 3)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00094">94</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l05642">pbx_builtin_background()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="47b32a985ce6a66e0eec79f36b8e34db"></a><!-- doxytag: member="pbx.c::BACKGROUND_SKIP" ref="47b32a985ce6a66e0eec79f36b8e34db" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define BACKGROUND_SKIP&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00091">91</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l05642">pbx_builtin_background()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="28f9e18bd04fd180975e7c0b090950a2"></a><!-- doxytag: member="pbx.c::EXT_DATA_SIZE" ref="28f9e18bd04fd180975e7c0b090950a2" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define EXT_DATA_SIZE&nbsp;&nbsp;&nbsp;8192          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Note:</b></dt><dd>I M P O R T A N T :</dd></dl>
The speed of extension handling will likely be among the most important aspects of this PBX. The switching scheme as it exists right now isn't terribly bad (it's O(N+M), where N is the # of extensions and M is the avg # of priorities, but a constant search time here would be great ;-) 
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00080">80</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>, and <a class="el" href="pbx__realtime_8c-source.html#l00174">realtime_exec()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="765461194756cf310d974e5e4d5c3de8"></a><!-- doxytag: member="pbx.c::SAY_STUBS" ref="765461194756cf310d974e5e4d5c3de8" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define SAY_STUBS          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00058">58</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="04069b8c4c23b1436ecbd5daea064e7d"></a><!-- doxytag: member="pbx.c::STATUS_NO_CONTEXT" ref="04069b8c4c23b1436ecbd5daea064e7d" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define STATUS_NO_CONTEXT&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00901">901</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>, and <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="1ed8706992a31b08f995af6dd5c78c39"></a><!-- doxytag: member="pbx.c::STATUS_NO_EXTENSION" ref="1ed8706992a31b08f995af6dd5c78c39" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define STATUS_NO_EXTENSION&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00902">902</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>, and <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a614994b37f867365ca54ec3a75b7f1b"></a><!-- doxytag: member="pbx.c::STATUS_NO_LABEL" ref="a614994b37f867365ca54ec3a75b7f1b" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define STATUS_NO_LABEL&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00904">904</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>, and <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="92658abbaf41e9115ce5d413ccc7ee1d"></a><!-- doxytag: member="pbx.c::STATUS_NO_PRIORITY" ref="92658abbaf41e9115ce5d413ccc7ee1d" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define STATUS_NO_PRIORITY&nbsp;&nbsp;&nbsp;3          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00903">903</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>, and <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="47768f6d3d56f8455845fb093ab0cf0e"></a><!-- doxytag: member="pbx.c::STATUS_SUCCESS" ref="47768f6d3d56f8455845fb093ab0cf0e" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define STATUS_SUCCESS&nbsp;&nbsp;&nbsp;5          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00905">905</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="27dc176701e9014e219fe586c4f546e5"></a><!-- doxytag: member="pbx.c::SWITCH_DATA_LENGTH" ref="27dc176701e9014e219fe586c4f546e5" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define SWITCH_DATA_LENGTH&nbsp;&nbsp;&nbsp;256          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00083">83</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04386">ast_context_add_switch2()</a>, and <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="970eeb66b59dcceec190d4d3147cb12f"></a><!-- doxytag: member="pbx.c::VAR_BUF_SIZE" ref="970eeb66b59dcceec190d4d3147cb12f" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define VAR_BUF_SIZE&nbsp;&nbsp;&nbsp;4096          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00085">85</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04765">ast_add_extension2()</a>, <a class="el" href="pbx_8c-source.html#l05901">pbx_builtin_importvar()</a>, and <a class="el" href="pbx_8c-source.html#l01468">pbx_substitute_variables_helper_full()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="9edf59ee06e97212a06f9b1cfd809a0d"></a><!-- doxytag: member="pbx.c::VAR_HARDTRAN" ref="9edf59ee06e97212a06f9b1cfd809a0d" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define VAR_HARDTRAN&nbsp;&nbsp;&nbsp;3          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00089">89</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="2f935a5d3016e990bb3e97e810132d21"></a><!-- doxytag: member="pbx.c::VAR_NORMAL" ref="2f935a5d3016e990bb3e97e810132d21" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define VAR_NORMAL&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00087">87</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="cc14ef5a8775ee40c7a3df88c7a2cc60"></a><!-- doxytag: member="pbx.c::VAR_SOFTTRAN" ref="cc14ef5a8775ee40c7a3df88c7a2cc60" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define VAR_SOFTTRAN&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00088">88</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="6e4590710fad4ff778fdd12b9ee916d2"></a><!-- doxytag: member="pbx.c::WAITEXTEN_MOH" ref="6e4590710fad4ff778fdd12b9ee916d2" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define WAITEXTEN_MOH&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00103">103</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l05584">pbx_builtin_waitexten()</a>.    </td>
  </tr>
</table>
<hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="5982fa5b4310acd51c79b20de9f824fe"></a><!-- doxytag: member="pbx.c::ext_match_t" ref="5982fa5b4310acd51c79b20de9f824fe" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe">ext_match_t</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
When looking up extensions, we can have different requests identified by the 'action' argument, as follows. Note that the coding is such that the low 4 bits are the third argument to extension_match_core. <dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="5982fa5b4310acd51c79b20de9f824febb13020eaa30c314c1bff110026a7cd2"></a><!-- doxytag: member="E_MATCHMORE" ref="5982fa5b4310acd51c79b20de9f824febb13020eaa30c314c1bff110026a7cd2" args="" -->E_MATCHMORE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="5982fa5b4310acd51c79b20de9f824fee9684886238bd81a61f3358030326178"></a><!-- doxytag: member="E_CANMATCH" ref="5982fa5b4310acd51c79b20de9f824fee9684886238bd81a61f3358030326178" args="" -->E_CANMATCH</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="5982fa5b4310acd51c79b20de9f824fe437691af9bdd09d1ad4c2e5b087d5717"></a><!-- doxytag: member="E_MATCH" ref="5982fa5b4310acd51c79b20de9f824fe437691af9bdd09d1ad4c2e5b087d5717" args="" -->E_MATCH</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="5982fa5b4310acd51c79b20de9f824fe548e6fa5f2ee06c5a9a3a193414cf29c"></a><!-- doxytag: member="E_MATCH_MASK" ref="5982fa5b4310acd51c79b20de9f824fe548e6fa5f2ee06c5a9a3a193414cf29c" args="" -->E_MATCH_MASK</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="5982fa5b4310acd51c79b20de9f824fe216abbac78adc685e53502161a311679"></a><!-- doxytag: member="E_SPAWN" ref="5982fa5b4310acd51c79b20de9f824fe216abbac78adc685e53502161a311679" args="" -->E_SPAWN</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="5982fa5b4310acd51c79b20de9f824fe1bb8d310644e3f6e2603d80f8464bdda"></a><!-- doxytag: member="E_FINDLABEL" ref="5982fa5b4310acd51c79b20de9f824fe1bb8d310644e3f6e2603d80f8464bdda" args="" -->E_FINDLABEL</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00748">748</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.<div class="fragment"><pre class="fragment"><a name="l00748"></a>00748                  {
<a name="l00749"></a>00749    <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824febb13020eaa30c314c1bff110026a7cd2">E_MATCHMORE</a> =  0x00, <span class="comment">/* extension can match but only with more 'digits' */</span>
<a name="l00750"></a>00750    <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fee9684886238bd81a61f3358030326178">E_CANMATCH</a> =   0x01, <span class="comment">/* extension can match with or without more 'digits' */</span>
<a name="l00751"></a>00751    <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe437691af9bdd09d1ad4c2e5b087d5717">E_MATCH</a> =   0x02, <span class="comment">/* extension is an exact match */</span>
<a name="l00752"></a>00752    <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe548e6fa5f2ee06c5a9a3a193414cf29c">E_MATCH_MASK</a> = 0x03, <span class="comment">/* mask for the argument to extension_match_core() */</span>
<a name="l00753"></a>00753    <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe216abbac78adc685e53502161a311679">E_SPAWN</a> =   0x12, <span class="comment">/* want to spawn an extension. Requires exact match */</span>
<a name="l00754"></a>00754    <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe1bb8d310644e3f6e2603d80f8464bdda">E_FINDLABEL</a> =  0x22  <span class="comment">/* returns the priority for a given label. Requires exact match */</span>
<a name="l00755"></a>00755 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="04aa8a1856d1ec89ebff7bd112b037eb"></a><!-- doxytag: member="pbx.c::__ast_context_create" ref="04aa8a1856d1ec89ebff7bd112b037eb" args="(struct ast_context **extcontexts, const char *name, const char *registrar, int existsokay)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static struct <a class="el" href="structast__context.html">ast_context</a>* __ast_context_create           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>extcontexts</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>existsokay</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03870">3870</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="lock_8h-source.html#l00508">ast_mutex_init()</a>, <a class="el" href="lock_8h-source.html#l00619">ast_rwlock_init()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="pbx_8c-source.html#l06064">ast_wrlock_contexts()</a>, <a class="el" href="pbx_8c-source.html#l00489">contexts</a>, <a class="el" href="pbx_8c-source.html#l00170">ast_context::ignorepats</a>, <a class="el" href="pbx_8c-source.html#l00169">ast_context::includes</a>, <a class="el" href="pbx__config_8c-source.html#l00056">local_contexts</a>, <a class="el" href="pbx_8c-source.html#l00166">ast_context::lock</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="pbx_8c-source.html#l00168">ast_context::next</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="pbx_8c-source.html#l00171">ast_context::registrar</a>, <a class="el" href="pbx_8c-source.html#l00167">ast_context::root</a>, and <a class="el" href="logger_8h-source.html#l00045">VERBOSE_PREFIX_3</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03913">ast_context_create()</a>, and <a class="el" href="pbx_8c-source.html#l03918">ast_context_find_or_create()</a>.<div class="fragment"><pre class="fragment"><a name="l03871"></a>03871 {
<a name="l03872"></a>03872    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *tmp, **<a class="code" href="pbx__config_8c.html#912825ad219b891cbb0084ce14d20590">local_contexts</a>;
<a name="l03873"></a>03873    <span class="keywordtype">int</span> length = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a>) + strlen(name) + 1;
<a name="l03874"></a>03874 
<a name="l03875"></a>03875    <span class="keywordflow">if</span> (!extcontexts) {
<a name="l03876"></a>03876       <a class="code" href="pbx_8c.html#6f41efd0c2fa84486ef11fef33681139">ast_wrlock_contexts</a>();
<a name="l03877"></a>03877       local_contexts = &amp;<a class="code" href="pbx_8c.html#9be90dc64c1f5b5c993ff11d732a8da0">contexts</a>;
<a name="l03878"></a>03878    } <span class="keywordflow">else</span>
<a name="l03879"></a>03879       local_contexts = extcontexts;
<a name="l03880"></a>03880 
<a name="l03881"></a>03881    <span class="keywordflow">for</span> (tmp = *local_contexts; tmp; tmp = tmp-&gt;<a class="code" href="structast__context.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l03882"></a>03882       <span class="keywordflow">if</span> (!strcasecmp(tmp-&gt;name, name)) {
<a name="l03883"></a>03883          <span class="keywordflow">if</span> (!existsokay) {
<a name="l03884"></a>03884             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Tried to register context '%s', already in use\n"</span>, name);
<a name="l03885"></a>03885             tmp = NULL;
<a name="l03886"></a>03886          }
<a name="l03887"></a>03887          <span class="keywordflow">if</span> (!extcontexts)
<a name="l03888"></a>03888             <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l03889"></a>03889          <span class="keywordflow">return</span> tmp;
<a name="l03890"></a>03890       }
<a name="l03891"></a>03891    }
<a name="l03892"></a>03892    <span class="keywordflow">if</span> ((tmp = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, length))) {
<a name="l03893"></a>03893       <a class="code" href="lock_8h.html#e3e172b2e96f976c4e1ea692d61ccb89">ast_rwlock_init</a>(&amp;tmp-&gt;<a class="code" href="structast__context.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l03894"></a>03894       <a class="code" href="lock_8h.html#33e99ac90b0ca47211841b5cab79ffc4">ast_mutex_init</a>(&amp;tmp-&gt;macrolock);
<a name="l03895"></a>03895       strcpy(tmp-&gt;name, name);
<a name="l03896"></a>03896       tmp-&gt;<a class="code" href="structast__context.html#63a9f0ea7bb98050796b649e85481845">root</a> = NULL;
<a name="l03897"></a>03897       tmp-&gt;<a class="code" href="structast__context.html#5940569cd1d60781f856f93235b072ee">registrar</a> = <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>;
<a name="l03898"></a>03898       tmp-&gt;<a class="code" href="structast__context.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = *local_contexts;
<a name="l03899"></a>03899       tmp-&gt;<a class="code" href="structast__context.html#bb2b21ef7774df8687ff02b0284505c6">includes</a> = NULL;
<a name="l03900"></a>03900       tmp-&gt;<a class="code" href="structast__context.html#79a69e07731e7d02c0f52f19bab94dcb">ignorepats</a> = NULL;
<a name="l03901"></a>03901       *local_contexts = tmp;
<a name="l03902"></a>03902       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l03903"></a>03903          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Registered context '%s'\n"</span>, tmp-&gt;name);
<a name="l03904"></a>03904       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 2)
<a name="l03905"></a>03905          <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>( <a class="code" href="logger_8h.html#aefd5a67b7464040f5352e4ecdc535ca">VERBOSE_PREFIX_3</a> <span class="stringliteral">"Registered extension context '%s'\n"</span>, tmp-&gt;name);
<a name="l03906"></a>03906    }
<a name="l03907"></a>03907 
<a name="l03908"></a>03908    <span class="keywordflow">if</span> (!extcontexts)
<a name="l03909"></a>03909       <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l03910"></a>03910    <span class="keywordflow">return</span> tmp;
<a name="l03911"></a>03911 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="e2faf43e79194dd93e6200a86f08d563"></a><!-- doxytag: member="pbx.c::__ast_context_destroy" ref="e2faf43e79194dd93e6200a86f08d563" args="(struct ast_context *con, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void __ast_context_destroy           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05285">5285</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00710">AST_LIST_REMOVE_HEAD</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="lock_8h-source.html#l00632">ast_rwlock_destroy()</a>, <a class="el" href="pbx_8c-source.html#l06092">ast_unlock_context()</a>, <a class="el" href="pbx_8c-source.html#l06082">ast_wrlock_context()</a>, <a class="el" href="pbx_8c-source.html#l00489">contexts</a>, <a class="el" href="pbx_8c-source.html#l02521">destroy_exten()</a>, <a class="el" href="asterisk_8c-source.html#l00199">el</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="pbx_8c-source.html#l00131">ast_exten::next</a>, <a class="el" href="pbx_8c-source.html#l00160">ast_ignorepat::next</a>, <a class="el" href="pbx_8c-source.html#l00142">ast_include::next</a>, <a class="el" href="pbx_8c-source.html#l00168">ast_context::next</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, and <a class="el" href="pbx_8c-source.html#l00129">ast_exten::peer</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l05344">ast_context_destroy()</a>, and <a class="el" href="pbx_8c-source.html#l03936">ast_merge_contexts_and_delete()</a>.<div class="fragment"><pre class="fragment"><a name="l05286"></a>05286 {
<a name="l05287"></a>05287    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *tmp, *tmpl=NULL;
<a name="l05288"></a>05288    <span class="keyword">struct </span><a class="code" href="structast__include.html">ast_include</a> *tmpi;
<a name="l05289"></a>05289    <span class="keyword">struct </span><a class="code" href="structast__sw.html">ast_sw</a> *sw;
<a name="l05290"></a>05290    <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *e, *<a class="code" href="asterisk_8c.html#65c10911d8b8591219a21ebacf46da01">el</a>, *en;
<a name="l05291"></a>05291    <span class="keyword">struct </span><a class="code" href="structast__ignorepat.html">ast_ignorepat</a> *ipi;
<a name="l05292"></a>05292 
<a name="l05293"></a>05293    <span class="keywordflow">for</span> (tmp = <a class="code" href="pbx_8c.html#9be90dc64c1f5b5c993ff11d732a8da0">contexts</a>; tmp; ) {
<a name="l05294"></a>05294       <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *<a class="code" href="structast__context.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;  <span class="comment">/* next starting point */</span>
<a name="l05295"></a>05295       <span class="keywordflow">for</span> (; tmp; tmpl = tmp, tmp = tmp-&gt;<a class="code" href="structast__context.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l05296"></a>05296          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l05297"></a>05297             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"check ctx %s %s\n"</span>, tmp-&gt;name, tmp-&gt;registrar);
<a name="l05298"></a>05298          <span class="keywordflow">if</span> ( (!<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a> || !strcasecmp(<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>, tmp-&gt;registrar)) &amp;&amp;
<a name="l05299"></a>05299               (!con || !strcasecmp(tmp-&gt;name, con-&gt;name)) )
<a name="l05300"></a>05300             <span class="keywordflow">break</span>;   <span class="comment">/* found it */</span>
<a name="l05301"></a>05301       }
<a name="l05302"></a>05302       <span class="keywordflow">if</span> (!tmp)   <span class="comment">/* not found, we are done */</span>
<a name="l05303"></a>05303          <span class="keywordflow">break</span>;
<a name="l05304"></a>05304       <a class="code" href="pbx_8c.html#18884df37a7c36a24fd0b5f4225d1112">ast_wrlock_context</a>(tmp);
<a name="l05305"></a>05305       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l05306"></a>05306          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"delete ctx %s %s\n"</span>, tmp-&gt;name, tmp-&gt;registrar);
<a name="l05307"></a>05307       next = tmp-&gt;<a class="code" href="structast__context.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l05308"></a>05308       <span class="keywordflow">if</span> (tmpl)
<a name="l05309"></a>05309          tmpl-&gt;<a class="code" href="structast__context.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = next;
<a name="l05310"></a>05310       <span class="keywordflow">else</span>
<a name="l05311"></a>05311          <a class="code" href="pbx_8c.html#9be90dc64c1f5b5c993ff11d732a8da0">contexts</a> = next;
<a name="l05312"></a>05312       <span class="comment">/* Okay, now we're safe to let it go -- in a sense, we were</span>
<a name="l05313"></a>05313 <span class="comment">         ready to let it go as soon as we locked it. */</span>
<a name="l05314"></a>05314       <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(tmp);
<a name="l05315"></a>05315       <span class="keywordflow">for</span> (tmpi = tmp-&gt;includes; tmpi; ) { <span class="comment">/* Free includes */</span>
<a name="l05316"></a>05316          <span class="keyword">struct </span><a class="code" href="structast__include.html">ast_include</a> *tmpil = tmpi;
<a name="l05317"></a>05317          tmpi = tmpi-&gt;<a class="code" href="structast__include.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l05318"></a>05318          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(tmpil);
<a name="l05319"></a>05319       }
<a name="l05320"></a>05320       <span class="keywordflow">for</span> (ipi = tmp-&gt;ignorepats; ipi; ) { <span class="comment">/* Free ignorepats */</span>
<a name="l05321"></a>05321          <span class="keyword">struct </span><a class="code" href="structast__ignorepat.html">ast_ignorepat</a> *ipl = ipi;
<a name="l05322"></a>05322          ipi = ipi-&gt;<a class="code" href="structast__ignorepat.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l05323"></a>05323          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(ipl);
<a name="l05324"></a>05324       }
<a name="l05325"></a>05325       <span class="keywordflow">while</span> ((sw = <a class="code" href="linkedlists_8h.html#beec347da29fe6b0d7fdb3e80b851f90">AST_LIST_REMOVE_HEAD</a>(&amp;tmp-&gt;alts, list)))
<a name="l05326"></a>05326          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(sw);
<a name="l05327"></a>05327       <span class="keywordflow">for</span> (e = tmp-&gt;root; e;) {
<a name="l05328"></a>05328          <span class="keywordflow">for</span> (en = e-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a>; en;) {
<a name="l05329"></a>05329             el = en;
<a name="l05330"></a>05330             en = en-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a>;
<a name="l05331"></a>05331             <a class="code" href="pbx_8c.html#c7a22bae87915c24108c7304264b78c8">destroy_exten</a>(el);
<a name="l05332"></a>05332          }
<a name="l05333"></a>05333          el = e;
<a name="l05334"></a>05334          e = e-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l05335"></a>05335          <a class="code" href="pbx_8c.html#c7a22bae87915c24108c7304264b78c8">destroy_exten</a>(el);
<a name="l05336"></a>05336       }
<a name="l05337"></a>05337       <a class="code" href="lock_8h.html#9bef7411577c7ffaa1d8451a0c51fb2c">ast_rwlock_destroy</a>(&amp;tmp-&gt;lock);
<a name="l05338"></a>05338       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(tmp);
<a name="l05339"></a>05339       <span class="comment">/* if we have a specific match, we are done, otherwise continue */</span>
<a name="l05340"></a>05340       tmp = con ? NULL : next;
<a name="l05341"></a>05341    }
<a name="l05342"></a>05342 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ea67e0eddc31f7145c5c9c7991255636"></a><!-- doxytag: member="pbx.c::__ast_goto_if_exists" ref="ea67e0eddc31f7145c5c9c7991255636" args="(struct ast_channel *chan, const char *context, const char *exten, int priority, int async)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int __ast_goto_if_exists           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>async</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06258">6258</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l04595">ast_async_goto()</a>, <a class="el" href="pbx_8c-source.html#l02183">ast_exists_extension()</a>, <a class="el" href="pbx_8c-source.html#l04576">ast_explicit_goto()</a>, <a class="el" href="channel_8h-source.html#l00437">ast_channel::cid</a>, <a class="el" href="channel_8h-source.html#l00212">ast_callerid::cid_num</a>, <a class="el" href="channel_8h-source.html#l00441">ast_channel::context</a>, and <a class="el" href="channel_8h-source.html#l00442">ast_channel::exten</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l06282">ast_async_goto_if_exists()</a>, and <a class="el" href="pbx_8c-source.html#l06277">ast_goto_if_exists()</a>.<div class="fragment"><pre class="fragment"><a name="l06259"></a>06259 {
<a name="l06260"></a>06260    int (*goto_func)(<span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <span class="keywordtype">int</span> <a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>);
<a name="l06261"></a>06261 
<a name="l06262"></a>06262    <span class="keywordflow">if</span> (!chan)
<a name="l06263"></a>06263       <span class="keywordflow">return</span> -2;
<a name="l06264"></a>06264 
<a name="l06265"></a>06265    <span class="keywordflow">if</span> (context == NULL)
<a name="l06266"></a>06266       context = chan-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>;
<a name="l06267"></a>06267    <span class="keywordflow">if</span> (exten == NULL)
<a name="l06268"></a>06268       exten = chan-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>;
<a name="l06269"></a>06269 
<a name="l06270"></a>06270    goto_func = (async) ? <a class="code" href="pbx_8c.html#563b92a651459898f8ccfdc367746147">ast_async_goto</a> : <a class="code" href="pbx_8c.html#1e0079c7f2934dd7ebe801fefe4057da">ast_explicit_goto</a>;
<a name="l06271"></a>06271    <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#90b58be34145fcfd99652f0c3ae7377d">ast_exists_extension</a>(chan, context, exten, <a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>, chan-&gt;cid.cid_num))
<a name="l06272"></a>06272       <span class="keywordflow">return</span> goto_func(chan, context, exten, <a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>);
<a name="l06273"></a>06273    <span class="keywordflow">else</span>
<a name="l06274"></a>06274       <span class="keywordflow">return</span> -3;
<a name="l06275"></a>06275 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d6a76cc38fc49b50acb5368a81899555"></a><!-- doxytag: member="pbx.c::__ast_pbx_run" ref="d6a76cc38fc49b50acb5368a81899555" args="(struct ast_channel *c)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int __ast_pbx_run           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>c</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02250">2250</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00414">ast_channel::_softhangup</a>, <a class="el" href="channel_8h-source.html#l00450">ast_channel::amaflags</a>, <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="cdr_8c-source.html#l00460">ast_cdr_alloc()</a>, <a class="el" href="cdr_8c-source.html#l00788">ast_cdr_end()</a>, <a class="el" href="cdr_8c-source.html#l00763">ast_cdr_init()</a>, <a class="el" href="cdr_8c-source.html#l00620">ast_cdr_start()</a>, <a class="el" href="cdr_8c-source.html#l00885">ast_cdr_update()</a>, <a class="el" href="pbx_8c-source.html#l02183">ast_exists_extension()</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73002122d39475941a27a292dfd49534d079">AST_FLAG_IN_AUTOLOOP</a>, <a class="el" href="channel_8c-source.html#l01598">ast_hangup()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="options_8h-source.html#l00105">ast_opt_end_cdr_before_h_exten</a>, <a class="el" href="pbx_8h-source.html#l00040">AST_PBX_KEEPALIVE</a>, <a class="el" href="utils_8h-source.html#l00098">ast_set2_flag</a>, <a class="el" href="utils_8h-source.html#l00074">ast_set_flag</a>, <a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a179c1afce6cda266617f47d63393c2d71">AST_SOFTHANGUP_ASYNCGOTO</a>, <a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a12709ffb7179ec4c9b3ba505519ddc84e">AST_SOFTHANGUP_TIMEOUT</a>, <a class="el" href="pbx_8c-source.html#l02208">ast_spawn_extension()</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="pbx_8c-source.html#l00249">autofallthrough</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, <a class="el" href="channel_8h-source.html#l00437">ast_channel::cid</a>, <a class="el" href="channel_8h-source.html#l00212">ast_callerid::cid_num</a>, <a class="el" href="pbx_8c-source.html#l02224">collect_digits()</a>, <a class="el" href="channel_8h-source.html#l00441">ast_channel::context</a>, <a class="el" href="pbx_8h-source.html#l00110">ast_pbx::dtimeout</a>, <a class="el" href="dlfcn_8c-source.html#l00196">error()</a>, <a class="el" href="channel_8h-source.html#l00442">ast_channel::exten</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="channel_8h-source.html#l00449">ast_channel::pbx</a>, <a class="el" href="pbx_8c-source.html#l05394">pbx_builtin_busy()</a>, <a class="el" href="pbx_8c-source.html#l05408">pbx_builtin_congestion()</a>, <a class="el" href="pbx_8c-source.html#l05762">pbx_builtin_getvar_helper()</a>, <a class="el" href="pbx_8c-source.html#l05821">pbx_builtin_setvar_helper()</a>, <a class="el" href="pbx_8c-source.html#l00583">pbx_destroy()</a>, <a class="el" href="channel_8h-source.html#l00443">ast_channel::priority</a>, <a class="el" href="pbx_8h-source.html#l00111">ast_pbx::rtimeout</a>, <a class="el" href="pbx_8c-source.html#l02214">set_ext_pri()</a>, <a class="el" href="cdr_8h-source.html#l00070">ast_cdr::start</a>, <a class="el" href="logger_8h-source.html#l00044">VERBOSE_PREFIX_2</a>, <a class="el" href="logger_8h-source.html#l00045">VERBOSE_PREFIX_3</a>, and <a class="el" href="channel_8h-source.html#l00416">ast_channel::whentohangup</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02572">ast_pbx_run()</a>, and <a class="el" href="pbx_8c-source.html#l02531">pbx_thread()</a>.<div class="fragment"><pre class="fragment"><a name="l02251"></a>02251 {
<a name="l02252"></a>02252    <span class="keywordtype">int</span> found = 0; <span class="comment">/* set if we find at least one match */</span>
<a name="l02253"></a>02253    <span class="keywordtype">int</span> res = 0;
<a name="l02254"></a>02254    <span class="keywordtype">int</span> autoloopflag;
<a name="l02255"></a>02255    <span class="keywordtype">int</span> <a class="code" href="dlfcn_8c.html#9989047f9754c69a45ea752cb417ca79">error</a> = 0;    <span class="comment">/* set an error conditions */</span>
<a name="l02256"></a>02256 
<a name="l02257"></a>02257    <span class="comment">/* A little initial setup here */</span>
<a name="l02258"></a>02258    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structast__channel.html#569f7a090087f9e7071a247a24ea0809">pbx</a>) {
<a name="l02259"></a>02259       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"%s already has PBX structure??\n"</span>, c-&gt;name);
<a name="l02260"></a>02260       <span class="comment">/* XXX and now what ? */</span>
<a name="l02261"></a>02261       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(c-&gt;<a class="code" href="structast__channel.html#569f7a090087f9e7071a247a24ea0809">pbx</a>);
<a name="l02262"></a>02262    }
<a name="l02263"></a>02263    <span class="keywordflow">if</span> (!(c-&gt;<a class="code" href="structast__channel.html#569f7a090087f9e7071a247a24ea0809">pbx</a> = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*c-&gt;<a class="code" href="structast__channel.html#569f7a090087f9e7071a247a24ea0809">pbx</a>))))
<a name="l02264"></a>02264       <span class="keywordflow">return</span> -1;
<a name="l02265"></a>02265    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structast__channel.html#d5aa4bb1461fe3d863bd95fb137e2284">amaflags</a>) {
<a name="l02266"></a>02266       <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>) {
<a name="l02267"></a>02267          c-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a> = <a class="code" href="cdr_8c.html#0dd431954a27c67f78c6e13be8a0b136">ast_cdr_alloc</a>();
<a name="l02268"></a>02268          <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>) {
<a name="l02269"></a>02269             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Unable to create Call Detail Record\n"</span>);
<a name="l02270"></a>02270             <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(c-&gt;<a class="code" href="structast__channel.html#569f7a090087f9e7071a247a24ea0809">pbx</a>);
<a name="l02271"></a>02271             <span class="keywordflow">return</span> -1;
<a name="l02272"></a>02272          }
<a name="l02273"></a>02273          <a class="code" href="cdr_8c.html#4d85bb268956ffbf0b19df25915726e8">ast_cdr_init</a>(c-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>, c);
<a name="l02274"></a>02274       }
<a name="l02275"></a>02275    }
<a name="l02276"></a>02276    <span class="comment">/* Set reasonable defaults */</span>
<a name="l02277"></a>02277    c-&gt;<a class="code" href="structast__channel.html#569f7a090087f9e7071a247a24ea0809">pbx</a>-&gt;<a class="code" href="structast__pbx.html#67f5f3b34d678e33543600540409fa9d">rtimeout</a> = 10;
<a name="l02278"></a>02278    c-&gt;<a class="code" href="structast__channel.html#569f7a090087f9e7071a247a24ea0809">pbx</a>-&gt;<a class="code" href="structast__pbx.html#5559d18605837885d883b6aa738283f4">dtimeout</a> = 5;
<a name="l02279"></a>02279 
<a name="l02280"></a>02280    autoloopflag = <a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(c, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73002122d39475941a27a292dfd49534d079">AST_FLAG_IN_AUTOLOOP</a>);   <span class="comment">/* save value to restore at the end */</span>
<a name="l02281"></a>02281    <a class="code" href="utils_8h.html#3208623241ff7b4c93907944487502a1">ast_set_flag</a>(c, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73002122d39475941a27a292dfd49534d079">AST_FLAG_IN_AUTOLOOP</a>);
<a name="l02282"></a>02282 
<a name="l02283"></a>02283    <span class="comment">/* Start by trying whatever the channel is set to */</span>
<a name="l02284"></a>02284    <span class="keywordflow">if</span> (!<a class="code" href="pbx_8c.html#90b58be34145fcfd99652f0c3ae7377d">ast_exists_extension</a>(c, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, c-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>, c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>)) {
<a name="l02285"></a>02285       <span class="comment">/* If not successful fall back to 's' */</span>
<a name="l02286"></a>02286       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 1)
<a name="l02287"></a>02287          <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>( <a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Starting %s at %s,%s,%d failed so falling back to exten 's'\n"</span>, c-&gt;name, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, c-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>);
<a name="l02288"></a>02288       <span class="comment">/* XXX the original code used the existing priority in the call to</span>
<a name="l02289"></a>02289 <span class="comment">       * ast_exists_extension(), and reset it to 1 afterwards.</span>
<a name="l02290"></a>02290 <span class="comment">       * I believe the correct thing is to set it to 1 immediately.</span>
<a name="l02291"></a>02291 <span class="comment">       */</span>
<a name="l02292"></a>02292       <a class="code" href="pbx_8c.html#09e258d284c6e074e06ec6e73fb5886e">set_ext_pri</a>(c, <span class="stringliteral">"s"</span>, 1);
<a name="l02293"></a>02293       <span class="keywordflow">if</span> (!<a class="code" href="pbx_8c.html#90b58be34145fcfd99652f0c3ae7377d">ast_exists_extension</a>(c, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, c-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>, c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>)) {
<a name="l02294"></a>02294          <span class="comment">/* JK02: And finally back to default if everything else failed */</span>
<a name="l02295"></a>02295          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 1)
<a name="l02296"></a>02296             <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>( <a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Starting %s at %s,%s,%d still failed so falling back to context 'default'\n"</span>, c-&gt;name, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, c-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>);
<a name="l02297"></a>02297          ast_copy_string(c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <span class="stringliteral">"default"</span>, <span class="keyword">sizeof</span>(c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>));
<a name="l02298"></a>02298       }
<a name="l02299"></a>02299    }
<a name="l02300"></a>02300    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a> &amp;&amp; ast_tvzero(c-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>-&gt;<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a>))
<a name="l02301"></a>02301       <a class="code" href="cdr_8c.html#56e1b7b9d5acada4d22d345813710582">ast_cdr_start</a>(c-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>);
<a name="l02302"></a>02302    <span class="keywordflow">for</span> (;;) {
<a name="l02303"></a>02303       <span class="keywordtype">char</span> dst_exten[256]; <span class="comment">/* buffer to accumulate digits */</span>
<a name="l02304"></a>02304       <span class="keywordtype">int</span> pos = 0;      <span class="comment">/* XXX should check bounds */</span>
<a name="l02305"></a>02305       <span class="keywordtype">int</span> digit = 0;
<a name="l02306"></a>02306 
<a name="l02307"></a>02307       <span class="comment">/* loop on priorities in this context/exten */</span>
<a name="l02308"></a>02308       <span class="keywordflow">while</span> (<a class="code" href="pbx_8c.html#90b58be34145fcfd99652f0c3ae7377d">ast_exists_extension</a>(c, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, c-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>, c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>)) {
<a name="l02309"></a>02309          found = 1;
<a name="l02310"></a>02310          <span class="keywordflow">if</span> ((res = <a class="code" href="pbx_8c.html#63a99eec1b6004791bd2013ad855eea8">ast_spawn_extension</a>(c, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, c-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>, c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>))) {
<a name="l02311"></a>02311             <span class="comment">/* Something bad happened, or a hangup has been requested. */</span>
<a name="l02312"></a>02312             <span class="keywordflow">if</span> (strchr(<span class="stringliteral">"0123456789ABCDEF*#"</span>, res)) {
<a name="l02313"></a>02313                <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l02314"></a>02314                   <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Oooh, got something to jump out with ('%c')!\n"</span>, res);
<a name="l02315"></a>02315                pos = 0;
<a name="l02316"></a>02316                dst_exten[pos++] = digit = res;
<a name="l02317"></a>02317                dst_exten[pos] = <span class="charliteral">'\0'</span>;
<a name="l02318"></a>02318                <span class="keywordflow">break</span>;
<a name="l02319"></a>02319             }
<a name="l02320"></a>02320             <span class="keywordflow">if</span> (res == <a class="code" href="pbx_8h.html#60ed4b0965b6f9aa117240879d402201">AST_PBX_KEEPALIVE</a>) {
<a name="l02321"></a>02321                <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l02322"></a>02322                   <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Spawn extension (%s,%s,%d) exited KEEPALIVE on '%s'\n"</span>, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, c-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>, c-&gt;name);
<a name="l02323"></a>02323                <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 1)
<a name="l02324"></a>02324                   <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>( <a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Spawn extension (%s, %s, %d) exited KEEPALIVE on '%s'\n"</span>, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, c-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>, c-&gt;name);
<a name="l02325"></a>02325                error = 1;
<a name="l02326"></a>02326                <span class="keywordflow">break</span>;
<a name="l02327"></a>02327             }
<a name="l02328"></a>02328             <span class="keywordflow">if</span> (option_debug)
<a name="l02329"></a>02329                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Spawn extension (%s,%s,%d) exited non-zero on '%s'\n"</span>, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, c-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>, c-&gt;name);
<a name="l02330"></a>02330             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 1)
<a name="l02331"></a>02331                <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>( <a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Spawn extension (%s, %s, %d) exited non-zero on '%s'\n"</span>, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, c-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>, c-&gt;name);
<a name="l02332"></a>02332             <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> == <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a179c1afce6cda266617f47d63393c2d71">AST_SOFTHANGUP_ASYNCGOTO</a>) {
<a name="l02333"></a>02333                c-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> =0;
<a name="l02334"></a>02334             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> == <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a12709ffb7179ec4c9b3ba505519ddc84e">AST_SOFTHANGUP_TIMEOUT</a>) {
<a name="l02335"></a>02335                <span class="comment">/* atimeout, nothing bad */</span>
<a name="l02336"></a>02336             } <span class="keywordflow">else</span> {
<a name="l02337"></a>02337                <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>)
<a name="l02338"></a>02338                   <a class="code" href="cdr_8c.html#0247fba893abcaf42f3861b4982361db">ast_cdr_update</a>(c);
<a name="l02339"></a>02339                error = 1;
<a name="l02340"></a>02340                <span class="keywordflow">break</span>;
<a name="l02341"></a>02341             }
<a name="l02342"></a>02342          }
<a name="l02343"></a>02343          <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> == <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a12709ffb7179ec4c9b3ba505519ddc84e">AST_SOFTHANGUP_TIMEOUT</a> &amp;&amp; <a class="code" href="pbx_8c.html#90b58be34145fcfd99652f0c3ae7377d">ast_exists_extension</a>(c,c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>,<span class="stringliteral">"T"</span>,1,c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>)) {
<a name="l02344"></a>02344             <a class="code" href="pbx_8c.html#09e258d284c6e074e06ec6e73fb5886e">set_ext_pri</a>(c, <span class="stringliteral">"T"</span>, 0); <span class="comment">/* 0 will become 1 with the c-&gt;priority++; at the end */</span>
<a name="l02345"></a>02345             <span class="comment">/* If the AbsoluteTimeout is not reset to 0, we'll get an infinite loop */</span>
<a name="l02346"></a>02346             c-&gt;<a class="code" href="structast__channel.html#1272db9c0584f07eb3c6bae4e21fc7c8">whentohangup</a> = 0;
<a name="l02347"></a>02347             c-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> &amp;= ~<a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a12709ffb7179ec4c9b3ba505519ddc84e">AST_SOFTHANGUP_TIMEOUT</a>;
<a name="l02348"></a>02348          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a>) {
<a name="l02349"></a>02349             <span class="keywordflow">if</span> (option_debug)
<a name="l02350"></a>02350                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Extension %s, priority %d returned normally even though call was hung up\n"</span>,
<a name="l02351"></a>02351                   c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, c-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>);
<a name="l02352"></a>02352             error = 1;
<a name="l02353"></a>02353             <span class="keywordflow">break</span>;
<a name="l02354"></a>02354          }
<a name="l02355"></a>02355          c-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>++;
<a name="l02356"></a>02356       } <span class="comment">/* end while  - from here on we can use 'break' to go out */</span>
<a name="l02357"></a>02357       <span class="keywordflow">if</span> (error)
<a name="l02358"></a>02358          <span class="keywordflow">break</span>;
<a name="l02359"></a>02359 
<a name="l02360"></a>02360       <span class="comment">/* XXX we get here on non-existing extension or a keypress or hangup ? */</span>
<a name="l02361"></a>02361 
<a name="l02362"></a>02362       <span class="keywordflow">if</span> (!<a class="code" href="pbx_8c.html#90b58be34145fcfd99652f0c3ae7377d">ast_exists_extension</a>(c, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, 1, c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>)) {
<a name="l02363"></a>02363          <span class="comment">/* If there is no match at priority 1, it is not a valid extension anymore.</span>
<a name="l02364"></a>02364 <span class="comment">          * Try to continue at "i", 1 or exit if the latter does not exist.</span>
<a name="l02365"></a>02365 <span class="comment">          */</span>
<a name="l02366"></a>02366          <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#90b58be34145fcfd99652f0c3ae7377d">ast_exists_extension</a>(c, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <span class="stringliteral">"i"</span>, 1, c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>)) {
<a name="l02367"></a>02367             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 2)
<a name="l02368"></a>02368                <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#aefd5a67b7464040f5352e4ecdc535ca">VERBOSE_PREFIX_3</a> <span class="stringliteral">"Sent into invalid extension '%s' in context '%s' on %s\n"</span>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, c-&gt;name);
<a name="l02369"></a>02369             <a class="code" href="pbx_8c.html#64407c916a2de6ae3f0efeca471c1b1d">pbx_builtin_setvar_helper</a>(c, <span class="stringliteral">"INVALID_EXTEN"</span>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>);
<a name="l02370"></a>02370             <a class="code" href="pbx_8c.html#09e258d284c6e074e06ec6e73fb5886e">set_ext_pri</a>(c, <span class="stringliteral">"i"</span>, 1);
<a name="l02371"></a>02371          } <span class="keywordflow">else</span> {
<a name="l02372"></a>02372             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Channel '%s' sent into invalid extension '%s' in context '%s', but no invalid handler\n"</span>,
<a name="l02373"></a>02373                c-&gt;name, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l02374"></a>02374             error = 1; <span class="comment">/* we know what to do with it */</span>
<a name="l02375"></a>02375             <span class="keywordflow">break</span>;
<a name="l02376"></a>02376          }
<a name="l02377"></a>02377       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> == <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a12709ffb7179ec4c9b3ba505519ddc84e">AST_SOFTHANGUP_TIMEOUT</a>) {
<a name="l02378"></a>02378          <span class="comment">/* If we get this far with AST_SOFTHANGUP_TIMEOUT, then we know that the "T" extension is next. */</span>
<a name="l02379"></a>02379          c-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> = 0;
<a name="l02380"></a>02380       } <span class="keywordflow">else</span> { <span class="comment">/* keypress received, get more digits for a full extension */</span>
<a name="l02381"></a>02381          <span class="keywordtype">int</span> waittime = 0;
<a name="l02382"></a>02382          <span class="keywordflow">if</span> (digit)
<a name="l02383"></a>02383             waittime = c-&gt;<a class="code" href="structast__channel.html#569f7a090087f9e7071a247a24ea0809">pbx</a>-&gt;<a class="code" href="structast__pbx.html#5559d18605837885d883b6aa738283f4">dtimeout</a>;
<a name="l02384"></a>02384          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="pbx_8c.html#509cd842fa6ca4f1b6be7d908dbedf09">autofallthrough</a>)
<a name="l02385"></a>02385             waittime = c-&gt;<a class="code" href="structast__channel.html#569f7a090087f9e7071a247a24ea0809">pbx</a>-&gt;<a class="code" href="structast__pbx.html#67f5f3b34d678e33543600540409fa9d">rtimeout</a>;
<a name="l02386"></a>02386          <span class="keywordflow">if</span> (!waittime) {
<a name="l02387"></a>02387             <span class="keyword">const</span> <span class="keywordtype">char</span> *status = <a class="code" href="pbx_8c.html#944d18aa90701f025b30e63d9644e448">pbx_builtin_getvar_helper</a>(c, <span class="stringliteral">"DIALSTATUS"</span>);
<a name="l02388"></a>02388             <span class="keywordflow">if</span> (!status)
<a name="l02389"></a>02389                status = <span class="stringliteral">"UNKNOWN"</span>;
<a name="l02390"></a>02390             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 2)
<a name="l02391"></a>02391                <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Auto fallthrough, channel '%s' status is '%s'\n"</span>, c-&gt;name, status);
<a name="l02392"></a>02392             <span class="keywordflow">if</span> (!strcasecmp(status, <span class="stringliteral">"CONGESTION"</span>))
<a name="l02393"></a>02393                res = <a class="code" href="group__applications.html#gba7a6211f869def5ad321c8c89825e82">pbx_builtin_congestion</a>(c, <span class="stringliteral">"10"</span>);
<a name="l02394"></a>02394             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(status, <span class="stringliteral">"CHANUNAVAIL"</span>))
<a name="l02395"></a>02395                res = <a class="code" href="group__applications.html#gba7a6211f869def5ad321c8c89825e82">pbx_builtin_congestion</a>(c, <span class="stringliteral">"10"</span>);
<a name="l02396"></a>02396             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(status, <span class="stringliteral">"BUSY"</span>))
<a name="l02397"></a>02397                res = <a class="code" href="group__applications.html#g8224c9f80e837c7f2f815ddd5b18aee6">pbx_builtin_busy</a>(c, <span class="stringliteral">"10"</span>);
<a name="l02398"></a>02398             error = 1; <span class="comment">/* XXX disable message */</span>
<a name="l02399"></a>02399             <span class="keywordflow">break</span>;   <span class="comment">/* exit from the 'for' loop */</span>
<a name="l02400"></a>02400          }
<a name="l02401"></a>02401 
<a name="l02402"></a>02402          <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#56ac9c8dffe6fb673e5c26f2b706777b">collect_digits</a>(c, waittime, dst_exten, <span class="keyword">sizeof</span>(dst_exten), pos))
<a name="l02403"></a>02403             <span class="keywordflow">break</span>;
<a name="l02404"></a>02404          <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#90b58be34145fcfd99652f0c3ae7377d">ast_exists_extension</a>(c, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, dst_exten, 1, c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>)) <span class="comment">/* Prepare the next cycle */</span>
<a name="l02405"></a>02405             <a class="code" href="pbx_8c.html#09e258d284c6e074e06ec6e73fb5886e">set_ext_pri</a>(c, dst_exten, 1);
<a name="l02406"></a>02406          <span class="keywordflow">else</span> {
<a name="l02407"></a>02407             <span class="comment">/* No such extension */</span>
<a name="l02408"></a>02408             <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(dst_exten)) {
<a name="l02409"></a>02409                <span class="comment">/* An invalid extension */</span>
<a name="l02410"></a>02410                <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#90b58be34145fcfd99652f0c3ae7377d">ast_exists_extension</a>(c, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <span class="stringliteral">"i"</span>, 1, c-&gt;cid.cid_num)) {
<a name="l02411"></a>02411                   <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 2)
<a name="l02412"></a>02412                      <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>( <a class="code" href="logger_8h.html#aefd5a67b7464040f5352e4ecdc535ca">VERBOSE_PREFIX_3</a> <span class="stringliteral">"Invalid extension '%s' in context '%s' on %s\n"</span>, dst_exten, c-&gt;context, c-&gt;name);
<a name="l02413"></a>02413                   <a class="code" href="pbx_8c.html#64407c916a2de6ae3f0efeca471c1b1d">pbx_builtin_setvar_helper</a>(c, <span class="stringliteral">"INVALID_EXTEN"</span>, dst_exten);
<a name="l02414"></a>02414                   <a class="code" href="pbx_8c.html#09e258d284c6e074e06ec6e73fb5886e">set_ext_pri</a>(c, <span class="stringliteral">"i"</span>, 1);
<a name="l02415"></a>02415                } <span class="keywordflow">else</span> {
<a name="l02416"></a>02416                   <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Invalid extension '%s', but no rule 'i' in context '%s'\n"</span>, dst_exten, c-&gt;context);
<a name="l02417"></a>02417                   found = 1; <span class="comment">/* XXX disable message */</span>
<a name="l02418"></a>02418                   <span class="keywordflow">break</span>;
<a name="l02419"></a>02419                }
<a name="l02420"></a>02420             } <span class="keywordflow">else</span> {
<a name="l02421"></a>02421                <span class="comment">/* A simple timeout */</span>
<a name="l02422"></a>02422                <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#90b58be34145fcfd99652f0c3ae7377d">ast_exists_extension</a>(c, c-&gt;context, <span class="stringliteral">"t"</span>, 1, c-&gt;cid.cid_num)) {
<a name="l02423"></a>02423                   <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 2)
<a name="l02424"></a>02424                      <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>( <a class="code" href="logger_8h.html#aefd5a67b7464040f5352e4ecdc535ca">VERBOSE_PREFIX_3</a> <span class="stringliteral">"Timeout on %s\n"</span>, c-&gt;name);
<a name="l02425"></a>02425                   <a class="code" href="pbx_8c.html#09e258d284c6e074e06ec6e73fb5886e">set_ext_pri</a>(c, <span class="stringliteral">"t"</span>, 1);
<a name="l02426"></a>02426                } <span class="keywordflow">else</span> {
<a name="l02427"></a>02427                   <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Timeout, but no rule 't' in context '%s'\n"</span>, c-&gt;context);
<a name="l02428"></a>02428                   found = 1; <span class="comment">/* XXX disable message */</span>
<a name="l02429"></a>02429                   <span class="keywordflow">break</span>;
<a name="l02430"></a>02430                }
<a name="l02431"></a>02431             }
<a name="l02432"></a>02432          }
<a name="l02433"></a>02433          <span class="keywordflow">if</span> (c-&gt;cdr) {
<a name="l02434"></a>02434             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 2)
<a name="l02435"></a>02435                <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"CDR updated on %s\n"</span>,c-&gt;name);
<a name="l02436"></a>02436             <a class="code" href="cdr_8c.html#0247fba893abcaf42f3861b4982361db">ast_cdr_update</a>(c);
<a name="l02437"></a>02437          }
<a name="l02438"></a>02438       }
<a name="l02439"></a>02439    }
<a name="l02440"></a>02440    <span class="keywordflow">if</span> (!found &amp;&amp; !error)
<a name="l02441"></a>02441       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Don't know what to do with '%s'\n"</span>, c-&gt;name);
<a name="l02442"></a>02442    <span class="keywordflow">if</span> ((res != <a class="code" href="pbx_8h.html#60ed4b0965b6f9aa117240879d402201">AST_PBX_KEEPALIVE</a>) &amp;&amp; <a class="code" href="pbx_8c.html#90b58be34145fcfd99652f0c3ae7377d">ast_exists_extension</a>(c, c-&gt;context, <span class="stringliteral">"h"</span>, 1, c-&gt;cid.cid_num)) {
<a name="l02443"></a>02443       <span class="keywordflow">if</span> (c-&gt;cdr &amp;&amp; <a class="code" href="options_8h.html#0b41981a788dd7bf06104c4b8fb056ff">ast_opt_end_cdr_before_h_exten</a>)
<a name="l02444"></a>02444          <a class="code" href="cdr_8c.html#545d0bb7a87e9317b6eb3ce2245145cc">ast_cdr_end</a>(c-&gt;cdr);
<a name="l02445"></a>02445       <a class="code" href="pbx_8c.html#09e258d284c6e074e06ec6e73fb5886e">set_ext_pri</a>(c, <span class="stringliteral">"h"</span>, 1);
<a name="l02446"></a>02446       <span class="keywordflow">while</span> (<a class="code" href="pbx_8c.html#90b58be34145fcfd99652f0c3ae7377d">ast_exists_extension</a>(c, c-&gt;context, c-&gt;exten, c-&gt;priority, c-&gt;cid.cid_num)) {
<a name="l02447"></a>02447          <span class="keywordflow">if</span> ((res = <a class="code" href="pbx_8c.html#63a99eec1b6004791bd2013ad855eea8">ast_spawn_extension</a>(c, c-&gt;context, c-&gt;exten, c-&gt;priority, c-&gt;cid.cid_num))) {
<a name="l02448"></a>02448             <span class="comment">/* Something bad happened, or a hangup has been requested. */</span>
<a name="l02449"></a>02449             <span class="keywordflow">if</span> (option_debug)
<a name="l02450"></a>02450                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Spawn extension (%s,%s,%d) exited non-zero on '%s'\n"</span>, c-&gt;context, c-&gt;exten, c-&gt;priority, c-&gt;name);
<a name="l02451"></a>02451             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 1)
<a name="l02452"></a>02452                <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>( <a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Spawn extension (%s, %s, %d) exited non-zero on '%s'\n"</span>, c-&gt;context, c-&gt;exten, c-&gt;priority, c-&gt;name);
<a name="l02453"></a>02453             <span class="keywordflow">break</span>;
<a name="l02454"></a>02454          }
<a name="l02455"></a>02455          c-&gt;priority++;
<a name="l02456"></a>02456       }
<a name="l02457"></a>02457    }
<a name="l02458"></a>02458    <a class="code" href="utils_8h.html#006f8c62b98bc7acf13ee1584ce5a1ce">ast_set2_flag</a>(c, autoloopflag, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73002122d39475941a27a292dfd49534d079">AST_FLAG_IN_AUTOLOOP</a>);
<a name="l02459"></a>02459 
<a name="l02460"></a>02460    <a class="code" href="pbx_8c.html#3f3f421aab3b84db6bcebc624d6c1426">pbx_destroy</a>(c-&gt;pbx);
<a name="l02461"></a>02461    c-&gt;pbx = NULL;
<a name="l02462"></a>02462    <span class="keywordflow">if</span> (res != <a class="code" href="pbx_8h.html#60ed4b0965b6f9aa117240879d402201">AST_PBX_KEEPALIVE</a>)
<a name="l02463"></a>02463       <a class="code" href="channel_8c.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a>(c);
<a name="l02464"></a>02464    <span class="keywordflow">return</span> 0;
<a name="l02465"></a>02465 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="db697281f06d30c766c4af8b5bf48199"></a><!-- doxytag: member="pbx.c::_extension_match_core" ref="db697281f06d30c766c4af8b5bf48199" args="(const char *pattern, const char *data, enum ext_match_t mode)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int _extension_match_core           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>pattern</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>enum <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe">ext_match_t</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>mode</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00766">766</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe437691af9bdd09d1ad4c2e5b087d5717">E_MATCH</a>, <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe548e6fa5f2ee06c5a9a3a193414cf29c">E_MATCH_MASK</a>, <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824febb13020eaa30c314c1bff110026a7cd2">E_MATCHMORE</a>, and <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l00865">extension_match_core()</a>.<div class="fragment"><pre class="fragment"><a name="l00767"></a>00767 {
<a name="l00768"></a>00768    mode &amp;= <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe548e6fa5f2ee06c5a9a3a193414cf29c">E_MATCH_MASK</a>;   <span class="comment">/* only consider the relevant bits */</span>
<a name="l00769"></a>00769 
<a name="l00770"></a>00770    <span class="keywordflow">if</span> ( (mode == <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe437691af9bdd09d1ad4c2e5b087d5717">E_MATCH</a>) &amp;&amp; (pattern[0] == <span class="charliteral">'_'</span>) &amp;&amp; (strcasecmp(pattern,<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a>)==0) ) <span class="comment">/* note: if this test is left out, then _x. will not match _x. !!! */</span>
<a name="l00771"></a>00771       <span class="keywordflow">return</span> 1;
<a name="l00772"></a>00772 
<a name="l00773"></a>00773    <span class="keywordflow">if</span> (pattern[0] != <span class="charliteral">'_'</span>) { <span class="comment">/* not a pattern, try exact or partial match */</span>
<a name="l00774"></a>00774       <span class="keywordtype">int</span> ld = strlen(<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a>), lp = strlen(pattern);
<a name="l00775"></a>00775 
<a name="l00776"></a>00776       <span class="keywordflow">if</span> (lp &lt; ld)      <span class="comment">/* pattern too short, cannot match */</span>
<a name="l00777"></a>00777          <span class="keywordflow">return</span> 0;
<a name="l00778"></a>00778       <span class="comment">/* depending on the mode, accept full or partial match or both */</span>
<a name="l00779"></a>00779       <span class="keywordflow">if</span> (mode == <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe437691af9bdd09d1ad4c2e5b087d5717">E_MATCH</a>)
<a name="l00780"></a>00780          <span class="keywordflow">return</span> !strcmp(pattern, <a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a>); <span class="comment">/* 1 on match, 0 on fail */</span>
<a name="l00781"></a>00781       <span class="keywordflow">if</span> (ld == 0 || !strncasecmp(pattern, <a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a>, ld)) <span class="comment">/* partial or full match */</span>
<a name="l00782"></a>00782          <span class="keywordflow">return</span> (mode == <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824febb13020eaa30c314c1bff110026a7cd2">E_MATCHMORE</a>) ? lp &gt; ld : 1; <span class="comment">/* XXX should consider '!' and '/' ? */</span>
<a name="l00783"></a>00783       <span class="keywordflow">else</span>
<a name="l00784"></a>00784          <span class="keywordflow">return</span> 0;
<a name="l00785"></a>00785    }
<a name="l00786"></a>00786    pattern++; <span class="comment">/* skip leading _ */</span>
<a name="l00787"></a>00787    <span class="comment">/*</span>
<a name="l00788"></a>00788 <span class="comment">    * XXX below we stop at '/' which is a separator for the CID info. However we should</span>
<a name="l00789"></a>00789 <span class="comment">    * not store '/' in the pattern at all. When we insure it, we can remove the checks.</span>
<a name="l00790"></a>00790 <span class="comment">    */</span>
<a name="l00791"></a>00791    <span class="keywordflow">while</span> (*<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a> &amp;&amp; *pattern &amp;&amp; *pattern != <span class="charliteral">'/'</span>) {
<a name="l00792"></a>00792       <span class="keyword">const</span> <span class="keywordtype">char</span> *end;
<a name="l00793"></a>00793 
<a name="l00794"></a>00794       <span class="keywordflow">if</span> (*<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a> == <span class="charliteral">'-'</span>) { <span class="comment">/* skip '-' in data (just a separator) */</span>
<a name="l00795"></a>00795          <a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a>++;
<a name="l00796"></a>00796          <span class="keywordflow">continue</span>;
<a name="l00797"></a>00797       }
<a name="l00798"></a>00798       <span class="keywordflow">switch</span> (toupper(*pattern)) {
<a name="l00799"></a>00799       <span class="keywordflow">case</span> <span class="charliteral">'['</span>:   <span class="comment">/* a range */</span>
<a name="l00800"></a>00800          end = strchr(pattern+1, <span class="charliteral">']'</span>); <span class="comment">/* XXX should deal with escapes ? */</span>
<a name="l00801"></a>00801          <span class="keywordflow">if</span> (end == NULL) {
<a name="l00802"></a>00802             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Wrong usage of [] in the extension\n"</span>);
<a name="l00803"></a>00803             <span class="keywordflow">return</span> 0;   <span class="comment">/* unconditional failure */</span>
<a name="l00804"></a>00804          }
<a name="l00805"></a>00805          <span class="keywordflow">for</span> (pattern++; pattern != end; pattern++) {
<a name="l00806"></a>00806             <span class="keywordflow">if</span> (pattern+2 &lt; end &amp;&amp; pattern[1] == <span class="charliteral">'-'</span>) { <span class="comment">/* this is a range */</span>
<a name="l00807"></a>00807                <span class="keywordflow">if</span> (*<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a> &gt;= pattern[0] &amp;&amp; *<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a> &lt;= pattern[2])
<a name="l00808"></a>00808                   <span class="keywordflow">break</span>;   <span class="comment">/* match found */</span>
<a name="l00809"></a>00809                <span class="keywordflow">else</span> {
<a name="l00810"></a>00810                   pattern += 2; <span class="comment">/* skip a total of 3 chars */</span>
<a name="l00811"></a>00811                   <span class="keywordflow">continue</span>;
<a name="l00812"></a>00812                }
<a name="l00813"></a>00813             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a> == pattern[0])
<a name="l00814"></a>00814                <span class="keywordflow">break</span>;   <span class="comment">/* match found */</span>
<a name="l00815"></a>00815          }
<a name="l00816"></a>00816          <span class="keywordflow">if</span> (pattern == end)
<a name="l00817"></a>00817             <span class="keywordflow">return</span> 0;
<a name="l00818"></a>00818          pattern = end; <span class="comment">/* skip and continue */</span>
<a name="l00819"></a>00819          <span class="keywordflow">break</span>;
<a name="l00820"></a>00820       <span class="keywordflow">case</span> <span class="charliteral">'N'</span>:
<a name="l00821"></a>00821          <span class="keywordflow">if</span> (*data &lt; '2' || *data &gt; <span class="charliteral">'9'</span>)
<a name="l00822"></a>00822             <span class="keywordflow">return</span> 0;
<a name="l00823"></a>00823          <span class="keywordflow">break</span>;
<a name="l00824"></a>00824       <span class="keywordflow">case</span> <span class="charliteral">'X'</span>:
<a name="l00825"></a>00825          <span class="keywordflow">if</span> (*data &lt; '0' || *data &gt; <span class="charliteral">'9'</span>)
<a name="l00826"></a>00826             <span class="keywordflow">return</span> 0;
<a name="l00827"></a>00827          <span class="keywordflow">break</span>;
<a name="l00828"></a>00828       <span class="keywordflow">case</span> <span class="charliteral">'Z'</span>:
<a name="l00829"></a>00829          <span class="keywordflow">if</span> (*data &lt; '1' || *data &gt; <span class="charliteral">'9'</span>)
<a name="l00830"></a>00830             <span class="keywordflow">return</span> 0;
<a name="l00831"></a>00831          <span class="keywordflow">break</span>;
<a name="l00832"></a>00832       <span class="keywordflow">case</span> <span class="charliteral">'.'</span>:   <span class="comment">/* Must match, even with more digits */</span>
<a name="l00833"></a>00833          <span class="keywordflow">return</span> 1;
<a name="l00834"></a>00834       <span class="keywordflow">case</span> <span class="charliteral">'!'</span>:   <span class="comment">/* Early match */</span>
<a name="l00835"></a>00835          <span class="keywordflow">return</span> 2;
<a name="l00836"></a>00836       <span class="keywordflow">case</span> <span class="charliteral">' '</span>:
<a name="l00837"></a>00837       <span class="keywordflow">case</span> <span class="charliteral">'-'</span>:   <span class="comment">/* Ignore these in patterns */</span>
<a name="l00838"></a>00838          <a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a>--; <span class="comment">/* compensate the final data++ */</span>
<a name="l00839"></a>00839          <span class="keywordflow">break</span>;
<a name="l00840"></a>00840       <span class="keywordflow">default</span>:
<a name="l00841"></a>00841          <span class="keywordflow">if</span> (*<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a> != *pattern)
<a name="l00842"></a>00842             <span class="keywordflow">return</span> 0;
<a name="l00843"></a>00843       }
<a name="l00844"></a>00844       <a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a>++;
<a name="l00845"></a>00845       pattern++;
<a name="l00846"></a>00846    }
<a name="l00847"></a>00847    <span class="keywordflow">if</span> (*<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a>)        <span class="comment">/* data longer than pattern, no match */</span>
<a name="l00848"></a>00848       <span class="keywordflow">return</span> 0;
<a name="l00849"></a>00849    <span class="comment">/*</span>
<a name="l00850"></a>00850 <span class="comment">    * match so far, but ran off the end of the data.</span>
<a name="l00851"></a>00851 <span class="comment">    * Depending on what is next, determine match or not.</span>
<a name="l00852"></a>00852 <span class="comment">    */</span>
<a name="l00853"></a>00853    <span class="keywordflow">if</span> (*pattern == <span class="charliteral">'\0'</span> || *pattern == <span class="charliteral">'/'</span>)  <span class="comment">/* exact match */</span>
<a name="l00854"></a>00854       <span class="keywordflow">return</span> (mode == <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824febb13020eaa30c314c1bff110026a7cd2">E_MATCHMORE</a>) ? 0 : 1;  <span class="comment">/* this is a failure for E_MATCHMORE */</span>
<a name="l00855"></a>00855    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*pattern == <span class="charliteral">'!'</span>)        <span class="comment">/* early match */</span>
<a name="l00856"></a>00856       <span class="keywordflow">return</span> 2;
<a name="l00857"></a>00857    <span class="keywordflow">else</span>                 <span class="comment">/* partial match */</span>
<a name="l00858"></a>00858       <span class="keywordflow">return</span> (mode == <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe437691af9bdd09d1ad4c2e5b087d5717">E_MATCH</a>) ? 0 : 1;   <span class="comment">/* this is a failure for E_MATCH */</span>
<a name="l00859"></a>00859 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2a729b6bbfa875032679e02260957526"></a><!-- doxytag: member="pbx.c::add_pri" ref="2a729b6bbfa875032679e02260957526" args="(struct ast_context *con, struct ast_exten *tmp, struct ast_exten *el, struct ast_exten *e, int replace)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int add_pri           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>tmp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>el</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>replace</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
add the extension in the priority chain. returns 0 on success, -1 on failure 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04681">4681</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l02076">ast_add_hint()</a>, <a class="el" href="pbx_8c-source.html#l02112">ast_change_hint()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="pbx_8c-source.html#l00127">ast_exten::data</a>, <a class="el" href="structast__exten.html#7c342dda03b7a7df3e7dc1603c4916d1">ast_exten::datad</a>, <a class="el" href="pbx_8c-source.html#l00119">ast_exten::exten</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="pbx_8c-source.html#l00131">ast_exten::next</a>, <a class="el" href="pbx_8c-source.html#l00129">ast_exten::peer</a>, <a class="el" href="pbx_8c-source.html#l00122">ast_exten::priority</a>, <a class="el" href="pbx_8h-source.html#l00044">PRIORITY_HINT</a>, and <a class="el" href="pbx_8c-source.html#l00167">ast_context::root</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04765">ast_add_extension2()</a>.<div class="fragment"><pre class="fragment"><a name="l04683"></a>04683 {
<a name="l04684"></a>04684    <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *ep;
<a name="l04685"></a>04685 
<a name="l04686"></a>04686    <span class="keywordflow">for</span> (ep = NULL; e ; ep = e, e = e-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a>) {
<a name="l04687"></a>04687       <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a> &gt;= tmp-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a>)
<a name="l04688"></a>04688          <span class="keywordflow">break</span>;
<a name="l04689"></a>04689    }
<a name="l04690"></a>04690    <span class="keywordflow">if</span> (!e) {   <span class="comment">/* go at the end, and ep is surely set because the list is not empty */</span>
<a name="l04691"></a>04691       ep-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a> = tmp;
<a name="l04692"></a>04692       <span class="keywordflow">return</span> 0;   <span class="comment">/* success */</span>
<a name="l04693"></a>04693    }
<a name="l04694"></a>04694    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a> == tmp-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a>) {
<a name="l04695"></a>04695       <span class="comment">/* Can't have something exactly the same.  Is this a</span>
<a name="l04696"></a>04696 <span class="comment">         replacement?  If so, replace, otherwise, bonk. */</span>
<a name="l04697"></a>04697       <span class="keywordflow">if</span> (!replace) {
<a name="l04698"></a>04698          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Unable to register extension '%s', priority %d in '%s', already in use\n"</span>, tmp-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>, tmp-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a>, con-&gt;name);
<a name="l04699"></a>04699          <span class="keywordflow">if</span> (tmp-&gt;<a class="code" href="structast__exten.html#7c342dda03b7a7df3e7dc1603c4916d1">datad</a>)
<a name="l04700"></a>04700             tmp-&gt;<a class="code" href="structast__exten.html#7c342dda03b7a7df3e7dc1603c4916d1">datad</a>(tmp-&gt;<a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l04701"></a>04701          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(tmp);
<a name="l04702"></a>04702          <span class="keywordflow">return</span> -1;
<a name="l04703"></a>04703       }
<a name="l04704"></a>04704       <span class="comment">/* we are replacing e, so copy the link fields and then update</span>
<a name="l04705"></a>04705 <span class="comment">       * whoever pointed to e to point to us</span>
<a name="l04706"></a>04706 <span class="comment">       */</span>
<a name="l04707"></a>04707       tmp-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = e-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>; <span class="comment">/* not meaningful if we are not first in the peer list */</span>
<a name="l04708"></a>04708       tmp-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a> = e-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a>; <span class="comment">/* always meaningful */</span>
<a name="l04709"></a>04709       <span class="keywordflow">if</span> (ep)        <span class="comment">/* We're in the peer list, just insert ourselves */</span>
<a name="l04710"></a>04710          ep-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a> = tmp;
<a name="l04711"></a>04711       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (el)      <span class="comment">/* We're the first extension. Take over e's functions */</span>
<a name="l04712"></a>04712          el-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = tmp;
<a name="l04713"></a>04713       <span class="keywordflow">else</span>        <span class="comment">/* We're the very first extension.  */</span>
<a name="l04714"></a>04714          con-&gt;<a class="code" href="structast__context.html#63a9f0ea7bb98050796b649e85481845">root</a> = tmp;
<a name="l04715"></a>04715       <span class="keywordflow">if</span> (tmp-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a> == <a class="code" href="pbx_8h.html#ab1e94ec9073ecc8bcedd7b11dd82001">PRIORITY_HINT</a>)
<a name="l04716"></a>04716          <a class="code" href="pbx_8c.html#89778ddb1deedf256115e0110daf3e19">ast_change_hint</a>(e,tmp);
<a name="l04717"></a>04717       <span class="comment">/* Destroy the old one */</span>
<a name="l04718"></a>04718       <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__exten.html#7c342dda03b7a7df3e7dc1603c4916d1">datad</a>)
<a name="l04719"></a>04719          e-&gt;<a class="code" href="structast__exten.html#7c342dda03b7a7df3e7dc1603c4916d1">datad</a>(e-&gt;<a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l04720"></a>04720       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(e);
<a name="l04721"></a>04721    } <span class="keywordflow">else</span> { <span class="comment">/* Slip ourselves in just before e */</span>
<a name="l04722"></a>04722       tmp-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a> = e;
<a name="l04723"></a>04723       tmp-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = e-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>; <span class="comment">/* extension chain, or NULL if e is not the first extension */</span>
<a name="l04724"></a>04724       <span class="keywordflow">if</span> (ep)        <span class="comment">/* Easy enough, we're just in the peer list */</span>
<a name="l04725"></a>04725          ep-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a> = tmp;
<a name="l04726"></a>04726       <span class="keywordflow">else</span> {         <span class="comment">/* we are the first in some peer list, so link in the ext list */</span>
<a name="l04727"></a>04727          <span class="keywordflow">if</span> (el)
<a name="l04728"></a>04728             el-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = tmp;   <span class="comment">/* in the middle... */</span>
<a name="l04729"></a>04729          <span class="keywordflow">else</span>
<a name="l04730"></a>04730             con-&gt;<a class="code" href="structast__context.html#63a9f0ea7bb98050796b649e85481845">root</a> = tmp; <span class="comment">/* ... or at the head */</span>
<a name="l04731"></a>04731          e-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = NULL;   <span class="comment">/* e is no more at the head, so e-&gt;next must be reset */</span>
<a name="l04732"></a>04732       }
<a name="l04733"></a>04733       <span class="comment">/* And immediately return success. */</span>
<a name="l04734"></a>04734       <span class="keywordflow">if</span> (tmp-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a> == <a class="code" href="pbx_8h.html#ab1e94ec9073ecc8bcedd7b11dd82001">PRIORITY_HINT</a>)
<a name="l04735"></a>04735           <a class="code" href="pbx_8c.html#b1882754d395928d10d8d94200dfffd1">ast_add_hint</a>(tmp);
<a name="l04736"></a>04736    }
<a name="l04737"></a>04737    <span class="keywordflow">return</span> 0;
<a name="l04738"></a>04738 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="12b93bee10e4fd5d30576d7a6877e12b"></a><!-- doxytag: member="pbx.c::ast_active_calls" ref="12b93bee10e4fd5d30576d7a6877e12b" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_active_calls           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Retrieve the number of active calls. 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02585">2585</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00252">countcalls</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l00452">handle_chanlist()</a>.<div class="fragment"><pre class="fragment"><a name="l02586"></a>02586 {
<a name="l02587"></a>02587    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#a3a9f90f51c55c02ddf6ad8e26249341">countcalls</a>;
<a name="l02588"></a>02588 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b77a5344eb4a1e2404c81a2a593deff5"></a><!-- doxytag: member="pbx.c::ast_add_extension" ref="b77a5344eb4a1e2404c81a2a593deff5" args="(const char *context, int replace, const char *extension, int priority, const char *label, const char *callerid, const char *application, void *data, void(*datad)(void *), const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_add_extension           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>replace</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>extension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>label</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>callerid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>application</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void(*)(void *)&nbsp;</td>
          <td class="mdname" nowrap> <em>datad</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add and extension to an extension context. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>context to add the extension to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>replace</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>extension</em>&nbsp;</td><td>extension to add </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>priority</em>&nbsp;</td><td>priority level of extension addition </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>label</em>&nbsp;</td><td>extension label </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callerid</em>&nbsp;</td><td>pattern to match CallerID, or NULL to match any CallerID </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>application</em>&nbsp;</td><td>application to run on the extension with that priority level </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>data to pass to the application </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>datad</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>registrar</em>&nbsp;</td><td>who registered the extension</td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04561">4561</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l04765">ast_add_extension2()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l00938">handle_context_add_extension()</a>, <a class="el" href="res__features_8c-source.html#l02439">park_add_hints()</a>, and <a class="el" href="chan__iax2_8c-source.html#l05647">register_peer_exten()</a>.<div class="fragment"><pre class="fragment"><a name="l04564"></a>04564 {
<a name="l04565"></a>04565    <span class="keywordtype">int</span> ret = -1;
<a name="l04566"></a>04566    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = <a class="code" href="pbx_8c.html#4669bd753e060c6bb15a0c63c4e3785a">find_context_locked</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l04567"></a>04567 
<a name="l04568"></a>04568    <span class="keywordflow">if</span> (c) {
<a name="l04569"></a>04569       ret = <a class="code" href="pbx_8c.html#0985a9a977ba8aa4f370da3a495437ae">ast_add_extension2</a>(c, replace, extension, priority, label, callerid,
<a name="l04570"></a>04570          application, data, datad, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l04571"></a>04571       <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l04572"></a>04572    }
<a name="l04573"></a>04573    <span class="keywordflow">return</span> ret;
<a name="l04574"></a>04574 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="0985a9a977ba8aa4f370da3a495437ae"></a><!-- doxytag: member="pbx.c::ast_add_extension2" ref="0985a9a977ba8aa4f370da3a495437ae" args="(struct ast_context *con, int replace, const char *extension, int priority, const char *label, const char *callerid, const char *application, void *data, void(*datad)(void *), const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_add_extension2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>replace</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>extension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>label</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>callerid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>application</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void(*)(void *)&nbsp;</td>
          <td class="mdname" nowrap> <em>datad</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add an extension to an extension context, this time with an <a class="el" href="structast__context.html">ast_context</a> *. 
<p>
We sort extensions in order of matching preference, so that we can stop the search as soon as we find a suitable match. This ordering also takes care of wildcards such as '.' (meaning "one or more of any character") and '!' (which is 'earlymatch', meaning "zero or more of any character" but also impacts the return value from CANMATCH and EARLYMATCH.<p>
The extension match rules defined in the devmeeting 2006.05.05 are quite simple: WE SELECT THE LONGEST MATCH. In detail, "longest" means the number of matched characters in the extension. In case of ties (e.g. _XXX and 333) in the length of a pattern, we give priority to entries with the smallest cardinality (e.g, [5-9] comes before [2-8] before the former has only 5 elements, while the latter has 7, etc. In case of same cardinality, the first element in the range counts. If we still have a tie, any final '!' will make this as a possibly less specific pattern.<p>
EBUSY - can't lock EEXIST - extension with the same priority exist and no replace is set 
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04765">4765</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l04681">add_pri()</a>, <a class="el" href="pbx_8c-source.html#l00125">ast_exten::app</a>, <a class="el" href="pbx_8c-source.html#l02076">ast_add_hint()</a>, <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="linkedlists_8h-source.html#l00385">AST_LIST_FIRST</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="lock_8h-source.html#l00642">ast_rwlock_rdlock()</a>, <a class="el" href="lock_8h-source.html#l00637">ast_rwlock_unlock()</a>, <a class="el" href="pbx_8c-source.html#l06092">ast_unlock_context()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="pbx_8c-source.html#l06082">ast_wrlock_context()</a>, <a class="el" href="pbx_8c-source.html#l00121">ast_exten::cidmatch</a>, <a class="el" href="pbx_8c-source.html#l00127">ast_exten::data</a>, <a class="el" href="structast__exten.html#7c342dda03b7a7df3e7dc1603c4916d1">ast_exten::datad</a>, <a class="el" href="asterisk_8c-source.html#l00199">el</a>, <a class="el" href="pbx_8c-source.html#l00716">ext_cmp()</a>, <a class="el" href="pbx_8c-source.html#l04655">ext_strncpy()</a>, <a class="el" href="pbx_8c-source.html#l00119">ast_exten::exten</a>, <a class="el" href="pbx_8c-source.html#l00123">ast_exten::label</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="pbx_8c-source.html#l00120">ast_exten::matchcid</a>, <a class="el" href="pbx_8c-source.html#l00131">ast_exten::next</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="pbx_8c-source.html#l00124">ast_exten::parent</a>, <a class="el" href="pbx_8c-source.html#l01665">pbx_substitute_variables_varshead()</a>, <a class="el" href="pbx_8c-source.html#l00122">ast_exten::priority</a>, <a class="el" href="pbx_8h-source.html#l00044">PRIORITY_HINT</a>, <a class="el" href="pbx_8c-source.html#l00130">ast_exten::registrar</a>, <a class="el" href="pbx_8c-source.html#l00167">ast_context::root</a>, <a class="el" href="pbx_8c-source.html#l00132">ast_exten::stuff</a>, <a class="el" href="pbx_8c-source.html#l00085">VAR_BUF_SIZE</a>, and <a class="el" href="logger_8h-source.html#l00045">VERBOSE_PREFIX_3</a>.
<p>
Referenced by <a class="el" href="pbx__ael_8c-source.html#l03652">add_extensions()</a>, <a class="el" href="pbx_8c-source.html#l04561">ast_add_extension()</a>, <a class="el" href="res__features_8c-source.html#l00342">ast_park_call()</a>, <a class="el" href="res__features_8c-source.html#l01761">do_parking_thread()</a>, <a class="el" href="res__features_8c-source.html#l02453">load_config()</a>, <a class="el" href="pbx__config_8c-source.html#l01332">pbx_load_config()</a>, <a class="el" href="pbx__config_8c-source.html#l01510">pbx_load_users()</a>, <a class="el" href="app__meetme_8c-source.html#l04662">sla_build_station()</a>, and <a class="el" href="app__meetme_8c-source.html#l04527">sla_build_trunk()</a>.<div class="fragment"><pre class="fragment"><a name="l04769"></a>04769 {
<a name="l04770"></a>04770    <span class="comment">/*</span>
<a name="l04771"></a>04771 <span class="comment">    * Sort extensions (or patterns) according to the rules indicated above.</span>
<a name="l04772"></a>04772 <span class="comment">    * These are implemented by the function ext_cmp()).</span>
<a name="l04773"></a>04773 <span class="comment">    * All priorities for the same ext/pattern/cid are kept in a list,</span>
<a name="l04774"></a>04774 <span class="comment">    * using the 'peer' field  as a link field..</span>
<a name="l04775"></a>04775 <span class="comment">    */</span>
<a name="l04776"></a>04776    <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *tmp, *e, *<a class="code" href="asterisk_8c.html#65c10911d8b8591219a21ebacf46da01">el</a> = NULL;
<a name="l04777"></a>04777    <span class="keywordtype">int</span> res;
<a name="l04778"></a>04778    <span class="keywordtype">int</span> length;
<a name="l04779"></a>04779    <span class="keywordtype">char</span> *p;
<a name="l04780"></a>04780    <span class="keywordtype">char</span> expand_buf[<a class="code" href="pbx_8c.html#970eeb66b59dcceec190d4d3147cb12f">VAR_BUF_SIZE</a>] = { 0, };
<a name="l04781"></a>04781 
<a name="l04782"></a>04782    <span class="comment">/* if we are adding a hint, and there are global variables, and the hint</span>
<a name="l04783"></a>04783 <span class="comment">      contains variable references, then expand them</span>
<a name="l04784"></a>04784 <span class="comment">   */</span>
<a name="l04785"></a>04785    <a class="code" href="lock_8h.html#f4b8158bcd471d4f28b380768e3ee073">ast_rwlock_rdlock</a>(&amp;globalslock);
<a name="l04786"></a>04786    <span class="keywordflow">if</span> (<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a> == <a class="code" href="pbx_8h.html#ab1e94ec9073ecc8bcedd7b11dd82001">PRIORITY_HINT</a> &amp;&amp; <a class="code" href="linkedlists_8h.html#e4deb7f32ef480cbc3b2e9b7e4ceff6c">AST_LIST_FIRST</a>(&amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>) &amp;&amp; strstr(application, <span class="stringliteral">"${"</span>)) {
<a name="l04787"></a>04787       <a class="code" href="pbx_8c.html#9c87adf1e75b8a9298ffc59378531172">pbx_substitute_variables_varshead</a>(&amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>, application, expand_buf, <span class="keyword">sizeof</span>(expand_buf));
<a name="l04788"></a>04788       application = expand_buf;
<a name="l04789"></a>04789    }
<a name="l04790"></a>04790    <a class="code" href="lock_8h.html#97ed909ef0a0582cf3870dd0629852c8">ast_rwlock_unlock</a>(&amp;globalslock);
<a name="l04791"></a>04791 
<a name="l04792"></a>04792    length = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a>);
<a name="l04793"></a>04793    length += strlen(extension) + 1;
<a name="l04794"></a>04794    length += strlen(application) + 1;
<a name="l04795"></a>04795    <span class="keywordflow">if</span> (<a class="code" href="structast__exten.html#d304ba20e96d87411588eeabac850e34">label</a>)
<a name="l04796"></a>04796       length += strlen(<a class="code" href="structast__exten.html#d304ba20e96d87411588eeabac850e34">label</a>) + 1;
<a name="l04797"></a>04797    <span class="keywordflow">if</span> (callerid)
<a name="l04798"></a>04798       length += strlen(callerid) + 1;
<a name="l04799"></a>04799    <span class="keywordflow">else</span>
<a name="l04800"></a>04800       length ++;  <span class="comment">/* just the '\0' */</span>
<a name="l04801"></a>04801 
<a name="l04802"></a>04802    <span class="comment">/* Be optimistic:  Build the extension structure first */</span>
<a name="l04803"></a>04803    <span class="keywordflow">if</span> (!(tmp = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, length)))
<a name="l04804"></a>04804       <span class="keywordflow">return</span> -1;
<a name="l04805"></a>04805 
<a name="l04806"></a>04806    <span class="comment">/* use p as dst in assignments, as the fields are const char * */</span>
<a name="l04807"></a>04807    p = tmp-&gt;<a class="code" href="structast__exten.html#3d111ff6c918c5cbdf2b3e843726ec71">stuff</a>;
<a name="l04808"></a>04808    <span class="keywordflow">if</span> (<a class="code" href="structast__exten.html#d304ba20e96d87411588eeabac850e34">label</a>) {
<a name="l04809"></a>04809       tmp-&gt;<a class="code" href="structast__exten.html#d304ba20e96d87411588eeabac850e34">label</a> = p;
<a name="l04810"></a>04810       strcpy(p, <a class="code" href="structast__exten.html#d304ba20e96d87411588eeabac850e34">label</a>);
<a name="l04811"></a>04811       p += strlen(<a class="code" href="structast__exten.html#d304ba20e96d87411588eeabac850e34">label</a>) + 1;
<a name="l04812"></a>04812    }
<a name="l04813"></a>04813    tmp-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a> = p;
<a name="l04814"></a>04814    p += <a class="code" href="pbx_8c.html#34cd75f9b635d6fb74649e8e456dcef9">ext_strncpy</a>(p, extension, strlen(extension) + 1) + 1;
<a name="l04815"></a>04815    tmp-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a> = <a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a>;
<a name="l04816"></a>04816    tmp-&gt;<a class="code" href="structast__exten.html#2ef4524f32df05033fd0502689de872e">cidmatch</a> = p;   <span class="comment">/* but use p for assignments below */</span>
<a name="l04817"></a>04817    <span class="keywordflow">if</span> (callerid) {
<a name="l04818"></a>04818       p += <a class="code" href="pbx_8c.html#34cd75f9b635d6fb74649e8e456dcef9">ext_strncpy</a>(p, callerid, strlen(callerid) + 1) + 1;
<a name="l04819"></a>04819       tmp-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a> = 1;
<a name="l04820"></a>04820    } <span class="keywordflow">else</span> {
<a name="l04821"></a>04821       *p++ = <span class="charliteral">'\0'</span>;
<a name="l04822"></a>04822       tmp-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a> = 0;
<a name="l04823"></a>04823    }
<a name="l04824"></a>04824    tmp-&gt;<a class="code" href="structast__exten.html#d2a57dc1d883fd21fb9951699df71cc7">app</a> = p;
<a name="l04825"></a>04825    strcpy(p, application);
<a name="l04826"></a>04826    tmp-&gt;<a class="code" href="structast__exten.html#d0e45878043844ffc41aac437e86b602">parent</a> = con;
<a name="l04827"></a>04827    tmp-&gt;<a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a> = <a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a>;
<a name="l04828"></a>04828    tmp-&gt;<a class="code" href="structast__exten.html#7c342dda03b7a7df3e7dc1603c4916d1">datad</a> = <a class="code" href="structast__exten.html#7c342dda03b7a7df3e7dc1603c4916d1">datad</a>;
<a name="l04829"></a>04829    tmp-&gt;<a class="code" href="structast__exten.html#5940569cd1d60781f856f93235b072ee">registrar</a> = <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>;
<a name="l04830"></a>04830 
<a name="l04831"></a>04831    <a class="code" href="pbx_8c.html#18884df37a7c36a24fd0b5f4225d1112">ast_wrlock_context</a>(con);
<a name="l04832"></a>04832    res = 0; <span class="comment">/* some compilers will think it is uninitialized otherwise */</span>
<a name="l04833"></a>04833    <span class="keywordflow">for</span> (e = con-&gt;<a class="code" href="structast__context.html#63a9f0ea7bb98050796b649e85481845">root</a>; e; el = e, e = e-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {   <span class="comment">/* scan the extension list */</span>
<a name="l04834"></a>04834       res = <a class="code" href="pbx_8c.html#fa125f786a7a85619f88c85292d5412f">ext_cmp</a>(e-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>, extension);
<a name="l04835"></a>04835       <span class="keywordflow">if</span> (res == 0) { <span class="comment">/* extension match, now look at cidmatch */</span>
<a name="l04836"></a>04836          <span class="keywordflow">if</span> (!e-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a> &amp;&amp; !tmp-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a>)
<a name="l04837"></a>04837             res = 0;
<a name="l04838"></a>04838          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tmp-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a> &amp;&amp; !e-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a>)
<a name="l04839"></a>04839             res = 1;
<a name="l04840"></a>04840          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a> &amp;&amp; !tmp-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a>)
<a name="l04841"></a>04841             res = -1;
<a name="l04842"></a>04842          <span class="keywordflow">else</span>
<a name="l04843"></a>04843             res = strcasecmp(e-&gt;<a class="code" href="structast__exten.html#2ef4524f32df05033fd0502689de872e">cidmatch</a>, tmp-&gt;<a class="code" href="structast__exten.html#2ef4524f32df05033fd0502689de872e">cidmatch</a>);
<a name="l04844"></a>04844       }
<a name="l04845"></a>04845       <span class="keywordflow">if</span> (res &gt;= 0)
<a name="l04846"></a>04846          <span class="keywordflow">break</span>;
<a name="l04847"></a>04847    }
<a name="l04848"></a>04848    <span class="keywordflow">if</span> (e &amp;&amp; res == 0) { <span class="comment">/* exact match, insert in the pri chain */</span>
<a name="l04849"></a>04849       res = <a class="code" href="pbx_8c.html#2a729b6bbfa875032679e02260957526">add_pri</a>(con, tmp, el, e, replace);
<a name="l04850"></a>04850       <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l04851"></a>04851       <span class="keywordflow">if</span> (res &lt; 0) {
<a name="l04852"></a>04852          errno = EEXIST;   <span class="comment">/* XXX do we care ? */</span>
<a name="l04853"></a>04853          <span class="keywordflow">return</span> 0; <span class="comment">/* XXX should we return -1 maybe ? */</span>
<a name="l04854"></a>04854       }
<a name="l04855"></a>04855    } <span class="keywordflow">else</span> {
<a name="l04856"></a>04856       <span class="comment">/*</span>
<a name="l04857"></a>04857 <span class="comment">       * not an exact match, this is the first entry with this pattern,</span>
<a name="l04858"></a>04858 <span class="comment">       * so insert in the main list right before 'e' (if any)</span>
<a name="l04859"></a>04859 <span class="comment">       */</span>
<a name="l04860"></a>04860       tmp-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = e;
<a name="l04861"></a>04861       <span class="keywordflow">if</span> (el)
<a name="l04862"></a>04862          el-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = tmp;
<a name="l04863"></a>04863       <span class="keywordflow">else</span>
<a name="l04864"></a>04864          con-&gt;<a class="code" href="structast__context.html#63a9f0ea7bb98050796b649e85481845">root</a> = tmp;
<a name="l04865"></a>04865       <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l04866"></a>04866       <span class="keywordflow">if</span> (tmp-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a> == <a class="code" href="pbx_8h.html#ab1e94ec9073ecc8bcedd7b11dd82001">PRIORITY_HINT</a>)
<a name="l04867"></a>04867          <a class="code" href="pbx_8c.html#b1882754d395928d10d8d94200dfffd1">ast_add_hint</a>(tmp);
<a name="l04868"></a>04868    }
<a name="l04869"></a>04869    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>) {
<a name="l04870"></a>04870       <span class="keywordflow">if</span> (tmp-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a>) {
<a name="l04871"></a>04871          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l04872"></a>04872             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Added extension '%s' priority %d (CID match '%s') to %s\n"</span>,
<a name="l04873"></a>04873                tmp-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>, tmp-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a>, tmp-&gt;<a class="code" href="structast__exten.html#2ef4524f32df05033fd0502689de872e">cidmatch</a>, con-&gt;name);
<a name="l04874"></a>04874       } <span class="keywordflow">else</span> {
<a name="l04875"></a>04875          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l04876"></a>04876             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Added extension '%s' priority %d to %s\n"</span>,
<a name="l04877"></a>04877                tmp-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>, tmp-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a>, con-&gt;name);
<a name="l04878"></a>04878       }
<a name="l04879"></a>04879    }
<a name="l04880"></a>04880    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 2) {
<a name="l04881"></a>04881       <span class="keywordflow">if</span> (tmp-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a>) {
<a name="l04882"></a>04882          <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>( <a class="code" href="logger_8h.html#aefd5a67b7464040f5352e4ecdc535ca">VERBOSE_PREFIX_3</a> <span class="stringliteral">"Added extension '%s' priority %d (CID match '%s')to %s\n"</span>,
<a name="l04883"></a>04883             tmp-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>, tmp-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a>, tmp-&gt;<a class="code" href="structast__exten.html#2ef4524f32df05033fd0502689de872e">cidmatch</a>, con-&gt;name);
<a name="l04884"></a>04884       } <span class="keywordflow">else</span> {
<a name="l04885"></a>04885          <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>( <a class="code" href="logger_8h.html#aefd5a67b7464040f5352e4ecdc535ca">VERBOSE_PREFIX_3</a> <span class="stringliteral">"Added extension '%s' priority %d to %s\n"</span>,
<a name="l04886"></a>04886             tmp-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>, tmp-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a>, con-&gt;name);
<a name="l04887"></a>04887       }
<a name="l04888"></a>04888    }
<a name="l04889"></a>04889    <span class="keywordflow">return</span> 0;
<a name="l04890"></a>04890 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b1882754d395928d10d8d94200dfffd1"></a><!-- doxytag: member="pbx.c::ast_add_hint" ref="b1882754d395928d10d8d94200dfffd1" args="(struct ast_exten *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int ast_add_hint           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
ast_add_hint: Add hint to hint list, check initial extension state 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02076">2076</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="pbx_8c-source.html#l01812">ast_extension_state2()</a>, <a class="el" href="pbx_8c-source.html#l06168">ast_get_extension_app()</a>, <a class="el" href="pbx_8c-source.html#l06110">ast_get_extension_name()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="linkedlists_8h-source.html#l00657">AST_RWLIST_INSERT_HEAD</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="pbx_8c-source.html#l00203">ast_hint::exten</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, and <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04681">add_pri()</a>, and <a class="el" href="pbx_8c-source.html#l04765">ast_add_extension2()</a>.<div class="fragment"><pre class="fragment"><a name="l02077"></a>02077 {
<a name="l02078"></a>02078    <span class="keyword">struct </span><a class="code" href="structast__hint.html">ast_hint</a> *hint;
<a name="l02079"></a>02079 
<a name="l02080"></a>02080    <span class="keywordflow">if</span> (!e)
<a name="l02081"></a>02081       <span class="keywordflow">return</span> -1;
<a name="l02082"></a>02082 
<a name="l02083"></a>02083    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;hints);
<a name="l02084"></a>02084 
<a name="l02085"></a>02085    <span class="comment">/* Search if hint exists, do nothing */</span>
<a name="l02086"></a>02086    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;hints, hint, list) {
<a name="l02087"></a>02087       <span class="keywordflow">if</span> (hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a> == e) {
<a name="l02088"></a>02088          <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l02089"></a>02089          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a> &gt; 1)
<a name="l02090"></a>02090             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"HINTS: Not re-adding existing hint %s: %s\n"</span>, <a class="code" href="pbx_8c.html#4318ec15d92ac47de94902f6aba4c114">ast_get_extension_name</a>(e), <a class="code" href="pbx_8c.html#c8eaa4fc248390fee258e7d2b2ff3490">ast_get_extension_app</a>(e));
<a name="l02091"></a>02091          <span class="keywordflow">return</span> -1;
<a name="l02092"></a>02092       }
<a name="l02093"></a>02093    }
<a name="l02094"></a>02094 
<a name="l02095"></a>02095    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a> &gt; 1)
<a name="l02096"></a>02096       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"HINTS: Adding hint %s: %s\n"</span>, <a class="code" href="pbx_8c.html#4318ec15d92ac47de94902f6aba4c114">ast_get_extension_name</a>(e), <a class="code" href="pbx_8c.html#c8eaa4fc248390fee258e7d2b2ff3490">ast_get_extension_app</a>(e));
<a name="l02097"></a>02097 
<a name="l02098"></a>02098    <span class="keywordflow">if</span> (!(hint = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*hint)))) {
<a name="l02099"></a>02099       <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l02100"></a>02100       <span class="keywordflow">return</span> -1;
<a name="l02101"></a>02101    }
<a name="l02102"></a>02102    <span class="comment">/* Initialize and insert new item at the top */</span>
<a name="l02103"></a>02103    hint-&gt;exten = e;
<a name="l02104"></a>02104    hint-&gt;laststate = <a class="code" href="pbx_8c.html#6aecfed8ee63e22940bc2d842f0a536c">ast_extension_state2</a>(e);
<a name="l02105"></a>02105    <a class="code" href="linkedlists_8h.html#b4592c522c6b3831f739508553316599">AST_RWLIST_INSERT_HEAD</a>(&amp;hints, hint, list);
<a name="l02106"></a>02106 
<a name="l02107"></a>02107    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l02108"></a>02108    <span class="keywordflow">return</span> 0;
<a name="l02109"></a>02109 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c9005802f33040d1cab7c4b3588b1b81"></a><!-- doxytag: member="pbx.c::AST_APP_OPTIONS" ref="c9005802f33040d1cab7c4b3588b1b81" args="(resetcdr_opts,{AST_APP_OPTION('w', AST_CDR_FLAG_POSTED), AST_APP_OPTION('a', AST_CDR_FLAG_LOCKED), AST_APP_OPTION('v', AST_CDR_FLAG_KEEP_VARS),})" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">AST_APP_OPTIONS           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">resetcdr_opts&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4c54d9fbb24b1a0a21a2c66428923224"></a><!-- doxytag: member="pbx.c::AST_APP_OPTIONS" ref="4c54d9fbb24b1a0a21a2c66428923224" args="(waitexten_opts,{AST_APP_OPTION_ARG('m', WAITEXTEN_MOH, 0),})" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">AST_APP_OPTIONS           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">waitexten_opts&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1436455fa6ff2a19f5bc8c20d6eab6c0"></a><!-- doxytag: member="pbx.c::AST_APP_OPTIONS" ref="1436455fa6ff2a19f5bc8c20d6eab6c0" args="(background_opts,{AST_APP_OPTION('s', BACKGROUND_SKIP), AST_APP_OPTION('n', BACKGROUND_NOANSWER), AST_APP_OPTION('m', BACKGROUND_MATCHEXTEN), AST_APP_OPTION('p', BACKGROUND_PLAYBACK),})" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">AST_APP_OPTIONS           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">background_opts&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="563b92a651459898f8ccfdc367746147"></a><!-- doxytag: member="pbx.c::ast_async_goto" ref="563b92a651459898f8ccfdc367746147" args="(struct ast_channel *chan, const char *context, const char *exten, int priority)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_async_goto           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04595">4595</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00435">ast_channel::_state</a>, <a class="el" href="channel_8h-source.html#l00450">ast_channel::amaflags</a>, <a class="el" href="cdr_8c-source.html#l00171">ast_cdr_dup()</a>, <a class="el" href="channel_8c-source.html#l00632">ast_channel_alloc()</a>, <a class="el" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>, <a class="el" href="channel_8c-source.html#l03270">ast_channel_masquerade()</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="channel_8c-source.html#l03406">ast_do_masquerade()</a>, <a class="el" href="pbx_8c-source.html#l04576">ast_explicit_goto()</a>, <a class="el" href="channel_8c-source.html#l01598">ast_hangup()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="pbx_8c-source.html#l02551">ast_pbx_start()</a>, <a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a179c1afce6cda266617f47d63393c2d71">AST_SOFTHANGUP_ASYNCGOTO</a>, <a class="el" href="channel_8c-source.html#l01442">ast_softhangup_nolock()</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, <a class="el" href="channel_8h-source.html#l00441">ast_channel::context</a>, <a class="el" href="channel_8h-source.html#l00442">ast_channel::exten</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="channel_8h-source.html#l00449">ast_channel::pbx</a>, <a class="el" href="channel_8h-source.html#l00477">ast_channel::readformat</a>, <a class="el" href="strings_8h-source.html#l00045">S_OR</a>, and <a class="el" href="channel_8h-source.html#l00478">ast_channel::writeformat</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l06258">__ast_goto_if_exists()</a>, <a class="el" href="manager_8c-source.html#l01726">action_redirect()</a>, <a class="el" href="pbx_8c-source.html#l04641">ast_async_goto_by_name()</a>, <a class="el" href="res__features_8c-source.html#l00673">builtin_blindtransfer()</a>, <a class="el" href="chan__oss_8c-source.html#l01339">console_transfer()</a>, <a class="el" href="chan__sip_8c-source.html#l15145">handle_request_bye()</a>, <a class="el" href="chan__misdn_8c-source.html#l02539">process_ast_dsp()</a>, and <a class="el" href="chan__zap_8c-source.html#l03875">zt_handle_dtmfup()</a>.<div class="fragment"><pre class="fragment"><a name="l04596"></a>04596 {
<a name="l04597"></a>04597    <span class="keywordtype">int</span> res = 0;
<a name="l04598"></a>04598 
<a name="l04599"></a>04599    <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l04600"></a>04600 
<a name="l04601"></a>04601    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#569f7a090087f9e7071a247a24ea0809">pbx</a>) { <span class="comment">/* This channel is currently in the PBX */</span>
<a name="l04602"></a>04602       <a class="code" href="pbx_8c.html#1e0079c7f2934dd7ebe801fefe4057da">ast_explicit_goto</a>(chan, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, priority);
<a name="l04603"></a>04603       <a class="code" href="channel_8c.html#c969f5294a61165c99c9b6f65ecae173">ast_softhangup_nolock</a>(chan, <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a179c1afce6cda266617f47d63393c2d71">AST_SOFTHANGUP_ASYNCGOTO</a>);
<a name="l04604"></a>04604    } <span class="keywordflow">else</span> {
<a name="l04605"></a>04605       <span class="comment">/* In order to do it when the channel doesn't really exist within</span>
<a name="l04606"></a>04606 <span class="comment">         the PBX, we have to make a new channel, masquerade, and start the PBX</span>
<a name="l04607"></a>04607 <span class="comment">         at the new location */</span>
<a name="l04608"></a>04608       <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *tmpchan = <a class="code" href="channel_8c.html#3e12df96f6a8fc8b7293ad03b29c729f">ast_channel_alloc</a>(0, chan-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a>, 0, 0, chan-&gt;accountcode, chan-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, chan-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, chan-&gt;<a class="code" href="structast__channel.html#d5aa4bb1461fe3d863bd95fb137e2284">amaflags</a>, <span class="stringliteral">"AsyncGoto/%s"</span>, chan-&gt;name);
<a name="l04609"></a>04609       <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>) {
<a name="l04610"></a>04610          tmpchan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a> = <a class="code" href="cdr_8c.html#8538ec9cb930d571cf367e372726d706">ast_cdr_dup</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>);
<a name="l04611"></a>04611       }
<a name="l04612"></a>04612       <span class="keywordflow">if</span> (!tmpchan)
<a name="l04613"></a>04613          res = -1;
<a name="l04614"></a>04614       <span class="keywordflow">else</span> {
<a name="l04615"></a>04615          <span class="comment">/* Make formats okay */</span>
<a name="l04616"></a>04616          tmpchan-&gt;<a class="code" href="structast__channel.html#c9d2702466074da94d21f26822247ed8">readformat</a> = chan-&gt;<a class="code" href="structast__channel.html#c9d2702466074da94d21f26822247ed8">readformat</a>;
<a name="l04617"></a>04617          tmpchan-&gt;<a class="code" href="structast__channel.html#45a38ca474a4f1df88fe13d68bbb0b44">writeformat</a> = chan-&gt;<a class="code" href="structast__channel.html#45a38ca474a4f1df88fe13d68bbb0b44">writeformat</a>;
<a name="l04618"></a>04618          <span class="comment">/* Setup proper location */</span>
<a name="l04619"></a>04619          <a class="code" href="pbx_8c.html#1e0079c7f2934dd7ebe801fefe4057da">ast_explicit_goto</a>(tmpchan,
<a name="l04620"></a>04620             <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, chan-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>), <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, chan-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>), <a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>);
<a name="l04621"></a>04621 
<a name="l04622"></a>04622          <span class="comment">/* Masquerade into temp channel */</span>
<a name="l04623"></a>04623          <a class="code" href="channel_8c.html#8e30c09190bd2388188cd8bab35ba595">ast_channel_masquerade</a>(tmpchan, chan);
<a name="l04624"></a>04624 
<a name="l04625"></a>04625          <span class="comment">/* Grab the locks and get going */</span>
<a name="l04626"></a>04626          <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(tmpchan);
<a name="l04627"></a>04627          <a class="code" href="channel_8c.html#f788595bd51a58be12bb3c3b28a950ec">ast_do_masquerade</a>(tmpchan);
<a name="l04628"></a>04628          <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(tmpchan);
<a name="l04629"></a>04629          <span class="comment">/* Start the PBX going on our stolen channel */</span>
<a name="l04630"></a>04630          <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#c55e82ff3dabed89efd77f20209b1006">ast_pbx_start</a>(tmpchan)) {
<a name="l04631"></a>04631             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Unable to start PBX on %s\n"</span>, tmpchan-&gt;name);
<a name="l04632"></a>04632             <a class="code" href="channel_8c.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a>(tmpchan);
<a name="l04633"></a>04633             res = -1;
<a name="l04634"></a>04634          }
<a name="l04635"></a>04635       }
<a name="l04636"></a>04636    }
<a name="l04637"></a>04637    <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l04638"></a>04638    <span class="keywordflow">return</span> res;
<a name="l04639"></a>04639 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b1007dfd72dec414ba71a3e5e00cf524"></a><!-- doxytag: member="pbx.c::ast_async_goto_by_name" ref="b1007dfd72dec414ba71a3e5e00cf524" args="(const char *channame, const char *context, const char *exten, int priority)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_async_goto_by_name           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>channame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04641">4641</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l04595">ast_async_goto()</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, and <a class="el" href="channel_8c-source.html#l00995">ast_get_channel_by_name_locked()</a>.<div class="fragment"><pre class="fragment"><a name="l04642"></a>04642 {
<a name="l04643"></a>04643    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>;
<a name="l04644"></a>04644    <span class="keywordtype">int</span> res = -1;
<a name="l04645"></a>04645 
<a name="l04646"></a>04646    chan = <a class="code" href="channel_8c.html#e01fecb172f34785571d94adbc5c6558">ast_get_channel_by_name_locked</a>(channame);
<a name="l04647"></a>04647    <span class="keywordflow">if</span> (chan) {
<a name="l04648"></a>04648       res = <a class="code" href="pbx_8c.html#563b92a651459898f8ccfdc367746147">ast_async_goto</a>(chan, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>);
<a name="l04649"></a>04649       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l04650"></a>04650    }
<a name="l04651"></a>04651    <span class="keywordflow">return</span> res;
<a name="l04652"></a>04652 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="26ff43c7d96ccf5b00248d0793ce93f5"></a><!-- doxytag: member="pbx.c::ast_async_goto_if_exists" ref="26ff43c7d96ccf5b00248d0793ce93f5" args="(struct ast_channel *chan, const char *context, const char *exten, int priority)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_async_goto_if_exists           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06282">6282</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06258">__ast_goto_if_exists()</a>.
<p>
Referenced by <a class="el" href="app__channelredirect_8c-source.html#l00052">asyncgoto_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l06283"></a>06283 {
<a name="l06284"></a>06284    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#ea67e0eddc31f7145c5c9c7991255636">__ast_goto_if_exists</a>(chan, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>, 1);
<a name="l06285"></a>06285 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b45b278cc04e70970e83433d6e9c60a8"></a><!-- doxytag: member="pbx.c::ast_build_timing" ref="b45b278cc04e70970e83433d6e9c60a8" args="(struct ast_timing *i, const char *info_in)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_build_timing           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__timing.html">ast_timing</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>info_in</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04236">4236</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="pbx_8c-source.html#l04207">days</a>, <a class="el" href="pbx_8c-source.html#l04076">get_range()</a>, <a class="el" href="pbx_8c-source.html#l04122">get_timerange()</a>, <a class="el" href="pbx_8c-source.html#l04219">months</a>, and <a class="el" href="strcompat_8c-source.html#l00035">strsep()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04304">ast_context_add_include2()</a>, <a class="el" href="func__logic_8c-source.html#l00059">iftime()</a>, <a class="el" href="pbx_8c-source.html#l05525">pbx_builtin_execiftime()</a>, and <a class="el" href="pbx_8c-source.html#l05499">pbx_builtin_gotoiftime()</a>.<div class="fragment"><pre class="fragment"><a name="l04237"></a>04237 {
<a name="l04238"></a>04238    <span class="keywordtype">char</span> info_save[256];
<a name="l04239"></a>04239    <span class="keywordtype">char</span> *info;
<a name="l04240"></a>04240 
<a name="l04241"></a>04241    <span class="comment">/* Check for empty just in case */</span>
<a name="l04242"></a>04242    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(info_in))
<a name="l04243"></a>04243       <span class="keywordflow">return</span> 0;
<a name="l04244"></a>04244    <span class="comment">/* make a copy just in case we were passed a static string */</span>
<a name="l04245"></a>04245    ast_copy_string(info_save, info_in, <span class="keyword">sizeof</span>(info_save));
<a name="l04246"></a>04246    info = info_save;
<a name="l04247"></a>04247    <span class="comment">/* Assume everything except time */</span>
<a name="l04248"></a>04248    i-&gt;<a class="code" href="structast__timing.html#172e0a07579e3432c1fd51e89212d053">monthmask</a> = 0xfff;   <span class="comment">/* 12 bits */</span>
<a name="l04249"></a>04249    i-&gt;<a class="code" href="structast__timing.html#8668879f841e75be72d8089c58da1084">daymask</a> = 0x7fffffffU; <span class="comment">/* 31 bits */</span>
<a name="l04250"></a>04250    i-&gt;<a class="code" href="structast__timing.html#6b1c01be5fdf58e2c3f68567c3e20479">dowmask</a> = 0x7f; <span class="comment">/* 7 bits */</span>
<a name="l04251"></a>04251    <span class="comment">/* on each call, use strsep() to move info to the next argument */</span>
<a name="l04252"></a>04252    <a class="code" href="pbx_8c.html#997d3ca719932cc6dbf54c26337a0b3c">get_timerange</a>(i, <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;info, <span class="stringliteral">"|"</span>));
<a name="l04253"></a>04253    <span class="keywordflow">if</span> (info)
<a name="l04254"></a>04254       i-&gt;<a class="code" href="structast__timing.html#6b1c01be5fdf58e2c3f68567c3e20479">dowmask</a> = <a class="code" href="pbx_8c.html#1d96b045db44a1d8881f22cd211d4099">get_range</a>(<a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;info, <span class="stringliteral">"|"</span>), 7, <a class="code" href="pbx_8c.html#b926d07cd15d8fd1bdf2ab377f30ee25">days</a>, <span class="stringliteral">"day of week"</span>);
<a name="l04255"></a>04255    <span class="keywordflow">if</span> (info)
<a name="l04256"></a>04256       i-&gt;<a class="code" href="structast__timing.html#8668879f841e75be72d8089c58da1084">daymask</a> = <a class="code" href="pbx_8c.html#1d96b045db44a1d8881f22cd211d4099">get_range</a>(<a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;info, <span class="stringliteral">"|"</span>), 31, NULL, <span class="stringliteral">"day"</span>);
<a name="l04257"></a>04257    <span class="keywordflow">if</span> (info)
<a name="l04258"></a>04258       i-&gt;<a class="code" href="structast__timing.html#172e0a07579e3432c1fd51e89212d053">monthmask</a> = <a class="code" href="pbx_8c.html#1d96b045db44a1d8881f22cd211d4099">get_range</a>(<a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;info, <span class="stringliteral">"|"</span>), 12, <a class="code" href="pbx_8c.html#aab8c6e8889bb80d928fd716f4406fe7">months</a>, <span class="stringliteral">"month"</span>);
<a name="l04259"></a>04259    <span class="keywordflow">return</span> 1;
<a name="l04260"></a>04260 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8cdcfc880eae31c1eaa91e154491b5bc"></a><!-- doxytag: member="pbx.c::ast_canmatch_extension" ref="8cdcfc880eae31c1eaa91e154491b5bc" args="(struct ast_channel *c, const char *context, const char *exten, int priority, const char *callerid)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_canmatch_extension           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>callerid</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Looks for a valid matching extension. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>not really important </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>context to serach within </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>exten</em>&nbsp;</td><td>extension to check </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>priority</em>&nbsp;</td><td>priority of extension path </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callerid</em>&nbsp;</td><td>callerid of extension being searched for</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>If "exten" *could be* a valid extension in this context with or without some more digits, return non-zero. Basically, when this returns 0, no matter what you add to exten, it's not going to be a valid extension anymore </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02198">2198</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fee9684886238bd81a61f3358030326178">E_CANMATCH</a>, and <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>.
<p>
Referenced by <a class="el" href="app__talkdetect_8c-source.html#l00063">background_detect_exec()</a>, <a class="el" href="chan__iax2_8c-source.html#l06220">dp_lookup()</a>, <a class="el" href="pbx__dundi_8c-source.html#l00532">dundi_lookup_local()</a>, <a class="el" href="chan__sip_8c-source.html#l09533">get_also_info()</a>, <a class="el" href="chan__sip_8c-source.html#l09207">get_destination()</a>, <a class="el" href="app__rpt_8c-source.html#l03406">handle_link_data()</a>, <a class="el" href="app__rpt_8c-source.html#l03557">handle_link_phone_dtmf()</a>, <a class="el" href="pbx__loopback_8c-source.html#l00133">loopback_canmatch()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02638">mgcp_ss()</a>, <a class="el" href="chan__phone_8c-source.html#l00939">phone_check_exception()</a>, <a class="el" href="chan__skinny_8c-source.html#l02365">skinny_ss()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, and <a class="el" href="app__queue_8c-source.html#l01320">valid_exit()</a>.<div class="fragment"><pre class="fragment"><a name="l02199"></a>02199 {
<a name="l02200"></a>02200    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#2377c7b979811bdd54ebf819e5d2037b">pbx_extension_helper</a>(c, NULL, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>, NULL, callerid, <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fee9684886238bd81a61f3358030326178">E_CANMATCH</a>);
<a name="l02201"></a>02201 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="89778ddb1deedf256115e0110daf3e19"></a><!-- doxytag: member="pbx.c::ast_change_hint" ref="89778ddb1deedf256115e0110daf3e19" args="(struct ast_exten *oe, struct ast_exten *ne)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int ast_change_hint           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>oe</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ne</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
ast_change_hint: Change hint for an extension 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02112">2112</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, and <a class="el" href="pbx_8c-source.html#l00203">ast_hint::exten</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04681">add_pri()</a>.<div class="fragment"><pre class="fragment"><a name="l02113"></a>02113 {
<a name="l02114"></a>02114    <span class="keyword">struct </span><a class="code" href="structast__hint.html">ast_hint</a> *hint;
<a name="l02115"></a>02115    <span class="keywordtype">int</span> res = -1;
<a name="l02116"></a>02116 
<a name="l02117"></a>02117    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;hints);
<a name="l02118"></a>02118    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;hints, hint, list) {
<a name="l02119"></a>02119       <span class="keywordflow">if</span> (hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a> == oe) {
<a name="l02120"></a>02120             hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a> = ne;
<a name="l02121"></a>02121          res = 0;
<a name="l02122"></a>02122          <span class="keywordflow">break</span>;
<a name="l02123"></a>02123       }
<a name="l02124"></a>02124    }
<a name="l02125"></a>02125    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l02126"></a>02126 
<a name="l02127"></a>02127    <span class="keywordflow">return</span> res;
<a name="l02128"></a>02128 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4dee27d639900ebea4f8b3c0366a197f"></a><!-- doxytag: member="pbx.c::ast_check_timing" ref="4dee27d639900ebea4f8b3c0366a197f" args="(const struct ast_timing *i)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_check_timing           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const struct <a class="el" href="structast__timing.html">ast_timing</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>i</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04262">4262</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="pbx_8h-source.html#l00101">ast_timing::daymask</a>, <a class="el" href="pbx_8h-source.html#l00102">ast_timing::dowmask</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="pbx_8h-source.html#l00103">ast_timing::minmask</a>, and <a class="el" href="pbx_8h-source.html#l00100">ast_timing::monthmask</a>.
<p>
Referenced by <a class="el" href="func__logic_8c-source.html#l00059">iftime()</a>, <a class="el" href="pbx_8c-source.html#l00575">include_valid()</a>, <a class="el" href="pbx_8c-source.html#l05525">pbx_builtin_execiftime()</a>, and <a class="el" href="pbx_8c-source.html#l05499">pbx_builtin_gotoiftime()</a>.<div class="fragment"><pre class="fragment"><a name="l04263"></a>04263 {
<a name="l04264"></a>04264    <span class="keyword">struct </span>tm tm;
<a name="l04265"></a>04265    time_t t = time(NULL);
<a name="l04266"></a>04266 
<a name="l04267"></a>04267    localtime_r(&amp;t,&amp;tm);
<a name="l04268"></a>04268 
<a name="l04269"></a>04269    <span class="comment">/* If it's not the right month, return */</span>
<a name="l04270"></a>04270    <span class="keywordflow">if</span> (!(i-&gt;<a class="code" href="structast__timing.html#172e0a07579e3432c1fd51e89212d053">monthmask</a> &amp; (1 &lt;&lt; tm.tm_mon)))
<a name="l04271"></a>04271       <span class="keywordflow">return</span> 0;
<a name="l04272"></a>04272 
<a name="l04273"></a>04273    <span class="comment">/* If it's not that time of the month.... */</span>
<a name="l04274"></a>04274    <span class="comment">/* Warning, tm_mday has range 1..31! */</span>
<a name="l04275"></a>04275    <span class="keywordflow">if</span> (!(i-&gt;<a class="code" href="structast__timing.html#8668879f841e75be72d8089c58da1084">daymask</a> &amp; (1 &lt;&lt; (tm.tm_mday-1))))
<a name="l04276"></a>04276       <span class="keywordflow">return</span> 0;
<a name="l04277"></a>04277 
<a name="l04278"></a>04278    <span class="comment">/* If it's not the right day of the week */</span>
<a name="l04279"></a>04279    <span class="keywordflow">if</span> (!(i-&gt;<a class="code" href="structast__timing.html#6b1c01be5fdf58e2c3f68567c3e20479">dowmask</a> &amp; (1 &lt;&lt; tm.tm_wday)))
<a name="l04280"></a>04280       <span class="keywordflow">return</span> 0;
<a name="l04281"></a>04281 
<a name="l04282"></a>04282    <span class="comment">/* Sanity check the hour just to be safe */</span>
<a name="l04283"></a>04283    <span class="keywordflow">if</span> ((tm.tm_hour &lt; 0) || (tm.tm_hour &gt; 23)) {
<a name="l04284"></a>04284       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Insane time...\n"</span>);
<a name="l04285"></a>04285       <span class="keywordflow">return</span> 0;
<a name="l04286"></a>04286    }
<a name="l04287"></a>04287 
<a name="l04288"></a>04288    <span class="comment">/* Now the tough part, we calculate if it fits</span>
<a name="l04289"></a>04289 <span class="comment">      in the right time based on min/hour */</span>
<a name="l04290"></a>04290    <span class="keywordflow">if</span> (!(i-&gt;<a class="code" href="structast__timing.html#abad86ac50409185e19bcfa94e974d51">minmask</a>[tm.tm_hour] &amp; (1 &lt;&lt; (tm.tm_min / 2))))
<a name="l04291"></a>04291       <span class="keywordflow">return</span> 0;
<a name="l04292"></a>04292 
<a name="l04293"></a>04293    <span class="comment">/* If we got this far, then we're good */</span>
<a name="l04294"></a>04294    <span class="keywordflow">return</span> 1;
<a name="l04295"></a>04295 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="00091c0d2706ab2a3132189402df5c48"></a><!-- doxytag: member="pbx.c::ast_context_add_ignorepat" ref="00091c0d2706ab2a3132189402df5c48" args="(const char *context, const char *value, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_add_ignorepat           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>ignorepat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add an ignorepat. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>which context to add the ignorpattern to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ignorepat</em>&nbsp;</td><td>ignorepattern to set up for the extension </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>registrar</em>&nbsp;</td><td>registrar of the ignore pattern</td></tr>
  </table>
</dl>
Adds an ignore pattern to a particular context.<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04497">4497</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l04509">ast_context_add_ignorepat2()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01065">handle_context_add_ignorepat()</a>.<div class="fragment"><pre class="fragment"><a name="l04498"></a>04498 {
<a name="l04499"></a>04499    <span class="keywordtype">int</span> ret = -1;
<a name="l04500"></a>04500    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = <a class="code" href="pbx_8c.html#4669bd753e060c6bb15a0c63c4e3785a">find_context_locked</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l04501"></a>04501 
<a name="l04502"></a>04502    <span class="keywordflow">if</span> (c) {
<a name="l04503"></a>04503       ret = <a class="code" href="pbx_8c.html#8837e61e90b56e79023e89ddb6b26fb1">ast_context_add_ignorepat2</a>(c, value, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l04504"></a>04504       <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l04505"></a>04505    }
<a name="l04506"></a>04506    <span class="keywordflow">return</span> ret;
<a name="l04507"></a>04507 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8837e61e90b56e79023e89ddb6b26fb1"></a><!-- doxytag: member="pbx.c::ast_context_add_ignorepat2" ref="8837e61e90b56e79023e89ddb6b26fb1" args="(struct ast_context *con, const char *value, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_add_ignorepat2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04509">4509</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="pbx_8c-source.html#l06092">ast_unlock_context()</a>, <a class="el" href="pbx_8c-source.html#l06082">ast_wrlock_context()</a>, <a class="el" href="pbx_8c-source.html#l00170">ast_context::ignorepats</a>, <a class="el" href="pbx_8c-source.html#l00160">ast_ignorepat::next</a>, <a class="el" href="pbx_8c-source.html#l00161">ast_ignorepat::pattern</a>, and <a class="el" href="pbx_8c-source.html#l00159">ast_ignorepat::registrar</a>.
<p>
Referenced by <a class="el" href="pbx__ael_8c-source.html#l03836">ast_compile_ael2()</a>, <a class="el" href="pbx_8c-source.html#l04497">ast_context_add_ignorepat()</a>, and <a class="el" href="pbx__config_8c-source.html#l01332">pbx_load_config()</a>.<div class="fragment"><pre class="fragment"><a name="l04510"></a>04510 {
<a name="l04511"></a>04511    <span class="keyword">struct </span><a class="code" href="structast__ignorepat.html">ast_ignorepat</a> *ignorepat, *ignorepatc, *ignorepatl = NULL;
<a name="l04512"></a>04512    <span class="keywordtype">int</span> length;
<a name="l04513"></a>04513    length = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structast__ignorepat.html">ast_ignorepat</a>);
<a name="l04514"></a>04514    length += strlen(value) + 1;
<a name="l04515"></a>04515    <span class="keywordflow">if</span> (!(ignorepat = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, length)))
<a name="l04516"></a>04516       <span class="keywordflow">return</span> -1;
<a name="l04517"></a>04517    <span class="comment">/* The cast to char * is because we need to write the initial value.</span>
<a name="l04518"></a>04518 <span class="comment">    * The field is not supposed to be modified otherwise</span>
<a name="l04519"></a>04519 <span class="comment">    */</span>
<a name="l04520"></a>04520    strcpy((<span class="keywordtype">char</span> *)ignorepat-&gt;<a class="code" href="structast__ignorepat.html#6ed092b904da0ceba9109608322e7880">pattern</a>, value);
<a name="l04521"></a>04521    ignorepat-&gt;<a class="code" href="structast__ignorepat.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = NULL;
<a name="l04522"></a>04522    ignorepat-&gt;<a class="code" href="structast__ignorepat.html#5940569cd1d60781f856f93235b072ee">registrar</a> = <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>;
<a name="l04523"></a>04523    <a class="code" href="pbx_8c.html#18884df37a7c36a24fd0b5f4225d1112">ast_wrlock_context</a>(con);
<a name="l04524"></a>04524    <span class="keywordflow">for</span> (ignorepatc = con-&gt;<a class="code" href="structast__context.html#79a69e07731e7d02c0f52f19bab94dcb">ignorepats</a>; ignorepatc; ignorepatc = ignorepatc-&gt;<a class="code" href="structast__ignorepat.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l04525"></a>04525       ignorepatl = ignorepatc;
<a name="l04526"></a>04526       <span class="keywordflow">if</span> (!strcasecmp(ignorepatc-&gt;<a class="code" href="structast__ignorepat.html#6ed092b904da0ceba9109608322e7880">pattern</a>, value)) {
<a name="l04527"></a>04527          <span class="comment">/* Already there */</span>
<a name="l04528"></a>04528          <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l04529"></a>04529          errno = EEXIST;
<a name="l04530"></a>04530          <span class="keywordflow">return</span> -1;
<a name="l04531"></a>04531       }
<a name="l04532"></a>04532    }
<a name="l04533"></a>04533    <span class="keywordflow">if</span> (ignorepatl)
<a name="l04534"></a>04534       ignorepatl-&gt;<a class="code" href="structast__ignorepat.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = ignorepat;
<a name="l04535"></a>04535    <span class="keywordflow">else</span>
<a name="l04536"></a>04536       con-&gt;<a class="code" href="structast__context.html#79a69e07731e7d02c0f52f19bab94dcb">ignorepats</a> = ignorepat;
<a name="l04537"></a>04537    <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l04538"></a>04538    <span class="keywordflow">return</span> 0;
<a name="l04539"></a>04539 
<a name="l04540"></a>04540 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ccdd98c0e8816634393437aad7cc5e01"></a><!-- doxytag: member="pbx.c::ast_context_add_include" ref="ccdd98c0e8816634393437aad7cc5e01" args="(const char *context, const char *include, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_add_include           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>include</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add a context include. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>context to add include to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>include</em>&nbsp;</td><td>new include to add </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>registrar</em>&nbsp;</td><td>who's registering it</td></tr>
  </table>
</dl>
Adds an include taking a char * string as the context parameter<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on error </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04042">4042</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l04304">ast_context_add_include2()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l00574">handle_context_add_include()</a>.<div class="fragment"><pre class="fragment"><a name="l04043"></a>04043 {
<a name="l04044"></a>04044    <span class="keywordtype">int</span> ret = -1;
<a name="l04045"></a>04045    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = <a class="code" href="pbx_8c.html#4669bd753e060c6bb15a0c63c4e3785a">find_context_locked</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l04046"></a>04046 
<a name="l04047"></a>04047    <span class="keywordflow">if</span> (c) {
<a name="l04048"></a>04048       ret = <a class="code" href="pbx_8c.html#b594e19215ace51bec1a5726a0801d07">ast_context_add_include2</a>(c, include, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l04049"></a>04049       <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l04050"></a>04050    }
<a name="l04051"></a>04051    <span class="keywordflow">return</span> ret;
<a name="l04052"></a>04052 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b594e19215ace51bec1a5726a0801d07"></a><!-- doxytag: member="pbx.c::ast_context_add_include2" ref="b594e19215ace51bec1a5726a0801d07" args="(struct ast_context *con, const char *value, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_add_include2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>include</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add a context include. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>con</em>&nbsp;</td><td>context to add the include to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>include</em>&nbsp;</td><td>include to add </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>registrar</em>&nbsp;</td><td>who registered the context</td></tr>
  </table>
</dl>
Adds an include taking a struct <a class="el" href="structast__context.html">ast_context</a> as the first parameter<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04304">4304</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l04236">ast_build_timing()</a>, <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="pbx_8c-source.html#l06100">ast_get_context_name()</a>, <a class="el" href="pbx_8c-source.html#l06092">ast_unlock_context()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="pbx_8c-source.html#l06082">ast_wrlock_context()</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="pbx_8c-source.html#l00140">ast_include::hastime</a>, <a class="el" href="pbx_8c-source.html#l00169">ast_context::includes</a>, <a class="el" href="pbx_8c-source.html#l00137">ast_include::name</a>, <a class="el" href="pbx_8c-source.html#l00142">ast_include::next</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="pbx_8c-source.html#l00139">ast_include::registrar</a>, <a class="el" href="pbx_8c-source.html#l00138">ast_include::rname</a>, <a class="el" href="pbx_8c-source.html#l00143">ast_include::stuff</a>, <a class="el" href="pbx_8c-source.html#l00141">ast_include::timing</a>, and <a class="el" href="logger_8h-source.html#l00045">VERBOSE_PREFIX_3</a>.
<p>
Referenced by <a class="el" href="pbx__ael_8c-source.html#l03836">ast_compile_ael2()</a>, <a class="el" href="pbx_8c-source.html#l04042">ast_context_add_include()</a>, and <a class="el" href="pbx__config_8c-source.html#l01332">pbx_load_config()</a>.<div class="fragment"><pre class="fragment"><a name="l04306"></a>04306 {
<a name="l04307"></a>04307    <span class="keyword">struct </span><a class="code" href="structast__include.html">ast_include</a> *new_include;
<a name="l04308"></a>04308    <span class="keywordtype">char</span> *c;
<a name="l04309"></a>04309    <span class="keyword">struct </span><a class="code" href="structast__include.html">ast_include</a> *i, *il = NULL; <span class="comment">/* include, include_last */</span>
<a name="l04310"></a>04310    <span class="keywordtype">int</span> length;
<a name="l04311"></a>04311    <span class="keywordtype">char</span> *p;
<a name="l04312"></a>04312 
<a name="l04313"></a>04313    length = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structast__include.html">ast_include</a>);
<a name="l04314"></a>04314    length += 2 * (strlen(value) + 1);
<a name="l04315"></a>04315 
<a name="l04316"></a>04316    <span class="comment">/* allocate new include structure ... */</span>
<a name="l04317"></a>04317    <span class="keywordflow">if</span> (!(new_include = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, length)))
<a name="l04318"></a>04318       <span class="keywordflow">return</span> -1;
<a name="l04319"></a>04319    <span class="comment">/* Fill in this structure. Use 'p' for assignments, as the fields</span>
<a name="l04320"></a>04320 <span class="comment">    * in the structure are 'const char *'</span>
<a name="l04321"></a>04321 <span class="comment">    */</span>
<a name="l04322"></a>04322    p = new_include-&gt;<a class="code" href="structast__include.html#3d111ff6c918c5cbdf2b3e843726ec71">stuff</a>;
<a name="l04323"></a>04323    new_include-&gt;<a class="code" href="structast__include.html#b068931cc450442b63f5b3d276ea4297">name</a> = p;
<a name="l04324"></a>04324    strcpy(p, value);
<a name="l04325"></a>04325    p += strlen(value) + 1;
<a name="l04326"></a>04326    new_include-&gt;<a class="code" href="structast__include.html#c626d8954194dd0136691c301dcf7ece">rname</a> = p;
<a name="l04327"></a>04327    strcpy(p, value);
<a name="l04328"></a>04328    <span class="comment">/* Strip off timing info, and process if it is there */</span>
<a name="l04329"></a>04329    <span class="keywordflow">if</span> ( (c = strchr(p, <span class="charliteral">'|'</span>)) ) {
<a name="l04330"></a>04330       *c++ = <span class="charliteral">'\0'</span>;
<a name="l04331"></a>04331            new_include-&gt;<a class="code" href="structast__include.html#afa6dfc2de3a5a43456abec2b5972ab0">hastime</a> = <a class="code" href="pbx_8c.html#b45b278cc04e70970e83433d6e9c60a8">ast_build_timing</a>(&amp;(new_include-&gt;<a class="code" href="structast__include.html#4ad8aa3a3571ea912a6ec5ea5fdcc93c">timing</a>), c);
<a name="l04332"></a>04332    }
<a name="l04333"></a>04333    new_include-&gt;<a class="code" href="structast__include.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>      = NULL;
<a name="l04334"></a>04334    new_include-&gt;<a class="code" href="structast__include.html#5940569cd1d60781f856f93235b072ee">registrar</a> = <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>;
<a name="l04335"></a>04335 
<a name="l04336"></a>04336    <a class="code" href="pbx_8c.html#18884df37a7c36a24fd0b5f4225d1112">ast_wrlock_context</a>(con);
<a name="l04337"></a>04337 
<a name="l04338"></a>04338    <span class="comment">/* ... go to last include and check if context is already included too... */</span>
<a name="l04339"></a>04339    <span class="keywordflow">for</span> (i = con-&gt;<a class="code" href="structast__context.html#bb2b21ef7774df8687ff02b0284505c6">includes</a>; i; i = i-&gt;<a class="code" href="structast__include.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l04340"></a>04340       <span class="keywordflow">if</span> (!strcasecmp(i-&gt;<a class="code" href="structast__include.html#b068931cc450442b63f5b3d276ea4297">name</a>, new_include-&gt;<a class="code" href="structast__include.html#b068931cc450442b63f5b3d276ea4297">name</a>)) {
<a name="l04341"></a>04341          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(new_include);
<a name="l04342"></a>04342          <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l04343"></a>04343          errno = EEXIST;
<a name="l04344"></a>04344          <span class="keywordflow">return</span> -1;
<a name="l04345"></a>04345       }
<a name="l04346"></a>04346       il = i;
<a name="l04347"></a>04347    }
<a name="l04348"></a>04348 
<a name="l04349"></a>04349    <span class="comment">/* ... include new context into context list, unlock, return */</span>
<a name="l04350"></a>04350    <span class="keywordflow">if</span> (il)
<a name="l04351"></a>04351       il-&gt;<a class="code" href="structast__include.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = new_include;
<a name="l04352"></a>04352    <span class="keywordflow">else</span>
<a name="l04353"></a>04353       con-&gt;<a class="code" href="structast__context.html#bb2b21ef7774df8687ff02b0284505c6">includes</a> = new_include;
<a name="l04354"></a>04354    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 2)
<a name="l04355"></a>04355       <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#aefd5a67b7464040f5352e4ecdc535ca">VERBOSE_PREFIX_3</a> <span class="stringliteral">"Including context '%s' in context '%s'\n"</span>, new_include-&gt;<a class="code" href="structast__include.html#b068931cc450442b63f5b3d276ea4297">name</a>, <a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(con));
<a name="l04356"></a>04356 
<a name="l04357"></a>04357    <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l04358"></a>04358 
<a name="l04359"></a>04359    <span class="keywordflow">return</span> 0;
<a name="l04360"></a>04360 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="afa734254246b0a5d03b045767bf645c"></a><!-- doxytag: member="pbx.c::ast_context_add_switch" ref="afa734254246b0a5d03b045767bf645c" args="(const char *context, const char *sw, const char *data, int eval, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_add_switch           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>sw</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>eval</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add a switch. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>context to which to add the switch </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sw</em>&nbsp;</td><td>switch to add </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>data to pass to switch </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>eval</em>&nbsp;</td><td>whether to evaluate variables when running switch </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>registrar</em>&nbsp;</td><td>whoever registered the switch</td></tr>
  </table>
</dl>
This function registers a switch with the asterisk switch architecture<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04367">4367</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l04386">ast_context_add_switch2()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>.<div class="fragment"><pre class="fragment"><a name="l04368"></a>04368 {
<a name="l04369"></a>04369    <span class="keywordtype">int</span> ret = -1;
<a name="l04370"></a>04370    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = <a class="code" href="pbx_8c.html#4669bd753e060c6bb15a0c63c4e3785a">find_context_locked</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l04371"></a>04371 
<a name="l04372"></a>04372    <span class="keywordflow">if</span> (c) { <span class="comment">/* found, add switch to this context */</span>
<a name="l04373"></a>04373       ret = <a class="code" href="pbx_8c.html#6fae5ece5f5f729b48d4a8e0bd73b642">ast_context_add_switch2</a>(c, sw, data, eval, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l04374"></a>04374       <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l04375"></a>04375    }
<a name="l04376"></a>04376    <span class="keywordflow">return</span> ret;
<a name="l04377"></a>04377 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6fae5ece5f5f729b48d4a8e0bd73b642"></a><!-- doxytag: member="pbx.c::ast_context_add_switch2" ref="6fae5ece5f5f729b48d4a8e0bd73b642" args="(struct ast_context *con, const char *value, const char *data, int eval, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_add_switch2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>sw</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>eval</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Adds a switch (first param is a <a class="el" href="structast__context.html">ast_context</a>). 
<p>
<dl compact><dt><b>Note:</b></dt><dd>See <a class="el" href="pbx_8c.html#afa734254246b0a5d03b045767bf645c">ast_context_add_switch()</a> for argument information, with the exception of the first argument. In this case, it's a pointer to an <a class="el" href="structast__context.html">ast_context</a> structure as opposed to the name. </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04386">4386</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="pbx_8c-source.html#l06100">ast_get_context_name()</a>, <a class="el" href="linkedlists_8h-source.html#l00670">AST_LIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="pbx_8c-source.html#l06092">ast_unlock_context()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="pbx_8c-source.html#l06082">ast_wrlock_context()</a>, <a class="el" href="pbx_8c-source.html#l00150">ast_sw::data</a>, <a class="el" href="pbx_8c-source.html#l00151">ast_sw::eval</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="pbx_8c-source.html#l00148">ast_sw::name</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="pbx_8c-source.html#l00149">ast_sw::registrar</a>, <a class="el" href="pbx_8c-source.html#l00083">SWITCH_DATA_LENGTH</a>, and <a class="el" href="logger_8h-source.html#l00045">VERBOSE_PREFIX_3</a>.
<p>
Referenced by <a class="el" href="pbx__ael_8c-source.html#l03836">ast_compile_ael2()</a>, <a class="el" href="pbx_8c-source.html#l04367">ast_context_add_switch()</a>, and <a class="el" href="pbx__config_8c-source.html#l01332">pbx_load_config()</a>.<div class="fragment"><pre class="fragment"><a name="l04388"></a>04388 {
<a name="l04389"></a>04389    <span class="keyword">struct </span><a class="code" href="structast__sw.html">ast_sw</a> *new_sw;
<a name="l04390"></a>04390    <span class="keyword">struct </span><a class="code" href="structast__sw.html">ast_sw</a> *i;
<a name="l04391"></a>04391    <span class="keywordtype">int</span> length;
<a name="l04392"></a>04392    <span class="keywordtype">char</span> *p;
<a name="l04393"></a>04393 
<a name="l04394"></a>04394    length = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structast__sw.html">ast_sw</a>);
<a name="l04395"></a>04395    length += strlen(value) + 1;
<a name="l04396"></a>04396    <span class="keywordflow">if</span> (<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>)
<a name="l04397"></a>04397       length += strlen(<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l04398"></a>04398    length++;
<a name="l04399"></a>04399    <span class="keywordflow">if</span> (<a class="code" href="structast__sw.html#2eed1fe0db36d674643b5f84d2adf46e">eval</a>) {
<a name="l04400"></a>04400       <span class="comment">/* Create buffer for evaluation of variables */</span>
<a name="l04401"></a>04401       length += <a class="code" href="pbx_8c.html#27dc176701e9014e219fe586c4f546e5">SWITCH_DATA_LENGTH</a>;
<a name="l04402"></a>04402       length++;
<a name="l04403"></a>04403    }
<a name="l04404"></a>04404 
<a name="l04405"></a>04405    <span class="comment">/* allocate new sw structure ... */</span>
<a name="l04406"></a>04406    <span class="keywordflow">if</span> (!(new_sw = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, length)))
<a name="l04407"></a>04407       <span class="keywordflow">return</span> -1;
<a name="l04408"></a>04408    <span class="comment">/* ... fill in this structure ... */</span>
<a name="l04409"></a>04409    p = new_sw-&gt;stuff;
<a name="l04410"></a>04410    new_sw-&gt;<a class="code" href="structast__sw.html#b068931cc450442b63f5b3d276ea4297">name</a> = p;
<a name="l04411"></a>04411    strcpy(new_sw-&gt;<a class="code" href="structast__sw.html#b068931cc450442b63f5b3d276ea4297">name</a>, value);
<a name="l04412"></a>04412    p += strlen(value) + 1;
<a name="l04413"></a>04413    new_sw-&gt;<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a> = p;
<a name="l04414"></a>04414    <span class="keywordflow">if</span> (<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>) {
<a name="l04415"></a>04415       strcpy(new_sw-&gt;<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>, <a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l04416"></a>04416       p += strlen(<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>) + 1;
<a name="l04417"></a>04417    } <span class="keywordflow">else</span> {
<a name="l04418"></a>04418       strcpy(new_sw-&gt;<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>, <span class="stringliteral">""</span>);
<a name="l04419"></a>04419       p++;
<a name="l04420"></a>04420    }
<a name="l04421"></a>04421    <span class="keywordflow">if</span> (<a class="code" href="structast__sw.html#2eed1fe0db36d674643b5f84d2adf46e">eval</a>)
<a name="l04422"></a>04422       new_sw-&gt;tmpdata = p;
<a name="l04423"></a>04423    new_sw-&gt;<a class="code" href="structast__sw.html#2eed1fe0db36d674643b5f84d2adf46e">eval</a>     = <a class="code" href="structast__sw.html#2eed1fe0db36d674643b5f84d2adf46e">eval</a>;
<a name="l04424"></a>04424    new_sw-&gt;<a class="code" href="structast__sw.html#5940569cd1d60781f856f93235b072ee">registrar</a> = <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>;
<a name="l04425"></a>04425 
<a name="l04426"></a>04426    <span class="comment">/* ... try to lock this context ... */</span>
<a name="l04427"></a>04427    <a class="code" href="pbx_8c.html#18884df37a7c36a24fd0b5f4225d1112">ast_wrlock_context</a>(con);
<a name="l04428"></a>04428 
<a name="l04429"></a>04429    <span class="comment">/* ... go to last sw and check if context is already swd too... */</span>
<a name="l04430"></a>04430    <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;con-&gt;alts, i, list) {
<a name="l04431"></a>04431       <span class="keywordflow">if</span> (!strcasecmp(i-&gt;<a class="code" href="structast__sw.html#b068931cc450442b63f5b3d276ea4297">name</a>, new_sw-&gt;<a class="code" href="structast__sw.html#b068931cc450442b63f5b3d276ea4297">name</a>) &amp;&amp; !strcasecmp(i-&gt;<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>, new_sw-&gt;<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>)) {
<a name="l04432"></a>04432          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(new_sw);
<a name="l04433"></a>04433          <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l04434"></a>04434          errno = EEXIST;
<a name="l04435"></a>04435          <span class="keywordflow">return</span> -1;
<a name="l04436"></a>04436       }
<a name="l04437"></a>04437    }
<a name="l04438"></a>04438 
<a name="l04439"></a>04439    <span class="comment">/* ... sw new context into context list, unlock, return */</span>
<a name="l04440"></a>04440    <a class="code" href="linkedlists_8h.html#8de6ce8a3b9d59e7e7fddee6b62b32a7">AST_LIST_INSERT_TAIL</a>(&amp;con-&gt;alts, new_sw, list);
<a name="l04441"></a>04441 
<a name="l04442"></a>04442    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 2)
<a name="l04443"></a>04443       <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#aefd5a67b7464040f5352e4ecdc535ca">VERBOSE_PREFIX_3</a> <span class="stringliteral">"Including switch '%s/%s' in context '%s'\n"</span>, new_sw-&gt;<a class="code" href="structast__sw.html#b068931cc450442b63f5b3d276ea4297">name</a>, new_sw-&gt;<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>, <a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(con));
<a name="l04444"></a>04444 
<a name="l04445"></a>04445    <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l04446"></a>04446 
<a name="l04447"></a>04447    <span class="keywordflow">return</span> 0;
<a name="l04448"></a>04448 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="9b7261abb02956903bb17c5bf8af265a"></a><!-- doxytag: member="pbx.c::ast_context_create" ref="9b7261abb02956903bb17c5bf8af265a" args="(struct ast_context **extcontexts, const char *name, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a>* ast_context_create           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>extcontexts</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Register a new context. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>extcontexts</em>&nbsp;</td><td>pointer to the <a class="el" href="structast__context.html">ast_context</a> structure pointer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>name of the new context </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>registrar</em>&nbsp;</td><td>registrar of the context</td></tr>
  </table>
</dl>
This will first search for a context with your name. If it exists already, it will not create a new one. If it does not exist, it will create a new one with the given name and registrar.<p>
<dl compact><dt><b>Returns:</b></dt><dd>NULL on failure, and an <a class="el" href="structast__context.html">ast_context</a> structure on success </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03913">3913</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l03870">__ast_context_create()</a>.
<p>
Referenced by <a class="el" href="pbx__ael_8c-source.html#l03836">ast_compile_ael2()</a>, <a class="el" href="res__features_8c-source.html#l00342">ast_park_call()</a>, <a class="el" href="res__features_8c-source.html#l01761">do_parking_thread()</a>, <a class="el" href="res__features_8c-source.html#l02453">load_config()</a>, and <a class="el" href="chan__sip_8c-source.html#l17179">reload_config()</a>.<div class="fragment"><pre class="fragment"><a name="l03914"></a>03914 {
<a name="l03915"></a>03915    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#04aa8a1856d1ec89ebff7bd112b037eb">__ast_context_create</a>(extcontexts, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>, 0);
<a name="l03916"></a>03916 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ac0d672d0448b82e3b3eac25b400d4d2"></a><!-- doxytag: member="pbx.c::ast_context_destroy" ref="ac0d672d0448b82e3b3eac25b400d4d2" args="(struct ast_context *con, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_context_destroy           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Destroy a context (matches the specified context (or ANY context if NULL). 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>con</em>&nbsp;</td><td>context to destroy </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>registrar</em>&nbsp;</td><td>who registered it</td></tr>
  </table>
</dl>
You can optionally leave out either parameter. It will find it based on either the <a class="el" href="structast__context.html">ast_context</a> or the registrar name.<p>
<dl compact><dt><b>Returns:</b></dt><dd>nothing </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05344">5344</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l05285">__ast_context_destroy()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l06064">ast_wrlock_contexts()</a>.
<p>
Referenced by <a class="el" href="chan__sip_8c-source.html#l10548">cleanup_stale_contexts()</a>, and <a class="el" href="pbx__ael_8c-source.html#l04125">unload_module()</a>.<div class="fragment"><pre class="fragment"><a name="l05345"></a>05345 {
<a name="l05346"></a>05346    <a class="code" href="pbx_8c.html#6f41efd0c2fa84486ef11fef33681139">ast_wrlock_contexts</a>();
<a name="l05347"></a>05347    <a class="code" href="pbx_8c.html#e2faf43e79194dd93e6200a86f08d563">__ast_context_destroy</a>(con,<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l05348"></a>05348    <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l05349"></a>05349 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="f8c5b4e7d06b7aff72707b5d7d7c94e1"></a><!-- doxytag: member="pbx.c::ast_context_find" ref="f8c5b4e7d06b7aff72707b5d7d7c94e1" args="(const char *name)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a>* ast_context_find           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>name</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Find a context. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>name of the context to find</td></tr>
  </table>
</dl>
Will search for the context with the given name.<p>
<dl compact><dt><b>Returns:</b></dt><dd>the <a class="el" href="structast__context.html">ast_context</a> on success, NULL on failure. </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00889">889</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06069">ast_rdlock_contexts()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l06196">ast_walk_contexts()</a>.
<p>
Referenced by <a class="el" href="app__macro_8c-source.html#l00144">_macro_exec()</a>, <a class="el" href="pbx_8c-source.html#l06243">ast_context_verify_includes()</a>, <a class="el" href="pbx_8c-source.html#l04542">ast_ignore_pattern()</a>, <a class="el" href="res__features_8c-source.html#l00342">ast_park_call()</a>, <a class="el" href="chan__sip_8c-source.html#l10548">cleanup_stale_contexts()</a>, <a class="el" href="res__features_8c-source.html#l01761">do_parking_thread()</a>, <a class="el" href="res__features_8c-source.html#l02453">load_config()</a>, <a class="el" href="chan__sip_8c-source.html#l02646">register_peer_exten()</a>, and <a class="el" href="chan__sip_8c-source.html#l17179">reload_config()</a>.<div class="fragment"><pre class="fragment"><a name="l00890"></a>00890 {
<a name="l00891"></a>00891    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *tmp = NULL;
<a name="l00892"></a>00892    <a class="code" href="pbx_8c.html#1b60f4b570102084989c86fd02ca6536">ast_rdlock_contexts</a>();
<a name="l00893"></a>00893    <span class="keywordflow">while</span> ( (tmp = <a class="code" href="pbx_8c.html#709c9b64f2da1eaace237db32a5e1445">ast_walk_contexts</a>(tmp)) ) {
<a name="l00894"></a>00894       <span class="keywordflow">if</span> (!<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a> || !strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, tmp-&gt;name))
<a name="l00895"></a>00895          <span class="keywordflow">break</span>;
<a name="l00896"></a>00896    }
<a name="l00897"></a>00897    <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l00898"></a>00898    <span class="keywordflow">return</span> tmp;
<a name="l00899"></a>00899 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="773dc5d298a6de227dfddae824e996d7"></a><!-- doxytag: member="pbx.c::ast_context_find_or_create" ref="773dc5d298a6de227dfddae824e996d7" args="(struct ast_context **extcontexts, const char *name, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a>* ast_context_find_or_create           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>extcontexts</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Register a new context or find an existing one. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>extcontexts</em>&nbsp;</td><td>pointer to the <a class="el" href="structast__context.html">ast_context</a> structure pointer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>name of the new context </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>registrar</em>&nbsp;</td><td>registrar of the context</td></tr>
  </table>
</dl>
This will first search for a context with your name. If it exists already, it will not create a new one. If it does not exist, it will create a new one with the given name and registrar.<p>
<dl compact><dt><b>Returns:</b></dt><dd>NULL on failure, and an <a class="el" href="structast__context.html">ast_context</a> structure on success </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03918">3918</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l03870">__ast_context_create()</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01332">pbx_load_config()</a>, <a class="el" href="pbx__config_8c-source.html#l01510">pbx_load_users()</a>, <a class="el" href="app__meetme_8c-source.html#l04662">sla_build_station()</a>, and <a class="el" href="app__meetme_8c-source.html#l04527">sla_build_trunk()</a>.<div class="fragment"><pre class="fragment"><a name="l03919"></a>03919 {
<a name="l03920"></a>03920    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#04aa8a1856d1ec89ebff7bd112b037eb">__ast_context_create</a>(extcontexts, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>, 1);
<a name="l03921"></a>03921 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="cf90385c0515753c76020cd48fe98c05"></a><!-- doxytag: member="pbx.c::ast_context_lockmacro" ref="cf90385c0515753c76020cd48fe98c05" args="(const char *context)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_lockmacro           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>context</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
locks the macrolock in the given given context 
<p>
<dl compact><dt><b>Note:</b></dt><dd>This function locks contexts list by &amp;conlist, searches for the right context structure, and locks the macrolock mutex in that context. macrolock is used to limit a macro to be executed by one call at a time. </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02823">2823</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06100">ast_get_context_name()</a>, <a class="el" href="lock_8h-source.html#l00530">ast_mutex_lock()</a>, <a class="el" href="pbx_8c-source.html#l06069">ast_rdlock_contexts()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l06196">ast_walk_contexts()</a>.
<p>
Referenced by <a class="el" href="app__macro_8c-source.html#l00144">_macro_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l02824"></a>02824 {
<a name="l02825"></a>02825    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = NULL;
<a name="l02826"></a>02826    <span class="keywordtype">int</span> ret = -1;
<a name="l02827"></a>02827 
<a name="l02828"></a>02828    <a class="code" href="pbx_8c.html#1b60f4b570102084989c86fd02ca6536">ast_rdlock_contexts</a>();
<a name="l02829"></a>02829 
<a name="l02830"></a>02830    <span class="keywordflow">while</span> ((c = <a class="code" href="pbx_8c.html#709c9b64f2da1eaace237db32a5e1445">ast_walk_contexts</a>(c))) {
<a name="l02831"></a>02831       <span class="keywordflow">if</span> (!strcmp(<a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(c), <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>)) {
<a name="l02832"></a>02832          ret = 0;
<a name="l02833"></a>02833          <span class="keywordflow">break</span>;
<a name="l02834"></a>02834       }
<a name="l02835"></a>02835    }
<a name="l02836"></a>02836 
<a name="l02837"></a>02837    <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l02838"></a>02838 
<a name="l02839"></a>02839    <span class="comment">/* if we found context, lock macrolock */</span>
<a name="l02840"></a>02840    <span class="keywordflow">if</span> (ret == 0) 
<a name="l02841"></a>02841       ret = <a class="code" href="lock_8h.html#b3c5e3093b325167f88db93c8b4b2421">ast_mutex_lock</a>(&amp;c-&gt;macrolock);
<a name="l02842"></a>02842 
<a name="l02843"></a>02843    <span class="keywordflow">return</span> ret;
<a name="l02844"></a>02844 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ed70bf6c908a1c70415454997c0d7902"></a><!-- doxytag: member="pbx.c::ast_context_remove_extension" ref="ed70bf6c908a1c70415454997c0d7902" args="(const char *context, const char *extension, int priority, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_remove_extension           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>extension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Simply remove extension from context. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>context to remove extension from </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>extension</em>&nbsp;</td><td>which extension to remove </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>priority</em>&nbsp;</td><td>priority of extension to remove </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>registrar</em>&nbsp;</td><td>registrar of the extension</td></tr>
  </table>
</dl>
This function removes an extension from a given context.<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02724">2724</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l02746">ast_context_remove_extension2()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>.
<p>
Referenced by <a class="el" href="app__meetme_8c-source.html#l04461">destroy_station()</a>, <a class="el" href="app__meetme_8c-source.html#l04447">destroy_trunk()</a>, <a class="el" href="pbx__config_8c-source.html#l00335">handle_context_remove_extension()</a>, and <a class="el" href="chan__iax2_8c-source.html#l05647">register_peer_exten()</a>.<div class="fragment"><pre class="fragment"><a name="l02725"></a>02725 {
<a name="l02726"></a>02726    <span class="keywordtype">int</span> ret = -1; <span class="comment">/* default error return */</span>
<a name="l02727"></a>02727    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = <a class="code" href="pbx_8c.html#4669bd753e060c6bb15a0c63c4e3785a">find_context_locked</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l02728"></a>02728 
<a name="l02729"></a>02729    <span class="keywordflow">if</span> (c) { <span class="comment">/* ... remove extension ... */</span>
<a name="l02730"></a>02730       ret = <a class="code" href="pbx_8c.html#c1d85c0d2ff75a7c476fa8379affd931">ast_context_remove_extension2</a>(c, extension, priority, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l02731"></a>02731       <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l02732"></a>02732    }
<a name="l02733"></a>02733    <span class="keywordflow">return</span> ret;
<a name="l02734"></a>02734 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c1d85c0d2ff75a7c476fa8379affd931"></a><!-- doxytag: member="pbx.c::ast_context_remove_extension2" ref="c1d85c0d2ff75a7c476fa8379affd931" args="(struct ast_context *con, const char *extension, int priority, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_remove_extension2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>extension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This functionc locks given context, search for the right extension and fires out all peer in this extensions with given priority. If priority is set to 0, all peers are removed. After that, unlock context and return. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>When do you want to call this function, make sure that &amp;conlock is locked, because some process can handle with your *con context before you lock it. </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02746">2746</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06092">ast_unlock_context()</a>, <a class="el" href="pbx_8c-source.html#l06082">ast_wrlock_context()</a>, <a class="el" href="pbx_8c-source.html#l02521">destroy_exten()</a>, <a class="el" href="chan__alsa_8c-source.html#l00126">exten</a>, <a class="el" href="pbx_8c-source.html#l00119">ast_exten::exten</a>, <a class="el" href="pbx_8c-source.html#l00131">ast_exten::next</a>, <a class="el" href="pbx_8c-source.html#l00129">ast_exten::peer</a>, <a class="el" href="pbx_8c-source.html#l00122">ast_exten::priority</a>, <a class="el" href="pbx_8c-source.html#l00130">ast_exten::registrar</a>, and <a class="el" href="pbx_8c-source.html#l00167">ast_context::root</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02724">ast_context_remove_extension()</a>, <a class="el" href="res__features_8c-source.html#l01761">do_parking_thread()</a>, and <a class="el" href="res__features_8c-source.html#l02453">load_config()</a>.<div class="fragment"><pre class="fragment"><a name="l02747"></a>02747 {
<a name="l02748"></a>02748    <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, *prev_exten = NULL;
<a name="l02749"></a>02749    <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a>;
<a name="l02750"></a>02750 
<a name="l02751"></a>02751    <a class="code" href="pbx_8c.html#18884df37a7c36a24fd0b5f4225d1112">ast_wrlock_context</a>(con);
<a name="l02752"></a>02752 
<a name="l02753"></a>02753    <span class="comment">/* scan the extension list to find matching extension-registrar */</span>
<a name="l02754"></a>02754    <span class="keywordflow">for</span> (exten = con-&gt;<a class="code" href="structast__context.html#63a9f0ea7bb98050796b649e85481845">root</a>; exten; prev_exten = exten, exten = exten-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l02755"></a>02755       <span class="keywordflow">if</span> (!strcmp(exten-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>, extension) &amp;&amp;
<a name="l02756"></a>02756          (!<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a> || !strcmp(exten-&gt;<a class="code" href="structast__exten.html#5940569cd1d60781f856f93235b072ee">registrar</a>, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)))
<a name="l02757"></a>02757          <span class="keywordflow">break</span>;
<a name="l02758"></a>02758    }
<a name="l02759"></a>02759    <span class="keywordflow">if</span> (!exten) {
<a name="l02760"></a>02760       <span class="comment">/* we can't find right extension */</span>
<a name="l02761"></a>02761       <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l02762"></a>02762       <span class="keywordflow">return</span> -1;
<a name="l02763"></a>02763    }
<a name="l02764"></a>02764 
<a name="l02765"></a>02765    <span class="comment">/* should we free all peers in this extension? (priority == 0)? */</span>
<a name="l02766"></a>02766    <span class="keywordflow">if</span> (<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a> == 0) {
<a name="l02767"></a>02767       <span class="comment">/* remove this extension from context list */</span>
<a name="l02768"></a>02768       <span class="keywordflow">if</span> (prev_exten)
<a name="l02769"></a>02769          prev_exten-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = exten-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l02770"></a>02770       <span class="keywordflow">else</span>
<a name="l02771"></a>02771          con-&gt;<a class="code" href="structast__context.html#63a9f0ea7bb98050796b649e85481845">root</a> = exten-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l02772"></a>02772 
<a name="l02773"></a>02773       <span class="comment">/* fire out all peers */</span>
<a name="l02774"></a>02774       <span class="keywordflow">while</span> ( (peer = exten) ) {
<a name="l02775"></a>02775          exten = peer-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a>; <span class="comment">/* prepare for next entry */</span>
<a name="l02776"></a>02776          <a class="code" href="pbx_8c.html#c7a22bae87915c24108c7304264b78c8">destroy_exten</a>(peer);
<a name="l02777"></a>02777       }
<a name="l02778"></a>02778    } <span class="keywordflow">else</span> {
<a name="l02779"></a>02779       <span class="comment">/* scan the priority list to remove extension with exten-&gt;priority == priority */</span>
<a name="l02780"></a>02780       <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *previous_peer = NULL;
<a name="l02781"></a>02781 
<a name="l02782"></a>02782       <span class="keywordflow">for</span> (peer = exten; peer; previous_peer = peer, peer = peer-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a>) {
<a name="l02783"></a>02783          <span class="keywordflow">if</span> (peer-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a> == <a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a> &amp;&amp;
<a name="l02784"></a>02784                (!<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a> || !strcmp(peer-&gt;<a class="code" href="structast__exten.html#5940569cd1d60781f856f93235b072ee">registrar</a>, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>) ))
<a name="l02785"></a>02785             <span class="keywordflow">break</span>; <span class="comment">/* found our priority */</span>
<a name="l02786"></a>02786       }
<a name="l02787"></a>02787       <span class="keywordflow">if</span> (!peer) { <span class="comment">/* not found */</span>
<a name="l02788"></a>02788          <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l02789"></a>02789          <span class="keywordflow">return</span> -1;
<a name="l02790"></a>02790       }
<a name="l02791"></a>02791       <span class="comment">/* we are first priority extension? */</span>
<a name="l02792"></a>02792       <span class="keywordflow">if</span> (!previous_peer) {
<a name="l02793"></a>02793          <span class="comment">/*</span>
<a name="l02794"></a>02794 <span class="comment">          * We are first in the priority chain, so must update the extension chain.</span>
<a name="l02795"></a>02795 <span class="comment">          * The next node is either the next priority or the next extension</span>
<a name="l02796"></a>02796 <span class="comment">          */</span>
<a name="l02797"></a>02797          <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *next_node = peer-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a> ? peer-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a> : peer-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l02798"></a>02798 
<a name="l02799"></a>02799          <span class="keywordflow">if</span> (!prev_exten)  <span class="comment">/* change the root... */</span>
<a name="l02800"></a>02800             con-&gt;<a class="code" href="structast__context.html#63a9f0ea7bb98050796b649e85481845">root</a> = next_node;
<a name="l02801"></a>02801          <span class="keywordflow">else</span>
<a name="l02802"></a>02802             prev_exten-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = next_node; <span class="comment">/* unlink */</span>
<a name="l02803"></a>02803          <span class="keywordflow">if</span> (peer-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a>)   <span class="comment">/* XXX update the new head of the pri list */</span>
<a name="l02804"></a>02804             peer-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a>-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = peer-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l02805"></a>02805       } <span class="keywordflow">else</span> { <span class="comment">/* easy, we are not first priority in extension */</span>
<a name="l02806"></a>02806          previous_peer-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a> = peer-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a>;
<a name="l02807"></a>02807       }
<a name="l02808"></a>02808 
<a name="l02809"></a>02809       <span class="comment">/* now, free whole priority extension */</span>
<a name="l02810"></a>02810       <a class="code" href="pbx_8c.html#c7a22bae87915c24108c7304264b78c8">destroy_exten</a>(peer);
<a name="l02811"></a>02811       <span class="comment">/* XXX should we return -1 ? */</span>
<a name="l02812"></a>02812    }
<a name="l02813"></a>02813    <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l02814"></a>02814    <span class="keywordflow">return</span> 0;
<a name="l02815"></a>02815 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="041875d3b92a3d0f748b8a0203e042a0"></a><!-- doxytag: member="pbx.c::ast_context_remove_ignorepat" ref="041875d3b92a3d0f748b8a0203e042a0" args="(const char *context, const char *ignorepat, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_remove_ignorepat           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>ignorepat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04454">4454</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l04466">ast_context_remove_ignorepat2()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01153">handle_context_remove_ignorepat()</a>.<div class="fragment"><pre class="fragment"><a name="l04455"></a>04455 {
<a name="l04456"></a>04456    <span class="keywordtype">int</span> ret = -1;
<a name="l04457"></a>04457    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = <a class="code" href="pbx_8c.html#4669bd753e060c6bb15a0c63c4e3785a">find_context_locked</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l04458"></a>04458 
<a name="l04459"></a>04459    <span class="keywordflow">if</span> (c) {
<a name="l04460"></a>04460       ret = <a class="code" href="pbx_8c.html#ad389cee2e8dda09b52d35340ddd294b">ast_context_remove_ignorepat2</a>(c, ignorepat, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l04461"></a>04461       <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l04462"></a>04462    }
<a name="l04463"></a>04463    <span class="keywordflow">return</span> ret;
<a name="l04464"></a>04464 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ad389cee2e8dda09b52d35340ddd294b"></a><!-- doxytag: member="pbx.c::ast_context_remove_ignorepat2" ref="ad389cee2e8dda09b52d35340ddd294b" args="(struct ast_context *con, const char *ignorepat, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_remove_ignorepat2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>ignorepat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04466">4466</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06092">ast_unlock_context()</a>, <a class="el" href="pbx_8c-source.html#l06082">ast_wrlock_context()</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="pbx_8c-source.html#l00170">ast_context::ignorepats</a>, <a class="el" href="pbx_8c-source.html#l00160">ast_ignorepat::next</a>, <a class="el" href="pbx_8c-source.html#l00161">ast_ignorepat::pattern</a>, and <a class="el" href="pbx_8c-source.html#l00159">ast_ignorepat::registrar</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04454">ast_context_remove_ignorepat()</a>.<div class="fragment"><pre class="fragment"><a name="l04467"></a>04467 {
<a name="l04468"></a>04468    <span class="keyword">struct </span><a class="code" href="structast__ignorepat.html">ast_ignorepat</a> *ip, *ipl = NULL;
<a name="l04469"></a>04469 
<a name="l04470"></a>04470    <a class="code" href="pbx_8c.html#18884df37a7c36a24fd0b5f4225d1112">ast_wrlock_context</a>(con);
<a name="l04471"></a>04471 
<a name="l04472"></a>04472    <span class="keywordflow">for</span> (ip = con-&gt;<a class="code" href="structast__context.html#79a69e07731e7d02c0f52f19bab94dcb">ignorepats</a>; ip; ip = ip-&gt;<a class="code" href="structast__ignorepat.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l04473"></a>04473       <span class="keywordflow">if</span> (!strcmp(ip-&gt;<a class="code" href="structast__ignorepat.html#6ed092b904da0ceba9109608322e7880">pattern</a>, ignorepat) &amp;&amp;
<a name="l04474"></a>04474          (!<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a> || (<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a> == ip-&gt;<a class="code" href="structast__ignorepat.html#5940569cd1d60781f856f93235b072ee">registrar</a>))) {
<a name="l04475"></a>04475          <span class="keywordflow">if</span> (ipl) {
<a name="l04476"></a>04476             ipl-&gt;<a class="code" href="structast__ignorepat.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = ip-&gt;<a class="code" href="structast__ignorepat.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l04477"></a>04477             <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(ip);
<a name="l04478"></a>04478          } <span class="keywordflow">else</span> {
<a name="l04479"></a>04479             con-&gt;<a class="code" href="structast__context.html#79a69e07731e7d02c0f52f19bab94dcb">ignorepats</a> = ip-&gt;<a class="code" href="structast__ignorepat.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l04480"></a>04480             <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(ip);
<a name="l04481"></a>04481          }
<a name="l04482"></a>04482          <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l04483"></a>04483          <span class="keywordflow">return</span> 0;
<a name="l04484"></a>04484       }
<a name="l04485"></a>04485       ipl = ip;
<a name="l04486"></a>04486    }
<a name="l04487"></a>04487 
<a name="l04488"></a>04488    <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l04489"></a>04489    errno = EINVAL;
<a name="l04490"></a>04490    <span class="keywordflow">return</span> -1;
<a name="l04491"></a>04491 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4318ec7b57c8064d746a1a395b5459bb"></a><!-- doxytag: member="pbx.c::ast_context_remove_include" ref="4318ec7b57c8064d746a1a395b5459bb" args="(const char *context, const char *include, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_remove_include           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>include</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Remove a context include. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>See ast_context_add_include for information on arguments</dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02619">2619</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l02640">ast_context_remove_include2()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l00117">handle_context_remove_include()</a>.<div class="fragment"><pre class="fragment"><a name="l02620"></a>02620 {
<a name="l02621"></a>02621    <span class="keywordtype">int</span> ret = -1;
<a name="l02622"></a>02622    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = <a class="code" href="pbx_8c.html#4669bd753e060c6bb15a0c63c4e3785a">find_context_locked</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l02623"></a>02623 
<a name="l02624"></a>02624    <span class="keywordflow">if</span> (c) {
<a name="l02625"></a>02625       <span class="comment">/* found, remove include from this context ... */</span>
<a name="l02626"></a>02626       ret = <a class="code" href="pbx_8c.html#c9afd67fae6ebbdc4e991024f69cff82">ast_context_remove_include2</a>(c, include, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l02627"></a>02627       <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l02628"></a>02628    }
<a name="l02629"></a>02629    <span class="keywordflow">return</span> ret;
<a name="l02630"></a>02630 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c9afd67fae6ebbdc4e991024f69cff82"></a><!-- doxytag: member="pbx.c::ast_context_remove_include2" ref="c9afd67fae6ebbdc4e991024f69cff82" args="(struct ast_context *con, const char *include, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_remove_include2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>include</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Removes an include by an <a class="el" href="structast__context.html">ast_context</a> structure. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>See ast_context_add_include2 for information on arguments</dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on success </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02640">2640</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06092">ast_unlock_context()</a>, <a class="el" href="pbx_8c-source.html#l06082">ast_wrlock_context()</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="pbx_8c-source.html#l00169">ast_context::includes</a>, <a class="el" href="pbx_8c-source.html#l00137">ast_include::name</a>, <a class="el" href="pbx_8c-source.html#l00142">ast_include::next</a>, and <a class="el" href="pbx_8c-source.html#l00139">ast_include::registrar</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02619">ast_context_remove_include()</a>.<div class="fragment"><pre class="fragment"><a name="l02641"></a>02641 {
<a name="l02642"></a>02642    <span class="keyword">struct </span><a class="code" href="structast__include.html">ast_include</a> *i, *pi = NULL;
<a name="l02643"></a>02643    <span class="keywordtype">int</span> ret = -1;
<a name="l02644"></a>02644 
<a name="l02645"></a>02645    <a class="code" href="pbx_8c.html#18884df37a7c36a24fd0b5f4225d1112">ast_wrlock_context</a>(con);
<a name="l02646"></a>02646 
<a name="l02647"></a>02647    <span class="comment">/* find our include */</span>
<a name="l02648"></a>02648    <span class="keywordflow">for</span> (i = con-&gt;<a class="code" href="structast__context.html#bb2b21ef7774df8687ff02b0284505c6">includes</a>; i; pi = i, i = i-&gt;<a class="code" href="structast__include.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l02649"></a>02649       <span class="keywordflow">if</span> (!strcmp(i-&gt;<a class="code" href="structast__include.html#b068931cc450442b63f5b3d276ea4297">name</a>, include) &amp;&amp;
<a name="l02650"></a>02650             (!<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a> || !strcmp(i-&gt;<a class="code" href="structast__include.html#5940569cd1d60781f856f93235b072ee">registrar</a>, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>))) {
<a name="l02651"></a>02651          <span class="comment">/* remove from list */</span>
<a name="l02652"></a>02652          <span class="keywordflow">if</span> (pi)
<a name="l02653"></a>02653             pi-&gt;next = i-&gt;<a class="code" href="structast__include.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l02654"></a>02654          <span class="keywordflow">else</span>
<a name="l02655"></a>02655             con-&gt;<a class="code" href="structast__context.html#bb2b21ef7774df8687ff02b0284505c6">includes</a> = i-&gt;<a class="code" href="structast__include.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l02656"></a>02656          <span class="comment">/* free include and return */</span>
<a name="l02657"></a>02657          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(i);
<a name="l02658"></a>02658          ret = 0;
<a name="l02659"></a>02659          <span class="keywordflow">break</span>;
<a name="l02660"></a>02660       }
<a name="l02661"></a>02661    }
<a name="l02662"></a>02662 
<a name="l02663"></a>02663    <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l02664"></a>02664 
<a name="l02665"></a>02665    <span class="keywordflow">return</span> ret;
<a name="l02666"></a>02666 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2db384d8d5d6a3155584ba62248a466a"></a><!-- doxytag: member="pbx.c::ast_context_remove_switch" ref="2db384d8d5d6a3155584ba62248a466a" args="(const char *context, const char *sw, const char *data, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_remove_switch           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>sw</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Remove a switch. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>This function locks contexts list by &amp;conlist, search for the rigt context structure, leave context list locked and call ast_context_remove_switch2 which removes switch, unlock contexts list and return ... </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02673">2673</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l02694">ast_context_remove_switch2()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>.<div class="fragment"><pre class="fragment"><a name="l02674"></a>02674 {
<a name="l02675"></a>02675    <span class="keywordtype">int</span> ret = -1; <span class="comment">/* default error return */</span>
<a name="l02676"></a>02676    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = <a class="code" href="pbx_8c.html#4669bd753e060c6bb15a0c63c4e3785a">find_context_locked</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l02677"></a>02677 
<a name="l02678"></a>02678    <span class="keywordflow">if</span> (c) {
<a name="l02679"></a>02679       <span class="comment">/* remove switch from this context ... */</span>
<a name="l02680"></a>02680       ret = <a class="code" href="pbx_8c.html#70c9b3efb9b5ad9ac26580cc90536fff">ast_context_remove_switch2</a>(c, sw, data, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l02681"></a>02681       <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l02682"></a>02682    }
<a name="l02683"></a>02683    <span class="keywordflow">return</span> ret;
<a name="l02684"></a>02684 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="70c9b3efb9b5ad9ac26580cc90536fff"></a><!-- doxytag: member="pbx.c::ast_context_remove_switch2" ref="70c9b3efb9b5ad9ac26580cc90536fff" args="(struct ast_context *con, const char *sw, const char *data, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_remove_switch2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>sw</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function locks given context, removes switch, unlock context and return. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>When we call this function, &amp;conlock lock must be locked, because when we giving *con argument, some process can remove/change this context and after that there can be segfault. </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02694">2694</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00516">AST_LIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h-source.html#l00491">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h-source.html#l00554">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="pbx_8c-source.html#l06092">ast_unlock_context()</a>, <a class="el" href="pbx_8c-source.html#l06082">ast_wrlock_context()</a>, <a class="el" href="pbx_8c-source.html#l00150">ast_sw::data</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="pbx_8c-source.html#l00148">ast_sw::name</a>, and <a class="el" href="pbx_8c-source.html#l00149">ast_sw::registrar</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02673">ast_context_remove_switch()</a>.<div class="fragment"><pre class="fragment"><a name="l02695"></a>02695 {
<a name="l02696"></a>02696    <span class="keyword">struct </span><a class="code" href="structast__sw.html">ast_sw</a> *i;
<a name="l02697"></a>02697    <span class="keywordtype">int</span> ret = -1;
<a name="l02698"></a>02698 
<a name="l02699"></a>02699    <a class="code" href="pbx_8c.html#18884df37a7c36a24fd0b5f4225d1112">ast_wrlock_context</a>(con);
<a name="l02700"></a>02700 
<a name="l02701"></a>02701    <span class="comment">/* walk switches */</span>
<a name="l02702"></a>02702    <a class="code" href="linkedlists_8h.html#915e438a9528c8d6316c617b5bd84487">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;con-&gt;alts, i, list) {
<a name="l02703"></a>02703       <span class="keywordflow">if</span> (!strcmp(i-&gt;<a class="code" href="structast__sw.html#b068931cc450442b63f5b3d276ea4297">name</a>, sw) &amp;&amp; !strcmp(i-&gt;<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>, <a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>) &amp;&amp;
<a name="l02704"></a>02704          (!<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a> || !strcmp(i-&gt;<a class="code" href="structast__sw.html#5940569cd1d60781f856f93235b072ee">registrar</a>, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>))) {
<a name="l02705"></a>02705          <span class="comment">/* found, remove from list */</span>
<a name="l02706"></a>02706          <a class="code" href="linkedlists_8h.html#37f99379dafa45c921f95bf7235eb91d">AST_LIST_REMOVE_CURRENT</a>(&amp;con-&gt;alts, list);
<a name="l02707"></a>02707          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(i); <span class="comment">/* free switch and return */</span>
<a name="l02708"></a>02708          ret = 0;
<a name="l02709"></a>02709          <span class="keywordflow">break</span>;
<a name="l02710"></a>02710       }
<a name="l02711"></a>02711    }
<a name="l02712"></a>02712    <a class="code" href="linkedlists_8h.html#a93fdadc00a2a090968004b7d9c79630">AST_LIST_TRAVERSE_SAFE_END</a>
<a name="l02713"></a>02713 
<a name="l02714"></a>02714    <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l02715"></a>02715 
<a name="l02716"></a>02716    <span class="keywordflow">return</span> ret;
<a name="l02717"></a>02717 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="577525a2317386a87ee26f89c0bd3cdc"></a><!-- doxytag: member="pbx.c::ast_context_unlockmacro" ref="577525a2317386a87ee26f89c0bd3cdc" args="(const char *context)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_unlockmacro           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>context</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unlocks the macrolock in the given context. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>This function locks contexts list by &amp;conlist, searches for the right context structure, and unlocks the macrolock mutex in that context. macrolock is used to limit a macro to be executed by one call at a time. </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02851">2851</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06100">ast_get_context_name()</a>, <a class="el" href="lock_8h-source.html#l00520">ast_mutex_unlock()</a>, <a class="el" href="pbx_8c-source.html#l06069">ast_rdlock_contexts()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l06196">ast_walk_contexts()</a>.<div class="fragment"><pre class="fragment"><a name="l02852"></a>02852 {
<a name="l02853"></a>02853    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = NULL;
<a name="l02854"></a>02854    <span class="keywordtype">int</span> ret = -1;
<a name="l02855"></a>02855 
<a name="l02856"></a>02856    <a class="code" href="pbx_8c.html#1b60f4b570102084989c86fd02ca6536">ast_rdlock_contexts</a>();
<a name="l02857"></a>02857 
<a name="l02858"></a>02858    <span class="keywordflow">while</span> ((c = <a class="code" href="pbx_8c.html#709c9b64f2da1eaace237db32a5e1445">ast_walk_contexts</a>(c))) {
<a name="l02859"></a>02859       <span class="keywordflow">if</span> (!strcmp(<a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(c), <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>)) {
<a name="l02860"></a>02860          ret = 0;
<a name="l02861"></a>02861          <span class="keywordflow">break</span>;
<a name="l02862"></a>02862       }
<a name="l02863"></a>02863    }
<a name="l02864"></a>02864 
<a name="l02865"></a>02865    <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l02866"></a>02866 
<a name="l02867"></a>02867    <span class="comment">/* if we found context, unlock macrolock */</span>
<a name="l02868"></a>02868    <span class="keywordflow">if</span> (ret == 0) 
<a name="l02869"></a>02869       ret = <a class="code" href="lock_8h.html#1d33e3caf152f0901c5ebdb69c2d4d26">ast_mutex_unlock</a>(&amp;c-&gt;macrolock);
<a name="l02870"></a>02870 
<a name="l02871"></a>02871    <span class="keywordflow">return</span> ret;
<a name="l02872"></a>02872 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d08532bf153875f677d2d3c59b13397f"></a><!-- doxytag: member="pbx.c::ast_context_verify_includes" ref="d08532bf153875f677d2d3c59b13397f" args="(struct ast_context *con)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_verify_includes           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>con</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Verifies includes in an ast_contect structure. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>con</em>&nbsp;</td><td>context in which to verify the includes</td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if no problems found </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>if there were any missing context </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06243">6243</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00889">ast_context_find()</a>, <a class="el" href="pbx_8c-source.html#l06100">ast_get_context_name()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="pbx_8c-source.html#l06225">ast_walk_context_includes()</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, and <a class="el" href="pbx_8c-source.html#l00138">ast_include::rname</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01596">pbx_load_module()</a>.<div class="fragment"><pre class="fragment"><a name="l06244"></a>06244 {
<a name="l06245"></a>06245    <span class="keyword">struct </span><a class="code" href="structast__include.html">ast_include</a> *inc = NULL;
<a name="l06246"></a>06246    <span class="keywordtype">int</span> res = 0;
<a name="l06247"></a>06247 
<a name="l06248"></a>06248    <span class="keywordflow">while</span> ( (inc = <a class="code" href="pbx_8c.html#ff52371424397442d32568beb910e153">ast_walk_context_includes</a>(con, inc)) )
<a name="l06249"></a>06249       <span class="keywordflow">if</span> (!<a class="code" href="pbx_8c.html#f8c5b4e7d06b7aff72707b5d7d7c94e1">ast_context_find</a>(inc-&gt;<a class="code" href="structast__include.html#c626d8954194dd0136691c301dcf7ece">rname</a>)) {
<a name="l06250"></a>06250          res = -1;
<a name="l06251"></a>06251          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Context '%s' tries includes nonexistent context '%s'\n"</span>,
<a name="l06252"></a>06252                <a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(con), inc-&gt;<a class="code" href="structast__include.html#c626d8954194dd0136691c301dcf7ece">rname</a>);
<a name="l06253"></a>06253       }
<a name="l06254"></a>06254    <span class="keywordflow">return</span> res;
<a name="l06255"></a>06255 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2f6033daa3dd2a6a51ee380a86a783ba"></a><!-- doxytag: member="pbx.c::ast_custom_function_find" ref="2f6033daa3dd2a6a51ee380a86a783ba" args="(const char *name)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__custom__function.html">ast_custom_function</a>* ast_custom_function_find           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>name</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01345">1345</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00060">AST_RWLIST_RDLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, and <a class="el" href="pbx_8h-source.html#l00073">ast_custom_function::name</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l01437">ast_func_read()</a>, <a class="el" href="pbx_8c-source.html#l01452">ast_func_write()</a>, and <a class="el" href="pbx_8c-source.html#l01269">handle_show_function()</a>.<div class="fragment"><pre class="fragment"><a name="l01346"></a>01346 {
<a name="l01347"></a>01347    <span class="keyword">struct </span><a class="code" href="structast__custom__function.html">ast_custom_function</a> *acf = NULL;
<a name="l01348"></a>01348 
<a name="l01349"></a>01349    <a class="code" href="linkedlists_8h.html#23c0c844e5abcb474854867b408e3be8">AST_RWLIST_RDLOCK</a>(&amp;acf_root);
<a name="l01350"></a>01350    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;acf_root, acf, acflist) {
<a name="l01351"></a>01351       <span class="keywordflow">if</span> (!strcmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, acf-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>))
<a name="l01352"></a>01352          <span class="keywordflow">break</span>;
<a name="l01353"></a>01353    }
<a name="l01354"></a>01354    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;acf_root);
<a name="l01355"></a>01355 
<a name="l01356"></a>01356    <span class="keywordflow">return</span> acf;
<a name="l01357"></a>01357 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="93b5bf1865d6f3290372ca5ee3274391"></a><!-- doxytag: member="pbx.c::ast_custom_function_register" ref="93b5bf1865d6f3290372ca5ee3274391" args="(struct ast_custom_function *acf)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_custom_function_register           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__custom__function.html">ast_custom_function</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>acf</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Reigster a custom function. 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01381">1381</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="linkedlists_8h-source.html#l00549">AST_RWLIST_INSERT_BEFORE_CURRENT</a>, <a class="el" href="linkedlists_8h-source.html#l00680">AST_RWLIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00503">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h-source.html#l00556">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, <a class="el" href="pbx_8h-source.html#l00073">ast_custom_function::name</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, and <a class="el" href="logger_8h-source.html#l00044">VERBOSE_PREFIX_2</a>.
<p>
Referenced by <a class="el" href="app__minivm_8c-source.html#l03157">load_module()</a>, and <a class="el" href="func__odbc_8c-source.html#l00630">reload()</a>.<div class="fragment"><pre class="fragment"><a name="l01382"></a>01382 {
<a name="l01383"></a>01383    <span class="keyword">struct </span><a class="code" href="structast__custom__function.html">ast_custom_function</a> *cur;
<a name="l01384"></a>01384 
<a name="l01385"></a>01385    <span class="keywordflow">if</span> (!acf)
<a name="l01386"></a>01386       <span class="keywordflow">return</span> -1;
<a name="l01387"></a>01387 
<a name="l01388"></a>01388    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;acf_root);
<a name="l01389"></a>01389 
<a name="l01390"></a>01390    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;acf_root, cur, acflist) {
<a name="l01391"></a>01391       <span class="keywordflow">if</span> (!strcmp(acf-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>, cur-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>)) {
<a name="l01392"></a>01392          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Function %s already registered.\n"</span>, acf-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l01393"></a>01393          <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;acf_root);
<a name="l01394"></a>01394          <span class="keywordflow">return</span> -1;
<a name="l01395"></a>01395       }
<a name="l01396"></a>01396    }
<a name="l01397"></a>01397 
<a name="l01398"></a>01398    <span class="comment">/* Store in alphabetical order */</span>
<a name="l01399"></a>01399    <a class="code" href="linkedlists_8h.html#b564f1f262db6464e1644462c38d61e3">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;acf_root, cur, acflist) {
<a name="l01400"></a>01400       <span class="keywordflow">if</span> (strcasecmp(acf-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>, cur-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>) &lt; 0) {
<a name="l01401"></a>01401          <a class="code" href="linkedlists_8h.html#cf4d2eed92b828f7212b90b1dcde0b29">AST_RWLIST_INSERT_BEFORE_CURRENT</a>(&amp;acf_root, acf, acflist);
<a name="l01402"></a>01402          <span class="keywordflow">break</span>;
<a name="l01403"></a>01403       }
<a name="l01404"></a>01404    }
<a name="l01405"></a>01405    <a class="code" href="linkedlists_8h.html#e5be717f6b8c1586fa30a060b56403fe">AST_RWLIST_TRAVERSE_SAFE_END</a>
<a name="l01406"></a>01406    <span class="keywordflow">if</span> (!cur)
<a name="l01407"></a>01407       <a class="code" href="linkedlists_8h.html#64b41a3e9f2e6a867c09431dfae7ce21">AST_RWLIST_INSERT_TAIL</a>(&amp;acf_root, acf, acflist);
<a name="l01408"></a>01408 
<a name="l01409"></a>01409    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;acf_root);
<a name="l01410"></a>01410 
<a name="l01411"></a>01411    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 1)
<a name="l01412"></a>01412       <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Registered custom function %s\n"</span>, acf-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l01413"></a>01413 
<a name="l01414"></a>01414    <span class="keywordflow">return</span> 0;
<a name="l01415"></a>01415 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="cfc1bbe0fad0bcf852611eaee79b2d03"></a><!-- doxytag: member="pbx.c::ast_custom_function_unregister" ref="cfc1bbe0fad0bcf852611eaee79b2d03" args="(struct ast_custom_function *acf)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_custom_function_unregister           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__custom__function.html">ast_custom_function</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>acf</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unregister a custom function. 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01359">1359</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00526">AST_RWLIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h-source.html#l00503">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h-source.html#l00556">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="pbx_8h-source.html#l00073">ast_custom_function::name</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, and <a class="el" href="logger_8h-source.html#l00044">VERBOSE_PREFIX_2</a>.
<p>
Referenced by <a class="el" href="func__odbc_8c-source.html#l00630">reload()</a>, and <a class="el" href="app__minivm_8c-source.html#l03204">unload_module()</a>.<div class="fragment"><pre class="fragment"><a name="l01360"></a>01360 {
<a name="l01361"></a>01361    <span class="keyword">struct </span><a class="code" href="structast__custom__function.html">ast_custom_function</a> *cur;
<a name="l01362"></a>01362 
<a name="l01363"></a>01363    <span class="keywordflow">if</span> (!acf)
<a name="l01364"></a>01364       <span class="keywordflow">return</span> -1;
<a name="l01365"></a>01365 
<a name="l01366"></a>01366    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;acf_root);
<a name="l01367"></a>01367    <a class="code" href="linkedlists_8h.html#b564f1f262db6464e1644462c38d61e3">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;acf_root, cur, acflist) {
<a name="l01368"></a>01368       <span class="keywordflow">if</span> (cur == acf) {
<a name="l01369"></a>01369          <a class="code" href="linkedlists_8h.html#93783e4cad722e705630e975d2e8d7f9">AST_RWLIST_REMOVE_CURRENT</a>(&amp;acf_root, acflist);
<a name="l01370"></a>01370          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 1)
<a name="l01371"></a>01371             <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Unregistered custom function %s\n"</span>, acf-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l01372"></a>01372          <span class="keywordflow">break</span>;
<a name="l01373"></a>01373       }
<a name="l01374"></a>01374    }
<a name="l01375"></a>01375    <a class="code" href="linkedlists_8h.html#e5be717f6b8c1586fa30a060b56403fe">AST_RWLIST_TRAVERSE_SAFE_END</a>
<a name="l01376"></a>01376    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;acf_root);
<a name="l01377"></a>01377 
<a name="l01378"></a>01378    <span class="keywordflow">return</span> acf ? 0 : -1;
<a name="l01379"></a>01379 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="90b58be34145fcfd99652f0c3ae7377d"></a><!-- doxytag: member="pbx.c::ast_exists_extension" ref="90b58be34145fcfd99652f0c3ae7377d" args="(struct ast_channel *c, const char *context, const char *exten, int priority, const char *callerid)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_exists_extension           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>callerid</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Determine whether an extension exists. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>this is not important </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>which context to look in </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>exten</em>&nbsp;</td><td>which extension to search for </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>priority</em>&nbsp;</td><td>priority of the action within the extension </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callerid</em>&nbsp;</td><td>callerid to search for</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>If an extension within the given context(or callerid) with the given priority is found a non zero value will be returned. Otherwise, 0 is returned. </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02183">2183</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe437691af9bdd09d1ad4c2e5b087d5717">E_MATCH</a>, and <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l06258">__ast_goto_if_exists()</a>, <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>, <a class="el" href="chan__agent_8c-source.html#l01763">__login_exec()</a>, <a class="el" href="app__macro_8c-source.html#l00144">_macro_exec()</a>, <a class="el" href="chan__agent_8c-source.html#l02207">agentmonitoroutgoing_exec()</a>, <a class="el" href="chan__h323_8c-source.html#l02238">answer_call()</a>, <a class="el" href="app_8c-source.html#l00065">ast_app_dtget()</a>, <a class="el" href="res__features_8c-source.html#l00342">ast_park_call()</a>, <a class="el" href="pbx_8c-source.html#l04991">ast_pbx_outgoing_exten()</a>, <a class="el" href="res__features_8c-source.html#l00776">builtin_atxfer()</a>, <a class="el" href="res__features_8c-source.html#l00673">builtin_blindtransfer()</a>, <a class="el" href="chan__alsa_8c-source.html#l01004">console_dial()</a>, <a class="el" href="chan__oss_8c-source.html#l01339">console_transfer()</a>, <a class="el" href="chan__iax2_8c-source.html#l06220">dp_lookup()</a>, <a class="el" href="pbx__dundi_8c-source.html#l00532">dundi_lookup_local()</a>, <a class="el" href="chan__sip_8c-source.html#l09533">get_also_info()</a>, <a class="el" href="chan__sip_8c-source.html#l09207">get_destination()</a>, <a class="el" href="chan__sip_8c-source.html#l09372">get_refer_info()</a>, <a class="el" href="app__rpt_8c-source.html#l03406">handle_link_data()</a>, <a class="el" href="app__rpt_8c-source.html#l03557">handle_link_phone_dtmf()</a>, <a class="el" href="chan__skinny_8c-source.html#l03102">handle_stimulus_message()</a>, <a class="el" href="app__voicemail_8c-source.html#l02956">leave_voicemail()</a>, <a class="el" href="chan__local_8c-source.html#l00550">local_alloc()</a>, <a class="el" href="chan__local_8c-source.html#l00127">local_devicestate()</a>, <a class="el" href="pbx__loopback_8c-source.html#l00124">loopback_exists()</a>, <a class="el" href="res__features_8c-source.html#l00318">metermaidstate()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02638">mgcp_ss()</a>, <a class="el" href="app__minivm_8c-source.html#l01818">minivm_greet_exec()</a>, <a class="el" href="chan__misdn_8c-source.html#l00650">misdn_overlap_dial_task()</a>, <a class="el" href="pbx_8c-source.html#l05584">pbx_builtin_waitexten()</a>, <a class="el" href="chan__phone_8c-source.html#l00939">phone_check_exception()</a>, <a class="el" href="chan__misdn_8c-source.html#l02539">process_ast_dsp()</a>, <a class="el" href="chan__iax2_8c-source.html#l05647">register_peer_exten()</a>, <a class="el" href="chan__skinny_8c-source.html#l02365">skinny_ss()</a>, <a class="el" href="chan__iax2_8c-source.html#l06624">socket_process()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, <a class="el" href="file_8c-source.html#l00983">waitstream_core()</a>, and <a class="el" href="chan__zap_8c-source.html#l03875">zt_handle_dtmfup()</a>.<div class="fragment"><pre class="fragment"><a name="l02184"></a>02184 {
<a name="l02185"></a>02185    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#2377c7b979811bdd54ebf819e5d2037b">pbx_extension_helper</a>(c, NULL, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, priority, NULL, callerid, <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe437691af9bdd09d1ad4c2e5b087d5717">E_MATCH</a>);
<a name="l02186"></a>02186 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1e0079c7f2934dd7ebe801fefe4057da"></a><!-- doxytag: member="pbx.c::ast_explicit_goto" ref="1e0079c7f2934dd7ebe801fefe4057da" args="(struct ast_channel *chan, const char *context, const char *exten, int priority)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_explicit_goto           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04576">4576</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73002122d39475941a27a292dfd49534d079">AST_FLAG_IN_AUTOLOOP</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="channel_8h-source.html#l00441">ast_channel::context</a>, <a class="el" href="channel_8h-source.html#l00442">ast_channel::exten</a>, and <a class="el" href="channel_8h-source.html#l00443">ast_channel::priority</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l06258">__ast_goto_if_exists()</a>, <a class="el" href="pbx_8c-source.html#l04595">ast_async_goto()</a>, <a class="el" href="pbx_8c-source.html#l06287">ast_parseable_goto()</a>, <a class="el" href="res__features_8c-source.html#l00776">builtin_atxfer()</a>, <a class="el" href="res__features_8c-source.html#l02147">do_bridge_masquerade()</a>, <a class="el" href="res__agi_8c-source.html#l00873">handle_setpriority()</a>, and <a class="el" href="app__stack_8c-source.html#l00163">return_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l04577"></a>04577 {
<a name="l04578"></a>04578    <span class="keywordflow">if</span> (!chan)
<a name="l04579"></a>04579       <span class="keywordflow">return</span> -1;
<a name="l04580"></a>04580 
<a name="l04581"></a>04581    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>))
<a name="l04582"></a>04582       ast_copy_string(chan-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <span class="keyword">sizeof</span>(chan-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>));
<a name="l04583"></a>04583    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>))
<a name="l04584"></a>04584       ast_copy_string(chan-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <span class="keyword">sizeof</span>(chan-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>));
<a name="l04585"></a>04585    <span class="keywordflow">if</span> (priority &gt; -1) {
<a name="l04586"></a>04586       chan-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a> = priority;
<a name="l04587"></a>04587       <span class="comment">/* see flag description in channel.h for explanation */</span>
<a name="l04588"></a>04588       <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73002122d39475941a27a292dfd49534d079">AST_FLAG_IN_AUTOLOOP</a>))
<a name="l04589"></a>04589          chan-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>--;
<a name="l04590"></a>04590    }
<a name="l04591"></a>04591 
<a name="l04592"></a>04592    <span class="keywordflow">return</span> 0;
<a name="l04593"></a>04593 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a82c6deae96c20bc56e29d921d6e036f"></a><!-- doxytag: member="pbx.c::ast_extension_close" ref="a82c6deae96c20bc56e29d921d6e036f" args="(const char *pattern, const char *data, int needmore)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_extension_close           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>pattern</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>needmore</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00882">882</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fee9684886238bd81a61f3358030326178">E_CANMATCH</a>, <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824febb13020eaa30c314c1bff110026a7cd2">E_MATCHMORE</a>, <a class="el" href="pbx_8c-source.html#l00865">extension_match_core()</a>, and <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>.<div class="fragment"><pre class="fragment"><a name="l00883"></a>00883 {
<a name="l00884"></a>00884    <span class="keywordflow">if</span> (needmore != <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824febb13020eaa30c314c1bff110026a7cd2">E_MATCHMORE</a> &amp;&amp; needmore != <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fee9684886238bd81a61f3358030326178">E_CANMATCH</a>)
<a name="l00885"></a>00885       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"invalid argument %d\n"</span>, needmore);
<a name="l00886"></a>00886    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#489ae231aa1cc1031dcfd0adc1cc4600">extension_match_core</a>(pattern, data, needmore);
<a name="l00887"></a>00887 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="fee4ebd3f1d86114fe9bb33931f9a6cf"></a><!-- doxytag: member="pbx.c::ast_extension_match" ref="fee4ebd3f1d86114fe9bb33931f9a6cf" args="(const char *pattern, const char *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_extension_match           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>pattern</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>extension</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Determine if a given extension matches a given pattern (in NXX format). 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pattern</em>&nbsp;</td><td>pattern to match </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>extension</em>&nbsp;</td><td>extension to check against the pattern.</td></tr>
  </table>
</dl>
Checks whether or not the given extension matches the given pattern.<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>1</em>&nbsp;</td><td>on match </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00877">877</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe437691af9bdd09d1ad4c2e5b087d5717">E_MATCH</a>, and <a class="el" href="pbx_8c-source.html#l00865">extension_match_core()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04542">ast_ignore_pattern()</a>, <a class="el" href="app__playback_8c-source.html#l00147">do_say()</a>, <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>, <a class="el" href="pbx__loopback_8c-source.html#l00133">loopback_canmatch()</a>, <a class="el" href="pbx__loopback_8c-source.html#l00142">loopback_exec()</a>, <a class="el" href="pbx__loopback_8c-source.html#l00124">loopback_exists()</a>, <a class="el" href="pbx__loopback_8c-source.html#l00152">loopback_matchmore()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, <a class="el" href="pbx_8c-source.html#l00907">matchcid()</a>, <a class="el" href="misdn__config_8c-source.html#l00631">misdn_cfg_is_msn_valid()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l00878"></a>00878 {
<a name="l00879"></a>00879    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#489ae231aa1cc1031dcfd0adc1cc4600">extension_match_core</a>(pattern, data, <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe437691af9bdd09d1ad4c2e5b087d5717">E_MATCH</a>);
<a name="l00880"></a>00880 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="16769dc669e528ae10a063594fb7f4ae"></a><!-- doxytag: member="pbx.c::ast_extension_state" ref="16769dc669e528ae10a063594fb7f4ae" args="(struct ast_channel *c, const char *context, const char *exten)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_extension_state           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Uses hint and devicestate callback to get the state of an extension. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>this is not important </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>which context to look in </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>exten</em>&nbsp;</td><td>which extension to get state</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>extension state as defined in the ast_extension_states enum </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01909">1909</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l01812">ast_extension_state2()</a>, and <a class="el" href="pbx_8c-source.html#l01799">ast_hint_extension()</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l02085">action_extensionstate()</a>, and <a class="el" href="chan__sip_8c-source.html#l15240">handle_request_subscribe()</a>.<div class="fragment"><pre class="fragment"><a name="l01910"></a>01910 {
<a name="l01911"></a>01911    <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *e;
<a name="l01912"></a>01912 
<a name="l01913"></a>01913    e = <a class="code" href="pbx_8c.html#a4691f6ae9689498c10c695381f36103">ast_hint_extension</a>(c, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>);   <span class="comment">/* Do we have a hint for this extension ? */</span>
<a name="l01914"></a>01914    <span class="keywordflow">if</span> (!e)
<a name="l01915"></a>01915       <span class="keywordflow">return</span> -1;           <span class="comment">/* No hint, return -1 */</span>
<a name="l01916"></a>01916 
<a name="l01917"></a>01917    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#6aecfed8ee63e22940bc2d842f0a536c">ast_extension_state2</a>(e);        <span class="comment">/* Check all devices in the hint */</span>
<a name="l01918"></a>01918 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6aecfed8ee63e22940bc2d842f0a536c"></a><!-- doxytag: member="pbx.c::ast_extension_state2" ref="6aecfed8ee63e22940bc2d842f0a536c" args="(struct ast_exten *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int ast_extension_state2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
ast_extensions_state2: Check state of extension by using hints 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01812">1812</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e1036467dfee7c023a3b7a28e45f7ef21">AST_DEVICE_BUSY</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9eb54883b8e5fcba0b30f9db4b98eb0f42">AST_DEVICE_INUSE</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e9cc12f38e2eec4c5ed63a43bc967834d">AST_DEVICE_INVALID</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e0fe2efc106235ced7c3742c8fb054544">AST_DEVICE_NOT_INUSE</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9ecec0bdf83d7b3e88d7e376422f6ba00d">AST_DEVICE_ONHOLD</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e4f429c553fc5d377aa9966350ff34d44">AST_DEVICE_RINGING</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e3ee5721810b67dd7c7bad7036ce97f37">AST_DEVICE_RINGINUSE</a>, <a class="el" href="devicestate_8c-source.html#l00274">ast_device_state()</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9eedbb8a648c9f4b3dfb164b9d5cf5cabb">AST_DEVICE_UNAVAILABLE</a>, <a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75721f2af8b4a4abcc783fce2791af6d13">AST_EXTENSION_BUSY</a>, <a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75af76c61ff1afcc94e335402cda274f0c">AST_EXTENSION_INUSE</a>, <a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f755fc09a563f5aee5b8cc58e535cbe6957">AST_EXTENSION_NOT_INUSE</a>, <a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f7541e76c8a6fe6c7824228f2613672c524">AST_EXTENSION_ONHOLD</a>, <a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75dfc0eb724f114235813e772b93bca550">AST_EXTENSION_RINGING</a>, <a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75555002246e0b0325196808797905c17d">AST_EXTENSION_UNAVAILABLE</a>, <a class="el" href="pbx_8c-source.html#l06168">ast_get_extension_app()</a>, <a class="el" href="channel_8h-source.html#l00139">AST_MAX_EXTENSION</a>, <a class="el" href="pbx__gtkconsole_8c-source.html#l00059">inuse</a>, <a class="el" href="chan__oss_8c-source.html#l00795">ring()</a>, and <a class="el" href="strcompat_8c-source.html#l00035">strsep()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02076">ast_add_hint()</a>, <a class="el" href="pbx_8c-source.html#l01909">ast_extension_state()</a>, and <a class="el" href="pbx_8c-source.html#l01920">ast_hint_state_changed()</a>.<div class="fragment"><pre class="fragment"><a name="l01813"></a>01813 {
<a name="l01814"></a>01814    <span class="keywordtype">char</span> hint[<a class="code" href="channel_8h.html#729d25558b5b1940c1a6ff9d806f944c">AST_MAX_EXTENSION</a>];
<a name="l01815"></a>01815    <span class="keywordtype">char</span> *cur, *rest;
<a name="l01816"></a>01816    <span class="keywordtype">int</span> allunavailable = 1, allbusy = 1, allfree = 1, allonhold = 1;
<a name="l01817"></a>01817    <span class="keywordtype">int</span> busy = 0, <a class="code" href="pbx__gtkconsole_8c.html#9ac84af00bd68fa1e4441a101c6b6305">inuse</a> = 0, <a class="code" href="chan__oss_8c.html#19e79acd569290fd06d1e97682f40d89">ring</a> = 0;
<a name="l01818"></a>01818 
<a name="l01819"></a>01819    <span class="keywordflow">if</span> (!e)
<a name="l01820"></a>01820       <span class="keywordflow">return</span> -1;
<a name="l01821"></a>01821 
<a name="l01822"></a>01822    ast_copy_string(hint, <a class="code" href="pbx_8c.html#c8eaa4fc248390fee258e7d2b2ff3490">ast_get_extension_app</a>(e), <span class="keyword">sizeof</span>(hint));
<a name="l01823"></a>01823 
<a name="l01824"></a>01824    rest = hint;   <span class="comment">/* One or more devices separated with a &amp; character */</span>
<a name="l01825"></a>01825    <span class="keywordflow">while</span> ( (cur = <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;rest, <span class="stringliteral">"&amp;"</span>)) ) {
<a name="l01826"></a>01826       <span class="keywordtype">int</span> res = <a class="code" href="devicestate_8c.html#108baa7a6e968d91099ef15c445e215c">ast_device_state</a>(cur);
<a name="l01827"></a>01827       <span class="keywordflow">switch</span> (res) {
<a name="l01828"></a>01828       <span class="keywordflow">case</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e0fe2efc106235ced7c3742c8fb054544">AST_DEVICE_NOT_INUSE</a>:
<a name="l01829"></a>01829          allunavailable = 0;
<a name="l01830"></a>01830          allbusy = 0;
<a name="l01831"></a>01831          allonhold = 0;
<a name="l01832"></a>01832          <span class="keywordflow">break</span>;
<a name="l01833"></a>01833       <span class="keywordflow">case</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9eb54883b8e5fcba0b30f9db4b98eb0f42">AST_DEVICE_INUSE</a>:
<a name="l01834"></a>01834          <a class="code" href="pbx__gtkconsole_8c.html#9ac84af00bd68fa1e4441a101c6b6305">inuse</a> = 1;
<a name="l01835"></a>01835          allunavailable = 0;
<a name="l01836"></a>01836          allfree = 0;
<a name="l01837"></a>01837          allonhold = 0;
<a name="l01838"></a>01838          <span class="keywordflow">break</span>;
<a name="l01839"></a>01839       <span class="keywordflow">case</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e4f429c553fc5d377aa9966350ff34d44">AST_DEVICE_RINGING</a>:
<a name="l01840"></a>01840          <a class="code" href="chan__oss_8c.html#19e79acd569290fd06d1e97682f40d89">ring</a> = 1;
<a name="l01841"></a>01841          allunavailable = 0;
<a name="l01842"></a>01842          allfree = 0;
<a name="l01843"></a>01843          allonhold = 0;
<a name="l01844"></a>01844          <span class="keywordflow">break</span>;
<a name="l01845"></a>01845       <span class="keywordflow">case</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e3ee5721810b67dd7c7bad7036ce97f37">AST_DEVICE_RINGINUSE</a>:
<a name="l01846"></a>01846          <a class="code" href="pbx__gtkconsole_8c.html#9ac84af00bd68fa1e4441a101c6b6305">inuse</a> = 1;
<a name="l01847"></a>01847          <a class="code" href="chan__oss_8c.html#19e79acd569290fd06d1e97682f40d89">ring</a> = 1;
<a name="l01848"></a>01848          allunavailable = 0;
<a name="l01849"></a>01849          allfree = 0;
<a name="l01850"></a>01850          allonhold = 0;
<a name="l01851"></a>01851          <span class="keywordflow">break</span>;
<a name="l01852"></a>01852       <span class="keywordflow">case</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9ecec0bdf83d7b3e88d7e376422f6ba00d">AST_DEVICE_ONHOLD</a>:
<a name="l01853"></a>01853          allunavailable = 0;
<a name="l01854"></a>01854          allfree = 0;
<a name="l01855"></a>01855          <span class="keywordflow">break</span>;
<a name="l01856"></a>01856       <span class="keywordflow">case</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e1036467dfee7c023a3b7a28e45f7ef21">AST_DEVICE_BUSY</a>:
<a name="l01857"></a>01857          allunavailable = 0;
<a name="l01858"></a>01858          allfree = 0;
<a name="l01859"></a>01859          allonhold = 0;
<a name="l01860"></a>01860          busy = 1;
<a name="l01861"></a>01861          <span class="keywordflow">break</span>;
<a name="l01862"></a>01862       <span class="keywordflow">case</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9eedbb8a648c9f4b3dfb164b9d5cf5cabb">AST_DEVICE_UNAVAILABLE</a>:
<a name="l01863"></a>01863       <span class="keywordflow">case</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e9cc12f38e2eec4c5ed63a43bc967834d">AST_DEVICE_INVALID</a>:
<a name="l01864"></a>01864          allbusy = 0;
<a name="l01865"></a>01865          allfree = 0;
<a name="l01866"></a>01866          allonhold = 0;
<a name="l01867"></a>01867          <span class="keywordflow">break</span>;
<a name="l01868"></a>01868       <span class="keywordflow">default</span>:
<a name="l01869"></a>01869          allunavailable = 0;
<a name="l01870"></a>01870          allbusy = 0;
<a name="l01871"></a>01871          allfree = 0;
<a name="l01872"></a>01872          allonhold = 0;
<a name="l01873"></a>01873       }
<a name="l01874"></a>01874    }
<a name="l01875"></a>01875 
<a name="l01876"></a>01876    <span class="keywordflow">if</span> (!<a class="code" href="pbx__gtkconsole_8c.html#9ac84af00bd68fa1e4441a101c6b6305">inuse</a> &amp;&amp; <a class="code" href="chan__oss_8c.html#19e79acd569290fd06d1e97682f40d89">ring</a>)
<a name="l01877"></a>01877       <span class="keywordflow">return</span> <a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75dfc0eb724f114235813e772b93bca550">AST_EXTENSION_RINGING</a>;
<a name="l01878"></a>01878    <span class="keywordflow">if</span> (<a class="code" href="pbx__gtkconsole_8c.html#9ac84af00bd68fa1e4441a101c6b6305">inuse</a> &amp;&amp; <a class="code" href="chan__oss_8c.html#19e79acd569290fd06d1e97682f40d89">ring</a>)
<a name="l01879"></a>01879       <span class="keywordflow">return</span> (<a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75af76c61ff1afcc94e335402cda274f0c">AST_EXTENSION_INUSE</a> | <a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75dfc0eb724f114235813e772b93bca550">AST_EXTENSION_RINGING</a>);
<a name="l01880"></a>01880    <span class="keywordflow">if</span> (<a class="code" href="pbx__gtkconsole_8c.html#9ac84af00bd68fa1e4441a101c6b6305">inuse</a>)
<a name="l01881"></a>01881       <span class="keywordflow">return</span> <a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75af76c61ff1afcc94e335402cda274f0c">AST_EXTENSION_INUSE</a>;
<a name="l01882"></a>01882    <span class="keywordflow">if</span> (allfree)
<a name="l01883"></a>01883       <span class="keywordflow">return</span> <a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f755fc09a563f5aee5b8cc58e535cbe6957">AST_EXTENSION_NOT_INUSE</a>;
<a name="l01884"></a>01884    <span class="keywordflow">if</span> (allonhold)
<a name="l01885"></a>01885       <span class="keywordflow">return</span> <a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f7541e76c8a6fe6c7824228f2613672c524">AST_EXTENSION_ONHOLD</a>;
<a name="l01886"></a>01886    <span class="keywordflow">if</span> (allbusy)
<a name="l01887"></a>01887       <span class="keywordflow">return</span> <a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75721f2af8b4a4abcc783fce2791af6d13">AST_EXTENSION_BUSY</a>;
<a name="l01888"></a>01888    <span class="keywordflow">if</span> (allunavailable)
<a name="l01889"></a>01889       <span class="keywordflow">return</span> <a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75555002246e0b0325196808797905c17d">AST_EXTENSION_UNAVAILABLE</a>;
<a name="l01890"></a>01890    <span class="keywordflow">if</span> (busy)
<a name="l01891"></a>01891       <span class="keywordflow">return</span> <a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75af76c61ff1afcc94e335402cda274f0c">AST_EXTENSION_INUSE</a>;
<a name="l01892"></a>01892 
<a name="l01893"></a>01893    <span class="keywordflow">return</span> <a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f755fc09a563f5aee5b8cc58e535cbe6957">AST_EXTENSION_NOT_INUSE</a>;
<a name="l01894"></a>01894 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c4e2c1f2a0862db3fb3faa3d5dd9350c"></a><!-- doxytag: member="pbx.c::ast_extension_state2str" ref="c4e2c1f2a0862db3fb3faa3d5dd9350c" args="(int extension_state)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_extension_state2str           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>extension_state</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return string representation of the state of an extension. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>extension_state</em>&nbsp;</td><td>is the numerical state delivered by ast_extension_state</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the state of an extension as string </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01897">1897</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c.html#63938e196e95ba3f1d098ec3884aca3a">extension_states</a>.
<p>
Referenced by <a class="el" href="chan__sip_8c-source.html#l11299">__sip_show_channels()</a>, <a class="el" href="chan__sip_8c-source.html#l15240">handle_request_subscribe()</a>, and <a class="el" href="pbx_8c-source.html#l03142">handle_show_hints()</a>.<div class="fragment"><pre class="fragment"><a name="l01898"></a>01898 {
<a name="l01899"></a>01899    <span class="keywordtype">int</span> i;
<a name="l01900"></a>01900 
<a name="l01901"></a>01901    <span class="keywordflow">for</span> (i = 0; (i &lt; (<span class="keyword">sizeof</span>(<a class="code" href="pbx_8c.html#63938e196e95ba3f1d098ec3884aca3a">extension_states</a>) / <span class="keyword">sizeof</span>(extension_states[0]))); i++) {
<a name="l01902"></a>01902       <span class="keywordflow">if</span> (extension_states[i].extension_state == extension_state)
<a name="l01903"></a>01903          <span class="keywordflow">return</span> extension_states[i].text;
<a name="l01904"></a>01904    }
<a name="l01905"></a>01905    <span class="keywordflow">return</span> <span class="stringliteral">"Unknown"</span>;
<a name="l01906"></a>01906 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="14f63100164300fc4b55b09d6c3474fd"></a><!-- doxytag: member="pbx.c::ast_extension_state_add" ref="14f63100164300fc4b55b09d6c3474fd" args="(const char *context, const char *exten, ast_state_cb_type callback, void *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_extension_state_add           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="pbx_8h.html#a083658b5411c328227915675531df43">ast_state_cb_type</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>callback</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Registers a state change callback. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>which context to look in </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>exten</em>&nbsp;</td><td>which extension to get state </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callback</em>&nbsp;</td><td>callback to call if state changed </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>to pass to callback</td></tr>
  </table>
</dl>
The callback is called if the state of an extension is changed.<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ID</em>&nbsp;</td><td>on success </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01964">1964</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="pbx_8c-source.html#l01799">ast_hint_extension()</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="pbx_8c-source.html#l00192">ast_state_cb::callback</a>, <a class="el" href="pbx_8c-source.html#l00205">ast_hint::callbacks</a>, <a class="el" href="pbx_8c-source.html#l00191">ast_state_cb::data</a>, <a class="el" href="pbx_8c-source.html#l00203">ast_hint::exten</a>, <a class="el" href="pbx_8c-source.html#l00193">ast_state_cb::next</a>, <a class="el" href="pbx_8c-source.html#l00504">statecbs</a>, and <a class="el" href="pbx_8c-source.html#l00496">stateid</a>.
<p>
Referenced by <a class="el" href="chan__sip_8c-source.html#l15240">handle_request_subscribe()</a>, <a class="el" href="manager_8c-source.html#l03215">init_manager()</a>, and <a class="el" href="chan__skinny_8c-source.html#l01355">skinny_register()</a>.<div class="fragment"><pre class="fragment"><a name="l01966"></a>01966 {
<a name="l01967"></a>01967    <span class="keyword">struct </span><a class="code" href="structast__hint.html">ast_hint</a> *hint;
<a name="l01968"></a>01968    <span class="keyword">struct </span><a class="code" href="structast__state__cb.html">ast_state_cb</a> *cblist;
<a name="l01969"></a>01969    <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *e;
<a name="l01970"></a>01970 
<a name="l01971"></a>01971    <span class="comment">/* If there's no context and extension:  add callback to statecbs list */</span>
<a name="l01972"></a>01972    <span class="keywordflow">if</span> (!<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a> &amp;&amp; !<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>) {
<a name="l01973"></a>01973       <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;hints);
<a name="l01974"></a>01974 
<a name="l01975"></a>01975       <span class="keywordflow">for</span> (cblist = <a class="code" href="pbx_8c.html#3b088b468374b928f6ab90bfe5db48bf">statecbs</a>; cblist; cblist = cblist-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l01976"></a>01976          <span class="keywordflow">if</span> (cblist-&gt;<a class="code" href="structast__state__cb.html#924a8ceeac17f54d3be3f8cdf1c04eb2">callback</a> == callback) {
<a name="l01977"></a>01977             cblist-&gt;<a class="code" href="structast__state__cb.html#8d777f385d3dfec8815d20f7496026dc">data</a> = <a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a>;
<a name="l01978"></a>01978             <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l01979"></a>01979             <span class="keywordflow">return</span> 0;
<a name="l01980"></a>01980          }
<a name="l01981"></a>01981       }
<a name="l01982"></a>01982 
<a name="l01983"></a>01983       <span class="comment">/* Now insert the callback */</span>
<a name="l01984"></a>01984       <span class="keywordflow">if</span> (!(cblist = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*cblist)))) {
<a name="l01985"></a>01985          <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l01986"></a>01986          <span class="keywordflow">return</span> -1;
<a name="l01987"></a>01987       }
<a name="l01988"></a>01988       cblist-&gt;id = 0;
<a name="l01989"></a>01989       cblist-&gt;callback = callback;
<a name="l01990"></a>01990       cblist-&gt;data = <a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a>;
<a name="l01991"></a>01991 
<a name="l01992"></a>01992       cblist-&gt;next = <a class="code" href="pbx_8c.html#3b088b468374b928f6ab90bfe5db48bf">statecbs</a>;
<a name="l01993"></a>01993       <a class="code" href="pbx_8c.html#3b088b468374b928f6ab90bfe5db48bf">statecbs</a> = cblist;
<a name="l01994"></a>01994 
<a name="l01995"></a>01995       <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l01996"></a>01996       <span class="keywordflow">return</span> 0;
<a name="l01997"></a>01997    }
<a name="l01998"></a>01998 
<a name="l01999"></a>01999    <span class="keywordflow">if</span> (!<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a> || !<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>)
<a name="l02000"></a>02000       <span class="keywordflow">return</span> -1;
<a name="l02001"></a>02001 
<a name="l02002"></a>02002    <span class="comment">/* This callback type is for only one hint, so get the hint */</span>
<a name="l02003"></a>02003    e = <a class="code" href="pbx_8c.html#a4691f6ae9689498c10c695381f36103">ast_hint_extension</a>(NULL, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>);
<a name="l02004"></a>02004    <span class="keywordflow">if</span> (!e) {
<a name="l02005"></a>02005       <span class="keywordflow">return</span> -1;
<a name="l02006"></a>02006    }
<a name="l02007"></a>02007 
<a name="l02008"></a>02008    <span class="comment">/* Find the hint in the list of hints */</span>
<a name="l02009"></a>02009    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;hints);
<a name="l02010"></a>02010 
<a name="l02011"></a>02011    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;hints, hint, list) {
<a name="l02012"></a>02012       <span class="keywordflow">if</span> (hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a> == e)
<a name="l02013"></a>02013          <span class="keywordflow">break</span>;
<a name="l02014"></a>02014    }
<a name="l02015"></a>02015 
<a name="l02016"></a>02016    <span class="keywordflow">if</span> (!hint) {
<a name="l02017"></a>02017       <span class="comment">/* We have no hint, sorry */</span>
<a name="l02018"></a>02018       <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l02019"></a>02019       <span class="keywordflow">return</span> -1;
<a name="l02020"></a>02020    }
<a name="l02021"></a>02021 
<a name="l02022"></a>02022    <span class="comment">/* Now insert the callback in the callback list  */</span>
<a name="l02023"></a>02023    <span class="keywordflow">if</span> (!(cblist = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*cblist)))) {
<a name="l02024"></a>02024       <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l02025"></a>02025       <span class="keywordflow">return</span> -1;
<a name="l02026"></a>02026    }
<a name="l02027"></a>02027    cblist-&gt;id = <a class="code" href="pbx_8c.html#2749ddcba583cf049c6034826528c0a4">stateid</a>++;    <span class="comment">/* Unique ID for this callback */</span>
<a name="l02028"></a>02028    cblist-&gt;callback = callback;  <span class="comment">/* Pointer to callback routine */</span>
<a name="l02029"></a>02029    cblist-&gt;data = <a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a>;    <span class="comment">/* Data for the callback */</span>
<a name="l02030"></a>02030 
<a name="l02031"></a>02031    cblist-&gt;next = hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a>;
<a name="l02032"></a>02032    hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a> = cblist;
<a name="l02033"></a>02033 
<a name="l02034"></a>02034    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l02035"></a>02035    <span class="keywordflow">return</span> cblist-&gt;id;
<a name="l02036"></a>02036 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2eee51fa21b14e53302712d806421fbb"></a><!-- doxytag: member="pbx.c::ast_extension_state_del" ref="2eee51fa21b14e53302712d806421fbb" args="(int id, ast_state_cb_type callback)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_extension_state_del           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>id</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="pbx_8h.html#a083658b5411c328227915675531df43">ast_state_cb_type</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>callback</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Deletes a registered state change callback by ID. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>id</em>&nbsp;</td><td>of the callback to delete </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callback</em>&nbsp;</td><td>callback</td></tr>
  </table>
</dl>
Removes the callback from list of callbacks<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02039">2039</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="pbx_8c-source.html#l00205">ast_hint::callbacks</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="pbx_8c-source.html#l00193">ast_state_cb::next</a>, and <a class="el" href="pbx_8c-source.html#l00504">statecbs</a>.
<p>
Referenced by <a class="el" href="chan__sip_8c-source.html#l03286">__sip_destroy()</a>, and <a class="el" href="chan__skinny_8c-source.html#l01398">skinny_unregister()</a>.<div class="fragment"><pre class="fragment"><a name="l02040"></a>02040 {
<a name="l02041"></a>02041    <span class="keyword">struct </span><a class="code" href="structast__state__cb.html">ast_state_cb</a> **p_cur = NULL; <span class="comment">/* address of pointer to us */</span>
<a name="l02042"></a>02042    <span class="keywordtype">int</span> ret = -1;
<a name="l02043"></a>02043 
<a name="l02044"></a>02044    <span class="keywordflow">if</span> (!<span class="keywordtype">id</span> &amp;&amp; !<a class="code" href="structast__state__cb.html#924a8ceeac17f54d3be3f8cdf1c04eb2">callback</a>)
<a name="l02045"></a>02045       <span class="keywordflow">return</span> -1;
<a name="l02046"></a>02046 
<a name="l02047"></a>02047    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;hints);
<a name="l02048"></a>02048 
<a name="l02049"></a>02049    <span class="keywordflow">if</span> (!<span class="keywordtype">id</span>) {  <span class="comment">/* id == 0 is a callback without extension */</span>
<a name="l02050"></a>02050       <span class="keywordflow">for</span> (p_cur = &amp;<a class="code" href="pbx_8c.html#3b088b468374b928f6ab90bfe5db48bf">statecbs</a>; *p_cur; p_cur = &amp;(*p_cur)-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l02051"></a>02051          <span class="keywordflow">if</span> ((*p_cur)-&gt;callback == <a class="code" href="structast__state__cb.html#924a8ceeac17f54d3be3f8cdf1c04eb2">callback</a>)
<a name="l02052"></a>02052             <span class="keywordflow">break</span>;
<a name="l02053"></a>02053       }
<a name="l02054"></a>02054    } <span class="keywordflow">else</span> { <span class="comment">/* callback with extension, find the callback based on ID */</span>
<a name="l02055"></a>02055       <span class="keyword">struct </span><a class="code" href="structast__hint.html">ast_hint</a> *hint;
<a name="l02056"></a>02056       <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;hints, hint, list) {
<a name="l02057"></a>02057          <span class="keywordflow">for</span> (p_cur = &amp;hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a>; *p_cur; p_cur = &amp;(*p_cur)-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l02058"></a>02058             <span class="keywordflow">if</span> ((*p_cur)-&gt;id == <span class="keywordtype">id</span>)
<a name="l02059"></a>02059                <span class="keywordflow">break</span>;
<a name="l02060"></a>02060          }
<a name="l02061"></a>02061          <span class="keywordflow">if</span> (*p_cur) <span class="comment">/* found in the inner loop */</span>
<a name="l02062"></a>02062             <span class="keywordflow">break</span>;
<a name="l02063"></a>02063       }
<a name="l02064"></a>02064    }
<a name="l02065"></a>02065    <span class="keywordflow">if</span> (p_cur &amp;&amp; *p_cur) {
<a name="l02066"></a>02066       <span class="keyword">struct </span><a class="code" href="structast__state__cb.html">ast_state_cb</a> *cur = *p_cur;
<a name="l02067"></a>02067       *p_cur = cur-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l02068"></a>02068       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(cur);
<a name="l02069"></a>02069       ret = 0;
<a name="l02070"></a>02070    }
<a name="l02071"></a>02071    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l02072"></a>02072    <span class="keywordflow">return</span> ret;
<a name="l02073"></a>02073 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6f1b63f69b489517c49ccfecdbe1642e"></a><!-- doxytag: member="pbx.c::ast_findlabel_extension" ref="6f1b63f69b489517c49ccfecdbe1642e" args="(struct ast_channel *c, const char *context, const char *exten, const char *label, const char *callerid)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_findlabel_extension           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>label</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>callerid</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Find the priority of an extension that has the specified label. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>this is not important </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>which context to look in </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>exten</em>&nbsp;</td><td>which extension to search for </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>label</em>&nbsp;</td><td>label of the action within the extension to match to priority </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callerid</em>&nbsp;</td><td>callerid to search for</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the priority which matches the given label in the extension or -1 if not found. </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02188">2188</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe1bb8d310644e3f6e2603d80f8464bdda">E_FINDLABEL</a>, and <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l01912">action_originate()</a>, <a class="el" href="manager_8c-source.html#l01726">action_redirect()</a>, <a class="el" href="pbx_8c-source.html#l06287">ast_parseable_goto()</a>, <a class="el" href="app__channelredirect_8c-source.html#l00052">asyncgoto_exec()</a>, and <a class="el" href="res__agi_8c-source.html#l00873">handle_setpriority()</a>.<div class="fragment"><pre class="fragment"><a name="l02189"></a>02189 {
<a name="l02190"></a>02190    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#2377c7b979811bdd54ebf819e5d2037b">pbx_extension_helper</a>(c, NULL, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, 0, label, callerid, <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe1bb8d310644e3f6e2603d80f8464bdda">E_FINDLABEL</a>);
<a name="l02191"></a>02191 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="7139f616e9b477dc630ba7cec0c22df4"></a><!-- doxytag: member="pbx.c::ast_findlabel_extension2" ref="7139f616e9b477dc630ba7cec0c22df4" args="(struct ast_channel *c, struct ast_context *con, const char *exten, const char *label, const char *callerid)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_findlabel_extension2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>label</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>callerid</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Find the priority of an extension that has the specified label. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>This function is the same as ast_findlabel_extension, except that it accepts a pointer to an <a class="el" href="structast__context.html">ast_context</a> structure to specify the context instead of the name of the context. Otherwise, the functions behave the same. </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02193">2193</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe1bb8d310644e3f6e2603d80f8464bdda">E_FINDLABEL</a>, and <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01332">pbx_load_config()</a>.<div class="fragment"><pre class="fragment"><a name="l02194"></a>02194 {
<a name="l02195"></a>02195    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#2377c7b979811bdd54ebf819e5d2037b">pbx_extension_helper</a>(c, con, NULL, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, 0, label, callerid, <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe1bb8d310644e3f6e2603d80f8464bdda">E_FINDLABEL</a>);
<a name="l02196"></a>02196 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="fc067f1890b3fdeeacbc538e92a39fbd"></a><!-- doxytag: member="pbx.c::ast_func_read" ref="fc067f1890b3fdeeacbc538e92a39fbd" args="(struct ast_channel *chan, const char *function, char *workspace, size_t len)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_func_read           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>function</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>workspace</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
executes a read operation on a function 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>Channel to execute on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>function</em>&nbsp;</td><td>Data containing the function call string (will be modified) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>workspace</em>&nbsp;</td><td>A pointer to safe memory to use for a return value </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>the number of bytes in workspace</td></tr>
  </table>
</dl>
This application executes a function in read mode on a given channel.<p>
<dl compact><dt><b>Returns:</b></dt><dd>zero on success, non-zero on failure </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01437">1437</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l01345">ast_custom_function_find()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>, <a class="el" href="file_8c-source.html#l00207">copy()</a>, <a class="el" href="pbx_8c-source.html#l01420">func_args()</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, and <a class="el" href="structast__custom__function.html#7fa57fbc014b0b862cf2bbeb43888f5e">ast_custom_function::read</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l01548">action_getvar()</a>, <a class="el" href="res__agi_8c-source.html#l01187">handle_getvariable()</a>, and <a class="el" href="pbx_8c-source.html#l01468">pbx_substitute_variables_helper_full()</a>.<div class="fragment"><pre class="fragment"><a name="l01438"></a>01438 {
<a name="l01439"></a>01439    <span class="keywordtype">char</span> *<a class="code" href="file_8c.html#231def655f9282cd0b10171d366f3d38">copy</a> = <a class="code" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>(function);
<a name="l01440"></a>01440    <span class="keywordtype">char</span> *args = <a class="code" href="pbx_8c.html#3d2c812ce63291930182ea8c9edb17b8">func_args</a>(copy);
<a name="l01441"></a>01441    <span class="keyword">struct </span><a class="code" href="structast__custom__function.html">ast_custom_function</a> *acfptr = <a class="code" href="pbx_8c.html#2f6033daa3dd2a6a51ee380a86a783ba">ast_custom_function_find</a>(copy);
<a name="l01442"></a>01442 
<a name="l01443"></a>01443    <span class="keywordflow">if</span> (acfptr == NULL)
<a name="l01444"></a>01444       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Function %s not registered\n"</span>, copy);
<a name="l01445"></a>01445    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!acfptr-&gt;<a class="code" href="structast__custom__function.html#7fa57fbc014b0b862cf2bbeb43888f5e">read</a>)
<a name="l01446"></a>01446       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Function %s cannot be read\n"</span>, copy);
<a name="l01447"></a>01447    <span class="keywordflow">else</span>
<a name="l01448"></a>01448       <span class="keywordflow">return</span> acfptr-&gt;<a class="code" href="structast__custom__function.html#7fa57fbc014b0b862cf2bbeb43888f5e">read</a>(chan, copy, args, workspace, <a class="code" href="utils_8h.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a>);
<a name="l01449"></a>01449    <span class="keywordflow">return</span> -1;
<a name="l01450"></a>01450 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2432c0e88181cb3ba2c1a2764b0a6238"></a><!-- doxytag: member="pbx.c::ast_func_write" ref="2432c0e88181cb3ba2c1a2764b0a6238" args="(struct ast_channel *chan, const char *function, const char *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_func_write           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>function</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
executes a write operation on a function 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>Channel to execute on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>function</em>&nbsp;</td><td>Data containing the function call string (will be modified) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>A value parameter to pass for writing</td></tr>
  </table>
</dl>
This application executes a function in write mode on a given channel.<p>
<dl compact><dt><b>Returns:</b></dt><dd>zero on success, non-zero on failure </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01452">1452</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l01345">ast_custom_function_find()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>, <a class="el" href="file_8c-source.html#l00207">copy()</a>, <a class="el" href="pbx_8c-source.html#l01420">func_args()</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, and <a class="el" href="structast__custom__function.html#07c22fb96be36e9fdeed80ce4067f2a2">ast_custom_function::write</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l05794">pbx_builtin_pushvar_helper()</a>, and <a class="el" href="pbx_8c-source.html#l05821">pbx_builtin_setvar_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l01453"></a>01453 {
<a name="l01454"></a>01454    <span class="keywordtype">char</span> *<a class="code" href="file_8c.html#231def655f9282cd0b10171d366f3d38">copy</a> = <a class="code" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>(function);
<a name="l01455"></a>01455    <span class="keywordtype">char</span> *args = <a class="code" href="pbx_8c.html#3d2c812ce63291930182ea8c9edb17b8">func_args</a>(copy);
<a name="l01456"></a>01456    <span class="keyword">struct </span><a class="code" href="structast__custom__function.html">ast_custom_function</a> *acfptr = <a class="code" href="pbx_8c.html#2f6033daa3dd2a6a51ee380a86a783ba">ast_custom_function_find</a>(copy);
<a name="l01457"></a>01457 
<a name="l01458"></a>01458    <span class="keywordflow">if</span> (acfptr == NULL)
<a name="l01459"></a>01459       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Function %s not registered\n"</span>, copy);
<a name="l01460"></a>01460    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!acfptr-&gt;<a class="code" href="structast__custom__function.html#07c22fb96be36e9fdeed80ce4067f2a2">write</a>)
<a name="l01461"></a>01461       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Function %s cannot be written to\n"</span>, copy);
<a name="l01462"></a>01462    <span class="keywordflow">else</span>
<a name="l01463"></a>01463       <span class="keywordflow">return</span> acfptr-&gt;<a class="code" href="structast__custom__function.html#07c22fb96be36e9fdeed80ce4067f2a2">write</a>(chan, copy, args, value);
<a name="l01464"></a>01464 
<a name="l01465"></a>01465    <span class="keywordflow">return</span> -1;
<a name="l01466"></a>01466 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4571490d866dec074492c52ea27a304b"></a><!-- doxytag: member="pbx.c::ast_get_context_name" ref="4571490d866dec074492c52ea27a304b" args="(struct ast_context *con)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_context_name           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>con</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06100">6100</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04304">ast_context_add_include2()</a>, <a class="el" href="pbx_8c-source.html#l04386">ast_context_add_switch2()</a>, <a class="el" href="pbx_8c-source.html#l02823">ast_context_lockmacro()</a>, <a class="el" href="pbx_8c-source.html#l02851">ast_context_unlockmacro()</a>, <a class="el" href="pbx_8c-source.html#l06243">ast_context_verify_includes()</a>, <a class="el" href="pbx__config_8c-source.html#l01033">complete_context_add_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01104">complete_context_add_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00619">complete_context_add_include()</a>, <a class="el" href="pbx__config_8c-source.html#l00449">complete_context_remove_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01187">complete_context_remove_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00211">complete_context_remove_include()</a>, <a class="el" href="pbx_8c-source.html#l03275">complete_show_dialplan_context()</a>, <a class="el" href="pbx__dundi_8c-source.html#l03615">dundi_precache_full()</a>, <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>, <a class="el" href="app__while_8c-source.html#l00123">find_matching_endwhile()</a>, <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>, <a class="el" href="pbx_8c-source.html#l03142">handle_show_hints()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06101"></a>06101 {
<a name="l06102"></a>06102    <span class="keywordflow">return</span> con ? con-&gt;name : NULL;
<a name="l06103"></a>06103 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="76308d8bcceb0331e0d4736df41b1412"></a><!-- doxytag: member="pbx.c::ast_get_context_registrar" ref="76308d8bcceb0331e0d4736df41b1412" args="(struct ast_context *c)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_context_registrar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>c</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06138">6138</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00171">ast_context::registrar</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06139"></a>06139 {
<a name="l06140"></a>06140    <span class="keywordflow">return</span> c ? c-&gt;<a class="code" href="structast__context.html#5940569cd1d60781f856f93235b072ee">registrar</a> : NULL;
<a name="l06141"></a>06141 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c8eaa4fc248390fee258e7d2b2ff3490"></a><!-- doxytag: member="pbx.c::ast_get_extension_app" ref="c8eaa4fc248390fee258e7d2b2ff3490" args="(struct ast_exten *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_extension_app           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06168">6168</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00125">ast_exten::app</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02076">ast_add_hint()</a>, <a class="el" href="pbx_8c-source.html#l01812">ast_extension_state2()</a>, <a class="el" href="pbx_8c-source.html#l02166">ast_get_hint()</a>, <a class="el" href="pbx_8c-source.html#l01920">ast_hint_state_changed()</a>, <a class="el" href="app__while_8c-source.html#l00123">find_matching_endwhile()</a>, <a class="el" href="pbx_8c-source.html#l03142">handle_show_hints()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03315">print_ext()</a>.<div class="fragment"><pre class="fragment"><a name="l06169"></a>06169 {
<a name="l06170"></a>06170    <span class="keywordflow">return</span> e ? e-&gt;<a class="code" href="structast__exten.html#d2a57dc1d883fd21fb9951699df71cc7">app</a> : NULL;
<a name="l06171"></a>06171 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4a723bd9d782fe0a3fb16d00268ec5a4"></a><!-- doxytag: member="pbx.c::ast_get_extension_app_data" ref="4a723bd9d782fe0a3fb16d00268ec5a4" args="(struct ast_exten *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void* ast_get_extension_app_data           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06173">6173</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00127">ast_exten::data</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02166">ast_get_hint()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03315">print_ext()</a>.<div class="fragment"><pre class="fragment"><a name="l06174"></a>06174 {
<a name="l06175"></a>06175    <span class="keywordflow">return</span> e ? e-&gt;<a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a> : NULL;
<a name="l06176"></a>06176 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="05032ac07f5935587193e7da044e30de"></a><!-- doxytag: member="pbx.c::ast_get_extension_cidmatch" ref="05032ac07f5935587193e7da044e30de" args="(struct ast_exten *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_extension_cidmatch           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06163">6163</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00121">ast_exten::cidmatch</a>.
<p>
Referenced by <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>.<div class="fragment"><pre class="fragment"><a name="l06164"></a>06164 {
<a name="l06165"></a>06165    <span class="keywordflow">return</span> e ? e-&gt;<a class="code" href="structast__exten.html#2ef4524f32df05033fd0502689de872e">cidmatch</a> : NULL;
<a name="l06166"></a>06166 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="61636cd55acce8616de92323b8a427b9"></a><!-- doxytag: member="pbx.c::ast_get_extension_context" ref="61636cd55acce8616de92323b8a427b9" args="(struct ast_exten *exten)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a>* ast_get_extension_context           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>exten</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06105">6105</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00124">ast_exten::parent</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03142">handle_show_hints()</a>.<div class="fragment"><pre class="fragment"><a name="l06106"></a>06106 {
<a name="l06107"></a>06107    <span class="keywordflow">return</span> exten ? exten-&gt;<a class="code" href="structast__exten.html#d0e45878043844ffc41aac437e86b602">parent</a> : NULL;
<a name="l06108"></a>06108 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6647bb905ee41ab599c1e9bfe5f086de"></a><!-- doxytag: member="pbx.c::ast_get_extension_label" ref="6647bb905ee41ab599c1e9bfe5f086de" args="(struct ast_exten *exten)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_extension_label           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>exten</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06115">6115</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00123">ast_exten::label</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06116"></a>06116 {
<a name="l06117"></a>06117    <span class="keywordflow">return</span> exten ? exten-&gt;<a class="code" href="structast__exten.html#d304ba20e96d87411588eeabac850e34">label</a> : NULL;
<a name="l06118"></a>06118 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8c7f1a8dd6fbdb6df987ac164ef7fdfc"></a><!-- doxytag: member="pbx.c::ast_get_extension_matchcid" ref="8c7f1a8dd6fbdb6df987ac164ef7fdfc" args="(struct ast_exten *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_get_extension_matchcid           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06158">6158</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00120">ast_exten::matchcid</a>.
<p>
Referenced by <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>.<div class="fragment"><pre class="fragment"><a name="l06159"></a>06159 {
<a name="l06160"></a>06160    <span class="keywordflow">return</span> e ? e-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a> : 0;
<a name="l06161"></a>06161 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4318ec15d92ac47de94902f6aba4c114"></a><!-- doxytag: member="pbx.c::ast_get_extension_name" ref="4318ec15d92ac47de94902f6aba4c114" args="(struct ast_exten *exten)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_extension_name           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>exten</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06110">6110</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00119">ast_exten::exten</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02076">ast_add_hint()</a>, <a class="el" href="pbx__config_8c-source.html#l00449">complete_context_remove_extension()</a>, <a class="el" href="pbx__dundi_8c-source.html#l03615">dundi_precache_full()</a>, <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>, <a class="el" href="pbx_8c-source.html#l03142">handle_show_hints()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06111"></a>06111 {
<a name="l06112"></a>06112    <span class="keywordflow">return</span> exten ? exten-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a> : NULL;
<a name="l06113"></a>06113 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ecebedf381a09dd2630dc03e49b83112"></a><!-- doxytag: member="pbx.c::ast_get_extension_priority" ref="ecebedf381a09dd2630dc03e49b83112" args="(struct ast_exten *exten)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_get_extension_priority           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>exten</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06130">6130</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00122">ast_exten::priority</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l00449">complete_context_remove_extension()</a>, <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03315">print_ext()</a>.<div class="fragment"><pre class="fragment"><a name="l06131"></a>06131 {
<a name="l06132"></a>06132    <span class="keywordflow">return</span> exten ? exten-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a> : -1;
<a name="l06133"></a>06133 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="20537e2517918a112d0b738d8c70cae2"></a><!-- doxytag: member="pbx.c::ast_get_extension_registrar" ref="20537e2517918a112d0b738d8c70cae2" args="(struct ast_exten *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_extension_registrar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06143">6143</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00130">ast_exten::registrar</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06144"></a>06144 {
<a name="l06145"></a>06145    <span class="keywordflow">return</span> e ? e-&gt;<a class="code" href="structast__exten.html#5940569cd1d60781f856f93235b072ee">registrar</a> : NULL;
<a name="l06146"></a>06146 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b654f3264742a57f212c38761672a6c0"></a><!-- doxytag: member="pbx.c::ast_get_hint" ref="b654f3264742a57f212c38761672a6c0" args="(char *hint, int hintsize, char *name, int namesize, struct ast_channel *c, const char *context, const char *exten)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_get_hint           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>hint</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>maxnamelen</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
If an extension hint exists, return non-zero. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>hint</em>&nbsp;</td><td>buffer for hint </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>maxlen</em>&nbsp;</td><td>size of hint buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>buffer for name portion of hint </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>maxnamelen</em>&nbsp;</td><td>size of name buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>this is not important </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>which context to look in </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>exten</em>&nbsp;</td><td>which extension to search for</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>If an extension within the given context with the priority PRIORITY_HINT is found a non zero value will be returned. Otherwise, 0 is returned. </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02166">2166</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06168">ast_get_extension_app()</a>, <a class="el" href="pbx_8c-source.html#l06173">ast_get_extension_app_data()</a>, and <a class="el" href="pbx_8c-source.html#l01799">ast_hint_extension()</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l02085">action_extensionstate()</a>, <a class="el" href="app__dial_8c-source.html#l00392">get_cid_name()</a>, <a class="el" href="manager_8c-source.html#l02654">manager_state_cb()</a>, <a class="el" href="pbx_8c-source.html#l01132">pbx_retrieve_variable()</a>, <a class="el" href="chan__skinny_8c-source.html#l01719">skinny_extensionstate_cb()</a>, and <a class="el" href="chan__sip_8c-source.html#l07533">transmit_state_notify()</a>.<div class="fragment"><pre class="fragment"><a name="l02167"></a>02167 {
<a name="l02168"></a>02168    <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *e = <a class="code" href="pbx_8c.html#a4691f6ae9689498c10c695381f36103">ast_hint_extension</a>(c, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>);
<a name="l02169"></a>02169 
<a name="l02170"></a>02170    <span class="keywordflow">if</span> (e) {
<a name="l02171"></a>02171       <span class="keywordflow">if</span> (hint)
<a name="l02172"></a>02172          ast_copy_string(hint, <a class="code" href="pbx_8c.html#c8eaa4fc248390fee258e7d2b2ff3490">ast_get_extension_app</a>(e), hintsize);
<a name="l02173"></a>02173       <span class="keywordflow">if</span> (<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>) {
<a name="l02174"></a>02174          <span class="keyword">const</span> <span class="keywordtype">char</span> *tmp = <a class="code" href="pbx_8c.html#4a723bd9d782fe0a3fb16d00268ec5a4">ast_get_extension_app_data</a>(e);
<a name="l02175"></a>02175          <span class="keywordflow">if</span> (tmp)
<a name="l02176"></a>02176             ast_copy_string(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, tmp, namesize);
<a name="l02177"></a>02177       }
<a name="l02178"></a>02178       <span class="keywordflow">return</span> -1;
<a name="l02179"></a>02179    }
<a name="l02180"></a>02180    <span class="keywordflow">return</span> 0;
<a name="l02181"></a>02181 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8362b5fbecbf06d68596f1361a817971"></a><!-- doxytag: member="pbx.c::ast_get_ignorepat_name" ref="8362b5fbecbf06d68596f1361a817971" args="(struct ast_ignorepat *ip)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_ignorepat_name           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__ignorepat.html">ast_ignorepat</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ip</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06125">6125</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00161">ast_ignorepat::pattern</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01187">complete_context_remove_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00151">lookup_c_ip()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06126"></a>06126 {
<a name="l06127"></a>06127    <span class="keywordflow">return</span> ip ? ip-&gt;<a class="code" href="structast__ignorepat.html#6ed092b904da0ceba9109608322e7880">pattern</a> : NULL;
<a name="l06128"></a>06128 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ecf759381e5bb2d13dbf2188d6728217"></a><!-- doxytag: member="pbx.c::ast_get_ignorepat_registrar" ref="ecf759381e5bb2d13dbf2188d6728217" args="(struct ast_ignorepat *ip)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_ignorepat_registrar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__ignorepat.html">ast_ignorepat</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ip</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06153">6153</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00159">ast_ignorepat::registrar</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06154"></a>06154 {
<a name="l06155"></a>06155    <span class="keywordflow">return</span> ip ? ip-&gt;<a class="code" href="structast__ignorepat.html#5940569cd1d60781f856f93235b072ee">registrar</a> : NULL;
<a name="l06156"></a>06156 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="04500f482fe3f27ee84f53c832f49c92"></a><!-- doxytag: member="pbx.c::ast_get_include_name" ref="04500f482fe3f27ee84f53c832f49c92" args="(struct ast_include *inc)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_include_name           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__include.html">ast_include</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>inc</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06120">6120</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00137">ast_include::name</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l00211">complete_context_remove_include()</a>, <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>, <a class="el" href="pbx__config_8c-source.html#l00137">lookup_ci()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06121"></a>06121 {
<a name="l06122"></a>06122    <span class="keywordflow">return</span> inc ? inc-&gt;<a class="code" href="structast__include.html#b068931cc450442b63f5b3d276ea4297">name</a> : NULL;
<a name="l06123"></a>06123 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a10e2a34982bf1e3c4df8fbf94a8f858"></a><!-- doxytag: member="pbx.c::ast_get_include_registrar" ref="a10e2a34982bf1e3c4df8fbf94a8f858" args="(struct ast_include *i)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_include_registrar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__include.html">ast_include</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>i</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06148">6148</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00139">ast_include::registrar</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06149"></a>06149 {
<a name="l06150"></a>06150    <span class="keywordflow">return</span> i ? i-&gt;<a class="code" href="structast__include.html#5940569cd1d60781f856f93235b072ee">registrar</a> : NULL;
<a name="l06151"></a>06151 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ee960249076eea022f3aaa855b0a2475"></a><!-- doxytag: member="pbx.c::ast_get_switch_data" ref="ee960249076eea022f3aaa855b0a2475" args="(struct ast_sw *sw)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_switch_data           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__sw.html">ast_sw</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>sw</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06183">6183</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00150">ast_sw::data</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06184"></a>06184 {
<a name="l06185"></a>06185    <span class="keywordflow">return</span> sw ? sw-&gt;<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a> : NULL;
<a name="l06186"></a>06186 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="e78e1da5bf7f86cd550128a0cc440658"></a><!-- doxytag: member="pbx.c::ast_get_switch_name" ref="e78e1da5bf7f86cd550128a0cc440658" args="(struct ast_sw *sw)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_switch_name           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__sw.html">ast_sw</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>sw</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06178">6178</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00148">ast_sw::name</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06179"></a>06179 {
<a name="l06180"></a>06180    <span class="keywordflow">return</span> sw ? sw-&gt;<a class="code" href="structast__sw.html#b068931cc450442b63f5b3d276ea4297">name</a> : NULL;
<a name="l06181"></a>06181 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6e9fbaaa189820f4a0c36a1ad4dfca6d"></a><!-- doxytag: member="pbx.c::ast_get_switch_registrar" ref="6e9fbaaa189820f4a0c36a1ad4dfca6d" args="(struct ast_sw *sw)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_switch_registrar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__sw.html">ast_sw</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>sw</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06188">6188</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00149">ast_sw::registrar</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06189"></a>06189 {
<a name="l06190"></a>06190    <span class="keywordflow">return</span> sw ? sw-&gt;<a class="code" href="structast__sw.html#5940569cd1d60781f856f93235b072ee">registrar</a> : NULL;
<a name="l06191"></a>06191 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="66e271b78f5b09452a521e220c223e1e"></a><!-- doxytag: member="pbx.c::ast_goto_if_exists" ref="66e271b78f5b09452a521e220c223e1e" args="(struct ast_channel *chan, const char *context, const char *exten, int priority)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_goto_if_exists           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06277">6277</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06258">__ast_goto_if_exists()</a>.
<p>
Referenced by <a class="el" href="app__queue_8c-source.html#l03326">aqm_exec()</a>, <a class="el" href="app__authenticate_8c-source.html#l00094">auth_exec()</a>, <a class="el" href="app__talkdetect_8c-source.html#l00063">background_detect_exec()</a>, <a class="el" href="app__chanisavail_8c-source.html#l00069">chanavail_exec()</a>, <a class="el" href="app__chanspy_8c-source.html#l00266">channel_spy()</a>, <a class="el" href="app__chanspy_8c-source.html#l00465">common_exec()</a>, <a class="el" href="app__controlplayback_8c-source.html#l00075">controlplayback_exec()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="app__directory_8c-source.html#l00400">do_directory()</a>, <a class="el" href="app__voicemail_8c-source.html#l02956">leave_voicemail()</a>, <a class="el" href="app__dial_8c-source.html#l00373">onedigit_goto()</a>, <a class="el" href="app__osplookup_8c-source.html#l01311">ospauth_exec()</a>, <a class="el" href="app__osplookup_8c-source.html#l01803">ospfinished_exec()</a>, <a class="el" href="app__osplookup_8c-source.html#l01415">osplookup_exec()</a>, <a class="el" href="app__osplookup_8c-source.html#l01618">ospnext_exec()</a>, <a class="el" href="app__directory_8c-source.html#l00261">play_mailbox_owner()</a>, <a class="el" href="app__playback_8c-source.html#l00378">playback_exec()</a>, <a class="el" href="app__queue_8c-source.html#l03157">pqm_exec()</a>, <a class="el" href="app__privacy_8c-source.html#l00078">privacy_exec()</a>, <a class="el" href="app__queue_8c-source.html#l03263">rqm_exec()</a>, <a class="el" href="app__image_8c-source.html#l00063">sendimage_exec()</a>, <a class="el" href="app__sendtext_8c-source.html#l00067">sendtext_exec()</a>, <a class="el" href="app__url_8c-source.html#l00070">sendurl_exec()</a>, <a class="el" href="app__system_8c-source.html#l00085">system_exec_helper()</a>, <a class="el" href="app__transfer_8c-source.html#l00068">transfer_exec()</a>, <a class="el" href="app__queue_8c-source.html#l03210">upqm_exec()</a>, <a class="el" href="app__queue_8c-source.html#l01320">valid_exit()</a>, <a class="el" href="app__voicemail_8c-source.html#l07081">vm_box_exists()</a>, <a class="el" href="app__voicemail_8c-source.html#l06944">vm_exec()</a>, and <a class="el" href="app__dial_8c-source.html#l00532">wait_for_answer()</a>.<div class="fragment"><pre class="fragment"><a name="l06278"></a>06278 {
<a name="l06279"></a>06279    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#ea67e0eddc31f7145c5c9c7991255636">__ast_goto_if_exists</a>(chan, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a>, 0);
<a name="l06280"></a>06280 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a4691f6ae9689498c10c695381f36103"></a><!-- doxytag: member="pbx.c::ast_hint_extension" ref="a4691f6ae9689498c10c695381f36103" args="(struct ast_channel *c, const char *context, const char *exten)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static struct <a class="el" href="structast__exten.html">ast_exten</a>* ast_hint_extension           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
ast_hint_extension: Find hint for given extension in context 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01799">1799</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06069">ast_rdlock_contexts()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe437691af9bdd09d1ad4c2e5b087d5717">E_MATCH</a>, <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>, <a class="el" href="pbx_8h-source.html#l00044">PRIORITY_HINT</a>, and <a class="el" href="pbx_8c-source.html#l00927">pbx_find_info::stacklen</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l01909">ast_extension_state()</a>, <a class="el" href="pbx_8c-source.html#l01964">ast_extension_state_add()</a>, <a class="el" href="pbx_8c-source.html#l02166">ast_get_hint()</a>, and <a class="el" href="pbx_8c-source.html#l03936">ast_merge_contexts_and_delete()</a>.<div class="fragment"><pre class="fragment"><a name="l01800"></a>01800 {
<a name="l01801"></a>01801    <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *e;
<a name="l01802"></a>01802    <span class="keyword">struct </span><a class="code" href="structpbx__find__info.html">pbx_find_info</a> q = { .<a class="code" href="structpbx__find__info.html#c824947321b49de41aed9aaf089999dd">stacklen</a> = 0 }; <span class="comment">/* the rest is set in pbx_find_context */</span>
<a name="l01803"></a>01803 
<a name="l01804"></a>01804    <a class="code" href="pbx_8c.html#1b60f4b570102084989c86fd02ca6536">ast_rdlock_contexts</a>();
<a name="l01805"></a>01805    e = <a class="code" href="pbx_8c.html#b3ba8b98731731a7e47467140cc6a6a3">pbx_find_extension</a>(c, NULL, &amp;q, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="code" href="pbx_8h.html#ab1e94ec9073ecc8bcedd7b11dd82001">PRIORITY_HINT</a>, NULL, <span class="stringliteral">""</span>, <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe437691af9bdd09d1ad4c2e5b087d5717">E_MATCH</a>);
<a name="l01806"></a>01806    <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l01807"></a>01807 
<a name="l01808"></a>01808    <span class="keywordflow">return</span> e;
<a name="l01809"></a>01809 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="5bc7455c31be4c32a90e55a101009fdf"></a><!-- doxytag: member="pbx.c::ast_hint_state_changed" ref="5bc7455c31be4c32a90e55a101009fdf" args="(const char *device)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_hint_state_changed           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>device</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01920">1920</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l01812">ast_extension_state2()</a>, <a class="el" href="pbx_8c-source.html#l06168">ast_get_extension_app()</a>, <a class="el" href="channel_8h-source.html#l00139">AST_MAX_EXTENSION</a>, <a class="el" href="linkedlists_8h-source.html#l00060">AST_RWLIST_RDLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="adsistub_8c-source.html#l00065">buf</a>, <a class="el" href="pbx_8c-source.html#l00192">ast_state_cb::callback</a>, <a class="el" href="pbx_8c-source.html#l00205">ast_hint::callbacks</a>, <a class="el" href="pbx_8c-source.html#l00191">ast_state_cb::data</a>, <a class="el" href="pbx_8c-source.html#l00203">ast_hint::exten</a>, <a class="el" href="pbx_8c-source.html#l00119">ast_exten::exten</a>, <a class="el" href="pbx_8c-source.html#l00204">ast_hint::laststate</a>, <a class="el" href="pbx_8c-source.html#l00193">ast_state_cb::next</a>, <a class="el" href="pbx_8c-source.html#l00124">ast_exten::parent</a>, <a class="el" href="chan__mgcp_8c-source.html#l01734">parse()</a>, <a class="el" href="pbx_8c-source.html#l00504">statecbs</a>, and <a class="el" href="strcompat_8c-source.html#l00035">strsep()</a>.
<p>
Referenced by <a class="el" href="devicestate_8c-source.html#l00421">do_state_change()</a>.<div class="fragment"><pre class="fragment"><a name="l01921"></a>01921 {
<a name="l01922"></a>01922    <span class="keyword">struct </span><a class="code" href="structast__hint.html">ast_hint</a> *hint;
<a name="l01923"></a>01923 
<a name="l01924"></a>01924    <a class="code" href="linkedlists_8h.html#23c0c844e5abcb474854867b408e3be8">AST_RWLIST_RDLOCK</a>(&amp;hints);
<a name="l01925"></a>01925 
<a name="l01926"></a>01926    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;hints, hint, list) {
<a name="l01927"></a>01927       <span class="keyword">struct </span><a class="code" href="structast__state__cb.html">ast_state_cb</a> *cblist;
<a name="l01928"></a>01928       <span class="keywordtype">char</span> <a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>[<a class="code" href="channel_8h.html#729d25558b5b1940c1a6ff9d806f944c">AST_MAX_EXTENSION</a>];
<a name="l01929"></a>01929       <span class="keywordtype">char</span> *<a class="code" href="chan__mgcp_8c.html#96d2a4ae057584ce23ca92b03303bd2f">parse</a> = buf;
<a name="l01930"></a>01930       <span class="keywordtype">char</span> *cur;
<a name="l01931"></a>01931       <span class="keywordtype">int</span> <a class="code" href="structstate.html">state</a>;
<a name="l01932"></a>01932 
<a name="l01933"></a>01933       ast_copy_string(buf, <a class="code" href="pbx_8c.html#c8eaa4fc248390fee258e7d2b2ff3490">ast_get_extension_app</a>(hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>), <span class="keyword">sizeof</span>(buf));
<a name="l01934"></a>01934       <span class="keywordflow">while</span> ( (cur = <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;parse, <span class="stringliteral">"&amp;"</span>)) ) {
<a name="l01935"></a>01935          <span class="keywordflow">if</span> (!strcasecmp(cur, device))
<a name="l01936"></a>01936             <span class="keywordflow">break</span>;
<a name="l01937"></a>01937       }
<a name="l01938"></a>01938       <span class="keywordflow">if</span> (!cur)
<a name="l01939"></a>01939          <span class="keywordflow">continue</span>;
<a name="l01940"></a>01940 
<a name="l01941"></a>01941       <span class="comment">/* Get device state for this hint */</span>
<a name="l01942"></a>01942       state = <a class="code" href="pbx_8c.html#6aecfed8ee63e22940bc2d842f0a536c">ast_extension_state2</a>(hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>);
<a name="l01943"></a>01943 
<a name="l01944"></a>01944       <span class="keywordflow">if</span> ((state == -1) || (state == hint-&gt;<a class="code" href="structast__hint.html#406c995dd8ced9add7c7f6eb95532fe7">laststate</a>))
<a name="l01945"></a>01945          <span class="keywordflow">continue</span>;
<a name="l01946"></a>01946 
<a name="l01947"></a>01947       <span class="comment">/* Device state changed since last check - notify the watchers */</span>
<a name="l01948"></a>01948 
<a name="l01949"></a>01949       <span class="comment">/* For general callbacks */</span>
<a name="l01950"></a>01950       <span class="keywordflow">for</span> (cblist = <a class="code" href="pbx_8c.html#3b088b468374b928f6ab90bfe5db48bf">statecbs</a>; cblist; cblist = cblist-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>)
<a name="l01951"></a>01951          cblist-&gt;<a class="code" href="structast__state__cb.html#924a8ceeac17f54d3be3f8cdf1c04eb2">callback</a>(hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>-&gt;<a class="code" href="structast__exten.html#d0e45878043844ffc41aac437e86b602">parent</a>-&gt;name, hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>, state, cblist-&gt;<a class="code" href="structast__state__cb.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l01952"></a>01952 
<a name="l01953"></a>01953       <span class="comment">/* For extension callbacks */</span>
<a name="l01954"></a>01954       <span class="keywordflow">for</span> (cblist = hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a>; cblist; cblist = cblist-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>)
<a name="l01955"></a>01955          cblist-&gt;<a class="code" href="structast__state__cb.html#924a8ceeac17f54d3be3f8cdf1c04eb2">callback</a>(hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>-&gt;<a class="code" href="structast__exten.html#d0e45878043844ffc41aac437e86b602">parent</a>-&gt;name, hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>, state, cblist-&gt;<a class="code" href="structast__state__cb.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l01956"></a>01956 
<a name="l01957"></a>01957       hint-&gt;<a class="code" href="structast__hint.html#406c995dd8ced9add7c7f6eb95532fe7">laststate</a> = state;   <span class="comment">/* record we saw the change */</span>
<a name="l01958"></a>01958    }
<a name="l01959"></a>01959 
<a name="l01960"></a>01960    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l01961"></a>01961 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3c8a7255ea36a7270c24fd5ccccc56f6"></a><!-- doxytag: member="pbx.c::ast_ignore_pattern" ref="3c8a7255ea36a7270c24fd5ccccc56f6" args="(const char *context, const char *pattern)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_ignore_pattern           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>pattern</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Checks to see if a number should be ignored. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>context to search within </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pattern</em>&nbsp;</td><td>to check whether it should be ignored or not</td></tr>
  </table>
</dl>
Check if a number should be ignored with respect to dialtone cancellation.<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if the pattern should not be ignored </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>non-zero</em>&nbsp;</td><td>if the pattern should be ignored </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04542">4542</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00889">ast_context_find()</a>, <a class="el" href="pbx_8c-source.html#l00877">ast_extension_match()</a>, <a class="el" href="pbx_8c-source.html#l00170">ast_context::ignorepats</a>, <a class="el" href="pbx_8c-source.html#l00160">ast_ignorepat::next</a>, and <a class="el" href="pbx_8c-source.html#l00161">ast_ignorepat::pattern</a>.
<p>
Referenced by <a class="el" href="app_8c-source.html#l00065">ast_app_dtget()</a>, <a class="el" href="app__disa_8c-source.html#l00113">disa_exec()</a>, <a class="el" href="chan__iax2_8c-source.html#l06220">dp_lookup()</a>, <a class="el" href="pbx__dundi_8c-source.html#l00532">dundi_lookup_local()</a>, <a class="el" href="chan__skinny_8c-source.html#l03920">handle_soft_key_event_message()</a>, <a class="el" href="chan__skinny_8c-source.html#l03102">handle_stimulus_message()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02638">mgcp_ss()</a>, <a class="el" href="chan__skinny_8c-source.html#l02365">skinny_ss()</a>, and <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>.<div class="fragment"><pre class="fragment"><a name="l04543"></a>04543 {
<a name="l04544"></a>04544    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *con = <a class="code" href="pbx_8c.html#f8c5b4e7d06b7aff72707b5d7d7c94e1">ast_context_find</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l04545"></a>04545    <span class="keywordflow">if</span> (con) {
<a name="l04546"></a>04546       <span class="keyword">struct </span><a class="code" href="structast__ignorepat.html">ast_ignorepat</a> *pat;
<a name="l04547"></a>04547       <span class="keywordflow">for</span> (pat = con-&gt;<a class="code" href="structast__context.html#79a69e07731e7d02c0f52f19bab94dcb">ignorepats</a>; pat; pat = pat-&gt;<a class="code" href="structast__ignorepat.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l04548"></a>04548          <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#fee4ebd3f1d86114fe9bb33931f9a6cf">ast_extension_match</a>(pat-&gt;<a class="code" href="structast__ignorepat.html#6ed092b904da0ceba9109608322e7880">pattern</a>, <a class="code" href="structast__ignorepat.html#6ed092b904da0ceba9109608322e7880">pattern</a>))
<a name="l04549"></a>04549             <span class="keywordflow">return</span> 1;
<a name="l04550"></a>04550       }
<a name="l04551"></a>04551    }
<a name="l04552"></a>04552 
<a name="l04553"></a>04553    <span class="keywordflow">return</span> 0;
<a name="l04554"></a>04554 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="16620a4fec6f26db370f97db3c778b05"></a><!-- doxytag: member="pbx.c::AST_LIST_HEAD" ref="16620a4fec6f26db370f97db3c778b05" args="(store_hints, store_hint)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">AST_LIST_HEAD           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">store_hints&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structstore__hint.html">store_hint</a>&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6e9c6f3a112b82510968f729fa3765bc"></a><!-- doxytag: member="pbx.c::ast_matchmore_extension" ref="6e9c6f3a112b82510968f729fa3765bc" args="(struct ast_channel *c, const char *context, const char *exten, int priority, const char *callerid)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_matchmore_extension           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>callerid</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Looks to see if adding anything to this extension might match something. (exists ^ canmatch). 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>not really important XXX </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>context to serach within </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>exten</em>&nbsp;</td><td>extension to check </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>priority</em>&nbsp;</td><td>priority of extension path </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callerid</em>&nbsp;</td><td>callerid of extension being searched for</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>If "exten" *could match* a valid extension in this context with some more digits, return non-zero. Does NOT return non-zero if this is an exact-match only. Basically, when this returns 0, no matter what you add to exten, it's not going to be a valid extension anymore </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02203">2203</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824febb13020eaa30c314c1bff110026a7cd2">E_MATCHMORE</a>, and <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>.
<p>
Referenced by <a class="el" href="app_8c-source.html#l00065">ast_app_dtget()</a>, <a class="el" href="pbx_8c-source.html#l02224">collect_digits()</a>, <a class="el" href="app__disa_8c-source.html#l00113">disa_exec()</a>, <a class="el" href="chan__iax2_8c-source.html#l06220">dp_lookup()</a>, <a class="el" href="pbx__dundi_8c-source.html#l00532">dundi_lookup_local()</a>, <a class="el" href="pbx__loopback_8c-source.html#l00152">loopback_matchmore()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02638">mgcp_ss()</a>, <a class="el" href="chan__skinny_8c-source.html#l02365">skinny_ss()</a>, and <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>.<div class="fragment"><pre class="fragment"><a name="l02204"></a>02204 {
<a name="l02205"></a>02205    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#2377c7b979811bdd54ebf819e5d2037b">pbx_extension_helper</a>(c, NULL, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, priority, NULL, callerid, <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824febb13020eaa30c314c1bff110026a7cd2">E_MATCHMORE</a>);
<a name="l02206"></a>02206 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6a86443aa2d56a55b117b3f985565bcb"></a><!-- doxytag: member="pbx.c::ast_merge_contexts_and_delete" ref="6a86443aa2d56a55b117b3f985565bcb" args="(struct ast_context **extcontexts, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_merge_contexts_and_delete           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>extcontexts</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Merge the temporary contexts into a global contexts list and delete from the global list the ones that are being added. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>extcontexts</em>&nbsp;</td><td>pointer to the <a class="el" href="structast__context.html">ast_context</a> structure pointer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>registrar</em>&nbsp;</td><td>of the context; if it's set the routine will delete all contexts that belong to that registrar; if NULL only the contexts that are specified in extcontexts </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03936">3936</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l05285">__ast_context_destroy()</a>, <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f7564c0d9d79bfb21b4578eb245ddcecd9a">AST_EXTENSION_REMOVED</a>, <a class="el" href="pbx_8c-source.html#l01799">ast_hint_extension()</a>, <a class="el" href="linkedlists_8h-source.html#l00198">AST_LIST_HEAD_INIT_VALUE</a>, <a class="el" href="linkedlists_8h-source.html#l00650">AST_LIST_INSERT_HEAD</a>, <a class="el" href="linkedlists_8h-source.html#l00710">AST_LIST_REMOVE_HEAD</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, <a class="el" href="pbx_8c-source.html#l06064">ast_wrlock_contexts()</a>, <a class="el" href="pbx_8c-source.html#l00192">ast_state_cb::callback</a>, <a class="el" href="pbx_8c-source.html#l00205">ast_hint::callbacks</a>, <a class="el" href="chan__alsa_8c-source.html#l00124">context</a>, <a class="el" href="pbx_8c-source.html#l00489">contexts</a>, <a class="el" href="pbx_8c-source.html#l00191">ast_state_cb::data</a>, <a class="el" href="chan__alsa_8c-source.html#l00126">exten</a>, <a class="el" href="pbx_8c-source.html#l00203">ast_hint::exten</a>, <a class="el" href="pbx_8c-source.html#l00119">ast_exten::exten</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="pbx_8c-source.html#l00204">ast_hint::laststate</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="pbx_8c-source.html#l00168">ast_context::next</a>, <a class="el" href="pbx_8c-source.html#l00193">ast_state_cb::next</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="pbx_8c-source.html#l00124">ast_exten::parent</a>, and <a class="el" href="pbx_8c-source.html#l00171">ast_context::registrar</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01596">pbx_load_module()</a>.<div class="fragment"><pre class="fragment"><a name="l03937"></a>03937 {
<a name="l03938"></a>03938    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *tmp, *lasttmp = NULL;
<a name="l03939"></a>03939    <span class="keyword">struct </span>store_hints store = <a class="code" href="linkedlists_8h.html#2bed4896e7f99dbbabfe1c897dcb96d9">AST_LIST_HEAD_INIT_VALUE</a>;
<a name="l03940"></a>03940    <span class="keyword">struct </span><a class="code" href="structstore__hint.html">store_hint</a> *<span class="keyword">this</span>;
<a name="l03941"></a>03941    <span class="keyword">struct </span><a class="code" href="structast__hint.html">ast_hint</a> *hint;
<a name="l03942"></a>03942    <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>;
<a name="l03943"></a>03943    <span class="keywordtype">int</span> length;
<a name="l03944"></a>03944    <span class="keyword">struct </span><a class="code" href="structast__state__cb.html">ast_state_cb</a> *thiscb, *prevcb;
<a name="l03945"></a>03945 
<a name="l03946"></a>03946    <span class="comment">/* it is very important that this function hold the hint list lock _and_ the conlock</span>
<a name="l03947"></a>03947 <span class="comment">      during its operation; not only do we need to ensure that the list of contexts</span>
<a name="l03948"></a>03948 <span class="comment">      and extensions does not change, but also that no hint callbacks (watchers) are</span>
<a name="l03949"></a>03949 <span class="comment">      added or removed during the merge/delete process</span>
<a name="l03950"></a>03950 <span class="comment"></span>
<a name="l03951"></a>03951 <span class="comment">      in addition, the locks _must_ be taken in this order, because there are already</span>
<a name="l03952"></a>03952 <span class="comment">      other code paths that use this order</span>
<a name="l03953"></a>03953 <span class="comment">   */</span>
<a name="l03954"></a>03954    <a class="code" href="pbx_8c.html#6f41efd0c2fa84486ef11fef33681139">ast_wrlock_contexts</a>();
<a name="l03955"></a>03955    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;hints);
<a name="l03956"></a>03956 
<a name="l03957"></a>03957    <span class="comment">/* preserve all watchers for hints associated with this registrar */</span>
<a name="l03958"></a>03958    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;hints, hint, list) {
<a name="l03959"></a>03959       <span class="keywordflow">if</span> (hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a> &amp;&amp; !strcmp(<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>, hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>-&gt;<a class="code" href="structast__exten.html#d0e45878043844ffc41aac437e86b602">parent</a>-&gt;<a class="code" href="structast__context.html#5940569cd1d60781f856f93235b072ee">registrar</a>)) {
<a name="l03960"></a>03960          length = strlen(hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>) + strlen(hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>-&gt;<a class="code" href="structast__exten.html#d0e45878043844ffc41aac437e86b602">parent</a>-&gt;name) + 2 + <span class="keyword">sizeof</span>(*this);
<a name="l03961"></a>03961          <span class="keywordflow">if</span> (!(<span class="keyword">this</span> = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, length)))
<a name="l03962"></a>03962             <span class="keywordflow">continue</span>;
<a name="l03963"></a>03963          this-&gt;callbacks = hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a>;
<a name="l03964"></a>03964          hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a> = NULL;
<a name="l03965"></a>03965          this-&gt;laststate = hint-&gt;<a class="code" href="structast__hint.html#406c995dd8ced9add7c7f6eb95532fe7">laststate</a>;
<a name="l03966"></a>03966          this-&gt;<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a> = this-&gt;<a class="code" href="structast__state__cb.html#8d777f385d3dfec8815d20f7496026dc">data</a>;
<a name="l03967"></a>03967          strcpy(this-&gt;data, hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>-&gt;<a class="code" href="structast__exten.html#d0e45878043844ffc41aac437e86b602">parent</a>-&gt;name);
<a name="l03968"></a>03968          this-&gt;exten = this-&gt;<a class="code" href="structast__state__cb.html#8d777f385d3dfec8815d20f7496026dc">data</a> + strlen(this-&gt;context) + 1;
<a name="l03969"></a>03969          strcpy(this-&gt;exten, hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>);
<a name="l03970"></a>03970          <a class="code" href="linkedlists_8h.html#5df56040a8838bdc841ef8eb179b7609">AST_LIST_INSERT_HEAD</a>(&amp;store, <span class="keyword">this</span>, list);
<a name="l03971"></a>03971       }
<a name="l03972"></a>03972    }
<a name="l03973"></a>03973 
<a name="l03974"></a>03974    tmp = *extcontexts;
<a name="l03975"></a>03975    <span class="keywordflow">if</span> (<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>) {
<a name="l03976"></a>03976       <span class="comment">/* XXX remove previous contexts from same registrar */</span>
<a name="l03977"></a>03977       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l03978"></a>03978          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"must remove any reg %s\n"</span>, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l03979"></a>03979       <a class="code" href="pbx_8c.html#e2faf43e79194dd93e6200a86f08d563">__ast_context_destroy</a>(NULL,<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l03980"></a>03980       <span class="keywordflow">while</span> (tmp) {
<a name="l03981"></a>03981          lasttmp = tmp;
<a name="l03982"></a>03982          tmp = tmp-&gt;<a class="code" href="structast__context.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l03983"></a>03983       }
<a name="l03984"></a>03984    } <span class="keywordflow">else</span> {
<a name="l03985"></a>03985       <span class="comment">/* XXX remove contexts with the same name */</span>
<a name="l03986"></a>03986       <span class="keywordflow">while</span> (tmp) {
<a name="l03987"></a>03987          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"must remove %s  reg %s\n"</span>, tmp-&gt;name, tmp-&gt;<a class="code" href="structast__context.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l03988"></a>03988          <a class="code" href="pbx_8c.html#e2faf43e79194dd93e6200a86f08d563">__ast_context_destroy</a>(tmp,tmp-&gt;<a class="code" href="structast__context.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l03989"></a>03989          lasttmp = tmp;
<a name="l03990"></a>03990          tmp = tmp-&gt;<a class="code" href="structast__context.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l03991"></a>03991       }
<a name="l03992"></a>03992    }
<a name="l03993"></a>03993    <span class="keywordflow">if</span> (lasttmp) {
<a name="l03994"></a>03994       lasttmp-&gt;<a class="code" href="structast__context.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = <a class="code" href="pbx_8c.html#9be90dc64c1f5b5c993ff11d732a8da0">contexts</a>;
<a name="l03995"></a>03995       <a class="code" href="pbx_8c.html#9be90dc64c1f5b5c993ff11d732a8da0">contexts</a> = *extcontexts;
<a name="l03996"></a>03996       *extcontexts = NULL;
<a name="l03997"></a>03997    } <span class="keywordflow">else</span>
<a name="l03998"></a>03998       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Requested contexts didn't get merged\n"</span>);
<a name="l03999"></a>03999 
<a name="l04000"></a>04000    <span class="comment">/* restore the watchers for hints that can be found; notify those that</span>
<a name="l04001"></a>04001 <span class="comment">      cannot be restored</span>
<a name="l04002"></a>04002 <span class="comment">   */</span>
<a name="l04003"></a>04003    <span class="keywordflow">while</span> ((<span class="keyword">this</span> = <a class="code" href="linkedlists_8h.html#beec347da29fe6b0d7fdb3e80b851f90">AST_LIST_REMOVE_HEAD</a>(&amp;store, list))) {
<a name="l04004"></a>04004       exten = <a class="code" href="pbx_8c.html#a4691f6ae9689498c10c695381f36103">ast_hint_extension</a>(NULL, this-&gt;context, this-&gt;exten);
<a name="l04005"></a>04005       <span class="comment">/* Find the hint in the list of hints */</span>
<a name="l04006"></a>04006       <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;hints, hint, list) {
<a name="l04007"></a>04007          <span class="keywordflow">if</span> (hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a> == exten)
<a name="l04008"></a>04008             <span class="keywordflow">break</span>;
<a name="l04009"></a>04009       }
<a name="l04010"></a>04010       <span class="keywordflow">if</span> (!exten || !hint) {
<a name="l04011"></a>04011          <span class="comment">/* this hint has been removed, notify the watchers */</span>
<a name="l04012"></a>04012          prevcb = NULL;
<a name="l04013"></a>04013          thiscb = this-&gt;callbacks;
<a name="l04014"></a>04014          <span class="keywordflow">while</span> (thiscb) {
<a name="l04015"></a>04015             prevcb = thiscb;
<a name="l04016"></a>04016             thiscb = thiscb-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l04017"></a>04017             prevcb-&gt;<a class="code" href="structast__state__cb.html#924a8ceeac17f54d3be3f8cdf1c04eb2">callback</a>(this-&gt;context, this-&gt;exten, <a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f7564c0d9d79bfb21b4578eb245ddcecd9a">AST_EXTENSION_REMOVED</a>, prevcb-&gt;<a class="code" href="structast__state__cb.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l04018"></a>04018             <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(prevcb);
<a name="l04019"></a>04019             }
<a name="l04020"></a>04020       } <span class="keywordflow">else</span> {
<a name="l04021"></a>04021          thiscb = this-&gt;callbacks;
<a name="l04022"></a>04022          <span class="keywordflow">while</span> (thiscb-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>)
<a name="l04023"></a>04023             thiscb = thiscb-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l04024"></a>04024          thiscb-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a>;
<a name="l04025"></a>04025          hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a> = this-&gt;callbacks;
<a name="l04026"></a>04026          hint-&gt;<a class="code" href="structast__hint.html#406c995dd8ced9add7c7f6eb95532fe7">laststate</a> = this-&gt;laststate;
<a name="l04027"></a>04027       }
<a name="l04028"></a>04028       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(<span class="keyword">this</span>);
<a name="l04029"></a>04029    }
<a name="l04030"></a>04030 
<a name="l04031"></a>04031    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l04032"></a>04032    <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l04033"></a>04033 
<a name="l04034"></a>04034    <span class="keywordflow">return</span>;
<a name="l04035"></a>04035 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ac3097f3dd8ef4fb7e1468f589b42c57"></a><!-- doxytag: member="pbx.c::AST_MUTEX_DEFINE_STATIC" ref="ac3097f3dd8ef4fb7e1468f589b42c57" args="(maxcalllock)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">AST_MUTEX_DEFINE_STATIC           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">maxcalllock&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="86eba1ec3178373f61c082e1f1f12b68"></a><!-- doxytag: member="pbx.c::ast_parseable_goto" ref="86eba1ec3178373f61c082e1f1f12b68" args="(struct ast_channel *chan, const char *goto_string)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_parseable_goto           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>goto_string</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06287">6287</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="cdr_8c-source.html#l00885">ast_cdr_update()</a>, <a class="el" href="pbx_8c-source.html#l04576">ast_explicit_goto()</a>, <a class="el" href="pbx_8c-source.html#l02188">ast_findlabel_extension()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="channel_8h-source.html#l00437">ast_channel::cid</a>, <a class="el" href="channel_8h-source.html#l00212">ast_callerid::cid_num</a>, <a class="el" href="channel_8h-source.html#l00441">ast_channel::context</a>, <a class="el" href="chan__alsa_8c-source.html#l00126">exten</a>, <a class="el" href="channel_8h-source.html#l00442">ast_channel::exten</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="channel_8h-source.html#l00443">ast_channel::priority</a>, and <a class="el" href="strcompat_8c-source.html#l00035">strsep()</a>.
<p>
Referenced by <a class="el" href="app__while_8c-source.html#l00164">_while_exec()</a>, <a class="el" href="res__features_8c-source.html#l00192">check_goto_on_transfer()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="app__stack_8c-source.html#l00193">gosub_exec()</a>, <a class="el" href="app_8c-source.html#l01149">ivr_dispatch()</a>, <a class="el" href="pbx_8c-source.html#l05725">pbx_builtin_goto()</a>, <a class="el" href="app__rpt_8c-source.html#l06759">rpt_exec()</a>, and <a class="el" href="app__while_8c-source.html#l00290">while_continue_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l06288"></a>06288 {
<a name="l06289"></a>06289    <span class="keywordtype">char</span> *<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, *pri, *<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>;
<a name="l06290"></a>06290    <span class="keywordtype">char</span> *stringp;
<a name="l06291"></a>06291    <span class="keywordtype">int</span> ipri;
<a name="l06292"></a>06292    <span class="keywordtype">int</span> mode = 0;
<a name="l06293"></a>06293 
<a name="l06294"></a>06294    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(goto_string)) {
<a name="l06295"></a>06295       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Goto requires an argument (optional context|optional extension|priority)\n"</span>);
<a name="l06296"></a>06296       <span class="keywordflow">return</span> -1;
<a name="l06297"></a>06297    }
<a name="l06298"></a>06298    stringp = <a class="code" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>(goto_string);
<a name="l06299"></a>06299    context = <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;stringp, <span class="stringliteral">"|"</span>); <span class="comment">/* guaranteed non-null */</span>
<a name="l06300"></a>06300    exten = <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;stringp, <span class="stringliteral">"|"</span>);
<a name="l06301"></a>06301    pri = <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;stringp, <span class="stringliteral">"|"</span>);
<a name="l06302"></a>06302    <span class="keywordflow">if</span> (!exten) {  <span class="comment">/* Only a priority in this one */</span>
<a name="l06303"></a>06303       pri = context;
<a name="l06304"></a>06304       exten = NULL;
<a name="l06305"></a>06305       context = NULL;
<a name="l06306"></a>06306    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!pri) {   <span class="comment">/* Only an extension and priority in this one */</span>
<a name="l06307"></a>06307       pri = exten;
<a name="l06308"></a>06308       exten = context;
<a name="l06309"></a>06309       context = NULL;
<a name="l06310"></a>06310    }
<a name="l06311"></a>06311    <span class="keywordflow">if</span> (*pri == <span class="charliteral">'+'</span>) {
<a name="l06312"></a>06312       mode = 1;
<a name="l06313"></a>06313       pri++;
<a name="l06314"></a>06314    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*pri == <span class="charliteral">'-'</span>) {
<a name="l06315"></a>06315       mode = -1;
<a name="l06316"></a>06316       pri++;
<a name="l06317"></a>06317    }
<a name="l06318"></a>06318    <span class="keywordflow">if</span> (sscanf(pri, <span class="stringliteral">"%d"</span>, &amp;ipri) != 1) {
<a name="l06319"></a>06319       <span class="keywordflow">if</span> ((ipri = <a class="code" href="pbx_8c.html#6f1b63f69b489517c49ccfecdbe1642e">ast_findlabel_extension</a>(chan, context ? context : chan-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, exten ? exten : chan-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>,
<a name="l06320"></a>06320          pri, chan-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>)) &lt; 1) {
<a name="l06321"></a>06321          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Priority '%s' must be a number &gt; 0, or valid label\n"</span>, pri);
<a name="l06322"></a>06322          <span class="keywordflow">return</span> -1;
<a name="l06323"></a>06323       } <span class="keywordflow">else</span>
<a name="l06324"></a>06324          mode = 0;
<a name="l06325"></a>06325    }
<a name="l06326"></a>06326    <span class="comment">/* At this point we have a priority and maybe an extension and a context */</span>
<a name="l06327"></a>06327 
<a name="l06328"></a>06328    <span class="keywordflow">if</span> (mode)
<a name="l06329"></a>06329       ipri = chan-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a> + (ipri * mode);
<a name="l06330"></a>06330 
<a name="l06331"></a>06331    <a class="code" href="pbx_8c.html#1e0079c7f2934dd7ebe801fefe4057da">ast_explicit_goto</a>(chan, context, exten, ipri);
<a name="l06332"></a>06332    <a class="code" href="cdr_8c.html#0247fba893abcaf42f3861b4982361db">ast_cdr_update</a>(chan);
<a name="l06333"></a>06333    <span class="keywordflow">return</span> 0;
<a name="l06334"></a>06334 
<a name="l06335"></a>06335 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8bd05d7cdf218eaecfb4a33dd0eb32d8"></a><!-- doxytag: member="pbx.c::ast_pbx_outgoing_app" ref="8bd05d7cdf218eaecfb4a33dd0eb32d8" args="(const char *type, int format, void *data, int timeout, const char *app, const char *appdata, int *reason, int sync, const char *cid_num, const char *cid_name, struct ast_variable *vars, const char *account, struct ast_channel **locked_channel)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_pbx_outgoing_app           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>timeout</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>app</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>appdata</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>reason</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>sync</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cid_num</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cid_name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__variable.html">ast_variable</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>vars</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>account</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__channel.html">ast_channel</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>locked_channel</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Synchronously or asynchronously make an outbound call and send it to a particular application with given extension 
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05150">5150</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="cdr_8c-source.html#l00460">ast_cdr_alloc()</a>, <a class="el" href="cdr_8c-source.html#l00684">ast_cdr_disposition()</a>, <a class="el" href="cdr_8c-source.html#l00657">ast_cdr_failed()</a>, <a class="el" href="cdr_8c-source.html#l00763">ast_cdr_init()</a>, <a class="el" href="cdr_8c-source.html#l00834">ast_cdr_setaccount()</a>, <a class="el" href="cdr_8c-source.html#l00620">ast_cdr_start()</a>, <a class="el" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="channel_8c-source.html#l01598">ast_hangup()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="pbx_8c-source.html#l04966">ast_pbx_outgoing_cdr_failed()</a>, <a class="el" href="pbx_8c-source.html#l05134">ast_pbx_run_app()</a>, <a class="el" href="utils_8h-source.html#l00302">ast_pthread_create_detached</a>, <a class="el" href="channel_8c-source.html#l04486">ast_set_variables()</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="config_8c-source.html#l00211">ast_variables_destroy()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="pbx_8c-source.html#l04903">async_wait()</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="channel_8h-source.html#l00449">ast_channel::pbx</a>, and <a class="el" href="logger_8h-source.html#l00046">VERBOSE_PREFIX_4</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l01912">action_originate()</a>, <a class="el" href="pbx__spool_8c-source.html#l00327">attempt_thread()</a>, <a class="el" href="manager_8c-source.html#l01850">fast_originate()</a>, and <a class="el" href="res__clioriginate_8c-source.html#l00072">orig_app()</a>.<div class="fragment"><pre class="fragment"><a name="l05151"></a>05151 {
<a name="l05152"></a>05152    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>;
<a name="l05153"></a>05153    <span class="keyword">struct </span><a class="code" href="structapp__tmp.html">app_tmp</a> *tmp;
<a name="l05154"></a>05154    <span class="keywordtype">int</span> res = -1, cdr_res = -1;
<a name="l05155"></a>05155    <span class="keyword">struct </span><a class="code" href="structoutgoing__helper.html">outgoing_helper</a> oh;
<a name="l05156"></a>05156 
<a name="l05157"></a>05157    memset(&amp;oh, 0, <span class="keyword">sizeof</span>(oh));
<a name="l05158"></a>05158    oh.<a class="code" href="structoutgoing__helper.html#b63119da730344b345cdc8f62a4711e9">vars</a> = vars;
<a name="l05159"></a>05159    oh.<a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a> = <a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a>;
<a name="l05160"></a>05160 
<a name="l05161"></a>05161    <span class="keywordflow">if</span> (locked_channel)
<a name="l05162"></a>05162       *locked_channel = NULL;
<a name="l05163"></a>05163    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(<a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>)) {
<a name="l05164"></a>05164       res = -1;
<a name="l05165"></a>05165       <span class="keywordflow">goto</span> outgoing_app_cleanup;
<a name="l05166"></a>05166    }
<a name="l05167"></a>05167    <span class="keywordflow">if</span> (sync) {
<a name="l05168"></a>05168       chan = <a class="code" href="channel_8c.html#8537f62a5cf4153cbafae491fb365303">__ast_request_and_dial</a>(<a class="code" href="rtp_8c.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, <a class="code" href="chan__alsa_8c.html#1ddcb92ade31c8fbd370001f9b29a7d9">format</a>, data, timeout, reason, <a class="code" href="chan__mgcp_8c.html#ca3c0eb6b6e898f3a32aed5de1320774">cid_num</a>, <a class="code" href="chan__mgcp_8c.html#70f178a59d8df82fe5e107da71415b9b">cid_name</a>, &amp;oh);
<a name="l05169"></a>05169       <span class="keywordflow">if</span> (chan) {
<a name="l05170"></a>05170          <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>) { <span class="comment">/* check if the channel already has a cdr record, if not give it one */</span>
<a name="l05171"></a>05171             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"%s already has a call record??\n"</span>, chan-&gt;name);
<a name="l05172"></a>05172          } <span class="keywordflow">else</span> {
<a name="l05173"></a>05173             chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a> = <a class="code" href="cdr_8c.html#0dd431954a27c67f78c6e13be8a0b136">ast_cdr_alloc</a>();   <span class="comment">/* allocate a cdr for the channel */</span>
<a name="l05174"></a>05174             <span class="keywordflow">if</span> (!chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>) {
<a name="l05175"></a>05175                <span class="comment">/* allocation of the cdr failed */</span>
<a name="l05176"></a>05176                <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(chan-&gt;<a class="code" href="structast__channel.html#569f7a090087f9e7071a247a24ea0809">pbx</a>);
<a name="l05177"></a>05177                res = -1;
<a name="l05178"></a>05178                <span class="keywordflow">goto</span> outgoing_app_cleanup;
<a name="l05179"></a>05179             }
<a name="l05180"></a>05180             <span class="comment">/* allocation of the cdr was successful */</span>
<a name="l05181"></a>05181             <a class="code" href="cdr_8c.html#4d85bb268956ffbf0b19df25915726e8">ast_cdr_init</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>, chan);  <span class="comment">/* initialize our channel's cdr */</span>
<a name="l05182"></a>05182             <a class="code" href="cdr_8c.html#56e1b7b9d5acada4d22d345813710582">ast_cdr_start</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>);
<a name="l05183"></a>05183          }
<a name="l05184"></a>05184          <a class="code" href="channel_8c.html#ee674fb53b907cc57dda6e54ac24a637">ast_set_variables</a>(chan, vars);
<a name="l05185"></a>05185          <span class="keywordflow">if</span> (<a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a>)
<a name="l05186"></a>05186             <a class="code" href="cdr_8c.html#8aa58d36e6bd15ba7d10e367d9870e60">ast_cdr_setaccount</a>(chan, <a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a>);
<a name="l05187"></a>05187          <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a> == <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>) {
<a name="l05188"></a>05188             res = 0;
<a name="l05189"></a>05189             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 3)
<a name="l05190"></a>05190                <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#8f25f582e7a737b25f607fb6ad653807">VERBOSE_PREFIX_4</a> <span class="stringliteral">"Channel %s was answered.\n"</span>, chan-&gt;name);
<a name="l05191"></a>05191             tmp = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*tmp));
<a name="l05192"></a>05192             <span class="keywordflow">if</span> (!tmp)
<a name="l05193"></a>05193                res = -1;
<a name="l05194"></a>05194             <span class="keywordflow">else</span> {
<a name="l05195"></a>05195                ast_copy_string(tmp-&gt;<a class="code" href="structapp__tmp.html#c43b13e5c8f54532967ff0925bb74a16">app</a>, <a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>, <span class="keyword">sizeof</span>(tmp-&gt;<a class="code" href="structapp__tmp.html#c43b13e5c8f54532967ff0925bb74a16">app</a>));
<a name="l05196"></a>05196                <span class="keywordflow">if</span> (appdata)
<a name="l05197"></a>05197                   ast_copy_string(tmp-&gt;<a class="code" href="structapp__tmp.html#e7232ed861fc8b075649bf08d405e789">data</a>, appdata, <span class="keyword">sizeof</span>(tmp-&gt;<a class="code" href="structapp__tmp.html#e7232ed861fc8b075649bf08d405e789">data</a>));
<a name="l05198"></a>05198                tmp-&gt;<a class="code" href="structapp__tmp.html#26c322652770620e64ac90682eb6504c">chan</a> = chan;
<a name="l05199"></a>05199                <span class="keywordflow">if</span> (sync &gt; 1) {
<a name="l05200"></a>05200                   <span class="keywordflow">if</span> (locked_channel)
<a name="l05201"></a>05201                      <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l05202"></a>05202                   <a class="code" href="pbx_8c.html#38fb34f5a491b6b51279535ef9ba6620">ast_pbx_run_app</a>(tmp);
<a name="l05203"></a>05203                } <span class="keywordflow">else</span> {
<a name="l05204"></a>05204                   <span class="keywordflow">if</span> (locked_channel)
<a name="l05205"></a>05205                      <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l05206"></a>05206                   <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#97e9ed35da1f19087b177cdffdf53c97">ast_pthread_create_detached</a>(&amp;tmp-&gt;<a class="code" href="structapp__tmp.html#e358efa489f58062f10dd7316b65649e">t</a>, NULL, <a class="code" href="pbx_8c.html#38fb34f5a491b6b51279535ef9ba6620">ast_pbx_run_app</a>, tmp)) {
<a name="l05207"></a>05207                      <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Unable to spawn execute thread on %s: %s\n"</span>, chan-&gt;name, strerror(errno));
<a name="l05208"></a>05208                      <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(tmp);
<a name="l05209"></a>05209                      <span class="keywordflow">if</span> (locked_channel)
<a name="l05210"></a>05210                         <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l05211"></a>05211                      <a class="code" href="channel_8c.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a>(chan);
<a name="l05212"></a>05212                      res = -1;
<a name="l05213"></a>05213                   } <span class="keywordflow">else</span> {
<a name="l05214"></a>05214                      <span class="keywordflow">if</span> (locked_channel)
<a name="l05215"></a>05215                         *locked_channel = chan;
<a name="l05216"></a>05216                   }
<a name="l05217"></a>05217                }
<a name="l05218"></a>05218             }
<a name="l05219"></a>05219          } <span class="keywordflow">else</span> {
<a name="l05220"></a>05220             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 3)
<a name="l05221"></a>05221                <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#8f25f582e7a737b25f607fb6ad653807">VERBOSE_PREFIX_4</a> <span class="stringliteral">"Channel %s was never answered.\n"</span>, chan-&gt;name);
<a name="l05222"></a>05222             <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>) { <span class="comment">/* update the cdr */</span>
<a name="l05223"></a>05223                <span class="comment">/* here we update the status of the call, which sould be busy.</span>
<a name="l05224"></a>05224 <span class="comment">                * if that fails then we set the status to failed */</span>
<a name="l05225"></a>05225                <span class="keywordflow">if</span> (<a class="code" href="cdr_8c.html#995ca95113dc7070faca1a0969a72eb9">ast_cdr_disposition</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>, chan-&gt;<a class="code" href="structast__channel.html#8be5f831332d8ff714e90c2cf85171fe">hangupcause</a>))
<a name="l05226"></a>05226                   <a class="code" href="cdr_8c.html#3f2e573eb7fde7a250ca8aa95a0d367d">ast_cdr_failed</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>);
<a name="l05227"></a>05227             }
<a name="l05228"></a>05228             <a class="code" href="channel_8c.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a>(chan);
<a name="l05229"></a>05229          }
<a name="l05230"></a>05230       }
<a name="l05231"></a>05231 
<a name="l05232"></a>05232       <span class="keywordflow">if</span> (res &lt; 0) { <span class="comment">/* the call failed for some reason */</span>
<a name="l05233"></a>05233          <span class="keywordflow">if</span> (*reason == 0) { <span class="comment">/* if the call failed (not busy or no answer)</span>
<a name="l05234"></a>05234 <span class="comment">                        * update the cdr with the failed message */</span>
<a name="l05235"></a>05235             cdr_res = <a class="code" href="pbx_8c.html#09a9b482db62db9b75905bfad1c77ef1">ast_pbx_outgoing_cdr_failed</a>();
<a name="l05236"></a>05236             <span class="keywordflow">if</span> (cdr_res != 0) {
<a name="l05237"></a>05237                res = cdr_res;
<a name="l05238"></a>05238                <span class="keywordflow">goto</span> outgoing_app_cleanup;
<a name="l05239"></a>05239             }
<a name="l05240"></a>05240          }
<a name="l05241"></a>05241       }
<a name="l05242"></a>05242 
<a name="l05243"></a>05243    } <span class="keywordflow">else</span> {
<a name="l05244"></a>05244       <span class="keyword">struct </span><a class="code" href="structasync__stat.html">async_stat</a> *as;
<a name="l05245"></a>05245       <span class="keywordflow">if</span> (!(as = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*as)))) {
<a name="l05246"></a>05246          res = -1;
<a name="l05247"></a>05247          <span class="keywordflow">goto</span> outgoing_app_cleanup;
<a name="l05248"></a>05248       }
<a name="l05249"></a>05249       chan = <a class="code" href="channel_8c.html#8537f62a5cf4153cbafae491fb365303">__ast_request_and_dial</a>(<a class="code" href="rtp_8c.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, <a class="code" href="chan__alsa_8c.html#1ddcb92ade31c8fbd370001f9b29a7d9">format</a>, data, <a class="code" href="structasync__stat.html#90272dda245ae1fb3cf197e91a8689dc">timeout</a>, reason, <a class="code" href="chan__mgcp_8c.html#ca3c0eb6b6e898f3a32aed5de1320774">cid_num</a>, <a class="code" href="chan__mgcp_8c.html#70f178a59d8df82fe5e107da71415b9b">cid_name</a>, &amp;oh);
<a name="l05250"></a>05250       <span class="keywordflow">if</span> (!chan) {
<a name="l05251"></a>05251          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(as);
<a name="l05252"></a>05252          res = -1;
<a name="l05253"></a>05253          <span class="keywordflow">goto</span> outgoing_app_cleanup;
<a name="l05254"></a>05254       }
<a name="l05255"></a>05255       as-&gt;chan = chan;
<a name="l05256"></a>05256       ast_copy_string(as-&gt;app, <a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>, <span class="keyword">sizeof</span>(as-&gt;app));
<a name="l05257"></a>05257       <span class="keywordflow">if</span> (<a class="code" href="structasync__stat.html#ffa091f1a08de73baae354df77b07668">appdata</a>)
<a name="l05258"></a>05258          ast_copy_string(as-&gt;appdata,  <a class="code" href="structasync__stat.html#ffa091f1a08de73baae354df77b07668">appdata</a>, <span class="keyword">sizeof</span>(as-&gt;appdata));
<a name="l05259"></a>05259       as-&gt;timeout = <a class="code" href="structasync__stat.html#90272dda245ae1fb3cf197e91a8689dc">timeout</a>;
<a name="l05260"></a>05260       <a class="code" href="channel_8c.html#ee674fb53b907cc57dda6e54ac24a637">ast_set_variables</a>(chan, vars);
<a name="l05261"></a>05261       <span class="keywordflow">if</span> (account)
<a name="l05262"></a>05262          <a class="code" href="cdr_8c.html#8aa58d36e6bd15ba7d10e367d9870e60">ast_cdr_setaccount</a>(chan, account);
<a name="l05263"></a>05263       <span class="comment">/* Start a new thread, and get something handling this channel. */</span>
<a name="l05264"></a>05264       <span class="keywordflow">if</span> (locked_channel)
<a name="l05265"></a>05265          <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l05266"></a>05266       <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#97e9ed35da1f19087b177cdffdf53c97">ast_pthread_create_detached</a>(&amp;as-&gt;p, NULL, <a class="code" href="pbx_8c.html#23af98d69a15a8250c44aaea18d487af">async_wait</a>, as)) {
<a name="l05267"></a>05267          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Failed to start async wait\n"</span>);
<a name="l05268"></a>05268          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(as);
<a name="l05269"></a>05269          <span class="keywordflow">if</span> (locked_channel)
<a name="l05270"></a>05270             <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l05271"></a>05271          <a class="code" href="channel_8c.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a>(chan);
<a name="l05272"></a>05272          res = -1;
<a name="l05273"></a>05273          <span class="keywordflow">goto</span> outgoing_app_cleanup;
<a name="l05274"></a>05274       } <span class="keywordflow">else</span> {
<a name="l05275"></a>05275          <span class="keywordflow">if</span> (locked_channel)
<a name="l05276"></a>05276             *locked_channel = chan;
<a name="l05277"></a>05277       }
<a name="l05278"></a>05278       res = 0;
<a name="l05279"></a>05279    }
<a name="l05280"></a>05280 outgoing_app_cleanup:
<a name="l05281"></a>05281    <a class="code" href="config_8c.html#d616f18584600c70e8744e217c03407c">ast_variables_destroy</a>(vars);
<a name="l05282"></a>05282    <span class="keywordflow">return</span> res;
<a name="l05283"></a>05283 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="09a9b482db62db9b75905bfad1c77ef1"></a><!-- doxytag: member="pbx.c::ast_pbx_outgoing_cdr_failed" ref="09a9b482db62db9b75905bfad1c77ef1" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int ast_pbx_outgoing_cdr_failed           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Function to post an empty cdr after a spool call fails.<p>
This function posts an empty cdr for a failed spool call 
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04966">4966</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="cdr_8c-source.html#l01087">ast_cdr_detach()</a>, <a class="el" href="cdr_8c-source.html#l00788">ast_cdr_end()</a>, <a class="el" href="cdr_8c-source.html#l00657">ast_cdr_failed()</a>, <a class="el" href="cdr_8c-source.html#l00763">ast_cdr_init()</a>, <a class="el" href="cdr_8c-source.html#l00620">ast_cdr_start()</a>, <a class="el" href="channel_8c-source.html#l00632">ast_channel_alloc()</a>, <a class="el" href="channel_8c-source.html#l01069">ast_channel_free()</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a3c9bf8b90a4d4f25fc98dd1360bba58b">AST_STATE_DOWN</a>, and <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l05150">ast_pbx_outgoing_app()</a>, and <a class="el" href="pbx_8c-source.html#l04991">ast_pbx_outgoing_exten()</a>.<div class="fragment"><pre class="fragment"><a name="l04967"></a>04967 {
<a name="l04968"></a>04968    <span class="comment">/* allocate a channel */</span>
<a name="l04969"></a>04969    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a> = <a class="code" href="channel_8c.html#3e12df96f6a8fc8b7293ad03b29c729f">ast_channel_alloc</a>(0, <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a3c9bf8b90a4d4f25fc98dd1360bba58b">AST_STATE_DOWN</a>, 0, 0, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, 0, 0);
<a name="l04970"></a>04970 
<a name="l04971"></a>04971    <span class="keywordflow">if</span> (!chan)
<a name="l04972"></a>04972       <span class="keywordflow">return</span> -1;  <span class="comment">/* failure */</span>
<a name="l04973"></a>04973 
<a name="l04974"></a>04974    <span class="keywordflow">if</span> (!chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>) {
<a name="l04975"></a>04975       <span class="comment">/* allocation of the cdr failed */</span>
<a name="l04976"></a>04976       <a class="code" href="channel_8c.html#230a804b09060fecdf699c2c9613fff7">ast_channel_free</a>(chan);   <span class="comment">/* free the channel */</span>
<a name="l04977"></a>04977       <span class="keywordflow">return</span> -1;                <span class="comment">/* return failure */</span>
<a name="l04978"></a>04978    }
<a name="l04979"></a>04979 
<a name="l04980"></a>04980    <span class="comment">/* allocation of the cdr was successful */</span>
<a name="l04981"></a>04981    <a class="code" href="cdr_8c.html#4d85bb268956ffbf0b19df25915726e8">ast_cdr_init</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>, chan);  <span class="comment">/* initialize our channel's cdr */</span>
<a name="l04982"></a>04982    <a class="code" href="cdr_8c.html#56e1b7b9d5acada4d22d345813710582">ast_cdr_start</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>);       <span class="comment">/* record the start and stop time */</span>
<a name="l04983"></a>04983    <a class="code" href="cdr_8c.html#545d0bb7a87e9317b6eb3ce2245145cc">ast_cdr_end</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>);
<a name="l04984"></a>04984    <a class="code" href="cdr_8c.html#3f2e573eb7fde7a250ca8aa95a0d367d">ast_cdr_failed</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>);      <span class="comment">/* set the status to failed */</span>
<a name="l04985"></a>04985    <a class="code" href="cdr_8c.html#b20947a5170d08a12a3cee0498e07614">ast_cdr_detach</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>);      <span class="comment">/* post and free the record */</span>
<a name="l04986"></a>04986    <a class="code" href="channel_8c.html#230a804b09060fecdf699c2c9613fff7">ast_channel_free</a>(chan);         <span class="comment">/* free the channel */</span>
<a name="l04987"></a>04987 
<a name="l04988"></a>04988    <span class="keywordflow">return</span> 0;  <span class="comment">/* success */</span>
<a name="l04989"></a>04989 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1b1911a618935b371e69b60c66cf6221"></a><!-- doxytag: member="pbx.c::ast_pbx_outgoing_exten" ref="1b1911a618935b371e69b60c66cf6221" args="(const char *type, int format, void *data, int timeout, const char *context, const char *exten, int priority, int *reason, int sync, const char *cid_num, const char *cid_name, struct ast_variable *vars, const char *account, struct ast_channel **channel)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_pbx_outgoing_exten           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>timeout</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>reason</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>sync</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cid_num</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cid_name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__variable.html">ast_variable</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>vars</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>account</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__channel.html">ast_channel</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>locked_channel</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Synchronously or asynchronously make an outbound call and send it to a particular extension 
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04991">4991</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="channel_8h-source.html#l00435">ast_channel::_state</a>, <a class="el" href="channel_8h-source.html#l00578">outgoing_helper::account</a>, <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="cdr_8c-source.html#l00684">ast_cdr_disposition()</a>, <a class="el" href="cdr_8c-source.html#l00657">ast_cdr_failed()</a>, <a class="el" href="cdr_8c-source.html#l00834">ast_cdr_setaccount()</a>, <a class="el" href="channel_8c-source.html#l00632">ast_channel_alloc()</a>, <a class="el" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="pbx_8c-source.html#l02183">ast_exists_extension()</a>, <a class="el" href="channel_8c-source.html#l01598">ast_hangup()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="pbx_8c-source.html#l04966">ast_pbx_outgoing_cdr_failed()</a>, <a class="el" href="pbx_8c-source.html#l02572">ast_pbx_run()</a>, <a class="el" href="pbx_8c-source.html#l02551">ast_pbx_start()</a>, <a class="el" href="utils_8h-source.html#l00302">ast_pthread_create_detached</a>, <a class="el" href="channel_8c-source.html#l03058">ast_request_and_dial()</a>, <a class="el" href="channel_8c-source.html#l04486">ast_set_variables()</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a3c9bf8b90a4d4f25fc98dd1360bba58b">AST_STATE_DOWN</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="config_8c-source.html#l00211">ast_variables_destroy()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="pbx_8c-source.html#l04903">async_wait()</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, <a class="el" href="channel_8h-source.html#l00577">outgoing_helper::cid_name</a>, <a class="el" href="channel_8h-source.html#l00576">outgoing_helper::cid_num</a>, <a class="el" href="channel_8h-source.html#l00573">outgoing_helper::context</a>, <a class="el" href="channel_8h-source.html#l00441">ast_channel::context</a>, <a class="el" href="channel_8h-source.html#l00574">outgoing_helper::exten</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="channel_8h-source.html#l00466">ast_channel::hangupcause</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="channel_8h-source.html#l00580">outgoing_helper::parent_channel</a>, <a class="el" href="channel_8h-source.html#l00575">outgoing_helper::priority</a>, <a class="el" href="pbx_8c-source.html#l02214">set_ext_pri()</a>, <a class="el" href="channel_8h-source.html#l00579">outgoing_helper::vars</a>, and <a class="el" href="logger_8h-source.html#l00046">VERBOSE_PREFIX_4</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l01912">action_originate()</a>, <a class="el" href="pbx__spool_8c-source.html#l00327">attempt_thread()</a>, <a class="el" href="manager_8c-source.html#l01850">fast_originate()</a>, and <a class="el" href="res__clioriginate_8c-source.html#l00094">orig_exten()</a>.<div class="fragment"><pre class="fragment"><a name="l04992"></a>04992 {
<a name="l04993"></a>04993    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>;
<a name="l04994"></a>04994    <span class="keyword">struct </span><a class="code" href="structasync__stat.html">async_stat</a> *as;
<a name="l04995"></a>04995    <span class="keywordtype">int</span> res = -1, cdr_res = -1;
<a name="l04996"></a>04996    <span class="keyword">struct </span><a class="code" href="structoutgoing__helper.html">outgoing_helper</a> oh;
<a name="l04997"></a>04997 
<a name="l04998"></a>04998    <span class="keywordflow">if</span> (sync) {
<a name="l04999"></a>04999       oh.<a class="code" href="structoutgoing__helper.html#5c18ef72771564b7f43c497dc507aeab">context</a> = <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>;
<a name="l05000"></a>05000       oh.<a class="code" href="structoutgoing__helper.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a> = <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>;
<a name="l05001"></a>05001       oh.<a class="code" href="structoutgoing__helper.html#b988295c268025b49dfb3df26171ddc3">priority</a> = <a class="code" href="structoutgoing__helper.html#b988295c268025b49dfb3df26171ddc3">priority</a>;
<a name="l05002"></a>05002       oh.<a class="code" href="structoutgoing__helper.html#64191918d2ec3d68a26f486c5d134221">cid_num</a> = <a class="code" href="chan__mgcp_8c.html#ca3c0eb6b6e898f3a32aed5de1320774">cid_num</a>;
<a name="l05003"></a>05003       oh.<a class="code" href="structoutgoing__helper.html#51ae63e8ccffb05b130f96cc397ec7b0">cid_name</a> = <a class="code" href="chan__mgcp_8c.html#70f178a59d8df82fe5e107da71415b9b">cid_name</a>;
<a name="l05004"></a>05004       oh.<a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a> = <a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a>;
<a name="l05005"></a>05005       oh.<a class="code" href="structoutgoing__helper.html#b63119da730344b345cdc8f62a4711e9">vars</a> = vars;
<a name="l05006"></a>05006       oh.<a class="code" href="structoutgoing__helper.html#61b4aeaf61a5a027c4783915d73aa2ae">parent_channel</a> = NULL;
<a name="l05007"></a>05007 
<a name="l05008"></a>05008       chan = <a class="code" href="channel_8c.html#8537f62a5cf4153cbafae491fb365303">__ast_request_and_dial</a>(<a class="code" href="rtp_8c.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, <a class="code" href="chan__alsa_8c.html#1ddcb92ade31c8fbd370001f9b29a7d9">format</a>, data, timeout, reason, <a class="code" href="chan__mgcp_8c.html#ca3c0eb6b6e898f3a32aed5de1320774">cid_num</a>, <a class="code" href="chan__mgcp_8c.html#70f178a59d8df82fe5e107da71415b9b">cid_name</a>, &amp;oh);
<a name="l05009"></a>05009       <span class="keywordflow">if</span> (channel) {
<a name="l05010"></a>05010          *channel = chan;
<a name="l05011"></a>05011          <span class="keywordflow">if</span> (chan)
<a name="l05012"></a>05012             <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l05013"></a>05013       }
<a name="l05014"></a>05014       <span class="keywordflow">if</span> (chan) {
<a name="l05015"></a>05015          <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a> == <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>) {
<a name="l05016"></a>05016                res = 0;
<a name="l05017"></a>05017             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 3)
<a name="l05018"></a>05018                <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#8f25f582e7a737b25f607fb6ad653807">VERBOSE_PREFIX_4</a> <span class="stringliteral">"Channel %s was answered.\n"</span>, chan-&gt;name);
<a name="l05019"></a>05019 
<a name="l05020"></a>05020             <span class="keywordflow">if</span> (sync &gt; 1) {
<a name="l05021"></a>05021                <span class="keywordflow">if</span> (channel)
<a name="l05022"></a>05022                   <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l05023"></a>05023                <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#235c18a381a9501a4dc41b06b080c24f">ast_pbx_run</a>(chan)) {
<a name="l05024"></a>05024                   <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Unable to run PBX on %s\n"</span>, chan-&gt;name);
<a name="l05025"></a>05025                   <span class="keywordflow">if</span> (channel)
<a name="l05026"></a>05026                      *channel = NULL;
<a name="l05027"></a>05027                   <a class="code" href="channel_8c.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a>(chan);
<a name="l05028"></a>05028                   res = -1;
<a name="l05029"></a>05029                }
<a name="l05030"></a>05030             } <span class="keywordflow">else</span> {
<a name="l05031"></a>05031                <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#c55e82ff3dabed89efd77f20209b1006">ast_pbx_start</a>(chan)) {
<a name="l05032"></a>05032                   <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Unable to start PBX on %s\n"</span>, chan-&gt;name);
<a name="l05033"></a>05033                   <span class="keywordflow">if</span> (channel) {
<a name="l05034"></a>05034                      *channel = NULL;
<a name="l05035"></a>05035                      <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l05036"></a>05036                   }
<a name="l05037"></a>05037                   <a class="code" href="channel_8c.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a>(chan);
<a name="l05038"></a>05038                   res = -1;
<a name="l05039"></a>05039                }
<a name="l05040"></a>05040             }
<a name="l05041"></a>05041          } <span class="keywordflow">else</span> {
<a name="l05042"></a>05042             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 3)
<a name="l05043"></a>05043                <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#8f25f582e7a737b25f607fb6ad653807">VERBOSE_PREFIX_4</a> <span class="stringliteral">"Channel %s was never answered.\n"</span>, chan-&gt;name);
<a name="l05044"></a>05044 
<a name="l05045"></a>05045             <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>) { <span class="comment">/* update the cdr */</span>
<a name="l05046"></a>05046                <span class="comment">/* here we update the status of the call, which sould be busy.</span>
<a name="l05047"></a>05047 <span class="comment">                * if that fails then we set the status to failed */</span>
<a name="l05048"></a>05048                <span class="keywordflow">if</span> (<a class="code" href="cdr_8c.html#995ca95113dc7070faca1a0969a72eb9">ast_cdr_disposition</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>, chan-&gt;<a class="code" href="structast__channel.html#8be5f831332d8ff714e90c2cf85171fe">hangupcause</a>))
<a name="l05049"></a>05049                   <a class="code" href="cdr_8c.html#3f2e573eb7fde7a250ca8aa95a0d367d">ast_cdr_failed</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>);
<a name="l05050"></a>05050             }
<a name="l05051"></a>05051 
<a name="l05052"></a>05052             <span class="keywordflow">if</span> (channel) {
<a name="l05053"></a>05053                *channel = NULL;
<a name="l05054"></a>05054                <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l05055"></a>05055             }
<a name="l05056"></a>05056             <a class="code" href="channel_8c.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a>(chan);
<a name="l05057"></a>05057          }
<a name="l05058"></a>05058       }
<a name="l05059"></a>05059 
<a name="l05060"></a>05060       <span class="keywordflow">if</span> (res &lt; 0) { <span class="comment">/* the call failed for some reason */</span>
<a name="l05061"></a>05061          <span class="keywordflow">if</span> (*reason == 0) { <span class="comment">/* if the call failed (not busy or no answer)</span>
<a name="l05062"></a>05062 <span class="comment">                        * update the cdr with the failed message */</span>
<a name="l05063"></a>05063             cdr_res = <a class="code" href="pbx_8c.html#09a9b482db62db9b75905bfad1c77ef1">ast_pbx_outgoing_cdr_failed</a>();
<a name="l05064"></a>05064             <span class="keywordflow">if</span> (cdr_res != 0) {
<a name="l05065"></a>05065                res = cdr_res;
<a name="l05066"></a>05066                <span class="keywordflow">goto</span> outgoing_exten_cleanup;
<a name="l05067"></a>05067             }
<a name="l05068"></a>05068          }
<a name="l05069"></a>05069 
<a name="l05070"></a>05070          <span class="comment">/* create a fake channel and execute the "failed" extension (if it exists) within the requested context */</span>
<a name="l05071"></a>05071          <span class="comment">/* check if "failed" exists */</span>
<a name="l05072"></a>05072          <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#90b58be34145fcfd99652f0c3ae7377d">ast_exists_extension</a>(chan, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <span class="stringliteral">"failed"</span>, 1, NULL)) {
<a name="l05073"></a>05073             chan = <a class="code" href="channel_8c.html#3e12df96f6a8fc8b7293ad03b29c729f">ast_channel_alloc</a>(0, <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a3c9bf8b90a4d4f25fc98dd1360bba58b">AST_STATE_DOWN</a>, 0, 0, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, 0, <span class="stringliteral">"OutgoingSpoolFailed"</span>);
<a name="l05074"></a>05074             <span class="keywordflow">if</span> (chan) {
<a name="l05075"></a>05075                <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>))
<a name="l05076"></a>05076                   ast_copy_string(chan-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <span class="keyword">sizeof</span>(chan-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>));
<a name="l05077"></a>05077                <a class="code" href="pbx_8c.html#09e258d284c6e074e06ec6e73fb5886e">set_ext_pri</a>(chan, <span class="stringliteral">"failed"</span>, 1);
<a name="l05078"></a>05078                <a class="code" href="channel_8c.html#ee674fb53b907cc57dda6e54ac24a637">ast_set_variables</a>(chan, vars);
<a name="l05079"></a>05079                <span class="keywordflow">if</span> (<a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a>)
<a name="l05080"></a>05080                   <a class="code" href="cdr_8c.html#8aa58d36e6bd15ba7d10e367d9870e60">ast_cdr_setaccount</a>(chan, <a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a>);
<a name="l05081"></a>05081                <a class="code" href="pbx_8c.html#235c18a381a9501a4dc41b06b080c24f">ast_pbx_run</a>(chan);
<a name="l05082"></a>05082             }
<a name="l05083"></a>05083          }
<a name="l05084"></a>05084       }
<a name="l05085"></a>05085    } <span class="keywordflow">else</span> {
<a name="l05086"></a>05086       <span class="keywordflow">if</span> (!(as = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*as)))) {
<a name="l05087"></a>05087          res = -1;
<a name="l05088"></a>05088          <span class="keywordflow">goto</span> outgoing_exten_cleanup;
<a name="l05089"></a>05089       }
<a name="l05090"></a>05090       chan = <a class="code" href="channel_8c.html#354090aed9318ebfbf7629d0a4e5fb7c">ast_request_and_dial</a>(<a class="code" href="rtp_8c.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, <a class="code" href="chan__alsa_8c.html#1ddcb92ade31c8fbd370001f9b29a7d9">format</a>, data, timeout, reason, <a class="code" href="chan__mgcp_8c.html#ca3c0eb6b6e898f3a32aed5de1320774">cid_num</a>, <a class="code" href="chan__mgcp_8c.html#70f178a59d8df82fe5e107da71415b9b">cid_name</a>);
<a name="l05091"></a>05091       <span class="keywordflow">if</span> (channel) {
<a name="l05092"></a>05092          *channel = chan;
<a name="l05093"></a>05093          <span class="keywordflow">if</span> (chan)
<a name="l05094"></a>05094             <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l05095"></a>05095       }
<a name="l05096"></a>05096       <span class="keywordflow">if</span> (!chan) {
<a name="l05097"></a>05097          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(as);
<a name="l05098"></a>05098          res = -1;
<a name="l05099"></a>05099          <span class="keywordflow">goto</span> outgoing_exten_cleanup;
<a name="l05100"></a>05100       }
<a name="l05101"></a>05101       as-&gt;chan = chan;
<a name="l05102"></a>05102       ast_copy_string(as-&gt;context, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <span class="keyword">sizeof</span>(as-&gt;context));
<a name="l05103"></a>05103       <a class="code" href="pbx_8c.html#09e258d284c6e074e06ec6e73fb5886e">set_ext_pri</a>(as-&gt;chan,  <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="code" href="structoutgoing__helper.html#b988295c268025b49dfb3df26171ddc3">priority</a>);
<a name="l05104"></a>05104       as-&gt;timeout = timeout;
<a name="l05105"></a>05105       <a class="code" href="channel_8c.html#ee674fb53b907cc57dda6e54ac24a637">ast_set_variables</a>(chan, vars);
<a name="l05106"></a>05106       <span class="keywordflow">if</span> (<a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a>)
<a name="l05107"></a>05107          <a class="code" href="cdr_8c.html#8aa58d36e6bd15ba7d10e367d9870e60">ast_cdr_setaccount</a>(chan, <a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a>);
<a name="l05108"></a>05108       <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#97e9ed35da1f19087b177cdffdf53c97">ast_pthread_create_detached</a>(&amp;as-&gt;p, NULL, <a class="code" href="pbx_8c.html#23af98d69a15a8250c44aaea18d487af">async_wait</a>, as)) {
<a name="l05109"></a>05109          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Failed to start async wait\n"</span>);
<a name="l05110"></a>05110          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(as);
<a name="l05111"></a>05111          <span class="keywordflow">if</span> (channel) {
<a name="l05112"></a>05112             *channel = NULL;
<a name="l05113"></a>05113             <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l05114"></a>05114          }
<a name="l05115"></a>05115          <a class="code" href="channel_8c.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a>(chan);
<a name="l05116"></a>05116          res = -1;
<a name="l05117"></a>05117          <span class="keywordflow">goto</span> outgoing_exten_cleanup;
<a name="l05118"></a>05118       }
<a name="l05119"></a>05119       res = 0;
<a name="l05120"></a>05120    }
<a name="l05121"></a>05121 outgoing_exten_cleanup:
<a name="l05122"></a>05122    <a class="code" href="config_8c.html#d616f18584600c70e8744e217c03407c">ast_variables_destroy</a>(vars);
<a name="l05123"></a>05123    <span class="keywordflow">return</span> res;
<a name="l05124"></a>05124 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="235c18a381a9501a4dc41b06b080c24f"></a><!-- doxytag: member="pbx.c::ast_pbx_run" ref="235c18a381a9501a4dc41b06b080c24f" args="(struct ast_channel *c)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912">ast_pbx_result</a> ast_pbx_run           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>c</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Execute the PBX in the current thread. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>channel to run the pbx on</td></tr>
  </table>
</dl>
This executes the PBX on a given channel. It allocates a new PBX structure for the channel, and provides all PBX functionality. See ast_pbx_start for an asynchronous function to run the PBX in a new thread as opposed to the current one.<p>
<dl compact><dt><b>Returns:</b></dt><dd>Zero on success, non-zero on failure </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02572">2572</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>, <a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a9126d32a4969792a16a712111cd4664d1c8">AST_PBX_CALL_LIMIT</a>, <a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912c86643c5e19588b3eb7dce58a2b4145a">AST_PBX_SUCCESS</a>, <a class="el" href="pbx_8c-source.html#l02513">decrease_call_count()</a>, and <a class="el" href="pbx_8c-source.html#l02468">increase_call_count()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04991">ast_pbx_outgoing_exten()</a>, <a class="el" href="pbx_8c-source.html#l04903">async_wait()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02638">mgcp_ss()</a>, <a class="el" href="chan__skinny_8c-source.html#l02342">skinny_newcall()</a>, and <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>.<div class="fragment"><pre class="fragment"><a name="l02573"></a>02573 {
<a name="l02574"></a>02574    <span class="keyword">enum</span> <a class="code" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912">ast_pbx_result</a> res = <a class="code" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912c86643c5e19588b3eb7dce58a2b4145a">AST_PBX_SUCCESS</a>;
<a name="l02575"></a>02575 
<a name="l02576"></a>02576    <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#98ddc357b5ac13bfaa71167740ecc75a">increase_call_count</a>(c))
<a name="l02577"></a>02577       <span class="keywordflow">return</span> <a class="code" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a9126d32a4969792a16a712111cd4664d1c8">AST_PBX_CALL_LIMIT</a>;
<a name="l02578"></a>02578 
<a name="l02579"></a>02579    res = <a class="code" href="pbx_8c.html#d6a76cc38fc49b50acb5368a81899555">__ast_pbx_run</a>(c);
<a name="l02580"></a>02580    <a class="code" href="pbx_8c.html#2cf1332e5b45c96d7508015a47e21b84">decrease_call_count</a>();
<a name="l02581"></a>02581 
<a name="l02582"></a>02582    <span class="keywordflow">return</span> res;
<a name="l02583"></a>02583 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="38fb34f5a491b6b51279535ef9ba6620"></a><!-- doxytag: member="pbx.c::ast_pbx_run_app" ref="38fb34f5a491b6b51279535ef9ba6620" args="(void *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void* ast_pbx_run_app           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>data</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
run the application and free the descriptor once done 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05134">5134</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l05127">app_tmp::app</a>, <a class="el" href="channel_8c-source.html#l01598">ast_hangup()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="pbx_8c-source.html#l05129">app_tmp::chan</a>, <a class="el" href="pbx_8c-source.html#l05128">app_tmp::data</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="pbx_8c-source.html#l00509">pbx_exec()</a>, <a class="el" href="pbx_8c-source.html#l00547">pbx_findapp()</a>, and <a class="el" href="logger_8h-source.html#l00046">VERBOSE_PREFIX_4</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l05150">ast_pbx_outgoing_app()</a>.<div class="fragment"><pre class="fragment"><a name="l05135"></a>05135 {
<a name="l05136"></a>05136    <span class="keyword">struct </span><a class="code" href="structapp__tmp.html">app_tmp</a> *tmp = <a class="code" href="structapp__tmp.html#e7232ed861fc8b075649bf08d405e789">data</a>;
<a name="l05137"></a>05137    <span class="keyword">struct </span><a class="code" href="structast__app.html">ast_app</a> *<a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>;
<a name="l05138"></a>05138    app = <a class="code" href="pbx_8c.html#d407cf204ec8fc50e5a578c8c17e0cb5">pbx_findapp</a>(tmp-&gt;<a class="code" href="structapp__tmp.html#c43b13e5c8f54532967ff0925bb74a16">app</a>);
<a name="l05139"></a>05139    <span class="keywordflow">if</span> (app) {
<a name="l05140"></a>05140       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 3)
<a name="l05141"></a>05141          <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#8f25f582e7a737b25f607fb6ad653807">VERBOSE_PREFIX_4</a> <span class="stringliteral">"Launching %s(%s) on %s\n"</span>, tmp-&gt;<a class="code" href="structapp__tmp.html#c43b13e5c8f54532967ff0925bb74a16">app</a>, tmp-&gt;<a class="code" href="structapp__tmp.html#e7232ed861fc8b075649bf08d405e789">data</a>, tmp-&gt;<a class="code" href="structapp__tmp.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;name);
<a name="l05142"></a>05142       <a class="code" href="pbx_8c.html#5970fbcb6a776848d11bf1c8ddb1c948">pbx_exec</a>(tmp-&gt;<a class="code" href="structapp__tmp.html#26c322652770620e64ac90682eb6504c">chan</a>, app, tmp-&gt;<a class="code" href="structapp__tmp.html#e7232ed861fc8b075649bf08d405e789">data</a>);
<a name="l05143"></a>05143    } <span class="keywordflow">else</span>
<a name="l05144"></a>05144       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"No such application '%s'\n"</span>, tmp-&gt;<a class="code" href="structapp__tmp.html#c43b13e5c8f54532967ff0925bb74a16">app</a>);
<a name="l05145"></a>05145    <a class="code" href="channel_8c.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a>(tmp-&gt;<a class="code" href="structapp__tmp.html#26c322652770620e64ac90682eb6504c">chan</a>);
<a name="l05146"></a>05146    <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(tmp);
<a name="l05147"></a>05147    <span class="keywordflow">return</span> NULL;
<a name="l05148"></a>05148 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c55e82ff3dabed89efd77f20209b1006"></a><!-- doxytag: member="pbx.c::ast_pbx_start" ref="c55e82ff3dabed89efd77f20209b1006" args="(struct ast_channel *c)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912">ast_pbx_result</a> ast_pbx_start           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>c</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Create a new thread and start the PBX. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>channel to start the pbx on</td></tr>
  </table>
</dl>
See ast_pbx_run for a synchronous function to run the PBX in the current thread, as opposed to starting a new one.<p>
<dl compact><dt><b>Returns:</b></dt><dd>Zero on success, non-zero on failure </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02551">2551</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a9126d32a4969792a16a712111cd4664d1c8">AST_PBX_CALL_LIMIT</a>, <a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912f5f5d3987a33fd6012262bab9c332519">AST_PBX_FAILED</a>, <a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912c86643c5e19588b3eb7dce58a2b4145a">AST_PBX_SUCCESS</a>, <a class="el" href="utils_8h-source.html#l00302">ast_pthread_create_detached</a>, <a class="el" href="pbx_8c-source.html#l02468">increase_call_count()</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, and <a class="el" href="pbx_8c-source.html#l02531">pbx_thread()</a>.
<p>
Referenced by <a class="el" href="chan__h323_8c-source.html#l01010">__oh323_new()</a>, <a class="el" href="chan__alsa_8c-source.html#l00790">alsa_new()</a>, <a class="el" href="pbx_8c-source.html#l04595">ast_async_goto()</a>, <a class="el" href="res__features_8c-source.html#l00231">ast_bridge_call_thread()</a>, <a class="el" href="chan__iax2_8c-source.html#l03426">ast_iax2_new()</a>, <a class="el" href="pbx_8c-source.html#l04991">ast_pbx_outgoing_exten()</a>, <a class="el" href="res__features_8c-source.html#l02716">bridge_exec()</a>, <a class="el" href="res__features_8c-source.html#l00192">check_goto_on_transfer()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="res__features_8c-source.html#l01761">do_parking_thread()</a>, <a class="el" href="chan__gtalk_8c-source.html#l00902">gtalk_new()</a>, <a class="el" href="chan__gtalk_8c-source.html#l01070">gtalk_newcall()</a>, <a class="el" href="chan__sip_8c-source.html#l14098">handle_request_invite()</a>, <a class="el" href="chan__jingle_8c-source.html#l00759">jingle_new()</a>, <a class="el" href="chan__jingle_8c-source.html#l00911">jingle_newcall()</a>, <a class="el" href="chan__local_8c-source.html#l00446">local_call()</a>, <a class="el" href="chan__mgcp_8c-source.html#l01457">mgcp_new()</a>, <a class="el" href="chan__nbs_8c-source.html#l00233">nbs_new()</a>, <a class="el" href="chan__oss_8c-source.html#l01020">oss_new()</a>, <a class="el" href="chan__misdn_8c-source.html#l03427">pbx_start_chan()</a>, <a class="el" href="chan__phone_8c-source.html#l00864">phone_new()</a>, <a class="el" href="app__rpt_8c-source.html#l02483">rpt_call()</a>, <a class="el" href="chan__sip_8c-source.html#l04179">sip_new()</a>, <a class="el" href="chan__skinny_8c-source.html#l02823">skinny_new()</a>, <a class="el" href="chan__iax2_8c-source.html#l06624">socket_process()</a>, and <a class="el" href="chan__zap_8c-source.html#l05516">zt_new()</a>.<div class="fragment"><pre class="fragment"><a name="l02552"></a>02552 {
<a name="l02553"></a>02553    pthread_t t;
<a name="l02554"></a>02554 
<a name="l02555"></a>02555    <span class="keywordflow">if</span> (!c) {
<a name="l02556"></a>02556       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Asked to start thread on NULL channel?\n"</span>);
<a name="l02557"></a>02557       <span class="keywordflow">return</span> <a class="code" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912f5f5d3987a33fd6012262bab9c332519">AST_PBX_FAILED</a>;
<a name="l02558"></a>02558    }
<a name="l02559"></a>02559 
<a name="l02560"></a>02560    <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#98ddc357b5ac13bfaa71167740ecc75a">increase_call_count</a>(c))
<a name="l02561"></a>02561       <span class="keywordflow">return</span> <a class="code" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a9126d32a4969792a16a712111cd4664d1c8">AST_PBX_CALL_LIMIT</a>;
<a name="l02562"></a>02562 
<a name="l02563"></a>02563    <span class="comment">/* Start a new thread, and get something handling this channel. */</span>
<a name="l02564"></a>02564    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#97e9ed35da1f19087b177cdffdf53c97">ast_pthread_create_detached</a>(&amp;t, NULL, <a class="code" href="pbx_8c.html#b3150b6a7a36bf2a840a8d53b01a36c9">pbx_thread</a>, c)) {
<a name="l02565"></a>02565       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Failed to create new channel thread\n"</span>);
<a name="l02566"></a>02566       <span class="keywordflow">return</span> <a class="code" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912f5f5d3987a33fd6012262bab9c332519">AST_PBX_FAILED</a>;
<a name="l02567"></a>02567    }
<a name="l02568"></a>02568 
<a name="l02569"></a>02569    <span class="keywordflow">return</span> <a class="code" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912c86643c5e19588b3eb7dce58a2b4145a">AST_PBX_SUCCESS</a>;
<a name="l02570"></a>02570 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a09f0d0ac316a1ae5c74d6958d2b913e"></a><!-- doxytag: member="pbx.c::ast_rdlock_context" ref="a09f0d0ac316a1ae5c74d6958d2b913e" args="(struct ast_context *con)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_rdlock_context           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>con</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read locks a given context. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>con</em>&nbsp;</td><td>context to lock</td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06087">6087</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="lock_8h-source.html#l00642">ast_rwlock_rdlock()</a>, and <a class="el" href="pbx_8c-source.html#l00166">ast_context::lock</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01187">complete_context_remove_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00211">complete_context_remove_include()</a>, <a class="el" href="pbx__dundi_8c-source.html#l03615">dundi_precache_full()</a>, <a class="el" href="app__while_8c-source.html#l00123">find_matching_endwhile()</a>, <a class="el" href="pbx__config_8c-source.html#l00151">lookup_c_ip()</a>, <a class="el" href="pbx__config_8c-source.html#l00137">lookup_ci()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06088"></a>06088 {
<a name="l06089"></a>06089    <span class="keywordflow">return</span> <a class="code" href="lock_8h.html#f4b8158bcd471d4f28b380768e3ee073">ast_rwlock_rdlock</a>(&amp;con-&gt;<a class="code" href="structast__context.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l06090"></a>06090 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1b60f4b570102084989c86fd02ca6536"></a><!-- doxytag: member="pbx.c::ast_rdlock_contexts" ref="1b60f4b570102084989c86fd02ca6536" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_rdlock_contexts           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read locks the context list. 
<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on error </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06069">6069</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="lock_8h-source.html#l00642">ast_rwlock_rdlock()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l00889">ast_context_find()</a>, <a class="el" href="pbx_8c-source.html#l02823">ast_context_lockmacro()</a>, <a class="el" href="pbx_8c-source.html#l02851">ast_context_unlockmacro()</a>, <a class="el" href="pbx_8c-source.html#l01799">ast_hint_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01033">complete_context_add_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01104">complete_context_add_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00619">complete_context_add_include()</a>, <a class="el" href="pbx__config_8c-source.html#l00449">complete_context_remove_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01187">complete_context_remove_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00211">complete_context_remove_include()</a>, <a class="el" href="pbx_8c-source.html#l03275">complete_show_dialplan_context()</a>, <a class="el" href="pbx__dundi_8c-source.html#l03615">dundi_precache_full()</a>, <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>, <a class="el" href="app__while_8c-source.html#l00123">find_matching_endwhile()</a>, <a class="el" href="pbx__config_8c-source.html#l00717">handle_save_dialplan()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>, <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03830">unreference_cached_app()</a>.<div class="fragment"><pre class="fragment"><a name="l06070"></a>06070 {
<a name="l06071"></a>06071    <span class="keywordflow">return</span> <a class="code" href="lock_8h.html#f4b8158bcd471d4f28b380768e3ee073">ast_rwlock_rdlock</a>(&amp;conlock);
<a name="l06072"></a>06072 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="f8e9b339fed38c405332f222cceeec40"></a><!-- doxytag: member="pbx.c::ast_register_application" ref="f8e9b339fed38c405332f222cceeec40" args="(const char *app, int(*execute)(struct ast_channel *, void *), const char *synopsis, const char *description)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_register_application           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>app</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int(*)(struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)&nbsp;</td>
          <td class="mdname" nowrap> <em>execute</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>synopsis</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>description</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Register an application. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>app</em>&nbsp;</td><td>Short name of the application </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>execute</em>&nbsp;</td><td>a function callback to execute the application. It should return non-zero if the channel needs to be hung up. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>synopsis</em>&nbsp;</td><td>a short description (one line synopsis) of the application </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>description</em>&nbsp;</td><td>long description with all of the details about the use of the application</td></tr>
  </table>
</dl>
This registers an application with Asterisk's internal application list. <dl compact><dt><b>Note:</b></dt><dd>The individual applications themselves are responsible for registering and unregistering and unregistering their own CLI commands.</dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>failure. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02875">2875</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="linkedlists_8h-source.html#l00549">AST_RWLIST_INSERT_BEFORE_CURRENT</a>, <a class="el" href="linkedlists_8h-source.html#l00680">AST_RWLIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00503">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h-source.html#l00556">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="term_8h-source.html#l00052">COLOR_BRCYAN</a>, <a class="el" href="pbx_8c-source.html#l00182">ast_app::description</a>, <a class="el" href="structast__app.html#881e868890bc8e5cd8614a1ce80c09eb">ast_app::execute</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="pbx_8c-source.html#l00181">ast_app::synopsis</a>, <a class="el" href="term_8c-source.html#l00150">term_color()</a>, and <a class="el" href="logger_8h-source.html#l00044">VERBOSE_PREFIX_2</a>.
<p>
Referenced by <a class="el" href="app__adsiprog_8c-source.html#l01585">load_module()</a>, and <a class="el" href="pbx_8c-source.html#l06035">load_pbx()</a>.<div class="fragment"><pre class="fragment"><a name="l02876"></a>02876 {
<a name="l02877"></a>02877    <span class="keyword">struct </span><a class="code" href="structast__app.html">ast_app</a> *tmp, *cur = NULL;
<a name="l02878"></a>02878    <span class="keywordtype">char</span> tmps[80];
<a name="l02879"></a>02879    <span class="keywordtype">int</span> length;
<a name="l02880"></a>02880 
<a name="l02881"></a>02881    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;apps);
<a name="l02882"></a>02882    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;apps, tmp, list) {
<a name="l02883"></a>02883       <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>, tmp-&gt;name)) {
<a name="l02884"></a>02884          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Already have an application '%s'\n"</span>, <a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>);
<a name="l02885"></a>02885          <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;apps);
<a name="l02886"></a>02886          <span class="keywordflow">return</span> -1;
<a name="l02887"></a>02887       }
<a name="l02888"></a>02888    }
<a name="l02889"></a>02889 
<a name="l02890"></a>02890    length = <span class="keyword">sizeof</span>(*tmp) + strlen(<a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>) + 1;
<a name="l02891"></a>02891 
<a name="l02892"></a>02892    <span class="keywordflow">if</span> (!(tmp = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, length))) {
<a name="l02893"></a>02893       <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;apps);
<a name="l02894"></a>02894       <span class="keywordflow">return</span> -1;
<a name="l02895"></a>02895    }
<a name="l02896"></a>02896 
<a name="l02897"></a>02897    strcpy(tmp-&gt;name, <a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>);
<a name="l02898"></a>02898    tmp-&gt;<a class="code" href="structast__app.html#881e868890bc8e5cd8614a1ce80c09eb">execute</a> = <a class="code" href="structast__app.html#881e868890bc8e5cd8614a1ce80c09eb">execute</a>;
<a name="l02899"></a>02899    tmp-&gt;<a class="code" href="structast__app.html#512fbb4e7b617c04031f58b631f2b05d">synopsis</a> = <a class="code" href="chan__agent_8c.html#485d112e4e425dde393e2e7091451856">synopsis</a>;
<a name="l02900"></a>02900    tmp-&gt;<a class="code" href="structast__app.html#67daf92c833c41c95db874e18fcb2786">description</a> = <a class="code" href="callerid_8c.html#67daf92c833c41c95db874e18fcb2786">description</a>;
<a name="l02901"></a>02901 
<a name="l02902"></a>02902    <span class="comment">/* Store in alphabetical order */</span>
<a name="l02903"></a>02903    <a class="code" href="linkedlists_8h.html#b564f1f262db6464e1644462c38d61e3">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;apps, cur, list) {
<a name="l02904"></a>02904       <span class="keywordflow">if</span> (strcasecmp(tmp-&gt;name, cur-&gt;name) &lt; 0) {
<a name="l02905"></a>02905          <a class="code" href="linkedlists_8h.html#cf4d2eed92b828f7212b90b1dcde0b29">AST_RWLIST_INSERT_BEFORE_CURRENT</a>(&amp;apps, tmp, list);
<a name="l02906"></a>02906          <span class="keywordflow">break</span>;
<a name="l02907"></a>02907       }
<a name="l02908"></a>02908    }
<a name="l02909"></a>02909    <a class="code" href="linkedlists_8h.html#e5be717f6b8c1586fa30a060b56403fe">AST_RWLIST_TRAVERSE_SAFE_END</a>
<a name="l02910"></a>02910    <span class="keywordflow">if</span> (!cur)
<a name="l02911"></a>02911       <a class="code" href="linkedlists_8h.html#64b41a3e9f2e6a867c09431dfae7ce21">AST_RWLIST_INSERT_TAIL</a>(&amp;apps, tmp, list);
<a name="l02912"></a>02912 
<a name="l02913"></a>02913    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 1)
<a name="l02914"></a>02914       <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>( <a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Registered application '%s'\n"</span>, <a class="code" href="term_8c.html#e93d6667c9a6823fef4ab75cd64c90ca">term_color</a>(tmps, tmp-&gt;name, <a class="code" href="term_8h.html#ed35747ad832f24a4b7cf183cf619ad5">COLOR_BRCYAN</a>, 0, <span class="keyword">sizeof</span>(tmps)));
<a name="l02915"></a>02915 
<a name="l02916"></a>02916    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;apps);
<a name="l02917"></a>02917 
<a name="l02918"></a>02918    <span class="keywordflow">return</span> 0;
<a name="l02919"></a>02919 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ce9b1b9b9951df409f13e9c6c9a94d71"></a><!-- doxytag: member="pbx.c::ast_register_switch" ref="ce9b1b9b9951df409f13e9c6c9a94d71" args="(struct ast_switch *sw)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_register_switch           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__switch.html">ast_switch</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>sw</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Register an alternative dialplan switch. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sw</em>&nbsp;</td><td>switch to register</td></tr>
  </table>
</dl>
This function registers a populated <a class="el" href="structast__switch.html">ast_switch</a> structure with the asterisk switching architecture.<p>
<dl compact><dt><b>Returns:</b></dt><dd>0 on success, and other than 0 on failure </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02925">2925</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="linkedlists_8h-source.html#l00680">AST_RWLIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, and <a class="el" href="pbx_8h-source.html#l00089">ast_switch::name</a>.
<p>
Referenced by <a class="el" href="chan__iax2_8c-source.html#l10425">load_module()</a>.<div class="fragment"><pre class="fragment"><a name="l02926"></a>02926 {
<a name="l02927"></a>02927    <span class="keyword">struct </span><a class="code" href="structast__switch.html">ast_switch</a> *tmp;
<a name="l02928"></a>02928 
<a name="l02929"></a>02929    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;switches);
<a name="l02930"></a>02930    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;switches, tmp, list) {
<a name="l02931"></a>02931       <span class="keywordflow">if</span> (!strcasecmp(tmp-&gt;<a class="code" href="structast__switch.html#b068931cc450442b63f5b3d276ea4297">name</a>, sw-&gt;<a class="code" href="structast__switch.html#b068931cc450442b63f5b3d276ea4297">name</a>)) {
<a name="l02932"></a>02932          <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;switches);
<a name="l02933"></a>02933          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Switch '%s' already found\n"</span>, sw-&gt;<a class="code" href="structast__switch.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l02934"></a>02934          <span class="keywordflow">return</span> -1;
<a name="l02935"></a>02935       }
<a name="l02936"></a>02936    }
<a name="l02937"></a>02937    <a class="code" href="linkedlists_8h.html#64b41a3e9f2e6a867c09431dfae7ce21">AST_RWLIST_INSERT_TAIL</a>(&amp;switches, sw, list);
<a name="l02938"></a>02938    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;switches);
<a name="l02939"></a>02939 
<a name="l02940"></a>02940    <span class="keywordflow">return</span> 0;
<a name="l02941"></a>02941 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1b7cfd3851ae1fbfaf60fef51c4756f2"></a><!-- doxytag: member="pbx.c::ast_remove_hint" ref="1b7cfd3851ae1fbfaf60fef51c4756f2" args="(struct ast_exten *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int ast_remove_hint           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
ast_remove_hint: Remove hint from extension 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02131">2131</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75ba2a7d54f03c58c97ed6230623a70d4b">AST_EXTENSION_DEACTIVATED</a>, <a class="el" href="linkedlists_8h-source.html#l00526">AST_RWLIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h-source.html#l00503">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h-source.html#l00556">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="pbx_8c-source.html#l00192">ast_state_cb::callback</a>, <a class="el" href="pbx_8c-source.html#l00205">ast_hint::callbacks</a>, <a class="el" href="pbx_8c-source.html#l00191">ast_state_cb::data</a>, <a class="el" href="pbx_8c-source.html#l00119">ast_exten::exten</a>, <a class="el" href="pbx_8c-source.html#l00203">ast_hint::exten</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="pbx_8c-source.html#l00193">ast_state_cb::next</a>, and <a class="el" href="pbx_8c-source.html#l00124">ast_exten::parent</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02521">destroy_exten()</a>.<div class="fragment"><pre class="fragment"><a name="l02132"></a>02132 {
<a name="l02133"></a>02133    <span class="comment">/* Cleanup the Notifys if hint is removed */</span>
<a name="l02134"></a>02134    <span class="keyword">struct </span><a class="code" href="structast__hint.html">ast_hint</a> *hint;
<a name="l02135"></a>02135    <span class="keyword">struct </span><a class="code" href="structast__state__cb.html">ast_state_cb</a> *cblist, *cbprev;
<a name="l02136"></a>02136    <span class="keywordtype">int</span> res = -1;
<a name="l02137"></a>02137 
<a name="l02138"></a>02138    <span class="keywordflow">if</span> (!e)
<a name="l02139"></a>02139       <span class="keywordflow">return</span> -1;
<a name="l02140"></a>02140 
<a name="l02141"></a>02141    <a class="code" href="linkedlists_8h.html#b564f1f262db6464e1644462c38d61e3">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;hints, hint, list) {
<a name="l02142"></a>02142       <span class="keywordflow">if</span> (hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a> == e) {
<a name="l02143"></a>02143          cbprev = NULL;
<a name="l02144"></a>02144          cblist = hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a>;
<a name="l02145"></a>02145          <span class="keywordflow">while</span> (cblist) {
<a name="l02146"></a>02146             <span class="comment">/* Notify with -1 and remove all callbacks */</span>
<a name="l02147"></a>02147             cbprev = cblist;
<a name="l02148"></a>02148             cblist = cblist-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l02149"></a>02149             cbprev-&gt;<a class="code" href="structast__state__cb.html#924a8ceeac17f54d3be3f8cdf1c04eb2">callback</a>(hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>-&gt;<a class="code" href="structast__exten.html#d0e45878043844ffc41aac437e86b602">parent</a>-&gt;name, hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>, <a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75ba2a7d54f03c58c97ed6230623a70d4b">AST_EXTENSION_DEACTIVATED</a>, cbprev-&gt;<a class="code" href="structast__state__cb.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l02150"></a>02150             <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(cbprev);
<a name="l02151"></a>02151             }
<a name="l02152"></a>02152             hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a> = NULL;
<a name="l02153"></a>02153          <a class="code" href="linkedlists_8h.html#93783e4cad722e705630e975d2e8d7f9">AST_RWLIST_REMOVE_CURRENT</a>(&amp;hints, list);
<a name="l02154"></a>02154             <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(hint);
<a name="l02155"></a>02155             res = 0;
<a name="l02156"></a>02156          <span class="keywordflow">break</span>;
<a name="l02157"></a>02157       }
<a name="l02158"></a>02158    }
<a name="l02159"></a>02159    <a class="code" href="linkedlists_8h.html#e5be717f6b8c1586fa30a060b56403fe">AST_RWLIST_TRAVERSE_SAFE_END</a>
<a name="l02160"></a>02160 
<a name="l02161"></a>02161    <span class="keywordflow">return</span> res;
<a name="l02162"></a>02162 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="027c81114f7c33b0761f8738aa848686"></a><!-- doxytag: member="pbx.c::AST_RWLIST_HEAD_STATIC" ref="027c81114f7c33b0761f8738aa848686" args="(hints, ast_hint)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static AST_RWLIST_HEAD_STATIC           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">hints&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structast__hint.html">ast_hint</a>&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1514e136859b9d9743a2e119aa0a338a"></a><!-- doxytag: member="pbx.c::AST_RWLIST_HEAD_STATIC" ref="1514e136859b9d9743a2e119aa0a338a" args="(switches, ast_switch)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static AST_RWLIST_HEAD_STATIC           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">switches&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structast__switch.html">ast_switch</a>&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="5d937a850fe80d246dbb85200c152a2f"></a><!-- doxytag: member="pbx.c::AST_RWLIST_HEAD_STATIC" ref="5d937a850fe80d246dbb85200c152a2f" args="(apps, ast_app)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static AST_RWLIST_HEAD_STATIC           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">apps&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structast__app.html">ast_app</a>&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c0487194302197a978dc0c1f7f0abfb5"></a><!-- doxytag: member="pbx.c::AST_RWLIST_HEAD_STATIC" ref="c0487194302197a978dc0c1f7f0abfb5" args="(acf_root, ast_custom_function)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static AST_RWLIST_HEAD_STATIC           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">acf_root&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structast__custom__function.html">ast_custom_function</a>&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1d2c53e09ab41536a967ee69814e3c87"></a><!-- doxytag: member="pbx.c::AST_RWLOCK_DEFINE_STATIC" ref="1d2c53e09ab41536a967ee69814e3c87" args="(conlock)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">AST_RWLOCK_DEFINE_STATIC           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">conlock&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Lock for the <a class="el" href="structast__context.html">ast_context</a> list     </td>
  </tr>
</table>
<a class="anchor" name="03bd27a9311428cc3704f560c5c5f623"></a><!-- doxytag: member="pbx.c::AST_RWLOCK_DEFINE_STATIC" ref="03bd27a9311428cc3704f560c5c5f623" args="(globalslock)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">AST_RWLOCK_DEFINE_STATIC           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">globalslock&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="63a99eec1b6004791bd2013ad855eea8"></a><!-- doxytag: member="pbx.c::ast_spawn_extension" ref="63a99eec1b6004791bd2013ad855eea8" args="(struct ast_channel *c, const char *context, const char *exten, int priority, const char *callerid)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_spawn_extension           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>callerid</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Launch a new extension (i.e. new stack). 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>not important </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>which context to generate the extension within </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>exten</em>&nbsp;</td><td>new extension to add </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>priority</em>&nbsp;</td><td>priority of new extension </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callerid</em>&nbsp;</td><td>callerid of extension</td></tr>
  </table>
</dl>
This adds a new extension to the asterisk extension list.<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02208">2208</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe216abbac78adc685e53502161a311679">E_SPAWN</a>, and <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>, and <a class="el" href="pbx__loopback_8c-source.html#l00142">loopback_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l02209"></a>02209 {
<a name="l02210"></a>02210    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#2377c7b979811bdd54ebf819e5d2037b">pbx_extension_helper</a>(c, NULL, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, priority, NULL, callerid, <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe216abbac78adc685e53502161a311679">E_SPAWN</a>);
<a name="l02211"></a>02211 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="adad2f961a9f0ccdd8a48dee073793cc"></a><!-- doxytag: member="pbx.c::ast_unlock_context" ref="adad2f961a9f0ccdd8a48dee073793cc" args="(struct ast_context *con)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_unlock_context           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>con</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Unlocks</em>&nbsp;</td><td>the given context</td></tr>
  </table>
</dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>con</em>&nbsp;</td><td>context to unlock</td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06092">6092</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="lock_8h-source.html#l00637">ast_rwlock_unlock()</a>, and <a class="el" href="pbx_8c-source.html#l00166">ast_context::lock</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l05285">__ast_context_destroy()</a>, <a class="el" href="pbx_8c-source.html#l04765">ast_add_extension2()</a>, <a class="el" href="pbx_8c-source.html#l04509">ast_context_add_ignorepat2()</a>, <a class="el" href="pbx_8c-source.html#l04304">ast_context_add_include2()</a>, <a class="el" href="pbx_8c-source.html#l04386">ast_context_add_switch2()</a>, <a class="el" href="pbx_8c-source.html#l02746">ast_context_remove_extension2()</a>, <a class="el" href="pbx_8c-source.html#l04466">ast_context_remove_ignorepat2()</a>, <a class="el" href="pbx_8c-source.html#l02640">ast_context_remove_include2()</a>, <a class="el" href="pbx_8c-source.html#l02694">ast_context_remove_switch2()</a>, <a class="el" href="pbx__config_8c-source.html#l01187">complete_context_remove_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00211">complete_context_remove_include()</a>, <a class="el" href="pbx__dundi_8c-source.html#l03615">dundi_precache_full()</a>, <a class="el" href="app__while_8c-source.html#l00123">find_matching_endwhile()</a>, <a class="el" href="pbx__config_8c-source.html#l00151">lookup_c_ip()</a>, <a class="el" href="pbx__config_8c-source.html#l00137">lookup_ci()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06093"></a>06093 {
<a name="l06094"></a>06094    <span class="keywordflow">return</span> <a class="code" href="lock_8h.html#97ed909ef0a0582cf3870dd0629852c8">ast_rwlock_unlock</a>(&amp;con-&gt;<a class="code" href="structast__context.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l06095"></a>06095 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="dc1d3ecafa5a93767dd4ed321ed91d10"></a><!-- doxytag: member="pbx.c::ast_unlock_contexts" ref="dc1d3ecafa5a93767dd4ed321ed91d10" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_unlock_contexts           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unlocks contexts. 
<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06074">6074</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="lock_8h-source.html#l00637">ast_rwlock_unlock()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03870">__ast_context_create()</a>, <a class="el" href="pbx_8c-source.html#l04561">ast_add_extension()</a>, <a class="el" href="pbx_8c-source.html#l04497">ast_context_add_ignorepat()</a>, <a class="el" href="pbx_8c-source.html#l04042">ast_context_add_include()</a>, <a class="el" href="pbx_8c-source.html#l04367">ast_context_add_switch()</a>, <a class="el" href="pbx_8c-source.html#l05344">ast_context_destroy()</a>, <a class="el" href="pbx_8c-source.html#l00889">ast_context_find()</a>, <a class="el" href="pbx_8c-source.html#l02823">ast_context_lockmacro()</a>, <a class="el" href="pbx_8c-source.html#l02724">ast_context_remove_extension()</a>, <a class="el" href="pbx_8c-source.html#l04454">ast_context_remove_ignorepat()</a>, <a class="el" href="pbx_8c-source.html#l02619">ast_context_remove_include()</a>, <a class="el" href="pbx_8c-source.html#l02673">ast_context_remove_switch()</a>, <a class="el" href="pbx_8c-source.html#l02851">ast_context_unlockmacro()</a>, <a class="el" href="pbx_8c-source.html#l01799">ast_hint_extension()</a>, <a class="el" href="pbx_8c-source.html#l03936">ast_merge_contexts_and_delete()</a>, <a class="el" href="pbx__config_8c-source.html#l01033">complete_context_add_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01104">complete_context_add_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00619">complete_context_add_include()</a>, <a class="el" href="pbx__config_8c-source.html#l00449">complete_context_remove_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01187">complete_context_remove_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00211">complete_context_remove_include()</a>, <a class="el" href="pbx_8c-source.html#l03275">complete_show_dialplan_context()</a>, <a class="el" href="pbx__dundi_8c-source.html#l03615">dundi_precache_full()</a>, <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>, <a class="el" href="app__while_8c-source.html#l00123">find_matching_endwhile()</a>, <a class="el" href="pbx__config_8c-source.html#l00717">handle_save_dialplan()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>, <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03830">unreference_cached_app()</a>.<div class="fragment"><pre class="fragment"><a name="l06075"></a>06075 {
<a name="l06076"></a>06076    <span class="keywordflow">return</span> <a class="code" href="lock_8h.html#97ed909ef0a0582cf3870dd0629852c8">ast_rwlock_unlock</a>(&amp;conlock);
<a name="l06077"></a>06077 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4fc9ac8a7093a1f73637df0b9d6d6de9"></a><!-- doxytag: member="pbx.c::ast_unregister_application" ref="4fc9ac8a7093a1f73637df0b9d6d6de9" args="(const char *app)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_unregister_application           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>app</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unregister an application. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>app</em>&nbsp;</td><td>name of the application (does not have to be the same string as the one that was registered)</td></tr>
  </table>
</dl>
This unregisters an application from Asterisk's internal application list.<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03849">3849</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00526">AST_RWLIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h-source.html#l00503">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h-source.html#l00556">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="pbx_8c-source.html#l03830">unreference_cached_app()</a>, and <a class="el" href="logger_8h-source.html#l00044">VERBOSE_PREFIX_2</a>.
<p>
Referenced by <a class="el" href="chan__iax2_8c-source.html#l10340">__unload_module()</a>, and <a class="el" href="app__adsiprog_8c-source.html#l01573">unload_module()</a>.<div class="fragment"><pre class="fragment"><a name="l03850"></a>03850 {
<a name="l03851"></a>03851    <span class="keyword">struct </span><a class="code" href="structast__app.html">ast_app</a> *tmp;
<a name="l03852"></a>03852 
<a name="l03853"></a>03853    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;apps);
<a name="l03854"></a>03854    <a class="code" href="linkedlists_8h.html#b564f1f262db6464e1644462c38d61e3">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;apps, tmp, list) {
<a name="l03855"></a>03855       <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>, tmp-&gt;name)) {
<a name="l03856"></a>03856          <a class="code" href="pbx_8c.html#de5c3078bd604949446521990a001661">unreference_cached_app</a>(tmp);
<a name="l03857"></a>03857          <a class="code" href="linkedlists_8h.html#93783e4cad722e705630e975d2e8d7f9">AST_RWLIST_REMOVE_CURRENT</a>(&amp;apps, list);
<a name="l03858"></a>03858          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 1)
<a name="l03859"></a>03859             <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>( <a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Unregistered application '%s'\n"</span>, tmp-&gt;name);
<a name="l03860"></a>03860          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(tmp);
<a name="l03861"></a>03861          <span class="keywordflow">break</span>;
<a name="l03862"></a>03862       }
<a name="l03863"></a>03863    }
<a name="l03864"></a>03864    <a class="code" href="linkedlists_8h.html#e5be717f6b8c1586fa30a060b56403fe">AST_RWLIST_TRAVERSE_SAFE_END</a>
<a name="l03865"></a>03865    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;apps);
<a name="l03866"></a>03866 
<a name="l03867"></a>03867    <span class="keywordflow">return</span> tmp ? 0 : -1;
<a name="l03868"></a>03868 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="dfce547713eae00cf11fd0b876adb7f7"></a><!-- doxytag: member="pbx.c::ast_unregister_switch" ref="dfce547713eae00cf11fd0b876adb7f7" args="(struct ast_switch *sw)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_unregister_switch           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__switch.html">ast_switch</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>sw</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unregister an alternative switch. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sw</em>&nbsp;</td><td>switch to unregister</td></tr>
  </table>
</dl>
Unregisters a switch from asterisk.<p>
<dl compact><dt><b>Returns:</b></dt><dd>nothing </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02943">2943</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00749">AST_RWLIST_REMOVE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, and <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>.
<p>
Referenced by <a class="el" href="chan__iax2_8c-source.html#l10340">__unload_module()</a>, and <a class="el" href="pbx__dundi_8c-source.html#l04703">unload_module()</a>.<div class="fragment"><pre class="fragment"><a name="l02944"></a>02944 {
<a name="l02945"></a>02945    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;switches);
<a name="l02946"></a>02946    <a class="code" href="linkedlists_8h.html#dd27d7fa9f70ab8e5e35161cafdd0459">AST_RWLIST_REMOVE</a>(&amp;switches, sw, list);
<a name="l02947"></a>02947    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;switches);
<a name="l02948"></a>02948 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b3b7bf8e22da60a0df718a52f3424b79"></a><!-- doxytag: member="pbx.c::ast_walk_context_extensions" ref="b3b7bf8e22da60a0df718a52f3424b79" args="(struct ast_context *con, struct ast_exten *exten)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a>* ast_walk_context_extensions           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06201">6201</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00131">ast_exten::next</a>, and <a class="el" href="pbx_8c-source.html#l00167">ast_context::root</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l00449">complete_context_remove_extension()</a>, <a class="el" href="pbx__dundi_8c-source.html#l03615">dundi_precache_full()</a>, <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>, <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03830">unreference_cached_app()</a>.<div class="fragment"><pre class="fragment"><a name="l06203"></a>06203 {
<a name="l06204"></a>06204    <span class="keywordflow">if</span> (!exten)
<a name="l06205"></a>06205       <span class="keywordflow">return</span> con ? con-&gt;<a class="code" href="structast__context.html#63a9f0ea7bb98050796b649e85481845">root</a> : NULL;
<a name="l06206"></a>06206    <span class="keywordflow">else</span>
<a name="l06207"></a>06207       <span class="keywordflow">return</span> exten-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l06208"></a>06208 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="78f92771f39acc0696f7d12053ff4304"></a><!-- doxytag: member="pbx.c::ast_walk_context_ignorepats" ref="78f92771f39acc0696f7d12053ff4304" args="(struct ast_context *con, struct ast_ignorepat *ip)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__ignorepat.html">ast_ignorepat</a>* ast_walk_context_ignorepats           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__ignorepat.html">ast_ignorepat</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ip</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06234">6234</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00170">ast_context::ignorepats</a>, and <a class="el" href="pbx_8c-source.html#l00160">ast_ignorepat::next</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01187">complete_context_remove_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00151">lookup_c_ip()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06236"></a>06236 {
<a name="l06237"></a>06237    <span class="keywordflow">if</span> (!ip)
<a name="l06238"></a>06238       <span class="keywordflow">return</span> con ? con-&gt;<a class="code" href="structast__context.html#79a69e07731e7d02c0f52f19bab94dcb">ignorepats</a> : NULL;
<a name="l06239"></a>06239    <span class="keywordflow">else</span>
<a name="l06240"></a>06240       <span class="keywordflow">return</span> ip-&gt;<a class="code" href="structast__ignorepat.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l06241"></a>06241 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ff52371424397442d32568beb910e153"></a><!-- doxytag: member="pbx.c::ast_walk_context_includes" ref="ff52371424397442d32568beb910e153" args="(struct ast_context *con, struct ast_include *inc)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__include.html">ast_include</a>* ast_walk_context_includes           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__include.html">ast_include</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>inc</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06225">6225</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00169">ast_context::includes</a>, and <a class="el" href="pbx_8c-source.html#l00142">ast_include::next</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l06243">ast_context_verify_includes()</a>, <a class="el" href="pbx__config_8c-source.html#l00211">complete_context_remove_include()</a>, <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>, <a class="el" href="pbx__config_8c-source.html#l00137">lookup_ci()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06227"></a>06227 {
<a name="l06228"></a>06228    <span class="keywordflow">if</span> (!inc)
<a name="l06229"></a>06229       <span class="keywordflow">return</span> con ? con-&gt;<a class="code" href="structast__context.html#bb2b21ef7774df8687ff02b0284505c6">includes</a> : NULL;
<a name="l06230"></a>06230    <span class="keywordflow">else</span>
<a name="l06231"></a>06231       <span class="keywordflow">return</span> inc-&gt;<a class="code" href="structast__include.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l06232"></a>06232 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6cbdae284c7bcff5b16d687a1f60b61b"></a><!-- doxytag: member="pbx.c::ast_walk_context_switches" ref="6cbdae284c7bcff5b16d687a1f60b61b" args="(struct ast_context *con, struct ast_sw *sw)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__sw.html">ast_sw</a>* ast_walk_context_switches           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__sw.html">ast_sw</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>sw</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06210">6210</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00385">AST_LIST_FIRST</a>, and <a class="el" href="linkedlists_8h-source.html#l00403">AST_LIST_NEXT</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06212"></a>06212 {
<a name="l06213"></a>06213    <span class="keywordflow">if</span> (!sw)
<a name="l06214"></a>06214       <span class="keywordflow">return</span> con ? <a class="code" href="linkedlists_8h.html#e4deb7f32ef480cbc3b2e9b7e4ceff6c">AST_LIST_FIRST</a>(&amp;con-&gt;alts) : NULL;
<a name="l06215"></a>06215    <span class="keywordflow">else</span>
<a name="l06216"></a>06216       <span class="keywordflow">return</span> <a class="code" href="linkedlists_8h.html#ab7d30c78fda9982ddc59f746adf8a69">AST_LIST_NEXT</a>(sw, list);
<a name="l06217"></a>06217 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="709c9b64f2da1eaace237db32a5e1445"></a><!-- doxytag: member="pbx.c::ast_walk_contexts" ref="709c9b64f2da1eaace237db32a5e1445" args="(struct ast_context *con)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a>* ast_walk_contexts           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>con</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06196">6196</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00489">contexts</a>, and <a class="el" href="pbx_8c-source.html#l00168">ast_context::next</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l00889">ast_context_find()</a>, <a class="el" href="pbx_8c-source.html#l02823">ast_context_lockmacro()</a>, <a class="el" href="pbx_8c-source.html#l02851">ast_context_unlockmacro()</a>, <a class="el" href="pbx__config_8c-source.html#l01033">complete_context_add_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01104">complete_context_add_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00619">complete_context_add_include()</a>, <a class="el" href="pbx__config_8c-source.html#l00449">complete_context_remove_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01187">complete_context_remove_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00211">complete_context_remove_include()</a>, <a class="el" href="pbx_8c-source.html#l03275">complete_show_dialplan_context()</a>, <a class="el" href="pbx__dundi_8c-source.html#l03615">dundi_precache_full()</a>, <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>, <a class="el" href="app__while_8c-source.html#l00123">find_matching_endwhile()</a>, <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01596">pbx_load_module()</a>, <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03830">unreference_cached_app()</a>.<div class="fragment"><pre class="fragment"><a name="l06197"></a>06197 {
<a name="l06198"></a>06198    <span class="keywordflow">return</span> con ? con-&gt;<a class="code" href="structast__context.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> : <a class="code" href="pbx_8c.html#9be90dc64c1f5b5c993ff11d732a8da0">contexts</a>;
<a name="l06199"></a>06199 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2ae60ad33dfd510584655331ac42b890"></a><!-- doxytag: member="pbx.c::ast_walk_extension_priorities" ref="2ae60ad33dfd510584655331ac42b890" args="(struct ast_exten *exten, struct ast_exten *priority)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a>* ast_walk_extension_priorities           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06219">6219</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00129">ast_exten::peer</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l00449">complete_context_remove_extension()</a>, <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>, <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03830">unreference_cached_app()</a>.<div class="fragment"><pre class="fragment"><a name="l06221"></a>06221 {
<a name="l06222"></a>06222    <span class="keywordflow">return</span> priority ? priority-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a> : exten;
<a name="l06223"></a>06223 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="18884df37a7c36a24fd0b5f4225d1112"></a><!-- doxytag: member="pbx.c::ast_wrlock_context" ref="18884df37a7c36a24fd0b5f4225d1112" args="(struct ast_context *con)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_wrlock_context           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>con</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Write locks a given context. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>con</em>&nbsp;</td><td>context to lock</td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06082">6082</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="lock_8h-source.html#l00652">ast_rwlock_wrlock()</a>, and <a class="el" href="pbx_8c-source.html#l00166">ast_context::lock</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l05285">__ast_context_destroy()</a>, <a class="el" href="pbx_8c-source.html#l04765">ast_add_extension2()</a>, <a class="el" href="pbx_8c-source.html#l04509">ast_context_add_ignorepat2()</a>, <a class="el" href="pbx_8c-source.html#l04304">ast_context_add_include2()</a>, <a class="el" href="pbx_8c-source.html#l04386">ast_context_add_switch2()</a>, <a class="el" href="pbx_8c-source.html#l02746">ast_context_remove_extension2()</a>, <a class="el" href="pbx_8c-source.html#l04466">ast_context_remove_ignorepat2()</a>, <a class="el" href="pbx_8c-source.html#l02640">ast_context_remove_include2()</a>, and <a class="el" href="pbx_8c-source.html#l02694">ast_context_remove_switch2()</a>.<div class="fragment"><pre class="fragment"><a name="l06083"></a>06083 {
<a name="l06084"></a>06084    <span class="keywordflow">return</span> <a class="code" href="lock_8h.html#25d2e851f878ee9a64d36b67b67ede6e">ast_rwlock_wrlock</a>(&amp;con-&gt;<a class="code" href="structast__context.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l06085"></a>06085 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6f41efd0c2fa84486ef11fef33681139"></a><!-- doxytag: member="pbx.c::ast_wrlock_contexts" ref="6f41efd0c2fa84486ef11fef33681139" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_wrlock_contexts           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Write locks the context list. 
<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on error </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06064">6064</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="lock_8h-source.html#l00652">ast_rwlock_wrlock()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03870">__ast_context_create()</a>, <a class="el" href="pbx_8c-source.html#l05344">ast_context_destroy()</a>, <a class="el" href="pbx_8c-source.html#l03936">ast_merge_contexts_and_delete()</a>, and <a class="el" href="pbx__config_8c-source.html#l00211">complete_context_remove_include()</a>.<div class="fragment"><pre class="fragment"><a name="l06065"></a>06065 {
<a name="l06066"></a>06066    <span class="keywordflow">return</span> <a class="code" href="lock_8h.html#25d2e851f878ee9a64d36b67b67ede6e">ast_rwlock_wrlock</a>(&amp;conlock);
<a name="l06067"></a>06067 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="23af98d69a15a8250c44aaea18d487af"></a><!-- doxytag: member="pbx.c::async_wait" ref="23af98d69a15a8250c44aaea18d487af" args="(void *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void* async_wait           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>data</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04903">4903</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00435">ast_channel::_state</a>, <a class="el" href="pbx_8c-source.html#l04899">async_stat::app</a>, <a class="el" href="pbx_8c-source.html#l04900">async_stat::appdata</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3898c0ff5febeb7ff9d8880e2bc7f1d6ca1">AST_CONTROL_BUSY</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389fafe5e503d0d74218854b57e66282419">AST_CONTROL_CONGESTION</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a>, <a class="el" href="frame_8h-source.html#l00396">ast_frfree()</a>, <a class="el" href="channel_8c-source.html#l01598">ast_hangup()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="pbx_8c-source.html#l02572">ast_pbx_run()</a>, <a class="el" href="channel_8c-source.html#l02438">ast_read()</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="channel_8c-source.html#l01952">ast_waitfor()</a>, <a class="el" href="pbx_8c-source.html#l04894">async_stat::chan</a>, <a class="el" href="channel_8h-source.html#l00441">ast_channel::context</a>, <a class="el" href="pbx_8c-source.html#l04895">async_stat::context</a>, <a class="el" href="channel_8h-source.html#l00442">ast_channel::exten</a>, <a class="el" href="pbx_8c-source.html#l04896">async_stat::exten</a>, <a class="el" href="frame_8h-source.html#l00131">ast_frame::frametype</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="pbx_8c-source.html#l00509">pbx_exec()</a>, <a class="el" href="pbx_8c-source.html#l00547">pbx_findapp()</a>, <a class="el" href="channel_8h-source.html#l00443">ast_channel::priority</a>, <a class="el" href="pbx_8c-source.html#l04897">async_stat::priority</a>, <a class="el" href="frame_8h-source.html#l00133">ast_frame::subclass</a>, <a class="el" href="pbx_8c-source.html#l04898">async_stat::timeout</a>, and <a class="el" href="logger_8h-source.html#l00045">VERBOSE_PREFIX_3</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l05150">ast_pbx_outgoing_app()</a>, and <a class="el" href="pbx_8c-source.html#l04991">ast_pbx_outgoing_exten()</a>.<div class="fragment"><pre class="fragment"><a name="l04904"></a>04904 {
<a name="l04905"></a>04905    <span class="keyword">struct </span><a class="code" href="structasync__stat.html">async_stat</a> *as = data;
<a name="l04906"></a>04906    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a> = as-&gt;<a class="code" href="structasync__stat.html#26c322652770620e64ac90682eb6504c">chan</a>;
<a name="l04907"></a>04907    <span class="keywordtype">int</span> timeout = as-&gt;<a class="code" href="structasync__stat.html#90272dda245ae1fb3cf197e91a8689dc">timeout</a>;
<a name="l04908"></a>04908    <span class="keywordtype">int</span> res;
<a name="l04909"></a>04909    <span class="keyword">struct </span><a class="code" href="structast__frame.html">ast_frame</a> *<a class="code" href="format__g726_8c.html#85b9b17a7dd34a3638c560bc9152473b">f</a>;
<a name="l04910"></a>04910    <span class="keyword">struct </span><a class="code" href="structast__app.html">ast_app</a> *<a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>;
<a name="l04911"></a>04911 
<a name="l04912"></a>04912    <span class="keywordflow">while</span> (timeout &amp;&amp; (chan-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a> != <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>)) {
<a name="l04913"></a>04913       res = <a class="code" href="channel_8c.html#e02dcdf40023f275d4561a930e7a7fc9">ast_waitfor</a>(chan, timeout);
<a name="l04914"></a>04914       <span class="keywordflow">if</span> (res &lt; 1)
<a name="l04915"></a>04915          <span class="keywordflow">break</span>;
<a name="l04916"></a>04916       <span class="keywordflow">if</span> (timeout &gt; -1)
<a name="l04917"></a>04917          timeout = res;
<a name="l04918"></a>04918       f = <a class="code" href="channel_8c.html#1446a8c0bddf626bf26b000fbeae117f">ast_read</a>(chan);
<a name="l04919"></a>04919       <span class="keywordflow">if</span> (!f)
<a name="l04920"></a>04920          <span class="keywordflow">break</span>;
<a name="l04921"></a>04921       <span class="keywordflow">if</span> (f-&gt;<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a> == <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a>) {
<a name="l04922"></a>04922          <span class="keywordflow">if</span> ((f-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> == <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3898c0ff5febeb7ff9d8880e2bc7f1d6ca1">AST_CONTROL_BUSY</a>)  ||
<a name="l04923"></a>04923              (f-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> == <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389fafe5e503d0d74218854b57e66282419">AST_CONTROL_CONGESTION</a>) ) {
<a name="l04924"></a>04924             <a class="code" href="frame_8h.html#506c759ec4950e7f7465e8f090a6252b">ast_frfree</a>(f);
<a name="l04925"></a>04925             <span class="keywordflow">break</span>;
<a name="l04926"></a>04926          }
<a name="l04927"></a>04927       }
<a name="l04928"></a>04928       <a class="code" href="frame_8h.html#506c759ec4950e7f7465e8f090a6252b">ast_frfree</a>(f);
<a name="l04929"></a>04929    }
<a name="l04930"></a>04930    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a> == <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>) {
<a name="l04931"></a>04931       <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(as-&gt;<a class="code" href="structasync__stat.html#d3fa2274939949eea1a37de844eecea0">app</a>)) {
<a name="l04932"></a>04932          app = <a class="code" href="pbx_8c.html#d407cf204ec8fc50e5a578c8c17e0cb5">pbx_findapp</a>(as-&gt;<a class="code" href="structasync__stat.html#d3fa2274939949eea1a37de844eecea0">app</a>);
<a name="l04933"></a>04933          <span class="keywordflow">if</span> (app) {
<a name="l04934"></a>04934             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 2)
<a name="l04935"></a>04935                <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#aefd5a67b7464040f5352e4ecdc535ca">VERBOSE_PREFIX_3</a> <span class="stringliteral">"Launching %s(%s) on %s\n"</span>, as-&gt;<a class="code" href="structasync__stat.html#d3fa2274939949eea1a37de844eecea0">app</a>, as-&gt;<a class="code" href="structasync__stat.html#ffa091f1a08de73baae354df77b07668">appdata</a>, chan-&gt;name);
<a name="l04936"></a>04936             <a class="code" href="pbx_8c.html#5970fbcb6a776848d11bf1c8ddb1c948">pbx_exec</a>(chan, app, as-&gt;<a class="code" href="structasync__stat.html#ffa091f1a08de73baae354df77b07668">appdata</a>);
<a name="l04937"></a>04937          } <span class="keywordflow">else</span>
<a name="l04938"></a>04938             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"No such application '%s'\n"</span>, as-&gt;<a class="code" href="structasync__stat.html#d3fa2274939949eea1a37de844eecea0">app</a>);
<a name="l04939"></a>04939       } <span class="keywordflow">else</span> {
<a name="l04940"></a>04940          <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(as-&gt;<a class="code" href="structasync__stat.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>))
<a name="l04941"></a>04941             ast_copy_string(chan-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, as-&gt;<a class="code" href="structasync__stat.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <span class="keyword">sizeof</span>(chan-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>));
<a name="l04942"></a>04942          <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(as-&gt;<a class="code" href="structasync__stat.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>))
<a name="l04943"></a>04943             ast_copy_string(chan-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, as-&gt;<a class="code" href="structasync__stat.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <span class="keyword">sizeof</span>(chan-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>));
<a name="l04944"></a>04944          <span class="keywordflow">if</span> (as-&gt;<a class="code" href="structasync__stat.html#b988295c268025b49dfb3df26171ddc3">priority</a> &gt; 0)
<a name="l04945"></a>04945             chan-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a> = as-&gt;<a class="code" href="structasync__stat.html#b988295c268025b49dfb3df26171ddc3">priority</a>;
<a name="l04946"></a>04946          <span class="comment">/* Run the PBX */</span>
<a name="l04947"></a>04947          <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#235c18a381a9501a4dc41b06b080c24f">ast_pbx_run</a>(chan)) {
<a name="l04948"></a>04948             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Failed to start PBX on %s\n"</span>, chan-&gt;name);
<a name="l04949"></a>04949          } <span class="keywordflow">else</span> {
<a name="l04950"></a>04950             <span class="comment">/* PBX will have taken care of this */</span>
<a name="l04951"></a>04951             chan = NULL;
<a name="l04952"></a>04952          }
<a name="l04953"></a>04953       }
<a name="l04954"></a>04954    }
<a name="l04955"></a>04955    <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(as);
<a name="l04956"></a>04956    <span class="keywordflow">if</span> (chan)
<a name="l04957"></a>04957       <a class="code" href="channel_8c.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a>(chan);
<a name="l04958"></a>04958    <span class="keywordflow">return</span> NULL;
<a name="l04959"></a>04959 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="56ac9c8dffe6fb673e5c26f2b706777b"></a><!-- doxytag: member="pbx.c::collect_digits" ref="56ac9c8dffe6fb673e5c26f2b706777b" args="(struct ast_channel *c, int waittime, char *buf, int buflen, int pos)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int collect_digits           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>waittime</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>buflen</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pos</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
collect digits from the channel into the buffer, return -1 on error, 0 on timeout or done. 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02224">2224</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00414">ast_channel::_softhangup</a>, <a class="el" href="pbx_8c-source.html#l02203">ast_matchmore_extension()</a>, <a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a179c1afce6cda266617f47d63393c2d71">AST_SOFTHANGUP_ASYNCGOTO</a>, <a class="el" href="channel_8c-source.html#l01963">ast_waitfordigit()</a>, <a class="el" href="channel_8h-source.html#l00437">ast_channel::cid</a>, <a class="el" href="channel_8h-source.html#l00212">ast_callerid::cid_num</a>, <a class="el" href="channel_8h-source.html#l00441">ast_channel::context</a>, <a class="el" href="pbx_8h-source.html#l00110">ast_pbx::dtimeout</a>, and <a class="el" href="channel_8h-source.html#l00449">ast_channel::pbx</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>.<div class="fragment"><pre class="fragment"><a name="l02225"></a>02225 {
<a name="l02226"></a>02226    <span class="keywordtype">int</span> digit;
<a name="l02227"></a>02227 
<a name="l02228"></a>02228    <a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>[pos] = <span class="charliteral">'\0'</span>;  <span class="comment">/* make sure it is properly terminated */</span>
<a name="l02229"></a>02229    <span class="keywordflow">while</span> (<a class="code" href="pbx_8c.html#6e9c6f3a112b82510968f729fa3765bc">ast_matchmore_extension</a>(c, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>, 1, c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>)) {
<a name="l02230"></a>02230       <span class="comment">/* As long as we're willing to wait, and as long as it's not defined,</span>
<a name="l02231"></a>02231 <span class="comment">         keep reading digits until we can't possibly get a right answer anymore.  */</span>
<a name="l02232"></a>02232       digit = <a class="code" href="channel_8c.html#b02063e7425e3cfb63ba24edf8081835">ast_waitfordigit</a>(c, waittime * 1000);
<a name="l02233"></a>02233       <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> == <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a179c1afce6cda266617f47d63393c2d71">AST_SOFTHANGUP_ASYNCGOTO</a>) {
<a name="l02234"></a>02234          c-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> = 0;
<a name="l02235"></a>02235       } <span class="keywordflow">else</span> {
<a name="l02236"></a>02236          <span class="keywordflow">if</span> (!digit) <span class="comment">/* No entry */</span>
<a name="l02237"></a>02237             <span class="keywordflow">break</span>;
<a name="l02238"></a>02238          <span class="keywordflow">if</span> (digit &lt; 0) <span class="comment">/* Error, maybe a  hangup */</span>
<a name="l02239"></a>02239             <span class="keywordflow">return</span> -1;
<a name="l02240"></a>02240          <span class="keywordflow">if</span> (pos &lt; buflen - 1) { <span class="comment">/* XXX maybe error otherwise ? */</span>
<a name="l02241"></a>02241             <a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>[pos++] = digit;
<a name="l02242"></a>02242             <a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>[pos] = <span class="charliteral">'\0'</span>;
<a name="l02243"></a>02243          }
<a name="l02244"></a>02244          waittime = c-&gt;<a class="code" href="structast__channel.html#569f7a090087f9e7071a247a24ea0809">pbx</a>-&gt;<a class="code" href="structast__pbx.html#5559d18605837885d883b6aa738283f4">dtimeout</a>;
<a name="l02245"></a>02245       }
<a name="l02246"></a>02246    }
<a name="l02247"></a>02247    <span class="keywordflow">return</span> 0;
<a name="l02248"></a>02248 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="54f047831976b704c2fe17e388f6e79e"></a><!-- doxytag: member="pbx.c::complete_show_application" ref="54f047831976b704c2fe17e388f6e79e" args="(const char *line, const char *word, int pos, int state)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* complete_show_application           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>line</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>word</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pos</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>state</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03001">3001</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00060">AST_RWLIST_RDLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, and <a class="el" href="astmm_8h-source.html#l00075">strdup</a>.<div class="fragment"><pre class="fragment"><a name="l03002"></a>03002 {
<a name="l03003"></a>03003    <span class="keyword">struct </span><a class="code" href="structast__app.html">ast_app</a> *a;
<a name="l03004"></a>03004    <span class="keywordtype">char</span> *ret = NULL;
<a name="l03005"></a>03005    <span class="keywordtype">int</span> which = 0;
<a name="l03006"></a>03006    <span class="keywordtype">int</span> wordlen = strlen(word);
<a name="l03007"></a>03007 
<a name="l03008"></a>03008    <span class="comment">/* return the n-th [partial] matching entry */</span>
<a name="l03009"></a>03009    <a class="code" href="linkedlists_8h.html#23c0c844e5abcb474854867b408e3be8">AST_RWLIST_RDLOCK</a>(&amp;apps);
<a name="l03010"></a>03010    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;apps, a, list) {
<a name="l03011"></a>03011       <span class="keywordflow">if</span> (!strncasecmp(word, a-&gt;name, wordlen) &amp;&amp; ++which &gt; <a class="code" href="structstate.html">state</a>) {
<a name="l03012"></a>03012          ret = <a class="code" href="astmm_8h.html#17881997a89ddffd239268f0476567d0">strdup</a>(a-&gt;name);
<a name="l03013"></a>03013          <span class="keywordflow">break</span>;
<a name="l03014"></a>03014       }
<a name="l03015"></a>03015    }
<a name="l03016"></a>03016    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;apps);
<a name="l03017"></a>03017 
<a name="l03018"></a>03018    <span class="keywordflow">return</span> ret;
<a name="l03019"></a>03019 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4a465aef0f262af46a537ff2d1966732"></a><!-- doxytag: member="pbx.c::complete_show_applications" ref="4a465aef0f262af46a537ff2d1966732" args="(const char *line, const char *word, int pos, int state)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* complete_show_applications           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>line</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>word</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pos</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>state</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03265">3265</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l00861">ast_cli_complete()</a>.<div class="fragment"><pre class="fragment"><a name="l03266"></a>03266 {
<a name="l03267"></a>03267    <span class="keyword">static</span> <span class="keywordtype">char</span>* choices[] = { <span class="stringliteral">"like"</span>, <span class="stringliteral">"describing"</span>, NULL };
<a name="l03268"></a>03268 
<a name="l03269"></a>03269    <span class="keywordflow">return</span> (pos != 3) ? NULL : <a class="code" href="cli_8c.html#ff4b12b0f87714d5e22fdc54065104ac">ast_cli_complete</a>(word, choices, <a class="code" href="structstate.html">state</a>);
<a name="l03270"></a>03270 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6c63ff167234692e52eaa6d19856317c"></a><!-- doxytag: member="pbx.c::complete_show_dialplan_context" ref="6c63ff167234692e52eaa6d19856317c" args="(const char *line, const char *word, int pos, int state)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* complete_show_dialplan_context           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>line</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>word</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pos</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>state</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03275">3275</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06100">ast_get_context_name()</a>, <a class="el" href="pbx_8c-source.html#l06069">ast_rdlock_contexts()</a>, <a class="el" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l06196">ast_walk_contexts()</a>.<div class="fragment"><pre class="fragment"><a name="l03277"></a>03277 {
<a name="l03278"></a>03278    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = NULL;
<a name="l03279"></a>03279    <span class="keywordtype">char</span> *ret = NULL;
<a name="l03280"></a>03280    <span class="keywordtype">int</span> which = 0;
<a name="l03281"></a>03281    <span class="keywordtype">int</span> wordlen;
<a name="l03282"></a>03282 
<a name="l03283"></a>03283    <span class="comment">/* we are do completion of [exten@]context on second position only */</span>
<a name="l03284"></a>03284    <span class="keywordflow">if</span> (pos != 2)
<a name="l03285"></a>03285       <span class="keywordflow">return</span> NULL;
<a name="l03286"></a>03286 
<a name="l03287"></a>03287    <a class="code" href="pbx_8c.html#1b60f4b570102084989c86fd02ca6536">ast_rdlock_contexts</a>();
<a name="l03288"></a>03288 
<a name="l03289"></a>03289    wordlen = strlen(word);
<a name="l03290"></a>03290 
<a name="l03291"></a>03291    <span class="comment">/* walk through all contexts and return the n-th match */</span>
<a name="l03292"></a>03292    <span class="keywordflow">while</span> ( (c = <a class="code" href="pbx_8c.html#709c9b64f2da1eaace237db32a5e1445">ast_walk_contexts</a>(c)) ) {
<a name="l03293"></a>03293       <span class="keywordflow">if</span> (!strncasecmp(word, <a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(c), wordlen) &amp;&amp; ++which &gt; <a class="code" href="structstate.html">state</a>) {
<a name="l03294"></a>03294          ret = <a class="code" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>(<a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(c));
<a name="l03295"></a>03295          <span class="keywordflow">break</span>;
<a name="l03296"></a>03296       }
<a name="l03297"></a>03297    }
<a name="l03298"></a>03298 
<a name="l03299"></a>03299    <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l03300"></a>03300 
<a name="l03301"></a>03301    <span class="keywordflow">return</span> ret;
<a name="l03302"></a>03302 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="06132b1a307c8696f30585c776f764f5"></a><!-- doxytag: member="pbx.c::complete_show_function" ref="06132b1a307c8696f30585c776f764f5" args="(const char *line, const char *word, int pos, int state)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* complete_show_function           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>line</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>word</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pos</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>state</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01325">1325</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00060">AST_RWLIST_RDLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="pbx_8h-source.html#l00073">ast_custom_function::name</a>, and <a class="el" href="astmm_8h-source.html#l00075">strdup</a>.<div class="fragment"><pre class="fragment"><a name="l01326"></a>01326 {
<a name="l01327"></a>01327    <span class="keyword">struct </span><a class="code" href="structast__custom__function.html">ast_custom_function</a> *acf;
<a name="l01328"></a>01328    <span class="keywordtype">char</span> *ret = NULL;
<a name="l01329"></a>01329    <span class="keywordtype">int</span> which = 0;
<a name="l01330"></a>01330    <span class="keywordtype">int</span> wordlen = strlen(word);
<a name="l01331"></a>01331 
<a name="l01332"></a>01332    <span class="comment">/* case-insensitive for convenience in this 'complete' function */</span>
<a name="l01333"></a>01333    <a class="code" href="linkedlists_8h.html#23c0c844e5abcb474854867b408e3be8">AST_RWLIST_RDLOCK</a>(&amp;acf_root);
<a name="l01334"></a>01334    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;acf_root, acf, acflist) {
<a name="l01335"></a>01335       <span class="keywordflow">if</span> (!strncasecmp(word, acf-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>, wordlen) &amp;&amp; ++which &gt; <a class="code" href="structstate.html">state</a>) {
<a name="l01336"></a>01336          ret = <a class="code" href="astmm_8h.html#17881997a89ddffd239268f0476567d0">strdup</a>(acf-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l01337"></a>01337          <span class="keywordflow">break</span>;
<a name="l01338"></a>01338       }
<a name="l01339"></a>01339    }
<a name="l01340"></a>01340    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;acf_root);
<a name="l01341"></a>01341 
<a name="l01342"></a>01342    <span class="keywordflow">return</span> ret;
<a name="l01343"></a>01343 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2cf1332e5b45c96d7508015a47e21b84"></a><!-- doxytag: member="pbx.c::decrease_call_count" ref="2cf1332e5b45c96d7508015a47e21b84" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void decrease_call_count           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02513">2513</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="lock_8h-source.html#l00530">ast_mutex_lock()</a>, <a class="el" href="lock_8h-source.html#l00520">ast_mutex_unlock()</a>, and <a class="el" href="pbx_8c-source.html#l00252">countcalls</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02572">ast_pbx_run()</a>, and <a class="el" href="pbx_8c-source.html#l02531">pbx_thread()</a>.<div class="fragment"><pre class="fragment"><a name="l02514"></a>02514 {
<a name="l02515"></a>02515    <a class="code" href="lock_8h.html#b3c5e3093b325167f88db93c8b4b2421">ast_mutex_lock</a>(&amp;maxcalllock);
<a name="l02516"></a>02516    <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#a3a9f90f51c55c02ddf6ad8e26249341">countcalls</a> &gt; 0)
<a name="l02517"></a>02517       <a class="code" href="pbx_8c.html#a3a9f90f51c55c02ddf6ad8e26249341">countcalls</a>--;
<a name="l02518"></a>02518    <a class="code" href="lock_8h.html#1d33e3caf152f0901c5ebdb69c2d4d26">ast_mutex_unlock</a>(&amp;maxcalllock);
<a name="l02519"></a>02519 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c7a22bae87915c24108c7304264b78c8"></a><!-- doxytag: member="pbx.c::destroy_exten" ref="c7a22bae87915c24108c7304264b78c8" args="(struct ast_exten *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void destroy_exten           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02521">2521</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l02131">ast_remove_hint()</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="pbx_8c-source.html#l00122">ast_exten::priority</a>, and <a class="el" href="pbx_8h-source.html#l00044">PRIORITY_HINT</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l05285">__ast_context_destroy()</a>, and <a class="el" href="pbx_8c-source.html#l02746">ast_context_remove_extension2()</a>.<div class="fragment"><pre class="fragment"><a name="l02522"></a>02522 {
<a name="l02523"></a>02523    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a> == <a class="code" href="pbx_8h.html#ab1e94ec9073ecc8bcedd7b11dd82001">PRIORITY_HINT</a>)
<a name="l02524"></a>02524       <a class="code" href="pbx_8c.html#1b7cfd3851ae1fbfaf60fef51c4756f2">ast_remove_hint</a>(e);
<a name="l02525"></a>02525 
<a name="l02526"></a>02526    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__exten.html#7c342dda03b7a7df3e7dc1603c4916d1">datad</a>)
<a name="l02527"></a>02527       e-&gt;<a class="code" href="structast__exten.html#7c342dda03b7a7df3e7dc1603c4916d1">datad</a>(e-&gt;<a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l02528"></a>02528    <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(e);
<a name="l02529"></a>02529 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="fa125f786a7a85619f88c85292d5412f"></a><!-- doxytag: member="pbx.c::ext_cmp" ref="fa125f786a7a85619f88c85292d5412f" args="(const char *a, const char *b)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int ext_cmp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>b</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
the full routine to compare extensions in rules. 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00716">716</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00644">ext_cmp1()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04765">ast_add_extension2()</a>.<div class="fragment"><pre class="fragment"><a name="l00717"></a>00717 {
<a name="l00718"></a>00718    <span class="comment">/* make sure non-patterns come first.</span>
<a name="l00719"></a>00719 <span class="comment">    * If a is not a pattern, it either comes first or</span>
<a name="l00720"></a>00720 <span class="comment">    * we use strcmp to compare the strings.</span>
<a name="l00721"></a>00721 <span class="comment">    */</span>
<a name="l00722"></a>00722    <span class="keywordtype">int</span> ret = 0;
<a name="l00723"></a>00723 
<a name="l00724"></a>00724    <span class="keywordflow">if</span> (a[0] != <span class="charliteral">'_'</span>)
<a name="l00725"></a>00725       <span class="keywordflow">return</span> (b[0] == <span class="charliteral">'_'</span>) ? -1 : strcmp(a, b);
<a name="l00726"></a>00726 
<a name="l00727"></a>00727    <span class="comment">/* Now we know a is a pattern; if b is not, a comes first */</span>
<a name="l00728"></a>00728    <span class="keywordflow">if</span> (b[0] != <span class="charliteral">'_'</span>)
<a name="l00729"></a>00729       <span class="keywordflow">return</span> 1;
<a name="l00730"></a>00730 <span class="preprocessor">#if 0 </span><span class="comment">/* old mode for ext matching */</span>
<a name="l00731"></a>00731    <span class="keywordflow">return</span> strcmp(a, b);
<a name="l00732"></a>00732 <span class="preprocessor">#endif</span>
<a name="l00733"></a>00733 <span class="preprocessor"></span>   <span class="comment">/* ok we need full pattern sorting routine */</span>
<a name="l00734"></a>00734    <span class="keywordflow">while</span> (!ret &amp;&amp; a &amp;&amp; b)
<a name="l00735"></a>00735       ret = <a class="code" href="pbx_8c.html#48c405f7522d6b169f7e80c09f2acdb5">ext_cmp1</a>(&amp;a) - <a class="code" href="pbx_8c.html#48c405f7522d6b169f7e80c09f2acdb5">ext_cmp1</a>(&amp;b);
<a name="l00736"></a>00736    <span class="keywordflow">if</span> (ret == 0)
<a name="l00737"></a>00737       <span class="keywordflow">return</span> 0;
<a name="l00738"></a>00738    <span class="keywordflow">else</span>
<a name="l00739"></a>00739       <span class="keywordflow">return</span> (ret &gt; 0) ? 1 : -1;
<a name="l00740"></a>00740 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="48c405f7522d6b169f7e80c09f2acdb5"></a><!-- doxytag: member="pbx.c::ext_cmp1" ref="48c405f7522d6b169f7e80c09f2acdb5" args="(const char **p)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int ext_cmp1           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char **&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>p</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
helper functions to sort extensions and patterns in the desired way, so that more specific patterns appear first. 
<p>
ext_cmp1 compares individual characters (or sets of), returning an int where bits 0-7 are the ASCII code of the first char in the set, while bit 8-15 are the cardinality of the set minus 1. This way more specific patterns (smaller cardinality) appear first. Wildcards have a special value, so that we can directly compare them to sets by subtracting the two values. In particular: 0x000xx one character, xx 0x0yyxx yy character set starting with xx 0x10000 '.' (one or more of anything) 0x20000 '!' (zero or more of anything) 0x30000 NUL (end of string) 0x40000 error in set. The pointer to the string is advanced according to needs. NOTES: 1. the empty set is equivalent to NUL. 2. given that a full set has always 0 as the first element, we could encode the special cases as 0xffXX where XX is 1, 2, 3, 4 as used above. 
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00644">644</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, and <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l00716">ext_cmp()</a>.<div class="fragment"><pre class="fragment"><a name="l00645"></a>00645 {
<a name="l00646"></a>00646    uint32_t chars[8];
<a name="l00647"></a>00647    <span class="keywordtype">int</span> c, cmin = 0xff, count = 0;
<a name="l00648"></a>00648    <span class="keyword">const</span> <span class="keywordtype">char</span> *end;
<a name="l00649"></a>00649 
<a name="l00650"></a>00650    <span class="comment">/* load, sign extend and advance pointer until we find</span>
<a name="l00651"></a>00651 <span class="comment">    * a valid character.</span>
<a name="l00652"></a>00652 <span class="comment">    */</span>
<a name="l00653"></a>00653    <span class="keywordflow">while</span> ( (c = *(*p)++) &amp;&amp; (c == <span class="charliteral">' '</span> || c == <span class="charliteral">'-'</span>) )
<a name="l00654"></a>00654       ;  <span class="comment">/* ignore some characters */</span>
<a name="l00655"></a>00655 
<a name="l00656"></a>00656    <span class="comment">/* always return unless we have a set of chars */</span>
<a name="l00657"></a>00657    <span class="keywordflow">switch</span> (c) {
<a name="l00658"></a>00658    <span class="keywordflow">default</span>: <span class="comment">/* ordinary character */</span>
<a name="l00659"></a>00659       <span class="keywordflow">return</span> 0x0000 | (c &amp; 0xff);
<a name="l00660"></a>00660 
<a name="l00661"></a>00661    <span class="keywordflow">case</span> <span class="charliteral">'N'</span>:   <span class="comment">/* 2..9 */</span>
<a name="l00662"></a>00662       <span class="keywordflow">return</span> 0x0700 | <span class="charliteral">'2'</span> ;
<a name="l00663"></a>00663 
<a name="l00664"></a>00664    <span class="keywordflow">case</span> <span class="charliteral">'X'</span>:   <span class="comment">/* 0..9 */</span>
<a name="l00665"></a>00665       <span class="keywordflow">return</span> 0x0900 | <span class="charliteral">'0'</span>;
<a name="l00666"></a>00666 
<a name="l00667"></a>00667    <span class="keywordflow">case</span> <span class="charliteral">'Z'</span>:   <span class="comment">/* 1..9 */</span>
<a name="l00668"></a>00668       <span class="keywordflow">return</span> 0x0800 | <span class="charliteral">'1'</span>;
<a name="l00669"></a>00669 
<a name="l00670"></a>00670    <span class="keywordflow">case</span> <span class="charliteral">'.'</span>:   <span class="comment">/* wildcard */</span>
<a name="l00671"></a>00671       <span class="keywordflow">return</span> 0x10000;
<a name="l00672"></a>00672 
<a name="l00673"></a>00673    <span class="keywordflow">case</span> <span class="charliteral">'!'</span>:   <span class="comment">/* earlymatch */</span>
<a name="l00674"></a>00674       <span class="keywordflow">return</span> 0x20000;   <span class="comment">/* less specific than NULL */</span>
<a name="l00675"></a>00675 
<a name="l00676"></a>00676    <span class="keywordflow">case</span> <span class="charliteral">'\0'</span>:  <span class="comment">/* empty string */</span>
<a name="l00677"></a>00677       *p = NULL;
<a name="l00678"></a>00678       <span class="keywordflow">return</span> 0x30000;
<a name="l00679"></a>00679 
<a name="l00680"></a>00680    <span class="keywordflow">case</span> <span class="charliteral">'['</span>:   <span class="comment">/* pattern */</span>
<a name="l00681"></a>00681       <span class="keywordflow">break</span>;
<a name="l00682"></a>00682    }
<a name="l00683"></a>00683    <span class="comment">/* locate end of set */</span>
<a name="l00684"></a>00684    end = strchr(*p, <span class="charliteral">']'</span>);  
<a name="l00685"></a>00685 
<a name="l00686"></a>00686    <span class="keywordflow">if</span> (end == NULL) {
<a name="l00687"></a>00687       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Wrong usage of [] in the extension\n"</span>);
<a name="l00688"></a>00688       <span class="keywordflow">return</span> 0x40000;   <span class="comment">/* XXX make this entry go last... */</span>
<a name="l00689"></a>00689    }
<a name="l00690"></a>00690 
<a name="l00691"></a>00691    bzero(chars, <span class="keyword">sizeof</span>(chars));  <span class="comment">/* clear all chars in the set */</span>
<a name="l00692"></a>00692    <span class="keywordflow">for</span> (; *p &lt; end  ; (*p)++) {
<a name="l00693"></a>00693       <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> c1, c2;   <span class="comment">/* first-last char in range */</span>
<a name="l00694"></a>00694       c1 = (<span class="keywordtype">unsigned</span> char)((*p)[0]);
<a name="l00695"></a>00695       <span class="keywordflow">if</span> (*p + 2 &lt; end &amp;&amp; (*p)[1] == <span class="charliteral">'-'</span>) { <span class="comment">/* this is a range */</span>
<a name="l00696"></a>00696          c2 = (<span class="keywordtype">unsigned</span> char)((*p)[2]);
<a name="l00697"></a>00697          *p += 2; <span class="comment">/* skip a total of 3 chars */</span>
<a name="l00698"></a>00698       } <span class="keywordflow">else</span>         <span class="comment">/* individual character */</span>
<a name="l00699"></a>00699          c2 = c1;
<a name="l00700"></a>00700       <span class="keywordflow">if</span> (c1 &lt; cmin)
<a name="l00701"></a>00701          cmin = c1;
<a name="l00702"></a>00702       <span class="keywordflow">for</span> (; c1 &lt;= c2; c1++) {
<a name="l00703"></a>00703          uint32_t mask = 1 &lt;&lt; (c1 % 32);
<a name="l00704"></a>00704          <span class="keywordflow">if</span> ( (chars[ c1 / 32 ] &amp; mask) == 0)
<a name="l00705"></a>00705             count += 0x100;
<a name="l00706"></a>00706          chars[ c1 / 32 ] |= mask;
<a name="l00707"></a>00707       }
<a name="l00708"></a>00708    }
<a name="l00709"></a>00709    (*p)++;
<a name="l00710"></a>00710    <span class="keywordflow">return</span> count == 0 ? 0x30000 : (count | cmin);
<a name="l00711"></a>00711 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="34cd75f9b635d6fb74649e8e456dcef9"></a><!-- doxytag: member="pbx.c::ext_strncpy" ref="34cd75f9b635d6fb74649e8e456dcef9" args="(char *dst, const char *src, int len)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int ext_strncpy           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>dst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
copy a string skipping whitespace 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04655">4655</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04765">ast_add_extension2()</a>.<div class="fragment"><pre class="fragment"><a name="l04656"></a>04656 {
<a name="l04657"></a>04657    <span class="keywordtype">int</span> count=0;
<a name="l04658"></a>04658 
<a name="l04659"></a>04659    <span class="keywordflow">while</span> (*src &amp;&amp; (count &lt; <a class="code" href="utils_8h.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a> - 1)) {
<a name="l04660"></a>04660       <span class="keywordflow">switch</span> (*src) {
<a name="l04661"></a>04661       <span class="keywordflow">case</span> <span class="charliteral">' '</span>:
<a name="l04662"></a>04662          <span class="comment">/* otherwise exten =&gt; [a-b],1,... doesn't work */</span>
<a name="l04663"></a>04663          <span class="comment">/*    case '-': */</span>
<a name="l04664"></a>04664          <span class="comment">/* Ignore */</span>
<a name="l04665"></a>04665          <span class="keywordflow">break</span>;
<a name="l04666"></a>04666       <span class="keywordflow">default</span>:
<a name="l04667"></a>04667          *dst = *src;
<a name="l04668"></a>04668          dst++;
<a name="l04669"></a>04669       }
<a name="l04670"></a>04670       src++;
<a name="l04671"></a>04671       count++;
<a name="l04672"></a>04672    }
<a name="l04673"></a>04673    *dst = <span class="charliteral">'\0'</span>;
<a name="l04674"></a>04674 
<a name="l04675"></a>04675    <span class="keywordflow">return</span> count;
<a name="l04676"></a>04676 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="489ae231aa1cc1031dcfd0adc1cc4600"></a><!-- doxytag: member="pbx.c::extension_match_core" ref="489ae231aa1cc1031dcfd0adc1cc4600" args="(const char *pattern, const char *data, enum ext_match_t mode)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int extension_match_core           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>pattern</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>enum <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe">ext_match_t</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>mode</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00865">865</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00766">_extension_match_core()</a>, <a class="el" href="asterisk_8c-source.html#l00465">ast_add_profile()</a>, and <a class="el" href="asterisk_8c-source.html#l00527">ast_mark()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l00882">ast_extension_close()</a>, <a class="el" href="pbx_8c-source.html#l00877">ast_extension_match()</a>, and <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>.<div class="fragment"><pre class="fragment"><a name="l00866"></a>00866 {
<a name="l00867"></a>00867    <span class="keywordtype">int</span> i;
<a name="l00868"></a>00868    <span class="keyword">static</span> <span class="keywordtype">int</span> prof_id = -2;   <span class="comment">/* marker for 'unallocated' id */</span>
<a name="l00869"></a>00869    <span class="keywordflow">if</span> (prof_id == -2)
<a name="l00870"></a>00870       prof_id = <a class="code" href="asterisk_8c.html#ee200af0b46d69592f0df14e7652e8b0">ast_add_profile</a>(<span class="stringliteral">"ext_match"</span>, 0);
<a name="l00871"></a>00871    <a class="code" href="asterisk_8c.html#fe3990908e16ffa4ec9e929bb02fad2c">ast_mark</a>(prof_id, 1);
<a name="l00872"></a>00872    i = <a class="code" href="pbx_8c.html#db697281f06d30c766c4af8b5bf48199">_extension_match_core</a>(pattern, data, mode);
<a name="l00873"></a>00873    <a class="code" href="asterisk_8c.html#fe3990908e16ffa4ec9e929bb02fad2c">ast_mark</a>(prof_id, 0);
<a name="l00874"></a>00874    <span class="keywordflow">return</span> i;
<a name="l00875"></a>00875 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4669bd753e060c6bb15a0c63c4e3785a"></a><!-- doxytag: member="pbx.c::find_context_locked" ref="4669bd753e060c6bb15a0c63c4e3785a" args="(const char *context)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static struct <a class="el" href="structast__context.html">ast_context</a>* find_context_locked           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>context</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02600">2600</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06100">ast_get_context_name()</a>, <a class="el" href="pbx_8c-source.html#l06069">ast_rdlock_contexts()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l06196">ast_walk_contexts()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04561">ast_add_extension()</a>, <a class="el" href="pbx_8c-source.html#l04497">ast_context_add_ignorepat()</a>, <a class="el" href="pbx_8c-source.html#l04042">ast_context_add_include()</a>, <a class="el" href="pbx_8c-source.html#l04367">ast_context_add_switch()</a>, <a class="el" href="pbx_8c-source.html#l02724">ast_context_remove_extension()</a>, <a class="el" href="pbx_8c-source.html#l04454">ast_context_remove_ignorepat()</a>, <a class="el" href="pbx_8c-source.html#l02619">ast_context_remove_include()</a>, and <a class="el" href="pbx_8c-source.html#l02673">ast_context_remove_switch()</a>.<div class="fragment"><pre class="fragment"><a name="l02601"></a>02601 {
<a name="l02602"></a>02602    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = NULL;
<a name="l02603"></a>02603 
<a name="l02604"></a>02604    <a class="code" href="pbx_8c.html#1b60f4b570102084989c86fd02ca6536">ast_rdlock_contexts</a>();
<a name="l02605"></a>02605    <span class="keywordflow">while</span> ( (c = <a class="code" href="pbx_8c.html#709c9b64f2da1eaace237db32a5e1445">ast_walk_contexts</a>(c)) ) {
<a name="l02606"></a>02606       <span class="keywordflow">if</span> (!strcmp(<a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(c), <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>))
<a name="l02607"></a>02607          <span class="keywordflow">return</span> c;
<a name="l02608"></a>02608    }
<a name="l02609"></a>02609    <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l02610"></a>02610 
<a name="l02611"></a>02611    <span class="keywordflow">return</span> NULL;
<a name="l02612"></a>02612 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3d2c812ce63291930182ea8c9edb17b8"></a><!-- doxytag: member="pbx.c::func_args" ref="3d2c812ce63291930182ea8c9edb17b8" args="(char *function)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* func_args           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>function</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
return a pointer to the arguments of the function, and terminates the function name with '\0' 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01420">1420</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, and <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l01437">ast_func_read()</a>, and <a class="el" href="pbx_8c-source.html#l01452">ast_func_write()</a>.<div class="fragment"><pre class="fragment"><a name="l01421"></a>01421 {
<a name="l01422"></a>01422    <span class="keywordtype">char</span> *args = strchr(function, <span class="charliteral">'('</span>);
<a name="l01423"></a>01423 
<a name="l01424"></a>01424    <span class="keywordflow">if</span> (!args)
<a name="l01425"></a>01425       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Function doesn't contain parentheses.  Assuming null argument.\n"</span>);
<a name="l01426"></a>01426    <span class="keywordflow">else</span> {
<a name="l01427"></a>01427       <span class="keywordtype">char</span> *p;
<a name="l01428"></a>01428       *args++ = <span class="charliteral">'\0'</span>;
<a name="l01429"></a>01429       <span class="keywordflow">if</span> ((p = strrchr(args, <span class="charliteral">')'</span>)) )
<a name="l01430"></a>01430          *p = <span class="charliteral">'\0'</span>;
<a name="l01431"></a>01431       <span class="keywordflow">else</span>
<a name="l01432"></a>01432          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Can't find trailing parenthesis?\n"</span>);
<a name="l01433"></a>01433    }
<a name="l01434"></a>01434    <span class="keywordflow">return</span> args;
<a name="l01435"></a>01435 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1d96b045db44a1d8881f22cd211d4099"></a><!-- doxytag: member="pbx.c::get_range" ref="1d96b045db44a1d8881f22cd211d4099" args="(char *src, int max, char *const names[], const char *msg)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static unsigned get_range           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>max</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *const &nbsp;</td>
          <td class="mdname" nowrap> <em>names</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
helper function to return a range up to max (7, 12, 31 respectively). names, if supplied, is an array of names that should be mapped to numbers. 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04076">4076</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="pbx_8c-source.html#l04058">lookup_name()</a>, and <a class="el" href="aesopt_8h-source.html#l00399">s</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04236">ast_build_timing()</a>.<div class="fragment"><pre class="fragment"><a name="l04077"></a>04077 {
<a name="l04078"></a>04078    <span class="keywordtype">int</span> <a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>, e; <span class="comment">/* start and ending position */</span>
<a name="l04079"></a>04079    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mask = 0;
<a name="l04080"></a>04080 
<a name="l04081"></a>04081    <span class="comment">/* Check for whole range */</span>
<a name="l04082"></a>04082    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(src) || !strcmp(src, <span class="stringliteral">"*"</span>)) {
<a name="l04083"></a>04083       s = 0;
<a name="l04084"></a>04084       e = max - 1;
<a name="l04085"></a>04085    } <span class="keywordflow">else</span> {
<a name="l04086"></a>04086       <span class="comment">/* Get start and ending position */</span>
<a name="l04087"></a>04087       <span class="keywordtype">char</span> *c = strchr(src, <span class="charliteral">'-'</span>);
<a name="l04088"></a>04088       <span class="keywordflow">if</span> (c)
<a name="l04089"></a>04089          *c++ = <span class="charliteral">'\0'</span>;
<a name="l04090"></a>04090       <span class="comment">/* Find the start */</span>
<a name="l04091"></a>04091       s = <a class="code" href="pbx_8c.html#37c96c5787cdf4375b2e683139ce9a87">lookup_name</a>(src, names, max);
<a name="l04092"></a>04092       <span class="keywordflow">if</span> (!s) {
<a name="l04093"></a>04093          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Invalid %s '%s', assuming none\n"</span>, <a class="code" href="adsistub_8c.html#6e2baaf3b97dbeef01c0043275f9a0e7">msg</a>, src);
<a name="l04094"></a>04094          <span class="keywordflow">return</span> 0;
<a name="l04095"></a>04095       }
<a name="l04096"></a>04096       s--;
<a name="l04097"></a>04097       <span class="keywordflow">if</span> (c) { <span class="comment">/* find end of range */</span>
<a name="l04098"></a>04098          e = <a class="code" href="pbx_8c.html#37c96c5787cdf4375b2e683139ce9a87">lookup_name</a>(c, names, max);
<a name="l04099"></a>04099          <span class="keywordflow">if</span> (!e) {
<a name="l04100"></a>04100             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Invalid end %s '%s', assuming none\n"</span>, <a class="code" href="adsistub_8c.html#6e2baaf3b97dbeef01c0043275f9a0e7">msg</a>, c);
<a name="l04101"></a>04101             <span class="keywordflow">return</span> 0;
<a name="l04102"></a>04102          }
<a name="l04103"></a>04103          e--;
<a name="l04104"></a>04104       } <span class="keywordflow">else</span>
<a name="l04105"></a>04105          e = s;
<a name="l04106"></a>04106    }
<a name="l04107"></a>04107    <span class="comment">/* Fill the mask. Remember that ranges are cyclic */</span>
<a name="l04108"></a>04108    mask = 1 &lt;&lt; e; <span class="comment">/* initialize with last element */</span>
<a name="l04109"></a>04109    <span class="keywordflow">while</span> (s != e) {
<a name="l04110"></a>04110       <span class="keywordflow">if</span> (s &gt;= max) {
<a name="l04111"></a>04111          s = 0;
<a name="l04112"></a>04112          mask |= (1 &lt;&lt; s);
<a name="l04113"></a>04113       } <span class="keywordflow">else</span> {
<a name="l04114"></a>04114          mask |= (1 &lt;&lt; s);
<a name="l04115"></a>04115          s++;
<a name="l04116"></a>04116       }
<a name="l04117"></a>04117    }
<a name="l04118"></a>04118    <span class="keywordflow">return</span> mask;
<a name="l04119"></a>04119 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="997d3ca719932cc6dbf54c26337a0b3c"></a><!-- doxytag: member="pbx.c::get_timerange" ref="997d3ca719932cc6dbf54c26337a0b3c" args="(struct ast_timing *i, char *times)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void get_timerange           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__timing.html">ast_timing</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>times</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
store a bitmask of valid times, one bit each 2 minute 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04122">4122</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, and <a class="el" href="pbx_8h-source.html#l00103">ast_timing::minmask</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04236">ast_build_timing()</a>.<div class="fragment"><pre class="fragment"><a name="l04123"></a>04123 {
<a name="l04124"></a>04124    <span class="keywordtype">char</span> *e;
<a name="l04125"></a>04125    <span class="keywordtype">int</span> x;
<a name="l04126"></a>04126    <span class="keywordtype">int</span> s1, s2;
<a name="l04127"></a>04127    <span class="keywordtype">int</span> e1, e2;
<a name="l04128"></a>04128    <span class="comment">/* int cth, ctm; */</span>
<a name="l04129"></a>04129 
<a name="l04130"></a>04130    <span class="comment">/* start disabling all times, fill the fields with 0's, as they may contain garbage */</span>
<a name="l04131"></a>04131    memset(i-&gt;<a class="code" href="structast__timing.html#abad86ac50409185e19bcfa94e974d51">minmask</a>, 0, <span class="keyword">sizeof</span>(i-&gt;<a class="code" href="structast__timing.html#abad86ac50409185e19bcfa94e974d51">minmask</a>));
<a name="l04132"></a>04132 
<a name="l04133"></a>04133    <span class="comment">/* 2-minutes per bit, since the mask has only 32 bits :( */</span>
<a name="l04134"></a>04134    <span class="comment">/* Star is all times */</span>
<a name="l04135"></a>04135    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(times) || !strcmp(times, <span class="stringliteral">"*"</span>)) {
<a name="l04136"></a>04136       <span class="keywordflow">for</span> (x=0; x&lt;24; x++)
<a name="l04137"></a>04137          i-&gt;<a class="code" href="structast__timing.html#abad86ac50409185e19bcfa94e974d51">minmask</a>[x] = 0x3fffffff; <span class="comment">/* 30 bits */</span>
<a name="l04138"></a>04138       <span class="keywordflow">return</span>;
<a name="l04139"></a>04139    }
<a name="l04140"></a>04140    <span class="comment">/* Otherwise expect a range */</span>
<a name="l04141"></a>04141    e = strchr(times, <span class="charliteral">'-'</span>);
<a name="l04142"></a>04142    <span class="keywordflow">if</span> (!e) {
<a name="l04143"></a>04143       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Time range is not valid. Assuming no restrictions based on time.\n"</span>);
<a name="l04144"></a>04144       <span class="keywordflow">return</span>;
<a name="l04145"></a>04145    }
<a name="l04146"></a>04146    *e++ = <span class="charliteral">'\0'</span>;
<a name="l04147"></a>04147    <span class="comment">/* XXX why skip non digits ? */</span>
<a name="l04148"></a>04148    <span class="keywordflow">while</span> (*e &amp;&amp; !isdigit(*e))
<a name="l04149"></a>04149       e++;
<a name="l04150"></a>04150    <span class="keywordflow">if</span> (!*e) {
<a name="l04151"></a>04151       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Invalid time range.  Assuming no restrictions based on time.\n"</span>);
<a name="l04152"></a>04152       <span class="keywordflow">return</span>;
<a name="l04153"></a>04153    }
<a name="l04154"></a>04154    <span class="keywordflow">if</span> (sscanf(times, <span class="stringliteral">"%d:%d"</span>, &amp;s1, &amp;s2) != 2) {
<a name="l04155"></a>04155       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"%s isn't a time.  Assuming no restrictions based on time.\n"</span>, times);
<a name="l04156"></a>04156       <span class="keywordflow">return</span>;
<a name="l04157"></a>04157    }
<a name="l04158"></a>04158    <span class="keywordflow">if</span> (sscanf(e, <span class="stringliteral">"%d:%d"</span>, &amp;e1, &amp;e2) != 2) {
<a name="l04159"></a>04159       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"%s isn't a time.  Assuming no restrictions based on time.\n"</span>, e);
<a name="l04160"></a>04160       <span class="keywordflow">return</span>;
<a name="l04161"></a>04161    }
<a name="l04162"></a>04162    <span class="comment">/* XXX this needs to be optimized */</span>
<a name="l04163"></a>04163 <span class="preprocessor">#if 1</span>
<a name="l04164"></a>04164 <span class="preprocessor"></span>   s1 = s1 * 30 + s2/2;
<a name="l04165"></a>04165    <span class="keywordflow">if</span> ((s1 &lt; 0) || (s1 &gt;= 24*30)) {
<a name="l04166"></a>04166       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"%s isn't a valid start time. Assuming no time.\n"</span>, times);
<a name="l04167"></a>04167       <span class="keywordflow">return</span>;
<a name="l04168"></a>04168    }
<a name="l04169"></a>04169    e1 = e1 * 30 + e2/2;
<a name="l04170"></a>04170    <span class="keywordflow">if</span> ((e1 &lt; 0) || (e1 &gt;= 24*30)) {
<a name="l04171"></a>04171       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"%s isn't a valid end time. Assuming no time.\n"</span>, e);
<a name="l04172"></a>04172       <span class="keywordflow">return</span>;
<a name="l04173"></a>04173    }
<a name="l04174"></a>04174    <span class="comment">/* Go through the time and enable each appropriate bit */</span>
<a name="l04175"></a>04175    <span class="keywordflow">for</span> (x=s1;x != e1;x = (x + 1) % (24 * 30)) {
<a name="l04176"></a>04176       i-&gt;<a class="code" href="structast__timing.html#abad86ac50409185e19bcfa94e974d51">minmask</a>[x/30] |= (1 &lt;&lt; (x % 30));
<a name="l04177"></a>04177    }
<a name="l04178"></a>04178    <span class="comment">/* Do the last one */</span>
<a name="l04179"></a>04179    i-&gt;<a class="code" href="structast__timing.html#abad86ac50409185e19bcfa94e974d51">minmask</a>[x/30] |= (1 &lt;&lt; (x % 30));
<a name="l04180"></a>04180 <span class="preprocessor">#else</span>
<a name="l04181"></a>04181 <span class="preprocessor"></span>   <span class="keywordflow">for</span> (cth=0; cth&lt;24; cth++) {
<a name="l04182"></a>04182       <span class="comment">/* Initialize masks to blank */</span>
<a name="l04183"></a>04183       i-&gt;<a class="code" href="structast__timing.html#abad86ac50409185e19bcfa94e974d51">minmask</a>[cth] = 0;
<a name="l04184"></a>04184       <span class="keywordflow">for</span> (ctm=0; ctm&lt;30; ctm++) {
<a name="l04185"></a>04185          <span class="keywordflow">if</span> (
<a name="l04186"></a>04186          <span class="comment">/* First hour with more than one hour */</span>
<a name="l04187"></a>04187                (((cth == s1) &amp;&amp; (ctm &gt;= s2)) &amp;&amp;
<a name="l04188"></a>04188                 ((cth &lt; e1)))
<a name="l04189"></a>04189          <span class="comment">/* Only one hour */</span>
<a name="l04190"></a>04190          ||    (((cth == s1) &amp;&amp; (ctm &gt;= s2)) &amp;&amp;
<a name="l04191"></a>04191                 ((cth == e1) &amp;&amp; (ctm &lt;= e2)))
<a name="l04192"></a>04192          <span class="comment">/* In between first and last hours (more than 2 hours) */</span>
<a name="l04193"></a>04193          ||    ((cth &gt; s1) &amp;&amp;
<a name="l04194"></a>04194                 (cth &lt; e1))
<a name="l04195"></a>04195          <span class="comment">/* Last hour with more than one hour */</span>
<a name="l04196"></a>04196          ||    ((cth &gt; s1) &amp;&amp;
<a name="l04197"></a>04197                 ((cth == e1) &amp;&amp; (ctm &lt;= e2)))
<a name="l04198"></a>04198          )
<a name="l04199"></a>04199             i-&gt;<a class="code" href="structast__timing.html#abad86ac50409185e19bcfa94e974d51">minmask</a>[cth] |= (1 &lt;&lt; (ctm / 2));
<a name="l04200"></a>04200       }
<a name="l04201"></a>04201    }
<a name="l04202"></a>04202 #endif
<a name="l04203"></a>04203    <span class="comment">/* All done */</span>
<a name="l04204"></a>04204    <span class="keywordflow">return</span>;
<a name="l04205"></a>04205 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="5272725c34363168c9deab9dd6640200"></a><!-- doxytag: member="pbx.c::handle_set_global" ref="5272725c34363168c9deab9dd6640200" args="(int fd, int argc, char *argv[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int handle_set_global           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03770">3770</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="pbx_8c-source.html#l05821">pbx_builtin_setvar_helper()</a>, <a class="el" href="cli_8h-source.html#l00038">RESULT_SHOWUSAGE</a>, and <a class="el" href="cli_8h-source.html#l00037">RESULT_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l03771"></a>03771 {
<a name="l03772"></a>03772    <span class="keywordflow">if</span> (argc != 5)
<a name="l03773"></a>03773       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d7f3bcd35c16172e6fc0964a175fcadb">RESULT_SHOWUSAGE</a>;
<a name="l03774"></a>03774 
<a name="l03775"></a>03775    <a class="code" href="pbx_8c.html#64407c916a2de6ae3f0efeca471c1b1d">pbx_builtin_setvar_helper</a>(NULL, argv[3], argv[4]);
<a name="l03776"></a>03776    <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"\n    -- Global variable %s set to %s\n"</span>, argv[3], argv[4]);
<a name="l03777"></a>03777 
<a name="l03778"></a>03778    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l03779"></a>03779 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6f8de0cd01e797a4fb1d35fe54b4d76e"></a><!-- doxytag: member="pbx.c::handle_show_application" ref="6f8de0cd01e797a4fb1d35fe54b4d76e" args="(int fd, int argc, char *argv[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int handle_show_application           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03021">3021</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="pbx_8h-source.html#l00034">AST_MAX_APP</a>, <a class="el" href="linkedlists_8h-source.html#l00060">AST_RWLIST_RDLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="term_8h-source.html#l00051">COLOR_CYAN</a>, <a class="el" href="term_8h-source.html#l00049">COLOR_MAGENTA</a>, <a class="el" href="pbx_8c-source.html#l00182">ast_app::description</a>, <a class="el" href="callerid_8c-source.html#l01044">description</a>, <a class="el" href="cli_8h-source.html#l00039">RESULT_FAILURE</a>, <a class="el" href="cli_8h-source.html#l00038">RESULT_SHOWUSAGE</a>, <a class="el" href="cli_8h-source.html#l00037">RESULT_SUCCESS</a>, <a class="el" href="pbx_8c-source.html#l00181">ast_app::synopsis</a>, <a class="el" href="chan__agent_8c-source.html#l00082">synopsis</a>, and <a class="el" href="term_8c-source.html#l00150">term_color()</a>.<div class="fragment"><pre class="fragment"><a name="l03022"></a>03022 {
<a name="l03023"></a>03023    <span class="keyword">struct </span><a class="code" href="structast__app.html">ast_app</a> *a;
<a name="l03024"></a>03024    <span class="keywordtype">int</span> <a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>, no_registered_app = 1;
<a name="l03025"></a>03025 
<a name="l03026"></a>03026    <span class="keywordflow">if</span> (argc &lt; 4)
<a name="l03027"></a>03027       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d7f3bcd35c16172e6fc0964a175fcadb">RESULT_SHOWUSAGE</a>;
<a name="l03028"></a>03028 
<a name="l03029"></a>03029    <span class="comment">/* ... go through all applications ... */</span>
<a name="l03030"></a>03030    <a class="code" href="linkedlists_8h.html#23c0c844e5abcb474854867b408e3be8">AST_RWLIST_RDLOCK</a>(&amp;apps);
<a name="l03031"></a>03031    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;apps, a, list) {
<a name="l03032"></a>03032       <span class="comment">/* ... compare this application name with all arguments given</span>
<a name="l03033"></a>03033 <span class="comment">       * to 'show application' command ... */</span>
<a name="l03034"></a>03034       <span class="keywordflow">for</span> (app = 3; app &lt; argc; app++) {
<a name="l03035"></a>03035          <span class="keywordflow">if</span> (!strcasecmp(a-&gt;name, argv[app])) {
<a name="l03036"></a>03036             <span class="comment">/* Maximum number of characters added by terminal coloring is 22 */</span>
<a name="l03037"></a>03037             <span class="keywordtype">char</span> infotitle[64 + <a class="code" href="pbx_8h.html#a973a2fecfe2da6df7aaf2d5be3ea548">AST_MAX_APP</a> + 22], syntitle[40], destitle[40];
<a name="l03038"></a>03038             <span class="keywordtype">char</span> info[64 + <a class="code" href="pbx_8h.html#a973a2fecfe2da6df7aaf2d5be3ea548">AST_MAX_APP</a>], *<a class="code" href="chan__agent_8c.html#485d112e4e425dde393e2e7091451856">synopsis</a> = NULL, *<a class="code" href="callerid_8c.html#67daf92c833c41c95db874e18fcb2786">description</a> = NULL;
<a name="l03039"></a>03039             <span class="keywordtype">int</span> synopsis_size, description_size;
<a name="l03040"></a>03040 
<a name="l03041"></a>03041             no_registered_app = 0;
<a name="l03042"></a>03042 
<a name="l03043"></a>03043             <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__app.html#512fbb4e7b617c04031f58b631f2b05d">synopsis</a>)
<a name="l03044"></a>03044                synopsis_size = strlen(a-&gt;<a class="code" href="structast__app.html#512fbb4e7b617c04031f58b631f2b05d">synopsis</a>) + 23;
<a name="l03045"></a>03045             <span class="keywordflow">else</span>
<a name="l03046"></a>03046                synopsis_size = strlen(<span class="stringliteral">"Not available"</span>) + 23;
<a name="l03047"></a>03047             synopsis = alloca(synopsis_size);
<a name="l03048"></a>03048 
<a name="l03049"></a>03049             <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__app.html#67daf92c833c41c95db874e18fcb2786">description</a>)
<a name="l03050"></a>03050                description_size = strlen(a-&gt;<a class="code" href="structast__app.html#67daf92c833c41c95db874e18fcb2786">description</a>) + 23;
<a name="l03051"></a>03051             <span class="keywordflow">else</span>
<a name="l03052"></a>03052                description_size = strlen(<span class="stringliteral">"Not available"</span>) + 23;
<a name="l03053"></a>03053             description = alloca(description_size);
<a name="l03054"></a>03054 
<a name="l03055"></a>03055             <span class="keywordflow">if</span> (synopsis &amp;&amp; description) {
<a name="l03056"></a>03056                snprintf(info, 64 + <a class="code" href="pbx_8h.html#a973a2fecfe2da6df7aaf2d5be3ea548">AST_MAX_APP</a>, <span class="stringliteral">"\n  -= Info about application '%s' =- \n\n"</span>, a-&gt;name);
<a name="l03057"></a>03057                <a class="code" href="term_8c.html#e93d6667c9a6823fef4ab75cd64c90ca">term_color</a>(infotitle, info, <a class="code" href="term_8h.html#9b6e4fad9007204f76df6cd6e1ce1bf4">COLOR_MAGENTA</a>, 0, 64 + <a class="code" href="pbx_8h.html#a973a2fecfe2da6df7aaf2d5be3ea548">AST_MAX_APP</a> + 22);
<a name="l03058"></a>03058                <a class="code" href="term_8c.html#e93d6667c9a6823fef4ab75cd64c90ca">term_color</a>(syntitle, <span class="stringliteral">"[Synopsis]\n"</span>, <a class="code" href="term_8h.html#9b6e4fad9007204f76df6cd6e1ce1bf4">COLOR_MAGENTA</a>, 0, 40);
<a name="l03059"></a>03059                <a class="code" href="term_8c.html#e93d6667c9a6823fef4ab75cd64c90ca">term_color</a>(destitle, <span class="stringliteral">"[Description]\n"</span>, <a class="code" href="term_8h.html#9b6e4fad9007204f76df6cd6e1ce1bf4">COLOR_MAGENTA</a>, 0, 40);
<a name="l03060"></a>03060                <a class="code" href="term_8c.html#e93d6667c9a6823fef4ab75cd64c90ca">term_color</a>(synopsis,
<a name="l03061"></a>03061                            a-&gt;<a class="code" href="structast__app.html#512fbb4e7b617c04031f58b631f2b05d">synopsis</a> ? a-&gt;<a class="code" href="structast__app.html#512fbb4e7b617c04031f58b631f2b05d">synopsis</a> : <span class="stringliteral">"Not available"</span>,
<a name="l03062"></a>03062                            <a class="code" href="term_8h.html#0b7173c34af1ee5517a3db2a4446c39a">COLOR_CYAN</a>, 0, synopsis_size);
<a name="l03063"></a>03063                <a class="code" href="term_8c.html#e93d6667c9a6823fef4ab75cd64c90ca">term_color</a>(description,
<a name="l03064"></a>03064                            a-&gt;<a class="code" href="structast__app.html#67daf92c833c41c95db874e18fcb2786">description</a> ? a-&gt;<a class="code" href="structast__app.html#67daf92c833c41c95db874e18fcb2786">description</a> : <span class="stringliteral">"Not available"</span>,
<a name="l03065"></a>03065                            <a class="code" href="term_8h.html#0b7173c34af1ee5517a3db2a4446c39a">COLOR_CYAN</a>, 0, description_size);
<a name="l03066"></a>03066 
<a name="l03067"></a>03067                <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd,<span class="stringliteral">"%s%s%s\n\n%s%s\n"</span>, infotitle, syntitle, synopsis, destitle, description);
<a name="l03068"></a>03068             } <span class="keywordflow">else</span> {
<a name="l03069"></a>03069                <span class="comment">/* ... one of our applications, show info ...*/</span>
<a name="l03070"></a>03070                <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd,<span class="stringliteral">"\n  -= Info about application '%s' =- \n\n"</span>
<a name="l03071"></a>03071                   <span class="stringliteral">"[Synopsis]\n  %s\n\n"</span>
<a name="l03072"></a>03072                   <span class="stringliteral">"[Description]\n%s\n"</span>,
<a name="l03073"></a>03073                   a-&gt;name,
<a name="l03074"></a>03074                   a-&gt;<a class="code" href="structast__app.html#512fbb4e7b617c04031f58b631f2b05d">synopsis</a> ? a-&gt;<a class="code" href="structast__app.html#512fbb4e7b617c04031f58b631f2b05d">synopsis</a> : <span class="stringliteral">"Not available"</span>,
<a name="l03075"></a>03075                   a-&gt;<a class="code" href="structast__app.html#67daf92c833c41c95db874e18fcb2786">description</a> ? a-&gt;<a class="code" href="structast__app.html#67daf92c833c41c95db874e18fcb2786">description</a> : <span class="stringliteral">"Not available"</span>);
<a name="l03076"></a>03076             }
<a name="l03077"></a>03077          }
<a name="l03078"></a>03078       }
<a name="l03079"></a>03079    }
<a name="l03080"></a>03080    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;apps);
<a name="l03081"></a>03081 
<a name="l03082"></a>03082    <span class="comment">/* we found at least one app? no? */</span>
<a name="l03083"></a>03083    <span class="keywordflow">if</span> (no_registered_app) {
<a name="l03084"></a>03084       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"Your application(s) is (are) not registered\n"</span>);
<a name="l03085"></a>03085       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#029ade91f74f40adbbae98503f72e91b">RESULT_FAILURE</a>;
<a name="l03086"></a>03086    }
<a name="l03087"></a>03087 
<a name="l03088"></a>03088    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l03089"></a>03089 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6a58cc0389a0a88bf6b4d1507cbe43ee"></a><!-- doxytag: member="pbx.c::handle_show_applications" ref="6a58cc0389a0a88bf6b4d1507cbe43ee" args="(int fd, int argc, char *argv[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int handle_show_applications           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03196">3196</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="linkedlists_8h-source.html#l00415">AST_RWLIST_EMPTY</a>, <a class="el" href="linkedlists_8h-source.html#l00060">AST_RWLIST_RDLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="pbx_8c-source.html#l00182">ast_app::description</a>, <a class="el" href="cli_8h-source.html#l00037">RESULT_SUCCESS</a>, <a class="el" href="strcompat_8c-source.html#l00101">strcasestr()</a>, and <a class="el" href="pbx_8c-source.html#l00181">ast_app::synopsis</a>.<div class="fragment"><pre class="fragment"><a name="l03197"></a>03197 {
<a name="l03198"></a>03198    <span class="keyword">struct </span><a class="code" href="structast__app.html">ast_app</a> *a;
<a name="l03199"></a>03199    <span class="keywordtype">int</span> like = 0, describing = 0;
<a name="l03200"></a>03200    <span class="keywordtype">int</span> total_match = 0;    <span class="comment">/* Number of matches in like clause */</span>
<a name="l03201"></a>03201    <span class="keywordtype">int</span> total_apps = 0;  <span class="comment">/* Number of apps registered */</span>
<a name="l03202"></a>03202 
<a name="l03203"></a>03203    <a class="code" href="linkedlists_8h.html#23c0c844e5abcb474854867b408e3be8">AST_RWLIST_RDLOCK</a>(&amp;apps);
<a name="l03204"></a>03204 
<a name="l03205"></a>03205    <span class="keywordflow">if</span> (<a class="code" href="linkedlists_8h.html#020b0bebdc89708ef3af28762efc67d6">AST_RWLIST_EMPTY</a>(&amp;apps)) {
<a name="l03206"></a>03206       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"There are no registered applications\n"</span>);
<a name="l03207"></a>03207       <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;apps);
<a name="l03208"></a>03208       <span class="keywordflow">return</span> -1;
<a name="l03209"></a>03209    }
<a name="l03210"></a>03210 
<a name="l03211"></a>03211    <span class="comment">/* core list applications like &lt;keyword&gt; */</span>
<a name="l03212"></a>03212    <span class="keywordflow">if</span> ((argc == 5) &amp;&amp; (!strcmp(argv[3], <span class="stringliteral">"like"</span>))) {
<a name="l03213"></a>03213       like = 1;
<a name="l03214"></a>03214    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((argc &gt; 4) &amp;&amp; (!strcmp(argv[3], <span class="stringliteral">"describing"</span>))) {
<a name="l03215"></a>03215       describing = 1;
<a name="l03216"></a>03216    }
<a name="l03217"></a>03217 
<a name="l03218"></a>03218    <span class="comment">/* core list applications describing &lt;keyword1&gt; [&lt;keyword2&gt;] [...] */</span>
<a name="l03219"></a>03219    <span class="keywordflow">if</span> ((!like) &amp;&amp; (!describing)) {
<a name="l03220"></a>03220       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"    -= Registered Asterisk Applications =-\n"</span>);
<a name="l03221"></a>03221    } <span class="keywordflow">else</span> {
<a name="l03222"></a>03222       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"    -= Matching Asterisk Applications =-\n"</span>);
<a name="l03223"></a>03223    }
<a name="l03224"></a>03224 
<a name="l03225"></a>03225    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;apps, a, list) {
<a name="l03226"></a>03226       <span class="keywordtype">int</span> printapp = 0;
<a name="l03227"></a>03227       total_apps++;
<a name="l03228"></a>03228       <span class="keywordflow">if</span> (like) {
<a name="l03229"></a>03229          <span class="keywordflow">if</span> (<a class="code" href="strcompat_8c.html#4a77b3b09866eecb70e963be481fe425">strcasestr</a>(a-&gt;name, argv[4])) {
<a name="l03230"></a>03230             printapp = 1;
<a name="l03231"></a>03231             total_match++;
<a name="l03232"></a>03232          }
<a name="l03233"></a>03233       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (describing) {
<a name="l03234"></a>03234          <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structast__app.html#67daf92c833c41c95db874e18fcb2786">description</a>) {
<a name="l03235"></a>03235             <span class="comment">/* Match all words on command line */</span>
<a name="l03236"></a>03236             <span class="keywordtype">int</span> i;
<a name="l03237"></a>03237             printapp = 1;
<a name="l03238"></a>03238             <span class="keywordflow">for</span> (i = 4; i &lt; argc; i++) {
<a name="l03239"></a>03239                <span class="keywordflow">if</span> (!<a class="code" href="strcompat_8c.html#4a77b3b09866eecb70e963be481fe425">strcasestr</a>(a-&gt;<a class="code" href="structast__app.html#67daf92c833c41c95db874e18fcb2786">description</a>, argv[i])) {
<a name="l03240"></a>03240                   printapp = 0;
<a name="l03241"></a>03241                } <span class="keywordflow">else</span> {
<a name="l03242"></a>03242                   total_match++;
<a name="l03243"></a>03243                }
<a name="l03244"></a>03244             }
<a name="l03245"></a>03245          }
<a name="l03246"></a>03246       } <span class="keywordflow">else</span> {
<a name="l03247"></a>03247          printapp = 1;
<a name="l03248"></a>03248       }
<a name="l03249"></a>03249 
<a name="l03250"></a>03250       <span class="keywordflow">if</span> (printapp) {
<a name="l03251"></a>03251          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd,<span class="stringliteral">"  %20s: %s\n"</span>, a-&gt;name, a-&gt;<a class="code" href="structast__app.html#512fbb4e7b617c04031f58b631f2b05d">synopsis</a> ? a-&gt;<a class="code" href="structast__app.html#512fbb4e7b617c04031f58b631f2b05d">synopsis</a> : <span class="stringliteral">"&lt;Synopsis not available&gt;"</span>);
<a name="l03252"></a>03252       }
<a name="l03253"></a>03253    }
<a name="l03254"></a>03254    <span class="keywordflow">if</span> ((!like) &amp;&amp; (!describing)) {
<a name="l03255"></a>03255       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"    -= %d Applications Registered =-\n"</span>,total_apps);
<a name="l03256"></a>03256    } <span class="keywordflow">else</span> {
<a name="l03257"></a>03257       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"    -= %d Applications Matching =-\n"</span>,total_match);
<a name="l03258"></a>03258    }
<a name="l03259"></a>03259 
<a name="l03260"></a>03260    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;apps);
<a name="l03261"></a>03261 
<a name="l03262"></a>03262    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l03263"></a>03263 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="bdad08d2759df1713bf4c15b39be4893"></a><!-- doxytag: member="pbx.c::handle_show_dialplan" ref="bdad08d2759df1713bf4c15b39be4893" args="(int fd, int argc, char *argv[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int handle_show_dialplan           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03480">3480</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="pbx_8c-source.html#l00543">AST_PBX_MAX_STACK</a>, <a class="el" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="chan__alsa_8c-source.html#l00124">context</a>, <a class="el" href="chan__alsa_8c-source.html#l00126">exten</a>, <a class="el" href="cli_8h-source.html#l00039">RESULT_FAILURE</a>, <a class="el" href="cli_8h-source.html#l00038">RESULT_SHOWUSAGE</a>, <a class="el" href="cli_8h-source.html#l00037">RESULT_SUCCESS</a>, <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>, and <a class="el" href="strcompat_8c-source.html#l00035">strsep()</a>.<div class="fragment"><pre class="fragment"><a name="l03481"></a>03481 {
<a name="l03482"></a>03482    <span class="keywordtype">char</span> *<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a> = NULL, *<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a> = NULL;
<a name="l03483"></a>03483    <span class="comment">/* Variables used for different counters */</span>
<a name="l03484"></a>03484    <span class="keyword">struct </span><a class="code" href="structdialplan__counters.html">dialplan_counters</a> counters;
<a name="l03485"></a>03485 
<a name="l03486"></a>03486    <span class="keyword">const</span> <span class="keywordtype">char</span> *incstack[<a class="code" href="pbx_8c.html#249ae5f11bddff7a9bda62683881685d">AST_PBX_MAX_STACK</a>];
<a name="l03487"></a>03487    memset(&amp;counters, 0, <span class="keyword">sizeof</span>(counters));
<a name="l03488"></a>03488 
<a name="l03489"></a>03489    <span class="keywordflow">if</span> (argc != 2 &amp;&amp; argc != 3)
<a name="l03490"></a>03490       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d7f3bcd35c16172e6fc0964a175fcadb">RESULT_SHOWUSAGE</a>;
<a name="l03491"></a>03491 
<a name="l03492"></a>03492    <span class="comment">/* we obtain [exten@]context? if yes, split them ... */</span>
<a name="l03493"></a>03493    <span class="keywordflow">if</span> (argc == 3) {
<a name="l03494"></a>03494       <span class="keywordflow">if</span> (strchr(argv[2], <span class="charliteral">'@'</span>)) {   <span class="comment">/* split into exten &amp; context */</span>
<a name="l03495"></a>03495          context = <a class="code" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>(argv[2]);
<a name="l03496"></a>03496          exten = <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;context, <span class="stringliteral">"@"</span>);
<a name="l03497"></a>03497          <span class="comment">/* change empty strings to NULL */</span>
<a name="l03498"></a>03498          <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(exten))
<a name="l03499"></a>03499             exten = NULL;
<a name="l03500"></a>03500       } <span class="keywordflow">else</span> { <span class="comment">/* no '@' char, only context given */</span>
<a name="l03501"></a>03501          context = argv[2];
<a name="l03502"></a>03502       }
<a name="l03503"></a>03503       <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(context))
<a name="l03504"></a>03504          context = NULL;
<a name="l03505"></a>03505    }
<a name="l03506"></a>03506    <span class="comment">/* else Show complete dial plan, context and exten are NULL */</span>
<a name="l03507"></a>03507    <a class="code" href="pbx_8c.html#493e8914a452df695fe1e0ac69d6aca3">show_dialplan_helper</a>(fd, context, exten, &amp;counters, NULL, 0, incstack);
<a name="l03508"></a>03508 
<a name="l03509"></a>03509    <span class="comment">/* check for input failure and throw some error messages */</span>
<a name="l03510"></a>03510    <span class="keywordflow">if</span> (context &amp;&amp; !counters.<a class="code" href="structdialplan__counters.html#d83aeff98aa6828baafded23fc65db20">context_existence</a>) {
<a name="l03511"></a>03511       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"There is no existence of '%s' context\n"</span>, context);
<a name="l03512"></a>03512       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#029ade91f74f40adbbae98503f72e91b">RESULT_FAILURE</a>;
<a name="l03513"></a>03513    }
<a name="l03514"></a>03514 
<a name="l03515"></a>03515    <span class="keywordflow">if</span> (exten &amp;&amp; !counters.<a class="code" href="structdialplan__counters.html#bdd2eb943b642d347ef6b674e1e2218c">extension_existence</a>) {
<a name="l03516"></a>03516       <span class="keywordflow">if</span> (context)
<a name="l03517"></a>03517          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"There is no existence of %s@%s extension\n"</span>,
<a name="l03518"></a>03518             exten, context);
<a name="l03519"></a>03519       <span class="keywordflow">else</span>
<a name="l03520"></a>03520          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd,
<a name="l03521"></a>03521             <span class="stringliteral">"There is no existence of '%s' extension in all contexts\n"</span>,
<a name="l03522"></a>03522             exten);
<a name="l03523"></a>03523       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#029ade91f74f40adbbae98503f72e91b">RESULT_FAILURE</a>;
<a name="l03524"></a>03524    }
<a name="l03525"></a>03525 
<a name="l03526"></a>03526    <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd,<span class="stringliteral">"-= %d %s (%d %s) in %d %s. =-\n"</span>,
<a name="l03527"></a>03527             counters.<a class="code" href="structdialplan__counters.html#5d114b3c88c5a56e3372542b0505af59">total_exten</a>, counters.<a class="code" href="structdialplan__counters.html#5d114b3c88c5a56e3372542b0505af59">total_exten</a> == 1 ? <span class="stringliteral">"extension"</span> : <span class="stringliteral">"extensions"</span>,
<a name="l03528"></a>03528             counters.<a class="code" href="structdialplan__counters.html#041d969e041f5ac8328a9422cf8a3cb1">total_prio</a>, counters.<a class="code" href="structdialplan__counters.html#041d969e041f5ac8328a9422cf8a3cb1">total_prio</a> == 1 ? <span class="stringliteral">"priority"</span> : <span class="stringliteral">"priorities"</span>,
<a name="l03529"></a>03529             counters.<a class="code" href="structdialplan__counters.html#e56cfe3dac1f97235b12888a73e565a8">total_context</a>, counters.<a class="code" href="structdialplan__counters.html#e56cfe3dac1f97235b12888a73e565a8">total_context</a> == 1 ? <span class="stringliteral">"context"</span> : <span class="stringliteral">"contexts"</span>);
<a name="l03530"></a>03530 
<a name="l03531"></a>03531    <span class="comment">/* everything ok */</span>
<a name="l03532"></a>03532    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l03533"></a>03533 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="524ad80b6c4f0d68e6552e45cf4a18ba"></a><!-- doxytag: member="pbx.c::handle_show_function" ref="524ad80b6c4f0d68e6552e45cf4a18ba" args="(int fd, int argc, char *argv[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int handle_show_function           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01269">1269</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="pbx_8c-source.html#l01345">ast_custom_function_find()</a>, <a class="el" href="pbx_8h-source.html#l00034">AST_MAX_APP</a>, <a class="el" href="term_8h-source.html#l00051">COLOR_CYAN</a>, <a class="el" href="term_8h-source.html#l00049">COLOR_MAGENTA</a>, <a class="el" href="pbx_8h-source.html#l00075">ast_custom_function::desc</a>, <a class="el" href="callerid_8c-source.html#l01044">description</a>, <a class="el" href="pbx_8h-source.html#l00073">ast_custom_function::name</a>, <a class="el" href="cli_8h-source.html#l00039">RESULT_FAILURE</a>, <a class="el" href="cli_8h-source.html#l00038">RESULT_SHOWUSAGE</a>, <a class="el" href="cli_8h-source.html#l00037">RESULT_SUCCESS</a>, <a class="el" href="pbx_8h-source.html#l00074">ast_custom_function::synopsis</a>, <a class="el" href="chan__agent_8c-source.html#l00082">synopsis</a>, <a class="el" href="pbx_8h-source.html#l00076">ast_custom_function::syntax</a>, and <a class="el" href="term_8c-source.html#l00150">term_color()</a>.<div class="fragment"><pre class="fragment"><a name="l01270"></a>01270 {
<a name="l01271"></a>01271    <span class="keyword">struct </span><a class="code" href="structast__custom__function.html">ast_custom_function</a> *acf;
<a name="l01272"></a>01272    <span class="comment">/* Maximum number of characters added by terminal coloring is 22 */</span>
<a name="l01273"></a>01273    <span class="keywordtype">char</span> infotitle[64 + <a class="code" href="pbx_8h.html#a973a2fecfe2da6df7aaf2d5be3ea548">AST_MAX_APP</a> + 22], syntitle[40], destitle[40];
<a name="l01274"></a>01274    <span class="keywordtype">char</span> info[64 + <a class="code" href="pbx_8h.html#a973a2fecfe2da6df7aaf2d5be3ea548">AST_MAX_APP</a>], *<a class="code" href="chan__agent_8c.html#485d112e4e425dde393e2e7091451856">synopsis</a> = NULL, *<a class="code" href="callerid_8c.html#67daf92c833c41c95db874e18fcb2786">description</a> = NULL;
<a name="l01275"></a>01275    <span class="keywordtype">char</span> stxtitle[40], *<a class="code" href="structast__custom__function.html#55152fd428afc5d73e8878d27d0b09c3">syntax</a> = NULL;
<a name="l01276"></a>01276    <span class="keywordtype">int</span> synopsis_size, description_size, syntax_size;
<a name="l01277"></a>01277 
<a name="l01278"></a>01278    <span class="keywordflow">if</span> (argc &lt; 4)
<a name="l01279"></a>01279       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d7f3bcd35c16172e6fc0964a175fcadb">RESULT_SHOWUSAGE</a>;
<a name="l01280"></a>01280 
<a name="l01281"></a>01281    <span class="keywordflow">if</span> (!(acf = <a class="code" href="pbx_8c.html#2f6033daa3dd2a6a51ee380a86a783ba">ast_custom_function_find</a>(argv[3]))) {
<a name="l01282"></a>01282       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"No function by that name registered.\n"</span>);
<a name="l01283"></a>01283       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#029ade91f74f40adbbae98503f72e91b">RESULT_FAILURE</a>;
<a name="l01284"></a>01284 
<a name="l01285"></a>01285    }
<a name="l01286"></a>01286 
<a name="l01287"></a>01287    <span class="keywordflow">if</span> (acf-&gt;<a class="code" href="structast__custom__function.html#512fbb4e7b617c04031f58b631f2b05d">synopsis</a>)
<a name="l01288"></a>01288       synopsis_size = strlen(acf-&gt;<a class="code" href="structast__custom__function.html#512fbb4e7b617c04031f58b631f2b05d">synopsis</a>) + 23;
<a name="l01289"></a>01289    <span class="keywordflow">else</span>
<a name="l01290"></a>01290       synopsis_size = strlen(<span class="stringliteral">"Not available"</span>) + 23;
<a name="l01291"></a>01291    synopsis = alloca(synopsis_size);
<a name="l01292"></a>01292 
<a name="l01293"></a>01293    <span class="keywordflow">if</span> (acf-&gt;<a class="code" href="structast__custom__function.html#1dee80c7d5ab2c1c90aa8d2f7dd47256">desc</a>)
<a name="l01294"></a>01294       description_size = strlen(acf-&gt;<a class="code" href="structast__custom__function.html#1dee80c7d5ab2c1c90aa8d2f7dd47256">desc</a>) + 23;
<a name="l01295"></a>01295    <span class="keywordflow">else</span>
<a name="l01296"></a>01296       description_size = strlen(<span class="stringliteral">"Not available"</span>) + 23;
<a name="l01297"></a>01297    description = alloca(description_size);
<a name="l01298"></a>01298 
<a name="l01299"></a>01299    <span class="keywordflow">if</span> (acf-&gt;<a class="code" href="structast__custom__function.html#55152fd428afc5d73e8878d27d0b09c3">syntax</a>)
<a name="l01300"></a>01300       syntax_size = strlen(acf-&gt;<a class="code" href="structast__custom__function.html#55152fd428afc5d73e8878d27d0b09c3">syntax</a>) + 23;
<a name="l01301"></a>01301    <span class="keywordflow">else</span>
<a name="l01302"></a>01302       syntax_size = strlen(<span class="stringliteral">"Not available"</span>) + 23;
<a name="l01303"></a>01303    syntax = alloca(syntax_size);
<a name="l01304"></a>01304 
<a name="l01305"></a>01305    snprintf(info, 64 + <a class="code" href="pbx_8h.html#a973a2fecfe2da6df7aaf2d5be3ea548">AST_MAX_APP</a>, <span class="stringliteral">"\n  -= Info about function '%s' =- \n\n"</span>, acf-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l01306"></a>01306    <a class="code" href="term_8c.html#e93d6667c9a6823fef4ab75cd64c90ca">term_color</a>(infotitle, info, <a class="code" href="term_8h.html#9b6e4fad9007204f76df6cd6e1ce1bf4">COLOR_MAGENTA</a>, 0, 64 + <a class="code" href="pbx_8h.html#a973a2fecfe2da6df7aaf2d5be3ea548">AST_MAX_APP</a> + 22);
<a name="l01307"></a>01307    <a class="code" href="term_8c.html#e93d6667c9a6823fef4ab75cd64c90ca">term_color</a>(stxtitle, <span class="stringliteral">"[Syntax]\n"</span>, <a class="code" href="term_8h.html#9b6e4fad9007204f76df6cd6e1ce1bf4">COLOR_MAGENTA</a>, 0, 40);
<a name="l01308"></a>01308    <a class="code" href="term_8c.html#e93d6667c9a6823fef4ab75cd64c90ca">term_color</a>(syntitle, <span class="stringliteral">"[Synopsis]\n"</span>, <a class="code" href="term_8h.html#9b6e4fad9007204f76df6cd6e1ce1bf4">COLOR_MAGENTA</a>, 0, 40);
<a name="l01309"></a>01309    <a class="code" href="term_8c.html#e93d6667c9a6823fef4ab75cd64c90ca">term_color</a>(destitle, <span class="stringliteral">"[Description]\n"</span>, <a class="code" href="term_8h.html#9b6e4fad9007204f76df6cd6e1ce1bf4">COLOR_MAGENTA</a>, 0, 40);
<a name="l01310"></a>01310    <a class="code" href="term_8c.html#e93d6667c9a6823fef4ab75cd64c90ca">term_color</a>(syntax,
<a name="l01311"></a>01311          acf-&gt;<a class="code" href="structast__custom__function.html#55152fd428afc5d73e8878d27d0b09c3">syntax</a> ? acf-&gt;<a class="code" href="structast__custom__function.html#55152fd428afc5d73e8878d27d0b09c3">syntax</a> : <span class="stringliteral">"Not available"</span>,
<a name="l01312"></a>01312          <a class="code" href="term_8h.html#0b7173c34af1ee5517a3db2a4446c39a">COLOR_CYAN</a>, 0, syntax_size);
<a name="l01313"></a>01313    <a class="code" href="term_8c.html#e93d6667c9a6823fef4ab75cd64c90ca">term_color</a>(synopsis,
<a name="l01314"></a>01314          acf-&gt;<a class="code" href="structast__custom__function.html#512fbb4e7b617c04031f58b631f2b05d">synopsis</a> ? acf-&gt;<a class="code" href="structast__custom__function.html#512fbb4e7b617c04031f58b631f2b05d">synopsis</a> : <span class="stringliteral">"Not available"</span>,
<a name="l01315"></a>01315          <a class="code" href="term_8h.html#0b7173c34af1ee5517a3db2a4446c39a">COLOR_CYAN</a>, 0, synopsis_size);
<a name="l01316"></a>01316    <a class="code" href="term_8c.html#e93d6667c9a6823fef4ab75cd64c90ca">term_color</a>(description,
<a name="l01317"></a>01317          acf-&gt;<a class="code" href="structast__custom__function.html#1dee80c7d5ab2c1c90aa8d2f7dd47256">desc</a> ? acf-&gt;<a class="code" href="structast__custom__function.html#1dee80c7d5ab2c1c90aa8d2f7dd47256">desc</a> : <span class="stringliteral">"Not available"</span>,
<a name="l01318"></a>01318          <a class="code" href="term_8h.html#0b7173c34af1ee5517a3db2a4446c39a">COLOR_CYAN</a>, 0, description_size);
<a name="l01319"></a>01319 
<a name="l01320"></a>01320    <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd,<span class="stringliteral">"%s%s%s\n\n%s%s\n\n%s%s\n"</span>, infotitle, stxtitle, syntax, syntitle, synopsis, destitle, description);
<a name="l01321"></a>01321 
<a name="l01322"></a>01322    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l01323"></a>01323 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4777aaf3739c0e3a6979ebb5e9eb221d"></a><!-- doxytag: member="pbx.c::handle_show_functions" ref="4777aaf3739c0e3a6979ebb5e9eb221d" args="(int fd, int argc, char *argv[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int handle_show_functions           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01241">1241</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="linkedlists_8h-source.html#l00060">AST_RWLIST_RDLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="pbx_8h-source.html#l00073">ast_custom_function::name</a>, <a class="el" href="cli_8h-source.html#l00038">RESULT_SHOWUSAGE</a>, <a class="el" href="cli_8h-source.html#l00037">RESULT_SUCCESS</a>, <a class="el" href="pbx_8h-source.html#l00074">ast_custom_function::synopsis</a>, and <a class="el" href="pbx_8h-source.html#l00076">ast_custom_function::syntax</a>.<div class="fragment"><pre class="fragment"><a name="l01242"></a>01242 {
<a name="l01243"></a>01243    <span class="keyword">struct </span><a class="code" href="structast__custom__function.html">ast_custom_function</a> *acf;
<a name="l01244"></a>01244    <span class="keywordtype">int</span> count_acf = 0;
<a name="l01245"></a>01245    <span class="keywordtype">int</span> like = 0;
<a name="l01246"></a>01246 
<a name="l01247"></a>01247    <span class="keywordflow">if</span> (argc == 5 &amp;&amp; (!strcmp(argv[3], <span class="stringliteral">"like"</span>)) ) {
<a name="l01248"></a>01248       like = 1;
<a name="l01249"></a>01249    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (argc != 3) {
<a name="l01250"></a>01250       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d7f3bcd35c16172e6fc0964a175fcadb">RESULT_SHOWUSAGE</a>;
<a name="l01251"></a>01251    }
<a name="l01252"></a>01252 
<a name="l01253"></a>01253    <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"%s Custom Functions:\n--------------------------------------------------------------------------------\n"</span>, like ? <span class="stringliteral">"Matching"</span> : <span class="stringliteral">"Installed"</span>);
<a name="l01254"></a>01254 
<a name="l01255"></a>01255    <a class="code" href="linkedlists_8h.html#23c0c844e5abcb474854867b408e3be8">AST_RWLIST_RDLOCK</a>(&amp;acf_root);
<a name="l01256"></a>01256    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;acf_root, acf, acflist) {
<a name="l01257"></a>01257       <span class="keywordflow">if</span> (!like || strstr(acf-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>, argv[4])) {
<a name="l01258"></a>01258          count_acf++;
<a name="l01259"></a>01259          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"%-20.20s  %-35.35s  %s\n"</span>, acf-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>, acf-&gt;<a class="code" href="structast__custom__function.html#55152fd428afc5d73e8878d27d0b09c3">syntax</a>, acf-&gt;<a class="code" href="structast__custom__function.html#512fbb4e7b617c04031f58b631f2b05d">synopsis</a>);
<a name="l01260"></a>01260       }
<a name="l01261"></a>01261    }
<a name="l01262"></a>01262    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;acf_root);
<a name="l01263"></a>01263 
<a name="l01264"></a>01264    <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"%d %scustom functions installed.\n"</span>, count_acf, like ? <span class="stringliteral">"matching "</span> : <span class="stringliteral">""</span>);
<a name="l01265"></a>01265 
<a name="l01266"></a>01266    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l01267"></a>01267 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="23311d60c2977067b7a13a76e575116f"></a><!-- doxytag: member="pbx.c::handle_show_globals" ref="23311d60c2977067b7a13a76e575116f" args="(int fd, int argc, char *argv[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int handle_show_globals           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
CLI support for listing global variables in a parseable way. 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03754">3754</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="lock_8h-source.html#l00642">ast_rwlock_rdlock()</a>, <a class="el" href="lock_8h-source.html#l00637">ast_rwlock_unlock()</a>, <a class="el" href="chanvars_8c-source.html#l00062">ast_var_name()</a>, <a class="el" href="chanvars_8c-source.html#l00082">ast_var_value()</a>, and <a class="el" href="cli_8h-source.html#l00037">RESULT_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l03755"></a>03755 {
<a name="l03756"></a>03756    <span class="keywordtype">int</span> i = 0;
<a name="l03757"></a>03757    <span class="keyword">struct </span><a class="code" href="structast__var__t.html">ast_var_t</a> *newvariable;
<a name="l03758"></a>03758 
<a name="l03759"></a>03759    <a class="code" href="lock_8h.html#f4b8158bcd471d4f28b380768e3ee073">ast_rwlock_rdlock</a>(&amp;globalslock);
<a name="l03760"></a>03760    <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a> (&amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>, newvariable, entries) {
<a name="l03761"></a>03761       i++;
<a name="l03762"></a>03762       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"   %s=%s\n"</span>, <a class="code" href="chanvars_8c.html#29d40dfad3c6b59de315b3a0d2ed0a23">ast_var_name</a>(newvariable), <a class="code" href="chanvars_8c.html#6aa089cff5424a26ade21a520e443f82">ast_var_value</a>(newvariable));
<a name="l03763"></a>03763    }
<a name="l03764"></a>03764    <a class="code" href="lock_8h.html#97ed909ef0a0582cf3870dd0629852c8">ast_rwlock_unlock</a>(&amp;globalslock);
<a name="l03765"></a>03765    <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"\n    -- %d variables\n"</span>, i);
<a name="l03766"></a>03766 
<a name="l03767"></a>03767    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l03768"></a>03768 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="373673c4f54bbeb1b4e6f3e02a1b1206"></a><!-- doxytag: member="pbx.c::handle_show_hints" ref="373673c4f54bbeb1b4e6f3e02a1b1206" args="(int fd, int argc, char *argv[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int handle_show_hints           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
handle_show_hints: CLI support for listing registered dial plan hints 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03142">3142</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="pbx_8c-source.html#l01897">ast_extension_state2str()</a>, <a class="el" href="pbx_8c-source.html#l06100">ast_get_context_name()</a>, <a class="el" href="pbx_8c-source.html#l06168">ast_get_extension_app()</a>, <a class="el" href="pbx_8c-source.html#l06105">ast_get_extension_context()</a>, <a class="el" href="pbx_8c-source.html#l06110">ast_get_extension_name()</a>, <a class="el" href="linkedlists_8h-source.html#l00415">AST_RWLIST_EMPTY</a>, <a class="el" href="linkedlists_8h-source.html#l00060">AST_RWLIST_RDLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="pbx_8c-source.html#l00205">ast_hint::callbacks</a>, <a class="el" href="pbx_8c-source.html#l00203">ast_hint::exten</a>, <a class="el" href="pbx_8c-source.html#l00204">ast_hint::laststate</a>, <a class="el" href="pbx_8c-source.html#l00193">ast_state_cb::next</a>, <a class="el" href="adsistub_8c-source.html#l00083">num</a>, and <a class="el" href="cli_8h-source.html#l00037">RESULT_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l03143"></a>03143 {
<a name="l03144"></a>03144    <span class="keyword">struct </span><a class="code" href="structast__hint.html">ast_hint</a> *hint;
<a name="l03145"></a>03145    <span class="keywordtype">int</span> <a class="code" href="adsistub_8c.html#0fc3cfbc27e91ea60a787de13dae3e3c">num</a> = 0;
<a name="l03146"></a>03146    <span class="keywordtype">int</span> watchers;
<a name="l03147"></a>03147    <span class="keyword">struct </span><a class="code" href="structast__state__cb.html">ast_state_cb</a> *watcher;
<a name="l03148"></a>03148 
<a name="l03149"></a>03149    <a class="code" href="linkedlists_8h.html#23c0c844e5abcb474854867b408e3be8">AST_RWLIST_RDLOCK</a>(&amp;hints);
<a name="l03150"></a>03150    <span class="keywordflow">if</span> (<a class="code" href="linkedlists_8h.html#020b0bebdc89708ef3af28762efc67d6">AST_RWLIST_EMPTY</a>(&amp;hints)) {
<a name="l03151"></a>03151       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"There are no registered dialplan hints\n"</span>);
<a name="l03152"></a>03152       <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l03153"></a>03153       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l03154"></a>03154    }
<a name="l03155"></a>03155    <span class="comment">/* ... we have hints ... */</span>
<a name="l03156"></a>03156    <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"\n    -= Registered Asterisk Dial Plan Hints =-\n"</span>);
<a name="l03157"></a>03157    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;hints, hint, list) {
<a name="l03158"></a>03158       watchers = 0;
<a name="l03159"></a>03159       <span class="keywordflow">for</span> (watcher = hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a>; watcher; watcher = watcher-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>)
<a name="l03160"></a>03160          watchers++;
<a name="l03161"></a>03161       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"   %20s@%-20.20s: %-20.20s  State:%-15.15s Watchers %2d\n"</span>,
<a name="l03162"></a>03162          <a class="code" href="pbx_8c.html#4318ec15d92ac47de94902f6aba4c114">ast_get_extension_name</a>(hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>),
<a name="l03163"></a>03163          <a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(<a class="code" href="pbx_8c.html#61636cd55acce8616de92323b8a427b9">ast_get_extension_context</a>(hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>)),
<a name="l03164"></a>03164          <a class="code" href="pbx_8c.html#c8eaa4fc248390fee258e7d2b2ff3490">ast_get_extension_app</a>(hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>),
<a name="l03165"></a>03165          <a class="code" href="pbx_8c.html#c4e2c1f2a0862db3fb3faa3d5dd9350c">ast_extension_state2str</a>(hint-&gt;<a class="code" href="structast__hint.html#406c995dd8ced9add7c7f6eb95532fe7">laststate</a>), watchers);
<a name="l03166"></a>03166       num++;
<a name="l03167"></a>03167    }
<a name="l03168"></a>03168    <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"----------------\n"</span>);
<a name="l03169"></a>03169    <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"- %d hints registered\n"</span>, num);
<a name="l03170"></a>03170    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l03171"></a>03171    <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l03172"></a>03172 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b34567b1f69cf39a5506464a4d407346"></a><!-- doxytag: member="pbx.c::handle_show_switches" ref="b34567b1f69cf39a5506464a4d407346" args="(int fd, int argc, char *argv[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int handle_show_switches           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
handle_show_switches: CLI support for listing registered dial plan switches 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03175">3175</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="linkedlists_8h-source.html#l00415">AST_RWLIST_EMPTY</a>, <a class="el" href="linkedlists_8h-source.html#l00060">AST_RWLIST_RDLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="pbx_8h-source.html#l00090">ast_switch::description</a>, <a class="el" href="pbx_8h-source.html#l00089">ast_switch::name</a>, and <a class="el" href="cli_8h-source.html#l00037">RESULT_SUCCESS</a>.<div class="fragment"><pre class="fragment"><a name="l03176"></a>03176 {
<a name="l03177"></a>03177    <span class="keyword">struct </span><a class="code" href="structast__switch.html">ast_switch</a> *sw;
<a name="l03178"></a>03178 
<a name="l03179"></a>03179    <a class="code" href="linkedlists_8h.html#23c0c844e5abcb474854867b408e3be8">AST_RWLIST_RDLOCK</a>(&amp;switches);
<a name="l03180"></a>03180 
<a name="l03181"></a>03181    <span class="keywordflow">if</span> (<a class="code" href="linkedlists_8h.html#020b0bebdc89708ef3af28762efc67d6">AST_RWLIST_EMPTY</a>(&amp;switches)) {
<a name="l03182"></a>03182       <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;switches);
<a name="l03183"></a>03183       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"There are no registered alternative switches\n"</span>);
<a name="l03184"></a>03184       <span class="keywordflow">return</span> <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l03185"></a>03185    }
<a name="l03186"></a>03186 
<a name="l03187"></a>03187    <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"\n    -= Registered Asterisk Alternative Switches =-\n"</span>);
<a name="l03188"></a>03188    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;switches, sw, list)
<a name="l03189"></a>03189       <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, "%<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>: %<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>\n", sw-&gt;<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, sw-&gt;<a class="code" href="callerid_8c.html#67daf92c833c41c95db874e18fcb2786">description</a>);
<a name="l03190"></a>03190 
<a name="l03191"></a>03191    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;switches);
<a name="l03192"></a>03192 
<a name="l03193"></a>03193    return <a class="code" href="cli_8h.html#d92028a33e35e9d037718f4d846096f9">RESULT_SUCCESS</a>;
<a name="l03194"></a>03194 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="355ea768230f2ab2299d8eea050b674c"></a><!-- doxytag: member="pbx.c::include_valid" ref="355ea768230f2ab2299d8eea050b674c" args="(struct ast_include *i)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int include_valid           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__include.html">ast_include</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>i</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00575">575</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l04262">ast_check_timing()</a>, <a class="el" href="pbx_8c-source.html#l00140">ast_include::hastime</a>, and <a class="el" href="pbx_8c-source.html#l00141">ast_include::timing</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>.<div class="fragment"><pre class="fragment"><a name="l00576"></a>00576 {
<a name="l00577"></a>00577    <span class="keywordflow">if</span> (!i-&gt;<a class="code" href="structast__include.html#afa6dfc2de3a5a43456abec2b5972ab0">hastime</a>)
<a name="l00578"></a>00578       <span class="keywordflow">return</span> 1;
<a name="l00579"></a>00579 
<a name="l00580"></a>00580    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#4dee27d639900ebea4f8b3c0366a197f">ast_check_timing</a>(&amp;(i-&gt;<a class="code" href="structast__include.html#4ad8aa3a3571ea912a6ec5ea5fdcc93c">timing</a>));
<a name="l00581"></a>00581 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="98ddc357b5ac13bfaa71167740ecc75a"></a><!-- doxytag: member="pbx.c::increase_call_count" ref="98ddc357b5ac13bfaa71167740ecc75a" args="(const struct ast_channel *c)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int increase_call_count           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>c</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02468">2468</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="lock_8h-source.html#l00530">ast_mutex_lock()</a>, <a class="el" href="lock_8h-source.html#l00520">ast_mutex_unlock()</a>, <a class="el" href="pbx_8c-source.html#l00252">countcalls</a>, <a class="el" href="strcompat_8c-source.html#l00333">getloadavg()</a>, <a class="el" href="logger_8h-source.html#l00106">LOG_NOTICE</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="asterisk_8c-source.html#l00167">option_maxcalls</a>, and <a class="el" href="asterisk_8c-source.html#l00166">option_maxload</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02572">ast_pbx_run()</a>, and <a class="el" href="pbx_8c-source.html#l02551">ast_pbx_start()</a>.<div class="fragment"><pre class="fragment"><a name="l02469"></a>02469 {
<a name="l02470"></a>02470    <span class="keywordtype">int</span> failed = 0;
<a name="l02471"></a>02471    <span class="keywordtype">double</span> curloadavg;
<a name="l02472"></a>02472 <span class="preprocessor">#if defined(HAVE_SYSINFO)</span>
<a name="l02473"></a>02473 <span class="preprocessor"></span>   <span class="keywordtype">long</span> curfreemem;
<a name="l02474"></a>02474    <span class="keyword">struct </span>sysinfo sys_info;
<a name="l02475"></a>02475 <span class="preprocessor">#endif</span>
<a name="l02476"></a>02476 <span class="preprocessor"></span>
<a name="l02477"></a>02477    <a class="code" href="lock_8h.html#b3c5e3093b325167f88db93c8b4b2421">ast_mutex_lock</a>(&amp;maxcalllock);
<a name="l02478"></a>02478    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g367972f6fd289cfd0361f9f8292dd597">option_maxcalls</a>) {
<a name="l02479"></a>02479       <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#a3a9f90f51c55c02ddf6ad8e26249341">countcalls</a> &gt;= <a class="code" href="group__main__options.html#g367972f6fd289cfd0361f9f8292dd597">option_maxcalls</a>) {
<a name="l02480"></a>02480          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#bbf95aad74d847cd4bcb129604f798cd">LOG_NOTICE</a>, <span class="stringliteral">"Maximum call limit of %d calls exceeded by '%s'!\n"</span>, <a class="code" href="group__main__options.html#g367972f6fd289cfd0361f9f8292dd597">option_maxcalls</a>, c-&gt;name);
<a name="l02481"></a>02481          failed = -1;
<a name="l02482"></a>02482       }
<a name="l02483"></a>02483    }
<a name="l02484"></a>02484    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g3d42ed99510dbaa405f4e83e95267503">option_maxload</a>) {
<a name="l02485"></a>02485       <a class="code" href="strcompat_8c.html#4080893624f396234249433a0e8a2317">getloadavg</a>(&amp;curloadavg, 1);
<a name="l02486"></a>02486       <span class="keywordflow">if</span> (curloadavg &gt;= <a class="code" href="group__main__options.html#g3d42ed99510dbaa405f4e83e95267503">option_maxload</a>) {
<a name="l02487"></a>02487          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#bbf95aad74d847cd4bcb129604f798cd">LOG_NOTICE</a>, <span class="stringliteral">"Maximum loadavg limit of %f load exceeded by '%s' (currently %f)!\n"</span>, <a class="code" href="group__main__options.html#g3d42ed99510dbaa405f4e83e95267503">option_maxload</a>, c-&gt;name, curloadavg);
<a name="l02488"></a>02488          failed = -1;
<a name="l02489"></a>02489       }
<a name="l02490"></a>02490    }
<a name="l02491"></a>02491 <span class="preprocessor">#if defined(HAVE_SYSINFO)</span>
<a name="l02492"></a>02492 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (option_minmemfree) {
<a name="l02493"></a>02493       <span class="keywordflow">if</span> (!sysinfo(&amp;sys_info)) {
<a name="l02494"></a>02494          <span class="comment">/* make sure that the free system memory is above the configured low watermark</span>
<a name="l02495"></a>02495 <span class="comment">          * convert the amount of freeram from mem_units to MB */</span>
<a name="l02496"></a>02496          curfreemem = sys_info.freeram / sys_info.mem_unit; 
<a name="l02497"></a>02497          curfreemem /= 1024*1024; 
<a name="l02498"></a>02498          <span class="keywordflow">if</span> (curfreemem &lt; option_minmemfree) {
<a name="l02499"></a>02499             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Available system memory (~%ldMB) is below the configured low watermark (%ldMB)\n"</span>, curfreemem, option_minmemfree);
<a name="l02500"></a>02500             failed = -1;
<a name="l02501"></a>02501          }
<a name="l02502"></a>02502       }
<a name="l02503"></a>02503    }
<a name="l02504"></a>02504 <span class="preprocessor">#endif</span>
<a name="l02505"></a>02505 <span class="preprocessor"></span>      
<a name="l02506"></a>02506    <span class="keywordflow">if</span> (!failed)
<a name="l02507"></a>02507       <a class="code" href="pbx_8c.html#a3a9f90f51c55c02ddf6ad8e26249341">countcalls</a>++;
<a name="l02508"></a>02508    <a class="code" href="lock_8h.html#1d33e3caf152f0901c5ebdb69c2d4d26">ast_mutex_unlock</a>(&amp;maxcalllock);
<a name="l02509"></a>02509 
<a name="l02510"></a>02510    <span class="keywordflow">return</span> failed;
<a name="l02511"></a>02511 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1123cfede7379bd2813e1b4306327c10"></a><!-- doxytag: member="pbx.c::load_pbx" ref="1123cfede7379bd2813e1b4306327c10" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int load_pbx           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Provided by <a class="el" href="pbx_8c.html">pbx.c</a> 
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06035">6035</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l01352">ast_cli_register_multiple()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="manager_8c-source.html#l02694">ast_manager_register2()</a>, <a class="el" href="pbx_8c-source.html#l02875">ast_register_application()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="cli_8c-source.html#l00949">builtins</a>, <a class="el" href="callerid_8c-source.html#l01044">description</a>, <a class="el" href="manager_8h-source.html#l00058">EVENT_FLAG_CONFIG</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, <a class="el" href="pbx_8c-source.html#l03690">manager_show_dialplan()</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="chan__agent_8c-source.html#l00082">synopsis</a>, and <a class="el" href="logger_8h-source.html#l00043">VERBOSE_PREFIX_1</a>.
<p>
Referenced by <a class="el" href="asterisk_8c-source.html#l02570">main()</a>.<div class="fragment"><pre class="fragment"><a name="l06036"></a>06036 {
<a name="l06037"></a>06037    <span class="keywordtype">int</span> x;
<a name="l06038"></a>06038 
<a name="l06039"></a>06039    <span class="comment">/* Initialize the PBX */</span>
<a name="l06040"></a>06040    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a>) {
<a name="l06041"></a>06041       <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>( <span class="stringliteral">"Asterisk PBX Core Initializing\n"</span>);
<a name="l06042"></a>06042       <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>( <span class="stringliteral">"Registering builtin applications:\n"</span>);
<a name="l06043"></a>06043    }
<a name="l06044"></a>06044    <a class="code" href="cli_8c.html#a334dfd903e83eea3729ff37aa372781">ast_cli_register_multiple</a>(<a class="code" href="pbx_8c.html#886f64036bf3be08de3c6f7561b0a8a9">pbx_cli</a>, <span class="keyword">sizeof</span>(<a class="code" href="pbx_8c.html#886f64036bf3be08de3c6f7561b0a8a9">pbx_cli</a>) / <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structast__cli__entry.html">ast_cli_entry</a>));
<a name="l06045"></a>06045 
<a name="l06046"></a>06046    <span class="comment">/* Register builtin applications */</span>
<a name="l06047"></a>06047    <span class="keywordflow">for</span> (x=0; x&lt;<span class="keyword">sizeof</span>(<a class="code" href="cli_8c.html#7b94c2c41ed9fd600b9a19bb54467397">builtins</a>) / <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structpbx__builtin.html">pbx_builtin</a>); x++) {
<a name="l06048"></a>06048       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a>)
<a name="l06049"></a>06049          <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>( <a class="code" href="logger_8h.html#be88e5e9e0316971a55422c09f04e996">VERBOSE_PREFIX_1</a> <span class="stringliteral">"[%s]\n"</span>, builtins[x].<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l06050"></a>06050       <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#f8e9b339fed38c405332f222cceeec40">ast_register_application</a>(builtins[x].<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, builtins[x].execute, builtins[x].<a class="code" href="chan__agent_8c.html#485d112e4e425dde393e2e7091451856">synopsis</a>, builtins[x].<a class="code" href="callerid_8c.html#67daf92c833c41c95db874e18fcb2786">description</a>)) {
<a name="l06051"></a>06051          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Unable to register builtin application '%s'\n"</span>, builtins[x].name);
<a name="l06052"></a>06052          <span class="keywordflow">return</span> -1;
<a name="l06053"></a>06053       }
<a name="l06054"></a>06054    }
<a name="l06055"></a>06055    
<a name="l06056"></a>06056    <span class="comment">/* Register manager application */</span>
<a name="l06057"></a>06057    <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"ShowDialPlan"</span>, <a class="code" href="manager_8h.html#31c33938947056ad055258c5c585812c">EVENT_FLAG_CONFIG</a>, <a class="code" href="pbx_8c.html#f6b8ea6835408c7f6c5a42d5a7502c03">manager_show_dialplan</a>, <span class="stringliteral">"List dialplan"</span>, <a class="code" href="pbx_8c.html#120b7e9b0d3b3902740d7fa84fc826e0">mandescr_show_dialplan</a>);
<a name="l06058"></a>06058    <span class="keywordflow">return</span> 0;
<a name="l06059"></a>06059 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="37c96c5787cdf4375b2e683139ce9a87"></a><!-- doxytag: member="pbx.c::lookup_name" ref="37c96c5787cdf4375b2e683139ce9a87" args="(const char *s, char *const names[], int max)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int lookup_name           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *const &nbsp;</td>
          <td class="mdname" nowrap> <em>names</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>max</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Helper for get_range. return the index of the matching entry, starting from 1. If names is not supplied, try numeric values. 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04058">4058</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04076">get_range()</a>.<div class="fragment"><pre class="fragment"><a name="l04059"></a>04059 {
<a name="l04060"></a>04060    <span class="keywordtype">int</span> i;
<a name="l04061"></a>04061 
<a name="l04062"></a>04062    <span class="keywordflow">if</span> (names) {
<a name="l04063"></a>04063       <span class="keywordflow">for</span> (i = 0; names[i]; i++) {
<a name="l04064"></a>04064          <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>, names[i]))
<a name="l04065"></a>04065             <span class="keywordflow">return</span> i+1;
<a name="l04066"></a>04066       }
<a name="l04067"></a>04067    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sscanf(<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>, <span class="stringliteral">"%d"</span>, &amp;i) == 1 &amp;&amp; i &gt;= 1 &amp;&amp; i &lt;= max) {
<a name="l04068"></a>04068       <span class="keywordflow">return</span> i;
<a name="l04069"></a>04069    }
<a name="l04070"></a>04070    <span class="keywordflow">return</span> 0; <span class="comment">/* error return */</span>
<a name="l04071"></a>04071 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="5d6b6ee3b52cfcfe8a3a6d88564dc768"></a><!-- doxytag: member="pbx.c::manager_dpsendack" ref="5d6b6ee3b52cfcfe8a3a6d88564dc768" args="(struct mansession *s, const struct message *m)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void manager_dpsendack           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structmansession.html">mansession</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const struct <a class="el" href="structmessage.html">message</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>m</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Send ack once. 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03536">3536</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="manager_8c-source.html#l00874">astman_send_listack()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l03537"></a>03537 {
<a name="l03538"></a>03538    <a class="code" href="group__Group__AMI.html#ga868a0aada874f97606fcc3119bad3da">astman_send_listack</a>(s, m, <span class="stringliteral">"DialPlan list will follow"</span>, <span class="stringliteral">"start"</span>);
<a name="l03539"></a>03539 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="f6b8ea6835408c7f6c5a42d5a7502c03"></a><!-- doxytag: member="pbx.c::manager_show_dialplan" ref="f6b8ea6835408c7f6c5a42d5a7502c03" args="(struct mansession *s, const struct message *m)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int manager_show_dialplan           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structmansession.html">mansession</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const struct <a class="el" href="structmessage.html">message</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>m</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Manager listing of dial plan. 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03690">3690</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="manager_8c-source.html#l00713">astman_get_header()</a>, <a class="el" href="manager_8c-source.html#l00859">astman_send_error()</a>, <a class="el" href="chan__alsa_8c-source.html#l00124">context</a>, <a class="el" href="manager_8h-source.html#l00058">EVENT_FLAG_CONFIG</a>, <a class="el" href="chan__alsa_8c-source.html#l00126">exten</a>, <a class="el" href="manager_8h-source.html#l00163">manager_event</a>, and <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l06035">load_pbx()</a>.<div class="fragment"><pre class="fragment"><a name="l03691"></a>03691 {
<a name="l03692"></a>03692    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, *<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>;
<a name="l03693"></a>03693    <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span> = <a class="code" href="group__Group__AMI.html#gd208abe83c7bd47d8004134de94d1b4b">astman_get_header</a>(m, <span class="stringliteral">"ActionID"</span>);
<a name="l03694"></a>03694    <span class="keywordtype">char</span> idtext[256];
<a name="l03695"></a>03695    <span class="keywordtype">int</span> res;
<a name="l03696"></a>03696 
<a name="l03697"></a>03697    <span class="comment">/* Variables used for different counters */</span>
<a name="l03698"></a>03698    <span class="keyword">struct </span><a class="code" href="structdialplan__counters.html">dialplan_counters</a> counters;
<a name="l03699"></a>03699 
<a name="l03700"></a>03700    <span class="keywordflow">if</span> (<span class="keywordtype">id</span> &amp;&amp; !<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(<span class="keywordtype">id</span>))
<a name="l03701"></a>03701       snprintf(idtext, <span class="keyword">sizeof</span>(idtext), <span class="stringliteral">"ActionID: %s\r\n"</span>, <span class="keywordtype">id</span>);
<a name="l03702"></a>03702    <span class="keywordflow">else</span>
<a name="l03703"></a>03703       idtext[0] = <span class="charliteral">'\0'</span>;
<a name="l03704"></a>03704 
<a name="l03705"></a>03705    memset(&amp;counters, 0, <span class="keyword">sizeof</span>(counters));
<a name="l03706"></a>03706 
<a name="l03707"></a>03707    exten = <a class="code" href="group__Group__AMI.html#gd208abe83c7bd47d8004134de94d1b4b">astman_get_header</a>(m, <span class="stringliteral">"Extension"</span>);
<a name="l03708"></a>03708    context = <a class="code" href="group__Group__AMI.html#gd208abe83c7bd47d8004134de94d1b4b">astman_get_header</a>(m, <span class="stringliteral">"Context"</span>);
<a name="l03709"></a>03709    
<a name="l03710"></a>03710    res = <a class="code" href="pbx_8c.html#1c7815f40dc8d76231a9aaa789b60de0">manager_show_dialplan_helper</a>(s, m, idtext, context, exten, &amp;counters, NULL);
<a name="l03711"></a>03711 
<a name="l03712"></a>03712    <span class="keywordflow">if</span> (context &amp;&amp; !counters.<a class="code" href="structdialplan__counters.html#d83aeff98aa6828baafded23fc65db20">context_existence</a>) {
<a name="l03713"></a>03713       <span class="keywordtype">char</span> errorbuf[BUFSIZ];
<a name="l03714"></a>03714    
<a name="l03715"></a>03715       snprintf(errorbuf, <span class="keyword">sizeof</span>(errorbuf), <span class="stringliteral">"Did not find context %s\r\n"</span>, context);
<a name="l03716"></a>03716       <a class="code" href="group__Group__AMI.html#g23a27dba104a8df4bb1c6a217a71e7e7">astman_send_error</a>(s, m, errorbuf);
<a name="l03717"></a>03717       <span class="keywordflow">return</span> 0;
<a name="l03718"></a>03718    }
<a name="l03719"></a>03719    <span class="keywordflow">if</span> (exten &amp;&amp; !counters.<a class="code" href="structdialplan__counters.html#bdd2eb943b642d347ef6b674e1e2218c">extension_existence</a>) {
<a name="l03720"></a>03720       <span class="keywordtype">char</span> errorbuf[BUFSIZ];
<a name="l03721"></a>03721 
<a name="l03722"></a>03722       <span class="keywordflow">if</span> (context)
<a name="l03723"></a>03723          snprintf(errorbuf, <span class="keyword">sizeof</span>(errorbuf), <span class="stringliteral">"Did not find extension %s@%s\r\n"</span>, exten, context);
<a name="l03724"></a>03724       <span class="keywordflow">else</span>
<a name="l03725"></a>03725          snprintf(errorbuf, <span class="keyword">sizeof</span>(errorbuf), <span class="stringliteral">"Did not find extension %s in any context\r\n"</span>, exten);
<a name="l03726"></a>03726       <a class="code" href="group__Group__AMI.html#g23a27dba104a8df4bb1c6a217a71e7e7">astman_send_error</a>(s, m, errorbuf);
<a name="l03727"></a>03727       <span class="keywordflow">return</span> 0;
<a name="l03728"></a>03728    }
<a name="l03729"></a>03729 
<a name="l03730"></a>03730    <a class="code" href="manager_8h.html#17a8c809d5b2d04cbb8969a209134c2b">manager_event</a>(<a class="code" href="manager_8h.html#31c33938947056ad055258c5c585812c">EVENT_FLAG_CONFIG</a>, <span class="stringliteral">"ShowDialPlanComplete"</span>,
<a name="l03731"></a>03731       <span class="stringliteral">"EventList: Complete\r\n"</span>
<a name="l03732"></a>03732       <span class="stringliteral">"ListItems: %d\r\n"</span>
<a name="l03733"></a>03733       <span class="stringliteral">"ListExtensions: %d\r\n"</span>
<a name="l03734"></a>03734       <span class="stringliteral">"ListPriorities: %d\r\n"</span>   
<a name="l03735"></a>03735       <span class="stringliteral">"ListContexts: %d\r\n"</span>  
<a name="l03736"></a>03736       <span class="stringliteral">"%s"</span>
<a name="l03737"></a>03737       <span class="stringliteral">"\r\n"</span>, counters.<a class="code" href="structdialplan__counters.html#9c4e8fc926b5698807c4bd065419bc94">total_items</a>, counters.<a class="code" href="structdialplan__counters.html#5d114b3c88c5a56e3372542b0505af59">total_exten</a>, counters.<a class="code" href="structdialplan__counters.html#041d969e041f5ac8328a9422cf8a3cb1">total_prio</a>, counters.<a class="code" href="structdialplan__counters.html#e56cfe3dac1f97235b12888a73e565a8">total_context</a>, idtext);
<a name="l03738"></a>03738 
<a name="l03739"></a>03739    <span class="comment">/* everything ok */</span>
<a name="l03740"></a>03740    <span class="keywordflow">return</span> 0;
<a name="l03741"></a>03741 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1c7815f40dc8d76231a9aaa789b60de0"></a><!-- doxytag: member="pbx.c::manager_show_dialplan_helper" ref="1c7815f40dc8d76231a9aaa789b60de0" args="(struct mansession *s, const struct message *m, const char *actionidtext, const char *context, const char *exten, struct dialplan_counters *dpc, struct ast_include *rinclude)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int manager_show_dialplan_helper           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structmansession.html">mansession</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const struct <a class="el" href="structmessage.html">message</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>actionidtext</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structdialplan__counters.html">dialplan_counters</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>dpc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__include.html">ast_include</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>rinclude</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Show dialplan extensions XXX this function is similar but not exactly the same as the CLI's show dialplan. Must check whether the difference is intentional or not. 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03545">3545</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00877">ast_extension_match()</a>, <a class="el" href="pbx_8c-source.html#l06100">ast_get_context_name()</a>, <a class="el" href="pbx_8c-source.html#l06168">ast_get_extension_app()</a>, <a class="el" href="pbx_8c-source.html#l06173">ast_get_extension_app_data()</a>, <a class="el" href="pbx_8c-source.html#l06115">ast_get_extension_label()</a>, <a class="el" href="pbx_8c-source.html#l06110">ast_get_extension_name()</a>, <a class="el" href="pbx_8c-source.html#l06130">ast_get_extension_priority()</a>, <a class="el" href="pbx_8c-source.html#l06143">ast_get_extension_registrar()</a>, <a class="el" href="pbx_8c-source.html#l06125">ast_get_ignorepat_name()</a>, <a class="el" href="pbx_8c-source.html#l06153">ast_get_ignorepat_registrar()</a>, <a class="el" href="pbx_8c-source.html#l06120">ast_get_include_name()</a>, <a class="el" href="pbx_8c-source.html#l06148">ast_get_include_registrar()</a>, <a class="el" href="pbx_8c-source.html#l06183">ast_get_switch_data()</a>, <a class="el" href="pbx_8c-source.html#l06178">ast_get_switch_name()</a>, <a class="el" href="pbx_8c-source.html#l06188">ast_get_switch_registrar()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="channel_8h-source.html#l00139">AST_MAX_EXTENSION</a>, <a class="el" href="pbx_8c-source.html#l06087">ast_rdlock_context()</a>, <a class="el" href="pbx_8c-source.html#l06069">ast_rdlock_contexts()</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="pbx_8c-source.html#l06092">ast_unlock_context()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, <a class="el" href="pbx_8c-source.html#l06201">ast_walk_context_extensions()</a>, <a class="el" href="pbx_8c-source.html#l06234">ast_walk_context_ignorepats()</a>, <a class="el" href="pbx_8c-source.html#l06225">ast_walk_context_includes()</a>, <a class="el" href="pbx_8c-source.html#l06210">ast_walk_context_switches()</a>, <a class="el" href="pbx_8c-source.html#l06196">ast_walk_contexts()</a>, <a class="el" href="pbx_8c-source.html#l06219">ast_walk_extension_priorities()</a>, <a class="el" href="manager_8c-source.html#l00802">astman_append()</a>, <a class="el" href="manager_8c-source.html#l00859">astman_send_error()</a>, <a class="el" href="pbx_8c-source.html#l03310">dialplan_counters::context_existence</a>, <a class="el" href="pbx_8c-source.html#l03311">dialplan_counters::extension_existence</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="pbx_8c-source.html#l03536">manager_dpsendack()</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="pbx_8h-source.html#l00044">PRIORITY_HINT</a>, <a class="el" href="pbx_8c-source.html#l03307">dialplan_counters::total_context</a>, <a class="el" href="pbx_8c-source.html#l03308">dialplan_counters::total_exten</a>, <a class="el" href="pbx_8c-source.html#l03306">dialplan_counters::total_items</a>, and <a class="el" href="pbx_8c-source.html#l03309">dialplan_counters::total_prio</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03690">manager_show_dialplan()</a>.<div class="fragment"><pre class="fragment"><a name="l03549"></a>03549 {
<a name="l03550"></a>03550    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c;
<a name="l03551"></a>03551    <span class="keywordtype">int</span> res=0, old_total_exten = dpc-&gt;<a class="code" href="structdialplan__counters.html#5d114b3c88c5a56e3372542b0505af59">total_exten</a>;
<a name="l03552"></a>03552 
<a name="l03553"></a>03553    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>))
<a name="l03554"></a>03554       <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a> = NULL;
<a name="l03555"></a>03555    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>))
<a name="l03556"></a>03556       <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a> = NULL;
<a name="l03557"></a>03557 
<a name="l03558"></a>03558    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a> &gt; 2)
<a name="l03559"></a>03559       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"manager_show_dialplan: Context: -%s- Extension: -%s-\n"</span>, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>);
<a name="l03560"></a>03560 
<a name="l03561"></a>03561    <span class="comment">/* try to lock contexts */</span>
<a name="l03562"></a>03562    <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#1b60f4b570102084989c86fd02ca6536">ast_rdlock_contexts</a>()) {
<a name="l03563"></a>03563       <a class="code" href="group__Group__AMI.html#g23a27dba104a8df4bb1c6a217a71e7e7">astman_send_error</a>(s, m, <span class="stringliteral">"Failed to lock contexts\r\n"</span>);
<a name="l03564"></a>03564       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Failed to lock contexts list for manager: listdialplan\n"</span>);
<a name="l03565"></a>03565       <span class="keywordflow">return</span> -1;
<a name="l03566"></a>03566    }
<a name="l03567"></a>03567 
<a name="l03568"></a>03568    c = NULL;      <span class="comment">/* walk all contexts ... */</span>
<a name="l03569"></a>03569    <span class="keywordflow">while</span> ( (c = <a class="code" href="pbx_8c.html#709c9b64f2da1eaace237db32a5e1445">ast_walk_contexts</a>(c)) ) {
<a name="l03570"></a>03570       <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *e;
<a name="l03571"></a>03571       <span class="keyword">struct </span><a class="code" href="structast__include.html">ast_include</a> *i;
<a name="l03572"></a>03572       <span class="keyword">struct </span><a class="code" href="structast__ignorepat.html">ast_ignorepat</a> *ip;
<a name="l03573"></a>03573 
<a name="l03574"></a>03574       <span class="keywordflow">if</span> (<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a> &amp;&amp; strcmp(<a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(c), <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>) != 0)
<a name="l03575"></a>03575          <span class="keywordflow">continue</span>;   <span class="comment">/* not the name we want */</span>
<a name="l03576"></a>03576 
<a name="l03577"></a>03577       dpc-&gt;<a class="code" href="structdialplan__counters.html#d83aeff98aa6828baafded23fc65db20">context_existence</a> = 1;
<a name="l03578"></a>03578 
<a name="l03579"></a>03579       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a> &gt; 2)
<a name="l03580"></a>03580          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"manager_show_dialplan: Found Context: %s \n"</span>, <a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(c));
<a name="l03581"></a>03581 
<a name="l03582"></a>03582       <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#a09f0d0ac316a1ae5c74d6958d2b913e">ast_rdlock_context</a>(c)) {  <span class="comment">/* failed to lock */</span>
<a name="l03583"></a>03583          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a> &gt; 2)
<a name="l03584"></a>03584             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"manager_show_dialplan: Failed to lock context\n"</span>);
<a name="l03585"></a>03585          <span class="keywordflow">continue</span>;
<a name="l03586"></a>03586       }
<a name="l03587"></a>03587 
<a name="l03588"></a>03588       <span class="comment">/* XXX note- an empty context is not printed */</span>
<a name="l03589"></a>03589       e = NULL;      <span class="comment">/* walk extensions in context  */</span>
<a name="l03590"></a>03590       <span class="keywordflow">while</span> ( (e = <a class="code" href="pbx_8c.html#b3b7bf8e22da60a0df718a52f3424b79">ast_walk_context_extensions</a>(c, e)) ) {
<a name="l03591"></a>03591          <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *p;
<a name="l03592"></a>03592 
<a name="l03593"></a>03593          <span class="comment">/* looking for extension? is this our extension? */</span>
<a name="l03594"></a>03594          <span class="keywordflow">if</span> (<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a> &amp;&amp; !<a class="code" href="pbx_8c.html#fee4ebd3f1d86114fe9bb33931f9a6cf">ast_extension_match</a>(<a class="code" href="pbx_8c.html#4318ec15d92ac47de94902f6aba4c114">ast_get_extension_name</a>(e), <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>)) {
<a name="l03595"></a>03595             <span class="comment">/* not the one we are looking for, continue */</span>
<a name="l03596"></a>03596             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a> &gt; 2)
<a name="l03597"></a>03597                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"manager_show_dialplan: Skipping extension %s\n"</span>, <a class="code" href="pbx_8c.html#4318ec15d92ac47de94902f6aba4c114">ast_get_extension_name</a>(e));
<a name="l03598"></a>03598             <span class="keywordflow">continue</span>;
<a name="l03599"></a>03599          }
<a name="l03600"></a>03600          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a> &gt; 2)
<a name="l03601"></a>03601             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"manager_show_dialplan: Found Extension: %s \n"</span>, <a class="code" href="pbx_8c.html#4318ec15d92ac47de94902f6aba4c114">ast_get_extension_name</a>(e));
<a name="l03602"></a>03602 
<a name="l03603"></a>03603          dpc-&gt;<a class="code" href="structdialplan__counters.html#bdd2eb943b642d347ef6b674e1e2218c">extension_existence</a> = 1;
<a name="l03604"></a>03604 
<a name="l03605"></a>03605          <span class="comment">/* may we print context info? */</span> 
<a name="l03606"></a>03606          dpc-&gt;<a class="code" href="structdialplan__counters.html#e56cfe3dac1f97235b12888a73e565a8">total_context</a>++;
<a name="l03607"></a>03607          dpc-&gt;<a class="code" href="structdialplan__counters.html#5d114b3c88c5a56e3372542b0505af59">total_exten</a>++;
<a name="l03608"></a>03608 
<a name="l03609"></a>03609          p = NULL;      <span class="comment">/* walk next extension peers */</span>
<a name="l03610"></a>03610          <span class="keywordflow">while</span> ( (p = <a class="code" href="pbx_8c.html#2ae60ad33dfd510584655331ac42b890">ast_walk_extension_priorities</a>(e, p)) ) {
<a name="l03611"></a>03611             <span class="keywordtype">int</span> prio = <a class="code" href="pbx_8c.html#ecebedf381a09dd2630dc03e49b83112">ast_get_extension_priority</a>(p);
<a name="l03612"></a>03612 
<a name="l03613"></a>03613             dpc-&gt;<a class="code" href="structdialplan__counters.html#041d969e041f5ac8328a9422cf8a3cb1">total_prio</a>++;
<a name="l03614"></a>03614             <span class="keywordflow">if</span> (!dpc-&gt;<a class="code" href="structdialplan__counters.html#9c4e8fc926b5698807c4bd065419bc94">total_items</a>++)
<a name="l03615"></a>03615                <a class="code" href="pbx_8c.html#5d6b6ee3b52cfcfe8a3a6d88564dc768">manager_dpsendack</a>(s, m);
<a name="l03616"></a>03616             <a class="code" href="group__Group__AMI.html#gb743ac558357307ea2fdd322561e371b">astman_append</a>(s, <span class="stringliteral">"Event: ListDialplan\r\n%s"</span>, actionidtext);
<a name="l03617"></a>03617             <a class="code" href="group__Group__AMI.html#gb743ac558357307ea2fdd322561e371b">astman_append</a>(s, <span class="stringliteral">"Context: %s\r\nExtension: %s\r\n"</span>, <a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(c), <a class="code" href="pbx_8c.html#4318ec15d92ac47de94902f6aba4c114">ast_get_extension_name</a>(e) );
<a name="l03618"></a>03618 
<a name="l03619"></a>03619             <span class="comment">/* XXX maybe make this conditional, if p != e ? */</span>
<a name="l03620"></a>03620             <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#6647bb905ee41ab599c1e9bfe5f086de">ast_get_extension_label</a>(p))
<a name="l03621"></a>03621                <a class="code" href="group__Group__AMI.html#gb743ac558357307ea2fdd322561e371b">astman_append</a>(s, <span class="stringliteral">"ExtensionLabel: %s\r\n"</span>, <a class="code" href="pbx_8c.html#6647bb905ee41ab599c1e9bfe5f086de">ast_get_extension_label</a>(p));
<a name="l03622"></a>03622 
<a name="l03623"></a>03623             <span class="keywordflow">if</span> (prio == <a class="code" href="pbx_8h.html#ab1e94ec9073ecc8bcedd7b11dd82001">PRIORITY_HINT</a>) {
<a name="l03624"></a>03624                <a class="code" href="group__Group__AMI.html#gb743ac558357307ea2fdd322561e371b">astman_append</a>(s, <span class="stringliteral">"Priority: hint\r\nApplication: %s\r\n"</span>, <a class="code" href="pbx_8c.html#c8eaa4fc248390fee258e7d2b2ff3490">ast_get_extension_app</a>(p));
<a name="l03625"></a>03625             } <span class="keywordflow">else</span> {
<a name="l03626"></a>03626                <a class="code" href="group__Group__AMI.html#gb743ac558357307ea2fdd322561e371b">astman_append</a>(s, <span class="stringliteral">"Priority: %d\r\nApplication: %s\r\nAppData: %s\r\n"</span>, prio, <a class="code" href="pbx_8c.html#c8eaa4fc248390fee258e7d2b2ff3490">ast_get_extension_app</a>(p), (<span class="keywordtype">char</span> *) <a class="code" href="pbx_8c.html#4a723bd9d782fe0a3fb16d00268ec5a4">ast_get_extension_app_data</a>(p));
<a name="l03627"></a>03627             }
<a name="l03628"></a>03628             <a class="code" href="group__Group__AMI.html#gb743ac558357307ea2fdd322561e371b">astman_append</a>(s, <span class="stringliteral">"Registrar: %s\r\n\r\n"</span>, <a class="code" href="pbx_8c.html#20537e2517918a112d0b738d8c70cae2">ast_get_extension_registrar</a>(e));
<a name="l03629"></a>03629          }
<a name="l03630"></a>03630       }
<a name="l03631"></a>03631 
<a name="l03632"></a>03632       i = NULL;      <span class="comment">/* walk included and write info ... */</span>
<a name="l03633"></a>03633       <span class="keywordflow">while</span> ( (i = <a class="code" href="pbx_8c.html#ff52371424397442d32568beb910e153">ast_walk_context_includes</a>(c, i)) ) {
<a name="l03634"></a>03634          <span class="keywordflow">if</span> (<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>) {
<a name="l03635"></a>03635             <span class="comment">/* Check all includes for the requested extension */</span>
<a name="l03636"></a>03636             <a class="code" href="pbx_8c.html#1c7815f40dc8d76231a9aaa789b60de0">manager_show_dialplan_helper</a>(s, m, actionidtext, <a class="code" href="pbx_8c.html#04500f482fe3f27ee84f53c832f49c92">ast_get_include_name</a>(i), exten, dpc, i);
<a name="l03637"></a>03637          } <span class="keywordflow">else</span> {
<a name="l03638"></a>03638             <span class="keywordflow">if</span> (!dpc-&gt;<a class="code" href="structdialplan__counters.html#9c4e8fc926b5698807c4bd065419bc94">total_items</a>++)
<a name="l03639"></a>03639                <a class="code" href="pbx_8c.html#5d6b6ee3b52cfcfe8a3a6d88564dc768">manager_dpsendack</a>(s, m);
<a name="l03640"></a>03640             <a class="code" href="group__Group__AMI.html#gb743ac558357307ea2fdd322561e371b">astman_append</a>(s, <span class="stringliteral">"Event: ListDialplan\r\n%s"</span>, actionidtext);
<a name="l03641"></a>03641             <a class="code" href="group__Group__AMI.html#gb743ac558357307ea2fdd322561e371b">astman_append</a>(s, <span class="stringliteral">"Context: %s\r\nIncludeContext: %s\r\nRegistrar: %s\r\n"</span>, <a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(c), <a class="code" href="pbx_8c.html#04500f482fe3f27ee84f53c832f49c92">ast_get_include_name</a>(i), <a class="code" href="pbx_8c.html#a10e2a34982bf1e3c4df8fbf94a8f858">ast_get_include_registrar</a>(i));
<a name="l03642"></a>03642             <a class="code" href="group__Group__AMI.html#gb743ac558357307ea2fdd322561e371b">astman_append</a>(s, <span class="stringliteral">"\r\n"</span>);
<a name="l03643"></a>03643             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a> &gt; 2)
<a name="l03644"></a>03644                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"manager_show_dialplan: Found Included context: %s \n"</span>, <a class="code" href="pbx_8c.html#04500f482fe3f27ee84f53c832f49c92">ast_get_include_name</a>(i));
<a name="l03645"></a>03645          }
<a name="l03646"></a>03646       }
<a name="l03647"></a>03647 
<a name="l03648"></a>03648       ip = NULL;  <span class="comment">/* walk ignore patterns and write info ... */</span>
<a name="l03649"></a>03649       <span class="keywordflow">while</span> ( (ip = <a class="code" href="pbx_8c.html#78f92771f39acc0696f7d12053ff4304">ast_walk_context_ignorepats</a>(c, ip)) ) {
<a name="l03650"></a>03650          <span class="keyword">const</span> <span class="keywordtype">char</span> *ipname = <a class="code" href="pbx_8c.html#8362b5fbecbf06d68596f1361a817971">ast_get_ignorepat_name</a>(ip);
<a name="l03651"></a>03651          <span class="keywordtype">char</span> ignorepat[<a class="code" href="channel_8h.html#729d25558b5b1940c1a6ff9d806f944c">AST_MAX_EXTENSION</a>];
<a name="l03652"></a>03652 
<a name="l03653"></a>03653          snprintf(ignorepat, <span class="keyword">sizeof</span>(ignorepat), <span class="stringliteral">"_%s."</span>, ipname);
<a name="l03654"></a>03654          <span class="keywordflow">if</span> (!exten || <a class="code" href="pbx_8c.html#fee4ebd3f1d86114fe9bb33931f9a6cf">ast_extension_match</a>(ignorepat, exten)) {
<a name="l03655"></a>03655             <span class="keywordflow">if</span> (!dpc-&gt;<a class="code" href="structdialplan__counters.html#9c4e8fc926b5698807c4bd065419bc94">total_items</a>++)
<a name="l03656"></a>03656                <a class="code" href="pbx_8c.html#5d6b6ee3b52cfcfe8a3a6d88564dc768">manager_dpsendack</a>(s, m);
<a name="l03657"></a>03657             <a class="code" href="group__Group__AMI.html#gb743ac558357307ea2fdd322561e371b">astman_append</a>(s, <span class="stringliteral">"Event: ListDialplan\r\n%s"</span>, actionidtext);
<a name="l03658"></a>03658             <a class="code" href="group__Group__AMI.html#gb743ac558357307ea2fdd322561e371b">astman_append</a>(s, <span class="stringliteral">"Context: %s\r\nIgnorePattern: %s\r\nRegistrar: %s\r\n"</span>, <a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(c), ipname, <a class="code" href="pbx_8c.html#ecf759381e5bb2d13dbf2188d6728217">ast_get_ignorepat_registrar</a>(ip));
<a name="l03659"></a>03659             <a class="code" href="group__Group__AMI.html#gb743ac558357307ea2fdd322561e371b">astman_append</a>(s, <span class="stringliteral">"\r\n"</span>);
<a name="l03660"></a>03660          }
<a name="l03661"></a>03661       }
<a name="l03662"></a>03662       <span class="keywordflow">if</span> (!rinclude) {
<a name="l03663"></a>03663          <span class="keyword">struct </span><a class="code" href="structast__sw.html">ast_sw</a> *sw = NULL;
<a name="l03664"></a>03664          <span class="keywordflow">while</span> ( (sw = <a class="code" href="pbx_8c.html#6cbdae284c7bcff5b16d687a1f60b61b">ast_walk_context_switches</a>(c, sw)) ) {
<a name="l03665"></a>03665             <span class="keywordflow">if</span> (!dpc-&gt;<a class="code" href="structdialplan__counters.html#9c4e8fc926b5698807c4bd065419bc94">total_items</a>++)
<a name="l03666"></a>03666                <a class="code" href="pbx_8c.html#5d6b6ee3b52cfcfe8a3a6d88564dc768">manager_dpsendack</a>(s, m);
<a name="l03667"></a>03667             <a class="code" href="group__Group__AMI.html#gb743ac558357307ea2fdd322561e371b">astman_append</a>(s, <span class="stringliteral">"Event: ListDialplan\r\n%s"</span>, actionidtext);
<a name="l03668"></a>03668             <a class="code" href="group__Group__AMI.html#gb743ac558357307ea2fdd322561e371b">astman_append</a>(s, <span class="stringliteral">"Context: %s\r\nSwitch: %s/%s\r\nRegistrar: %s\r\n"</span>, <a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(c), <a class="code" href="pbx_8c.html#e78e1da5bf7f86cd550128a0cc440658">ast_get_switch_name</a>(sw), <a class="code" href="pbx_8c.html#ee960249076eea022f3aaa855b0a2475">ast_get_switch_data</a>(sw), <a class="code" href="pbx_8c.html#6e9fbaaa189820f4a0c36a1ad4dfca6d">ast_get_switch_registrar</a>(sw));  
<a name="l03669"></a>03669             <a class="code" href="group__Group__AMI.html#gb743ac558357307ea2fdd322561e371b">astman_append</a>(s, <span class="stringliteral">"\r\n"</span>);
<a name="l03670"></a>03670             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a> &gt; 2)
<a name="l03671"></a>03671                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"manager_show_dialplan: Found Switch : %s \n"</span>, <a class="code" href="pbx_8c.html#e78e1da5bf7f86cd550128a0cc440658">ast_get_switch_name</a>(sw));
<a name="l03672"></a>03672          }
<a name="l03673"></a>03673       }
<a name="l03674"></a>03674 
<a name="l03675"></a>03675       <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(c);
<a name="l03676"></a>03676    }
<a name="l03677"></a>03677    <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l03678"></a>03678 
<a name="l03679"></a>03679    <span class="keywordflow">if</span> (dpc-&gt;<a class="code" href="structdialplan__counters.html#5d114b3c88c5a56e3372542b0505af59">total_exten</a> == old_total_exten) {
<a name="l03680"></a>03680       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a> &gt; 2)
<a name="l03681"></a>03681          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"manager_show_dialplan: Found nothing new\n"</span>);
<a name="l03682"></a>03682       <span class="comment">/* Nothing new under the sun */</span>
<a name="l03683"></a>03683       <span class="keywordflow">return</span> -1;
<a name="l03684"></a>03684    } <span class="keywordflow">else</span> {
<a name="l03685"></a>03685       <span class="keywordflow">return</span> res;
<a name="l03686"></a>03686    }
<a name="l03687"></a>03687 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="fba0369f208e3a6a1ae37ed883985304"></a><!-- doxytag: member="pbx.c::matchcid" ref="fba0369f208e3a6a1ae37ed883985304" args="(const char *cidpattern, const char *callerid)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int matchcid           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cidpattern</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>callerid</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00907">907</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00877">ast_extension_match()</a>, and <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>.<div class="fragment"><pre class="fragment"><a name="l00908"></a>00908 {
<a name="l00909"></a>00909    <span class="comment">/* If the Caller*ID pattern is empty, then we're matching NO Caller*ID, so</span>
<a name="l00910"></a>00910 <span class="comment">      failing to get a number should count as a match, otherwise not */</span>
<a name="l00911"></a>00911 
<a name="l00912"></a>00912    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(callerid))
<a name="l00913"></a>00913       <span class="keywordflow">return</span> <a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(cidpattern) ? 1 : 0;
<a name="l00914"></a>00914 
<a name="l00915"></a>00915    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#fee4ebd3f1d86114fe9bb33931f9a6cf">ast_extension_match</a>(cidpattern, callerid);
<a name="l00916"></a>00916 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1f596dad2120f1ef7d9cceea084686cc"></a><!-- doxytag: member="pbx.c::parse_variable_name" ref="1f596dad2120f1ef7d9cceea084686cc" args="(char *var, int *offset, int *length, int *isfunc)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int parse_variable_name           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>var</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>offset</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>isfunc</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
extract offset:length from variable name. Returns 1 if there is a offset:length part, which is trimmed off (values go into variables) 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01060">1060</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l01132">pbx_retrieve_variable()</a>, and <a class="el" href="pbx_8c-source.html#l01468">pbx_substitute_variables_helper_full()</a>.<div class="fragment"><pre class="fragment"><a name="l01061"></a>01061 {
<a name="l01062"></a>01062    <span class="keywordtype">int</span> parens=0;
<a name="l01063"></a>01063 
<a name="l01064"></a>01064    *<a class="code" href="chan__alsa_8c.html#7a86c157ee9713c34fbd7a1ee40f0c5a">offset</a> = 0;
<a name="l01065"></a>01065    *length = INT_MAX;
<a name="l01066"></a>01066    *isfunc = 0;
<a name="l01067"></a>01067    <span class="keywordflow">for</span> (; *<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>; <a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>++) {
<a name="l01068"></a>01068       <span class="keywordflow">if</span> (*<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a> == <span class="charliteral">'('</span>) {
<a name="l01069"></a>01069          (*isfunc)++;
<a name="l01070"></a>01070          parens++;
<a name="l01071"></a>01071       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a> == <span class="charliteral">')'</span>) {
<a name="l01072"></a>01072          parens--;
<a name="l01073"></a>01073       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a> == <span class="charliteral">':'</span> &amp;&amp; parens == 0) {
<a name="l01074"></a>01074          *<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>++ = <span class="charliteral">'\0'</span>;
<a name="l01075"></a>01075          sscanf(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"%d:%d"</span>, <a class="code" href="chan__alsa_8c.html#7a86c157ee9713c34fbd7a1ee40f0c5a">offset</a>, length);
<a name="l01076"></a>01076          <span class="keywordflow">return</span> 1; <span class="comment">/* offset:length valid */</span>
<a name="l01077"></a>01077       }
<a name="l01078"></a>01078    }
<a name="l01079"></a>01079    <span class="keywordflow">return</span> 0;
<a name="l01080"></a>01080 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="70b34943ce7b4a596f724e9d2e5463f6"></a><!-- doxytag: member="pbx.c::pbx_builtin_clear_globals" ref="70b34943ce7b4a596f724e9d2e5463f6" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pbx_builtin_clear_globals           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05937">5937</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00710">AST_LIST_REMOVE_HEAD</a>, <a class="el" href="lock_8h-source.html#l00637">ast_rwlock_unlock()</a>, <a class="el" href="lock_8h-source.html#l00652">ast_rwlock_wrlock()</a>, and <a class="el" href="chanvars_8c-source.html#l00056">ast_var_delete()</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01271">handle_reload_extensions()</a>, and <a class="el" href="pbx__config_8c-source.html#l01627">reload()</a>.<div class="fragment"><pre class="fragment"><a name="l05938"></a>05938 {
<a name="l05939"></a>05939    <span class="keyword">struct </span><a class="code" href="structast__var__t.html">ast_var_t</a> *vardata;
<a name="l05940"></a>05940 
<a name="l05941"></a>05941    <a class="code" href="lock_8h.html#25d2e851f878ee9a64d36b67b67ede6e">ast_rwlock_wrlock</a>(&amp;globalslock);
<a name="l05942"></a>05942    <span class="keywordflow">while</span> ((vardata = <a class="code" href="linkedlists_8h.html#beec347da29fe6b0d7fdb3e80b851f90">AST_LIST_REMOVE_HEAD</a>(&amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>, entries)))
<a name="l05943"></a>05943       <a class="code" href="chanvars_8c.html#32e018d32324bab845a9cac601c175d8">ast_var_delete</a>(vardata);
<a name="l05944"></a>05944    <a class="code" href="lock_8h.html#97ed909ef0a0582cf3870dd0629852c8">ast_rwlock_unlock</a>(&amp;globalslock);
<a name="l05945"></a>05945 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="944d18aa90701f025b30e63d9644e448"></a><!-- doxytag: member="pbx.c::pbx_builtin_getvar_helper" ref="944d18aa90701f025b30e63d9644e448" args="(struct ast_channel *chan, const char *name)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* pbx_builtin_getvar_helper           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05762">5762</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="lock_8h-source.html#l00642">ast_rwlock_rdlock()</a>, <a class="el" href="lock_8h-source.html#l00637">ast_rwlock_unlock()</a>, <a class="el" href="chanvars_8c-source.html#l00062">ast_var_name()</a>, <a class="el" href="chanvars_8c-source.html#l00082">ast_var_value()</a>, and <a class="el" href="channel_8h-source.html#l00467">ast_channel::varshead</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>, <a class="el" href="chan__agent_8c-source.html#l01763">__login_exec()</a>, <a class="el" href="app__macro_8c-source.html#l00144">_macro_exec()</a>, <a class="el" href="app__while_8c-source.html#l00164">_while_exec()</a>, <a class="el" href="chan__iax2_8c-source.html#l06597">acf_iaxvar_read()</a>, <a class="el" href="chan__agent_8c-source.html#l00717">agent_hangup()</a>, <a class="el" href="chan__agent_8c-source.html#l00427">agent_read()</a>, <a class="el" href="chan__agent_8c-source.html#l02207">agentmonitoroutgoing_exec()</a>, <a class="el" href="func__strings_8c-source.html#l00204">array()</a>, <a class="el" href="res__features_8c-source.html#l01478">ast_bridge_call()</a>, <a class="el" href="res__features_8c-source.html#l01194">ast_feature_interpret()</a>, <a class="el" href="res__monitor_8c-source.html#l00254">ast_monitor_stop()</a>, <a class="el" href="res__features_8c-source.html#l00342">ast_park_call()</a>, <a class="el" href="res__features_8c-source.html#l00562">builtin_automonitor()</a>, <a class="el" href="res__features_8c-source.html#l00192">check_goto_on_transfer()</a>, <a class="el" href="app__chanspy_8c-source.html#l00465">common_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l01350">conf_run()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="app__dial_8c-source.html#l00430">do_forward()</a>, <a class="el" href="app__dial_8c-source.html#l00839">do_timelimit()</a>, <a class="el" href="pbx__dundi_8c-source.html#l04479">dundi_exec()</a>, <a class="el" href="pbx__dundi_8c-source.html#l04430">dundi_helper()</a>, <a class="el" href="chan__sip_8c-source.html#l09533">get_also_info()</a>, <a class="el" href="app__while_8c-source.html#l00081">get_index()</a>, <a class="el" href="chan__sip_8c-source.html#l09372">get_refer_info()</a>, <a class="el" href="func__global_8c-source.html#l00043">global_read()</a>, <a class="el" href="func__strings_8c-source.html#l00316">hash_read()</a>, <a class="el" href="chan__iax2_8c-source.html#l09890">iax2_exec()</a>, <a class="el" href="chan__misdn_8c-source.html#l03679">import_ch()</a>, <a class="el" href="app__voicemail_8c-source.html#l02956">leave_voicemail()</a>, <a class="el" href="chan__local_8c-source.html#l00488">local_hangup()</a>, <a class="el" href="app__minivm_8c-source.html#l02021">minivm_delete_exec()</a>, <a class="el" href="app__minivm_8c-source.html#l01673">minivm_notify_exec()</a>, <a class="el" href="chan__misdn_8c-source.html#l02107">misdn_answer()</a>, <a class="el" href="chan__misdn_8c-source.html#l02376">misdn_hangup()</a>, <a class="el" href="app__morsecode_8c-source.html#l00109">morsecode_exec()</a>, <a class="el" href="app__minivm_8c-source.html#l01427">notify_new_message()</a>, <a class="el" href="chan__h323_8c-source.html#l00594">oh323_call()</a>, <a class="el" href="chan__h323_8c-source.html#l00696">oh323_hangup()</a>, <a class="el" href="app__directed__pickup_8c-source.html#l00113">pickup_by_mark()</a>, <a class="el" href="app__queue_8c-source.html#l03443">queue_exec()</a>, <a class="el" href="res__features_8c-source.html#l00661">real_ctx()</a>, <a class="el" href="app__dial_8c-source.html#l01747">retrydial_exec()</a>, <a class="el" href="res__agi_8c-source.html#l01833">run_agi()</a>, <a class="el" href="res__features_8c-source.html#l01252">set_config_flags()</a>, <a class="el" href="chan__sip_8c-source.html#l18113">sip_addheader()</a>, <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>, <a class="el" href="chan__sip_8c-source.html#l03836">try_suggested_sip_codec()</a>, <a class="el" href="app__dial_8c-source.html#l00532">wait_for_answer()</a>, <a class="el" href="chan__zap_8c-source.html#l01923">zt_call()</a>, and <a class="el" href="chan__zap_8c-source.html#l02612">zt_hangup()</a>.<div class="fragment"><pre class="fragment"><a name="l05763"></a>05763 {
<a name="l05764"></a>05764    <span class="keyword">struct </span><a class="code" href="structast__var__t.html">ast_var_t</a> *variables;
<a name="l05765"></a>05765    <span class="keyword">const</span> <span class="keywordtype">char</span> *ret = NULL;
<a name="l05766"></a>05766    <span class="keywordtype">int</span> i;
<a name="l05767"></a>05767    <span class="keyword">struct </span>varshead *places[2] = { NULL, &amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a> };
<a name="l05768"></a>05768 
<a name="l05769"></a>05769    <span class="keywordflow">if</span> (!<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>)
<a name="l05770"></a>05770       <span class="keywordflow">return</span> NULL;
<a name="l05771"></a>05771    <span class="keywordflow">if</span> (chan)
<a name="l05772"></a>05772       places[0] = &amp;chan-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>;
<a name="l05773"></a>05773 
<a name="l05774"></a>05774    <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++) {
<a name="l05775"></a>05775       <span class="keywordflow">if</span> (!places[i])
<a name="l05776"></a>05776          <span class="keywordflow">continue</span>;
<a name="l05777"></a>05777       <span class="keywordflow">if</span> (places[i] == &amp;globals)
<a name="l05778"></a>05778          <a class="code" href="lock_8h.html#f4b8158bcd471d4f28b380768e3ee073">ast_rwlock_rdlock</a>(&amp;globalslock);
<a name="l05779"></a>05779       <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(places[i], variables, entries) {
<a name="l05780"></a>05780          <span class="keywordflow">if</span> (!strcmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <a class="code" href="chanvars_8c.html#29d40dfad3c6b59de315b3a0d2ed0a23">ast_var_name</a>(variables))) {
<a name="l05781"></a>05781             ret = <a class="code" href="chanvars_8c.html#6aa089cff5424a26ade21a520e443f82">ast_var_value</a>(variables);
<a name="l05782"></a>05782             <span class="keywordflow">break</span>;
<a name="l05783"></a>05783          }
<a name="l05784"></a>05784       }
<a name="l05785"></a>05785       <span class="keywordflow">if</span> (places[i] == &amp;globals)
<a name="l05786"></a>05786          <a class="code" href="lock_8h.html#97ed909ef0a0582cf3870dd0629852c8">ast_rwlock_unlock</a>(&amp;globalslock);
<a name="l05787"></a>05787       <span class="keywordflow">if</span> (ret)
<a name="l05788"></a>05788          <span class="keywordflow">break</span>;
<a name="l05789"></a>05789    }
<a name="l05790"></a>05790 
<a name="l05791"></a>05791    <span class="keywordflow">return</span> ret;
<a name="l05792"></a>05792 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="f817fed49da112575f6b5e0c39a386fc"></a><!-- doxytag: member="pbx.c::pbx_builtin_gotoif" ref="f817fed49da112575f6b5e0c39a386fc" args="(struct ast_channel *, void *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int pbx_builtin_gotoif           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05957">5957</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="pbx_8c-source.html#l05725">pbx_builtin_goto()</a>, <a class="el" href="pbx_8c-source.html#l05947">pbx_checkcondition()</a>, and <a class="el" href="strcompat_8c-source.html#l00035">strsep()</a>.<div class="fragment"><pre class="fragment"><a name="l05958"></a>05958 {
<a name="l05959"></a>05959    <span class="keywordtype">char</span> *condition, *branch1, *branch2, *branch;
<a name="l05960"></a>05960    <span class="keywordtype">int</span> rc;
<a name="l05961"></a>05961    <span class="keywordtype">char</span> *stringp;
<a name="l05962"></a>05962 
<a name="l05963"></a>05963    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(data)) {
<a name="l05964"></a>05964       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Ignoring, since there is no variable to check\n"</span>);
<a name="l05965"></a>05965       <span class="keywordflow">return</span> 0;
<a name="l05966"></a>05966    }
<a name="l05967"></a>05967 
<a name="l05968"></a>05968    stringp = <a class="code" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>(data);
<a name="l05969"></a>05969    condition = <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;stringp,<span class="stringliteral">"?"</span>);
<a name="l05970"></a>05970    branch1 = <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;stringp,<span class="stringliteral">":"</span>);
<a name="l05971"></a>05971    branch2 = <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;stringp,<span class="stringliteral">""</span>);
<a name="l05972"></a>05972    branch = <a class="code" href="pbx_8c.html#356fc557c1fe7c36e2773ba403e7625a">pbx_checkcondition</a>(condition) ? branch1 : branch2;
<a name="l05973"></a>05973 
<a name="l05974"></a>05974    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(branch)) {
<a name="l05975"></a>05975       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l05976"></a>05976          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Not taking any branch\n"</span>);
<a name="l05977"></a>05977       <span class="keywordflow">return</span> 0;
<a name="l05978"></a>05978    }
<a name="l05979"></a>05979 
<a name="l05980"></a>05980    rc = <a class="code" href="group__applications.html#g810e6cb9f297016b6c6e22171fba4458">pbx_builtin_goto</a>(chan, branch);
<a name="l05981"></a>05981 
<a name="l05982"></a>05982    <span class="keywordflow">return</span> rc;
<a name="l05983"></a>05983 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="9072e12e84cb5f0e0377791e417a6ee6"></a><!-- doxytag: member="pbx.c::pbx_builtin_importvar" ref="9072e12e84cb5f0e0377791e417a6ee6" args="(struct ast_channel *, void *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int pbx_builtin_importvar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>XXX should do !ast_strlen_zero(..) of the args ? </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05901">5901</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="channel_8c-source.html#l00995">ast_get_channel_by_name_locked()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="pbx_8c-source.html#l05821">pbx_builtin_setvar_helper()</a>, <a class="el" href="pbx_8c-source.html#l01660">pbx_substitute_variables_helper()</a>, <a class="el" href="aesopt_8h-source.html#l00399">s</a>, <a class="el" href="strcompat_8c-source.html#l00035">strsep()</a>, and <a class="el" href="pbx_8c-source.html#l00085">VAR_BUF_SIZE</a>.<div class="fragment"><pre class="fragment"><a name="l05902"></a>05902 {
<a name="l05903"></a>05903    <span class="keywordtype">char</span> *<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>;
<a name="l05904"></a>05904    <span class="keywordtype">char</span> *value;
<a name="l05905"></a>05905    <span class="keywordtype">char</span> *channel;
<a name="l05906"></a>05906    <span class="keywordtype">char</span> tmp[<a class="code" href="pbx_8c.html#970eeb66b59dcceec190d4d3147cb12f">VAR_BUF_SIZE</a>]=<span class="stringliteral">""</span>;
<a name="l05907"></a>05907 
<a name="l05908"></a>05908    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(data)) {
<a name="l05909"></a>05909       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Ignoring, since there is no variable to set\n"</span>);
<a name="l05910"></a>05910       <span class="keywordflow">return</span> 0;
<a name="l05911"></a>05911    }
<a name="l05912"></a>05912 
<a name="l05913"></a>05913    value = <a class="code" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>(data);
<a name="l05914"></a>05914    name = <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;value,<span class="stringliteral">"="</span>);
<a name="l05915"></a>05915    channel = <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;value,<span class="stringliteral">"|"</span>);
<a name="l05916"></a>05916    <span class="keywordflow">if</span> (channel &amp;&amp; value &amp;&amp; name) { <span class="comment">/*! \todo XXX should do !ast_strlen_zero(..) of the args ? */</span>
<a name="l05917"></a>05917       <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *chan2 = <a class="code" href="channel_8c.html#e01fecb172f34785571d94adbc5c6558">ast_get_channel_by_name_locked</a>(channel);
<a name="l05918"></a>05918       <span class="keywordflow">if</span> (chan2) {
<a name="l05919"></a>05919          <span class="keywordtype">char</span> *<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a> = alloca(strlen(value) + 4);
<a name="l05920"></a>05920          <span class="keywordflow">if</span> (s) {
<a name="l05921"></a>05921             sprintf(s, <span class="stringliteral">"${%s}"</span>, value);
<a name="l05922"></a>05922             <a class="code" href="pbx_8c.html#7f62e5d5f926a2eeedb559b6afd3d80a">pbx_substitute_variables_helper</a>(chan2, s, tmp, <span class="keyword">sizeof</span>(tmp) - 1);
<a name="l05923"></a>05923          }
<a name="l05924"></a>05924          <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan2);
<a name="l05925"></a>05925       }
<a name="l05926"></a>05926       <a class="code" href="pbx_8c.html#64407c916a2de6ae3f0efeca471c1b1d">pbx_builtin_setvar_helper</a>(chan, name, tmp);
<a name="l05927"></a>05927    }
<a name="l05928"></a>05928 
<a name="l05929"></a>05929    <span class="keywordflow">return</span>(0);
<a name="l05930"></a>05930 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="63e6b36cd0848b527b0f14db5dd8d3e4"></a><!-- doxytag: member="pbx.c::pbx_builtin_noop" ref="63e6b36cd0848b527b0f14db5dd8d3e4" args="(struct ast_channel *, void *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int pbx_builtin_noop           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05932">5932</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.<div class="fragment"><pre class="fragment"><a name="l05933"></a>05933 {
<a name="l05934"></a>05934    <span class="keywordflow">return</span> 0;
<a name="l05935"></a>05935 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="314bde51a938aa39daab1c3379eed3c7"></a><!-- doxytag: member="pbx.c::pbx_builtin_pushvar_helper" ref="314bde51a938aa39daab1c3379eed3c7" args="(struct ast_channel *chan, const char *name, const char *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pbx_builtin_pushvar_helper           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05794">5794</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l01452">ast_func_write()</a>, <a class="el" href="linkedlists_8h-source.html#l00650">AST_LIST_INSERT_HEAD</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="lock_8h-source.html#l00637">ast_rwlock_unlock()</a>, <a class="el" href="lock_8h-source.html#l00652">ast_rwlock_wrlock()</a>, <a class="el" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>, <a class="el" href="chanvars_8c-source.html#l00039">ast_var_assign()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="channel_8h-source.html#l00467">ast_channel::varshead</a>, and <a class="el" href="logger_8h-source.html#l00044">VERBOSE_PREFIX_2</a>.
<p>
Referenced by <a class="el" href="func__odbc_8c-source.html#l00199">acf_odbc_read()</a>, <a class="el" href="func__odbc_8c-source.html#l00099">acf_odbc_write()</a>, and <a class="el" href="app__stack_8c-source.html#l00193">gosub_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l05795"></a>05795 {
<a name="l05796"></a>05796    <span class="keyword">struct </span><a class="code" href="structast__var__t.html">ast_var_t</a> *newvariable;
<a name="l05797"></a>05797    <span class="keyword">struct </span>varshead *headp;
<a name="l05798"></a>05798 
<a name="l05799"></a>05799    <span class="keywordflow">if</span> (<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>[strlen(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>)-1] == <span class="charliteral">')'</span>) {
<a name="l05800"></a>05800       <span class="keywordtype">char</span> *function = <a class="code" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>(name);
<a name="l05801"></a>05801 
<a name="l05802"></a>05802       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Cannot push a value onto a function\n"</span>);
<a name="l05803"></a>05803       <a class="code" href="pbx_8c.html#2432c0e88181cb3ba2c1a2764b0a6238">ast_func_write</a>(chan, function, value);
<a name="l05804"></a>05804       <span class="keywordflow">return</span>;
<a name="l05805"></a>05805    }
<a name="l05806"></a>05806 
<a name="l05807"></a>05807    headp = (chan) ? &amp;chan-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a> : &amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>;
<a name="l05808"></a>05808 
<a name="l05809"></a>05809    if (value) {
<a name="l05810"></a>05810       <span class="keywordflow">if</span> ((<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 1) &amp;&amp; (headp == &amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>))
<a name="l05811"></a>05811          <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Setting global variable '%s' to '%s'\n"</span>, name, value);
<a name="l05812"></a>05812       newvariable = <a class="code" href="chanvars_8c.html#4d0028e2dbd755ae38d2fe4204ad9071">ast_var_assign</a>(name, value);
<a name="l05813"></a>05813       <span class="keywordflow">if</span> (headp == &amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>)
<a name="l05814"></a>05814          <a class="code" href="lock_8h.html#25d2e851f878ee9a64d36b67b67ede6e">ast_rwlock_wrlock</a>(&amp;globalslock);
<a name="l05815"></a>05815       <a class="code" href="linkedlists_8h.html#5df56040a8838bdc841ef8eb179b7609">AST_LIST_INSERT_HEAD</a>(headp, newvariable, entries);
<a name="l05816"></a>05816       <span class="keywordflow">if</span> (headp == &amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>)
<a name="l05817"></a>05817          <a class="code" href="lock_8h.html#97ed909ef0a0582cf3870dd0629852c8">ast_rwlock_unlock</a>(&amp;globalslock);
<a name="l05818"></a>05818    }
<a name="l05819"></a>05819 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3e3753e8824cad0efc44f031897f3bae"></a><!-- doxytag: member="pbx.c::pbx_builtin_saycharacters" ref="3e3753e8824cad0efc44f031897f3bae" args="(struct ast_channel *, void *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int pbx_builtin_saycharacters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06017">6017</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l04861">ast_say_character_str()</a>.<div class="fragment"><pre class="fragment"><a name="l06018"></a>06018 {
<a name="l06019"></a>06019    <span class="keywordtype">int</span> res = 0;
<a name="l06020"></a>06020 
<a name="l06021"></a>06021    <span class="keywordflow">if</span> (data)
<a name="l06022"></a>06022       res = <a class="code" href="channel_8c.html#21b43fd85379f13bafbc47156bceebbb">ast_say_character_str</a>(chan, data, <span class="stringliteral">""</span>, chan-&gt;language);
<a name="l06023"></a>06023    <span class="keywordflow">return</span> res;
<a name="l06024"></a>06024 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="f76465f331191d8cea145d9882cad42b"></a><!-- doxytag: member="pbx.c::pbx_builtin_saydigits" ref="f76465f331191d8cea145d9882cad42b" args="(struct ast_channel *, void *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int pbx_builtin_saydigits           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06008">6008</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l04855">ast_say_digit_str()</a>.<div class="fragment"><pre class="fragment"><a name="l06009"></a>06009 {
<a name="l06010"></a>06010    <span class="keywordtype">int</span> res = 0;
<a name="l06011"></a>06011 
<a name="l06012"></a>06012    <span class="keywordflow">if</span> (data)
<a name="l06013"></a>06013       res = <a class="code" href="channel_8c.html#39bff415a7dcb7271c386495e8f90984">ast_say_digit_str</a>(chan, data, <span class="stringliteral">""</span>, chan-&gt;language);
<a name="l06014"></a>06014    <span class="keywordflow">return</span> res;
<a name="l06015"></a>06015 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="eb3b4ee4e253d22d78e69093838bbb6f"></a><!-- doxytag: member="pbx.c::pbx_builtin_saynumber" ref="eb3b4ee4e253d22d78e69093838bbb6f" args="(struct ast_channel *, void *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int pbx_builtin_saynumber           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05985">5985</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="channel_8c-source.html#l04837">ast_say_number()</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, and <a class="el" href="strcompat_8c-source.html#l00035">strsep()</a>.<div class="fragment"><pre class="fragment"><a name="l05986"></a>05986 {
<a name="l05987"></a>05987    <span class="keywordtype">char</span> tmp[256];
<a name="l05988"></a>05988    <span class="keywordtype">char</span> *<a class="code" href="structnumber.html">number</a> = tmp;
<a name="l05989"></a>05989    <span class="keywordtype">char</span> *options;
<a name="l05990"></a>05990 
<a name="l05991"></a>05991    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(data)) {
<a name="l05992"></a>05992       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"SayNumber requires an argument (number)\n"</span>);
<a name="l05993"></a>05993       <span class="keywordflow">return</span> -1;
<a name="l05994"></a>05994    }
<a name="l05995"></a>05995    ast_copy_string(tmp, data, <span class="keyword">sizeof</span>(tmp));
<a name="l05996"></a>05996    <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;number, <span class="stringliteral">"|"</span>);
<a name="l05997"></a>05997    options = <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;number, <span class="stringliteral">"|"</span>);
<a name="l05998"></a>05998    <span class="keywordflow">if</span> (options) {
<a name="l05999"></a>05999       <span class="keywordflow">if</span> ( strcasecmp(options, <span class="stringliteral">"f"</span>) &amp;&amp; strcasecmp(options,<span class="stringliteral">"m"</span>) &amp;&amp;
<a name="l06000"></a>06000          strcasecmp(options, <span class="stringliteral">"c"</span>) &amp;&amp; strcasecmp(options, <span class="stringliteral">"n"</span>) ) {
<a name="l06001"></a>06001          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"SayNumber gender option is either 'f', 'm', 'c' or 'n'\n"</span>);
<a name="l06002"></a>06002          <span class="keywordflow">return</span> -1;
<a name="l06003"></a>06003       }
<a name="l06004"></a>06004    }
<a name="l06005"></a>06005    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#ae819935343a14b1f61b331ff85fc214">ast_say_number</a>(chan, atoi(tmp), <span class="stringliteral">""</span>, chan-&gt;language, options);
<a name="l06006"></a>06006 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d8962c3a5e8b928f83bbe27e1af89433"></a><!-- doxytag: member="pbx.c::pbx_builtin_sayphonetic" ref="d8962c3a5e8b928f83bbe27e1af89433" args="(struct ast_channel *, void *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int pbx_builtin_sayphonetic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06026">6026</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l04867">ast_say_phonetic_str()</a>.<div class="fragment"><pre class="fragment"><a name="l06027"></a>06027 {
<a name="l06028"></a>06028    <span class="keywordtype">int</span> res = 0;
<a name="l06029"></a>06029 
<a name="l06030"></a>06030    <span class="keywordflow">if</span> (data)
<a name="l06031"></a>06031       res = <a class="code" href="channel_8c.html#d785e228f61ef3808a94532aa1655d63">ast_say_phonetic_str</a>(chan, data, <span class="stringliteral">""</span>, chan-&gt;language);
<a name="l06032"></a>06032    <span class="keywordflow">return</span> res;
<a name="l06033"></a>06033 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="54b5d868be87581f886aee1b5fed126a"></a><!-- doxytag: member="pbx.c::pbx_builtin_serialize_variables" ref="54b5d868be87581f886aee1b5fed126a" args="(struct ast_channel *chan, struct ast_str **buf)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int pbx_builtin_serialize_variables           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__str.html">ast_str</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05734">5734</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="strings_8h.html#0c00985509b077cfe0ccdd5829342ca4">ast_str_append()</a>, <a class="el" href="chanvars_8c-source.html#l00062">ast_var_name()</a>, <a class="el" href="chanvars_8c-source.html#l00082">ast_var_value()</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, <a class="el" href="res__adsi_8c-source.html#l00943">total</a>, <a class="el" href="ast__expr2f_8c-source.html#l01417">var</a>, and <a class="el" href="channel_8h-source.html#l00467">ast_channel::varshead</a>.
<p>
Referenced by <a class="el" href="app__dumpchan_8c-source.html#l00143">dumpchan_exec()</a>, <a class="el" href="cli_8c-source.html#l00770">handle_showchan()</a>, and <a class="el" href="app__queue_8c-source.html#l01623">vars2manager()</a>.<div class="fragment"><pre class="fragment"><a name="l05735"></a>05735 {
<a name="l05736"></a>05736    <span class="keyword">struct </span><a class="code" href="structast__var__t.html">ast_var_t</a> *variables;
<a name="l05737"></a>05737    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, *<a class="code" href="structval.html">val</a>;
<a name="l05738"></a>05738    <span class="keywordtype">int</span> <a class="code" href="res__adsi_8c.html#fbb44b4487415b134bce9c790a27fe5e">total</a> = 0;
<a name="l05739"></a>05739 
<a name="l05740"></a>05740    <span class="keywordflow">if</span> (!chan)
<a name="l05741"></a>05741       <span class="keywordflow">return</span> 0;
<a name="l05742"></a>05742 
<a name="l05743"></a>05743    (*buf)-&gt;used = 0;
<a name="l05744"></a>05744    (*buf)-&gt;str[0] = <span class="charliteral">'\0'</span>;
<a name="l05745"></a>05745 
<a name="l05746"></a>05746    <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;chan-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>, variables, entries) {
<a name="l05747"></a>05747       <span class="keywordflow">if</span> ((var=<a class="code" href="chanvars_8c.html#29d40dfad3c6b59de315b3a0d2ed0a23">ast_var_name</a>(variables)) &amp;&amp; (val=<a class="code" href="chanvars_8c.html#6aa089cff5424a26ade21a520e443f82">ast_var_value</a>(variables))
<a name="l05748"></a>05748          <span class="comment">/* &amp;&amp; !ast_strlen_zero(var) &amp;&amp; !ast_strlen_zero(val) */</span>
<a name="l05749"></a>05749          ) {
<a name="l05750"></a>05750          <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#0c00985509b077cfe0ccdd5829342ca4">ast_str_append</a>(buf, 0, <span class="stringliteral">"%s=%s\n"</span>, var, val) &lt; 0) {
<a name="l05751"></a>05751             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Data Buffer Size Exceeded!\n"</span>);
<a name="l05752"></a>05752             <span class="keywordflow">break</span>;
<a name="l05753"></a>05753          } <span class="keywordflow">else</span>
<a name="l05754"></a>05754             total++;
<a name="l05755"></a>05755       } <span class="keywordflow">else</span>
<a name="l05756"></a>05756          <span class="keywordflow">break</span>;
<a name="l05757"></a>05757    }
<a name="l05758"></a>05758 
<a name="l05759"></a>05759    <span class="keywordflow">return</span> total;
<a name="l05760"></a>05760 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1fd124882bb88b58dd9474ac0c5f6c4e"></a><!-- doxytag: member="pbx.c::pbx_builtin_setvar" ref="1fd124882bb88b58dd9474ac0c5f6c4e" args="(struct ast_channel *, void *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int pbx_builtin_setvar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05866">5866</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="app_8c-source.html#l00943">ast_app_separate_args()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, and <a class="el" href="pbx_8c-source.html#l05821">pbx_builtin_setvar_helper()</a>.
<p>
Referenced by <a class="el" href="pbx__ael_8c-source.html#l03836">ast_compile_ael2()</a>, <a class="el" href="app__queue_8c-source.html#l03731">queue_function_var()</a>, <a class="el" href="app__queue_8c-source.html#l00455">set_queue_variables()</a>, and <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>.<div class="fragment"><pre class="fragment"><a name="l05867"></a>05867 {
<a name="l05868"></a>05868    <span class="keywordtype">char</span> *<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, *<a class="code" href="structast__var__t.html#2063c1608d6e0baf80249c42e2be5804">value</a>, *mydata;
<a name="l05869"></a>05869    <span class="keywordtype">int</span> argc;
<a name="l05870"></a>05870    <span class="keywordtype">char</span> *argv[24];      <span class="comment">/* this will only support a maximum of 24 variables being set in a single operation */</span>
<a name="l05871"></a>05871    <span class="keywordtype">int</span> global = 0;
<a name="l05872"></a>05872    <span class="keywordtype">int</span> x;
<a name="l05873"></a>05873 
<a name="l05874"></a>05874    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(data)) {
<a name="l05875"></a>05875       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Set requires at least one variable name/value pair.\n"</span>);
<a name="l05876"></a>05876       <span class="keywordflow">return</span> 0;
<a name="l05877"></a>05877    }
<a name="l05878"></a>05878 
<a name="l05879"></a>05879    mydata = <a class="code" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>(data);
<a name="l05880"></a>05880    argc = <a class="code" href="app_8c.html#dcdae17d64f9e1f0fe1879e70961f028">ast_app_separate_args</a>(mydata, <span class="charliteral">'|'</span>, argv, <span class="keyword">sizeof</span>(argv) / <span class="keyword">sizeof</span>(argv[0]));
<a name="l05881"></a>05881 
<a name="l05882"></a>05882    <span class="comment">/* check for a trailing flags argument */</span>
<a name="l05883"></a>05883    <span class="keywordflow">if</span> ((argc &gt; 1) &amp;&amp; !strchr(argv[argc-1], <span class="charliteral">'='</span>)) {
<a name="l05884"></a>05884       argc--;
<a name="l05885"></a>05885       <span class="keywordflow">if</span> (strchr(argv[argc], <span class="charliteral">'g'</span>))
<a name="l05886"></a>05886          global = 1;
<a name="l05887"></a>05887    }
<a name="l05888"></a>05888 
<a name="l05889"></a>05889    <span class="keywordflow">for</span> (x = 0; x &lt; argc; x++) {
<a name="l05890"></a>05890       name = argv[x];
<a name="l05891"></a>05891       <span class="keywordflow">if</span> ((value = strchr(name, <span class="charliteral">'='</span>))) {
<a name="l05892"></a>05892          *value++ = <span class="charliteral">'\0'</span>;
<a name="l05893"></a>05893          <a class="code" href="pbx_8c.html#64407c916a2de6ae3f0efeca471c1b1d">pbx_builtin_setvar_helper</a>((global) ? NULL : chan, name, value);
<a name="l05894"></a>05894       } <span class="keywordflow">else</span>
<a name="l05895"></a>05895          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Ignoring entry '%s' with no = (and not last 'options' entry)\n"</span>, name);
<a name="l05896"></a>05896    }
<a name="l05897"></a>05897 
<a name="l05898"></a>05898    <span class="keywordflow">return</span>(0);
<a name="l05899"></a>05899 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="64407c916a2de6ae3f0efeca471c1b1d"></a><!-- doxytag: member="pbx.c::pbx_builtin_setvar_helper" ref="64407c916a2de6ae3f0efeca471c1b1d" args="(struct ast_channel *chan, const char *name, const char *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pbx_builtin_setvar_helper           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05821">5821</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l01452">ast_func_write()</a>, <a class="el" href="linkedlists_8h-source.html#l00650">AST_LIST_INSERT_HEAD</a>, <a class="el" href="linkedlists_8h-source.html#l00731">AST_LIST_REMOVE</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="lock_8h-source.html#l00637">ast_rwlock_unlock()</a>, <a class="el" href="lock_8h-source.html#l00652">ast_rwlock_wrlock()</a>, <a class="el" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>, <a class="el" href="chanvars_8c-source.html#l00039">ast_var_assign()</a>, <a class="el" href="chanvars_8c-source.html#l00056">ast_var_delete()</a>, <a class="el" href="chanvars_8c-source.html#l00062">ast_var_name()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="channel_8h-source.html#l00467">ast_channel::varshead</a>, and <a class="el" href="logger_8h-source.html#l00044">VERBOSE_PREFIX_2</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>, <a class="el" href="chan__h323_8c-source.html#l01010">__oh323_new()</a>, <a class="el" href="app__macro_8c-source.html#l00144">_macro_exec()</a>, <a class="el" href="app__while_8c-source.html#l00164">_while_exec()</a>, <a class="el" href="chan__iax2_8c-source.html#l06607">acf_iaxvar_write()</a>, <a class="el" href="func__odbc_8c-source.html#l00199">acf_odbc_read()</a>, <a class="el" href="func__odbc_8c-source.html#l00099">acf_odbc_write()</a>, <a class="el" href="manager_8c-source.html#l01506">action_setvar()</a>, <a class="el" href="res__agi_8c-source.html#l02033">agi_exec_full()</a>, <a class="el" href="app__externalivr_8c-source.html#l00244">app_exec()</a>, <a class="el" href="app__queue_8c-source.html#l03326">aqm_exec()</a>, <a class="el" href="func__strings_8c-source.html#l00204">array()</a>, <a class="el" href="res__features_8c-source.html#l01478">ast_bridge_call()</a>, <a class="el" href="res__features_8c-source.html#l01295">ast_feature_request_and_dial()</a>, <a class="el" href="chan__iax2_8c-source.html#l03426">ast_iax2_new()</a>, <a class="el" href="res__monitor_8c-source.html#l00127">ast_monitor_start()</a>, <a class="el" href="channel_8c-source.html#l04486">ast_set_variables()</a>, <a class="el" href="app__talkdetect_8c-source.html#l00063">background_detect_exec()</a>, <a class="el" href="res__features_8c-source.html#l02716">bridge_exec()</a>, <a class="el" href="res__features_8c-source.html#l00562">builtin_automonitor()</a>, <a class="el" href="res__features_8c-source.html#l00673">builtin_blindtransfer()</a>, <a class="el" href="app__chanisavail_8c-source.html#l00069">chanavail_exec()</a>, <a class="el" href="app__chanspy_8c-source.html#l00266">channel_spy()</a>, <a class="el" href="app__meetme_8c-source.html#l01350">conf_run()</a>, <a class="el" href="app__controlplayback_8c-source.html#l00075">controlplayback_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l02434">count_exec()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="res__features_8c-source.html#l01761">do_parking_thread()</a>, <a class="el" href="app__waitforsilence_8c-source.html#l00078">do_waiting()</a>, <a class="el" href="chan__misdn_8c-source.html#l00493">export_aoc_vars()</a>, <a class="el" href="chan__misdn_8c-source.html#l03713">export_ch()</a>, <a class="el" href="func__db_8c-source.html#l00165">function_db_delete()</a>, <a class="el" href="func__db_8c-source.html#l00121">function_db_exists()</a>, <a class="el" href="func__db_8c-source.html#l00049">function_db_read()</a>, <a class="el" href="chan__sip_8c-source.html#l09150">get_rdnis()</a>, <a class="el" href="func__global_8c-source.html#l00055">global_write()</a>, <a class="el" href="app__stack_8c-source.html#l00091">gosub_release_frame()</a>, <a class="el" href="chan__sip_8c-source.html#l15145">handle_request_bye()</a>, <a class="el" href="pbx_8c-source.html#l03770">handle_set_global()</a>, <a class="el" href="res__agi_8c-source.html#l01178">handle_setvariable()</a>, <a class="el" href="func__strings_8c-source.html#l00316">hash_read()</a>, <a class="el" href="func__strings_8c-source.html#l00296">hash_write()</a>, <a class="el" href="app__amd_8c-source.html#l00097">isAnsweringMachine()</a>, <a class="el" href="app__minivm_8c-source.html#l01501">leave_voicemail()</a>, <a class="el" href="chan__local_8c-source.html#l00488">local_hangup()</a>, <a class="el" href="app__minivm_8c-source.html#l02065">minivm_accmess_exec()</a>, <a class="el" href="app__minivm_8c-source.html#l02021">minivm_delete_exec()</a>, <a class="el" href="app__minivm_8c-source.html#l01818">minivm_greet_exec()</a>, <a class="el" href="app__minivm_8c-source.html#l01673">minivm_notify_exec()</a>, <a class="el" href="app__minivm_8c-source.html#l01751">minivm_record_exec()</a>, <a class="el" href="chan__misdn_8c-source.html#l01948">misdn_call()</a>, <a class="el" href="app__mixmonitor_8c-source.html#l00302">mixmonitor_exec()</a>, <a class="el" href="app__osplookup_8c-source.html#l01311">ospauth_exec()</a>, <a class="el" href="app__osplookup_8c-source.html#l01803">ospfinished_exec()</a>, <a class="el" href="app__osplookup_8c-source.html#l01415">osplookup_exec()</a>, <a class="el" href="app__osplookup_8c-source.html#l01618">ospnext_exec()</a>, <a class="el" href="chan__sip_8c-source.html#l12501">parse_moved_contact()</a>, <a class="el" href="pbx_8c-source.html#l05642">pbx_builtin_background()</a>, <a class="el" href="pbx_8c-source.html#l05901">pbx_builtin_importvar()</a>, <a class="el" href="pbx_8c-source.html#l05866">pbx_builtin_setvar()</a>, <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>, <a class="el" href="pbx__config_8c-source.html#l01332">pbx_load_config()</a>, <a class="el" href="app__voicemail_8c-source.html#l04396">play_message_datetime()</a>, <a class="el" href="app__playback_8c-source.html#l00378">playback_exec()</a>, <a class="el" href="app__queue_8c-source.html#l03157">pqm_exec()</a>, <a class="el" href="app__minivm_8c-source.html#l00738">prep_email_sub_vars()</a>, <a class="el" href="app__privacy_8c-source.html#l00078">privacy_exec()</a>, <a class="el" href="chan__misdn_8c-source.html#l02539">process_ast_dsp()</a>, <a class="el" href="app__read_8c-source.html#l00087">read_exec()</a>, <a class="el" href="app__readfile_8c-source.html#l00056">readfile_exec()</a>, <a class="el" href="app__record_8c-source.html#l00078">record_exec()</a>, <a class="el" href="app__stack_8c-source.html#l00163">return_exec()</a>, <a class="el" href="app__queue_8c-source.html#l03263">rqm_exec()</a>, <a class="el" href="app__image_8c-source.html#l00063">sendimage_exec()</a>, <a class="el" href="app__sendtext_8c-source.html#l00067">sendtext_exec()</a>, <a class="el" href="app__url_8c-source.html#l00070">sendurl_exec()</a>, <a class="el" href="func__logic_8c-source.html#l00121">set()</a>, <a class="el" href="chan__agent_8c-source.html#l00705">set_agentbycallerid()</a>, <a class="el" href="app__queue_8c-source.html#l00419">set_queue_result()</a>, <a class="el" href="chan__sip_8c-source.html#l18113">sip_addheader()</a>, <a class="el" href="chan__sip_8c-source.html#l03676">sip_hangup()</a>, <a class="el" href="chan__sip_8c-source.html#l04179">sip_new()</a>, <a class="el" href="app__meetme_8c-source.html#l04166">sla_station_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l04326">sla_trunk_exec()</a>, <a class="el" href="chan__iax2_8c-source.html#l06624">socket_process()</a>, <a class="el" href="app__speech__utils_8c-source.html#l00346">speech_create()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, <a class="el" href="res__monitor_8c-source.html#l00389">start_monitor_exec()</a>, <a class="el" href="app__system_8c-source.html#l00085">system_exec_helper()</a>, <a class="el" href="app__transfer_8c-source.html#l00068">transfer_exec()</a>, <a class="el" href="app__exec_8c-source.html#l00126">tryexec_exec()</a>, <a class="el" href="app__queue_8c-source.html#l03210">upqm_exec()</a>, <a class="el" href="app__voicemail_8c-source.html#l07081">vm_box_exists()</a>, <a class="el" href="app__voicemail_8c-source.html#l06944">vm_exec()</a>, <a class="el" href="app__voicemail_8c-source.html#l07154">vmauthenticate()</a>, <a class="el" href="chan__zap_8c-source.html#l03875">zt_handle_dtmfup()</a>, and <a class="el" href="chan__zap_8c-source.html#l05516">zt_new()</a>.<div class="fragment"><pre class="fragment"><a name="l05822"></a>05822 {
<a name="l05823"></a>05823    <span class="keyword">struct </span><a class="code" href="structast__var__t.html">ast_var_t</a> *newvariable;
<a name="l05824"></a>05824    <span class="keyword">struct </span>varshead *headp;
<a name="l05825"></a>05825    <span class="keyword">const</span> <span class="keywordtype">char</span> *nametail = <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>;
<a name="l05826"></a>05826 
<a name="l05827"></a>05827    <span class="comment">/* XXX may need locking on the channel ? */</span>
<a name="l05828"></a>05828    <span class="keywordflow">if</span> (<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>[strlen(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>)-1] == <span class="charliteral">')'</span>) {
<a name="l05829"></a>05829       <span class="keywordtype">char</span> *function = <a class="code" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>(name);
<a name="l05830"></a>05830 
<a name="l05831"></a>05831       <a class="code" href="pbx_8c.html#2432c0e88181cb3ba2c1a2764b0a6238">ast_func_write</a>(chan, function, value);
<a name="l05832"></a>05832       <span class="keywordflow">return</span>;
<a name="l05833"></a>05833    }
<a name="l05834"></a>05834 
<a name="l05835"></a>05835    headp = (chan) ? &amp;chan-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a> : &amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>;
<a name="l05836"></a>05836 
<a name="l05837"></a>05837    <span class="comment">/* For comparison purposes, we have to strip leading underscores */</span>
<a name="l05838"></a>05838    if (*nametail == <span class="charliteral">'_'</span>) {
<a name="l05839"></a>05839       nametail++;
<a name="l05840"></a>05840       <span class="keywordflow">if</span> (*nametail == <span class="charliteral">'_'</span>)
<a name="l05841"></a>05841          nametail++;
<a name="l05842"></a>05842    }
<a name="l05843"></a>05843 
<a name="l05844"></a>05844    <span class="keywordflow">if</span> (headp == &amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>)
<a name="l05845"></a>05845       <a class="code" href="lock_8h.html#25d2e851f878ee9a64d36b67b67ede6e">ast_rwlock_wrlock</a>(&amp;globalslock);
<a name="l05846"></a>05846    <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a> (headp, newvariable, entries) {
<a name="l05847"></a>05847       <span class="keywordflow">if</span> (strcasecmp(<a class="code" href="chanvars_8c.html#29d40dfad3c6b59de315b3a0d2ed0a23">ast_var_name</a>(newvariable), nametail) == 0) {
<a name="l05848"></a>05848          <span class="comment">/* there is already such a variable, delete it */</span>
<a name="l05849"></a>05849          <a class="code" href="linkedlists_8h.html#d4a4c53d3b264b4e1c5e3fdd84cd8b5a">AST_LIST_REMOVE</a>(headp, newvariable, entries);
<a name="l05850"></a>05850          <a class="code" href="chanvars_8c.html#32e018d32324bab845a9cac601c175d8">ast_var_delete</a>(newvariable);
<a name="l05851"></a>05851          <span class="keywordflow">break</span>;
<a name="l05852"></a>05852       }
<a name="l05853"></a>05853    }
<a name="l05854"></a>05854 
<a name="l05855"></a>05855    <span class="keywordflow">if</span> (value) {
<a name="l05856"></a>05856       <span class="keywordflow">if</span> ((<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 1) &amp;&amp; (headp == &amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>))
<a name="l05857"></a>05857          <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Setting global variable '%s' to '%s'\n"</span>, name, value);
<a name="l05858"></a>05858       newvariable = <a class="code" href="chanvars_8c.html#4d0028e2dbd755ae38d2fe4204ad9071">ast_var_assign</a>(name, value);
<a name="l05859"></a>05859       <a class="code" href="linkedlists_8h.html#5df56040a8838bdc841ef8eb179b7609">AST_LIST_INSERT_HEAD</a>(headp, newvariable, entries);
<a name="l05860"></a>05860    }
<a name="l05861"></a>05861 
<a name="l05862"></a>05862    <span class="keywordflow">if</span> (headp == &amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>)
<a name="l05863"></a>05863       <a class="code" href="lock_8h.html#97ed909ef0a0582cf3870dd0629852c8">ast_rwlock_unlock</a>(&amp;globalslock);
<a name="l05864"></a>05864 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="356fc557c1fe7c36e2773ba403e7625a"></a><!-- doxytag: member="pbx.c::pbx_checkcondition" ref="356fc557c1fe7c36e2773ba403e7625a" args="(const char *condition)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int pbx_checkcondition           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>condition</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Evaluate a condition. 
<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if the condition is NULL or of zero length </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>If the string is an integer, the integer representation of the integer is returned </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>1</em>&nbsp;</td><td>Any other non-empty string </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05947">5947</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>.
<p>
Referenced by <a class="el" href="app__while_8c-source.html#l00164">_while_exec()</a>, <a class="el" href="func__logic_8c-source.html#l00093">acf_if()</a>, <a class="el" href="app__exec_8c-source.html#l00162">execif_exec()</a>, <a class="el" href="app__stack_8c-source.html#l00277">gosubif_exec()</a>, <a class="el" href="app__macro_8c-source.html#l00499">macroif_exec()</a>, and <a class="el" href="pbx_8c-source.html#l05957">pbx_builtin_gotoif()</a>.<div class="fragment"><pre class="fragment"><a name="l05948"></a>05948 {
<a name="l05949"></a>05949    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(condition))  <span class="comment">/* NULL or empty strings are false */</span>
<a name="l05950"></a>05950       <span class="keywordflow">return</span> 0;
<a name="l05951"></a>05951    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*condition &gt;= <span class="charliteral">'0'</span> &amp;&amp; *condition &lt;= <span class="charliteral">'9'</span>)   <span class="comment">/* Numbers are evaluated for truth */</span>
<a name="l05952"></a>05952       <span class="keywordflow">return</span> atoi(condition);
<a name="l05953"></a>05953    <span class="keywordflow">else</span>  <span class="comment">/* Strings are true */</span>
<a name="l05954"></a>05954       <span class="keywordflow">return</span> 1;
<a name="l05955"></a>05955 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3f3f421aab3b84db6bcebc624d6c1426"></a><!-- doxytag: member="pbx.c::pbx_destroy" ref="3f3f421aab3b84db6bcebc624d6c1426" args="(struct ast_pbx *p)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void pbx_destroy           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__pbx.html">ast_pbx</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>p</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00583">583</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="astmm_8h-source.html#l00069">free</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>.<div class="fragment"><pre class="fragment"><a name="l00584"></a>00584 {
<a name="l00585"></a>00585    <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(p);
<a name="l00586"></a>00586 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="5970fbcb6a776848d11bf1c8ddb1c948"></a><!-- doxytag: member="pbx.c::pbx_exec" ref="5970fbcb6a776848d11bf1c8ddb1c948" args="(struct ast_channel *c, struct ast_app *app, void *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int pbx_exec           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__app.html">ast_app</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>app</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Execute an application. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>channel to execute on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>app</em>&nbsp;</td><td>which app to execute </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>the data passed into the app</td></tr>
  </table>
</dl>
This application executes an application on a given channel. It saves the stack and executes the given application passing in the given data.<p>
<dl compact><dt><b>Returns:</b></dt><dd>0 on success, and -1 on failure </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>c</em>&nbsp;</td><td>
Channel </td></tr>
<tr><td valign="top"><em>app</em>&nbsp;</td><td>
Application </td></tr>
<tr><td valign="top"><em>data</em>&nbsp;</td><td>
Data for execution </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00509">509</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00421">ast_channel::appl</a>, <a class="el" href="cdr_8c-source.html#l00718">ast_cdr_setapp()</a>, <a class="el" href="channel_8c-source.html#l00325">ast_check_hangup()</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, <a class="el" href="channel_8h-source.html#l00422">ast_channel::data</a>, and <a class="el" href="structast__app.html#881e868890bc8e5cd8614a1ce80c09eb">ast_app::execute</a>.
<p>
Referenced by <a class="el" href="dial_8c-source.html#l00142">answer_exec_run()</a>, <a class="el" href="res__features_8c-source.html#l01478">ast_bridge_call()</a>, <a class="el" href="pbx_8c-source.html#l05134">ast_pbx_run_app()</a>, <a class="el" href="pbx_8c-source.html#l04903">async_wait()</a>, <a class="el" href="res__features_8c-source.html#l00562">builtin_automonitor()</a>, <a class="el" href="app__meetme_8c-source.html#l01350">conf_run()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="pbx__dundi_8c-source.html#l04479">dundi_exec()</a>, <a class="el" href="app__exec_8c-source.html#l00091">exec_exec()</a>, <a class="el" href="app__exec_8c-source.html#l00162">execif_exec()</a>, <a class="el" href="res__features_8c-source.html#l01098">feature_exec_app()</a>, <a class="el" href="app__voicemail_8c-source.html#l04129">forward_message()</a>, <a class="el" href="res__agi_8c-source.html#l01110">handle_exec()</a>, <a class="el" href="chan__iax2_8c-source.html#l09890">iax2_exec()</a>, <a class="el" href="app__page_8c-source.html#l00085">page_exec()</a>, <a class="el" href="pbx_8c-source.html#l05525">pbx_builtin_execiftime()</a>, <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>, <a class="el" href="pbx__realtime_8c-source.html#l00174">realtime_exec()</a>, <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>, and <a class="el" href="app__exec_8c-source.html#l00126">tryexec_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l00512"></a>00512 {
<a name="l00513"></a>00513    <span class="keywordtype">int</span> res;
<a name="l00514"></a>00514 
<a name="l00515"></a>00515    <span class="keyword">const</span> <span class="keywordtype">char</span> *saved_c_appl;
<a name="l00516"></a>00516    <span class="keyword">const</span> <span class="keywordtype">char</span> *saved_c_data;
<a name="l00517"></a>00517 
<a name="l00518"></a>00518    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a> &amp;&amp;  !<a class="code" href="channel_8c.html#042e64a8d465783855a52ec8c56a9373">ast_check_hangup</a>(c))
<a name="l00519"></a>00519       <a class="code" href="cdr_8c.html#018b6c8a00209b6cf1fd7386b493f930">ast_cdr_setapp</a>(c-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>, app-&gt;name, data);
<a name="l00520"></a>00520 
<a name="l00521"></a>00521    <span class="comment">/* save channel values */</span>
<a name="l00522"></a>00522    saved_c_appl= c-&gt;<a class="code" href="structast__channel.html#63469c3c4f19f07c737127a117296de4">appl</a>;
<a name="l00523"></a>00523    saved_c_data= c-&gt;<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a>;
<a name="l00524"></a>00524 
<a name="l00525"></a>00525    c-&gt;<a class="code" href="structast__channel.html#63469c3c4f19f07c737127a117296de4">appl</a> = app-&gt;name;
<a name="l00526"></a>00526    c-&gt;<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a> = data;
<a name="l00527"></a>00527    <span class="comment">/* XXX remember what to to when we have linked apps to modules */</span>
<a name="l00528"></a>00528    <span class="keywordflow">if</span> (app-&gt;module) {
<a name="l00529"></a>00529       <span class="comment">/* XXX LOCAL_USER_ADD(app-&gt;module) */</span>
<a name="l00530"></a>00530    }
<a name="l00531"></a>00531    res = app-&gt;<a class="code" href="structast__app.html#881e868890bc8e5cd8614a1ce80c09eb">execute</a>(c, data);
<a name="l00532"></a>00532    <span class="keywordflow">if</span> (app-&gt;module) {
<a name="l00533"></a>00533       <span class="comment">/* XXX LOCAL_USER_REMOVE(app-&gt;module) */</span>
<a name="l00534"></a>00534    }
<a name="l00535"></a>00535    <span class="comment">/* restore channel values */</span>
<a name="l00536"></a>00536    c-&gt;<a class="code" href="structast__channel.html#63469c3c4f19f07c737127a117296de4">appl</a> = saved_c_appl;
<a name="l00537"></a>00537    c-&gt;<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a> = saved_c_data;
<a name="l00538"></a>00538    <span class="keywordflow">return</span> res;
<a name="l00539"></a>00539 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2377c7b979811bdd54ebf819e5d2037b"></a><!-- doxytag: member="pbx.c::pbx_extension_helper" ref="2377c7b979811bdd54ebf819e5d2037b" args="(struct ast_channel *c, struct ast_context *con, const char *context, const char *exten, int priority, const char *label, const char *callerid, enum ext_match_t action)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int pbx_extension_helper           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>label</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>callerid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>enum <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe">ext_match_t</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>action</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The return value depends on the action:. 
<p>
E_MATCH, E_CANMATCH, E_MATCHMORE require a real match, and return 0 on failure, -1 on match; E_FINDLABEL maps the label to a priority, and returns the priority on success, ... XXX E_SPAWN, spawn an application, and return 0 on success, -1 on failure. 
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01692">1692</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00125">ast_exten::app</a>, <a class="el" href="adsistub_8c-source.html#l00059">app</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="pbx_8c-source.html#l06069">ast_rdlock_contexts()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="pbx_8c-source.html#l00126">ast_exten::cached_app</a>, <a class="el" href="term_8h-source.html#l00052">COLOR_BRCYAN</a>, <a class="el" href="term_8h-source.html#l00050">COLOR_BRMAGENTA</a>, <a class="el" href="channel_8h-source.html#l00441">ast_channel::context</a>, <a class="el" href="pbx_8c-source.html#l00930">pbx_find_info::data</a>, <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fee9684886238bd81a61f3358030326178">E_CANMATCH</a>, <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe1bb8d310644e3f6e2603d80f8464bdda">E_FINDLABEL</a>, <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe437691af9bdd09d1ad4c2e5b087d5717">E_MATCH</a>, <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824febb13020eaa30c314c1bff110026a7cd2">E_MATCHMORE</a>, <a class="el" href="manager_8h-source.html#l00052">EVENT_FLAG_CALL</a>, <a class="el" href="pbx_8h-source.html#l00094">ast_switch::exec</a>, <a class="el" href="pbx_8c-source.html#l00080">EXT_DATA_SIZE</a>, <a class="el" href="channel_8h-source.html#l00442">ast_channel::exten</a>, <a class="el" href="pbx_8c-source.html#l00931">pbx_find_info::foundcontext</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00106">LOG_NOTICE</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="manager_8h-source.html#l00163">manager_event</a>, <a class="el" href="pbx_8h-source.html#l00089">ast_switch::name</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="pbx_8c-source.html#l05821">pbx_builtin_setvar_helper()</a>, <a class="el" href="pbx_8c-source.html#l00509">pbx_exec()</a>, <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>, <a class="el" href="pbx_8c-source.html#l00547">pbx_findapp()</a>, <a class="el" href="pbx_8c-source.html#l01670">pbx_substitute_variables()</a>, <a class="el" href="channel_8h-source.html#l00443">ast_channel::priority</a>, <a class="el" href="pbx_8c-source.html#l00122">ast_exten::priority</a>, <a class="el" href="pbx_8c-source.html#l00927">pbx_find_info::stacklen</a>, <a class="el" href="pbx_8c-source.html#l00928">pbx_find_info::status</a>, <a class="el" href="pbx_8c-source.html#l00901">STATUS_NO_CONTEXT</a>, <a class="el" href="pbx_8c-source.html#l00902">STATUS_NO_EXTENSION</a>, <a class="el" href="pbx_8c-source.html#l00904">STATUS_NO_LABEL</a>, <a class="el" href="pbx_8c-source.html#l00903">STATUS_NO_PRIORITY</a>, <a class="el" href="pbx_8c-source.html#l00929">pbx_find_info::swo</a>, <a class="el" href="term_8c-source.html#l00150">term_color()</a>, and <a class="el" href="logger_8h-source.html#l00045">VERBOSE_PREFIX_3</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02198">ast_canmatch_extension()</a>, <a class="el" href="pbx_8c-source.html#l02183">ast_exists_extension()</a>, <a class="el" href="pbx_8c-source.html#l02188">ast_findlabel_extension()</a>, <a class="el" href="pbx_8c-source.html#l02193">ast_findlabel_extension2()</a>, <a class="el" href="pbx_8c-source.html#l02203">ast_matchmore_extension()</a>, and <a class="el" href="pbx_8c-source.html#l02208">ast_spawn_extension()</a>.<div class="fragment"><pre class="fragment"><a name="l01695"></a>01695 {
<a name="l01696"></a>01696    <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *e;
<a name="l01697"></a>01697    <span class="keyword">struct </span><a class="code" href="structast__app.html">ast_app</a> *<a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>;
<a name="l01698"></a>01698    <span class="keywordtype">int</span> res;
<a name="l01699"></a>01699    <span class="keyword">struct </span><a class="code" href="structpbx__find__info.html">pbx_find_info</a> q = { .<a class="code" href="structpbx__find__info.html#c824947321b49de41aed9aaf089999dd">stacklen</a> = 0 }; <span class="comment">/* the rest is reset in pbx_find_extension */</span>
<a name="l01700"></a>01700    <span class="keywordtype">char</span> passdata[<a class="code" href="pbx_8c.html#28f9e18bd04fd180975e7c0b090950a2">EXT_DATA_SIZE</a>];
<a name="l01701"></a>01701 
<a name="l01702"></a>01702    <span class="keywordtype">int</span> matching_action = (action == <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe437691af9bdd09d1ad4c2e5b087d5717">E_MATCH</a> || action == <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fee9684886238bd81a61f3358030326178">E_CANMATCH</a> || action == <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824febb13020eaa30c314c1bff110026a7cd2">E_MATCHMORE</a>);
<a name="l01703"></a>01703 
<a name="l01704"></a>01704    <a class="code" href="pbx_8c.html#1b60f4b570102084989c86fd02ca6536">ast_rdlock_contexts</a>();
<a name="l01705"></a>01705    e = <a class="code" href="pbx_8c.html#b3ba8b98731731a7e47467140cc6a6a3">pbx_find_extension</a>(c, con, &amp;q, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, priority, label, callerid, action);
<a name="l01706"></a>01706    <span class="keywordflow">if</span> (e) {
<a name="l01707"></a>01707       <span class="keywordflow">if</span> (matching_action) {
<a name="l01708"></a>01708          <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l01709"></a>01709          <span class="keywordflow">return</span> -1;  <span class="comment">/* success, we found it */</span>
<a name="l01710"></a>01710       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (action == <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe1bb8d310644e3f6e2603d80f8464bdda">E_FINDLABEL</a>) { <span class="comment">/* map the label to a priority */</span>
<a name="l01711"></a>01711          res = e-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a>;
<a name="l01712"></a>01712          <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l01713"></a>01713          <span class="keywordflow">return</span> res; <span class="comment">/* the priority we were looking for */</span>
<a name="l01714"></a>01714       } <span class="keywordflow">else</span> { <span class="comment">/* spawn */</span>
<a name="l01715"></a>01715          <span class="keywordflow">if</span> (!e-&gt;<a class="code" href="structast__exten.html#26436909aad39881cd80f1d60289d898">cached_app</a>)
<a name="l01716"></a>01716             e-&gt;<a class="code" href="structast__exten.html#26436909aad39881cd80f1d60289d898">cached_app</a> = <a class="code" href="pbx_8c.html#d407cf204ec8fc50e5a578c8c17e0cb5">pbx_findapp</a>(e-&gt;<a class="code" href="structast__exten.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>);
<a name="l01717"></a>01717          app = e-&gt;<a class="code" href="structast__exten.html#26436909aad39881cd80f1d60289d898">cached_app</a>;
<a name="l01718"></a>01718          <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l01719"></a>01719          <span class="keywordflow">if</span> (!app) {
<a name="l01720"></a>01720             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"No application '%s' for extension (%s, %s, %d)\n"</span>, e-&gt;<a class="code" href="structast__exten.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, priority);
<a name="l01721"></a>01721             <span class="keywordflow">return</span> -1;
<a name="l01722"></a>01722          }
<a name="l01723"></a>01723          <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a> != <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>)
<a name="l01724"></a>01724             ast_copy_string(c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <span class="keyword">sizeof</span>(c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>));
<a name="l01725"></a>01725          <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a> != <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>)
<a name="l01726"></a>01726             ast_copy_string(c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <span class="keyword">sizeof</span>(c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>));
<a name="l01727"></a>01727          c-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a> = priority;
<a name="l01728"></a>01728          <a class="code" href="pbx_8c.html#120f5033eea8bea86259e519eefbbfe2">pbx_substitute_variables</a>(passdata, <span class="keyword">sizeof</span>(passdata), c, e);
<a name="l01729"></a>01729          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>) {
<a name="l01730"></a>01730             <span class="keywordtype">char</span> atmp[80];
<a name="l01731"></a>01731             <span class="keywordtype">char</span> atmp2[<a class="code" href="pbx_8c.html#28f9e18bd04fd180975e7c0b090950a2">EXT_DATA_SIZE</a>+100];
<a name="l01732"></a>01732             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l01733"></a>01733                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Launching '%s'\n"</span>, app-&gt;name);
<a name="l01734"></a>01734             snprintf(atmp, <span class="keyword">sizeof</span>(atmp), <span class="stringliteral">"STACK-%s-%s-%d"</span>, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, priority);
<a name="l01735"></a>01735             snprintf(atmp2, <span class="keyword">sizeof</span>(atmp2), <span class="stringliteral">"%s(\"%s\", \"%s\") %s"</span>,
<a name="l01736"></a>01736                app-&gt;name, c-&gt;name, passdata, <span class="stringliteral">"in new stack"</span>);
<a name="l01737"></a>01737             <a class="code" href="pbx_8c.html#64407c916a2de6ae3f0efeca471c1b1d">pbx_builtin_setvar_helper</a>(c, atmp, atmp2);
<a name="l01738"></a>01738          }
<a name="l01739"></a>01739          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 2) {
<a name="l01740"></a>01740             <span class="keywordtype">char</span> tmp[80], tmp2[80], tmp3[<a class="code" href="pbx_8c.html#28f9e18bd04fd180975e7c0b090950a2">EXT_DATA_SIZE</a>];
<a name="l01741"></a>01741             <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>( <a class="code" href="logger_8h.html#aefd5a67b7464040f5352e4ecdc535ca">VERBOSE_PREFIX_3</a> <span class="stringliteral">"Executing [%s@%s:%d] %s(\"%s\", \"%s\") %s\n"</span>,
<a name="l01742"></a>01742                <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, priority,
<a name="l01743"></a>01743                <a class="code" href="term_8c.html#e93d6667c9a6823fef4ab75cd64c90ca">term_color</a>(tmp, app-&gt;name, <a class="code" href="term_8h.html#ed35747ad832f24a4b7cf183cf619ad5">COLOR_BRCYAN</a>, 0, <span class="keyword">sizeof</span>(tmp)),
<a name="l01744"></a>01744                <a class="code" href="term_8c.html#e93d6667c9a6823fef4ab75cd64c90ca">term_color</a>(tmp2, c-&gt;name, <a class="code" href="term_8h.html#1aa594af665de225e032ba989d9b4472">COLOR_BRMAGENTA</a>, 0, <span class="keyword">sizeof</span>(tmp2)),
<a name="l01745"></a>01745                <a class="code" href="term_8c.html#e93d6667c9a6823fef4ab75cd64c90ca">term_color</a>(tmp3, passdata, <a class="code" href="term_8h.html#1aa594af665de225e032ba989d9b4472">COLOR_BRMAGENTA</a>, 0, <span class="keyword">sizeof</span>(tmp3)),
<a name="l01746"></a>01746                <span class="stringliteral">"in new stack"</span>);
<a name="l01747"></a>01747          }
<a name="l01748"></a>01748          <a class="code" href="manager_8h.html#17a8c809d5b2d04cbb8969a209134c2b">manager_event</a>(<a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <span class="stringliteral">"Newexten"</span>,
<a name="l01749"></a>01749                <span class="stringliteral">"Channel: %s\r\n"</span>
<a name="l01750"></a>01750                <span class="stringliteral">"Context: %s\r\n"</span>
<a name="l01751"></a>01751                <span class="stringliteral">"Extension: %s\r\n"</span>
<a name="l01752"></a>01752                <span class="stringliteral">"Priority: %d\r\n"</span>
<a name="l01753"></a>01753                <span class="stringliteral">"Application: %s\r\n"</span>
<a name="l01754"></a>01754                <span class="stringliteral">"AppData: %s\r\n"</span>
<a name="l01755"></a>01755                <span class="stringliteral">"Uniqueid: %s\r\n"</span>,
<a name="l01756"></a>01756                c-&gt;name, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, c-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>, app-&gt;name, passdata, c-&gt;uniqueid);
<a name="l01757"></a>01757          <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#5970fbcb6a776848d11bf1c8ddb1c948">pbx_exec</a>(c, app, passdata);  <span class="comment">/* 0 on success, -1 on failure */</span>
<a name="l01758"></a>01758       }
<a name="l01759"></a>01759    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (q.<a class="code" href="structpbx__find__info.html#74c18e3bfc1c1c7a1e94a1134f0e325d">swo</a>) {  <span class="comment">/* not found here, but in another switch */</span>
<a name="l01760"></a>01760       <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l01761"></a>01761       <span class="keywordflow">if</span> (matching_action)
<a name="l01762"></a>01762          <span class="keywordflow">return</span> -1;
<a name="l01763"></a>01763       <span class="keywordflow">else</span> {
<a name="l01764"></a>01764          <span class="keywordflow">if</span> (!q.<a class="code" href="structpbx__find__info.html#74c18e3bfc1c1c7a1e94a1134f0e325d">swo</a>-&gt;<a class="code" href="structast__switch.html#52fb3679b07eb74d90784e612ca5cb30">exec</a>) {
<a name="l01765"></a>01765             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"No execution engine for switch %s\n"</span>, q.<a class="code" href="structpbx__find__info.html#74c18e3bfc1c1c7a1e94a1134f0e325d">swo</a>-&gt;<a class="code" href="structast__switch.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l01766"></a>01766             res = -1;
<a name="l01767"></a>01767          }
<a name="l01768"></a>01768          <span class="keywordflow">return</span> q.<a class="code" href="structpbx__find__info.html#74c18e3bfc1c1c7a1e94a1134f0e325d">swo</a>-&gt;<a class="code" href="structast__switch.html#52fb3679b07eb74d90784e612ca5cb30">exec</a>(c, q.<a class="code" href="structpbx__find__info.html#366aef73a4366f97a04b24bfa6291fda">foundcontext</a> ? q.<a class="code" href="structpbx__find__info.html#366aef73a4366f97a04b24bfa6291fda">foundcontext</a> : <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, priority, callerid, q.<a class="code" href="structpbx__find__info.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l01769"></a>01769       }
<a name="l01770"></a>01770    } <span class="keywordflow">else</span> { <span class="comment">/* not found anywhere, see what happened */</span>
<a name="l01771"></a>01771       <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l01772"></a>01772       <span class="keywordflow">switch</span> (q.<a class="code" href="structpbx__find__info.html#9acb44549b41563697bb490144ec6258">status</a>) {
<a name="l01773"></a>01773       <span class="keywordflow">case</span> <a class="code" href="pbx_8c.html#04069b8c4c23b1436ecbd5daea064e7d">STATUS_NO_CONTEXT</a>:
<a name="l01774"></a>01774          <span class="keywordflow">if</span> (!matching_action)
<a name="l01775"></a>01775             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#bbf95aad74d847cd4bcb129604f798cd">LOG_NOTICE</a>, <span class="stringliteral">"Cannot find extension context '%s'\n"</span>, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l01776"></a>01776          <span class="keywordflow">break</span>;
<a name="l01777"></a>01777       <span class="keywordflow">case</span> <a class="code" href="pbx_8c.html#1ed8706992a31b08f995af6dd5c78c39">STATUS_NO_EXTENSION</a>:
<a name="l01778"></a>01778          <span class="keywordflow">if</span> (!matching_action)
<a name="l01779"></a>01779             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#bbf95aad74d847cd4bcb129604f798cd">LOG_NOTICE</a>, <span class="stringliteral">"Cannot find extension '%s' in context '%s'\n"</span>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l01780"></a>01780          <span class="keywordflow">break</span>;
<a name="l01781"></a>01781       <span class="keywordflow">case</span> <a class="code" href="pbx_8c.html#92658abbaf41e9115ce5d413ccc7ee1d">STATUS_NO_PRIORITY</a>:
<a name="l01782"></a>01782          <span class="keywordflow">if</span> (!matching_action)
<a name="l01783"></a>01783             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#bbf95aad74d847cd4bcb129604f798cd">LOG_NOTICE</a>, <span class="stringliteral">"No such priority %d in extension '%s' in context '%s'\n"</span>, priority, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l01784"></a>01784          <span class="keywordflow">break</span>;
<a name="l01785"></a>01785       <span class="keywordflow">case</span> <a class="code" href="pbx_8c.html#a614994b37f867365ca54ec3a75b7f1b">STATUS_NO_LABEL</a>:
<a name="l01786"></a>01786          <span class="keywordflow">if</span> (<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>)
<a name="l01787"></a>01787             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#bbf95aad74d847cd4bcb129604f798cd">LOG_NOTICE</a>, <span class="stringliteral">"No such label '%s' in extension '%s' in context '%s'\n"</span>, label, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l01788"></a>01788          <span class="keywordflow">break</span>;
<a name="l01789"></a>01789       <span class="keywordflow">default</span>:
<a name="l01790"></a>01790          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l01791"></a>01791             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Shouldn't happen!\n"</span>);
<a name="l01792"></a>01792       }
<a name="l01793"></a>01793 
<a name="l01794"></a>01794       <span class="keywordflow">return</span> (matching_action) ? 0 : -1;
<a name="l01795"></a>01795    }
<a name="l01796"></a>01796 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b3ba8b98731731a7e47467140cc6a6a3"></a><!-- doxytag: member="pbx.c::pbx_find_extension" ref="b3ba8b98731731a7e47467140cc6a6a3" args="(struct ast_channel *chan, struct ast_context *bypass, struct pbx_find_info *q, const char *context, const char *exten, int priority, const char *label, const char *callerid, enum ext_match_t action)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static struct <a class="el" href="structast__exten.html">ast_exten</a>* pbx_find_extension           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>bypass</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structpbx__find__info.html">pbx_find_info</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>q</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>label</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>callerid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>enum <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe">ext_match_t</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>action</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00934">934</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="pbx_8c-source.html#l00543">AST_PBX_MAX_STACK</a>, <a class="el" href="pbx_8c-source.html#l06201">ast_walk_context_extensions()</a>, <a class="el" href="pbx_8c-source.html#l06196">ast_walk_contexts()</a>, <a class="el" href="pbx_8c-source.html#l06219">ast_walk_extension_priorities()</a>, <a class="el" href="pbx_8h-source.html#l00093">ast_switch::canmatch</a>, <a class="el" href="pbx_8c-source.html#l00121">ast_exten::cidmatch</a>, <a class="el" href="pbx_8c-source.html#l00150">ast_sw::data</a>, <a class="el" href="pbx_8c-source.html#l00930">pbx_find_info::data</a>, <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fee9684886238bd81a61f3358030326178">E_CANMATCH</a>, <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe1bb8d310644e3f6e2603d80f8464bdda">E_FINDLABEL</a>, <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824febb13020eaa30c314c1bff110026a7cd2">E_MATCHMORE</a>, <a class="el" href="pbx_8c-source.html#l00151">ast_sw::eval</a>, <a class="el" href="pbx_8h-source.html#l00092">ast_switch::exists</a>, <a class="el" href="pbx_8c-source.html#l00119">ast_exten::exten</a>, <a class="el" href="pbx_8c-source.html#l00865">extension_match_core()</a>, <a class="el" href="pbx_8c-source.html#l00931">pbx_find_info::foundcontext</a>, <a class="el" href="pbx_8c-source.html#l00575">include_valid()</a>, <a class="el" href="pbx_8c-source.html#l00169">ast_context::includes</a>, <a class="el" href="pbx_8c-source.html#l00926">pbx_find_info::incstack</a>, <a class="el" href="pbx_8c-source.html#l00123">ast_exten::label</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="chan__iax2_8c-source.html#l01198">match()</a>, <a class="el" href="pbx_8c-source.html#l00907">matchcid()</a>, <a class="el" href="pbx_8c-source.html#l00120">ast_exten::matchcid</a>, <a class="el" href="pbx_8h-source.html#l00095">ast_switch::matchmore</a>, <a class="el" href="pbx_8c-source.html#l00148">ast_sw::name</a>, <a class="el" href="pbx_8c-source.html#l00142">ast_include::next</a>, <a class="el" href="pbx_8c-source.html#l00561">pbx_findswitch()</a>, <a class="el" href="pbx_8c-source.html#l01660">pbx_substitute_variables_helper()</a>, <a class="el" href="pbx_8c-source.html#l00122">ast_exten::priority</a>, <a class="el" href="pbx_8c-source.html#l00138">ast_include::rname</a>, <a class="el" href="pbx_8c-source.html#l00927">pbx_find_info::stacklen</a>, <a class="el" href="pbx_8c-source.html#l00928">pbx_find_info::status</a>, <a class="el" href="pbx_8c-source.html#l00901">STATUS_NO_CONTEXT</a>, <a class="el" href="pbx_8c-source.html#l00902">STATUS_NO_EXTENSION</a>, <a class="el" href="pbx_8c-source.html#l00904">STATUS_NO_LABEL</a>, <a class="el" href="pbx_8c-source.html#l00903">STATUS_NO_PRIORITY</a>, <a class="el" href="pbx_8c-source.html#l00905">STATUS_SUCCESS</a>, <a class="el" href="pbx_8c-source.html#l00083">SWITCH_DATA_LENGTH</a>, and <a class="el" href="pbx_8c-source.html#l00929">pbx_find_info::swo</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l01799">ast_hint_extension()</a>, and <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l00938"></a>00938 {
<a name="l00939"></a>00939    <span class="keywordtype">int</span> x, res;
<a name="l00940"></a>00940    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *tmp;
<a name="l00941"></a>00941    <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *e, *eroot;
<a name="l00942"></a>00942    <span class="keyword">struct </span><a class="code" href="structast__include.html">ast_include</a> *i;
<a name="l00943"></a>00943    <span class="keyword">struct </span><a class="code" href="structast__sw.html">ast_sw</a> *sw;
<a name="l00944"></a>00944 
<a name="l00945"></a>00945    <span class="comment">/* Initialize status if appropriate */</span>
<a name="l00946"></a>00946    <span class="keywordflow">if</span> (q-&gt;<a class="code" href="structpbx__find__info.html#c824947321b49de41aed9aaf089999dd">stacklen</a> == 0) {
<a name="l00947"></a>00947       q-&gt;<a class="code" href="structpbx__find__info.html#9acb44549b41563697bb490144ec6258">status</a> = <a class="code" href="pbx_8c.html#04069b8c4c23b1436ecbd5daea064e7d">STATUS_NO_CONTEXT</a>;
<a name="l00948"></a>00948       q-&gt;<a class="code" href="structpbx__find__info.html#74c18e3bfc1c1c7a1e94a1134f0e325d">swo</a> = NULL;
<a name="l00949"></a>00949       q-&gt;<a class="code" href="structpbx__find__info.html#8d777f385d3dfec8815d20f7496026dc">data</a> = NULL;
<a name="l00950"></a>00950       q-&gt;<a class="code" href="structpbx__find__info.html#366aef73a4366f97a04b24bfa6291fda">foundcontext</a> = NULL;
<a name="l00951"></a>00951    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (q-&gt;<a class="code" href="structpbx__find__info.html#c824947321b49de41aed9aaf089999dd">stacklen</a> &gt;= <a class="code" href="pbx_8c.html#249ae5f11bddff7a9bda62683881685d">AST_PBX_MAX_STACK</a>) {
<a name="l00952"></a>00952       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Maximum PBX stack exceeded\n"</span>);
<a name="l00953"></a>00953       <span class="keywordflow">return</span> NULL;
<a name="l00954"></a>00954    }
<a name="l00955"></a>00955 
<a name="l00956"></a>00956    <span class="comment">/* Check first to see if we've already been checked */</span>
<a name="l00957"></a>00957    <span class="keywordflow">for</span> (x = 0; x &lt; q-&gt;stacklen; x++) {
<a name="l00958"></a>00958       <span class="keywordflow">if</span> (!strcasecmp(q-&gt;<a class="code" href="structpbx__find__info.html#a385f353501865e79be68b4e4e6571a7">incstack</a>[x], <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>))
<a name="l00959"></a>00959          <span class="keywordflow">return</span> NULL;
<a name="l00960"></a>00960    }
<a name="l00961"></a>00961 
<a name="l00962"></a>00962    <span class="keywordflow">if</span> (bypass) <span class="comment">/* bypass means we only look there */</span>
<a name="l00963"></a>00963       tmp = bypass;
<a name="l00964"></a>00964    <span class="keywordflow">else</span> {   <span class="comment">/* look in contexts */</span>
<a name="l00965"></a>00965       tmp = NULL;
<a name="l00966"></a>00966       <span class="keywordflow">while</span> ((tmp = <a class="code" href="pbx_8c.html#709c9b64f2da1eaace237db32a5e1445">ast_walk_contexts</a>(tmp)) ) {
<a name="l00967"></a>00967          <span class="keywordflow">if</span> (!strcmp(tmp-&gt;name, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>))
<a name="l00968"></a>00968             <span class="keywordflow">break</span>;
<a name="l00969"></a>00969       }
<a name="l00970"></a>00970       <span class="keywordflow">if</span> (!tmp)
<a name="l00971"></a>00971          <span class="keywordflow">return</span> NULL;
<a name="l00972"></a>00972    }
<a name="l00973"></a>00973 
<a name="l00974"></a>00974    <span class="keywordflow">if</span> (q-&gt;<a class="code" href="structpbx__find__info.html#9acb44549b41563697bb490144ec6258">status</a> &lt; <a class="code" href="pbx_8c.html#1ed8706992a31b08f995af6dd5c78c39">STATUS_NO_EXTENSION</a>)
<a name="l00975"></a>00975       q-&gt;<a class="code" href="structpbx__find__info.html#9acb44549b41563697bb490144ec6258">status</a> = <a class="code" href="pbx_8c.html#1ed8706992a31b08f995af6dd5c78c39">STATUS_NO_EXTENSION</a>;
<a name="l00976"></a>00976 
<a name="l00977"></a>00977    <span class="comment">/* scan the list trying to match extension and CID */</span>
<a name="l00978"></a>00978    eroot = NULL;
<a name="l00979"></a>00979    <span class="keywordflow">while</span> ( (eroot = <a class="code" href="pbx_8c.html#b3b7bf8e22da60a0df718a52f3424b79">ast_walk_context_extensions</a>(tmp, eroot)) ) {
<a name="l00980"></a>00980       <span class="keywordtype">int</span> <a class="code" href="chan__iax2_8c.html#b5f545ec55667a61a75dd2047251b4ac">match</a> = <a class="code" href="pbx_8c.html#489ae231aa1cc1031dcfd0adc1cc4600">extension_match_core</a>(eroot-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, action);
<a name="l00981"></a>00981       <span class="comment">/* 0 on fail, 1 on match, 2 on earlymatch */</span>
<a name="l00982"></a>00982 
<a name="l00983"></a>00983       <span class="keywordflow">if</span> (!match || (eroot-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a> &amp;&amp; !<a class="code" href="pbx_8c.html#fba0369f208e3a6a1ae37ed883985304">matchcid</a>(eroot-&gt;<a class="code" href="structast__exten.html#2ef4524f32df05033fd0502689de872e">cidmatch</a>, callerid)))
<a name="l00984"></a>00984          <span class="keywordflow">continue</span>;   <span class="comment">/* keep trying */</span>
<a name="l00985"></a>00985       <span class="keywordflow">if</span> (match == 2 &amp;&amp; action == <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824febb13020eaa30c314c1bff110026a7cd2">E_MATCHMORE</a>) {
<a name="l00986"></a>00986          <span class="comment">/* We match an extension ending in '!'.</span>
<a name="l00987"></a>00987 <span class="comment">          * The decision in this case is final and is NULL (no match).</span>
<a name="l00988"></a>00988 <span class="comment">          */</span>
<a name="l00989"></a>00989          <span class="keywordflow">return</span> NULL;
<a name="l00990"></a>00990       }
<a name="l00991"></a>00991       <span class="comment">/* found entry, now look for the right priority */</span>
<a name="l00992"></a>00992       <span class="keywordflow">if</span> (q-&gt;<a class="code" href="structpbx__find__info.html#9acb44549b41563697bb490144ec6258">status</a> &lt; <a class="code" href="pbx_8c.html#92658abbaf41e9115ce5d413ccc7ee1d">STATUS_NO_PRIORITY</a>)
<a name="l00993"></a>00993          q-&gt;<a class="code" href="structpbx__find__info.html#9acb44549b41563697bb490144ec6258">status</a> = <a class="code" href="pbx_8c.html#92658abbaf41e9115ce5d413ccc7ee1d">STATUS_NO_PRIORITY</a>;
<a name="l00994"></a>00994       e = NULL;
<a name="l00995"></a>00995       <span class="keywordflow">while</span> ( (e = <a class="code" href="pbx_8c.html#2ae60ad33dfd510584655331ac42b890">ast_walk_extension_priorities</a>(eroot, e)) ) {
<a name="l00996"></a>00996          <span class="comment">/* Match label or priority */</span>
<a name="l00997"></a>00997          <span class="keywordflow">if</span> (action == <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe1bb8d310644e3f6e2603d80f8464bdda">E_FINDLABEL</a>) {
<a name="l00998"></a>00998             <span class="keywordflow">if</span> (q-&gt;<a class="code" href="structpbx__find__info.html#9acb44549b41563697bb490144ec6258">status</a> &lt; <a class="code" href="pbx_8c.html#a614994b37f867365ca54ec3a75b7f1b">STATUS_NO_LABEL</a>)
<a name="l00999"></a>00999                q-&gt;<a class="code" href="structpbx__find__info.html#9acb44549b41563697bb490144ec6258">status</a> = <a class="code" href="pbx_8c.html#a614994b37f867365ca54ec3a75b7f1b">STATUS_NO_LABEL</a>;
<a name="l01000"></a>01000             <span class="keywordflow">if</span> (label &amp;&amp; e-&gt;<a class="code" href="structast__exten.html#d304ba20e96d87411588eeabac850e34">label</a> &amp;&amp; !strcmp(label, e-&gt;<a class="code" href="structast__exten.html#d304ba20e96d87411588eeabac850e34">label</a>))
<a name="l01001"></a>01001                <span class="keywordflow">break</span>;   <span class="comment">/* found it */</span>
<a name="l01002"></a>01002          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a> == priority) {
<a name="l01003"></a>01003             <span class="keywordflow">break</span>;   <span class="comment">/* found it */</span>
<a name="l01004"></a>01004          } <span class="comment">/* else keep searching */</span>
<a name="l01005"></a>01005       }
<a name="l01006"></a>01006       <span class="keywordflow">if</span> (e) { <span class="comment">/* found a valid match */</span>
<a name="l01007"></a>01007          q-&gt;<a class="code" href="structpbx__find__info.html#9acb44549b41563697bb490144ec6258">status</a> = <a class="code" href="pbx_8c.html#47768f6d3d56f8455845fb093ab0cf0e">STATUS_SUCCESS</a>;
<a name="l01008"></a>01008          q-&gt;<a class="code" href="structpbx__find__info.html#366aef73a4366f97a04b24bfa6291fda">foundcontext</a> = <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>;
<a name="l01009"></a>01009          <span class="keywordflow">return</span> e;
<a name="l01010"></a>01010       }
<a name="l01011"></a>01011    }
<a name="l01012"></a>01012    <span class="comment">/* Check alternative switches */</span>
<a name="l01013"></a>01013    <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;tmp-&gt;alts, sw, list) {
<a name="l01014"></a>01014       <span class="keyword">struct </span><a class="code" href="structast__switch.html">ast_switch</a> *asw = <a class="code" href="pbx_8c.html#877982a93293a50800c723f2d6a076b8">pbx_findswitch</a>(sw-&gt;<a class="code" href="structast__sw.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l01015"></a>01015       <a class="code" href="pbx_8h.html#9ca45d5d91ac596db3ca4ad7325420d9">ast_switch_f</a> *aswf = NULL;
<a name="l01016"></a>01016       <span class="keywordtype">char</span> *datap;
<a name="l01017"></a>01017 
<a name="l01018"></a>01018       <span class="keywordflow">if</span> (!asw) {
<a name="l01019"></a>01019          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"No such switch '%s'\n"</span>, sw-&gt;<a class="code" href="structast__sw.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l01020"></a>01020          <span class="keywordflow">continue</span>;
<a name="l01021"></a>01021       }
<a name="l01022"></a>01022       <span class="comment">/* Substitute variables now */</span>
<a name="l01023"></a>01023       <span class="keywordflow">if</span> (sw-&gt;<a class="code" href="structast__sw.html#2eed1fe0db36d674643b5f84d2adf46e">eval</a>)
<a name="l01024"></a>01024          <a class="code" href="pbx_8c.html#7f62e5d5f926a2eeedb559b6afd3d80a">pbx_substitute_variables_helper</a>(chan, sw-&gt;<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>, sw-&gt;tmpdata, <a class="code" href="pbx_8c.html#27dc176701e9014e219fe586c4f546e5">SWITCH_DATA_LENGTH</a> - 1);
<a name="l01025"></a>01025 
<a name="l01026"></a>01026       <span class="comment">/* equivalent of extension_match_core() at the switch level */</span>
<a name="l01027"></a>01027       <span class="keywordflow">if</span> (action == <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fee9684886238bd81a61f3358030326178">E_CANMATCH</a>)
<a name="l01028"></a>01028          aswf = asw-&gt;<a class="code" href="structast__switch.html#7531782c74501c61c046a809eb326f1a">canmatch</a>;
<a name="l01029"></a>01029       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (action == <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824febb13020eaa30c314c1bff110026a7cd2">E_MATCHMORE</a>)
<a name="l01030"></a>01030          aswf = asw-&gt;<a class="code" href="structast__switch.html#2e681e3552976639b321e152a285583c">matchmore</a>;
<a name="l01031"></a>01031       <span class="keywordflow">else</span> <span class="comment">/* action == E_MATCH */</span>
<a name="l01032"></a>01032          aswf = asw-&gt;<a class="code" href="structast__switch.html#e087923eb5dd1310f5f25ddd5ae5b580">exists</a>;
<a name="l01033"></a>01033       datap = sw-&gt;<a class="code" href="structast__sw.html#2eed1fe0db36d674643b5f84d2adf46e">eval</a> ? sw-&gt;tmpdata : sw-&gt;<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>;
<a name="l01034"></a>01034       res = !aswf ? 0 : aswf(chan, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, priority, callerid, datap);
<a name="l01035"></a>01035       <span class="keywordflow">if</span> (res) {  <span class="comment">/* Got a match */</span>
<a name="l01036"></a>01036          q-&gt;<a class="code" href="structpbx__find__info.html#74c18e3bfc1c1c7a1e94a1134f0e325d">swo</a> = asw;
<a name="l01037"></a>01037          q-&gt;<a class="code" href="structpbx__find__info.html#8d777f385d3dfec8815d20f7496026dc">data</a> = datap;
<a name="l01038"></a>01038          q-&gt;<a class="code" href="structpbx__find__info.html#366aef73a4366f97a04b24bfa6291fda">foundcontext</a> = <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>;
<a name="l01039"></a>01039          <span class="comment">/* XXX keep status = STATUS_NO_CONTEXT ? */</span>
<a name="l01040"></a>01040          <span class="keywordflow">return</span> NULL;
<a name="l01041"></a>01041       }
<a name="l01042"></a>01042    }
<a name="l01043"></a>01043    q-&gt;<a class="code" href="structpbx__find__info.html#a385f353501865e79be68b4e4e6571a7">incstack</a>[q-&gt;<a class="code" href="structpbx__find__info.html#c824947321b49de41aed9aaf089999dd">stacklen</a>++] = tmp-&gt;name;   <span class="comment">/* Setup the stack */</span>
<a name="l01044"></a>01044    <span class="comment">/* Now try any includes we have in this context */</span>
<a name="l01045"></a>01045    <span class="keywordflow">for</span> (i = tmp-&gt;<a class="code" href="structast__context.html#bb2b21ef7774df8687ff02b0284505c6">includes</a>; i; i = i-&gt;<a class="code" href="structast__include.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l01046"></a>01046       <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#355ea768230f2ab2299d8eea050b674c">include_valid</a>(i)) {
<a name="l01047"></a>01047          <span class="keywordflow">if</span> ((e = <a class="code" href="pbx_8c.html#b3ba8b98731731a7e47467140cc6a6a3">pbx_find_extension</a>(chan, bypass, q, i-&gt;<a class="code" href="structast__include.html#c626d8954194dd0136691c301dcf7ece">rname</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, priority, label, callerid, action)))
<a name="l01048"></a>01048             <span class="keywordflow">return</span> e;
<a name="l01049"></a>01049          <span class="keywordflow">if</span> (q-&gt;<a class="code" href="structpbx__find__info.html#74c18e3bfc1c1c7a1e94a1134f0e325d">swo</a>)
<a name="l01050"></a>01050             <span class="keywordflow">return</span> NULL;
<a name="l01051"></a>01051       }
<a name="l01052"></a>01052    }
<a name="l01053"></a>01053    <span class="keywordflow">return</span> NULL;
<a name="l01054"></a>01054 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d407cf204ec8fc50e5a578c8c17e0cb5"></a><!-- doxytag: member="pbx.c::pbx_findapp" ref="d407cf204ec8fc50e5a578c8c17e0cb5" args="(const char *app)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__app.html">ast_app</a>* pbx_findapp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>app</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Look up an application. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>app</em>&nbsp;</td><td>name of the app</td></tr>
  </table>
</dl>
This function searches for the <a class="el" href="structast__app.html">ast_app</a> structure within the apps that are registered for the one with the name you passed in.<p>
<dl compact><dt><b>Returns:</b></dt><dd>the <a class="el" href="structast__app.html">ast_app</a> structure that matches on success, or NULL on failure </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00547">547</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00060">AST_RWLIST_RDLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, and <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>.
<p>
Referenced by <a class="el" href="dial_8c-source.html#l00142">answer_exec_run()</a>, <a class="el" href="res__features_8c-source.html#l01478">ast_bridge_call()</a>, <a class="el" href="pbx_8c-source.html#l05134">ast_pbx_run_app()</a>, <a class="el" href="pbx_8c-source.html#l04903">async_wait()</a>, <a class="el" href="res__features_8c-source.html#l00562">builtin_automonitor()</a>, <a class="el" href="app__meetme_8c-source.html#l01350">conf_run()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="pbx__dundi_8c-source.html#l04479">dundi_exec()</a>, <a class="el" href="app__exec_8c-source.html#l00091">exec_exec()</a>, <a class="el" href="app__exec_8c-source.html#l00162">execif_exec()</a>, <a class="el" href="res__features_8c-source.html#l01098">feature_exec_app()</a>, <a class="el" href="app__voicemail_8c-source.html#l04129">forward_message()</a>, <a class="el" href="res__agi_8c-source.html#l01110">handle_exec()</a>, <a class="el" href="chan__iax2_8c-source.html#l09890">iax2_exec()</a>, <a class="el" href="app__page_8c-source.html#l00085">page_exec()</a>, <a class="el" href="pbx_8c-source.html#l05525">pbx_builtin_execiftime()</a>, <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>, <a class="el" href="pbx__realtime_8c-source.html#l00174">realtime_exec()</a>, <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>, and <a class="el" href="app__exec_8c-source.html#l00126">tryexec_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l00548"></a>00548 {
<a name="l00549"></a>00549    <span class="keyword">struct </span><a class="code" href="structast__app.html">ast_app</a> *tmp;
<a name="l00550"></a>00550 
<a name="l00551"></a>00551    <a class="code" href="linkedlists_8h.html#23c0c844e5abcb474854867b408e3be8">AST_RWLIST_RDLOCK</a>(&amp;apps);
<a name="l00552"></a>00552    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;apps, tmp, list) {
<a name="l00553"></a>00553       <span class="keywordflow">if</span> (!strcasecmp(tmp-&gt;name, <a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>))
<a name="l00554"></a>00554          <span class="keywordflow">break</span>;
<a name="l00555"></a>00555    }
<a name="l00556"></a>00556    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;apps);
<a name="l00557"></a>00557 
<a name="l00558"></a>00558    <span class="keywordflow">return</span> tmp;
<a name="l00559"></a>00559 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="877982a93293a50800c723f2d6a076b8"></a><!-- doxytag: member="pbx.c::pbx_findswitch" ref="877982a93293a50800c723f2d6a076b8" args="(const char *sw)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static struct <a class="el" href="structast__switch.html">ast_switch</a>* pbx_findswitch           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>sw</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00561">561</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00060">AST_RWLIST_RDLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, and <a class="el" href="pbx_8h-source.html#l00089">ast_switch::name</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>.<div class="fragment"><pre class="fragment"><a name="l00562"></a>00562 {
<a name="l00563"></a>00563    <span class="keyword">struct </span><a class="code" href="structast__switch.html">ast_switch</a> *asw;
<a name="l00564"></a>00564 
<a name="l00565"></a>00565    <a class="code" href="linkedlists_8h.html#23c0c844e5abcb474854867b408e3be8">AST_RWLIST_RDLOCK</a>(&amp;switches);
<a name="l00566"></a>00566    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;switches, asw, list) {
<a name="l00567"></a>00567       <span class="keywordflow">if</span> (!strcasecmp(asw-&gt;<a class="code" href="structast__switch.html#b068931cc450442b63f5b3d276ea4297">name</a>, sw))
<a name="l00568"></a>00568          <span class="keywordflow">break</span>;
<a name="l00569"></a>00569    }
<a name="l00570"></a>00570    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;switches);
<a name="l00571"></a>00571 
<a name="l00572"></a>00572    <span class="keywordflow">return</span> asw;
<a name="l00573"></a>00573 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2753b759766c3d305e2551f63e403677"></a><!-- doxytag: member="pbx.c::pbx_retrieve_variable" ref="2753b759766c3d305e2551f63e403677" args="(struct ast_channel *c, const char *var, char **ret, char *workspace, int workspacelen, struct varshead *headp)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pbx_retrieve_variable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>var</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char **&nbsp;</td>
          <td class="mdname" nowrap> <em>ret</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>workspace</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>workspacelen</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct varshead *&nbsp;</td>
          <td class="mdname" nowrap> <em>headp</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Support for Asterisk built-in variables in the dialplan. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>See also<ul>
<li><a class="el" href="AstVar.html">Globally predefined channel variables</a> Channel variables</li><li><a class="el" href="AstCauses.html">Hangup Causes for Asterisk</a> The HANGUPCAUSE variable </li></ul>
</dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01132">1132</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="asterisk_8c-source.html#l00230">ast_config_AST_SYSTEM_NAME</a>, <a class="el" href="pbx_8c-source.html#l02166">ast_get_hint()</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="lock_8h-source.html#l00642">ast_rwlock_rdlock()</a>, <a class="el" href="lock_8h-source.html#l00637">ast_rwlock_unlock()</a>, <a class="el" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>, <a class="el" href="chanvars_8c-source.html#l00062">ast_var_name()</a>, <a class="el" href="chanvars_8c-source.html#l00082">ast_var_value()</a>, <a class="el" href="channel_8h-source.html#l00437">ast_channel::cid</a>, <a class="el" href="channel_8h-source.html#l00217">ast_callerid::cid_ani2</a>, <a class="el" href="channel_8h-source.html#l00216">ast_callerid::cid_pres</a>, <a class="el" href="channel_8h-source.html#l00219">ast_callerid::cid_tns</a>, <a class="el" href="channel_8h-source.html#l00218">ast_callerid::cid_ton</a>, <a class="el" href="channel_8h-source.html#l00441">ast_channel::context</a>, <a class="el" href="channel_8h-source.html#l00442">ast_channel::exten</a>, <a class="el" href="channel_8h-source.html#l00466">ast_channel::hangupcause</a>, <a class="el" href="chan__alsa_8c-source.html#l00183">offset</a>, <a class="el" href="pbx_8c-source.html#l01060">parse_variable_name()</a>, <a class="el" href="channel_8h-source.html#l00443">ast_channel::priority</a>, <a class="el" href="aesopt_8h-source.html#l00399">s</a>, <a class="el" href="pbx_8c-source.html#l01090">substring()</a>, and <a class="el" href="channel_8h-source.html#l00467">ast_channel::varshead</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l01548">action_getvar()</a>, <a class="el" href="res__agi_8c-source.html#l01187">handle_getvariable()</a>, and <a class="el" href="pbx_8c-source.html#l01468">pbx_substitute_variables_helper_full()</a>.<div class="fragment"><pre class="fragment"><a name="l01133"></a>01133 {
<a name="l01134"></a>01134    <span class="keyword">const</span> <span class="keywordtype">char</span> not_found = <span class="charliteral">'\0'</span>;
<a name="l01135"></a>01135    <span class="keywordtype">char</span> *tmpvar;
<a name="l01136"></a>01136    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>; <span class="comment">/* the result */</span>
<a name="l01137"></a>01137    <span class="keywordtype">int</span> <a class="code" href="chan__alsa_8c.html#7a86c157ee9713c34fbd7a1ee40f0c5a">offset</a>, length;
<a name="l01138"></a>01138    <span class="keywordtype">int</span> i, need_substring;
<a name="l01139"></a>01139    <span class="keyword">struct </span>varshead *places[2] = { headp, &amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a> };  <span class="comment">/* list of places where we may look */</span>
<a name="l01140"></a>01140 
<a name="l01141"></a>01141    <span class="keywordflow">if</span> (c) {
<a name="l01142"></a>01142       places[0] = &amp;c-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>;
<a name="l01143"></a>01143    }
<a name="l01144"></a>01144    <span class="comment">/*</span>
<a name="l01145"></a>01145 <span class="comment">    * Make a copy of var because parse_variable_name() modifies the string.</span>
<a name="l01146"></a>01146 <span class="comment">    * Then if called directly, we might need to run substring() on the result;</span>
<a name="l01147"></a>01147 <span class="comment">    * remember this for later in 'need_substring', 'offset' and 'length'</span>
<a name="l01148"></a>01148 <span class="comment">    */</span>
<a name="l01149"></a>01149    tmpvar = <a class="code" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>); <span class="comment">/* parse_variable_name modifies the string */</span>
<a name="l01150"></a>01150    need_substring = <a class="code" href="pbx_8c.html#1f596dad2120f1ef7d9cceea084686cc">parse_variable_name</a>(tmpvar, &amp;offset, &amp;length, &amp;i <span class="comment">/* ignored */</span>);
<a name="l01151"></a>01151 
<a name="l01152"></a>01152    <span class="comment">/*</span>
<a name="l01153"></a>01153 <span class="comment">    * Look first into predefined variables, then into variable lists.</span>
<a name="l01154"></a>01154 <span class="comment">    * Variable 's' points to the result, according to the following rules:</span>
<a name="l01155"></a>01155 <span class="comment">    * s == &amp;not_found (set at the beginning) means that we did not find a</span>
<a name="l01156"></a>01156 <span class="comment">    * matching variable and need to look into more places.</span>
<a name="l01157"></a>01157 <span class="comment">    * If s != &amp;not_found, s is a valid result string as follows:</span>
<a name="l01158"></a>01158 <span class="comment">    * s = NULL if the variable does not have a value;</span>
<a name="l01159"></a>01159 <span class="comment">    * you typically do this when looking for an unset predefined variable.</span>
<a name="l01160"></a>01160 <span class="comment">    * s = workspace if the result has been assembled there;</span>
<a name="l01161"></a>01161 <span class="comment">    * typically done when the result is built e.g. with an snprintf(),</span>
<a name="l01162"></a>01162 <span class="comment">    * so we don't need to do an additional copy.</span>
<a name="l01163"></a>01163 <span class="comment">    * s != workspace in case we have a string, that needs to be copied</span>
<a name="l01164"></a>01164 <span class="comment">    * (the ast_copy_string is done once for all at the end).</span>
<a name="l01165"></a>01165 <span class="comment">    * Typically done when the result is already available in some string.</span>
<a name="l01166"></a>01166 <span class="comment">    */</span>
<a name="l01167"></a>01167    s = &amp;not_found;   <span class="comment">/* default value */</span>
<a name="l01168"></a>01168    <span class="keywordflow">if</span> (c) { <span class="comment">/* This group requires a valid channel */</span>
<a name="l01169"></a>01169       <span class="comment">/* Names with common parts are looked up a piece at a time using strncmp. */</span>
<a name="l01170"></a>01170       <span class="keywordflow">if</span> (!strncmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"CALL"</span>, 4)) {
<a name="l01171"></a>01171          <span class="keywordflow">if</span> (!strncmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a> + 4, <span class="stringliteral">"ING"</span>, 3)) {
<a name="l01172"></a>01172             <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a> + 7, <span class="stringliteral">"PRES"</span>)) {        <span class="comment">/* CALLINGPRES */</span>
<a name="l01173"></a>01173                snprintf(workspace, workspacelen, <span class="stringliteral">"%d"</span>, c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#872e42fb90e7d76ff7350f6741f567ff">cid_pres</a>);
<a name="l01174"></a>01174                s = workspace;
<a name="l01175"></a>01175             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a> + 7, <span class="stringliteral">"ANI2"</span>)) {    <span class="comment">/* CALLINGANI2 */</span>
<a name="l01176"></a>01176                snprintf(workspace, workspacelen, <span class="stringliteral">"%d"</span>, c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#644bbeb978ab62db10db9fd8cdaef142">cid_ani2</a>);
<a name="l01177"></a>01177                s = workspace;
<a name="l01178"></a>01178             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a> + 7, <span class="stringliteral">"TON"</span>)) {     <span class="comment">/* CALLINGTON */</span>
<a name="l01179"></a>01179                snprintf(workspace, workspacelen, <span class="stringliteral">"%d"</span>, c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#ed6d65567170b0bab67f0616396d247f">cid_ton</a>);
<a name="l01180"></a>01180                s = workspace;
<a name="l01181"></a>01181             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a> + 7, <span class="stringliteral">"TNS"</span>)) {     <span class="comment">/* CALLINGTNS */</span>
<a name="l01182"></a>01182                snprintf(workspace, workspacelen, <span class="stringliteral">"%d"</span>, c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#9010703800c4f5d446cfc1ad720bba2d">cid_tns</a>);
<a name="l01183"></a>01183                s = workspace;
<a name="l01184"></a>01184             }
<a name="l01185"></a>01185          }
<a name="l01186"></a>01186       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"HINT"</span>)) {
<a name="l01187"></a>01187          s = <a class="code" href="pbx_8c.html#b654f3264742a57f212c38761672a6c0">ast_get_hint</a>(workspace, workspacelen, NULL, 0, c, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>) ? workspace : NULL;
<a name="l01188"></a>01188       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"HINTNAME"</span>)) {
<a name="l01189"></a>01189          s = <a class="code" href="pbx_8c.html#b654f3264742a57f212c38761672a6c0">ast_get_hint</a>(NULL, 0, workspace, workspacelen, c, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>) ? workspace : NULL;
<a name="l01190"></a>01190       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"EXTEN"</span>)) {
<a name="l01191"></a>01191          s = c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>;
<a name="l01192"></a>01192       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"CONTEXT"</span>)) {
<a name="l01193"></a>01193          s = c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>;
<a name="l01194"></a>01194       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"PRIORITY"</span>)) {
<a name="l01195"></a>01195          snprintf(workspace, workspacelen, <span class="stringliteral">"%d"</span>, c-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>);
<a name="l01196"></a>01196          s = workspace;
<a name="l01197"></a>01197       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"CHANNEL"</span>)) {
<a name="l01198"></a>01198          s = c-&gt;name;
<a name="l01199"></a>01199       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"UNIQUEID"</span>)) {
<a name="l01200"></a>01200          s = c-&gt;uniqueid;
<a name="l01201"></a>01201       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"HANGUPCAUSE"</span>)) {
<a name="l01202"></a>01202          snprintf(workspace, workspacelen, <span class="stringliteral">"%d"</span>, c-&gt;<a class="code" href="structast__channel.html#8be5f831332d8ff714e90c2cf85171fe">hangupcause</a>);
<a name="l01203"></a>01203          s = workspace;
<a name="l01204"></a>01204       }
<a name="l01205"></a>01205    }
<a name="l01206"></a>01206    <span class="keywordflow">if</span> (s == &amp;not_found) { <span class="comment">/* look for more */</span>
<a name="l01207"></a>01207       <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"EPOCH"</span>)) {
<a name="l01208"></a>01208          snprintf(workspace, workspacelen, <span class="stringliteral">"%u"</span>,(<span class="keywordtype">int</span>)time(NULL));
<a name="l01209"></a>01209          s = workspace;
<a name="l01210"></a>01210       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"SYSTEMNAME"</span>)) {
<a name="l01211"></a>01211          s = <a class="code" href="asterisk_8c.html#0a0f8ba4c757a1da509a0cae1830025b">ast_config_AST_SYSTEM_NAME</a>;
<a name="l01212"></a>01212       }
<a name="l01213"></a>01213    }
<a name="l01214"></a>01214    <span class="comment">/* if not found, look into chanvars or global vars */</span>
<a name="l01215"></a>01215    <span class="keywordflow">for</span> (i = 0; s == &amp;not_found &amp;&amp; i &lt; (<span class="keyword">sizeof</span>(places) / <span class="keyword">sizeof</span>(places[0])); i++) {
<a name="l01216"></a>01216       <span class="keyword">struct </span><a class="code" href="structast__var__t.html">ast_var_t</a> *variables;
<a name="l01217"></a>01217       <span class="keywordflow">if</span> (!places[i])
<a name="l01218"></a>01218          <span class="keywordflow">continue</span>;
<a name="l01219"></a>01219       <span class="keywordflow">if</span> (places[i] == &amp;globals)
<a name="l01220"></a>01220          <a class="code" href="lock_8h.html#f4b8158bcd471d4f28b380768e3ee073">ast_rwlock_rdlock</a>(&amp;globalslock);
<a name="l01221"></a>01221       <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(places[i], variables, entries) {
<a name="l01222"></a>01222          <span class="keywordflow">if</span> (strcasecmp(<a class="code" href="chanvars_8c.html#29d40dfad3c6b59de315b3a0d2ed0a23">ast_var_name</a>(variables), <a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>)==0) {
<a name="l01223"></a>01223             s = <a class="code" href="chanvars_8c.html#6aa089cff5424a26ade21a520e443f82">ast_var_value</a>(variables);
<a name="l01224"></a>01224             <span class="keywordflow">break</span>;
<a name="l01225"></a>01225          }
<a name="l01226"></a>01226       }
<a name="l01227"></a>01227       <span class="keywordflow">if</span> (places[i] == &amp;globals)
<a name="l01228"></a>01228          <a class="code" href="lock_8h.html#97ed909ef0a0582cf3870dd0629852c8">ast_rwlock_unlock</a>(&amp;globalslock);
<a name="l01229"></a>01229    }
<a name="l01230"></a>01230    <span class="keywordflow">if</span> (s == &amp;not_found || s == NULL)
<a name="l01231"></a>01231       *ret = NULL;
<a name="l01232"></a>01232    <span class="keywordflow">else</span> {
<a name="l01233"></a>01233       <span class="keywordflow">if</span> (s != workspace)
<a name="l01234"></a>01234          ast_copy_string(workspace, s, workspacelen);
<a name="l01235"></a>01235       *ret = workspace;
<a name="l01236"></a>01236       <span class="keywordflow">if</span> (need_substring)
<a name="l01237"></a>01237          *ret = <a class="code" href="pbx_8c.html#04e7768e5fe29c8e12f2f22671d1b63d">substring</a>(*ret, offset, length, workspace, workspacelen);
<a name="l01238"></a>01238    }
<a name="l01239"></a>01239 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ea7c4ebeb23de4a6efa64ef901058db6"></a><!-- doxytag: member="pbx.c::pbx_set_autofallthrough" ref="ea7c4ebeb23de4a6efa64ef901058db6" args="(int newval)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int pbx_set_autofallthrough           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>newval</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set "autofallthrough" flag, if newval is &lt;0, does not acutally set. If set to 1, sets to auto fall through. If newval set to 0, sets to no auto fall through (reads extension instead). Returns previous value. 
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02590">2590</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00249">autofallthrough</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01596">pbx_load_module()</a>.<div class="fragment"><pre class="fragment"><a name="l02591"></a>02591 {
<a name="l02592"></a>02592    <span class="keywordtype">int</span> oldval = <a class="code" href="pbx_8c.html#509cd842fa6ca4f1b6be7d908dbedf09">autofallthrough</a>;
<a name="l02593"></a>02593    <a class="code" href="pbx_8c.html#509cd842fa6ca4f1b6be7d908dbedf09">autofallthrough</a> = newval;
<a name="l02594"></a>02594    <span class="keywordflow">return</span> oldval;
<a name="l02595"></a>02595 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="120f5033eea8bea86259e519eefbbfe2"></a><!-- doxytag: member="pbx.c::pbx_substitute_variables" ref="120f5033eea8bea86259e519eefbbfe2" args="(char *passdata, int datalen, struct ast_channel *c, struct ast_exten *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void pbx_substitute_variables           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>passdata</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>datalen</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01670">1670</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00127">ast_exten::data</a>, and <a class="el" href="pbx_8c-source.html#l01660">pbx_substitute_variables_helper()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l01671"></a>01671 {
<a name="l01672"></a>01672    memset(passdata, 0, datalen);
<a name="l01673"></a>01673 
<a name="l01674"></a>01674    <span class="comment">/* No variables or expressions in e-&gt;data, so why scan it? */</span>
<a name="l01675"></a>01675    <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a> &amp;&amp; !strchr(e-&gt;<a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a>, <span class="charliteral">'$'</span>) &amp;&amp; !strstr(e-&gt;<a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a>,<span class="stringliteral">"${"</span>) &amp;&amp; !strstr(e-&gt;<a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a>,<span class="stringliteral">"$["</span>) &amp;&amp; !strstr(e-&gt;<a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a>,<span class="stringliteral">"$("</span>)) {
<a name="l01676"></a>01676       ast_copy_string(passdata, e-&gt;<a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a>, datalen);
<a name="l01677"></a>01677       <span class="keywordflow">return</span>;
<a name="l01678"></a>01678    }
<a name="l01679"></a>01679 
<a name="l01680"></a>01680    <a class="code" href="pbx_8c.html#7f62e5d5f926a2eeedb559b6afd3d80a">pbx_substitute_variables_helper</a>(c, e-&gt;<a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a>, passdata, datalen - 1);
<a name="l01681"></a>01681 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="7f62e5d5f926a2eeedb559b6afd3d80a"></a><!-- doxytag: member="pbx.c::pbx_substitute_variables_helper" ref="7f62e5d5f926a2eeedb559b6afd3d80a" args="(struct ast_channel *c, const char *cp1, char *cp2, int count)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pbx_substitute_variables_helper           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cp1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cp2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>count</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01660">1660</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l01468">pbx_substitute_variables_helper_full()</a>, and <a class="el" href="channel_8h-source.html#l00467">ast_channel::varshead</a>.
<p>
Referenced by <a class="el" href="func__odbc_8c-source.html#l00199">acf_odbc_read()</a>, <a class="el" href="func__odbc_8c-source.html#l00099">acf_odbc_write()</a>, <a class="el" href="cdr__custom_8c-source.html#l00106">custom_log()</a>, <a class="el" href="func__cut_8c-source.html#l00118">cut_internal()</a>, <a class="el" href="app__exec_8c-source.html#l00091">exec_exec()</a>, <a class="el" href="func__strings_8c-source.html#l00681">function_eval()</a>, <a class="el" href="func__strings_8c-source.html#l00048">function_fieldqty()</a>, <a class="el" href="pbx__dundi_8c-source.html#l00519">get_mapping_weight()</a>, <a class="el" href="res__agi_8c-source.html#l01210">handle_getvariablefull()</a>, <a class="el" href="app__mixmonitor_8c-source.html#l00229">launch_monitor_thread()</a>, <a class="el" href="app__voicemail_8c-source.html#l01965">make_email_file()</a>, <a class="el" href="pbx_8c-source.html#l05901">pbx_builtin_importvar()</a>, <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01332">pbx_load_config()</a>, <a class="el" href="pbx_8c-source.html#l01670">pbx_substitute_variables()</a>, <a class="el" href="pbx__realtime_8c-source.html#l00174">realtime_exec()</a>, <a class="el" href="app__rpt_8c-source.html#l01329">rpt_do_lstats()</a>, <a class="el" href="app__rpt_8c-source.html#l06759">rpt_exec()</a>, <a class="el" href="app__minivm_8c-source.html#l00892">sendmail()</a>, <a class="el" href="app__voicemail_8c-source.html#l02166">sendpage()</a>, <a class="el" href="cdr__sqlite3__custom_8c-source.html#l00151">sqlite3_log()</a>, <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>, and <a class="el" href="app__exec_8c-source.html#l00126">tryexec_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l01661"></a>01661 {
<a name="l01662"></a>01662    <a class="code" href="pbx_8c.html#8055099d4774142bb312da4f1e35be1e">pbx_substitute_variables_helper_full</a>(c, (c) ? &amp;c-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a> : NULL, cp1, cp2, count);
<a name="l01663"></a>01663 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8055099d4774142bb312da4f1e35be1e"></a><!-- doxytag: member="pbx.c::pbx_substitute_variables_helper_full" ref="8055099d4774142bb312da4f1e35be1e" args="(struct ast_channel *c, struct varshead *headp, const char *cp1, char *cp2, int count)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void pbx_substitute_variables_helper_full           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct varshead *&nbsp;</td>
          <td class="mdname" nowrap> <em>headp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cp1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cp2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>count</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01468">1468</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l00632">ast_channel_alloc()</a>, <a class="el" href="channel_8c-source.html#l01069">ast_channel_free()</a>, <a class="el" href="ast__expr2f_8c-source.html#l03097">ast_expr()</a>, <a class="el" href="pbx_8c-source.html#l01437">ast_func_read()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="utils_8h-source.html#l00386">len</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, <a class="el" href="logger_8h-source.html#l00106">LOG_NOTICE</a>, <a class="el" href="chan__alsa_8c-source.html#l00183">offset</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="pbx_8c-source.html#l01060">parse_variable_name()</a>, <a class="el" href="pbx_8c-source.html#l01132">pbx_retrieve_variable()</a>, <a class="el" href="pbx_8c-source.html#l01090">substring()</a>, <a class="el" href="ast__expr2f_8c-source.html#l01417">var</a>, <a class="el" href="pbx_8c-source.html#l00085">VAR_BUF_SIZE</a>, and <a class="el" href="channel_8h-source.html#l00467">ast_channel::varshead</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l01660">pbx_substitute_variables_helper()</a>, and <a class="el" href="pbx_8c-source.html#l01665">pbx_substitute_variables_varshead()</a>.<div class="fragment"><pre class="fragment"><a name="l01469"></a>01469 {
<a name="l01470"></a>01470    <span class="comment">/* Substitutes variables into cp2, based on string cp1, and assuming cp2 to be</span>
<a name="l01471"></a>01471 <span class="comment">      zero-filled */</span>
<a name="l01472"></a>01472    <span class="keywordtype">char</span> *cp4;
<a name="l01473"></a>01473    <span class="keyword">const</span> <span class="keywordtype">char</span> *tmp, *whereweare;
<a name="l01474"></a>01474    <span class="keywordtype">int</span> length, <a class="code" href="chan__alsa_8c.html#7a86c157ee9713c34fbd7a1ee40f0c5a">offset</a>, offset2, isfunction;
<a name="l01475"></a>01475    <span class="keywordtype">char</span> *workspace = NULL;
<a name="l01476"></a>01476    <span class="keywordtype">char</span> *ltmp = NULL, *<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a> = NULL;
<a name="l01477"></a>01477    <span class="keywordtype">char</span> *nextvar, *nextexp, *nextthing;
<a name="l01478"></a>01478    <span class="keywordtype">char</span> *vars, *vare;
<a name="l01479"></a>01479    <span class="keywordtype">int</span> pos, brackets, needsub, <a class="code" href="utils_8h.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a>;
<a name="l01480"></a>01480 
<a name="l01481"></a>01481    whereweare=tmp=cp1;
<a name="l01482"></a>01482    <span class="keywordflow">while</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(whereweare) &amp;&amp; count) {
<a name="l01483"></a>01483       <span class="comment">/* Assume we're copying the whole remaining string */</span>
<a name="l01484"></a>01484       pos = strlen(whereweare);
<a name="l01485"></a>01485       nextvar = NULL;
<a name="l01486"></a>01486       nextexp = NULL;
<a name="l01487"></a>01487       nextthing = strchr(whereweare, <span class="charliteral">'$'</span>);
<a name="l01488"></a>01488       <span class="keywordflow">if</span> (nextthing) {
<a name="l01489"></a>01489          <span class="keywordflow">switch</span> (nextthing[1]) {
<a name="l01490"></a>01490          <span class="keywordflow">case</span> <span class="charliteral">'{'</span>:
<a name="l01491"></a>01491             nextvar = nextthing;
<a name="l01492"></a>01492             pos = nextvar - whereweare;
<a name="l01493"></a>01493             <span class="keywordflow">break</span>;
<a name="l01494"></a>01494          <span class="keywordflow">case</span> <span class="charliteral">'['</span>:
<a name="l01495"></a>01495             nextexp = nextthing;
<a name="l01496"></a>01496             pos = nextexp - whereweare;
<a name="l01497"></a>01497             <span class="keywordflow">break</span>;
<a name="l01498"></a>01498          }
<a name="l01499"></a>01499       }
<a name="l01500"></a>01500 
<a name="l01501"></a>01501       <span class="keywordflow">if</span> (pos) {
<a name="l01502"></a>01502          <span class="comment">/* Can't copy more than 'count' bytes */</span>
<a name="l01503"></a>01503          <span class="keywordflow">if</span> (pos &gt; count)
<a name="l01504"></a>01504             pos = count;
<a name="l01505"></a>01505 
<a name="l01506"></a>01506          <span class="comment">/* Copy that many bytes */</span>
<a name="l01507"></a>01507          memcpy(cp2, whereweare, pos);
<a name="l01508"></a>01508 
<a name="l01509"></a>01509          count -= pos;
<a name="l01510"></a>01510          cp2 += pos;
<a name="l01511"></a>01511          whereweare += pos;
<a name="l01512"></a>01512       }
<a name="l01513"></a>01513 
<a name="l01514"></a>01514       <span class="keywordflow">if</span> (nextvar) {
<a name="l01515"></a>01515          <span class="comment">/* We have a variable.  Find the start and end, and determine</span>
<a name="l01516"></a>01516 <span class="comment">            if we are going to have to recursively call ourselves on the</span>
<a name="l01517"></a>01517 <span class="comment">            contents */</span>
<a name="l01518"></a>01518          vars = vare = nextvar + 2;
<a name="l01519"></a>01519          brackets = 1;
<a name="l01520"></a>01520          needsub = 0;
<a name="l01521"></a>01521 
<a name="l01522"></a>01522          <span class="comment">/* Find the end of it */</span>
<a name="l01523"></a>01523          <span class="keywordflow">while</span> (brackets &amp;&amp; *vare) {
<a name="l01524"></a>01524             <span class="keywordflow">if</span> ((vare[0] == <span class="charliteral">'$'</span>) &amp;&amp; (vare[1] == <span class="charliteral">'{'</span>)) {
<a name="l01525"></a>01525                needsub++;
<a name="l01526"></a>01526             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (vare[0] == <span class="charliteral">'{'</span>) {
<a name="l01527"></a>01527                brackets++;
<a name="l01528"></a>01528             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (vare[0] == <span class="charliteral">'}'</span>) {
<a name="l01529"></a>01529                brackets--;
<a name="l01530"></a>01530             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((vare[0] == <span class="charliteral">'$'</span>) &amp;&amp; (vare[1] == <span class="charliteral">'['</span>))
<a name="l01531"></a>01531                needsub++;
<a name="l01532"></a>01532             vare++;
<a name="l01533"></a>01533          }
<a name="l01534"></a>01534          <span class="keywordflow">if</span> (brackets)
<a name="l01535"></a>01535             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#bbf95aad74d847cd4bcb129604f798cd">LOG_NOTICE</a>, <span class="stringliteral">"Error in extension logic (missing '}')\n"</span>);
<a name="l01536"></a>01536          len = vare - vars - 1;
<a name="l01537"></a>01537 
<a name="l01538"></a>01538          <span class="comment">/* Skip totally over variable string */</span>
<a name="l01539"></a>01539          whereweare += (len + 3);
<a name="l01540"></a>01540 
<a name="l01541"></a>01541          <span class="keywordflow">if</span> (!var)
<a name="l01542"></a>01542             var = alloca(<a class="code" href="pbx_8c.html#970eeb66b59dcceec190d4d3147cb12f">VAR_BUF_SIZE</a>);
<a name="l01543"></a>01543 
<a name="l01544"></a>01544          <span class="comment">/* Store variable name (and truncate) */</span>
<a name="l01545"></a>01545          ast_copy_string(var, vars, len + 1);
<a name="l01546"></a>01546 
<a name="l01547"></a>01547          <span class="comment">/* Substitute if necessary */</span>
<a name="l01548"></a>01548          <span class="keywordflow">if</span> (needsub) {
<a name="l01549"></a>01549             <span class="keywordflow">if</span> (!ltmp)
<a name="l01550"></a>01550                ltmp = alloca(<a class="code" href="pbx_8c.html#970eeb66b59dcceec190d4d3147cb12f">VAR_BUF_SIZE</a>);
<a name="l01551"></a>01551 
<a name="l01552"></a>01552             memset(ltmp, 0, <a class="code" href="pbx_8c.html#970eeb66b59dcceec190d4d3147cb12f">VAR_BUF_SIZE</a>);
<a name="l01553"></a>01553             <a class="code" href="pbx_8c.html#8055099d4774142bb312da4f1e35be1e">pbx_substitute_variables_helper_full</a>(c, headp, var, ltmp, <a class="code" href="pbx_8c.html#970eeb66b59dcceec190d4d3147cb12f">VAR_BUF_SIZE</a> - 1);
<a name="l01554"></a>01554             vars = ltmp;
<a name="l01555"></a>01555          } <span class="keywordflow">else</span> {
<a name="l01556"></a>01556             vars = var;
<a name="l01557"></a>01557          }
<a name="l01558"></a>01558 
<a name="l01559"></a>01559          <span class="keywordflow">if</span> (!workspace)
<a name="l01560"></a>01560             workspace = alloca(<a class="code" href="pbx_8c.html#970eeb66b59dcceec190d4d3147cb12f">VAR_BUF_SIZE</a>);
<a name="l01561"></a>01561 
<a name="l01562"></a>01562          workspace[0] = <span class="charliteral">'\0'</span>;
<a name="l01563"></a>01563 
<a name="l01564"></a>01564          <a class="code" href="pbx_8c.html#1f596dad2120f1ef7d9cceea084686cc">parse_variable_name</a>(vars, &amp;offset, &amp;offset2, &amp;isfunction);
<a name="l01565"></a>01565          <span class="keywordflow">if</span> (isfunction) {
<a name="l01566"></a>01566             <span class="comment">/* Evaluate function */</span>
<a name="l01567"></a>01567             <span class="keywordflow">if</span> (c || !headp)
<a name="l01568"></a>01568                cp4 = <a class="code" href="pbx_8c.html#fc067f1890b3fdeeacbc538e92a39fbd">ast_func_read</a>(c, vars, workspace, <a class="code" href="pbx_8c.html#970eeb66b59dcceec190d4d3147cb12f">VAR_BUF_SIZE</a>) ? NULL : workspace;
<a name="l01569"></a>01569             <span class="keywordflow">else</span> {
<a name="l01570"></a>01570                <span class="keyword">struct </span>varshead old;
<a name="l01571"></a>01571                <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *c = <a class="code" href="channel_8c.html#3e12df96f6a8fc8b7293ad03b29c729f">ast_channel_alloc</a>(0, 0, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, 0, <span class="stringliteral">"Bogus/%p"</span>, vars);
<a name="l01572"></a>01572                <span class="keywordflow">if</span> (c) {
<a name="l01573"></a>01573                   memcpy(&amp;old, &amp;c-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>, <span class="keyword">sizeof</span>(old));
<a name="l01574"></a>01574                   memcpy(&amp;c-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>, headp, <span class="keyword">sizeof</span>(c-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>));
<a name="l01575"></a>01575                   cp4 = <a class="code" href="pbx_8c.html#fc067f1890b3fdeeacbc538e92a39fbd">ast_func_read</a>(c, vars, workspace, <a class="code" href="pbx_8c.html#970eeb66b59dcceec190d4d3147cb12f">VAR_BUF_SIZE</a>) ? NULL : workspace;
<a name="l01576"></a>01576                   <span class="comment">/* Don't deallocate the varshead that was passed in */</span>
<a name="l01577"></a>01577                   memcpy(&amp;c-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>, &amp;old, <span class="keyword">sizeof</span>(c-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>));
<a name="l01578"></a>01578                   <a class="code" href="channel_8c.html#230a804b09060fecdf699c2c9613fff7">ast_channel_free</a>(c);
<a name="l01579"></a>01579                } <span class="keywordflow">else</span>
<a name="l01580"></a>01580                   <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Unable to allocate bogus channel for variable substitution.  Function results may be blank.\n"</span>);
<a name="l01581"></a>01581             }
<a name="l01582"></a>01582             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l01583"></a>01583                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Function result is '%s'\n"</span>, cp4 ? cp4 : <span class="stringliteral">"(null)"</span>);
<a name="l01584"></a>01584          } <span class="keywordflow">else</span> {
<a name="l01585"></a>01585             <span class="comment">/* Retrieve variable value */</span>
<a name="l01586"></a>01586             <a class="code" href="pbx_8c.html#2753b759766c3d305e2551f63e403677">pbx_retrieve_variable</a>(c, vars, &amp;cp4, workspace, <a class="code" href="pbx_8c.html#970eeb66b59dcceec190d4d3147cb12f">VAR_BUF_SIZE</a>, headp);
<a name="l01587"></a>01587          }
<a name="l01588"></a>01588          <span class="keywordflow">if</span> (cp4) {
<a name="l01589"></a>01589             cp4 = <a class="code" href="pbx_8c.html#04e7768e5fe29c8e12f2f22671d1b63d">substring</a>(cp4, offset, offset2, workspace, <a class="code" href="pbx_8c.html#970eeb66b59dcceec190d4d3147cb12f">VAR_BUF_SIZE</a>);
<a name="l01590"></a>01590 
<a name="l01591"></a>01591             length = strlen(cp4);
<a name="l01592"></a>01592             <span class="keywordflow">if</span> (length &gt; count)
<a name="l01593"></a>01593                length = count;
<a name="l01594"></a>01594             memcpy(cp2, cp4, length);
<a name="l01595"></a>01595             count -= length;
<a name="l01596"></a>01596             cp2 += length;
<a name="l01597"></a>01597          }
<a name="l01598"></a>01598       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nextexp) {
<a name="l01599"></a>01599          <span class="comment">/* We have an expression.  Find the start and end, and determine</span>
<a name="l01600"></a>01600 <span class="comment">            if we are going to have to recursively call ourselves on the</span>
<a name="l01601"></a>01601 <span class="comment">            contents */</span>
<a name="l01602"></a>01602          vars = vare = nextexp + 2;
<a name="l01603"></a>01603          brackets = 1;
<a name="l01604"></a>01604          needsub = 0;
<a name="l01605"></a>01605 
<a name="l01606"></a>01606          <span class="comment">/* Find the end of it */</span>
<a name="l01607"></a>01607          <span class="keywordflow">while</span> (brackets &amp;&amp; *vare) {
<a name="l01608"></a>01608             <span class="keywordflow">if</span> ((vare[0] == <span class="charliteral">'$'</span>) &amp;&amp; (vare[1] == <span class="charliteral">'['</span>)) {
<a name="l01609"></a>01609                needsub++;
<a name="l01610"></a>01610                brackets++;
<a name="l01611"></a>01611                vare++;
<a name="l01612"></a>01612             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (vare[0] == <span class="charliteral">'['</span>) {
<a name="l01613"></a>01613                brackets++;
<a name="l01614"></a>01614             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (vare[0] == <span class="charliteral">']'</span>) {
<a name="l01615"></a>01615                brackets--;
<a name="l01616"></a>01616             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((vare[0] == <span class="charliteral">'$'</span>) &amp;&amp; (vare[1] == <span class="charliteral">'{'</span>)) {
<a name="l01617"></a>01617                needsub++;
<a name="l01618"></a>01618                vare++;
<a name="l01619"></a>01619             }
<a name="l01620"></a>01620             vare++;
<a name="l01621"></a>01621          }
<a name="l01622"></a>01622          <span class="keywordflow">if</span> (brackets)
<a name="l01623"></a>01623             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#bbf95aad74d847cd4bcb129604f798cd">LOG_NOTICE</a>, <span class="stringliteral">"Error in extension logic (missing ']')\n"</span>);
<a name="l01624"></a>01624          len = vare - vars - 1;
<a name="l01625"></a>01625 
<a name="l01626"></a>01626          <span class="comment">/* Skip totally over expression */</span>
<a name="l01627"></a>01627          whereweare += (len + 3);
<a name="l01628"></a>01628 
<a name="l01629"></a>01629          <span class="keywordflow">if</span> (!var)
<a name="l01630"></a>01630             var = alloca(<a class="code" href="pbx_8c.html#970eeb66b59dcceec190d4d3147cb12f">VAR_BUF_SIZE</a>);
<a name="l01631"></a>01631 
<a name="l01632"></a>01632          <span class="comment">/* Store variable name (and truncate) */</span>
<a name="l01633"></a>01633          ast_copy_string(var, vars, len + 1);
<a name="l01634"></a>01634 
<a name="l01635"></a>01635          <span class="comment">/* Substitute if necessary */</span>
<a name="l01636"></a>01636          <span class="keywordflow">if</span> (needsub) {
<a name="l01637"></a>01637             <span class="keywordflow">if</span> (!ltmp)
<a name="l01638"></a>01638                ltmp = alloca(<a class="code" href="pbx_8c.html#970eeb66b59dcceec190d4d3147cb12f">VAR_BUF_SIZE</a>);
<a name="l01639"></a>01639 
<a name="l01640"></a>01640             memset(ltmp, 0, <a class="code" href="pbx_8c.html#970eeb66b59dcceec190d4d3147cb12f">VAR_BUF_SIZE</a>);
<a name="l01641"></a>01641             <a class="code" href="pbx_8c.html#8055099d4774142bb312da4f1e35be1e">pbx_substitute_variables_helper_full</a>(c, headp, var, ltmp, <a class="code" href="pbx_8c.html#970eeb66b59dcceec190d4d3147cb12f">VAR_BUF_SIZE</a> - 1);
<a name="l01642"></a>01642             vars = ltmp;
<a name="l01643"></a>01643          } <span class="keywordflow">else</span> {
<a name="l01644"></a>01644             vars = var;
<a name="l01645"></a>01645          }
<a name="l01646"></a>01646 
<a name="l01647"></a>01647          length = <a class="code" href="ast__expr2f_8c.html#ba551f4bc61114d2514c037ff14a9259">ast_expr</a>(vars, cp2, count);
<a name="l01648"></a>01648 
<a name="l01649"></a>01649          <span class="keywordflow">if</span> (length) {
<a name="l01650"></a>01650             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l01651"></a>01651                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Expression result is '%s'\n"</span>, cp2);
<a name="l01652"></a>01652             count -= length;
<a name="l01653"></a>01653             cp2 += length;
<a name="l01654"></a>01654          }
<a name="l01655"></a>01655       } <span class="keywordflow">else</span>
<a name="l01656"></a>01656          <span class="keywordflow">break</span>;
<a name="l01657"></a>01657    }
<a name="l01658"></a>01658 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="9c87adf1e75b8a9298ffc59378531172"></a><!-- doxytag: member="pbx.c::pbx_substitute_variables_varshead" ref="9c87adf1e75b8a9298ffc59378531172" args="(struct varshead *headp, const char *cp1, char *cp2, int count)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pbx_substitute_variables_varshead           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct varshead *&nbsp;</td>
          <td class="mdname" nowrap> <em>headp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cp1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cp2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>count</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01665">1665</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l01468">pbx_substitute_variables_helper_full()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04765">ast_add_extension2()</a>, <a class="el" href="app__playback_8c-source.html#l00147">do_say()</a>, <a class="el" href="pbx__dundi_8c-source.html#l00532">dundi_lookup_local()</a>, and <a class="el" href="pbx__loopback_8c-source.html#l00083">loopback_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l01666"></a>01666 {
<a name="l01667"></a>01667    <a class="code" href="pbx_8c.html#8055099d4774142bb312da4f1e35be1e">pbx_substitute_variables_helper_full</a>(NULL, headp, cp1, cp2, count);
<a name="l01668"></a>01668 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b3150b6a7a36bf2a840a8d53b01a36c9"></a><!-- doxytag: member="pbx.c::pbx_thread" ref="b3150b6a7a36bf2a840a8d53b01a36c9" args="(void *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void* pbx_thread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>data</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02531">2531</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>, and <a class="el" href="pbx_8c-source.html#l02513">decrease_call_count()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02551">ast_pbx_start()</a>.<div class="fragment"><pre class="fragment"><a name="l02532"></a>02532 {
<a name="l02533"></a>02533    <span class="comment">/* Oh joyeous kernel, we're a new thread, with nothing to do but</span>
<a name="l02534"></a>02534 <span class="comment">      answer this channel and get it going.</span>
<a name="l02535"></a>02535 <span class="comment">   */</span>
<a name="l02536"></a>02536    <span class="comment">/* NOTE:</span>
<a name="l02537"></a>02537 <span class="comment">      The launcher of this function _MUST_ increment 'countcalls'</span>
<a name="l02538"></a>02538 <span class="comment">      before invoking the function; it will be decremented when the</span>
<a name="l02539"></a>02539 <span class="comment">      PBX has finished running on the channel</span>
<a name="l02540"></a>02540 <span class="comment">    */</span>
<a name="l02541"></a>02541    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *c = <a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a>;
<a name="l02542"></a>02542 
<a name="l02543"></a>02543    <a class="code" href="pbx_8c.html#d6a76cc38fc49b50acb5368a81899555">__ast_pbx_run</a>(c);
<a name="l02544"></a>02544    <a class="code" href="pbx_8c.html#2cf1332e5b45c96d7508015a47e21b84">decrease_call_count</a>();
<a name="l02545"></a>02545 
<a name="l02546"></a>02546    pthread_exit(NULL);
<a name="l02547"></a>02547 
<a name="l02548"></a>02548    <span class="keywordflow">return</span> NULL;
<a name="l02549"></a>02549 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="cadc5d14cfbc397e43547db54a585a56"></a><!-- doxytag: member="pbx.c::print_ext" ref="cadc5d14cfbc397e43547db54a585a56" args="(struct ast_exten *e, char *buf, int buflen)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void print_ext           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>buflen</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
helper function to print an extension 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03315">3315</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06168">ast_get_extension_app()</a>, <a class="el" href="pbx_8c-source.html#l06173">ast_get_extension_app_data()</a>, <a class="el" href="pbx_8c-source.html#l06130">ast_get_extension_priority()</a>, and <a class="el" href="pbx_8h-source.html#l00044">PRIORITY_HINT</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l03316"></a>03316 {
<a name="l03317"></a>03317    <span class="keywordtype">int</span> prio = <a class="code" href="pbx_8c.html#ecebedf381a09dd2630dc03e49b83112">ast_get_extension_priority</a>(e);
<a name="l03318"></a>03318    <span class="keywordflow">if</span> (prio == <a class="code" href="pbx_8h.html#ab1e94ec9073ecc8bcedd7b11dd82001">PRIORITY_HINT</a>) {
<a name="l03319"></a>03319       snprintf(<a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>, buflen, <span class="stringliteral">"hint: %s"</span>,
<a name="l03320"></a>03320          <a class="code" href="pbx_8c.html#c8eaa4fc248390fee258e7d2b2ff3490">ast_get_extension_app</a>(e));
<a name="l03321"></a>03321    } <span class="keywordflow">else</span> {
<a name="l03322"></a>03322       snprintf(<a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>, buflen, <span class="stringliteral">"%d. %s(%s)"</span>,
<a name="l03323"></a>03323          prio, <a class="code" href="pbx_8c.html#c8eaa4fc248390fee258e7d2b2ff3490">ast_get_extension_app</a>(e),
<a name="l03324"></a>03324          (<span class="keywordtype">char</span> *)<a class="code" href="pbx_8c.html#4a723bd9d782fe0a3fb16d00268ec5a4">ast_get_extension_app_data</a>(e));
<a name="l03325"></a>03325    }
<a name="l03326"></a>03326 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="09e258d284c6e074e06ec6e73fb5886e"></a><!-- doxytag: member="pbx.c::set_ext_pri" ref="09e258d284c6e074e06ec6e73fb5886e" args="(struct ast_channel *c, const char *exten, int pri)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void set_ext_pri           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pri</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02214">2214</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00442">ast_channel::exten</a>, and <a class="el" href="channel_8h-source.html#l00443">ast_channel::priority</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>, <a class="el" href="pbx_8c-source.html#l04991">ast_pbx_outgoing_exten()</a>, and <a class="el" href="pbx_8c-source.html#l05584">pbx_builtin_waitexten()</a>.<div class="fragment"><pre class="fragment"><a name="l02215"></a>02215 {
<a name="l02216"></a>02216    ast_copy_string(c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <span class="keyword">sizeof</span>(c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>));
<a name="l02217"></a>02217    c-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a> = pri;
<a name="l02218"></a>02218 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="493e8914a452df695fe1e0ac69d6aca3"></a><!-- doxytag: member="pbx.c::show_dialplan_helper" ref="493e8914a452df695fe1e0ac69d6aca3" args="(int fd, const char *context, const char *exten, struct dialplan_counters *dpc, struct ast_include *rinclude, int includecount, const char *includes[])" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int show_dialplan_helper           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structdialplan__counters.html">dialplan_counters</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>dpc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__include.html">ast_include</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>rinclude</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>includecount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>includes</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03329">3329</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="cli_8c-source.html#l00057">ast_cli()</a>, <a class="el" href="pbx_8c-source.html#l00877">ast_extension_match()</a>, <a class="el" href="pbx_8c-source.html#l06100">ast_get_context_name()</a>, <a class="el" href="pbx_8c-source.html#l06138">ast_get_context_registrar()</a>, <a class="el" href="pbx_8c-source.html#l06115">ast_get_extension_label()</a>, <a class="el" href="pbx_8c-source.html#l06110">ast_get_extension_name()</a>, <a class="el" href="pbx_8c-source.html#l06143">ast_get_extension_registrar()</a>, <a class="el" href="pbx_8c-source.html#l06125">ast_get_ignorepat_name()</a>, <a class="el" href="pbx_8c-source.html#l06153">ast_get_ignorepat_registrar()</a>, <a class="el" href="pbx_8c-source.html#l06120">ast_get_include_name()</a>, <a class="el" href="pbx_8c-source.html#l06148">ast_get_include_registrar()</a>, <a class="el" href="pbx_8c-source.html#l06183">ast_get_switch_data()</a>, <a class="el" href="pbx_8c-source.html#l06178">ast_get_switch_name()</a>, <a class="el" href="pbx_8c-source.html#l06188">ast_get_switch_registrar()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="channel_8h-source.html#l00139">AST_MAX_EXTENSION</a>, <a class="el" href="pbx_8c-source.html#l00543">AST_PBX_MAX_STACK</a>, <a class="el" href="pbx_8c-source.html#l06087">ast_rdlock_context()</a>, <a class="el" href="pbx_8c-source.html#l06069">ast_rdlock_contexts()</a>, <a class="el" href="pbx_8c-source.html#l06092">ast_unlock_context()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, <a class="el" href="pbx_8c-source.html#l06201">ast_walk_context_extensions()</a>, <a class="el" href="pbx_8c-source.html#l06234">ast_walk_context_ignorepats()</a>, <a class="el" href="pbx_8c-source.html#l06225">ast_walk_context_includes()</a>, <a class="el" href="pbx_8c-source.html#l06210">ast_walk_context_switches()</a>, <a class="el" href="pbx_8c-source.html#l06196">ast_walk_contexts()</a>, <a class="el" href="pbx_8c-source.html#l06219">ast_walk_extension_priorities()</a>, <a class="el" href="adsistub_8c-source.html#l00065">buf</a>, <a class="el" href="pbx_8c-source.html#l00121">ast_exten::cidmatch</a>, <a class="el" href="pbx_8c-source.html#l03310">dialplan_counters::context_existence</a>, <a class="el" href="asterisk_8c-source.html#l00199">el</a>, <a class="el" href="pbx_8c-source.html#l03311">dialplan_counters::extension_existence</a>, <a class="el" href="logger_8h-source.html#l00106">LOG_NOTICE</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="pbx_8c-source.html#l00120">ast_exten::matchcid</a>, <a class="el" href="pbx_8c-source.html#l03315">print_ext()</a>, <a class="el" href="pbx_8c-source.html#l03307">dialplan_counters::total_context</a>, <a class="el" href="pbx_8c-source.html#l03308">dialplan_counters::total_exten</a>, and <a class="el" href="pbx_8c-source.html#l03309">dialplan_counters::total_prio</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03480">handle_show_dialplan()</a>.<div class="fragment"><pre class="fragment"><a name="l03330"></a>03330 {
<a name="l03331"></a>03331    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = NULL;
<a name="l03332"></a>03332    <span class="keywordtype">int</span> res = 0, old_total_exten = dpc-&gt;<a class="code" href="structdialplan__counters.html#5d114b3c88c5a56e3372542b0505af59">total_exten</a>;
<a name="l03333"></a>03333 
<a name="l03334"></a>03334    <a class="code" href="pbx_8c.html#1b60f4b570102084989c86fd02ca6536">ast_rdlock_contexts</a>();
<a name="l03335"></a>03335 
<a name="l03336"></a>03336    <span class="comment">/* walk all contexts ... */</span>
<a name="l03337"></a>03337    <span class="keywordflow">while</span> ( (c = <a class="code" href="pbx_8c.html#709c9b64f2da1eaace237db32a5e1445">ast_walk_contexts</a>(c)) ) {
<a name="l03338"></a>03338       <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *e;
<a name="l03339"></a>03339       <span class="keyword">struct </span><a class="code" href="structast__include.html">ast_include</a> *i;
<a name="l03340"></a>03340       <span class="keyword">struct </span><a class="code" href="structast__ignorepat.html">ast_ignorepat</a> *ip;
<a name="l03341"></a>03341       <span class="keywordtype">char</span> <a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>[256], buf2[256];
<a name="l03342"></a>03342       <span class="keywordtype">int</span> context_info_printed = 0;
<a name="l03343"></a>03343 
<a name="l03344"></a>03344       <span class="keywordflow">if</span> (<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a> &amp;&amp; strcmp(<a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(c), <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>))
<a name="l03345"></a>03345          <span class="keywordflow">continue</span>;   <span class="comment">/* skip this one, name doesn't match */</span>
<a name="l03346"></a>03346 
<a name="l03347"></a>03347       dpc-&gt;<a class="code" href="structdialplan__counters.html#d83aeff98aa6828baafded23fc65db20">context_existence</a> = 1;
<a name="l03348"></a>03348 
<a name="l03349"></a>03349       <a class="code" href="pbx_8c.html#a09f0d0ac316a1ae5c74d6958d2b913e">ast_rdlock_context</a>(c);
<a name="l03350"></a>03350 
<a name="l03351"></a>03351       <span class="comment">/* are we looking for exten too? if yes, we print context</span>
<a name="l03352"></a>03352 <span class="comment">       * only if we find our extension.</span>
<a name="l03353"></a>03353 <span class="comment">       * Otherwise print context even if empty ?</span>
<a name="l03354"></a>03354 <span class="comment">       * XXX i am not sure how the rinclude is handled.</span>
<a name="l03355"></a>03355 <span class="comment">       * I think it ought to go inside.</span>
<a name="l03356"></a>03356 <span class="comment">       */</span>
<a name="l03357"></a>03357       <span class="keywordflow">if</span> (!<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>) {
<a name="l03358"></a>03358          dpc-&gt;<a class="code" href="structdialplan__counters.html#e56cfe3dac1f97235b12888a73e565a8">total_context</a>++;
<a name="l03359"></a>03359          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"[ Context '%s' created by '%s' ]\n"</span>,
<a name="l03360"></a>03360             <a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(c), <a class="code" href="pbx_8c.html#76308d8bcceb0331e0d4736df41b1412">ast_get_context_registrar</a>(c));
<a name="l03361"></a>03361          context_info_printed = 1;
<a name="l03362"></a>03362       }
<a name="l03363"></a>03363 
<a name="l03364"></a>03364       <span class="comment">/* walk extensions ... */</span>
<a name="l03365"></a>03365       e = NULL;
<a name="l03366"></a>03366       <span class="keywordflow">while</span> ( (e = <a class="code" href="pbx_8c.html#b3b7bf8e22da60a0df718a52f3424b79">ast_walk_context_extensions</a>(c, e)) ) {
<a name="l03367"></a>03367          <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *p;
<a name="l03368"></a>03368 
<a name="l03369"></a>03369          <span class="keywordflow">if</span> (<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a> &amp;&amp; !<a class="code" href="pbx_8c.html#fee4ebd3f1d86114fe9bb33931f9a6cf">ast_extension_match</a>(<a class="code" href="pbx_8c.html#4318ec15d92ac47de94902f6aba4c114">ast_get_extension_name</a>(e), <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>))
<a name="l03370"></a>03370             <span class="keywordflow">continue</span>;   <span class="comment">/* skip, extension match failed */</span>
<a name="l03371"></a>03371 
<a name="l03372"></a>03372          dpc-&gt;<a class="code" href="structdialplan__counters.html#bdd2eb943b642d347ef6b674e1e2218c">extension_existence</a> = 1;
<a name="l03373"></a>03373 
<a name="l03374"></a>03374          <span class="comment">/* may we print context info? */</span>
<a name="l03375"></a>03375          <span class="keywordflow">if</span> (!context_info_printed) {
<a name="l03376"></a>03376             dpc-&gt;<a class="code" href="structdialplan__counters.html#e56cfe3dac1f97235b12888a73e565a8">total_context</a>++;
<a name="l03377"></a>03377             <span class="keywordflow">if</span> (rinclude) { <span class="comment">/* TODO Print more info about rinclude */</span>
<a name="l03378"></a>03378                <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"[ Included context '%s' created by '%s' ]\n"</span>,
<a name="l03379"></a>03379                   <a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(c), <a class="code" href="pbx_8c.html#76308d8bcceb0331e0d4736df41b1412">ast_get_context_registrar</a>(c));
<a name="l03380"></a>03380             } <span class="keywordflow">else</span> {
<a name="l03381"></a>03381                <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"[ Context '%s' created by '%s' ]\n"</span>,
<a name="l03382"></a>03382                   <a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(c), <a class="code" href="pbx_8c.html#76308d8bcceb0331e0d4736df41b1412">ast_get_context_registrar</a>(c));
<a name="l03383"></a>03383             }
<a name="l03384"></a>03384             context_info_printed = 1;
<a name="l03385"></a>03385          }
<a name="l03386"></a>03386          dpc-&gt;<a class="code" href="structdialplan__counters.html#041d969e041f5ac8328a9422cf8a3cb1">total_prio</a>++;
<a name="l03387"></a>03387 
<a name="l03388"></a>03388          <span class="comment">/* write extension name and first peer */</span>
<a name="l03389"></a>03389          <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a>)
<a name="l03390"></a>03390             snprintf(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">"'%s' (CID match '%s') =&gt; "</span>, <a class="code" href="pbx_8c.html#4318ec15d92ac47de94902f6aba4c114">ast_get_extension_name</a>(e), e-&gt;<a class="code" href="structast__exten.html#2ef4524f32df05033fd0502689de872e">cidmatch</a>);
<a name="l03391"></a>03391          <span class="keywordflow">else</span>
<a name="l03392"></a>03392             snprintf(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">"'%s' =&gt;"</span>, <a class="code" href="pbx_8c.html#4318ec15d92ac47de94902f6aba4c114">ast_get_extension_name</a>(e));
<a name="l03393"></a>03393 
<a name="l03394"></a>03394          <a class="code" href="pbx_8c.html#cadc5d14cfbc397e43547db54a585a56">print_ext</a>(e, buf2, <span class="keyword">sizeof</span>(buf2));
<a name="l03395"></a>03395 
<a name="l03396"></a>03396          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"  %-17s %-45s [%s]\n"</span>, buf, buf2,
<a name="l03397"></a>03397             <a class="code" href="pbx_8c.html#20537e2517918a112d0b738d8c70cae2">ast_get_extension_registrar</a>(e));
<a name="l03398"></a>03398 
<a name="l03399"></a>03399          dpc-&gt;<a class="code" href="structdialplan__counters.html#5d114b3c88c5a56e3372542b0505af59">total_exten</a>++;
<a name="l03400"></a>03400          <span class="comment">/* walk next extension peers */</span>
<a name="l03401"></a>03401          p = e;   <span class="comment">/* skip the first one, we already got it */</span>
<a name="l03402"></a>03402          <span class="keywordflow">while</span> ( (p = <a class="code" href="pbx_8c.html#2ae60ad33dfd510584655331ac42b890">ast_walk_extension_priorities</a>(e, p)) ) {
<a name="l03403"></a>03403             <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="asterisk_8c.html#65c10911d8b8591219a21ebacf46da01">el</a> = <a class="code" href="pbx_8c.html#6647bb905ee41ab599c1e9bfe5f086de">ast_get_extension_label</a>(p);
<a name="l03404"></a>03404             dpc-&gt;<a class="code" href="structdialplan__counters.html#041d969e041f5ac8328a9422cf8a3cb1">total_prio</a>++;
<a name="l03405"></a>03405             <span class="keywordflow">if</span> (el)
<a name="l03406"></a>03406                snprintf(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">"   [%s]"</span>, el);
<a name="l03407"></a>03407             <span class="keywordflow">else</span>
<a name="l03408"></a>03408                buf[0] = <span class="charliteral">'\0'</span>;
<a name="l03409"></a>03409             <a class="code" href="pbx_8c.html#cadc5d14cfbc397e43547db54a585a56">print_ext</a>(p, buf2, <span class="keyword">sizeof</span>(buf2));
<a name="l03410"></a>03410 
<a name="l03411"></a>03411             <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd,<span class="stringliteral">"  %-17s %-45s [%s]\n"</span>, buf, buf2,
<a name="l03412"></a>03412                <a class="code" href="pbx_8c.html#20537e2517918a112d0b738d8c70cae2">ast_get_extension_registrar</a>(p));
<a name="l03413"></a>03413          }
<a name="l03414"></a>03414       }
<a name="l03415"></a>03415 
<a name="l03416"></a>03416       <span class="comment">/* walk included and write info ... */</span>
<a name="l03417"></a>03417       i = NULL;
<a name="l03418"></a>03418       <span class="keywordflow">while</span> ( (i = <a class="code" href="pbx_8c.html#ff52371424397442d32568beb910e153">ast_walk_context_includes</a>(c, i)) ) {
<a name="l03419"></a>03419          snprintf(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">"'%s'"</span>, <a class="code" href="pbx_8c.html#04500f482fe3f27ee84f53c832f49c92">ast_get_include_name</a>(i));
<a name="l03420"></a>03420          <span class="keywordflow">if</span> (<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>) {
<a name="l03421"></a>03421             <span class="comment">/* Check all includes for the requested extension */</span>
<a name="l03422"></a>03422             <span class="keywordflow">if</span> (includecount &gt;= <a class="code" href="pbx_8c.html#249ae5f11bddff7a9bda62683881685d">AST_PBX_MAX_STACK</a>) {
<a name="l03423"></a>03423                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#bbf95aad74d847cd4bcb129604f798cd">LOG_NOTICE</a>, <span class="stringliteral">"Maximum include depth exceeded!\n"</span>);
<a name="l03424"></a>03424             } <span class="keywordflow">else</span> {
<a name="l03425"></a>03425                <span class="keywordtype">int</span> dupe=0;
<a name="l03426"></a>03426                <span class="keywordtype">int</span> x;
<a name="l03427"></a>03427                <span class="keywordflow">for</span> (x=0;x&lt;includecount;x++) {
<a name="l03428"></a>03428                   <span class="keywordflow">if</span> (!strcasecmp(includes[x], <a class="code" href="pbx_8c.html#04500f482fe3f27ee84f53c832f49c92">ast_get_include_name</a>(i))) {
<a name="l03429"></a>03429                      dupe++;
<a name="l03430"></a>03430                      <span class="keywordflow">break</span>;
<a name="l03431"></a>03431                   }
<a name="l03432"></a>03432                }
<a name="l03433"></a>03433                <span class="keywordflow">if</span> (!dupe) {
<a name="l03434"></a>03434                   includes[includecount] = <a class="code" href="pbx_8c.html#04500f482fe3f27ee84f53c832f49c92">ast_get_include_name</a>(i);
<a name="l03435"></a>03435                   <a class="code" href="pbx_8c.html#493e8914a452df695fe1e0ac69d6aca3">show_dialplan_helper</a>(fd, <a class="code" href="pbx_8c.html#04500f482fe3f27ee84f53c832f49c92">ast_get_include_name</a>(i), <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, dpc, i, includecount + 1, includes);
<a name="l03436"></a>03436                } <span class="keywordflow">else</span> {
<a name="l03437"></a>03437                   <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Avoiding circular include of %s within %s\n"</span>, <a class="code" href="pbx_8c.html#04500f482fe3f27ee84f53c832f49c92">ast_get_include_name</a>(i), <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l03438"></a>03438                }
<a name="l03439"></a>03439             }
<a name="l03440"></a>03440          } <span class="keywordflow">else</span> {
<a name="l03441"></a>03441             <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"  Include =&gt;        %-45s [%s]\n"</span>,
<a name="l03442"></a>03442                buf, <a class="code" href="pbx_8c.html#a10e2a34982bf1e3c4df8fbf94a8f858">ast_get_include_registrar</a>(i));
<a name="l03443"></a>03443          }
<a name="l03444"></a>03444       }
<a name="l03445"></a>03445 
<a name="l03446"></a>03446       <span class="comment">/* walk ignore patterns and write info ... */</span>
<a name="l03447"></a>03447       ip = NULL;
<a name="l03448"></a>03448       <span class="keywordflow">while</span> ( (ip = <a class="code" href="pbx_8c.html#78f92771f39acc0696f7d12053ff4304">ast_walk_context_ignorepats</a>(c, ip)) ) {
<a name="l03449"></a>03449          <span class="keyword">const</span> <span class="keywordtype">char</span> *ipname = <a class="code" href="pbx_8c.html#8362b5fbecbf06d68596f1361a817971">ast_get_ignorepat_name</a>(ip);
<a name="l03450"></a>03450          <span class="keywordtype">char</span> ignorepat[<a class="code" href="channel_8h.html#729d25558b5b1940c1a6ff9d806f944c">AST_MAX_EXTENSION</a>];
<a name="l03451"></a>03451          snprintf(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">"'%s'"</span>, ipname);
<a name="l03452"></a>03452          snprintf(ignorepat, <span class="keyword">sizeof</span>(ignorepat), <span class="stringliteral">"_%s."</span>, ipname);
<a name="l03453"></a>03453          <span class="keywordflow">if</span> (!<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a> || <a class="code" href="pbx_8c.html#fee4ebd3f1d86114fe9bb33931f9a6cf">ast_extension_match</a>(ignorepat, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>)) {
<a name="l03454"></a>03454             <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"  Ignore pattern =&gt; %-45s [%s]\n"</span>,
<a name="l03455"></a>03455                buf, <a class="code" href="pbx_8c.html#ecf759381e5bb2d13dbf2188d6728217">ast_get_ignorepat_registrar</a>(ip));
<a name="l03456"></a>03456          }
<a name="l03457"></a>03457       }
<a name="l03458"></a>03458       <span class="keywordflow">if</span> (!rinclude) {
<a name="l03459"></a>03459          <span class="keyword">struct </span><a class="code" href="structast__sw.html">ast_sw</a> *sw = NULL;
<a name="l03460"></a>03460          <span class="keywordflow">while</span> ( (sw = <a class="code" href="pbx_8c.html#6cbdae284c7bcff5b16d687a1f60b61b">ast_walk_context_switches</a>(c, sw)) ) {
<a name="l03461"></a>03461             snprintf(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">"'%s/%s'"</span>,
<a name="l03462"></a>03462                <a class="code" href="pbx_8c.html#e78e1da5bf7f86cd550128a0cc440658">ast_get_switch_name</a>(sw),
<a name="l03463"></a>03463                <a class="code" href="pbx_8c.html#ee960249076eea022f3aaa855b0a2475">ast_get_switch_data</a>(sw));
<a name="l03464"></a>03464             <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"  Alt. Switch =&gt;    %-45s [%s]\n"</span>,
<a name="l03465"></a>03465                buf, <a class="code" href="pbx_8c.html#6e9fbaaa189820f4a0c36a1ad4dfca6d">ast_get_switch_registrar</a>(sw));
<a name="l03466"></a>03466          }
<a name="l03467"></a>03467       }
<a name="l03468"></a>03468 
<a name="l03469"></a>03469       <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(c);
<a name="l03470"></a>03470 
<a name="l03471"></a>03471       <span class="comment">/* if we print something in context, make an empty line */</span>
<a name="l03472"></a>03472       <span class="keywordflow">if</span> (context_info_printed)
<a name="l03473"></a>03473          <a class="code" href="cli_8c.html#b610d6e1fd70e1b164d66a2ee22207dc">ast_cli</a>(fd, <span class="stringliteral">"\r\n"</span>);
<a name="l03474"></a>03474    }
<a name="l03475"></a>03475    <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l03476"></a>03476 
<a name="l03477"></a>03477    <span class="keywordflow">return</span> (dpc-&gt;<a class="code" href="structdialplan__counters.html#5d114b3c88c5a56e3372542b0505af59">total_exten</a> == old_total_exten) ? -1 : res;
<a name="l03478"></a>03478 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="04e7768e5fe29c8e12f2f22671d1b63d"></a><!-- doxytag: member="pbx.c::substring" ref="04e7768e5fe29c8e12f2f22671d1b63d" args="(const char *value, int offset, int length, char *workspace, size_t workspace_len)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* substring           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>offset</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>workspace</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>workspace_len</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
takes a substring. It is ok to call with value == workspace. 
<p>
offset &lt; 0 means start from the end of the string and set the beginning to be that many characters back. length is the length of the substring. A value less than 0 means to leave that many off the end. Always return a copy in workspace. 
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01090">1090</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l01132">pbx_retrieve_variable()</a>, and <a class="el" href="pbx_8c-source.html#l01468">pbx_substitute_variables_helper_full()</a>.<div class="fragment"><pre class="fragment"><a name="l01091"></a>01091 {
<a name="l01092"></a>01092    <span class="keywordtype">char</span> *ret = workspace;
<a name="l01093"></a>01093    <span class="keywordtype">int</span> lr;  <span class="comment">/* length of the input string after the copy */</span>
<a name="l01094"></a>01094 
<a name="l01095"></a>01095    ast_copy_string(workspace, value, workspace_len); <span class="comment">/* always make a copy */</span>
<a name="l01096"></a>01096 
<a name="l01097"></a>01097    lr = strlen(ret); <span class="comment">/* compute length after copy, so we never go out of the workspace */</span>
<a name="l01098"></a>01098 
<a name="l01099"></a>01099    <span class="comment">/* Quick check if no need to do anything */</span>
<a name="l01100"></a>01100    <span class="keywordflow">if</span> (<a class="code" href="chan__alsa_8c.html#7a86c157ee9713c34fbd7a1ee40f0c5a">offset</a> == 0 &amp;&amp; length &gt;= lr) <span class="comment">/* take the whole string */</span>
<a name="l01101"></a>01101       <span class="keywordflow">return</span> ret;
<a name="l01102"></a>01102 
<a name="l01103"></a>01103    <span class="keywordflow">if</span> (<a class="code" href="chan__alsa_8c.html#7a86c157ee9713c34fbd7a1ee40f0c5a">offset</a> &lt; 0)   {  <span class="comment">/* translate negative offset into positive ones */</span>
<a name="l01104"></a>01104       <a class="code" href="chan__alsa_8c.html#7a86c157ee9713c34fbd7a1ee40f0c5a">offset</a> = lr + <a class="code" href="chan__alsa_8c.html#7a86c157ee9713c34fbd7a1ee40f0c5a">offset</a>;
<a name="l01105"></a>01105       <span class="keywordflow">if</span> (offset &lt; 0) <span class="comment">/* If the negative offset was greater than the length of the string, just start at the beginning */</span>
<a name="l01106"></a>01106          offset = 0;
<a name="l01107"></a>01107    }
<a name="l01108"></a>01108 
<a name="l01109"></a>01109    <span class="comment">/* too large offset result in empty string so we know what to return */</span>
<a name="l01110"></a>01110    <span class="keywordflow">if</span> (offset &gt;= lr)
<a name="l01111"></a>01111       <span class="keywordflow">return</span> ret + lr;  <span class="comment">/* the final '\0' */</span>
<a name="l01112"></a>01112 
<a name="l01113"></a>01113    ret += offset;    <span class="comment">/* move to the start position */</span>
<a name="l01114"></a>01114    <span class="keywordflow">if</span> (length &gt;= 0 &amp;&amp; length &lt; lr - offset)  <span class="comment">/* truncate if necessary */</span>
<a name="l01115"></a>01115       ret[length] = <span class="charliteral">'\0'</span>;
<a name="l01116"></a>01116    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (length &lt; 0) {
<a name="l01117"></a>01117       <span class="keywordflow">if</span> (lr &gt; offset - length) <span class="comment">/* After we remove from the front and from the rear, is there anything left? */</span>
<a name="l01118"></a>01118          ret[lr + length - offset] = <span class="charliteral">'\0'</span>;
<a name="l01119"></a>01119       <span class="keywordflow">else</span>
<a name="l01120"></a>01120          ret[0] = <span class="charliteral">'\0'</span>;
<a name="l01121"></a>01121    }
<a name="l01122"></a>01122 
<a name="l01123"></a>01123    <span class="keywordflow">return</span> ret;
<a name="l01124"></a>01124 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="de5c3078bd604949446521990a001661"></a><!-- doxytag: member="pbx.c::unreference_cached_app" ref="de5c3078bd604949446521990a001661" args="(struct ast_app *app)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void unreference_cached_app           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__app.html">ast_app</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>app</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03830">3830</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06069">ast_rdlock_contexts()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, <a class="el" href="pbx_8c-source.html#l06201">ast_walk_context_extensions()</a>, <a class="el" href="pbx_8c-source.html#l06196">ast_walk_contexts()</a>, <a class="el" href="pbx_8c-source.html#l06219">ast_walk_extension_priorities()</a>, and <a class="el" href="chan__alsa_8c-source.html#l00124">context</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03849">ast_unregister_application()</a>.<div class="fragment"><pre class="fragment"><a name="l03831"></a>03831 {
<a name="l03832"></a>03832    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a> = NULL;
<a name="l03833"></a>03833    <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *eroot = NULL, *e = NULL;
<a name="l03834"></a>03834 
<a name="l03835"></a>03835    <a class="code" href="pbx_8c.html#1b60f4b570102084989c86fd02ca6536">ast_rdlock_contexts</a>();
<a name="l03836"></a>03836    <span class="keywordflow">while</span> ((context = <a class="code" href="pbx_8c.html#709c9b64f2da1eaace237db32a5e1445">ast_walk_contexts</a>(context))) {
<a name="l03837"></a>03837       <span class="keywordflow">while</span> ((eroot = <a class="code" href="pbx_8c.html#b3b7bf8e22da60a0df718a52f3424b79">ast_walk_context_extensions</a>(context, eroot))) {
<a name="l03838"></a>03838          <span class="keywordflow">while</span> ((e = <a class="code" href="pbx_8c.html#2ae60ad33dfd510584655331ac42b890">ast_walk_extension_priorities</a>(eroot, e))) {
<a name="l03839"></a>03839             <span class="keywordflow">if</span> (e-&gt;cached_app == app)
<a name="l03840"></a>03840                e-&gt;cached_app = NULL;
<a name="l03841"></a>03841          }
<a name="l03842"></a>03842       }
<a name="l03843"></a>03843    }
<a name="l03844"></a>03844    <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l03845"></a>03845 
<a name="l03846"></a>03846    <span class="keywordflow">return</span>;
<a name="l03847"></a>03847 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b69d22624170b4f0d028586dceca5c98"></a><!-- doxytag: member="pbx.c::wait_for_hangup" ref="b69d22624170b4f0d028586dceca5c98" args="(struct ast_channel *chan, void *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void wait_for_hangup           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05351">5351</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="frame_8h-source.html#l00396">ast_frfree()</a>, <a class="el" href="channel_8c-source.html#l02438">ast_read()</a>, <a class="el" href="channel_8c-source.html#l01048">ast_safe_sleep()</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, and <a class="el" href="channel_8c-source.html#l01952">ast_waitfor()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l05394">pbx_builtin_busy()</a>, and <a class="el" href="pbx_8c-source.html#l05408">pbx_builtin_congestion()</a>.<div class="fragment"><pre class="fragment"><a name="l05352"></a>05352 {
<a name="l05353"></a>05353    <span class="keywordtype">int</span> res;
<a name="l05354"></a>05354    <span class="keyword">struct </span><a class="code" href="structast__frame.html">ast_frame</a> *<a class="code" href="format__g726_8c.html#85b9b17a7dd34a3638c560bc9152473b">f</a>;
<a name="l05355"></a>05355    <span class="keywordtype">double</span> waitsec;
<a name="l05356"></a>05356    <span class="keywordtype">int</span> waittime;
<a name="l05357"></a>05357 
<a name="l05358"></a>05358    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(<a class="code" href="structast__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a>) || (sscanf(<a class="code" href="structast__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a>, <span class="stringliteral">"%lg"</span>, &amp;waitsec) != 1) || (waitsec &lt; 0))
<a name="l05359"></a>05359       waitsec = -1;
<a name="l05360"></a>05360    <span class="keywordflow">if</span> (waitsec &gt; -1) {
<a name="l05361"></a>05361       waittime = waitsec * 1000.0;
<a name="l05362"></a>05362       <a class="code" href="channel_8c.html#24a36b04429e3cdef17e161363c13900">ast_safe_sleep</a>(chan, waittime);
<a name="l05363"></a>05363    } <span class="keywordflow">else</span> <span class="keywordflow">do</span> {
<a name="l05364"></a>05364       res = <a class="code" href="channel_8c.html#e02dcdf40023f275d4561a930e7a7fc9">ast_waitfor</a>(chan, -1);
<a name="l05365"></a>05365       <span class="keywordflow">if</span> (res &lt; 0)
<a name="l05366"></a>05366          <span class="keywordflow">return</span>;
<a name="l05367"></a>05367       f = <a class="code" href="channel_8c.html#1446a8c0bddf626bf26b000fbeae117f">ast_read</a>(chan);
<a name="l05368"></a>05368       <span class="keywordflow">if</span> (f)
<a name="l05369"></a>05369          <a class="code" href="frame_8h.html#506c759ec4950e7f7465e8f090a6252b">ast_frfree</a>(f);
<a name="l05370"></a>05370    } <span class="keywordflow">while</span>(f);
<a name="l05371"></a>05371 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="509cd842fa6ca4f1b6be7d908dbedf09"></a><!-- doxytag: member="pbx.c::autofallthrough" ref="509cd842fa6ca4f1b6be7d908dbedf09" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="pbx_8c.html#509cd842fa6ca4f1b6be7d908dbedf09">autofallthrough</a> = 1<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00249">249</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>, and <a class="el" href="pbx_8c-source.html#l02590">pbx_set_autofallthrough()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="7b94c2c41ed9fd600b9a19bb54467397"></a><!-- doxytag: member="pbx.c::builtins" ref="7b94c2c41ed9fd600b9a19bb54467397" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structpbx__builtin.html">pbx_builtin</a>  <a class="el" href="pbx__functions_8h.html#7b94c2c41ed9fd600b9a19bb54467397">builtins</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Declaration of builtin applications. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="9be90dc64c1f5b5c993ff11d732a8da0"></a><!-- doxytag: member="pbx.c::contexts" ref="9be90dc64c1f5b5c993ff11d732a8da0" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a>* <a class="el" href="pbx_8c.html#9be90dc64c1f5b5c993ff11d732a8da0">contexts</a><code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00489">489</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03870">__ast_context_create()</a>, <a class="el" href="pbx_8c-source.html#l05285">__ast_context_destroy()</a>, <a class="el" href="pbx_8c-source.html#l03936">ast_merge_contexts_and_delete()</a>, and <a class="el" href="pbx_8c-source.html#l06196">ast_walk_contexts()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3a9f90f51c55c02ddf6ad8e26249341"></a><!-- doxytag: member="pbx.c::countcalls" ref="a3a9f90f51c55c02ddf6ad8e26249341" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="pbx_8c.html#a3a9f90f51c55c02ddf6ad8e26249341">countcalls</a><code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00252">252</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02585">ast_active_calls()</a>, <a class="el" href="pbx_8c-source.html#l02513">decrease_call_count()</a>, and <a class="el" href="pbx_8c-source.html#l02468">increase_call_count()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="b926d07cd15d8fd1bdf2ab377f30ee25"></a><!-- doxytag: member="pbx.c::days" ref="b926d07cd15d8fd1bdf2ab377f30ee25" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char* <a class="el" href="pbx__ael_8c.html#b926d07cd15d8fd1bdf2ab377f30ee25">days</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04207">4207</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04236">ast_build_timing()</a>, and <a class="el" href="localtime_8c-source.html#l01106">timesub()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="63938e196e95ba3f1d098ec3884aca3a"></a><!-- doxytag: member="pbx.c::extension_states" ref="63938e196e95ba3f1d098ec3884aca3a" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const struct <a class="el" href="structcfextension__states.html">cfextension_states</a>  <a class="el" href="pbx_8c.html#63938e196e95ba3f1d098ec3884aca3a">extension_states</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="pbx_8c-source.html#l01897">ast_extension_state2str()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="0c54ed5f674437c1eba26ffc6c786909"></a><!-- doxytag: member="pbx.c::globals" ref="0c54ed5f674437c1eba26ffc6c786909" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct varshead <a class="el" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a> = AST_LIST_HEAD_NOLOCK_INIT_VALUE<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00247">247</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="120b7e9b0d3b3902740d7fa84fc826e0"></a><!-- doxytag: member="pbx.c::mandescr_show_dialplan" ref="120b7e9b0d3b3902740d7fa84fc826e0" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char <a class="el" href="pbx_8c.html#120b7e9b0d3b3902740d7fa84fc826e0">mandescr_show_dialplan</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03743">3743</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="aab8c6e8889bb80d928fd716f4406fe7"></a><!-- doxytag: member="pbx.c::months" ref="aab8c6e8889bb80d928fd716f4406fe7" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char* <a class="el" href="pbx__ael_8c.html#aab8c6e8889bb80d928fd716f4406fe7">months</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04219">4219</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04236">ast_build_timing()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="886f64036bf3be08de3c6f7561b0a8a9"></a><!-- doxytag: member="pbx.c::pbx_cli" ref="886f64036bf3be08de3c6f7561b0a8a9" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__cli__entry.html">ast_cli_entry</a> <a class="el" href="pbx_8c.html#886f64036bf3be08de3c6f7561b0a8a9">pbx_cli</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03786">3786</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="586c6f775ee412d509eb3cb70d6eac05"></a><!-- doxytag: member="pbx.c::set_global_help" ref="586c6f775ee412d509eb3cb70d6eac05" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char <a class="el" href="pbx_8c.html#586c6f775ee412d509eb3cb70d6eac05">set_global_help</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment">
<span class="stringliteral">"Usage: core set global &lt;name&gt; &lt;value&gt;\n"</span>
<span class="stringliteral">"       Set global dialplan variable &lt;name&gt; to &lt;value&gt;\n"</span>
</pre></div>
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02987">2987</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a728f41d27e67a35e149551889efef83"></a><!-- doxytag: member="pbx.c::show_application_help" ref="a728f41d27e67a35e149551889efef83" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char <a class="el" href="pbx_8c.html#a728f41d27e67a35e149551889efef83">show_application_help</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment">
<span class="stringliteral">"Usage: core show application &lt;application&gt; [&lt;application&gt; [&lt;application&gt; [...]]]\n"</span>
<span class="stringliteral">"       Describes a particular application.\n"</span>
</pre></div>
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02975">2975</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="acb375c2b811bbaa2cdf4f1f2e22a3f8"></a><!-- doxytag: member="pbx.c::show_applications_help" ref="acb375c2b811bbaa2cdf4f1f2e22a3f8" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char <a class="el" href="pbx_8c.html#acb375c2b811bbaa2cdf4f1f2e22a3f8">show_applications_help</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment">
<span class="stringliteral">"Usage: core show applications [{like|describing} &lt;text&gt;]\n"</span>
<span class="stringliteral">"       List applications which are currently available.\n"</span>
<span class="stringliteral">"       If 'like', &lt;text&gt; will be a substring of the app name\n"</span>
<span class="stringliteral">"       If 'describing', &lt;text&gt; will be a substring of the description\n"</span>
</pre></div>
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02953">2953</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="caed5cd8779909df29243c5312745a93"></a><!-- doxytag: member="pbx.c::show_dialplan_help" ref="caed5cd8779909df29243c5312745a93" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char <a class="el" href="pbx_8c.html#caed5cd8779909df29243c5312745a93">show_dialplan_help</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment">
<span class="stringliteral">"Usage: core show dialplan [exten@][context]\n"</span>
<span class="stringliteral">"       Show dialplan\n"</span>
</pre></div>
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02983">2983</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="aebbde3b9bb1f2fec03df913f71462d4"></a><!-- doxytag: member="pbx.c::show_function_help" ref="aebbde3b9bb1f2fec03df913f71462d4" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char <a class="el" href="pbx_8c.html#aebbde3b9bb1f2fec03df913f71462d4">show_function_help</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment">
<span class="stringliteral">"Usage: core show function &lt;function&gt;\n"</span>
<span class="stringliteral">"       Describe a particular dialplan function.\n"</span>
</pre></div>
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02979">2979</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="8c2e1c611eb7455205f1841d4c163736"></a><!-- doxytag: member="pbx.c::show_functions_help" ref="8c2e1c611eb7455205f1841d4c163736" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char <a class="el" href="pbx_8c.html#8c2e1c611eb7455205f1841d4c163736">show_functions_help</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment">
<span class="stringliteral">"Usage: core show functions [like &lt;text&gt;]\n"</span>
<span class="stringliteral">"       List builtin functions, optionally only those matching a given string\n"</span>
</pre></div>
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02959">2959</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="ae50456a8bbe9c4f57a1ce1619aa8843"></a><!-- doxytag: member="pbx.c::show_globals_help" ref="ae50456a8bbe9c4f57a1ce1619aa8843" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char <a class="el" href="pbx_8c.html#ae50456a8bbe9c4f57a1ce1619aa8843">show_globals_help</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment">
<span class="stringliteral">"Usage: core show globals\n"</span>
<span class="stringliteral">"       List current global dialplan variables and their values\n"</span>
</pre></div>
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02971">2971</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="d2211cce31f9bfb73227bcf61c8c6d45"></a><!-- doxytag: member="pbx.c::show_hints_help" ref="d2211cce31f9bfb73227bcf61c8c6d45" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char <a class="el" href="pbx_8c.html#d2211cce31f9bfb73227bcf61c8c6d45">show_hints_help</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment">
<span class="stringliteral">"Usage: core show hints\n"</span>
<span class="stringliteral">"       List registered hints\n"</span>
</pre></div>
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02967">2967</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a01f140e49f6f8007121696c6036365a"></a><!-- doxytag: member="pbx.c::show_switches_help" ref="a01f140e49f6f8007121696c6036365a" args="[]" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char <a class="el" href="pbx_8c.html#a01f140e49f6f8007121696c6036365a">show_switches_help</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment">
<span class="stringliteral">"Usage: core show switches\n"</span>
<span class="stringliteral">"       List registered switches\n"</span>
</pre></div>
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02963">2963</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="3b088b468374b928f6ab90bfe5db48bf"></a><!-- doxytag: member="pbx.c::statecbs" ref="3b088b468374b928f6ab90bfe5db48bf" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__state__cb.html">ast_state_cb</a>* <a class="el" href="pbx_8c.html#3b088b468374b928f6ab90bfe5db48bf">statecbs</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00504">504</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l01964">ast_extension_state_add()</a>, <a class="el" href="pbx_8c-source.html#l02039">ast_extension_state_del()</a>, and <a class="el" href="pbx_8c-source.html#l01920">ast_hint_state_changed()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="2749ddcba583cf049c6034826528c0a4"></a><!-- doxytag: member="pbx.c::stateid" ref="2749ddcba583cf049c6034826528c0a4" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="pbx_8c.html#2749ddcba583cf049c6034826528c0a4">stateid</a> = 1<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00496">496</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l01964">ast_extension_state_add()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Thu May 24 22:27:39 2007 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.5 </small></address>
</body>
</html>
