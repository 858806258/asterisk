<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (24 May 2007)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Thu May 24 22:27:27 2007</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir__2Fusr_2Flocal_2Fsrc_2Fasterisk_2Esvn_2Fastum_2Finclude_2F.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir__2Fusr_2Flocal_2Fsrc_2Fasterisk_2Esvn_2Fastum_2Finclude_2Fasterisk_2F.html">asterisk</a></div>
<h1>dsp.h File Reference</h1>Convenient Signal Processing routines. <a href="#_details">More...</a>
<p>

<p>
<a href="dsp_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#be0bbe3452216acaafa0aa98659671a3">DSP_DIGITMODE_DTMF</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#fb189b1bdcec9ef8be15ad828fa9849f">DSP_DIGITMODE_MF</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#4109343ed21e6d37f8a61939bb693fba">DSP_DIGITMODE_MUTECONF</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 9)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#0bd2d02c701959ef9c9a54e1806a5e41">DSP_DIGITMODE_MUTEMAX</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 10)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#485baaa22ecef9f0a6e246d9582ab513">DSP_DIGITMODE_NOQUELCH</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 8)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#109a6eafe1e9b5ba51da24aa625e0aba">DSP_DIGITMODE_RELAXDTMF</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 11)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#2a3497141e07a91545d3010734789049">DSP_FEATURE_BUSY_DETECT</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#2e0bc6e2e31cb741d615569ec96b34dc">DSP_FEATURE_CALL_PROGRESS</a>&nbsp;&nbsp;&nbsp;(DSP_PROGRESS_TALK | DSP_PROGRESS_RINGING | DSP_PROGRESS_BUSY | DSP_PROGRESS_CONGESTION)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#524e0b0298ba1e3426a6afdd72ca6892">DSP_FEATURE_DTMF_DETECT</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 3)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#d05a15f98aacff1c1d0b7fa06d2476bf">DSP_FEATURE_FAX_DETECT</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 4)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#9b80d1ef1c960c0801c6e29354e5a600">DSP_FEATURE_SILENCE_SUPPRESS</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#99dbae565f15cba21ba3385724e30ebc">DSP_PROGRESS_BUSY</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 18)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#49200c894ff1dc7c43b2e446eb579dd3">DSP_PROGRESS_CONGESTION</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 19)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#dab258e3934e7b91d0bfb684723f2710">DSP_PROGRESS_RINGING</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 17)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#659d112a3e5b9657edc168133130e2f6">DSP_PROGRESS_TALK</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 16)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#d0954ba20d10217355a9168e5059e049">DSP_TONE_STATE_BUSY</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#00aced8168d6ca76787d9a1272c5aefe">DSP_TONE_STATE_DIALTONE</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#794a7e898fd12c941ea430445937e7ec">DSP_TONE_STATE_HUNGUP</a>&nbsp;&nbsp;&nbsp;8</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#9bb6530bd613c595cc39b0309bb03aff">DSP_TONE_STATE_RINGING</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#98a67f5267bc3ec52db9b7736e90e911">DSP_TONE_STATE_SILENCE</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#101ce98db0827a7760ea7b64dc6eac12">DSP_TONE_STATE_SPECIAL1</a>&nbsp;&nbsp;&nbsp;5</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#1848cd08785455f1604936394cd133bb">DSP_TONE_STATE_SPECIAL2</a>&nbsp;&nbsp;&nbsp;6</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#2776f4e220a6db9063ef9f9e8da1411c">DSP_TONE_STATE_SPECIAL3</a>&nbsp;&nbsp;&nbsp;7</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#fb89730b5c0e4860e739f3f0deab2850">DSP_TONE_STATE_TALKING</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#880a270d2941c89713095089cc92deb8">ast_dsp_busydetect</a> (struct <a class="el" href="structast__dsp.html">ast_dsp</a> *dsp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return non-zero if historically this should be a busy, request that ast_dsp_silence has already been called.  <a href="#880a270d2941c89713095089cc92deb8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#a013945c26553c4877316f359896e02c">ast_dsp_call_progress</a> (struct <a class="el" href="structast__dsp.html">ast_dsp</a> *dsp, struct <a class="el" href="structast__frame.html">ast_frame</a> *inf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Scans for progress indication in audio.  <a href="#a013945c26553c4877316f359896e02c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#de0dac1765fed7cf4088d8d95f6bf2fe">ast_dsp_digitdetect</a> (struct <a class="el" href="structast__dsp.html">ast_dsp</a> *dsp, struct <a class="el" href="structast__frame.html">ast_frame</a> *<a class="el" href="format__g726_8c.html#85b9b17a7dd34a3638c560bc9152473b">f</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return non-zero if DTMF hit was found.  <a href="#de0dac1765fed7cf4088d8d95f6bf2fe"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#729b2ca589c701de8002e79b11d28161">ast_dsp_digitmode</a> (struct <a class="el" href="structast__dsp.html">ast_dsp</a> *dsp, int digitmode)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set digit mode.  <a href="#729b2ca589c701de8002e79b11d28161"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#0be381c9328908706b61cc390a1d0a42">ast_dsp_digitreset</a> (struct <a class="el" href="structast__dsp.html">ast_dsp</a> *dsp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reset DTMF detector.  <a href="#0be381c9328908706b61cc390a1d0a42"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#4bcf981973b4db5614c153e1773da6a4">ast_dsp_free</a> (struct <a class="el" href="structast__dsp.html">ast_dsp</a> *dsp)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#9893a6dc736896fbe2c090d5a41c2a60">ast_dsp_get_tcount</a> (struct <a class="el" href="structast__dsp.html">ast_dsp</a> *dsp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get tcount (Threshold counter).  <a href="#9893a6dc736896fbe2c090d5a41c2a60"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#7095e2e4ce7ab727f02b5f17db02a9ed">ast_dsp_get_tstate</a> (struct <a class="el" href="structast__dsp.html">ast_dsp</a> *dsp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get tstate (Tone State).  <a href="#7095e2e4ce7ab727f02b5f17db02a9ed"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#71a140d025466320bd30016999452c73">ast_dsp_getdigits</a> (struct <a class="el" href="structast__dsp.html">ast_dsp</a> *dsp, char *<a class="el" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>, int max)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get pending DTMF/MF digits.  <a href="#71a140d025466320bd30016999452c73"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__dsp.html">ast_dsp</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#95aa7dc3101fae9b433b4f29feaa1bab">ast_dsp_new</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#e0c80b9ed57dba8c3f9864f8dded8ddb">ast_dsp_process</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, struct <a class="el" href="structast__dsp.html">ast_dsp</a> *dsp, struct <a class="el" href="structast__frame.html">ast_frame</a> *inf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return AST_FRAME_NULL frames when there is silence, AST_FRAME_BUSY on busies, and call progress, all dependent upon which features are enabled.  <a href="#e0c80b9ed57dba8c3f9864f8dded8ddb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#0aa66dfe7d026210825554bf4d7512bf">ast_dsp_reset</a> (struct <a class="el" href="structast__dsp.html">ast_dsp</a> *dsp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reset total silence count.  <a href="#0aa66dfe7d026210825554bf4d7512bf"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#0c5f8d78d6a1ca2602f40ece3578f835">ast_dsp_set_busy_count</a> (struct <a class="el" href="structast__dsp.html">ast_dsp</a> *dsp, int <a class="el" href="chan__zap_8c.html#5d2bdcda0cc13de0da41166e2ee369e6">cadences</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set number of required cadences for busy.  <a href="#0c5f8d78d6a1ca2602f40ece3578f835"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#7e3dc605ef28188f1998cdc15f4157df">ast_dsp_set_busy_pattern</a> (struct <a class="el" href="structast__dsp.html">ast_dsp</a> *dsp, int tonelength, int quietlength)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set expected lengths of the busy tone.  <a href="#7e3dc605ef28188f1998cdc15f4157df"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#5c0c1c53e85826961109ef1c9e10f941">ast_dsp_set_call_progress_zone</a> (struct <a class="el" href="structast__dsp.html">ast_dsp</a> *dsp, char *zone)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set zone for doing progress detection.  <a href="#5c0c1c53e85826961109ef1c9e10f941"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#3f743cd2722e6c2811abcac903abbda2">ast_dsp_set_features</a> (struct <a class="el" href="structast__dsp.html">ast_dsp</a> *dsp, int features)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Select feature set.  <a href="#3f743cd2722e6c2811abcac903abbda2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#06a1df6a74baf7fbd9f2db229408315f">ast_dsp_set_threshold</a> (struct <a class="el" href="structast__dsp.html">ast_dsp</a> *dsp, int threshold)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set threshold value for silence.  <a href="#06a1df6a74baf7fbd9f2db229408315f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dsp_8h.html#b40de8950fc5d32c476c4462a5e5d5c6">ast_dsp_silence</a> (struct <a class="el" href="structast__dsp.html">ast_dsp</a> *dsp, struct <a class="el" href="structast__frame.html">ast_frame</a> *<a class="el" href="format__g726_8c.html#85b9b17a7dd34a3638c560bc9152473b">f</a>, int *totalsilence)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return non-zero if this is silence. Updates "totalsilence" with the total number of seconds of silence.  <a href="#b40de8950fc5d32c476c4462a5e5d5c6"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Convenient Signal Processing routines. 
<p>

<p>
Definition in file <a class="el" href="dsp_8h-source.html">dsp.h</a>.<hr><h2>Define Documentation</h2>
<a class="anchor" name="be0bbe3452216acaafa0aa98659671a3"></a><!-- doxytag: member="dsp.h::DSP_DIGITMODE_DTMF" ref="be0bbe3452216acaafa0aa98659671a3" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_DIGITMODE_DTMF&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00031">31</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l01731">ast_dsp_digitmode()</a>, <a class="el" href="chan__zap_8c-source.html#l07493">mkintf()</a>, <a class="el" href="chan__sip_8c-source.html#l04179">sip_new()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, <a class="el" href="chan__zap_8c-source.html#l02612">zt_hangup()</a>, <a class="el" href="chan__zap_8c-source.html#l05516">zt_new()</a>, and <a class="el" href="chan__zap_8c-source.html#l03075">zt_setoption()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="fb189b1bdcec9ef8be15ad828fa9849f"></a><!-- doxytag: member="dsp.h::DSP_DIGITMODE_MF" ref="fb189b1bdcec9ef8be15ad828fa9849f" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_DIGITMODE_MF&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00032">32</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l00976">__ast_dsp_digitdetect()</a>, <a class="el" href="dsp_8c-source.html#l01731">ast_dsp_digitmode()</a>, <a class="el" href="dsp_8c-source.html#l01668">ast_dsp_digitreset()</a>, <a class="el" href="dsp_8c-source.html#l01026">ast_dsp_getdigits()</a>, <a class="el" href="dsp_8c-source.html#l01413">ast_dsp_process()</a>, and <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="4109343ed21e6d37f8a61939bb693fba"></a><!-- doxytag: member="dsp.h::DSP_DIGITMODE_MUTECONF" ref="4109343ed21e6d37f8a61939bb693fba" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_DIGITMODE_MUTECONF&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 9)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00035">35</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l01731">ast_dsp_digitmode()</a>, <a class="el" href="dsp_8c-source.html#l01413">ast_dsp_process()</a>, and <a class="el" href="chan__zap_8c-source.html#l03075">zt_setoption()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="0bd2d02c701959ef9c9a54e1806a5e41"></a><!-- doxytag: member="dsp.h::DSP_DIGITMODE_MUTEMAX" ref="0bd2d02c701959ef9c9a54e1806a5e41" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_DIGITMODE_MUTEMAX&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 10)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00036">36</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l01731">ast_dsp_digitmode()</a>, <a class="el" href="dsp_8c-source.html#l01413">ast_dsp_process()</a>, and <a class="el" href="chan__zap_8c-source.html#l03075">zt_setoption()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="485baaa22ecef9f0a6e246d9582ab513"></a><!-- doxytag: member="dsp.h::DSP_DIGITMODE_NOQUELCH" ref="485baaa22ecef9f0a6e246d9582ab513" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_DIGITMODE_NOQUELCH&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 8)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00034">34</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l00422">dtmf_detect()</a>, <a class="el" href="dsp_8c-source.html#l00693">mf_detect()</a>, and <a class="el" href="chan__mgcp_8c-source.html#l01457">mgcp_new()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="109a6eafe1e9b5ba51da24aa625e0aba"></a><!-- doxytag: member="dsp.h::DSP_DIGITMODE_RELAXDTMF" ref="109a6eafe1e9b5ba51da24aa625e0aba" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_DIGITMODE_RELAXDTMF&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 11)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00037">37</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l00976">__ast_dsp_digitdetect()</a>, <a class="el" href="chan__zap_8c-source.html#l11882">process_zap()</a>, <a class="el" href="chan__sip_8c-source.html#l04179">sip_new()</a>, and <a class="el" href="chan__zap_8c-source.html#l03075">zt_setoption()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="2a3497141e07a91545d3010734789049"></a><!-- doxytag: member="dsp.h::DSP_FEATURE_BUSY_DETECT" ref="2a3497141e07a91545d3010734789049" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_FEATURE_BUSY_DETECT&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 1)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00027">27</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l01413">ast_dsp_process()</a>, and <a class="el" href="chan__zap_8c-source.html#l05516">zt_new()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="2e0bc6e2e31cb741d615569ec96b34dc"></a><!-- doxytag: member="dsp.h::DSP_FEATURE_CALL_PROGRESS" ref="2e0bc6e2e31cb741d615569ec96b34dc" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_FEATURE_CALL_PROGRESS&nbsp;&nbsp;&nbsp;(DSP_PROGRESS_TALK | DSP_PROGRESS_RINGING | DSP_PROGRESS_BUSY | DSP_PROGRESS_CONGESTION)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00043">43</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l01051">__ast_dsp_call_progress()</a>, <a class="el" href="dsp_8c-source.html#l01413">ast_dsp_process()</a>, and <a class="el" href="chan__zap_8c-source.html#l05516">zt_new()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="524e0b0298ba1e3426a6afdd72ca6892"></a><!-- doxytag: member="dsp.h::DSP_FEATURE_DTMF_DETECT" ref="524e0b0298ba1e3426a6afdd72ca6892" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_FEATURE_DTMF_DETECT&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 3)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00028">28</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="chan__h323_8c-source.html#l01010">__oh323_new()</a>, <a class="el" href="dsp_8c-source.html#l01413">ast_dsp_process()</a>, <a class="el" href="chan__zap_8c-source.html#l03373">disable_dtmf_detect()</a>, <a class="el" href="chan__zap_8c-source.html#l03391">enable_dtmf_detect()</a>, <a class="el" href="chan__mgcp_8c-source.html#l01457">mgcp_new()</a>, <a class="el" href="chan__sip_8c-source.html#l18059">sip_dtmfmode()</a>, <a class="el" href="chan__sip_8c-source.html#l04179">sip_new()</a>, and <a class="el" href="chan__zap_8c-source.html#l05516">zt_new()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="d05a15f98aacff1c1d0b7fa06d2476bf"></a><!-- doxytag: member="dsp.h::DSP_FEATURE_FAX_DETECT" ref="d05a15f98aacff1c1d0b7fa06d2476bf" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_FEATURE_FAX_DETECT&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 4)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00029">29</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l00976">__ast_dsp_digitdetect()</a>, and <a class="el" href="chan__zap_8c-source.html#l05516">zt_new()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="9b80d1ef1c960c0801c6e29354e5a600"></a><!-- doxytag: member="dsp.h::DSP_FEATURE_SILENCE_SUPPRESS" ref="9b80d1ef1c960c0801c6e29354e5a600" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_FEATURE_SILENCE_SUPPRESS&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00026">26</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l01620">ast_dsp_new()</a>, and <a class="el" href="dsp_8c-source.html#l01413">ast_dsp_process()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="99dbae565f15cba21ba3385724e30ebc"></a><!-- doxytag: member="dsp.h::DSP_PROGRESS_BUSY" ref="99dbae565f15cba21ba3385724e30ebc" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_PROGRESS_BUSY&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 18)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00041">41</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l01051">__ast_dsp_call_progress()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="49200c894ff1dc7c43b2e446eb579dd3"></a><!-- doxytag: member="dsp.h::DSP_PROGRESS_CONGESTION" ref="49200c894ff1dc7c43b2e446eb579dd3" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_PROGRESS_CONGESTION&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 19)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00042">42</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l01051">__ast_dsp_call_progress()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="dab258e3934e7b91d0bfb684723f2710"></a><!-- doxytag: member="dsp.h::DSP_PROGRESS_RINGING" ref="dab258e3934e7b91d0bfb684723f2710" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_PROGRESS_RINGING&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 17)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00040">40</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l01051">__ast_dsp_call_progress()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="659d112a3e5b9657edc168133130e2f6"></a><!-- doxytag: member="dsp.h::DSP_PROGRESS_TALK" ref="659d112a3e5b9657edc168133130e2f6" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_PROGRESS_TALK&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 16)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00039">39</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l01051">__ast_dsp_call_progress()</a>, and <a class="el" href="chan__zap_8c-source.html#l05516">zt_new()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="d0954ba20d10217355a9168e5059e049"></a><!-- doxytag: member="dsp.h::DSP_TONE_STATE_BUSY" ref="d0954ba20d10217355a9168e5059e049" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_TONE_STATE_BUSY&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00049">49</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l01051">__ast_dsp_call_progress()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="00aced8168d6ca76787d9a1272c5aefe"></a><!-- doxytag: member="dsp.h::DSP_TONE_STATE_DIALTONE" ref="00aced8168d6ca76787d9a1272c5aefe" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_TONE_STATE_DIALTONE&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00047">47</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l01051">__ast_dsp_call_progress()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="794a7e898fd12c941ea430445937e7ec"></a><!-- doxytag: member="dsp.h::DSP_TONE_STATE_HUNGUP" ref="794a7e898fd12c941ea430445937e7ec" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_TONE_STATE_HUNGUP&nbsp;&nbsp;&nbsp;8          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00053">53</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l01051">__ast_dsp_call_progress()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="9bb6530bd613c595cc39b0309bb03aff"></a><!-- doxytag: member="dsp.h::DSP_TONE_STATE_RINGING" ref="9bb6530bd613c595cc39b0309bb03aff" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_TONE_STATE_RINGING&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00046">46</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l01051">__ast_dsp_call_progress()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="98a67f5267bc3ec52db9b7736e90e911"></a><!-- doxytag: member="dsp.h::DSP_TONE_STATE_SILENCE" ref="98a67f5267bc3ec52db9b7736e90e911" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_TONE_STATE_SILENCE&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00045">45</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l01051">__ast_dsp_call_progress()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="101ce98db0827a7760ea7b64dc6eac12"></a><!-- doxytag: member="dsp.h::DSP_TONE_STATE_SPECIAL1" ref="101ce98db0827a7760ea7b64dc6eac12" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_TONE_STATE_SPECIAL1&nbsp;&nbsp;&nbsp;5          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00050">50</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l01051">__ast_dsp_call_progress()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="1848cd08785455f1604936394cd133bb"></a><!-- doxytag: member="dsp.h::DSP_TONE_STATE_SPECIAL2" ref="1848cd08785455f1604936394cd133bb" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_TONE_STATE_SPECIAL2&nbsp;&nbsp;&nbsp;6          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00051">51</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l01051">__ast_dsp_call_progress()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="2776f4e220a6db9063ef9f9e8da1411c"></a><!-- doxytag: member="dsp.h::DSP_TONE_STATE_SPECIAL3" ref="2776f4e220a6db9063ef9f9e8da1411c" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_TONE_STATE_SPECIAL3&nbsp;&nbsp;&nbsp;7          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00052">52</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l01051">__ast_dsp_call_progress()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="fb89730b5c0e4860e739f3f0deab2850"></a><!-- doxytag: member="dsp.h::DSP_TONE_STATE_TALKING" ref="fb89730b5c0e4860e739f3f0deab2850" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DSP_TONE_STATE_TALKING&nbsp;&nbsp;&nbsp;3          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8h-source.html#l00048">48</a> of file <a class="el" href="dsp_8h-source.html">dsp.h</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l01051">__ast_dsp_call_progress()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="880a270d2941c89713095089cc92deb8"></a><!-- doxytag: member="dsp.h::ast_dsp_busydetect" ref="880a270d2941c89713095089cc92deb8" args="(struct ast_dsp *dsp)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_dsp_busydetect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__dsp.html">ast_dsp</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dsp</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return non-zero if historically this should be a busy, request that ast_dsp_silence has already been called. 
<p>

<p>
Definition at line <a class="el" href="dsp_8c-source.html#l01257">1257</a> of file <a class="el" href="dsp_8c-source.html">dsp.c</a>.
<p>
References <a class="el" href="dsp_8c-source.html#l01257">ast_dsp_busydetect()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="dsp_8c-source.html#l00121">BUSY_MAX</a>, <a class="el" href="dsp_8c.html#48431a757f2742b1811a2f834bdb182bcd0603f0d9f9f35bbcb203a09bb5cfe8">BUSY_MIN</a>, <a class="el" href="dsp_8c.html#48431a757f2742b1811a2f834bdb182b7f1e23cebb6ca4f3e954ffbb7281fc3d">BUSY_PAT_PERCENT</a>, <a class="el" href="dsp_8c.html#48431a757f2742b1811a2f834bdb182b1e4d61e5ae54e02fa29ac3f59fef8bf3">BUSY_PERCENT</a>, <a class="el" href="dsp_8c-source.html#l00339">ast_dsp::busy_quietlength</a>, <a class="el" href="dsp_8c.html#48431a757f2742b1811a2f834bdb182b99069b4b16deebd2a25ebe46d0a7b6ca">BUSY_THRESHOLD</a>, <a class="el" href="dsp_8c-source.html#l00338">ast_dsp::busy_tonelength</a>, <a class="el" href="dsp_8c-source.html#l00337">ast_dsp::busycount</a>, <a class="el" href="dsp_8c-source.html#l00336">ast_dsp::busymaybe</a>, <a class="el" href="dsp_8c-source.html#l00125">DSP_HISTORY</a>, <a class="el" href="dsp_8c-source.html#l00340">ast_dsp::historicnoise</a>, <a class="el" href="dsp_8c-source.html#l00341">ast_dsp::historicsilence</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00106">LOG_NOTICE</a>, and <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>.
<p>
Referenced by <a class="el" href="dsp_8c-source.html#l01257">ast_dsp_busydetect()</a>, and <a class="el" href="dsp_8c-source.html#l01413">ast_dsp_process()</a>.<div class="fragment"><pre class="fragment"><a name="l01258"></a>01258 {
<a name="l01259"></a>01259    <span class="keywordtype">int</span> res = 0, x;
<a name="l01260"></a>01260 <span class="preprocessor">#ifndef BUSYDETECT_TONEONLY</span>
<a name="l01261"></a>01261 <span class="preprocessor"></span>   <span class="keywordtype">int</span> avgsilence = 0, hitsilence = 0;
<a name="l01262"></a>01262 <span class="preprocessor">#endif</span>
<a name="l01263"></a>01263 <span class="preprocessor"></span>   <span class="keywordtype">int</span> avgtone = 0, hittone = 0;
<a name="l01264"></a>01264    <span class="keywordflow">if</span> (!dsp-&gt;<a class="code" href="structast__dsp.html#e133b832363775a159b6b5f04d4af9d5">busymaybe</a>)
<a name="l01265"></a>01265       <span class="keywordflow">return</span> res;
<a name="l01266"></a>01266    <span class="keywordflow">for</span> (x=<a class="code" href="dsp_8c.html#4e3bac47692ea9007c13953d7685b463">DSP_HISTORY</a> - dsp-&gt;<a class="code" href="structast__dsp.html#52a21002e97ff5acfba3fa71bef47c6b">busycount</a>;x&lt;<a class="code" href="dsp_8c.html#4e3bac47692ea9007c13953d7685b463">DSP_HISTORY</a>;x++) {
<a name="l01267"></a>01267 <span class="preprocessor">#ifndef BUSYDETECT_TONEONLY</span>
<a name="l01268"></a>01268 <span class="preprocessor"></span>      avgsilence += dsp-&gt;<a class="code" href="structast__dsp.html#dc58a4187dd8a0eccad58b432b328806">historicsilence</a>[x];
<a name="l01269"></a>01269 <span class="preprocessor">#endif</span>
<a name="l01270"></a>01270 <span class="preprocessor"></span>      avgtone += dsp-&gt;<a class="code" href="structast__dsp.html#d6bf5a07ea2e81220552af38e3791335">historicnoise</a>[x];
<a name="l01271"></a>01271    }
<a name="l01272"></a>01272 <span class="preprocessor">#ifndef BUSYDETECT_TONEONLY</span>
<a name="l01273"></a>01273 <span class="preprocessor"></span>   avgsilence /= dsp-&gt;<a class="code" href="structast__dsp.html#52a21002e97ff5acfba3fa71bef47c6b">busycount</a>;
<a name="l01274"></a>01274 <span class="preprocessor">#endif</span>
<a name="l01275"></a>01275 <span class="preprocessor"></span>   avgtone /= dsp-&gt;<a class="code" href="structast__dsp.html#52a21002e97ff5acfba3fa71bef47c6b">busycount</a>;
<a name="l01276"></a>01276    <span class="keywordflow">for</span> (x=<a class="code" href="dsp_8c.html#4e3bac47692ea9007c13953d7685b463">DSP_HISTORY</a> - dsp-&gt;<a class="code" href="structast__dsp.html#52a21002e97ff5acfba3fa71bef47c6b">busycount</a>;x&lt;<a class="code" href="dsp_8c.html#4e3bac47692ea9007c13953d7685b463">DSP_HISTORY</a>;x++) {
<a name="l01277"></a>01277 <span class="preprocessor">#ifndef BUSYDETECT_TONEONLY</span>
<a name="l01278"></a>01278 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (avgsilence &gt; dsp-&gt;<a class="code" href="structast__dsp.html#dc58a4187dd8a0eccad58b432b328806">historicsilence</a>[x]) {
<a name="l01279"></a>01279          <span class="keywordflow">if</span> (avgsilence - (avgsilence*<a class="code" href="dsp_8c.html#48431a757f2742b1811a2f834bdb182b1e4d61e5ae54e02fa29ac3f59fef8bf3">BUSY_PERCENT</a>/100) &lt;= dsp-&gt;<a class="code" href="structast__dsp.html#dc58a4187dd8a0eccad58b432b328806">historicsilence</a>[x])
<a name="l01280"></a>01280             hitsilence++;
<a name="l01281"></a>01281       } <span class="keywordflow">else</span> {
<a name="l01282"></a>01282          <span class="keywordflow">if</span> (avgsilence + (avgsilence*<a class="code" href="dsp_8c.html#48431a757f2742b1811a2f834bdb182b1e4d61e5ae54e02fa29ac3f59fef8bf3">BUSY_PERCENT</a>/100) &gt;= dsp-&gt;<a class="code" href="structast__dsp.html#dc58a4187dd8a0eccad58b432b328806">historicsilence</a>[x])
<a name="l01283"></a>01283             hitsilence++;
<a name="l01284"></a>01284       }
<a name="l01285"></a>01285 <span class="preprocessor">#endif</span>
<a name="l01286"></a>01286 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (avgtone &gt; dsp-&gt;<a class="code" href="structast__dsp.html#d6bf5a07ea2e81220552af38e3791335">historicnoise</a>[x]) {
<a name="l01287"></a>01287          <span class="keywordflow">if</span> (avgtone - (avgtone*<a class="code" href="dsp_8c.html#48431a757f2742b1811a2f834bdb182b1e4d61e5ae54e02fa29ac3f59fef8bf3">BUSY_PERCENT</a>/100) &lt;= dsp-&gt;<a class="code" href="structast__dsp.html#d6bf5a07ea2e81220552af38e3791335">historicnoise</a>[x])
<a name="l01288"></a>01288             hittone++;
<a name="l01289"></a>01289       } <span class="keywordflow">else</span> {
<a name="l01290"></a>01290          <span class="keywordflow">if</span> (avgtone + (avgtone*<a class="code" href="dsp_8c.html#48431a757f2742b1811a2f834bdb182b1e4d61e5ae54e02fa29ac3f59fef8bf3">BUSY_PERCENT</a>/100) &gt;= dsp-&gt;<a class="code" href="structast__dsp.html#d6bf5a07ea2e81220552af38e3791335">historicnoise</a>[x])
<a name="l01291"></a>01291             hittone++;
<a name="l01292"></a>01292       }
<a name="l01293"></a>01293    }
<a name="l01294"></a>01294 <span class="preprocessor">#ifndef BUSYDETECT_TONEONLY</span>
<a name="l01295"></a>01295 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ((hittone &gt;= dsp-&gt;<a class="code" href="structast__dsp.html#52a21002e97ff5acfba3fa71bef47c6b">busycount</a> - 1) &amp;&amp; (hitsilence &gt;= dsp-&gt;<a class="code" href="structast__dsp.html#52a21002e97ff5acfba3fa71bef47c6b">busycount</a> - 1) &amp;&amp; 
<a name="l01296"></a>01296        (avgtone &gt;= <a class="code" href="dsp_8c.html#48431a757f2742b1811a2f834bdb182bcd0603f0d9f9f35bbcb203a09bb5cfe8">BUSY_MIN</a> &amp;&amp; avgtone &lt;= <a class="code" href="dsp_8c.html#48431a757f2742b1811a2f834bdb182b2d6e05f43db4d7620238f331e93f874e">BUSY_MAX</a>) &amp;&amp; 
<a name="l01297"></a>01297        (avgsilence &gt;= <a class="code" href="dsp_8c.html#48431a757f2742b1811a2f834bdb182bcd0603f0d9f9f35bbcb203a09bb5cfe8">BUSY_MIN</a> &amp;&amp; avgsilence &lt;= <a class="code" href="dsp_8c.html#48431a757f2742b1811a2f834bdb182b2d6e05f43db4d7620238f331e93f874e">BUSY_MAX</a>)) {
<a name="l01298"></a>01298 <span class="preprocessor">#else</span>
<a name="l01299"></a>01299 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ((hittone &gt;= dsp-&gt;<a class="code" href="structast__dsp.html#52a21002e97ff5acfba3fa71bef47c6b">busycount</a> - 1) &amp;&amp; (avgtone &gt;= <a class="code" href="dsp_8c.html#48431a757f2742b1811a2f834bdb182bcd0603f0d9f9f35bbcb203a09bb5cfe8">BUSY_MIN</a> &amp;&amp; avgtone &lt;= <a class="code" href="dsp_8c.html#48431a757f2742b1811a2f834bdb182b2d6e05f43db4d7620238f331e93f874e">BUSY_MAX</a>)) {
<a name="l01300"></a>01300 <span class="preprocessor">#endif</span>
<a name="l01301"></a>01301 <span class="preprocessor"></span><span class="preprocessor">#ifdef BUSYDETECT_COMPARE_TONE_AND_SILENCE</span>
<a name="l01302"></a>01302 <span class="preprocessor"></span><span class="preprocessor">#ifdef BUSYDETECT_TONEONLY</span>
<a name="l01303"></a>01303 <span class="preprocessor"></span><span class="preprocessor">#error You cant use BUSYDETECT_TONEONLY together with BUSYDETECT_COMPARE_TONE_AND_SILENCE</span>
<a name="l01304"></a>01304 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l01305"></a>01305 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (avgtone &gt; avgsilence) {
<a name="l01306"></a>01306          <span class="keywordflow">if</span> (avgtone - avgtone*<a class="code" href="dsp_8c.html#48431a757f2742b1811a2f834bdb182b1e4d61e5ae54e02fa29ac3f59fef8bf3">BUSY_PERCENT</a>/100 &lt;= avgsilence)
<a name="l01307"></a>01307             res = 1;
<a name="l01308"></a>01308       } <span class="keywordflow">else</span> {
<a name="l01309"></a>01309          <span class="keywordflow">if</span> (avgtone + avgtone*<a class="code" href="dsp_8c.html#48431a757f2742b1811a2f834bdb182b1e4d61e5ae54e02fa29ac3f59fef8bf3">BUSY_PERCENT</a>/100 &gt;= avgsilence)
<a name="l01310"></a>01310             res = 1;
<a name="l01311"></a>01311       }
<a name="l01312"></a>01312 <span class="preprocessor">#else</span>
<a name="l01313"></a>01313 <span class="preprocessor"></span>      res = 1;
<a name="l01314"></a>01314 <span class="preprocessor">#endif</span>
<a name="l01315"></a>01315 <span class="preprocessor"></span>   }
<a name="l01316"></a>01316    <span class="comment">/* If we know the expected busy tone length, check we are in the range */</span>
<a name="l01317"></a>01317    <span class="keywordflow">if</span> (res &amp;&amp; (dsp-&gt;<a class="code" href="structast__dsp.html#f3519c229a77edad267c34820780b211">busy_tonelength</a> &gt; 0)) {
<a name="l01318"></a>01318       <span class="keywordflow">if</span> (abs(avgtone - dsp-&gt;<a class="code" href="structast__dsp.html#f3519c229a77edad267c34820780b211">busy_tonelength</a>) &gt; (dsp-&gt;<a class="code" href="structast__dsp.html#f3519c229a77edad267c34820780b211">busy_tonelength</a>*<a class="code" href="dsp_8c.html#48431a757f2742b1811a2f834bdb182b7f1e23cebb6ca4f3e954ffbb7281fc3d">BUSY_PAT_PERCENT</a>/100)) {
<a name="l01319"></a>01319 <span class="preprocessor">#if 0</span>
<a name="l01320"></a>01320 <span class="preprocessor"></span>         <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#bbf95aad74d847cd4bcb129604f798cd">LOG_NOTICE</a>, <span class="stringliteral">"busy detector: avgtone of %d not close enough to desired %d\n"</span>,
<a name="l01321"></a>01321                   avgtone, dsp-&gt;<a class="code" href="structast__dsp.html#f3519c229a77edad267c34820780b211">busy_tonelength</a>);
<a name="l01322"></a>01322 <span class="preprocessor">#endif</span>
<a name="l01323"></a>01323 <span class="preprocessor"></span>         res = 0;
<a name="l01324"></a>01324       }
<a name="l01325"></a>01325    }
<a name="l01326"></a>01326 <span class="preprocessor">#ifndef BUSYDETECT_TONEONLY</span>
<a name="l01327"></a>01327 <span class="preprocessor"></span>   <span class="comment">/* If we know the expected busy tone silent-period length, check we are in the range */</span>
<a name="l01328"></a>01328    <span class="keywordflow">if</span> (res &amp;&amp; (dsp-&gt;<a class="code" href="structast__dsp.html#26364047b8b733768c8927147b79c683">busy_quietlength</a> &gt; 0)) {
<a name="l01329"></a>01329       <span class="keywordflow">if</span> (abs(avgsilence - dsp-&gt;<a class="code" href="structast__dsp.html#26364047b8b733768c8927147b79c683">busy_quietlength</a>) &gt; (dsp-&gt;<a class="code" href="structast__dsp.html#26364047b8b733768c8927147b79c683">busy_quietlength</a>*<a class="code" href="dsp_8c.html#48431a757f2742b1811a2f834bdb182b7f1e23cebb6ca4f3e954ffbb7281fc3d">BUSY_PAT_PERCENT</a>/100)) {
<a name="l01330"></a>01330 <span class="preprocessor">#if 0</span>
<a name="l01331"></a>01331 <span class="preprocessor"></span>         <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#bbf95aad74d847cd4bcb129604f798cd">LOG_NOTICE</a>, <span class="stringliteral">"busy detector: avgsilence of %d not close enough to desired %d\n"</span>,
<a name="l01332"></a>01332                   avgsilence, dsp-&gt;<a class="code" href="structast__dsp.html#26364047b8b733768c8927147b79c683">busy_quietlength</a>);
<a name="l01333"></a>01333 <span class="preprocessor">#endif</span>
<a name="l01334"></a>01334 <span class="preprocessor"></span>         res = 0;
<a name="l01335"></a>01335       }
<a name="l01336"></a>01336    }
<a name="l01337"></a>01337 <span class="preprocessor">#endif</span>
<a name="l01338"></a>01338 <span class="preprocessor"></span><span class="preprocessor">#ifndef BUSYDETECT_TONEONLY</span>
<a name="l01339"></a>01339 <span class="preprocessor"></span><span class="preprocessor">#if 1</span>
<a name="l01340"></a>01340 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (res) {
<a name="l01341"></a>01341       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l01342"></a>01342          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"ast_dsp_busydetect detected busy, avgtone: %d, avgsilence %d\n"</span>, avgtone, avgsilence);
<a name="l01343"></a>01343    }
<a name="l01344"></a>01344 <span class="preprocessor">#endif</span>
<a name="l01345"></a>01345 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l01346"></a>01346 <span class="preprocessor"></span>   <span class="keywordflow">return</span> res;
<a name="l01347"></a>01347 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a013945c26553c4877316f359896e02c"></a><!-- doxytag: member="dsp.h::ast_dsp_call_progress" ref="a013945c26553c4877316f359896e02c" args="(struct ast_dsp *dsp, struct ast_frame *inf)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_dsp_call_progress           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__dsp.html">ast_dsp</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>inf</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Scans for progress indication in audio. 
<p>

<p>
Definition at line <a class="el" href="dsp_8c-source.html#l01188">1188</a> of file <a class="el" href="dsp_8c-source.html">dsp.c</a>.
<p>
References <a class="el" href="dsp_8c-source.html#l01051">__ast_dsp_call_progress()</a>, <a class="el" href="frame_8h-source.html#l00233">AST_FORMAT_SLINEAR</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f9264fc4720a7b3982e2d4bf246fe3d9924">AST_FRAME_VOICE</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="frame_8h-source.html#l00147">ast_frame::data</a>, <a class="el" href="frame_8h-source.html#l00135">ast_frame::datalen</a>, <a class="el" href="frame_8h-source.html#l00131">ast_frame::frametype</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, and <a class="el" href="frame_8h-source.html#l00133">ast_frame::subclass</a>.<div class="fragment"><pre class="fragment"><a name="l01189"></a>01189 {
<a name="l01190"></a>01190    <span class="keywordflow">if</span> (inf-&gt;<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a> != <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f9264fc4720a7b3982e2d4bf246fe3d9924">AST_FRAME_VOICE</a>) {
<a name="l01191"></a>01191       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Can't check call progress of non-voice frames\n"</span>);
<a name="l01192"></a>01192       <span class="keywordflow">return</span> 0;
<a name="l01193"></a>01193    }
<a name="l01194"></a>01194    <span class="keywordflow">if</span> (inf-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> != <a class="code" href="frame_8h.html#ce4d062ff9a85be84b636e7ec67a068b">AST_FORMAT_SLINEAR</a>) {
<a name="l01195"></a>01195       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Can only check call progress in signed-linear frames\n"</span>);
<a name="l01196"></a>01196       <span class="keywordflow">return</span> 0;
<a name="l01197"></a>01197    }
<a name="l01198"></a>01198    <span class="keywordflow">return</span> <a class="code" href="dsp_8c.html#8e4181ab2669d6ceb17fa012a1503664">__ast_dsp_call_progress</a>(dsp, inf-&gt;<a class="code" href="structast__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a>, inf-&gt;<a class="code" href="structast__frame.html#106553e2afb20bec4268dd6bd02c952d">datalen</a> / 2);
<a name="l01199"></a>01199 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="de0dac1765fed7cf4088d8d95f6bf2fe"></a><!-- doxytag: member="dsp.h::ast_dsp_digitdetect" ref="de0dac1765fed7cf4088d8d95f6bf2fe" args="(struct ast_dsp *dsp, struct ast_frame *f)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_dsp_digitdetect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__dsp.html">ast_dsp</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>f</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return non-zero if DTMF hit was found. 
<p>

<p>
Definition at line <a class="el" href="dsp_8c-source.html#l00987">987</a> of file <a class="el" href="dsp_8c-source.html">dsp.c</a>.
<p>
References <a class="el" href="dsp_8c-source.html#l00976">__ast_dsp_digitdetect()</a>, <a class="el" href="frame_8h-source.html#l00233">AST_FORMAT_SLINEAR</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f9264fc4720a7b3982e2d4bf246fe3d9924">AST_FRAME_VOICE</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="frame_8h-source.html#l00147">ast_frame::data</a>, <a class="el" href="frame_8h-source.html#l00135">ast_frame::datalen</a>, <a class="el" href="frame_8h-source.html#l00131">ast_frame::frametype</a>, <a class="el" href="utils_8h-source.html#l00386">len</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, and <a class="el" href="frame_8h-source.html#l00133">ast_frame::subclass</a>.<div class="fragment"><pre class="fragment"><a name="l00988"></a>00988 {
<a name="l00989"></a>00989    <span class="keywordtype">short</span> *<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>;
<a name="l00990"></a>00990    <span class="keywordtype">int</span> <a class="code" href="utils_8h.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a>;
<a name="l00991"></a>00991    <span class="keywordtype">int</span> ign=0;
<a name="l00992"></a>00992 
<a name="l00993"></a>00993    <span class="keywordflow">if</span> (inf-&gt;frametype != <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f9264fc4720a7b3982e2d4bf246fe3d9924">AST_FRAME_VOICE</a>) {
<a name="l00994"></a>00994       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Can't check call progress of non-voice frames\n"</span>);
<a name="l00995"></a>00995       <span class="keywordflow">return</span> 0;
<a name="l00996"></a>00996    }
<a name="l00997"></a>00997    <span class="keywordflow">if</span> (inf-&gt;subclass != <a class="code" href="frame_8h.html#ce4d062ff9a85be84b636e7ec67a068b">AST_FORMAT_SLINEAR</a>) {
<a name="l00998"></a>00998       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Can only check call progress in signed-linear frames\n"</span>);
<a name="l00999"></a>00999       <span class="keywordflow">return</span> 0;
<a name="l01000"></a>01000    }
<a name="l01001"></a>01001    s = inf-&gt;data;
<a name="l01002"></a>01002    len = inf-&gt;datalen / 2;
<a name="l01003"></a>01003    <span class="keywordflow">return</span> <a class="code" href="dsp_8c.html#9a305da9481542e7fc0b52466f33f633">__ast_dsp_digitdetect</a>(dsp, s, len, &amp;ign);
<a name="l01004"></a>01004 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="729b2ca589c701de8002e79b11d28161"></a><!-- doxytag: member="dsp.h::ast_dsp_digitmode" ref="729b2ca589c701de8002e79b11d28161" args="(struct ast_dsp *dsp, int digitmode)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_dsp_digitmode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__dsp.html">ast_dsp</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>digitmode</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set digit mode. 
<p>

<p>
Definition at line <a class="el" href="dsp_8c-source.html#l01731">1731</a> of file <a class="el" href="dsp_8c-source.html">dsp.c</a>.
<p>
References <a class="el" href="dsp_8c-source.html#l00358">ast_dtmf_detect_init()</a>, <a class="el" href="dsp_8c-source.html#l00397">ast_mf_detect_init()</a>, <a class="el" href="dsp_8c-source.html#l00349">ast_dsp::digitmode</a>, <a class="el" href="dsp_8h-source.html#l00031">DSP_DIGITMODE_DTMF</a>, <a class="el" href="dsp_8h-source.html#l00032">DSP_DIGITMODE_MF</a>, <a class="el" href="dsp_8h-source.html#l00035">DSP_DIGITMODE_MUTECONF</a>, <a class="el" href="dsp_8h-source.html#l00036">DSP_DIGITMODE_MUTEMAX</a>, and <a class="el" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">ast_dsp::td</a>.
<p>
Referenced by <a class="el" href="chan__mgcp_8c-source.html#l01457">mgcp_new()</a>, <a class="el" href="chan__zap_8c-source.html#l07493">mkintf()</a>, <a class="el" href="chan__sip_8c-source.html#l04179">sip_new()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, <a class="el" href="chan__zap_8c-source.html#l02612">zt_hangup()</a>, <a class="el" href="chan__zap_8c-source.html#l05516">zt_new()</a>, and <a class="el" href="chan__zap_8c-source.html#l03075">zt_setoption()</a>.<div class="fragment"><pre class="fragment"><a name="l01732"></a>01732 {
<a name="l01733"></a>01733    <span class="keywordtype">int</span> <span class="keyword">new</span>;
<a name="l01734"></a>01734    <span class="keywordtype">int</span> old;
<a name="l01735"></a>01735    
<a name="l01736"></a>01736    old = dsp-&gt;<a class="code" href="structast__dsp.html#eb5a9e2f0ae95bc1e00e3f37254fa8a9">digitmode</a> &amp; (<a class="code" href="dsp_8h.html#be0bbe3452216acaafa0aa98659671a3">DSP_DIGITMODE_DTMF</a> | <a class="code" href="dsp_8h.html#fb189b1bdcec9ef8be15ad828fa9849f">DSP_DIGITMODE_MF</a> | <a class="code" href="dsp_8h.html#4109343ed21e6d37f8a61939bb693fba">DSP_DIGITMODE_MUTECONF</a> | <a class="code" href="dsp_8h.html#0bd2d02c701959ef9c9a54e1806a5e41">DSP_DIGITMODE_MUTEMAX</a>);
<a name="l01737"></a>01737    <span class="keyword">new</span> = <a class="code" href="structast__dsp.html#eb5a9e2f0ae95bc1e00e3f37254fa8a9">digitmode</a> &amp; (<a class="code" href="dsp_8h.html#be0bbe3452216acaafa0aa98659671a3">DSP_DIGITMODE_DTMF</a> | <a class="code" href="dsp_8h.html#fb189b1bdcec9ef8be15ad828fa9849f">DSP_DIGITMODE_MF</a> | <a class="code" href="dsp_8h.html#4109343ed21e6d37f8a61939bb693fba">DSP_DIGITMODE_MUTECONF</a> | <a class="code" href="dsp_8h.html#0bd2d02c701959ef9c9a54e1806a5e41">DSP_DIGITMODE_MUTEMAX</a>);
<a name="l01738"></a>01738    <span class="keywordflow">if</span> (old != <span class="keyword">new</span>) {
<a name="l01739"></a>01739       <span class="comment">/* Must initialize structures if switching from MF to DTMF or vice-versa */</span>
<a name="l01740"></a>01740       <span class="keywordflow">if</span> (<span class="keyword">new</span> &amp; <a class="code" href="dsp_8h.html#fb189b1bdcec9ef8be15ad828fa9849f">DSP_DIGITMODE_MF</a>)
<a name="l01741"></a>01741          <a class="code" href="dsp_8c.html#1efb9542132163410830ae38982c7d99">ast_mf_detect_init</a>(&amp;dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf);
<a name="l01742"></a>01742       <span class="keywordflow">else</span>
<a name="l01743"></a>01743          <a class="code" href="dsp_8c.html#83c8c0a4f0c6f942f8794d8696d8a910">ast_dtmf_detect_init</a>(&amp;dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf);
<a name="l01744"></a>01744    }
<a name="l01745"></a>01745    dsp-&gt;<a class="code" href="structast__dsp.html#eb5a9e2f0ae95bc1e00e3f37254fa8a9">digitmode</a> = <a class="code" href="structast__dsp.html#eb5a9e2f0ae95bc1e00e3f37254fa8a9">digitmode</a>;
<a name="l01746"></a>01746    <span class="keywordflow">return</span> 0;
<a name="l01747"></a>01747 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="0be381c9328908706b61cc390a1d0a42"></a><!-- doxytag: member="dsp.h::ast_dsp_digitreset" ref="0be381c9328908706b61cc390a1d0a42" args="(struct ast_dsp *dsp)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_dsp_digitreset           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__dsp.html">ast_dsp</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dsp</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Reset DTMF detector. 
<p>

<p>
Definition at line <a class="el" href="dsp_8c-source.html#l01668">1668</a> of file <a class="el" href="dsp_8c-source.html">dsp.c</a>.
<p>
References <a class="el" href="dsp_8c-source.html#l00349">ast_dsp::digitmode</a>, <a class="el" href="dsp_8h-source.html#l00032">DSP_DIGITMODE_MF</a>, <a class="el" href="dsp_8c-source.html#l00324">goertzel_reset()</a>, <a class="el" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">ast_dsp::td</a>, and <a class="el" href="dsp_8c-source.html#l00350">ast_dsp::thinkdigit</a>.
<p>
Referenced by <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>.<div class="fragment"><pre class="fragment"><a name="l01669"></a>01669 {
<a name="l01670"></a>01670    <span class="keywordtype">int</span> i;
<a name="l01671"></a>01671    
<a name="l01672"></a>01672    dsp-&gt;<a class="code" href="structast__dsp.html#b5f38632ebb0dd3a0a1d8bdaf942b2df">thinkdigit</a> = 0;
<a name="l01673"></a>01673    <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="structast__dsp.html#eb5a9e2f0ae95bc1e00e3f37254fa8a9">digitmode</a> &amp; <a class="code" href="dsp_8h.html#fb189b1bdcec9ef8be15ad828fa9849f">DSP_DIGITMODE_MF</a>) {
<a name="l01674"></a>01674       memset(dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.digits, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.digits));
<a name="l01675"></a>01675       dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.current_digits = 0;
<a name="l01676"></a>01676       <span class="comment">/* Reinitialise the detector for the next block */</span>
<a name="l01677"></a>01677       <span class="keywordflow">for</span> (i = 0;  i &lt; 6;  i++) {
<a name="l01678"></a>01678          <a class="code" href="dsp_8c.html#abcc7a296f31ceb6430fda6d1c7c74f4">goertzel_reset</a>(&amp;dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.tone_out[i]);
<a name="l01679"></a>01679 <span class="preprocessor">#ifdef OLD_DSP_ROUTINES</span>
<a name="l01680"></a>01680 <span class="preprocessor"></span>         <a class="code" href="dsp_8c.html#abcc7a296f31ceb6430fda6d1c7c74f4">goertzel_reset</a>(&amp;dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.tone_out2nd[i]);
<a name="l01681"></a>01681 <span class="preprocessor">#endif         </span>
<a name="l01682"></a>01682 <span class="preprocessor"></span>      }
<a name="l01683"></a>01683 <span class="preprocessor">#ifdef OLD_DSP_ROUTINES</span>
<a name="l01684"></a>01684 <span class="preprocessor"></span>      dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.energy = 0.0;
<a name="l01685"></a>01685       dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.hit1 = dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.hit2 = dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.hit3 = dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.hit4 = dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.mhit = 0;
<a name="l01686"></a>01686 <span class="preprocessor">#else</span>
<a name="l01687"></a>01687 <span class="preprocessor"></span>      dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.hits[4] = dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.hits[3] = dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.hits[2] = dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.hits[1] = dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.hits[0] = dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.mhit = 0;
<a name="l01688"></a>01688 <span class="preprocessor">#endif      </span>
<a name="l01689"></a>01689 <span class="preprocessor"></span>      dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.current_sample = 0;
<a name="l01690"></a>01690    } <span class="keywordflow">else</span> {
<a name="l01691"></a>01691       memset(dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.digits, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.digits));
<a name="l01692"></a>01692       dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.current_digits = 0;
<a name="l01693"></a>01693       <span class="comment">/* Reinitialise the detector for the next block */</span>
<a name="l01694"></a>01694       <span class="keywordflow">for</span> (i = 0;  i &lt; 4;  i++) {
<a name="l01695"></a>01695          <a class="code" href="dsp_8c.html#abcc7a296f31ceb6430fda6d1c7c74f4">goertzel_reset</a>(&amp;dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.row_out[i]);
<a name="l01696"></a>01696          <a class="code" href="dsp_8c.html#abcc7a296f31ceb6430fda6d1c7c74f4">goertzel_reset</a>(&amp;dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.col_out[i]);
<a name="l01697"></a>01697 <span class="preprocessor">#ifdef OLD_DSP_ROUTINES</span>
<a name="l01698"></a>01698 <span class="preprocessor"></span>         <a class="code" href="dsp_8c.html#abcc7a296f31ceb6430fda6d1c7c74f4">goertzel_reset</a>(&amp;dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.row_out2nd[i]);
<a name="l01699"></a>01699          <a class="code" href="dsp_8c.html#abcc7a296f31ceb6430fda6d1c7c74f4">goertzel_reset</a>(&amp;dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.col_out2nd[i]);
<a name="l01700"></a>01700 <span class="preprocessor">#endif         </span>
<a name="l01701"></a>01701 <span class="preprocessor"></span>      }
<a name="l01702"></a>01702 <span class="preprocessor">#ifdef FAX_DETECT</span>
<a name="l01703"></a>01703 <span class="preprocessor"></span>      <a class="code" href="dsp_8c.html#abcc7a296f31ceb6430fda6d1c7c74f4">goertzel_reset</a> (&amp;dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.fax_tone);
<a name="l01704"></a>01704 <span class="preprocessor">#endif</span>
<a name="l01705"></a>01705 <span class="preprocessor"></span><span class="preprocessor">#ifdef OLD_DSP_ROUTINES</span>
<a name="l01706"></a>01706 <span class="preprocessor"></span><span class="preprocessor">#ifdef FAX_DETECT</span>
<a name="l01707"></a>01707 <span class="preprocessor"></span>      <a class="code" href="dsp_8c.html#abcc7a296f31ceb6430fda6d1c7c74f4">goertzel_reset</a> (&amp;dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.fax_tone2nd);
<a name="l01708"></a>01708 <span class="preprocessor">#endif</span>
<a name="l01709"></a>01709 <span class="preprocessor"></span>      dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.hit1 = dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.hit2 = dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.hit3 = dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.hit4 = dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.mhit = 0;
<a name="l01710"></a>01710 <span class="preprocessor">#else</span>
<a name="l01711"></a>01711 <span class="preprocessor"></span>      dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.hits[2] = dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.hits[1] = dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.hits[0] =  dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.mhit = 0;
<a name="l01712"></a>01712 <span class="preprocessor">#endif      </span>
<a name="l01713"></a>01713 <span class="preprocessor"></span>      dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.energy = 0.0;
<a name="l01714"></a>01714       dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.current_sample = 0;
<a name="l01715"></a>01715    }
<a name="l01716"></a>01716 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4bcf981973b4db5614c153e1773da6a4"></a><!-- doxytag: member="dsp.h::ast_dsp_free" ref="4bcf981973b4db5614c153e1773da6a4" args="(struct ast_dsp *dsp)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_dsp_free           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__dsp.html">ast_dsp</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dsp</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8c-source.html#l01641">1641</a> of file <a class="el" href="dsp_8c-source.html">dsp.c</a>.
<p>
References <a class="el" href="astmm_8h-source.html#l00069">free</a>.
<p>
Referenced by <a class="el" href="app_8c-source.html#l00509">__ast_play_and_record()</a>, <a class="el" href="chan__h323_8c-source.html#l00455">__oh323_destroy()</a>, <a class="el" href="chan__misdn_8c-source.html#l03389">cl_dequeue_chan()</a>, <a class="el" href="chan__h323_8c-source.html#l02355">cleanup_connection()</a>, <a class="el" href="chan__mgcp_8c-source.html#l04010">destroy_endpoint()</a>, <a class="el" href="res__agi_8c-source.html#l00889">handle_recordfile()</a>, <a class="el" href="app__amd_8c-source.html#l00097">isAnsweringMachine()</a>, <a class="el" href="chan__mgcp_8c-source.html#l00942">mgcp_hangup()</a>, <a class="el" href="app__record_8c-source.html#l00078">record_exec()</a>, <a class="el" href="chan__sip_8c-source.html#l18059">sip_dtmfmode()</a>, <a class="el" href="chan__sip_8c-source.html#l03676">sip_hangup()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, and <a class="el" href="chan__zap_8c-source.html#l02612">zt_hangup()</a>.<div class="fragment"><pre class="fragment"><a name="l01642"></a>01642 {
<a name="l01643"></a>01643    <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(dsp);
<a name="l01644"></a>01644 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="9893a6dc736896fbe2c090d5a41c2a60"></a><!-- doxytag: member="dsp.h::ast_dsp_get_tcount" ref="9893a6dc736896fbe2c090d5a41c2a60" args="(struct ast_dsp *dsp)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_dsp_get_tcount           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__dsp.html">ast_dsp</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dsp</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get tcount (Threshold counter). 
<p>

<p>
Definition at line <a class="el" href="dsp_8c-source.html#l01768">1768</a> of file <a class="el" href="dsp_8c-source.html">dsp.c</a>.
<p>
References <a class="el" href="dsp_8c-source.html#l00348">ast_dsp::tcount</a>.<div class="fragment"><pre class="fragment"><a name="l01769"></a>01769 {
<a name="l01770"></a>01770    <span class="keywordflow">return</span> dsp-&gt;<a class="code" href="structast__dsp.html#488063dd4ff024491b3e79a1745c8ace">tcount</a>;
<a name="l01771"></a>01771 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="7095e2e4ce7ab727f02b5f17db02a9ed"></a><!-- doxytag: member="dsp.h::ast_dsp_get_tstate" ref="7095e2e4ce7ab727f02b5f17db02a9ed" args="(struct ast_dsp *dsp)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_dsp_get_tstate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__dsp.html">ast_dsp</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dsp</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get tstate (Tone State). 
<p>

<p>
Definition at line <a class="el" href="dsp_8c-source.html#l01763">1763</a> of file <a class="el" href="dsp_8c-source.html">dsp.c</a>.
<p>
References <a class="el" href="dsp_8c-source.html#l00347">ast_dsp::tstate</a>.<div class="fragment"><pre class="fragment"><a name="l01764"></a>01764 {
<a name="l01765"></a>01765    <span class="keywordflow">return</span> dsp-&gt;<a class="code" href="structast__dsp.html#d1b96003358007d07982669f630a1016">tstate</a>;
<a name="l01766"></a>01766 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="71a140d025466320bd30016999452c73"></a><!-- doxytag: member="dsp.h::ast_dsp_getdigits" ref="71a140d025466320bd30016999452c73" args="(struct ast_dsp *dsp, char *buf, int max)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_dsp_getdigits           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__dsp.html">ast_dsp</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>max</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get pending DTMF/MF digits. 
<p>

<p>
Definition at line <a class="el" href="dsp_8c-source.html#l01026">1026</a> of file <a class="el" href="dsp_8c-source.html">dsp.c</a>.
<p>
References <a class="el" href="dsp_8c-source.html#l00349">ast_dsp::digitmode</a>, <a class="el" href="dsp_8h-source.html#l00032">DSP_DIGITMODE_MF</a>, and <a class="el" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">ast_dsp::td</a>.<div class="fragment"><pre class="fragment"><a name="l01027"></a>01027 {
<a name="l01028"></a>01028    <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="structast__dsp.html#eb5a9e2f0ae95bc1e00e3f37254fa8a9">digitmode</a> &amp; <a class="code" href="dsp_8h.html#fb189b1bdcec9ef8be15ad828fa9849f">DSP_DIGITMODE_MF</a>) {
<a name="l01029"></a>01029       <span class="keywordflow">if</span> (max &gt; dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.current_digits)
<a name="l01030"></a>01030          max = dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.current_digits;
<a name="l01031"></a>01031       <span class="keywordflow">if</span> (max &gt; 0) {
<a name="l01032"></a>01032          memcpy(<a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>, dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.digits, max);
<a name="l01033"></a>01033          memmove(dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.digits, dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.digits + max, dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.current_digits - max);
<a name="l01034"></a>01034          dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.current_digits -= max;
<a name="l01035"></a>01035       }
<a name="l01036"></a>01036       <a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>[max] = <span class="charliteral">'\0'</span>;
<a name="l01037"></a>01037       <span class="keywordflow">return</span>  max;
<a name="l01038"></a>01038    } <span class="keywordflow">else</span> {
<a name="l01039"></a>01039       <span class="keywordflow">if</span> (max &gt; dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.current_digits)
<a name="l01040"></a>01040          max = dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.current_digits;
<a name="l01041"></a>01041       <span class="keywordflow">if</span> (max &gt; 0) {
<a name="l01042"></a>01042          memcpy (<a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>, dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.digits, max);
<a name="l01043"></a>01043          memmove (dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.digits, dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.digits + max, dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.current_digits - max);
<a name="l01044"></a>01044          dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.current_digits -= max;
<a name="l01045"></a>01045       }
<a name="l01046"></a>01046       <a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>[max] = <span class="charliteral">'\0'</span>;
<a name="l01047"></a>01047       <span class="keywordflow">return</span>  max;
<a name="l01048"></a>01048    }
<a name="l01049"></a>01049 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="95aa7dc3101fae9b433b4f29feaa1bab"></a><!-- doxytag: member="dsp.h::ast_dsp_new" ref="95aa7dc3101fae9b433b4f29feaa1bab" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__dsp.html">ast_dsp</a>* ast_dsp_new           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="dsp_8c-source.html#l01620">1620</a> of file <a class="el" href="dsp_8c-source.html">dsp.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="dsp_8c-source.html#l01603">ast_dsp_prog_reset()</a>, <a class="el" href="dsp_8c-source.html#l00358">ast_dtmf_detect_init()</a>, <a class="el" href="dsp_8c-source.html#l00114">DEFAULT_THRESHOLD</a>, <a class="el" href="dsp_8h-source.html#l00026">DSP_FEATURE_SILENCE_SUPPRESS</a>, <a class="el" href="dsp_8c-source.html#l00125">DSP_HISTORY</a>, and <a class="el" href="dsp_8c-source.html#l00331">ast_dsp::threshold</a>.
<p>
Referenced by <a class="el" href="app_8c-source.html#l00509">__ast_play_and_record()</a>, <a class="el" href="chan__h323_8c-source.html#l01010">__oh323_new()</a>, <a class="el" href="app__talkdetect_8c-source.html#l00063">background_detect_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l01350">conf_run()</a>, <a class="el" href="app__waitforsilence_8c-source.html#l00078">do_waiting()</a>, <a class="el" href="res__agi_8c-source.html#l00889">handle_recordfile()</a>, <a class="el" href="app__amd_8c-source.html#l00097">isAnsweringMachine()</a>, <a class="el" href="chan__mgcp_8c-source.html#l01457">mgcp_new()</a>, <a class="el" href="app__record_8c-source.html#l00078">record_exec()</a>, <a class="el" href="chan__sip_8c-source.html#l18059">sip_dtmfmode()</a>, <a class="el" href="chan__sip_8c-source.html#l04179">sip_new()</a>, and <a class="el" href="chan__zap_8c-source.html#l05516">zt_new()</a>.<div class="fragment"><pre class="fragment"><a name="l01621"></a>01621 {
<a name="l01622"></a>01622    <span class="keyword">struct </span><a class="code" href="structast__dsp.html">ast_dsp</a> *dsp;
<a name="l01623"></a>01623    
<a name="l01624"></a>01624    <span class="keywordflow">if</span> ((dsp = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*dsp)))) {      
<a name="l01625"></a>01625       dsp-&gt;threshold = <a class="code" href="dsp_8c.html#95e4429f816c5226ce29546529715eb1">DEFAULT_THRESHOLD</a>;
<a name="l01626"></a>01626       dsp-&gt;features = <a class="code" href="dsp_8h.html#9b80d1ef1c960c0801c6e29354e5a600">DSP_FEATURE_SILENCE_SUPPRESS</a>;
<a name="l01627"></a>01627       dsp-&gt;busycount = <a class="code" href="dsp_8c.html#4e3bac47692ea9007c13953d7685b463">DSP_HISTORY</a>;
<a name="l01628"></a>01628       <span class="comment">/* Initialize DTMF detector */</span>
<a name="l01629"></a>01629       <a class="code" href="dsp_8c.html#83c8c0a4f0c6f942f8794d8696d8a910">ast_dtmf_detect_init</a>(&amp;dsp-&gt;td.dtmf);
<a name="l01630"></a>01630       <span class="comment">/* Initialize initial DSP progress detect parameters */</span>
<a name="l01631"></a>01631       <a class="code" href="dsp_8c.html#de95e18f7b9aedaaeea3965eb7c9a541">ast_dsp_prog_reset</a>(dsp);
<a name="l01632"></a>01632    }
<a name="l01633"></a>01633    <span class="keywordflow">return</span> dsp;
<a name="l01634"></a>01634 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="e0c80b9ed57dba8c3f9864f8dded8ddb"></a><!-- doxytag: member="dsp.h::ast_dsp_process" ref="e0c80b9ed57dba8c3f9864f8dded8ddb" args="(struct ast_channel *chan, struct ast_dsp *dsp, struct ast_frame *inf)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__frame.html">ast_frame</a>* ast_dsp_process           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__dsp.html">ast_dsp</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>inf</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return AST_FRAME_NULL frames when there is silence, AST_FRAME_BUSY on busies, and call progress, all dependent upon which features are enabled. 
<p>

<p>
Definition at line <a class="el" href="dsp_8c-source.html#l01413">1413</a> of file <a class="el" href="dsp_8c-source.html">dsp.c</a>.
<p>
References <a class="el" href="dsp_8c-source.html#l01051">__ast_dsp_call_progress()</a>, <a class="el" href="dsp_8c-source.html#l00976">__ast_dsp_digitdetect()</a>, <a class="el" href="dsp_8c-source.html#l01201">__ast_dsp_silence()</a>, <a class="el" href="channel_8h-source.html#l00414">ast_channel::_softhangup</a>, <a class="el" href="alaw_8h-source.html#l00041">AST_ALAW</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389edaaffc26d24394cd2557ddb1db10f64">AST_CONTROL_ANSWER</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3898c0ff5febeb7ff9d8880e2bc7f1d6ca1">AST_CONTROL_BUSY</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389fafe5e503d0d74218854b57e66282419">AST_CONTROL_CONGESTION</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3896a1de835fbf024ef925569eb775de67f">AST_CONTROL_HANGUP</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3895749da867c771f2391b19ce9e08f0149">AST_CONTROL_RINGING</a>, <a class="el" href="dsp_8c-source.html#l01257">ast_dsp_busydetect()</a>, <a class="el" href="frame_8h-source.html#l00227">AST_FORMAT_ALAW</a>, <a class="el" href="frame_8h-source.html#l00233">AST_FORMAT_SLINEAR</a>, <a class="el" href="frame_8h-source.html#l00225">AST_FORMAT_ULAW</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a>, <a class="el" href="frame_8h-source.html#l00125">AST_FRAME_DTMF</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f923c709a87ba681b04d6a6285d6d0af892">AST_FRAME_DTMF_BEGIN</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f927fc7453b6ac78761e7a4e46b3fcfa557">AST_FRAME_DTMF_END</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92eaf38b643259d44fcc0a869ab36609b1">AST_FRAME_NULL</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f9264fc4720a7b3982e2d4bf246fe3d9924">AST_FRAME_VOICE</a>, <a class="el" href="frame_8h-source.html#l00396">ast_frfree()</a>, <a class="el" href="frame_8c-source.html#l00532">ast_getformatname()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="ulaw_8h-source.html#l00041">AST_MULAW</a>, <a class="el" href="channel_8c-source.html#l00795">ast_queue_frame()</a>, <a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1cbe3f9a2385d6a31eac6abced2a9f17d">AST_SOFTHANGUP_DEV</a>, <a class="el" href="frame_8h-source.html#l00147">ast_frame::data</a>, <a class="el" href="frame_8h-source.html#l00135">ast_frame::datalen</a>, <a class="el" href="dsp_8c-source.html#l00349">ast_dsp::digitmode</a>, <a class="el" href="dsp_8h-source.html#l00032">DSP_DIGITMODE_MF</a>, <a class="el" href="dsp_8h-source.html#l00035">DSP_DIGITMODE_MUTECONF</a>, <a class="el" href="dsp_8h-source.html#l00036">DSP_DIGITMODE_MUTEMAX</a>, <a class="el" href="dsp_8h-source.html#l00027">DSP_FEATURE_BUSY_DETECT</a>, <a class="el" href="dsp_8h-source.html#l00043">DSP_FEATURE_CALL_PROGRESS</a>, <a class="el" href="dsp_8h-source.html#l00028">DSP_FEATURE_DTMF_DETECT</a>, <a class="el" href="dsp_8h-source.html#l00026">DSP_FEATURE_SILENCE_SUPPRESS</a>, <a class="el" href="dsp_8c-source.html#l00330">ast_dsp::f</a>, <a class="el" href="dsp_8c-source.html#l00334">ast_dsp::features</a>, <a class="el" href="dsp_8c.html#d6c56db9d39c2ec71e748971a2bfda20">FIX_INF</a>, <a class="el" href="frame_8h-source.html#l00131">ast_frame::frametype</a>, <a class="el" href="utils_8h-source.html#l00386">len</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="chan__alsa_8c-source.html#l00131">silence</a>, <a class="el" href="frame_8h-source.html#l00145">ast_frame::src</a>, <a class="el" href="frame_8h-source.html#l00133">ast_frame::subclass</a>, <a class="el" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">ast_dsp::td</a>, and <a class="el" href="dsp_8c-source.html#l00350">ast_dsp::thinkdigit</a>.
<p>
Referenced by <a class="el" href="chan__mgcp_8c-source.html#l01218">mgcp_rtp_read()</a>, <a class="el" href="chan__h323_8c-source.html#l00763">oh323_rtp_read()</a>, <a class="el" href="chan__misdn_8c-source.html#l02539">process_ast_dsp()</a>, and <a class="el" href="chan__zap_8c-source.html#l04906">zt_read()</a>.<div class="fragment"><pre class="fragment"><a name="l01414"></a>01414 {
<a name="l01415"></a>01415    <span class="keywordtype">int</span> <a class="code" href="chan__alsa_8c.html#7a985be8d5c8e77c165d051bec3ba198">silence</a>;
<a name="l01416"></a>01416    <span class="keywordtype">int</span> res;
<a name="l01417"></a>01417    <span class="keywordtype">int</span> digit;
<a name="l01418"></a>01418    <span class="keywordtype">int</span> x;
<a name="l01419"></a>01419    <span class="keywordtype">short</span> *shortdata;
<a name="l01420"></a>01420    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *odata;
<a name="l01421"></a>01421    <span class="keywordtype">int</span> <a class="code" href="utils_8h.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a>;
<a name="l01422"></a>01422    <span class="keywordtype">int</span> writeback = 0;
<a name="l01423"></a>01423 
<a name="l01424"></a>01424 <span class="preprocessor">#define FIX_INF(inf) do { \</span>
<a name="l01425"></a>01425 <span class="preprocessor">      if (writeback) { \</span>
<a name="l01426"></a>01426 <span class="preprocessor">         switch (inf-&gt;subclass) { \</span>
<a name="l01427"></a>01427 <span class="preprocessor">         case AST_FORMAT_SLINEAR: \</span>
<a name="l01428"></a>01428 <span class="preprocessor">            break; \</span>
<a name="l01429"></a>01429 <span class="preprocessor">         case AST_FORMAT_ULAW: \</span>
<a name="l01430"></a>01430 <span class="preprocessor">            for (x=0;x&lt;len;x++) \</span>
<a name="l01431"></a>01431 <span class="preprocessor">               odata[x] = AST_LIN2MU((unsigned short)shortdata[x]); \</span>
<a name="l01432"></a>01432 <span class="preprocessor">            break; \</span>
<a name="l01433"></a>01433 <span class="preprocessor">         case AST_FORMAT_ALAW: \</span>
<a name="l01434"></a>01434 <span class="preprocessor">            for (x=0;x&lt;len;x++) \</span>
<a name="l01435"></a>01435 <span class="preprocessor">               odata[x] = AST_LIN2A((unsigned short)shortdata[x]); \</span>
<a name="l01436"></a>01436 <span class="preprocessor">            break; \</span>
<a name="l01437"></a>01437 <span class="preprocessor">         } \</span>
<a name="l01438"></a>01438 <span class="preprocessor">      } \</span>
<a name="l01439"></a>01439 <span class="preprocessor">   } while(0) </span>
<a name="l01440"></a>01440 <span class="preprocessor"></span>
<a name="l01441"></a>01441    <span class="keywordflow">if</span> (!af)
<a name="l01442"></a>01442       <span class="keywordflow">return</span> NULL;
<a name="l01443"></a>01443    <span class="keywordflow">if</span> (af-&gt;frametype != <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f9264fc4720a7b3982e2d4bf246fe3d9924">AST_FRAME_VOICE</a>)
<a name="l01444"></a>01444       <span class="keywordflow">return</span> af;
<a name="l01445"></a>01445    odata = af-&gt;data;
<a name="l01446"></a>01446    len = af-&gt;datalen;
<a name="l01447"></a>01447    <span class="comment">/* Make sure we have short data */</span>
<a name="l01448"></a>01448    <span class="keywordflow">switch</span> (af-&gt;subclass) {
<a name="l01449"></a>01449    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#ce4d062ff9a85be84b636e7ec67a068b">AST_FORMAT_SLINEAR</a>:
<a name="l01450"></a>01450       shortdata = af-&gt;data;
<a name="l01451"></a>01451       len = af-&gt;datalen / 2;
<a name="l01452"></a>01452       <span class="keywordflow">break</span>;
<a name="l01453"></a>01453    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#a71706b2c864525ec1c9fcf925ae3802">AST_FORMAT_ULAW</a>:
<a name="l01454"></a>01454       shortdata = alloca(af-&gt;datalen * 2);
<a name="l01455"></a>01455       <span class="keywordflow">for</span> (x = 0;x &lt; len; x++) 
<a name="l01456"></a>01456          shortdata[x] = <a class="code" href="ulaw_8h.html#0879b97c4bdaed787e106608ca498a11">AST_MULAW</a>(odata[x]);
<a name="l01457"></a>01457       <span class="keywordflow">break</span>;
<a name="l01458"></a>01458    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#edc237300fef31677662db961c07484b">AST_FORMAT_ALAW</a>:
<a name="l01459"></a>01459       shortdata = alloca(af-&gt;datalen * 2);
<a name="l01460"></a>01460       <span class="keywordflow">for</span> (x = 0; x &lt; len; x++) 
<a name="l01461"></a>01461          shortdata[x] = <a class="code" href="alaw_8h.html#d50849502de04cbf2785fa43d21dc4ec">AST_ALAW</a>(odata[x]);
<a name="l01462"></a>01462       <span class="keywordflow">break</span>;
<a name="l01463"></a>01463    <span class="keywordflow">default</span>:
<a name="l01464"></a>01464       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Inband DTMF is not supported on codec %s. Use RFC2833\n"</span>, <a class="code" href="frame_8c.html#fc9ce4e422290b7bda33cc8685094a97">ast_getformatname</a>(af-&gt;subclass));
<a name="l01465"></a>01465       <span class="keywordflow">return</span> af;
<a name="l01466"></a>01466    }
<a name="l01467"></a>01467    silence = <a class="code" href="dsp_8c.html#859b5bfc83472c10c32bef2fc5c87f0a">__ast_dsp_silence</a>(dsp, shortdata, len, NULL);
<a name="l01468"></a>01468    <span class="keywordflow">if</span> ((dsp-&gt;<a class="code" href="structast__dsp.html#9f034b63948763d489f944319c2eb3de">features</a> &amp; <a class="code" href="dsp_8h.html#9b80d1ef1c960c0801c6e29354e5a600">DSP_FEATURE_SILENCE_SUPPRESS</a>) &amp;&amp; silence) {
<a name="l01469"></a>01469       memset(&amp;dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>));
<a name="l01470"></a>01470       dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>.<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a> = <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92eaf38b643259d44fcc0a869ab36609b1">AST_FRAME_NULL</a>;
<a name="l01471"></a>01471       <span class="keywordflow">return</span> &amp;dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>;
<a name="l01472"></a>01472    }
<a name="l01473"></a>01473    <span class="keywordflow">if</span> ((dsp-&gt;<a class="code" href="structast__dsp.html#9f034b63948763d489f944319c2eb3de">features</a> &amp; <a class="code" href="dsp_8h.html#2a3497141e07a91545d3010734789049">DSP_FEATURE_BUSY_DETECT</a>) &amp;&amp; <a class="code" href="dsp_8c.html#880a270d2941c89713095089cc92deb8">ast_dsp_busydetect</a>(dsp)) {
<a name="l01474"></a>01474       chan-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> |= <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1cbe3f9a2385d6a31eac6abced2a9f17d">AST_SOFTHANGUP_DEV</a>;
<a name="l01475"></a>01475       memset(&amp;dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>));
<a name="l01476"></a>01476       dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>.<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a> = <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a>;
<a name="l01477"></a>01477       dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>.<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> = <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3898c0ff5febeb7ff9d8880e2bc7f1d6ca1">AST_CONTROL_BUSY</a>;
<a name="l01478"></a>01478       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l01479"></a>01479          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Requesting Hangup because the busy tone was detected on channel %s\n"</span>, chan-&gt;name);
<a name="l01480"></a>01480       <span class="keywordflow">return</span> &amp;dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>;
<a name="l01481"></a>01481    }
<a name="l01482"></a>01482    <span class="keywordflow">if</span> ((dsp-&gt;<a class="code" href="structast__dsp.html#9f034b63948763d489f944319c2eb3de">features</a> &amp; <a class="code" href="dsp_8h.html#524e0b0298ba1e3426a6afdd72ca6892">DSP_FEATURE_DTMF_DETECT</a>)) {
<a name="l01483"></a>01483       digit = <a class="code" href="dsp_8c.html#9a305da9481542e7fc0b52466f33f633">__ast_dsp_digitdetect</a>(dsp, shortdata, len, &amp;writeback);
<a name="l01484"></a>01484 <span class="preprocessor">#if 0</span>
<a name="l01485"></a>01485 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (digit)
<a name="l01486"></a>01486          printf(<span class="stringliteral">"Performing digit detection returned %d, digitmode is %d\n"</span>, digit, dsp-&gt;<a class="code" href="structast__dsp.html#eb5a9e2f0ae95bc1e00e3f37254fa8a9">digitmode</a>);
<a name="l01487"></a>01487 <span class="preprocessor">#endif         </span>
<a name="l01488"></a>01488 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="structast__dsp.html#eb5a9e2f0ae95bc1e00e3f37254fa8a9">digitmode</a> &amp; (<a class="code" href="dsp_8h.html#4109343ed21e6d37f8a61939bb693fba">DSP_DIGITMODE_MUTECONF</a> | <a class="code" href="dsp_8h.html#0bd2d02c701959ef9c9a54e1806a5e41">DSP_DIGITMODE_MUTEMAX</a>)) {
<a name="l01489"></a>01489          <span class="keywordflow">if</span> (!dsp-&gt;<a class="code" href="structast__dsp.html#b5f38632ebb0dd3a0a1d8bdaf942b2df">thinkdigit</a>) {
<a name="l01490"></a>01490             <span class="keywordflow">if</span> (digit) {
<a name="l01491"></a>01491                <span class="comment">/* Looks like we might have something.  </span>
<a name="l01492"></a>01492 <span class="comment">                * Request a conference mute for the moment */</span>
<a name="l01493"></a>01493                memset(&amp;dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>));
<a name="l01494"></a>01494                dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>.<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a> = <a class="code" href="frame_8h.html#41e7a80287a24ece13159c2d8b1b9375">AST_FRAME_DTMF</a>;
<a name="l01495"></a>01495                dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>.<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> = <span class="charliteral">'m'</span>;
<a name="l01496"></a>01496                dsp-&gt;<a class="code" href="structast__dsp.html#b5f38632ebb0dd3a0a1d8bdaf942b2df">thinkdigit</a> = <span class="charliteral">'x'</span>;
<a name="l01497"></a>01497                <a class="code" href="dsp_8c.html#d6c56db9d39c2ec71e748971a2bfda20">FIX_INF</a>(af);
<a name="l01498"></a>01498                <span class="keywordflow">if</span> (chan)
<a name="l01499"></a>01499                   <a class="code" href="channel_8c.html#c02f134e64b4fc85c1efd80b8685b635">ast_queue_frame</a>(chan, af);
<a name="l01500"></a>01500                <a class="code" href="frame_8h.html#506c759ec4950e7f7465e8f090a6252b">ast_frfree</a>(af);
<a name="l01501"></a>01501                <span class="keywordflow">return</span> &amp;dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>;
<a name="l01502"></a>01502             }
<a name="l01503"></a>01503          } <span class="keywordflow">else</span> {
<a name="l01504"></a>01504             <span class="keywordflow">if</span> (digit) {
<a name="l01505"></a>01505                <span class="comment">/* Thought we saw one last time.  Pretty sure we really have now */</span>
<a name="l01506"></a>01506                <span class="keywordflow">if</span> ((dsp-&gt;<a class="code" href="structast__dsp.html#b5f38632ebb0dd3a0a1d8bdaf942b2df">thinkdigit</a> != <span class="charliteral">'x'</span>) &amp;&amp; (dsp-&gt;<a class="code" href="structast__dsp.html#b5f38632ebb0dd3a0a1d8bdaf942b2df">thinkdigit</a> != digit)) {
<a name="l01507"></a>01507                   <span class="comment">/* If we found a digit, and we're changing digits, go</span>
<a name="l01508"></a>01508 <span class="comment">                     ahead and send this one, but DON'T stop confmute because</span>
<a name="l01509"></a>01509 <span class="comment">                     we're detecting something else, too... */</span>
<a name="l01510"></a>01510                   memset(&amp;dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>));
<a name="l01511"></a>01511                   dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>.<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a> = <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f927fc7453b6ac78761e7a4e46b3fcfa557">AST_FRAME_DTMF_END</a>;
<a name="l01512"></a>01512                   dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>.<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> = dsp-&gt;<a class="code" href="structast__dsp.html#b5f38632ebb0dd3a0a1d8bdaf942b2df">thinkdigit</a>;
<a name="l01513"></a>01513                   <a class="code" href="dsp_8c.html#d6c56db9d39c2ec71e748971a2bfda20">FIX_INF</a>(af);
<a name="l01514"></a>01514                   <span class="keywordflow">if</span> (chan)
<a name="l01515"></a>01515                      <a class="code" href="channel_8c.html#c02f134e64b4fc85c1efd80b8685b635">ast_queue_frame</a>(chan, af);
<a name="l01516"></a>01516                   <a class="code" href="frame_8h.html#506c759ec4950e7f7465e8f090a6252b">ast_frfree</a>(af);
<a name="l01517"></a>01517                } <span class="keywordflow">else</span> {
<a name="l01518"></a>01518                   dsp-&gt;<a class="code" href="structast__dsp.html#b5f38632ebb0dd3a0a1d8bdaf942b2df">thinkdigit</a> = digit;
<a name="l01519"></a>01519                   memset(&amp;dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>));
<a name="l01520"></a>01520                   dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>.<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a> = <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f923c709a87ba681b04d6a6285d6d0af892">AST_FRAME_DTMF_BEGIN</a>;
<a name="l01521"></a>01521                   dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>.<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> = dsp-&gt;<a class="code" href="structast__dsp.html#b5f38632ebb0dd3a0a1d8bdaf942b2df">thinkdigit</a>;
<a name="l01522"></a>01522                   <a class="code" href="dsp_8c.html#d6c56db9d39c2ec71e748971a2bfda20">FIX_INF</a>(af);
<a name="l01523"></a>01523                   <span class="keywordflow">if</span> (chan)
<a name="l01524"></a>01524                      <a class="code" href="channel_8c.html#c02f134e64b4fc85c1efd80b8685b635">ast_queue_frame</a>(chan, af);
<a name="l01525"></a>01525                   <a class="code" href="frame_8h.html#506c759ec4950e7f7465e8f090a6252b">ast_frfree</a>(af);
<a name="l01526"></a>01526                }
<a name="l01527"></a>01527                <span class="keywordflow">return</span> &amp;dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>;
<a name="l01528"></a>01528             } <span class="keywordflow">else</span> {
<a name="l01529"></a>01529                memset(&amp;dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>));
<a name="l01530"></a>01530                <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="structast__dsp.html#b5f38632ebb0dd3a0a1d8bdaf942b2df">thinkdigit</a> != <span class="charliteral">'x'</span>) {
<a name="l01531"></a>01531                   <span class="comment">/* If we found a digit, send it now */</span>
<a name="l01532"></a>01532                   dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>.<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a> = <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f927fc7453b6ac78761e7a4e46b3fcfa557">AST_FRAME_DTMF_END</a>;
<a name="l01533"></a>01533                   dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>.<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> = dsp-&gt;<a class="code" href="structast__dsp.html#b5f38632ebb0dd3a0a1d8bdaf942b2df">thinkdigit</a>;
<a name="l01534"></a>01534                   dsp-&gt;<a class="code" href="structast__dsp.html#b5f38632ebb0dd3a0a1d8bdaf942b2df">thinkdigit</a> = 0;
<a name="l01535"></a>01535                } <span class="keywordflow">else</span> {
<a name="l01536"></a>01536                   dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>.<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a> = <a class="code" href="frame_8h.html#41e7a80287a24ece13159c2d8b1b9375">AST_FRAME_DTMF</a>;
<a name="l01537"></a>01537                   dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>.<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> = <span class="charliteral">'u'</span>;
<a name="l01538"></a>01538                   dsp-&gt;<a class="code" href="structast__dsp.html#b5f38632ebb0dd3a0a1d8bdaf942b2df">thinkdigit</a> = 0;
<a name="l01539"></a>01539                }
<a name="l01540"></a>01540                <a class="code" href="dsp_8c.html#d6c56db9d39c2ec71e748971a2bfda20">FIX_INF</a>(af);
<a name="l01541"></a>01541                <span class="keywordflow">if</span> (chan)
<a name="l01542"></a>01542                   <a class="code" href="channel_8c.html#c02f134e64b4fc85c1efd80b8685b635">ast_queue_frame</a>(chan, af);
<a name="l01543"></a>01543                <a class="code" href="frame_8h.html#506c759ec4950e7f7465e8f090a6252b">ast_frfree</a>(af);
<a name="l01544"></a>01544                <span class="keywordflow">return</span> &amp;dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>;
<a name="l01545"></a>01545             }
<a name="l01546"></a>01546          }
<a name="l01547"></a>01547       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!digit) {
<a name="l01548"></a>01548          <span class="comment">/* Only check when there is *not* a hit... */</span>
<a name="l01549"></a>01549          <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="structast__dsp.html#eb5a9e2f0ae95bc1e00e3f37254fa8a9">digitmode</a> &amp; <a class="code" href="dsp_8h.html#fb189b1bdcec9ef8be15ad828fa9849f">DSP_DIGITMODE_MF</a>) {
<a name="l01550"></a>01550             <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.current_digits) {
<a name="l01551"></a>01551                memset(&amp;dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>));
<a name="l01552"></a>01552                dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>.<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a> = <a class="code" href="frame_8h.html#41e7a80287a24ece13159c2d8b1b9375">AST_FRAME_DTMF</a>;
<a name="l01553"></a>01553                dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>.<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> = dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.digits[0];
<a name="l01554"></a>01554                memmove(dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.digits, dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.digits + 1, dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.current_digits);
<a name="l01555"></a>01555                dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.mf.current_digits--;
<a name="l01556"></a>01556                <a class="code" href="dsp_8c.html#d6c56db9d39c2ec71e748971a2bfda20">FIX_INF</a>(af);
<a name="l01557"></a>01557                <span class="keywordflow">if</span> (chan)
<a name="l01558"></a>01558                   <a class="code" href="channel_8c.html#c02f134e64b4fc85c1efd80b8685b635">ast_queue_frame</a>(chan, af);
<a name="l01559"></a>01559                <a class="code" href="frame_8h.html#506c759ec4950e7f7465e8f090a6252b">ast_frfree</a>(af);
<a name="l01560"></a>01560                <span class="keywordflow">return</span> &amp;dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>;
<a name="l01561"></a>01561             }
<a name="l01562"></a>01562          } <span class="keywordflow">else</span> {
<a name="l01563"></a>01563             <span class="keywordflow">if</span> (dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.current_digits) {
<a name="l01564"></a>01564                memset(&amp;dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>));
<a name="l01565"></a>01565                dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>.<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a> = <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f927fc7453b6ac78761e7a4e46b3fcfa557">AST_FRAME_DTMF_END</a>;
<a name="l01566"></a>01566                dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>.<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> = dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.digits[0];
<a name="l01567"></a>01567                memmove(dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.digits, dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.digits + 1, dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.current_digits);
<a name="l01568"></a>01568                dsp-&gt;<a class="code" href="structast__dsp.html#626726e60bd1215f36719a308a25b798">td</a>.dtmf.current_digits--;
<a name="l01569"></a>01569                <a class="code" href="dsp_8c.html#d6c56db9d39c2ec71e748971a2bfda20">FIX_INF</a>(af);
<a name="l01570"></a>01570                <span class="keywordflow">if</span> (chan)
<a name="l01571"></a>01571                   <a class="code" href="channel_8c.html#c02f134e64b4fc85c1efd80b8685b635">ast_queue_frame</a>(chan, af);
<a name="l01572"></a>01572                <a class="code" href="frame_8h.html#506c759ec4950e7f7465e8f090a6252b">ast_frfree</a>(af);
<a name="l01573"></a>01573                <span class="keywordflow">return</span> &amp;dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>;
<a name="l01574"></a>01574             }
<a name="l01575"></a>01575          }
<a name="l01576"></a>01576       }
<a name="l01577"></a>01577    }
<a name="l01578"></a>01578    <span class="keywordflow">if</span> ((dsp-&gt;<a class="code" href="structast__dsp.html#9f034b63948763d489f944319c2eb3de">features</a> &amp; <a class="code" href="dsp_8h.html#2e0bc6e2e31cb741d615569ec96b34dc">DSP_FEATURE_CALL_PROGRESS</a>)) {
<a name="l01579"></a>01579       res = <a class="code" href="dsp_8c.html#8e4181ab2669d6ceb17fa012a1503664">__ast_dsp_call_progress</a>(dsp, shortdata, len);
<a name="l01580"></a>01580       <span class="keywordflow">if</span> (res) {
<a name="l01581"></a>01581          <span class="keywordflow">switch</span> (res) {
<a name="l01582"></a>01582          <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389edaaffc26d24394cd2557ddb1db10f64">AST_CONTROL_ANSWER</a>:
<a name="l01583"></a>01583          <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3898c0ff5febeb7ff9d8880e2bc7f1d6ca1">AST_CONTROL_BUSY</a>:
<a name="l01584"></a>01584          <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3895749da867c771f2391b19ce9e08f0149">AST_CONTROL_RINGING</a>:
<a name="l01585"></a>01585          <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389fafe5e503d0d74218854b57e66282419">AST_CONTROL_CONGESTION</a>:
<a name="l01586"></a>01586          <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3896a1de835fbf024ef925569eb775de67f">AST_CONTROL_HANGUP</a>:
<a name="l01587"></a>01587             memset(&amp;dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>));
<a name="l01588"></a>01588             dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>.<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a> = <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a>;
<a name="l01589"></a>01589             dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>.<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> = res;
<a name="l01590"></a>01590             dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>.<a class="code" href="structast__frame.html#25d902c24283ab8cfbac54dfa101ad31">src</a> = <span class="stringliteral">"dsp_progress"</span>;
<a name="l01591"></a>01591             <span class="keywordflow">if</span> (chan) 
<a name="l01592"></a>01592                <a class="code" href="channel_8c.html#c02f134e64b4fc85c1efd80b8685b635">ast_queue_frame</a>(chan, &amp;dsp-&gt;<a class="code" href="structast__dsp.html#8fa14cdd754f91cc6554c9e71929cce7">f</a>);
<a name="l01593"></a>01593             <span class="keywordflow">break</span>;
<a name="l01594"></a>01594          <span class="keywordflow">default</span>:
<a name="l01595"></a>01595             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Don't know how to represent call progress message %d\n"</span>, res);
<a name="l01596"></a>01596          }
<a name="l01597"></a>01597       }
<a name="l01598"></a>01598    }
<a name="l01599"></a>01599    <a class="code" href="dsp_8c.html#d6c56db9d39c2ec71e748971a2bfda20">FIX_INF</a>(af);
<a name="l01600"></a>01600    <span class="keywordflow">return</span> af;
<a name="l01601"></a>01601 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="0aa66dfe7d026210825554bf4d7512bf"></a><!-- doxytag: member="dsp.h::ast_dsp_reset" ref="0aa66dfe7d026210825554bf4d7512bf" args="(struct ast_dsp *dsp)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_dsp_reset           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__dsp.html">ast_dsp</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dsp</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Reset total silence count. 
<p>

<p>
Definition at line <a class="el" href="dsp_8c-source.html#l01718">1718</a> of file <a class="el" href="dsp_8c-source.html">dsp.c</a>.
<p>
References <a class="el" href="dsp_8c-source.html#l00342">ast_dsp::freqs</a>, <a class="el" href="dsp_8c-source.html#l00344">ast_dsp::gsamps</a>, <a class="el" href="dsp_8c-source.html#l00340">ast_dsp::historicnoise</a>, <a class="el" href="dsp_8c-source.html#l00341">ast_dsp::historicsilence</a>, <a class="el" href="dsp_8c-source.html#l00335">ast_dsp::ringtimeout</a>, <a class="el" href="dsp_8c-source.html#l00332">ast_dsp::totalsilence</a>, <a class="el" href="dsp_8c-source.html#l00189">goertzel_state_t::v2</a>, and <a class="el" href="dsp_8c-source.html#l00190">goertzel_state_t::v3</a>.<div class="fragment"><pre class="fragment"><a name="l01719"></a>01719 {
<a name="l01720"></a>01720    <span class="keywordtype">int</span> x;
<a name="l01721"></a>01721    
<a name="l01722"></a>01722    dsp-&gt;<a class="code" href="structast__dsp.html#49af541c5e4edca2fb90987a3c7cd2ab">totalsilence</a> = 0;
<a name="l01723"></a>01723    dsp-&gt;<a class="code" href="structast__dsp.html#7dc36de431e8339fc8f37d34c9c4f2bb">gsamps</a> = 0;
<a name="l01724"></a>01724    <span class="keywordflow">for</span> (x=0;x&lt;4;x++)
<a name="l01725"></a>01725       dsp-&gt;<a class="code" href="structast__dsp.html#75d16c497ed97cd870b554e40df3ea29">freqs</a>[x].<a class="code" href="structgoertzel__state__t.html#1b267619c4812cc46ee281747884ca50">v2</a> = dsp-&gt;<a class="code" href="structast__dsp.html#75d16c497ed97cd870b554e40df3ea29">freqs</a>[x].<a class="code" href="structgoertzel__state__t.html#43a03299a3c3fed3d8ce7b820f3aca81">v3</a> = 0.0;
<a name="l01726"></a>01726    memset(dsp-&gt;<a class="code" href="structast__dsp.html#dc58a4187dd8a0eccad58b432b328806">historicsilence</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="structast__dsp.html#dc58a4187dd8a0eccad58b432b328806">historicsilence</a>));
<a name="l01727"></a>01727    memset(dsp-&gt;<a class="code" href="structast__dsp.html#d6bf5a07ea2e81220552af38e3791335">historicnoise</a>, 0, <span class="keyword">sizeof</span>(dsp-&gt;<a class="code" href="structast__dsp.html#d6bf5a07ea2e81220552af38e3791335">historicnoise</a>));  
<a name="l01728"></a>01728    dsp-&gt;<a class="code" href="structast__dsp.html#25314420cdb37891b675afed8823fb81">ringtimeout</a>= 0;
<a name="l01729"></a>01729 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="0c5f8d78d6a1ca2602f40ece3578f835"></a><!-- doxytag: member="dsp.h::ast_dsp_set_busy_count" ref="0c5f8d78d6a1ca2602f40ece3578f835" args="(struct ast_dsp *dsp, int cadences)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_dsp_set_busy_count           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__dsp.html">ast_dsp</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cadences</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set number of required cadences for busy. 
<p>

<p>
Definition at line <a class="el" href="dsp_8c-source.html#l01651">1651</a> of file <a class="el" href="dsp_8c-source.html">dsp.c</a>.
<p>
References <a class="el" href="dsp_8c-source.html#l00337">ast_dsp::busycount</a>, and <a class="el" href="dsp_8c-source.html#l00125">DSP_HISTORY</a>.
<p>
Referenced by <a class="el" href="chan__zap_8c-source.html#l05516">zt_new()</a>.<div class="fragment"><pre class="fragment"><a name="l01652"></a>01652 {
<a name="l01653"></a>01653    <span class="keywordflow">if</span> (<a class="code" href="chan__zap_8c.html#5d2bdcda0cc13de0da41166e2ee369e6">cadences</a> &lt; 4)
<a name="l01654"></a>01654       <a class="code" href="chan__zap_8c.html#5d2bdcda0cc13de0da41166e2ee369e6">cadences</a> = 4;
<a name="l01655"></a>01655    <span class="keywordflow">if</span> (<a class="code" href="chan__zap_8c.html#5d2bdcda0cc13de0da41166e2ee369e6">cadences</a> &gt; <a class="code" href="dsp_8c.html#4e3bac47692ea9007c13953d7685b463">DSP_HISTORY</a>)
<a name="l01656"></a>01656       <a class="code" href="chan__zap_8c.html#5d2bdcda0cc13de0da41166e2ee369e6">cadences</a> = <a class="code" href="dsp_8c.html#4e3bac47692ea9007c13953d7685b463">DSP_HISTORY</a>;
<a name="l01657"></a>01657    dsp-&gt;<a class="code" href="structast__dsp.html#52a21002e97ff5acfba3fa71bef47c6b">busycount</a> = <a class="code" href="chan__zap_8c.html#5d2bdcda0cc13de0da41166e2ee369e6">cadences</a>;
<a name="l01658"></a>01658 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="7e3dc605ef28188f1998cdc15f4157df"></a><!-- doxytag: member="dsp.h::ast_dsp_set_busy_pattern" ref="7e3dc605ef28188f1998cdc15f4157df" args="(struct ast_dsp *dsp, int tonelength, int quietlength)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_dsp_set_busy_pattern           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__dsp.html">ast_dsp</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>tonelength</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>quietlength</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set expected lengths of the busy tone. 
<p>

<p>
Definition at line <a class="el" href="dsp_8c-source.html#l01660">1660</a> of file <a class="el" href="dsp_8c-source.html">dsp.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="dsp_8c-source.html#l00339">ast_dsp::busy_quietlength</a>, <a class="el" href="dsp_8c-source.html#l00338">ast_dsp::busy_tonelength</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, and <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>.
<p>
Referenced by <a class="el" href="chan__zap_8c-source.html#l05516">zt_new()</a>.<div class="fragment"><pre class="fragment"><a name="l01661"></a>01661 {
<a name="l01662"></a>01662    dsp-&gt;<a class="code" href="structast__dsp.html#f3519c229a77edad267c34820780b211">busy_tonelength</a> = tonelength;
<a name="l01663"></a>01663    dsp-&gt;<a class="code" href="structast__dsp.html#26364047b8b733768c8927147b79c683">busy_quietlength</a> = quietlength;
<a name="l01664"></a>01664    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l01665"></a>01665       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"dsp busy pattern set to %d,%d\n"</span>, tonelength, quietlength);
<a name="l01666"></a>01666 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="5c0c1c53e85826961109ef1c9e10f941"></a><!-- doxytag: member="dsp.h::ast_dsp_set_call_progress_zone" ref="5c0c1c53e85826961109ef1c9e10f941" args="(struct ast_dsp *dsp, char *zone)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_dsp_set_call_progress_zone           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__dsp.html">ast_dsp</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>zone</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set zone for doing progress detection. 
<p>

<p>
Definition at line <a class="el" href="dsp_8c-source.html#l01749">1749</a> of file <a class="el" href="dsp_8c-source.html">dsp.c</a>.
<p>
References <a class="el" href="dsp_8c.html#1af180731a2e28726cc00c25bfefd522">aliases</a>, <a class="el" href="dsp_8c-source.html#l01603">ast_dsp_prog_reset()</a>, <a class="el" href="callerid_8c-source.html#l01043">name</a>, and <a class="el" href="dsp_8c-source.html#l00346">ast_dsp::progmode</a>.
<p>
Referenced by <a class="el" href="chan__zap_8c-source.html#l05516">zt_new()</a>.<div class="fragment"><pre class="fragment"><a name="l01750"></a>01750 {
<a name="l01751"></a>01751    <span class="keywordtype">int</span> x;
<a name="l01752"></a>01752    
<a name="l01753"></a>01753    <span class="keywordflow">for</span> (x=0;x&lt;<span class="keyword">sizeof</span>(<a class="code" href="dsp_8c.html#1af180731a2e28726cc00c25bfefd522">aliases</a>) / <span class="keyword">sizeof</span>(aliases[0]);x++) {
<a name="l01754"></a>01754       <span class="keywordflow">if</span> (!strcasecmp(aliases[x].<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, zone)) {
<a name="l01755"></a>01755          dsp-&gt;<a class="code" href="structast__dsp.html#e31ded0077e13d03b42180cc9bf8436f">progmode</a> = aliases[x].mode;
<a name="l01756"></a>01756          <a class="code" href="dsp_8c.html#de95e18f7b9aedaaeea3965eb7c9a541">ast_dsp_prog_reset</a>(dsp);
<a name="l01757"></a>01757          <span class="keywordflow">return</span> 0;
<a name="l01758"></a>01758       }
<a name="l01759"></a>01759    }
<a name="l01760"></a>01760    <span class="keywordflow">return</span> -1;
<a name="l01761"></a>01761 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3f743cd2722e6c2811abcac903abbda2"></a><!-- doxytag: member="dsp.h::ast_dsp_set_features" ref="3f743cd2722e6c2811abcac903abbda2" args="(struct ast_dsp *dsp, int features)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_dsp_set_features           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__dsp.html">ast_dsp</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>features</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Select feature set. 
<p>

<p>
Definition at line <a class="el" href="dsp_8c-source.html#l01636">1636</a> of file <a class="el" href="dsp_8c-source.html">dsp.c</a>.
<p>
References <a class="el" href="dsp_8c-source.html#l00334">ast_dsp::features</a>.
<p>
Referenced by <a class="el" href="chan__h323_8c-source.html#l01010">__oh323_new()</a>, <a class="el" href="chan__zap_8c-source.html#l03373">disable_dtmf_detect()</a>, <a class="el" href="chan__zap_8c-source.html#l03391">enable_dtmf_detect()</a>, <a class="el" href="chan__mgcp_8c-source.html#l01457">mgcp_new()</a>, <a class="el" href="chan__sip_8c-source.html#l18059">sip_dtmfmode()</a>, <a class="el" href="chan__sip_8c-source.html#l04179">sip_new()</a>, and <a class="el" href="chan__zap_8c-source.html#l05516">zt_new()</a>.<div class="fragment"><pre class="fragment"><a name="l01637"></a>01637 {
<a name="l01638"></a>01638    dsp-&gt;<a class="code" href="structast__dsp.html#9f034b63948763d489f944319c2eb3de">features</a> = <a class="code" href="structast__dsp.html#9f034b63948763d489f944319c2eb3de">features</a>;
<a name="l01639"></a>01639 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="06a1df6a74baf7fbd9f2db229408315f"></a><!-- doxytag: member="dsp.h::ast_dsp_set_threshold" ref="06a1df6a74baf7fbd9f2db229408315f" args="(struct ast_dsp *dsp, int threshold)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_dsp_set_threshold           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__dsp.html">ast_dsp</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>threshold</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set threshold value for silence. 
<p>

<p>
Definition at line <a class="el" href="dsp_8c-source.html#l01646">1646</a> of file <a class="el" href="dsp_8c-source.html">dsp.c</a>.
<p>
References <a class="el" href="dsp_8c-source.html#l00331">ast_dsp::threshold</a>.
<p>
Referenced by <a class="el" href="app_8c-source.html#l00509">__ast_play_and_record()</a>, <a class="el" href="app__waitforsilence_8c-source.html#l00078">do_waiting()</a>, <a class="el" href="res__agi_8c-source.html#l00889">handle_recordfile()</a>, <a class="el" href="app__amd_8c-source.html#l00097">isAnsweringMachine()</a>, and <a class="el" href="app__record_8c-source.html#l00078">record_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l01647"></a>01647 {
<a name="l01648"></a>01648    dsp-&gt;<a class="code" href="structast__dsp.html#f0598264a691a8f62272aca0e79af374">threshold</a> = <a class="code" href="structast__dsp.html#f0598264a691a8f62272aca0e79af374">threshold</a>;
<a name="l01649"></a>01649 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b40de8950fc5d32c476c4462a5e5d5c6"></a><!-- doxytag: member="dsp.h::ast_dsp_silence" ref="b40de8950fc5d32c476c4462a5e5d5c6" args="(struct ast_dsp *dsp, struct ast_frame *f, int *totalsilence)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_dsp_silence           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__dsp.html">ast_dsp</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>dsp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>totalsilence</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return non-zero if this is silence. Updates "totalsilence" with the total number of seconds of silence. 
<p>

<p>
Definition at line <a class="el" href="dsp_8c-source.html#l01395">1395</a> of file <a class="el" href="dsp_8c-source.html">dsp.c</a>.
<p>
References <a class="el" href="dsp_8c-source.html#l01201">__ast_dsp_silence()</a>, <a class="el" href="frame_8h-source.html#l00233">AST_FORMAT_SLINEAR</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f9264fc4720a7b3982e2d4bf246fe3d9924">AST_FRAME_VOICE</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="frame_8h-source.html#l00147">ast_frame::data</a>, <a class="el" href="frame_8h-source.html#l00135">ast_frame::datalen</a>, <a class="el" href="frame_8h-source.html#l00131">ast_frame::frametype</a>, <a class="el" href="utils_8h-source.html#l00386">len</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, and <a class="el" href="frame_8h-source.html#l00133">ast_frame::subclass</a>.
<p>
Referenced by <a class="el" href="app_8c-source.html#l00509">__ast_play_and_record()</a>, <a class="el" href="app__talkdetect_8c-source.html#l00063">background_detect_exec()</a>, <a class="el" href="app__waitforsilence_8c-source.html#l00078">do_waiting()</a>, <a class="el" href="res__agi_8c-source.html#l00889">handle_recordfile()</a>, <a class="el" href="app__amd_8c-source.html#l00097">isAnsweringMachine()</a>, and <a class="el" href="app__record_8c-source.html#l00078">record_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l01396"></a>01396 {
<a name="l01397"></a>01397    <span class="keywordtype">short</span> *<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>;
<a name="l01398"></a>01398    <span class="keywordtype">int</span> <a class="code" href="utils_8h.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a>;
<a name="l01399"></a>01399    
<a name="l01400"></a>01400    <span class="keywordflow">if</span> (f-&gt;<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a> != <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f9264fc4720a7b3982e2d4bf246fe3d9924">AST_FRAME_VOICE</a>) {
<a name="l01401"></a>01401       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Can't calculate silence on a non-voice frame\n"</span>);
<a name="l01402"></a>01402       <span class="keywordflow">return</span> 0;
<a name="l01403"></a>01403    }
<a name="l01404"></a>01404    <span class="keywordflow">if</span> (f-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> != <a class="code" href="frame_8h.html#ce4d062ff9a85be84b636e7ec67a068b">AST_FORMAT_SLINEAR</a>) {
<a name="l01405"></a>01405       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Can only calculate silence on signed-linear frames :(\n"</span>);
<a name="l01406"></a>01406       <span class="keywordflow">return</span> 0;
<a name="l01407"></a>01407    }
<a name="l01408"></a>01408    s = f-&gt;<a class="code" href="structast__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a>;
<a name="l01409"></a>01409    len = f-&gt;<a class="code" href="structast__frame.html#106553e2afb20bec4268dd6bd02c952d">datalen</a>/2;
<a name="l01410"></a>01410    <span class="keywordflow">return</span> <a class="code" href="dsp_8c.html#859b5bfc83472c10c32bef2fc5c87f0a">__ast_dsp_silence</a>(dsp, s, len, <a class="code" href="structast__dsp.html#49af541c5e4edca2fb90987a3c7cd2ab">totalsilence</a>);
<a name="l01411"></a>01411 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Thu May 24 22:27:27 2007 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.5 </small></address>
</body>
</html>
