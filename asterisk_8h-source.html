<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (24 May 2007)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Thu May 24 22:26:29 2007</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir__2Fusr_2Flocal_2Fsrc_2Fasterisk_2Esvn_2Fastum_2Finclude_2F.html">include</a></div>
<h1>asterisk.h</h1><a href="asterisk_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * Asterisk -- A telephony toolkit for Linux.</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * General Definitions for Asterisk top level program</span>
<a name="l00005"></a>00005 <span class="comment"> * </span>
<a name="l00006"></a>00006 <span class="comment"> * Copyright (C) 1999-2006, Digium, Inc.</span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> * Mark Spencer &lt;markster@digium.com&gt;</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> * This program is free software, distributed under the terms of</span>
<a name="l00011"></a>00011 <span class="comment"> * the GNU General Public License</span>
<a name="l00012"></a>00012 <span class="comment"> */</span>
<a name="l00013"></a>00013 <span class="comment"></span>
<a name="l00014"></a>00014 <span class="comment">/*! \file</span>
<a name="l00015"></a>00015 <span class="comment"> * \brief Asterisk main include file. File version handling, generic pbx functions.</span>
<a name="l00016"></a>00016 <span class="comment"> */</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="preprocessor">#ifndef _ASTERISK_H</span>
<a name="l00019"></a>00019 <span class="preprocessor"></span><span class="preprocessor">#define _ASTERISK_H</span>
<a name="l00020"></a>00020 <span class="preprocessor"></span>
<a name="l00021"></a>00021 <span class="comment">/* The include of 'autoconfig.h' is not necessary for any modules that</span>
<a name="l00022"></a>00022 <span class="comment">   are part of the Asterisk source tree, because the top-level Makefile</span>
<a name="l00023"></a>00023 <span class="comment">   will forcibly include that header in all compilations before all</span>
<a name="l00024"></a>00024 <span class="comment">   other headers (even system headers). However, leaving this here will</span>
<a name="l00025"></a>00025 <span class="comment">   help out-of-tree module builders, and doesn't cause any harm for the</span>
<a name="l00026"></a>00026 <span class="comment">   in-tree modules.</span>
<a name="l00027"></a>00027 <span class="comment">*/</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include "<a class="code" href="autoconfig_8h.html">asterisk/autoconfig.h</a>"</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="preprocessor">#include "<a class="code" href="compat_8h.html">asterisk/compat.h</a>"</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="preprocessor">#include "<a class="code" href="paths_8h.html">asterisk/paths.h</a>"</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="comment">/* Default to allowing the umask or filesystem ACLs to determine actual file</span>
<a name="l00035"></a>00035 <span class="comment"> * creation permissions</span>
<a name="l00036"></a>00036 <span class="comment"> */</span>
<a name="l00037"></a>00037 <span class="preprocessor">#ifndef AST_DIR_MODE</span>
<a name="l00038"></a><a class="code" href="asterisk_8h.html#457fd3a85858bd80e12a42d294d94309">00038</a> <span class="preprocessor"></span><span class="preprocessor">#define AST_DIR_MODE 0777</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span><span class="preprocessor">#ifndef AST_FILE_MODE</span>
<a name="l00041"></a><a class="code" href="asterisk_8h.html#40c72ca4a20a53b69eb99c554e214a82">00041</a> <span class="preprocessor"></span><span class="preprocessor">#define AST_FILE_MODE 0666</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span>
<a name="l00044"></a><a class="code" href="asterisk_8h.html#900caad9f94399bdf7f6344a3738976d">00044</a> <span class="preprocessor">#define DEFAULT_LANGUAGE "en"</span>
<a name="l00045"></a>00045 <span class="preprocessor"></span>
<a name="l00046"></a><a class="code" href="asterisk_8h.html#04d52d0c00ed0f3ea0678d55afbf957c">00046</a> <span class="preprocessor">#define DEFAULT_SAMPLE_RATE 8000</span>
<a name="l00047"></a><a class="code" href="asterisk_8h.html#35d9207ec8638d71f1e25e0299f1f48d">00047</a> <span class="preprocessor"></span><span class="preprocessor">#define DEFAULT_SAMPLES_PER_MS  ((DEFAULT_SAMPLE_RATE)/1000)</span>
<a name="l00048"></a><a class="code" href="asterisk_8h.html#8e136921ec18e6d7a07951bf19c1dfc4">00048</a> <span class="preprocessor"></span><span class="preprocessor">#define  setpriority __PLEASE_USE_ast_set_priority_INSTEAD_OF_setpriority__</span>
<a name="l00049"></a><a class="code" href="asterisk_8h.html#7e6c136d19e5300f9824d47089ae28bf">00049</a> <span class="preprocessor"></span><span class="preprocessor">#define  sched_setscheduler   __PLEASE_USE_ast_set_priority_INSTEAD_OF_sched_setscheduler__</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span>
<a name="l00051"></a>00051 <span class="comment">/* provided in asterisk.c */</span>
<a name="l00052"></a>00052 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#0a741f5d37bb00616aba45b9437c13a7">ast_config_AST_CONFIG_DIR</a>[PATH_MAX];
<a name="l00053"></a>00053 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#518e579b8448d2834f4d7bcb3c0374b9">ast_config_AST_CONFIG_FILE</a>[PATH_MAX];
<a name="l00054"></a>00054 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#0c9ed5029117c0cc03a5acb9e5ff967f">ast_config_AST_MODULE_DIR</a>[PATH_MAX];
<a name="l00055"></a>00055 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#a79197213f86764d67b79bf8542e8156">ast_config_AST_SPOOL_DIR</a>[PATH_MAX];
<a name="l00056"></a>00056 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#e30f110a2a02a50a63b05fe5ba3206b6">ast_config_AST_MONITOR_DIR</a>[PATH_MAX];
<a name="l00057"></a>00057 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#017a6bc35b6f5a54d1a20dd5ca71aba3">ast_config_AST_VAR_DIR</a>[PATH_MAX];
<a name="l00058"></a>00058 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#941063989b9bef2acc03ffa668b930a9">ast_config_AST_DATA_DIR</a>[PATH_MAX];
<a name="l00059"></a>00059 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#af6a08df4c5a91b22da1d9bb4fc3e2a3">ast_config_AST_LOG_DIR</a>[PATH_MAX];
<a name="l00060"></a>00060 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#0fc8e656809ce6507ffed32649956381">ast_config_AST_AGI_DIR</a>[PATH_MAX];
<a name="l00061"></a>00061 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#876cf5a30ab9549d0f5d72d8fac4ab1c">ast_config_AST_DB</a>[PATH_MAX];
<a name="l00062"></a>00062 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#5978b4013e123589a1077c519919f7af">ast_config_AST_KEY_DIR</a>[PATH_MAX];
<a name="l00063"></a>00063 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#fd1223810856be295a0c0fc256ec902f">ast_config_AST_PID</a>[PATH_MAX];
<a name="l00064"></a>00064 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#08630e9bc03919e21a3142aa0a35cbb2">ast_config_AST_SOCKET</a>[PATH_MAX];
<a name="l00065"></a>00065 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#8c5e4b7db03e053ea703f7166c2bd056">ast_config_AST_RUN_DIR</a>[PATH_MAX];
<a name="l00066"></a>00066 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#d09bbe8a64f8f712d59fb708101e5313">ast_config_AST_RUN_GROUP</a>[PATH_MAX];
<a name="l00067"></a>00067 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#64c0b497dfed5629380fe004fba12a35">ast_config_AST_RUN_USER</a>[PATH_MAX];
<a name="l00068"></a>00068 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#0c6a6808d852510151af7a84c8f57a99">ast_config_AST_CTL_PERMISSIONS</a>[PATH_MAX];
<a name="l00069"></a>00069 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#71f7124498b65b37b4211976138e2356">ast_config_AST_CTL_OWNER</a>[PATH_MAX];
<a name="l00070"></a>00070 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#3f64ed95129eea6328d3f3ecf4f34de8">ast_config_AST_CTL_GROUP</a>[PATH_MAX];
<a name="l00071"></a>00071 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#cca382de6ca5496a462dcdf283c793d1">ast_config_AST_CTL</a>[PATH_MAX];
<a name="l00072"></a>00072 <span class="keyword">extern</span> <span class="keywordtype">char</span> <a class="code" href="asterisk_8c.html#0a0f8ba4c757a1da509a0cae1830025b">ast_config_AST_SYSTEM_NAME</a>[20];
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 <span class="keywordtype">int</span> <a class="code" href="asterisk_8c.html#493d9dec6c0ca06f6b702513f8a72e96">ast_set_priority</a>(<span class="keywordtype">int</span>);       <span class="comment">/*!&lt; Provided by asterisk.c */</span>
<a name="l00075"></a>00075 <span class="keywordtype">int</span> <a class="code" href="loader_8c.html#2e27856f7fc1b5d125bca47c537ab196">load_modules</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>);        <span class="comment">/*!&lt; Provided by loader.c */</span>
<a name="l00076"></a>00076 <span class="keywordtype">int</span> <a class="code" href="pbx_8c.html#1123cfede7379bd2813e1b4306327c10">load_pbx</a>(<span class="keywordtype">void</span>);           <span class="comment">/*!&lt; Provided by pbx.c */</span>
<a name="l00077"></a>00077 <span class="keywordtype">int</span> <a class="code" href="logger_8c.html#2dc970548287d60ade9a663e2955d2fd">init_logger</a>(<span class="keywordtype">void</span>);           <span class="comment">/*!&lt; Provided by logger.c */</span>
<a name="l00078"></a>00078 <span class="keywordtype">void</span> <a class="code" href="logger_8c.html#323ddd8f4ed93915e0e27717128eba2f">close_logger</a>(<span class="keywordtype">void</span>);         <span class="comment">/*!&lt; Provided by logger.c */</span>
<a name="l00079"></a>00079 <span class="keywordtype">int</span> <a class="code" href="logger_8c.html#8b9f6380a58c329e147cc693a6b52219">reload_logger</a>(<span class="keywordtype">int</span>);          <span class="comment">/*!&lt; Provided by logger.c */</span>
<a name="l00080"></a>00080 <span class="keywordtype">int</span> <a class="code" href="frame_8c.html#d40eb7b18ae20acf758c562e5a44abf1">init_framer</a>(<span class="keywordtype">void</span>);           <span class="comment">/*!&lt; Provided by frame.c */</span>
<a name="l00081"></a>00081 <span class="keywordtype">int</span> <a class="code" href="term_8c.html#5c46f443c8dcb0695a690c4d9f7c37b7">ast_term_init</a>(<span class="keywordtype">void</span>);         <span class="comment">/*!&lt; Provided by term.c */</span>
<a name="l00082"></a>00082 <span class="keywordtype">int</span> <a class="code" href="db_8c.html#ffa7bfa9223627041ba7b94fc751b4e9">astdb_init</a>(<span class="keywordtype">void</span>);            <span class="comment">/*!&lt; Provided by db.c */</span>
<a name="l00083"></a>00083 <span class="keywordtype">void</span> <a class="code" href="channel_8c.html#ea40c04ddba9d91880686eb95e400008">ast_channels_init</a>(<span class="keywordtype">void</span>);       <span class="comment">/*!&lt; Provided by channel.c */</span>
<a name="l00084"></a>00084 <span class="keywordtype">void</span> <a class="code" href="cli_8c.html#833ba54dcfde3b670f65097c0f1aae33">ast_builtins_init</a>(<span class="keywordtype">void</span>);       <span class="comment">/*!&lt; Provided by cli.c */</span>
<a name="l00085"></a>00085 <span class="keywordtype">int</span> <a class="code" href="dnsmgr_8c.html#2edcd99e57832c03d01818ddbb8bf871">dnsmgr_init</a>(<span class="keywordtype">void</span>);           <span class="comment">/*!&lt; Provided by dnsmgr.c */</span> 
<a name="l00086"></a>00086 <span class="keywordtype">void</span> <a class="code" href="dnsmgr_8c.html#6a5d6dd87d710376bdb793d4b5e73010">dnsmgr_start_refresh</a>(<span class="keywordtype">void</span>);    <span class="comment">/*!&lt; Provided by dnsmgr.c */</span>
<a name="l00087"></a>00087 <span class="keywordtype">int</span> <a class="code" href="dnsmgr_8c.html#6be31af1df8dbb8613465dc090879c17">dnsmgr_reload</a>(<span class="keywordtype">void</span>);         <span class="comment">/*!&lt; Provided by dnsmgr.c */</span>
<a name="l00088"></a>00088 <span class="keywordtype">void</span> <a class="code" href="threadstorage_8c.html#59a5fcbc506d1e1e742c0ecbe4fb7ed5">threadstorage_init</a>(<span class="keywordtype">void</span>);         <span class="comment">/*!&lt; Provided by threadstorage.c */</span>
<a name="l00089"></a>00089 <span class="keywordtype">void</span> <a class="code" href="event_8c.html#8422fd37702f84a5ced85ca3a641915b">ast_event_init</a>(<span class="keywordtype">void</span>);          <span class="comment">/*!&lt; Provided by event.c */</span>
<a name="l00090"></a>00090 
<a name="l00091"></a>00091 <span class="comment">/* Many headers need 'ast_channel' to be defined */</span>
<a name="l00092"></a>00092 <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a>;
<a name="l00093"></a>00093 
<a name="l00094"></a>00094 <span class="comment">/* Many headers need 'ast_module' to be defined */</span>
<a name="l00095"></a>00095 <span class="keyword">struct </span><a class="code" href="structast__module.html">ast_module</a>;
<a name="l00096"></a>00096 <span class="comment"></span>
<a name="l00097"></a>00097 <span class="comment">/*!</span>
<a name="l00098"></a>00098 <span class="comment"> * \brief Reload asterisk modules.</span>
<a name="l00099"></a>00099 <span class="comment"> * \param name the name of the module to reload</span>
<a name="l00100"></a>00100 <span class="comment"> *</span>
<a name="l00101"></a>00101 <span class="comment"> * This function reloads the specified module, or if no modules are specified,</span>
<a name="l00102"></a>00102 <span class="comment"> * it will reload all loaded modules.</span>
<a name="l00103"></a>00103 <span class="comment"> *</span>
<a name="l00104"></a>00104 <span class="comment"> * \note Modules are reloaded using their reload() functions, not unloading</span>
<a name="l00105"></a>00105 <span class="comment"> * them and loading them again.</span>
<a name="l00106"></a>00106 <span class="comment"> * </span>
<a name="l00107"></a>00107 <span class="comment"> * \return Zero if the specified module was not found, 1 if the module was</span>
<a name="l00108"></a>00108 <span class="comment"> * found but cannot be reloaded, -1 if a reload operation is already in</span>
<a name="l00109"></a>00109 <span class="comment"> * progress, and 2 if the specfied module was found and reloaded.</span>
<a name="l00110"></a>00110 <span class="comment"> */</span>
<a name="l00111"></a>00111 <span class="keywordtype">int</span> <a class="code" href="loader_8c.html#12479ce54a93d95bd3c845793c3c0f19">ast_module_reload</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l00112"></a>00112 <span class="comment"></span>
<a name="l00113"></a>00113 <span class="comment">/*!</span>
<a name="l00114"></a>00114 <span class="comment"> * \brief Register a function to be executed before Asterisk exits.</span>
<a name="l00115"></a>00115 <span class="comment"> * \param func The callback function to use.</span>
<a name="l00116"></a>00116 <span class="comment"> *</span>
<a name="l00117"></a>00117 <span class="comment"> * \return Zero on success, -1 on error.</span>
<a name="l00118"></a>00118 <span class="comment"> */</span>
<a name="l00119"></a>00119 <span class="keywordtype">int</span> <a class="code" href="asterisk_8c.html#c0fa49bc6ac7af56a1f410920f115253">ast_register_atexit</a>(<span class="keywordtype">void</span> (*<a class="code" href="manager_8h.html#7df4935f4a5a2865191ef74f64df8754">func</a>)(<span class="keywordtype">void</span>));
<a name="l00120"></a>00120 <span class="comment"></span>
<a name="l00121"></a>00121 <span class="comment">/*!   </span>
<a name="l00122"></a>00122 <span class="comment"> * \brief Unregister a function registered with ast_register_atexit().</span>
<a name="l00123"></a>00123 <span class="comment"> * \param func The callback function to unregister.   </span>
<a name="l00124"></a>00124 <span class="comment"> */</span>
<a name="l00125"></a>00125 <span class="keywordtype">void</span> <a class="code" href="asterisk_8c.html#60996aec923b890a13ad493979174ea0">ast_unregister_atexit</a>(<span class="keywordtype">void</span> (*func)(<span class="keywordtype">void</span>));
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 <span class="preprocessor">#if !defined(LOW_MEMORY)</span>
<a name="l00128"></a>00128 <span class="preprocessor"></span><span class="comment">/*!</span>
<a name="l00129"></a>00129 <span class="comment"> * \brief Register the version of a source code file with the core.</span>
<a name="l00130"></a>00130 <span class="comment"> * \param file the source file name</span>
<a name="l00131"></a>00131 <span class="comment"> * \param version the version string (typically a CVS revision keyword string)</span>
<a name="l00132"></a>00132 <span class="comment"> * \return nothing</span>
<a name="l00133"></a>00133 <span class="comment"> *</span>
<a name="l00134"></a>00134 <span class="comment"> * This function should not be called directly, but instead the</span>
<a name="l00135"></a>00135 <span class="comment"> * ASTERISK_FILE_VERSION macro should be used to register a file with the core.</span>
<a name="l00136"></a>00136 <span class="comment"> */</span>
<a name="l00137"></a>00137 <span class="keywordtype">void</span> <a class="code" href="asterisk_8c.html#d52952457c154bcf0009ece6816c06e5">ast_register_file_version</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="manager_8h.html#8c7dd922ad47494fc02c388e12c00eac">file</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *version);
<a name="l00138"></a>00138 <span class="comment"></span>
<a name="l00139"></a>00139 <span class="comment">/*!</span>
<a name="l00140"></a>00140 <span class="comment"> * \brief Unregister a source code file from the core.</span>
<a name="l00141"></a>00141 <span class="comment"> * \param file the source file name</span>
<a name="l00142"></a>00142 <span class="comment"> * \return nothing</span>
<a name="l00143"></a>00143 <span class="comment"> *</span>
<a name="l00144"></a>00144 <span class="comment"> * This function should not be called directly, but instead the</span>
<a name="l00145"></a>00145 <span class="comment"> * ASTERISK_FILE_VERSION macro should be used to automatically unregister</span>
<a name="l00146"></a>00146 <span class="comment"> * the file when the module is unloaded.</span>
<a name="l00147"></a>00147 <span class="comment"> */</span>
<a name="l00148"></a>00148 <span class="keywordtype">void</span> <a class="code" href="asterisk_8c.html#f61bd9bec3e80110272581aa6591c72e">ast_unregister_file_version</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="manager_8h.html#8c7dd922ad47494fc02c388e12c00eac">file</a>);
<a name="l00149"></a>00149 <span class="comment"></span>
<a name="l00150"></a>00150 <span class="comment">/*!</span>
<a name="l00151"></a>00151 <span class="comment"> * \brief Register/unregister a source code file with the core.</span>
<a name="l00152"></a>00152 <span class="comment"> * \param file the source file name</span>
<a name="l00153"></a>00153 <span class="comment"> * \param version the version string (typically a CVS revision keyword string)</span>
<a name="l00154"></a>00154 <span class="comment"> *</span>
<a name="l00155"></a>00155 <span class="comment"> * This macro will place a file-scope constructor and destructor into the</span>
<a name="l00156"></a>00156 <span class="comment"> * source of the module using it; this will cause the version of this file</span>
<a name="l00157"></a>00157 <span class="comment"> * to registered with the Asterisk core (and unregistered) at the appropriate</span>
<a name="l00158"></a>00158 <span class="comment"> * times.</span>
<a name="l00159"></a>00159 <span class="comment"> *</span>
<a name="l00160"></a>00160 <span class="comment"> * Example:</span>
<a name="l00161"></a>00161 <span class="comment"> *</span>
<a name="l00162"></a>00162 <span class="comment"> * \code</span>
<a name="l00163"></a>00163 <span class="comment"> * ASTERISK_FILE_VERSION(__FILE__, "\$Revision\$")</span>
<a name="l00164"></a>00164 <span class="comment"> * \endcode</span>
<a name="l00165"></a>00165 <span class="comment"> *</span>
<a name="l00166"></a>00166 <span class="comment"> * \note The dollar signs above have been protected with backslashes to keep</span>
<a name="l00167"></a>00167 <span class="comment"> * CVS from modifying them in this file; under normal circumstances they would</span>
<a name="l00168"></a>00168 <span class="comment"> * not be present and CVS would expand the Revision keyword into the file's</span>
<a name="l00169"></a>00169 <span class="comment"> * revision number.</span>
<a name="l00170"></a>00170 <span class="comment"> */</span>
<a name="l00171"></a>00171 <span class="preprocessor">#ifdef MTX_PROFILE</span>
<a name="l00172"></a>00172 <span class="preprocessor"></span><span class="preprocessor">#define  HAVE_MTX_PROFILE  </span><span class="comment">/* used in lock.h */</span>
<a name="l00173"></a>00173 <span class="preprocessor">#define ASTERISK_FILE_VERSION(file, version) \</span>
<a name="l00174"></a>00174 <span class="preprocessor">   static int mtx_prof = -1;       </span><span class="comment">/* profile mutex */</span>   \
<a name="l00175"></a>00175    static void __attribute__((constructor)) __register_file_version(void) \
<a name="l00176"></a>00176    { \
<a name="l00177"></a>00177       mtx_prof = ast_add_profile("mtx_lock_" file, 0);   \
<a name="l00178"></a>00178       ast_register_file_version(file, version); \
<a name="l00179"></a>00179    } \
<a name="l00180"></a>00180    static void __attribute__((destructor)) __unregister_file_version(void) \
<a name="l00181"></a>00181    { \
<a name="l00182"></a>00182       ast_unregister_file_version(file); \
<a name="l00183"></a>00183    }
<a name="l00184"></a>00184 <span class="preprocessor">#else </span><span class="comment">/* !MTX_PROFILE */</span>
<a name="l00185"></a><a class="code" href="asterisk_8h.html#9c510a313e63f75dac1b4afadc0d5545">00185</a> <span class="preprocessor">#define ASTERISK_FILE_VERSION(file, version) \</span>
<a name="l00186"></a>00186 <span class="preprocessor">   static void __attribute__((constructor)) __register_file_version(void) \</span>
<a name="l00187"></a>00187 <span class="preprocessor">   { \</span>
<a name="l00188"></a>00188 <span class="preprocessor">      ast_register_file_version(file, version); \</span>
<a name="l00189"></a>00189 <span class="preprocessor">   } \</span>
<a name="l00190"></a>00190 <span class="preprocessor">   static void __attribute__((destructor)) __unregister_file_version(void) \</span>
<a name="l00191"></a>00191 <span class="preprocessor">   { \</span>
<a name="l00192"></a>00192 <span class="preprocessor">      ast_unregister_file_version(file); \</span>
<a name="l00193"></a>00193 <span class="preprocessor">   }</span>
<a name="l00194"></a>00194 <span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/* !MTX_PROFILE */</span>
<a name="l00195"></a>00195 <span class="preprocessor">#else </span><span class="comment">/* LOW_MEMORY */</span>
<a name="l00196"></a>00196 <span class="preprocessor">#define ASTERISK_FILE_VERSION(file, x)</span>
<a name="l00197"></a>00197 <span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/* LOW_MEMORY */</span>
<a name="l00198"></a>00198 
<a name="l00199"></a>00199 <span class="preprocessor">#if !defined(LOW_MEMORY)</span>
<a name="l00200"></a>00200 <span class="preprocessor"></span><span class="comment">/*!</span>
<a name="l00201"></a>00201 <span class="comment"> * \brief support for event profiling</span>
<a name="l00202"></a>00202 <span class="comment"> *</span>
<a name="l00203"></a>00203 <span class="comment"> * (note, this must be documented a lot more)</span>
<a name="l00204"></a>00204 <span class="comment"> * ast_add_profile allocates a generic 'counter' with a given name,</span>
<a name="l00205"></a>00205 <span class="comment"> * which can be shown with the command 'show profile &lt;name&gt;'</span>
<a name="l00206"></a>00206 <span class="comment"> *</span>
<a name="l00207"></a>00207 <span class="comment"> * The counter accumulates positive or negative values supplied by</span>
<a name="l00208"></a>00208 <span class="comment"> * ast_add_profile(), dividing them by the 'scale' value passed in the</span>
<a name="l00209"></a>00209 <span class="comment"> * create call, and also counts the number of 'events'.</span>
<a name="l00210"></a>00210 <span class="comment"> * Values can also be taked by the TSC counter on ia32 architectures,</span>
<a name="l00211"></a>00211 <span class="comment"> * in which case you can mark the start of an event calling ast_mark(id, 1)</span>
<a name="l00212"></a>00212 <span class="comment"> * and then the end of the event with ast_mark(id, 0).</span>
<a name="l00213"></a>00213 <span class="comment"> * For non-i386 architectures, these two calls return 0.</span>
<a name="l00214"></a>00214 <span class="comment"> */</span>
<a name="l00215"></a>00215 <span class="keywordtype">int</span> <a class="code" href="asterisk_8c.html#ee200af0b46d69592f0df14e7652e8b0">ast_add_profile</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *, uint64_t scale);
<a name="l00216"></a>00216 int64_t <a class="code" href="asterisk_8c.html#fd0bf2a38bf67c21dc1ce60bcda3240e">ast_profile</a>(<span class="keywordtype">int</span>, int64_t);
<a name="l00217"></a>00217 int64_t <a class="code" href="asterisk_8c.html#fe3990908e16ffa4ec9e929bb02fad2c">ast_mark</a>(<span class="keywordtype">int</span>, <span class="keywordtype">int</span> start1_stop0);
<a name="l00218"></a>00218 <span class="preprocessor">#else </span><span class="comment">/* LOW_MEMORY */</span>
<a name="l00219"></a>00219 <span class="preprocessor">#define ast_add_profile(a, b) 0</span>
<a name="l00220"></a>00220 <span class="preprocessor"></span><span class="preprocessor">#define ast_profile(a, b) do { } while (0)</span>
<a name="l00221"></a>00221 <span class="preprocessor"></span><span class="preprocessor">#define ast_mark(a, b) do { } while (0)</span>
<a name="l00222"></a>00222 <span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/* LOW_MEMORY */</span>
<a name="l00223"></a>00223 
<a name="l00224"></a>00224 <span class="preprocessor">#endif </span><span class="comment">/* _ASTERISK_H */</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu May 24 22:26:29 2007 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.5 </small></address>
</body>
</html>
