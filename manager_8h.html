<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (24 May 2007)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Thu May 24 22:27:37 2007</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir__2Fusr_2Flocal_2Fsrc_2Fasterisk_2Esvn_2Fastum_2Finclude_2F.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir__2Fusr_2Flocal_2Fsrc_2Fasterisk_2Esvn_2Fastum_2Finclude_2Fasterisk_2F.html">asterisk</a></div>
<h1>manager.h File Reference</h1>The AMI - Asterisk Manager Interface - is a TCP protocol created to manage Asterisk with third-party software. <a href="#_details">More...</a>
<p>
<code>#include &lt;stdarg.h&gt;</code><br>
<code>#include &lt;sys/types.h&gt;</code><br>
<code>#include &lt;sys/socket.h&gt;</code><br>
<code>#include &lt;netinet/in.h&gt;</code><br>
<code>#include &lt;arpa/inet.h&gt;</code><br>
<code>#include &quot;<a class="el" href="lock_8h-source.html">asterisk/lock.h</a>&quot;</code><br>

<p>
<a href="manager_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmanager__action.html">manager_action</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmanager__custom__hook.html">manager_custom_hook</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmessage.html">message</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#f3dd4f0a97fca03a8648f607708dafe5">AMI_VERSION</a>&nbsp;&nbsp;&nbsp;&quot;1.0&quot;</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#e4738d78136f7a3a390d7729872d206e">ast_manager_register</a>(a, b, c, d)&nbsp;&nbsp;&nbsp;ast_manager_register2(a, b, c, d, NULL)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#233ac9532f94e3f2b355891d25414118">AST_MAX_MANHEADERS</a>&nbsp;&nbsp;&nbsp;128</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#46c656f1ee5c96c2595d976973a96b7d">DEFAULT_MANAGER_PORT</a>&nbsp;&nbsp;&nbsp;5038</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#583e421890aa7e205abdcb39885d0b60">EVENT_FLAG_AGENT</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 5)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#055847dde76185d8491133f37610d68d">EVENT_FLAG_COMMAND</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 4)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#31c33938947056ad055258c5c585812c">EVENT_FLAG_CONFIG</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 7)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#d069fd0c9177a3b1a91cee305ddbeed3">EVENT_FLAG_DTMF</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 8)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#af437953071f12ffe22b0c72f3226b36">EVENT_FLAG_LOG</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 2)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#440ebd9d80179402b9cd76c426adb8d2">EVENT_FLAG_SYSTEM</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#87a2ec651ddd1db88b41715162d7a242">EVENT_FLAG_USER</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 6)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#f1cf405b1779736dc4e611883809b409">EVENT_FLAG_VERBOSE</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 3)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#17a8c809d5b2d04cbb8969a209134c2b">manager_event</a>(category, <a class="el" href="manager_8h.html#4119639092e62c55ea8be348e4d9260d">event</a>, <a class="el" href="manager_8h.html#98bf7d8c15784f0a3d63204441e1e2aa">contents</a>,)&nbsp;&nbsp;&nbsp;__manager_event(category, <a class="el" href="manager_8h.html#4119639092e62c55ea8be348e4d9260d">event</a>, __FILE__, __LINE__, __PRETTY_FUNCTION__, <a class="el" href="manager_8h.html#98bf7d8c15784f0a3d63204441e1e2aa">contents</a> , ## __VA_ARGS__)</td></tr>

<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef int(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#c4993551c9eef6913ec2fb6f1f9bcd7c">manager_hook_t</a> )(int, const char *, char *)</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#c977be6baedefea7283a393e49325620">__attribute__</a> ((<a class="el" href="cdr__custom_8c.html#b954976e6264c40232046aacb5b7c390">format</a>(printf, 2, 3))) astman_append(struct <a class="el" href="structmansession.html">mansession</a> *s</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#704aac0387cab0355e8d7f2f26d3e791">__attribute__</a> ((<a class="el" href="cdr__custom_8c.html#b954976e6264c40232046aacb5b7c390">format</a>(printf, 6, 7))) __manager_event(int category</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a> (const char *action, int authority, int(*<a class="el" href="utils_8h.html#7df4935f4a5a2865191ef74f64df8754">func</a>)(struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m), const char *<a class="el" href="res__features_8c.html#512fbb4e7b617c04031f58b631f2b05d">synopsis</a>, const char *description)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">register a new command with manager, including online help. This is the preferred way to register a manager command  <a href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#g6c0dd33a0e93b1a38be809f2e99980e4">ast_manager_register_hook</a> (struct <a class="el" href="structmanager__custom__hook.html">manager_custom_hook</a> *hook)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a custom hook to be called when an event is fired.  <a href="group__Group__AMI.html#g6c0dd33a0e93b1a38be809f2e99980e4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#g2ec5f3830dfb4a55fdf0ad8e78bc0db6">ast_manager_unregister</a> (char *action)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#g146f09ab1ed1df560f0ffe8113b3a88d">ast_manager_unregister_hook</a> (struct <a class="el" href="structmanager__custom__hook.html">manager_custom_hook</a> *hook)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Delete a custom hook to be called when an event is fired.  <a href="group__Group__AMI.html#g146f09ab1ed1df560f0ffe8113b3a88d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int const char const char <br>
int const char const char <br>
const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gd208abe83c7bd47d8004134de94d1b4b">astman_get_header</a> (const struct <a class="el" href="structmessage.html">message</a> *m, char *var)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__variable.html">ast_variable</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gf6be899da040cd416bb8317db016c1ff">astman_get_variables</a> (const struct <a class="el" href="structmessage.html">message</a> *m)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#g0c64878b307241bfe01cea67e09f49e2">astman_send_ack</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m, char *<a class="el" href="adsistub_8c.html#6e2baaf3b97dbeef01c0043275f9a0e7">msg</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#g23a27dba104a8df4bb1c6a217a71e7e7">astman_send_error</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m, char *error)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#ga868a0aada874f97606fcc3119bad3da">astman_send_listack</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m, char *<a class="el" href="adsistub_8c.html#6e2baaf3b97dbeef01c0043275f9a0e7">msg</a>, char *listflag)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#g005978ca7456f4c36c0cd89907d68fdb">astman_send_response</a> (struct <a class="el" href="structmansession.html">mansession</a> *s, const struct <a class="el" href="structmessage.html">message</a> *m, char *resp, char *<a class="el" href="adsistub_8c.html#6e2baaf3b97dbeef01c0043275f9a0e7">msg</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#cd5d8fb2d13b6780ba64c65a02485168">astman_verify_session_readpermissions</a> (unsigned long ident, int perm)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Verify a session's read permissions against a permission mask.  <a href="#cd5d8fb2d13b6780ba64c65a02485168"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#26f962a7a7a8f0cfadc06b37b77863bc">astman_verify_session_writepermissions</a> (unsigned long ident, int perm)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Verify a session's write permissions against a permission mask.  <a href="#26f962a7a7a8f0cfadc06b37b77863bc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#eca71ad744885dbe24bb135cef1012cb">authority_to_str</a> (int authority, char *res, int reslen)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert authority code to string with serveral options.  <a href="#eca71ad744885dbe24bb135cef1012cb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#gd45bb050dddb40e1768551d6be08c1ad">check_manager_enabled</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check if AMI is enabled.  <a href="group__Group__AMI.html#gd45bb050dddb40e1768551d6be08c1ad"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Group__AMI.html#g6fcd08c8c073e9da6c6f96d6663d69d9">check_webmanager_enabled</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check if AMI/HTTP is enabled.  <a href="group__Group__AMI.html#g6fcd08c8c073e9da6c6f96d6663d69d9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#dbdb69247084ab84961d3083a842d809">get_perm</a> (char *instr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void const char int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#31a28c522e71a1df85feb1926f943821">init_manager</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#5261ebdd008364aa84e6d7254982898e">reload_manager</a> (void)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int const char const char <br>
int const char const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#98bf7d8c15784f0a3d63204441e1e2aa">contents</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#4119639092e62c55ea8be348e4d9260d">event</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int const char const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#8c7dd922ad47494fc02c388e12c00eac">file</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#7631454338ff70b1a6b1262f5f36beac">fmt</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int const char const char <br>
int const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#7df4935f4a5a2865191ef74f64df8754">func</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int const char const char int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manager_8h.html#6438c669e0d0de98e6929c2cc0fac474">line</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
The AMI - Asterisk Manager Interface - is a TCP protocol created to manage Asterisk with third-party software. 
<p>
Manager protocol packages are text fields of the form a: b. There is always exactly one space after the colon.<p>
The first header type is the "Event" header. Other headers vary from event to event. Headers end with standard <br>
 termination. The last line of the manager response or event is an empty line. (<br>
)<p>
Please try to re-use existing headers to simplify manager message parsing in clients. Don't re-use an existing header with a new meaning, please. You can find a reference of standard headers in doc/manager.txt 
<p>
Definition in file <a class="el" href="manager_8h-source.html">manager.h</a>.<hr><h2>Define Documentation</h2>
<a class="anchor" name="f3dd4f0a97fca03a8648f607708dafe5"></a><!-- doxytag: member="manager.h::AMI_VERSION" ref="f3dd4f0a97fca03a8648f607708dafe5" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AMI_VERSION&nbsp;&nbsp;&nbsp;&quot;1.0&quot;          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00048">48</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l02200">action_coresettings()</a>, and <a class="el" href="manager_8c-source.html#l02448">session_do()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="e4738d78136f7a3a390d7729872d206e"></a><!-- doxytag: member="manager.h::ast_manager_register" ref="e4738d78136f7a3a390d7729872d206e" args="(a, b, c, d)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define ast_manager_register          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">a,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>b,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>c,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>d&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;ast_manager_register2(a, b, c, d, NULL)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00116">116</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.
<p>
Referenced by <a class="el" href="db_8c-source.html#l00643">astdb_init()</a>, <a class="el" href="manager_8c-source.html#l03215">init_manager()</a>, and <a class="el" href="app__meetme_8c-source.html#l04847">load_module()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="233ac9532f94e3f2b355891d25414118"></a><!-- doxytag: member="manager.h::AST_MAX_MANHEADERS" ref="233ac9532f94e3f2b355891d25414118" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_MAX_MANHEADERS&nbsp;&nbsp;&nbsp;128          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00062">62</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l02416">do_message()</a>, and <a class="el" href="manager_8c-source.html#l02988">generic_http_callback()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="46c656f1ee5c96c2595d976973a96b7d"></a><!-- doxytag: member="manager.h::DEFAULT_MANAGER_PORT" ref="46c656f1ee5c96c2595d976973a96b7d" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DEFAULT_MANAGER_PORT&nbsp;&nbsp;&nbsp;5038          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00049">49</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l03215">init_manager()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="583e421890aa7e205abdcb39885d0b60"></a><!-- doxytag: member="manager.h::EVENT_FLAG_AGENT" ref="583e421890aa7e205abdcb39885d0b60" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define EVENT_FLAG_AGENT&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 5)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00056">56</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.
<p>
Referenced by <a class="el" href="chan__agent_8c-source.html#l01763">__login_exec()</a>, <a class="el" href="app__queue_8c-source.html#l02971">add_to_queue()</a>, <a class="el" href="chan__agent_8c-source.html#l01473">agent_logoff_maintenance()</a>, <a class="el" href="app__queue_8c-source.html#l00541">handle_statechange()</a>, <a class="el" href="app__queue_8c-source.html#l04759">load_module()</a>, <a class="el" href="app__queue_8c-source.html#l01914">record_abandoned()</a>, <a class="el" href="app__queue_8c-source.html#l02917">remove_from_queue()</a>, <a class="el" href="app__queue_8c-source.html#l01660">ring_entry()</a>, <a class="el" href="app__queue_8c-source.html#l02385">send_agent_complete()</a>, <a class="el" href="app__queue_8c-source.html#l03022">set_member_paused()</a>, <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>, and <a class="el" href="app__queue_8c-source.html#l01535">update_status()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="c81a36aac6503176bd649993386b23e4"></a><!-- doxytag: member="manager.h::EVENT_FLAG_CALL" ref="c81a36aac6503176bd649993386b23e4" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define EVENT_FLAG_CALL&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 1)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00052">52</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l03335">ast_change_name()</a>, <a class="el" href="channel_8c-source.html#l00632">ast_channel_alloc()</a>, <a class="el" href="channel_8c-source.html#l03953">ast_channel_bridge()</a>, <a class="el" href="channel_8c-source.html#l03406">ast_do_masquerade()</a>, <a class="el" href="channel_8c-source.html#l01598">ast_hangup()</a>, <a class="el" href="res__features_8c-source.html#l00342">ast_park_call()</a>, <a class="el" href="channel_8c-source.html#l03694">ast_set_callerid()</a>, <a class="el" href="channel_8c-source.html#l03728">ast_setstate()</a>, <a class="el" href="res__features_8c-source.html#l02716">bridge_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l01211">conf_free()</a>, <a class="el" href="app__meetme_8c-source.html#l01350">conf_run()</a>, <a class="el" href="manager_8c-source.html#l01850">fast_originate()</a>, <a class="el" href="manager_8c-source.html#l03215">init_manager()</a>, <a class="el" href="app__queue_8c-source.html#l01240">join_queue()</a>, <a class="el" href="app__queue_8c-source.html#l01477">leave_queue()</a>, <a class="el" href="app__senddtmf_8c-source.html#l00133">load_module()</a>, <a class="el" href="cdr__manager_8c-source.html#l00086">manager_log()</a>, <a class="el" href="manager_8c-source.html#l02654">manager_state_cb()</a>, <a class="el" href="app__minivm_8c-source.html#l01427">notify_new_message()</a>, <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>, <a class="el" href="res__features_8c-source.html#l01746">post_manager_event()</a>, <a class="el" href="chan__sip_8c-source.html#l05180">process_sdp()</a>, <a class="el" href="pbx__realtime_8c-source.html#l00174">realtime_exec()</a>, <a class="el" href="app__dial_8c-source.html#l00415">senddialendevent()</a>, <a class="el" href="app__dial_8c-source.html#l00400">senddialevent()</a>, <a class="el" href="chan__iax2_8c-source.html#l06624">socket_process()</a>, and <a class="el" href="app__voicemail_8c-source.html#l06398">vm_execmain()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="055847dde76185d8491133f37610d68d"></a><!-- doxytag: member="manager.h::EVENT_FLAG_COMMAND" ref="055847dde76185d8491133f37610d68d" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define EVENT_FLAG_COMMAND&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 4)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00055">55</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l03215">init_manager()</a>, and <a class="el" href="res__features_8c-source.html#l02851">load_module()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="31c33938947056ad055258c5c585812c"></a><!-- doxytag: member="manager.h::EVENT_FLAG_CONFIG" ref="31c33938947056ad055258c5c585812c" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define EVENT_FLAG_CONFIG&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 7)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00058">58</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.
<p>
Referenced by <a class="el" href="http_8c-source.html#l00416">handle_post()</a>, <a class="el" href="manager_8c-source.html#l03215">init_manager()</a>, <a class="el" href="pbx_8c-source.html#l06035">load_pbx()</a>, and <a class="el" href="pbx_8c-source.html#l03690">manager_show_dialplan()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="d069fd0c9177a3b1a91cee305ddbeed3"></a><!-- doxytag: member="manager.h::EVENT_FLAG_DTMF" ref="d069fd0c9177a3b1a91cee305ddbeed3" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define EVENT_FLAG_DTMF&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 8)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00059">59</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02047">send_dtmf_event()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="af437953071f12ffe22b0c72f3226b36"></a><!-- doxytag: member="manager.h::EVENT_FLAG_LOG" ref="af437953071f12ffe22b0c72f3226b36" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define EVENT_FLAG_LOG&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 2)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00053">53</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="440ebd9d80179402b9cd76c426adb8d2"></a><!-- doxytag: member="manager.h::EVENT_FLAG_SYSTEM" ref="440ebd9d80179402b9cd76c426adb8d2" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define EVENT_FLAG_SYSTEM&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00051">51</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.
<p>
Referenced by <a class="el" href="chan__iax2_8c-source.html#l05666">__expire_registry()</a>, <a class="el" href="chan__iax2_8c-source.html#l08190">__iax2_poke_noanswer()</a>, <a class="el" href="db_8c-source.html#l00643">astdb_init()</a>, <a class="el" href="chan__sip_8c-source.html#l08271">expire_register()</a>, <a class="el" href="chan__zap_8c-source.html#l06934">handle_init_event()</a>, <a class="el" href="chan__sip_8c-source.html#l12569">handle_response_invite()</a>, <a class="el" href="chan__sip_8c-source.html#l13071">handle_response_peerpoke()</a>, <a class="el" href="chan__sip_8c-source.html#l12931">handle_response_register()</a>, <a class="el" href="chan__iax2_8c-source.html#l05519">iax2_ack_registry()</a>, <a class="el" href="chan__iax2_8c-source.html#l00903">iax2_ami_channelupdate()</a>, <a class="el" href="manager_8c-source.html#l03215">init_manager()</a>, <a class="el" href="chan__sip_8c-source.html#l18436">load_module()</a>, <a class="el" href="logger_8c-source.html#l00645">logger_print_normal()</a>, <a class="el" href="chan__sip_8c-source.html#l08437">parse_register_contact()</a>, <a class="el" href="asterisk_8c-source.html#l01201">quit_handler()</a>, <a class="el" href="chan__sip_8c-source.html#l08956">register_verify()</a>, <a class="el" href="chan__sip_8c-source.html#l17179">reload_config()</a>, <a class="el" href="logger_8c-source.html#l00397">reload_logger()</a>, <a class="el" href="manager_8c-source.html#l03442">reload_manager()</a>, <a class="el" href="chan__sip_8c-source.html#l04179">sip_new()</a>, <a class="el" href="chan__sip_8c-source.html#l16137">sip_poke_noanswer()</a>, <a class="el" href="chan__sip_8c-source.html#l07839">sip_reg_timeout()</a>, <a class="el" href="chan__sip_8c-source.html#l16326">sip_request_call()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, <a class="el" href="chan__iax2_8c-source.html#l05757">update_registry()</a>, and <a class="el" href="chan__zap_8c-source.html#l03942">zt_handle_event()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="87a2ec651ddd1db88b41715162d7a242"></a><!-- doxytag: member="manager.h::EVENT_FLAG_USER" ref="87a2ec651ddd1db88b41715162d7a242" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define EVENT_FLAG_USER&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 6)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00057">57</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l02176">action_userevent()</a>, <a class="el" href="res__jabber_8c-source.html#l00448">aji_log_hook()</a>, <a class="el" href="manager_8c-source.html#l03215">init_manager()</a>, and <a class="el" href="app__userevent_8c-source.html#l00058">userevent_exec()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="f1cf405b1779736dc4e611883809b409"></a><!-- doxytag: member="manager.h::EVENT_FLAG_VERBOSE" ref="f1cf405b1779736dc4e611883809b409" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define EVENT_FLAG_VERBOSE&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 3)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00054">54</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="17a8c809d5b2d04cbb8969a209134c2b"></a><!-- doxytag: member="manager.h::manager_event" ref="17a8c809d5b2d04cbb8969a209134c2b" args="(category, event, contents,)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define manager_event          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">category,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="manager_8h.html#4119639092e62c55ea8be348e4d9260d">event</a>,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="manager_8h.html#98bf7d8c15784f0a3d63204441e1e2aa">contents</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;__manager_event(category, <a class="el" href="manager_8h.html#4119639092e62c55ea8be348e4d9260d">event</a>, __FILE__, __LINE__, __PRETTY_FUNCTION__, <a class="el" href="manager_8h.html#98bf7d8c15784f0a3d63204441e1e2aa">contents</a> , ## __VA_ARGS__)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>category</em>&nbsp;</td><td>Event category, matches manager authorization </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>event</em>&nbsp;</td><td>Event name </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>contents</em>&nbsp;</td><td>Contents of event </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00163">163</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.
<p>
Referenced by <a class="el" href="chan__iax2_8c-source.html#l05666">__expire_registry()</a>, <a class="el" href="chan__iax2_8c-source.html#l08190">__iax2_poke_noanswer()</a>, <a class="el" href="chan__agent_8c-source.html#l01763">__login_exec()</a>, <a class="el" href="manager_8c-source.html#l02176">action_userevent()</a>, <a class="el" href="app__queue_8c-source.html#l02971">add_to_queue()</a>, <a class="el" href="chan__agent_8c-source.html#l01473">agent_logoff_maintenance()</a>, <a class="el" href="res__jabber_8c-source.html#l00448">aji_log_hook()</a>, <a class="el" href="channel_8c-source.html#l03335">ast_change_name()</a>, <a class="el" href="channel_8c-source.html#l00632">ast_channel_alloc()</a>, <a class="el" href="channel_8c-source.html#l03953">ast_channel_bridge()</a>, <a class="el" href="channel_8c-source.html#l03406">ast_do_masquerade()</a>, <a class="el" href="channel_8c-source.html#l01598">ast_hangup()</a>, <a class="el" href="res__features_8c-source.html#l00342">ast_park_call()</a>, <a class="el" href="channel_8c-source.html#l03694">ast_set_callerid()</a>, <a class="el" href="channel_8c-source.html#l03728">ast_setstate()</a>, <a class="el" href="res__features_8c-source.html#l02716">bridge_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l01211">conf_free()</a>, <a class="el" href="app__meetme_8c-source.html#l01350">conf_run()</a>, <a class="el" href="chan__sip_8c-source.html#l08271">expire_register()</a>, <a class="el" href="manager_8c-source.html#l01850">fast_originate()</a>, <a class="el" href="chan__zap_8c-source.html#l06934">handle_init_event()</a>, <a class="el" href="chan__sip_8c-source.html#l12569">handle_response_invite()</a>, <a class="el" href="chan__sip_8c-source.html#l13071">handle_response_peerpoke()</a>, <a class="el" href="chan__sip_8c-source.html#l12931">handle_response_register()</a>, <a class="el" href="app__queue_8c-source.html#l00541">handle_statechange()</a>, <a class="el" href="chan__iax2_8c-source.html#l05519">iax2_ack_registry()</a>, <a class="el" href="chan__iax2_8c-source.html#l00903">iax2_ami_channelupdate()</a>, <a class="el" href="app__queue_8c-source.html#l01240">join_queue()</a>, <a class="el" href="app__queue_8c-source.html#l01477">leave_queue()</a>, <a class="el" href="logger_8c-source.html#l00645">logger_print_normal()</a>, <a class="el" href="cdr__manager_8c-source.html#l00086">manager_log()</a>, <a class="el" href="pbx_8c-source.html#l03690">manager_show_dialplan()</a>, <a class="el" href="manager_8c-source.html#l02654">manager_state_cb()</a>, <a class="el" href="app__minivm_8c-source.html#l01427">notify_new_message()</a>, <a class="el" href="chan__sip_8c-source.html#l08437">parse_register_contact()</a>, <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>, <a class="el" href="res__features_8c-source.html#l01746">post_manager_event()</a>, <a class="el" href="chan__sip_8c-source.html#l05180">process_sdp()</a>, <a class="el" href="asterisk_8c-source.html#l01201">quit_handler()</a>, <a class="el" href="pbx__realtime_8c-source.html#l00174">realtime_exec()</a>, <a class="el" href="app__queue_8c-source.html#l01914">record_abandoned()</a>, <a class="el" href="chan__sip_8c-source.html#l08956">register_verify()</a>, <a class="el" href="chan__sip_8c-source.html#l17179">reload_config()</a>, <a class="el" href="logger_8c-source.html#l00397">reload_logger()</a>, <a class="el" href="manager_8c-source.html#l03442">reload_manager()</a>, <a class="el" href="app__queue_8c-source.html#l02917">remove_from_queue()</a>, <a class="el" href="app__queue_8c-source.html#l01660">ring_entry()</a>, <a class="el" href="app__queue_8c-source.html#l02385">send_agent_complete()</a>, <a class="el" href="channel_8c-source.html#l02047">send_dtmf_event()</a>, <a class="el" href="app__dial_8c-source.html#l00415">senddialendevent()</a>, <a class="el" href="app__dial_8c-source.html#l00400">senddialevent()</a>, <a class="el" href="app__queue_8c-source.html#l03022">set_member_paused()</a>, <a class="el" href="chan__sip_8c-source.html#l04179">sip_new()</a>, <a class="el" href="chan__sip_8c-source.html#l16137">sip_poke_noanswer()</a>, <a class="el" href="chan__sip_8c-source.html#l07839">sip_reg_timeout()</a>, <a class="el" href="chan__sip_8c-source.html#l16326">sip_request_call()</a>, <a class="el" href="chan__iax2_8c-source.html#l06624">socket_process()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>, <a class="el" href="chan__iax2_8c-source.html#l05757">update_registry()</a>, <a class="el" href="app__queue_8c-source.html#l01535">update_status()</a>, <a class="el" href="app__userevent_8c-source.html#l00058">userevent_exec()</a>, <a class="el" href="app__voicemail_8c-source.html#l06398">vm_execmain()</a>, and <a class="el" href="chan__zap_8c-source.html#l03942">zt_handle_event()</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="c4993551c9eef6913ec2fb6f1f9bcd7c"></a><!-- doxytag: member="manager.h::manager_hook_t" ref="c4993551c9eef6913ec2fb6f1f9bcd7c" args=")(int, const char *, char *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">typedef int(* <a class="el" href="manager_8h.html#c4993551c9eef6913ec2fb6f1f9bcd7c">manager_hook_t</a>)(int, const char *, char *)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00065">65</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="c977be6baedefea7283a393e49325620"></a><!-- doxytag: member="manager.h::__attribute__" ref="c977be6baedefea7283a393e49325620" args="((format(printf, 2, 3))) astman_append(struct mansession *s" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void <a class="el" href="struct____attribute____.html">__attribute__</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">(<a class="el" href="cdr__custom_8c.html#b954976e6264c40232046aacb5b7c390">format</a>(printf, 2, 3))&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="704aac0387cab0355e8d7f2f26d3e791"></a><!-- doxytag: member="manager.h::__attribute__" ref="704aac0387cab0355e8d7f2f26d3e791" args="((format(printf, 6, 7))) __manager_event(int category" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="struct____attribute____.html">__attribute__</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">(<a class="el" href="cdr__custom_8c.html#b954976e6264c40232046aacb5b7c390">format</a>(printf, 6, 7))&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="cd5d8fb2d13b6780ba64c65a02485168"></a><!-- doxytag: member="manager.h::astman_verify_session_readpermissions" ref="cd5d8fb2d13b6780ba64c65a02485168" args="(unsigned long ident, int perm)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int astman_verify_session_readpermissions           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned long&nbsp;</td>
          <td class="mdname" nowrap> <em>ident</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>perm</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Verify a session's read permissions against a permission mask. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ident</em>&nbsp;</td><td>session identity </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>perm</em>&nbsp;</td><td>permission mask to verify </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>1 if the session has the permission mask capabilities, otherwise 0 </dd></dl>

<p>
Definition at line <a class="el" href="manager_8c-source.html#l02766">2766</a> of file <a class="el" href="manager_8c-source.html">manager.c</a>.
<p>
References <a class="el" href="manager_8c-source.html#l00141">mansession::__lock</a>, <a class="el" href="linkedlists_8h-source.html#l00038">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00104">AST_LIST_UNLOCK</a>, <a class="el" href="lock_8h-source.html#l00530">ast_mutex_lock()</a>, <a class="el" href="lock_8h-source.html#l00520">ast_mutex_unlock()</a>, <a class="el" href="manager_8c-source.html#l00149">mansession::managerid</a>, <a class="el" href="manager_8c-source.html#l00154">mansession::readperm</a>, <a class="el" href="cdr__pgsql_8c-source.html#l00071">result</a>, and <a class="el" href="aesopt_8h-source.html#l00399">s</a>.<div class="fragment"><pre class="fragment"><a name="l02767"></a>02767 {
<a name="l02768"></a>02768    <span class="keywordtype">int</span> <a class="code" href="cdr__pgsql_8c.html#b4a88417b3d0170d754c647c30b7216a">result</a> = 0;
<a name="l02769"></a>02769    <span class="keyword">struct </span><a class="code" href="structmansession.html">mansession</a> *<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>;
<a name="l02770"></a>02770 
<a name="l02771"></a>02771    <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;<a class="code" href="chan__skinny_8c.html#161bca2e917335e125291a00fd76a80f">sessions</a>);
<a name="l02772"></a>02772    <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;<a class="code" href="chan__skinny_8c.html#161bca2e917335e125291a00fd76a80f">sessions</a>, s, list) {
<a name="l02773"></a>02773       <a class="code" href="lock_8h.html#b3c5e3093b325167f88db93c8b4b2421">ast_mutex_lock</a>(&amp;s-&gt;<a class="code" href="structmansession.html#48281fd13118453275d6e66c62994356">__lock</a>);
<a name="l02774"></a>02774       <span class="keywordflow">if</span> ((s-&gt;<a class="code" href="structmansession.html#5eb0038a1d93de54c255dc46dcd40c66">managerid</a> == ident) &amp;&amp; (s-&gt;<a class="code" href="structmansession.html#e12b8f9551a73d6196648b62754aa9e1">readperm</a> &amp; perm)) {
<a name="l02775"></a>02775          result = 1;
<a name="l02776"></a>02776          <a class="code" href="lock_8h.html#1d33e3caf152f0901c5ebdb69c2d4d26">ast_mutex_unlock</a>(&amp;s-&gt;<a class="code" href="structmansession.html#48281fd13118453275d6e66c62994356">__lock</a>);
<a name="l02777"></a>02777          <span class="keywordflow">break</span>;
<a name="l02778"></a>02778       }
<a name="l02779"></a>02779       <a class="code" href="lock_8h.html#1d33e3caf152f0901c5ebdb69c2d4d26">ast_mutex_unlock</a>(&amp;s-&gt;<a class="code" href="structmansession.html#48281fd13118453275d6e66c62994356">__lock</a>);
<a name="l02780"></a>02780    }
<a name="l02781"></a>02781    <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;<a class="code" href="chan__skinny_8c.html#161bca2e917335e125291a00fd76a80f">sessions</a>);
<a name="l02782"></a>02782    <span class="keywordflow">return</span> result;
<a name="l02783"></a>02783 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="26f962a7a7a8f0cfadc06b37b77863bc"></a><!-- doxytag: member="manager.h::astman_verify_session_writepermissions" ref="26f962a7a7a8f0cfadc06b37b77863bc" args="(unsigned long ident, int perm)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int astman_verify_session_writepermissions           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned long&nbsp;</td>
          <td class="mdname" nowrap> <em>ident</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>perm</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Verify a session's write permissions against a permission mask. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ident</em>&nbsp;</td><td>session identity </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>perm</em>&nbsp;</td><td>permission mask to verify </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>1 if the session has the permission mask capabilities, otherwise 0 </dd></dl>

<p>
Definition at line <a class="el" href="manager_8c-source.html#l02785">2785</a> of file <a class="el" href="manager_8c-source.html">manager.c</a>.
<p>
References <a class="el" href="manager_8c-source.html#l00141">mansession::__lock</a>, <a class="el" href="linkedlists_8h-source.html#l00038">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00104">AST_LIST_UNLOCK</a>, <a class="el" href="lock_8h-source.html#l00530">ast_mutex_lock()</a>, <a class="el" href="lock_8h-source.html#l00520">ast_mutex_unlock()</a>, <a class="el" href="manager_8c-source.html#l00149">mansession::managerid</a>, <a class="el" href="cdr__pgsql_8c-source.html#l00071">result</a>, <a class="el" href="aesopt_8h-source.html#l00399">s</a>, and <a class="el" href="manager_8c-source.html#l00155">mansession::writeperm</a>.
<p>
Referenced by <a class="el" href="http_8c-source.html#l00416">handle_post()</a>.<div class="fragment"><pre class="fragment"><a name="l02786"></a>02786 {
<a name="l02787"></a>02787    <span class="keywordtype">int</span> <a class="code" href="cdr__pgsql_8c.html#b4a88417b3d0170d754c647c30b7216a">result</a> = 0;
<a name="l02788"></a>02788    <span class="keyword">struct </span><a class="code" href="structmansession.html">mansession</a> *<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>;
<a name="l02789"></a>02789 
<a name="l02790"></a>02790    <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;<a class="code" href="chan__skinny_8c.html#161bca2e917335e125291a00fd76a80f">sessions</a>);
<a name="l02791"></a>02791    <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;<a class="code" href="chan__skinny_8c.html#161bca2e917335e125291a00fd76a80f">sessions</a>, s, list) {
<a name="l02792"></a>02792       <a class="code" href="lock_8h.html#b3c5e3093b325167f88db93c8b4b2421">ast_mutex_lock</a>(&amp;s-&gt;<a class="code" href="structmansession.html#48281fd13118453275d6e66c62994356">__lock</a>);
<a name="l02793"></a>02793       <span class="keywordflow">if</span> ((s-&gt;<a class="code" href="structmansession.html#5eb0038a1d93de54c255dc46dcd40c66">managerid</a> == ident) &amp;&amp; (s-&gt;<a class="code" href="structmansession.html#1cc72854e73b9b510a12e993d6479e86">writeperm</a> &amp; perm)) {
<a name="l02794"></a>02794          result = 1;
<a name="l02795"></a>02795          <a class="code" href="lock_8h.html#1d33e3caf152f0901c5ebdb69c2d4d26">ast_mutex_unlock</a>(&amp;s-&gt;<a class="code" href="structmansession.html#48281fd13118453275d6e66c62994356">__lock</a>);
<a name="l02796"></a>02796          <span class="keywordflow">break</span>;
<a name="l02797"></a>02797       }
<a name="l02798"></a>02798       <a class="code" href="lock_8h.html#1d33e3caf152f0901c5ebdb69c2d4d26">ast_mutex_unlock</a>(&amp;s-&gt;<a class="code" href="structmansession.html#48281fd13118453275d6e66c62994356">__lock</a>);
<a name="l02799"></a>02799    }
<a name="l02800"></a>02800    <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;<a class="code" href="chan__skinny_8c.html#161bca2e917335e125291a00fd76a80f">sessions</a>);
<a name="l02801"></a>02801    <span class="keywordflow">return</span> result;
<a name="l02802"></a>02802 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="eca71ad744885dbe24bb135cef1012cb"></a><!-- doxytag: member="manager.h::authority_to_str" ref="eca71ad744885dbe24bb135cef1012cb" args="(int authority, char *res, int reslen)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char* authority_to_str           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>authority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>res</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>reslen</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Convert authority code to string with serveral options. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="dbdb69247084ab84961d3083a842d809"></a><!-- doxytag: member="manager.h::get_perm" ref="dbdb69247084ab84961d3083a842d809" args="(char *instr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int get_perm           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>instr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="31a28c522e71a1df85feb1926f943821"></a><!-- doxytag: member="manager.h::init_manager" ref="31a28c522e71a1df85feb1926f943821" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void const char int init_manager           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Called by Asterisk initialization 
<p>
Definition at line <a class="el" href="manager_8c-source.html#l03215">3215</a> of file <a class="el" href="manager_8c-source.html">manager.c</a>.
<p>
References <a class="el" href="manager_8c-source.html#l01458">action_challenge()</a>, <a class="el" href="manager_8c-source.html#l01797">action_command()</a>, <a class="el" href="manager_8c-source.html#l02200">action_coresettings()</a>, <a class="el" href="manager_8c-source.html#l02244">action_corestatus()</a>, <a class="el" href="manager_8c-source.html#l01416">action_events()</a>, <a class="el" href="manager_8c-source.html#l02085">action_extensionstate()</a>, <a class="el" href="manager_8c-source.html#l01065">action_getconfig()</a>, <a class="el" href="manager_8c-source.html#l01114">action_getconfigjson()</a>, <a class="el" href="manager_8c-source.html#l01548">action_getvar()</a>, <a class="el" href="manager_8c-source.html#l01480">action_hangup()</a>, <a class="el" href="manager_8c-source.html#l01392">action_listcommands()</a>, <a class="el" href="manager_8c-source.html#l01440">action_login()</a>, <a class="el" href="manager_8c-source.html#l01434">action_logoff()</a>, <a class="el" href="manager_8c-source.html#l02054">action_mailboxcount()</a>, <a class="el" href="manager_8c-source.html#l02026">action_mailboxstatus()</a>, <a class="el" href="manager_8c-source.html#l01912">action_originate()</a>, <a class="el" href="manager_8c-source.html#l01053">action_ping()</a>, <a class="el" href="manager_8c-source.html#l01726">action_redirect()</a>, <a class="el" href="manager_8c-source.html#l01681">action_sendtext()</a>, <a class="el" href="manager_8c-source.html#l01506">action_setvar()</a>, <a class="el" href="manager_8c-source.html#l01587">action_status()</a>, <a class="el" href="manager_8c-source.html#l02116">action_timeout()</a>, <a class="el" href="manager_8c-source.html#l01251">action_updateconfig()</a>, <a class="el" href="manager_8c-source.html#l02176">action_userevent()</a>, <a class="el" href="manager_8c-source.html#l01291">action_waitevent()</a>, <a class="el" href="chan__skinny_8c-source.html#l00759">ahp</a>, <a class="el" href="manager_8c-source.html#l00114">allowmultiplelogin</a>, <a class="el" href="manager_8c-source.html#l02536">append_event()</a>, <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="config_8c-source.html#l00357">ast_category_browse()</a>, <a class="el" href="http_8h-source.html#l00067">AST_CERTFILE</a>, <a class="el" href="cli_8c-source.html#l01352">ast_cli_register_multiple()</a>, <a class="el" href="config_8c-source.html#l00555">ast_config_destroy()</a>, <a class="el" href="config_8c-source.html#l01278">ast_config_load()</a>, <a class="el" href="pbx_8c-source.html#l01964">ast_extension_state_add()</a>, <a class="el" href="utils_8c-source.html#l00182">ast_gethostbyname()</a>, <a class="el" href="http_8c-source.html#l00311">ast_http_uri_link()</a>, <a class="el" href="http_8c-source.html#l00340">ast_http_uri_unlink()</a>, <a class="el" href="linkedlists_8h-source.html#l00670">AST_LIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h-source.html#l00038">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00516">AST_LIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h-source.html#l00491">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h-source.html#l00554">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h-source.html#l00104">AST_LIST_UNLOCK</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="manager_8h-source.html#l00116">ast_manager_register</a>, <a class="el" href="manager_8c-source.html#l02694">ast_manager_register2()</a>, <a class="el" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>, <a class="el" href="utils_8c-source.html#l00724">ast_true()</a>, <a class="el" href="config_8c-source.html#l00222">ast_variable_browse()</a>, <a class="el" href="manager_8c-source.html#l00120">block_sockets</a>, <a class="el" href="http_8h-source.html#l00071">tls_config::certfile</a>, <a class="el" href="http_8h-source.html#l00072">tls_config::cipher</a>, <a class="el" href="manager_8h-source.html#l00049">DEFAULT_MANAGER_PORT</a>, <a class="el" href="manager_8c-source.html#l00178">ast_manager_user::deny</a>, <a class="el" href="manager_8c-source.html#l00182">ast_manager_user::displayconnects</a>, <a class="el" href="http_8h-source.html#l00070">tls_config::enabled</a>, <a class="el" href="manager_8h-source.html#l00052">EVENT_FLAG_CALL</a>, <a class="el" href="manager_8h-source.html#l00055">EVENT_FLAG_COMMAND</a>, <a class="el" href="manager_8h-source.html#l00058">EVENT_FLAG_CONFIG</a>, <a class="el" href="manager_8h-source.html#l00051">EVENT_FLAG_SYSTEM</a>, <a class="el" href="manager_8h-source.html#l00057">EVENT_FLAG_USER</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="manager_8c-source.html#l00445">get_manager_by_name_locked()</a>, <a class="el" href="chan__skinny_8c-source.html#l00760">hp</a>, <a class="el" href="manager_8c-source.html#l00116">httptimeout</a>, <a class="el" href="manager_8c-source.html#l00183">ast_manager_user::keep</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00106">LOG_NOTICE</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="manager_8c-source.html#l00123">manager_debug</a>, <a class="el" href="manager_8c-source.html#l00117">manager_enabled</a>, <a class="el" href="manager_8c-source.html#l02654">manager_state_cb()</a>, <a class="el" href="config_8h-source.html#l00039">ast_variable::name</a>, <a class="el" href="config_8h-source.html#l00046">ast_variable::next</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="manager_8c-source.html#l00179">ast_manager_user::permit</a>, <a class="el" href="manager_8c-source.html#l00180">ast_manager_user::read</a>, <a class="el" href="manager_8c-source.html#l00177">ast_manager_user::secret</a>, <a class="el" href="http_8c-source.html#l00987">server_start()</a>, <a class="el" href="http_8h-source.html#l00122">server_args::sin</a>, <a class="el" href="http_8c-source.html#l00948">ssl_setup()</a>, <a class="el" href="manager_8c-source.html#l00115">timestampevents</a>, <a class="el" href="http_8h-source.html#l00124">server_args::tls_cfg</a>, <a class="el" href="config_8h-source.html#l00040">ast_variable::value</a>, <a class="el" href="ast__expr2f_8c-source.html#l01417">var</a>, <a class="el" href="manager_8c-source.html#l00118">webmanager_enabled</a>, and <a class="el" href="manager_8c-source.html#l00181">ast_manager_user::write</a>.
<p>
Referenced by <a class="el" href="asterisk_8c-source.html#l02570">main()</a>, and <a class="el" href="manager_8c-source.html#l03442">reload_manager()</a>.<div class="fragment"><pre class="fragment"><a name="l03216"></a>03216 {
<a name="l03217"></a>03217    <span class="keyword">struct </span><a class="code" href="structast__config.html">ast_config</a> *cfg = NULL;
<a name="l03218"></a>03218    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structval.html">val</a>;
<a name="l03219"></a>03219    <span class="keywordtype">char</span> *cat = NULL;
<a name="l03220"></a>03220    <span class="keywordtype">int</span> newhttptimeout = 60;
<a name="l03221"></a>03221    <span class="keywordtype">int</span> have_sslbindaddr = 0;
<a name="l03222"></a>03222    <span class="keyword">struct </span>hostent *<a class="code" href="chan__skinny_8c.html#d2ccda10db94c2b5d51beed10484c025">hp</a>;
<a name="l03223"></a>03223    <span class="keyword">struct </span><a class="code" href="structast__hostent.html">ast_hostent</a> ahp;
<a name="l03224"></a>03224    <span class="keyword">struct </span><a class="code" href="structast__manager__user.html">ast_manager_user</a> *user = NULL;
<a name="l03225"></a>03225    <span class="keyword">struct </span><a class="code" href="structast__variable.html">ast_variable</a> *<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>;
<a name="l03226"></a>03226 
<a name="l03227"></a>03227    <span class="keywordflow">if</span> (!<a class="code" href="manager_8c.html#a2b8ed9c305b8ea86116b603cca78a97">registered</a>) {
<a name="l03228"></a>03228       <span class="comment">/* Register default actions */</span>
<a name="l03229"></a>03229       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"Ping"</span>, 0, <a class="code" href="group__Group__AMI.html#gbd5ac0feea5a76122c4bb7950f72dba9">action_ping</a>, <span class="stringliteral">"Keepalive command"</span>, <a class="code" href="group__Group__AMI.html#gd19fc2f4e2bf2f2b6e916f370a345957">mandescr_ping</a>);
<a name="l03230"></a>03230       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"Events"</span>, 0, <a class="code" href="group__Group__AMI.html#g77d280f8038dfa2bb4b1ea13569c07df">action_events</a>, <span class="stringliteral">"Control Event Flow"</span>, <a class="code" href="group__Group__AMI.html#gadfa58476f08d0f14e4209140d4ddf57">mandescr_events</a>);
<a name="l03231"></a>03231       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"Logoff"</span>, 0, <a class="code" href="group__Group__AMI.html#g655a6b9be76687e4d0887bffacd41b3d">action_logoff</a>, <span class="stringliteral">"Logoff Manager"</span>, <a class="code" href="group__Group__AMI.html#g4eb25b527bf76f2c94ee7f6a1727706c">mandescr_logoff</a>);
<a name="l03232"></a>03232       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"Login"</span>, 0, <a class="code" href="group__Group__AMI.html#gbd3f1f5c2f6fa1c0db6646c765751566">action_login</a>, <span class="stringliteral">"Login Manager"</span>, NULL);
<a name="l03233"></a>03233       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"Challenge"</span>, 0, <a class="code" href="group__Group__AMI.html#g9ba77c553c77f8cd95e812fc9a3cbf38">action_challenge</a>, <span class="stringliteral">"Generate Challenge for MD5 Auth"</span>, NULL);
<a name="l03234"></a>03234       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"Hangup"</span>, <a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <a class="code" href="group__Group__AMI.html#gcee30e0477fbe6f85ac98e124a25289d">action_hangup</a>, <span class="stringliteral">"Hangup Channel"</span>, <a class="code" href="group__Group__AMI.html#gcd3c210737ab7a7dea258825b16345a4">mandescr_hangup</a>);
<a name="l03235"></a>03235       <a class="code" href="manager_8h.html#e4738d78136f7a3a390d7729872d206e">ast_manager_register</a>(<span class="stringliteral">"Status"</span>, <a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <a class="code" href="group__Group__AMI.html#g6a023aadcdeed0f3c8db7756f06a85fe">action_status</a>, <span class="stringliteral">"Lists channel status"</span> );
<a name="l03236"></a>03236       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"Setvar"</span>, <a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <a class="code" href="group__Group__AMI.html#gff61c40432e7043889c37096ac0560c7">action_setvar</a>, <span class="stringliteral">"Set Channel Variable"</span>, <a class="code" href="group__Group__AMI.html#g011be8a601adfe631d2040fd2b3e347d">mandescr_setvar</a> );
<a name="l03237"></a>03237       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"Getvar"</span>, <a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <a class="code" href="group__Group__AMI.html#gdb0963bfde8071d731420ac8def41f9e">action_getvar</a>, <span class="stringliteral">"Gets a Channel Variable"</span>, <a class="code" href="group__Group__AMI.html#g7e44f6255d335a2c07e5a08424d9ab47">mandescr_getvar</a> );
<a name="l03238"></a>03238       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"GetConfig"</span>, <a class="code" href="manager_8h.html#31c33938947056ad055258c5c585812c">EVENT_FLAG_CONFIG</a>, <a class="code" href="group__Group__AMI.html#geeb75cf41619f536caffbbef71e3f730">action_getconfig</a>, <span class="stringliteral">"Retrieve configuration"</span>, <a class="code" href="group__Group__AMI.html#g47ba7bebfd930c7ba1797e460b0c261b">mandescr_getconfig</a>);
<a name="l03239"></a>03239       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"GetConfigJSON"</span>, <a class="code" href="manager_8h.html#31c33938947056ad055258c5c585812c">EVENT_FLAG_CONFIG</a>, <a class="code" href="group__Group__AMI.html#g51d0d48508ddb1374a9b28d95b5702d6">action_getconfigjson</a>, <span class="stringliteral">"Retrieve configuration (JSON format)"</span>, <a class="code" href="group__Group__AMI.html#gd3137ad18fefbbb17e1e3848b7423d16">mandescr_getconfigjson</a>);
<a name="l03240"></a>03240       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"UpdateConfig"</span>, <a class="code" href="manager_8h.html#31c33938947056ad055258c5c585812c">EVENT_FLAG_CONFIG</a>, <a class="code" href="group__Group__AMI.html#g2543b90f06c6700af2c68d854b6b4558">action_updateconfig</a>, <span class="stringliteral">"Update basic configuration"</span>, <a class="code" href="group__Group__AMI.html#gb327aa5c1fa62b6a6ea1eff221976639">mandescr_updateconfig</a>);
<a name="l03241"></a>03241       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"Redirect"</span>, <a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <a class="code" href="group__Group__AMI.html#g0076609fb6806996b6584b7a37870927">action_redirect</a>, <span class="stringliteral">"Redirect (transfer) a call"</span>, <a class="code" href="group__Group__AMI.html#gac91809519e0b430f42ce4cfdf5c5a2a">mandescr_redirect</a> );
<a name="l03242"></a>03242       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"Originate"</span>, <a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <a class="code" href="group__Group__AMI.html#gd8bc04cda5ffb147cb7c5542d3f8c1ea">action_originate</a>, <span class="stringliteral">"Originate Call"</span>, <a class="code" href="group__Group__AMI.html#gb8d0d86508e429319171f702da06978f">mandescr_originate</a>);
<a name="l03243"></a>03243       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"Command"</span>, <a class="code" href="manager_8h.html#055847dde76185d8491133f37610d68d">EVENT_FLAG_COMMAND</a>, <a class="code" href="group__Group__AMI.html#g6c71a4a16dd2e3115f1235a25a8fdb70">action_command</a>, <span class="stringliteral">"Execute Asterisk CLI Command"</span>, <a class="code" href="group__Group__AMI.html#g7ef45bd71ec09dcb2c7e6b8d6e48e57f">mandescr_command</a> );
<a name="l03244"></a>03244       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"ExtensionState"</span>, <a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <a class="code" href="group__Group__AMI.html#g58e43ceaccf852d6a41133bc5cfadc13">action_extensionstate</a>, <span class="stringliteral">"Check Extension Status"</span>, <a class="code" href="group__Group__AMI.html#gc23a0e40c449c0ff093ebb890078ccd7">mandescr_extensionstate</a> );
<a name="l03245"></a>03245       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"AbsoluteTimeout"</span>, <a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <a class="code" href="group__Group__AMI.html#ga8bc516739f567719fd6e75177f08f27">action_timeout</a>, <span class="stringliteral">"Set Absolute Timeout"</span>, <a class="code" href="group__Group__AMI.html#gd5b2a1a9f5c7c824e21d0345f08ad0d4">mandescr_timeout</a> );
<a name="l03246"></a>03246       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"MailboxStatus"</span>, <a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <a class="code" href="group__Group__AMI.html#g44d5b6b832d95db5bfb983d39e56ee21">action_mailboxstatus</a>, <span class="stringliteral">"Check Mailbox"</span>, <a class="code" href="group__Group__AMI.html#gfbeefe3f5b56dfe8f2379f93f8699b13">mandescr_mailboxstatus</a> );
<a name="l03247"></a>03247       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"MailboxCount"</span>, <a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <a class="code" href="group__Group__AMI.html#g86017430079df84ea69c923aa234bdcd">action_mailboxcount</a>, <span class="stringliteral">"Check Mailbox Message Count"</span>, <a class="code" href="group__Group__AMI.html#g4c3b52b7ac90a43027758d2aaf218202">mandescr_mailboxcount</a> );
<a name="l03248"></a>03248       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"ListCommands"</span>, 0, <a class="code" href="group__Group__AMI.html#gc47a6ddacfc4e36cfb9ab30e2baf7de0">action_listcommands</a>, <span class="stringliteral">"List available manager commands"</span>, <a class="code" href="group__Group__AMI.html#g8ff25cb8fe76a131a2401ce3e51ee07e">mandescr_listcommands</a>);
<a name="l03249"></a>03249       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"SendText"</span>, <a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <a class="code" href="group__Group__AMI.html#g250e20c09ed384cd90623cfd01f8b551">action_sendtext</a>, <span class="stringliteral">"Send text message to channel"</span>, <a class="code" href="group__Group__AMI.html#g718ec14078a25254e40cb5ea875d4955">mandescr_sendtext</a>);
<a name="l03250"></a>03250       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"UserEvent"</span>, <a class="code" href="manager_8h.html#87a2ec651ddd1db88b41715162d7a242">EVENT_FLAG_USER</a>, <a class="code" href="group__Group__AMI.html#g81297609484dc4a21d32483e91c8b11d">action_userevent</a>, <span class="stringliteral">"Send an arbitrary event"</span>, <a class="code" href="group__Group__AMI.html#g6c5c4b2a4fc6e25aac2fbc21cbbe12e4">mandescr_userevent</a>);
<a name="l03251"></a>03251       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"WaitEvent"</span>, 0, <a class="code" href="group__Group__AMI.html#g8c03c9dc4ab8279645aa28d8ec5d7290">action_waitevent</a>, <span class="stringliteral">"Wait for an event to occur"</span>, <a class="code" href="group__Group__AMI.html#g5ac7170aaf87a7b17bc4b85f93facd3a">mandescr_waitevent</a>);
<a name="l03252"></a>03252       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"CoreSettings"</span>, <a class="code" href="manager_8h.html#440ebd9d80179402b9cd76c426adb8d2">EVENT_FLAG_SYSTEM</a>, <a class="code" href="group__Group__AMI.html#g4572bba9501a379251e6d7712a077035">action_coresettings</a>, <span class="stringliteral">"Show PBX core settings (version etc)"</span>, <a class="code" href="group__Group__AMI.html#ge402cc29f5a0d8a9001d5071152b1281">mandescr_coresettings</a>);
<a name="l03253"></a>03253       <a class="code" href="group__Group__AMI.html#g84a70f66019d4cf74b8e203011d22431">ast_manager_register2</a>(<span class="stringliteral">"CoreStatus"</span>, <a class="code" href="manager_8h.html#440ebd9d80179402b9cd76c426adb8d2">EVENT_FLAG_SYSTEM</a>, <a class="code" href="group__Group__AMI.html#g48f94483856e54f9d016fd4e00963a5c">action_corestatus</a>, <span class="stringliteral">"Show PBX core status variables"</span>, <a class="code" href="group__Group__AMI.html#g54e903fbbc11dec18a6971c0b9f89df1">mandescr_corestatus</a>);
<a name="l03254"></a>03254 
<a name="l03255"></a>03255       <a class="code" href="cli_8c.html#a334dfd903e83eea3729ff37aa372781">ast_cli_register_multiple</a>(<a class="code" href="group__Group__AMI.html#gc63528124b8cf02a55bec42906b204ca">cli_manager</a>, <span class="keyword">sizeof</span>(<a class="code" href="group__Group__AMI.html#gc63528124b8cf02a55bec42906b204ca">cli_manager</a>) / <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structast__cli__entry.html">ast_cli_entry</a>));
<a name="l03256"></a>03256       <a class="code" href="pbx_8c.html#14f63100164300fc4b55b09d6c3474fd">ast_extension_state_add</a>(NULL, NULL, <a class="code" href="group__Group__AMI.html#gff6bb88658011308f835d9278cf7f4b5">manager_state_cb</a>, NULL);
<a name="l03257"></a>03257       <a class="code" href="manager_8c.html#a2b8ed9c305b8ea86116b603cca78a97">registered</a> = 1;
<a name="l03258"></a>03258       <span class="comment">/* Append placeholder event so master_eventq never runs dry */</span>
<a name="l03259"></a>03259       <a class="code" href="group__Group__AMI.html#g38726448f966fa5ad7aaa3141ba16235">append_event</a>(<span class="stringliteral">"Event: Placeholder\r\n\r\n"</span>, 0);
<a name="l03260"></a>03260    }
<a name="l03261"></a>03261    <a class="code" href="group__Group__AMI.html#ga3b408e54a36d8024f4861b84f8648fb">displayconnects</a> = 1;
<a name="l03262"></a>03262    cfg = <a class="code" href="config_8c.html#0ea8bde5422fa0db50302e0f710e18c1">ast_config_load</a>(<span class="stringliteral">"manager.conf"</span>);
<a name="l03263"></a>03263    <span class="keywordflow">if</span> (!cfg) {
<a name="l03264"></a>03264       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#bbf95aad74d847cd4bcb129604f798cd">LOG_NOTICE</a>, <span class="stringliteral">"Unable to open management configuration manager.conf.  Call management disabled.\n"</span>);
<a name="l03265"></a>03265       <span class="keywordflow">return</span> 0;
<a name="l03266"></a>03266    }
<a name="l03267"></a>03267 
<a name="l03268"></a>03268    <span class="comment">/* default values */</span>
<a name="l03269"></a>03269    memset(&amp;<a class="code" href="manager_8c.html#300cdb1a12b392413a97b68c6e659d08">ami_desc</a>.<a class="code" href="structserver__args.html#7d27e4a7ca7533a3bef4fad10a0c19c7">sin</a>, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sockaddr_in));
<a name="l03270"></a>03270    memset(&amp;<a class="code" href="manager_8c.html#d60178c503bef15cc7591c2c82a11fe7">amis_desc</a>.<a class="code" href="structserver__args.html#7d27e4a7ca7533a3bef4fad10a0c19c7">sin</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="manager_8c.html#d60178c503bef15cc7591c2c82a11fe7">amis_desc</a>.<a class="code" href="structserver__args.html#7d27e4a7ca7533a3bef4fad10a0c19c7">sin</a>));
<a name="l03271"></a>03271    <a class="code" href="manager_8c.html#d60178c503bef15cc7591c2c82a11fe7">amis_desc</a>.<a class="code" href="structserver__args.html#7d27e4a7ca7533a3bef4fad10a0c19c7">sin</a>.sin_port = htons(5039);
<a name="l03272"></a>03272    <a class="code" href="manager_8c.html#300cdb1a12b392413a97b68c6e659d08">ami_desc</a>.<a class="code" href="structserver__args.html#7d27e4a7ca7533a3bef4fad10a0c19c7">sin</a>.sin_port = htons(<a class="code" href="manager_8h.html#46c656f1ee5c96c2595d976973a96b7d">DEFAULT_MANAGER_PORT</a>);
<a name="l03273"></a>03273 
<a name="l03274"></a>03274    <a class="code" href="manager_8c.html#1d13b7f019c0c316c9b46d22c8dbd337">ami_tls_cfg</a>.<a class="code" href="structtls__config.html#a10311459433adf322f2590a4987c423">enabled</a> = 0;
<a name="l03275"></a>03275    <span class="keywordflow">if</span> (<a class="code" href="manager_8c.html#1d13b7f019c0c316c9b46d22c8dbd337">ami_tls_cfg</a>.<a class="code" href="structtls__config.html#b239093132d939820c54744c1ca8bb55">certfile</a>)
<a name="l03276"></a>03276       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(<a class="code" href="manager_8c.html#1d13b7f019c0c316c9b46d22c8dbd337">ami_tls_cfg</a>.<a class="code" href="structtls__config.html#b239093132d939820c54744c1ca8bb55">certfile</a>);
<a name="l03277"></a>03277    <a class="code" href="manager_8c.html#1d13b7f019c0c316c9b46d22c8dbd337">ami_tls_cfg</a>.<a class="code" href="structtls__config.html#b239093132d939820c54744c1ca8bb55">certfile</a> = <a class="code" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>(<a class="code" href="http_8h.html#681deafbde5165912b512a6dfc3a4cbc">AST_CERTFILE</a>);
<a name="l03278"></a>03278    <span class="keywordflow">if</span> (<a class="code" href="manager_8c.html#1d13b7f019c0c316c9b46d22c8dbd337">ami_tls_cfg</a>.<a class="code" href="structtls__config.html#08406a6e18bdf83010ddd1187251454d">cipher</a>)
<a name="l03279"></a>03279       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(<a class="code" href="manager_8c.html#1d13b7f019c0c316c9b46d22c8dbd337">ami_tls_cfg</a>.<a class="code" href="structtls__config.html#08406a6e18bdf83010ddd1187251454d">cipher</a>);
<a name="l03280"></a>03280    <a class="code" href="manager_8c.html#1d13b7f019c0c316c9b46d22c8dbd337">ami_tls_cfg</a>.<a class="code" href="structtls__config.html#08406a6e18bdf83010ddd1187251454d">cipher</a> = <a class="code" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>(<span class="stringliteral">""</span>);
<a name="l03281"></a>03281 
<a name="l03282"></a>03282    <span class="keywordflow">for</span> (var = <a class="code" href="config_8c.html#65ed813ca973e0e5dd3426804249db4f">ast_variable_browse</a>(cfg, <span class="stringliteral">"general"</span>); var; var = var-&gt;<a class="code" href="structast__variable.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l03283"></a>03283       val = var-&gt;<a class="code" href="structast__variable.html#2063c1608d6e0baf80249c42e2be5804">value</a>;
<a name="l03284"></a>03284       <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"ssenable"</span>))
<a name="l03285"></a>03285          <a class="code" href="manager_8c.html#1d13b7f019c0c316c9b46d22c8dbd337">ami_tls_cfg</a>.<a class="code" href="structtls__config.html#a10311459433adf322f2590a4987c423">enabled</a> = <a class="code" href="utils_8c.html#63bb02e4d6f18c1dbeca92dc63310685">ast_true</a>(val);
<a name="l03286"></a>03286       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"ssbindport"</span>))
<a name="l03287"></a>03287          <a class="code" href="manager_8c.html#d60178c503bef15cc7591c2c82a11fe7">amis_desc</a>.<a class="code" href="structserver__args.html#7d27e4a7ca7533a3bef4fad10a0c19c7">sin</a>.sin_port = htons(atoi(val));
<a name="l03288"></a>03288       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"ssbindaddr"</span>)) {
<a name="l03289"></a>03289          <span class="keywordflow">if</span> ((hp = <a class="code" href="utils_8c.html#00f9ad2be8cda9c885557d03568816ec">ast_gethostbyname</a>(val, &amp;ahp))) {
<a name="l03290"></a>03290             memcpy(&amp;<a class="code" href="manager_8c.html#d60178c503bef15cc7591c2c82a11fe7">amis_desc</a>.<a class="code" href="structserver__args.html#7d27e4a7ca7533a3bef4fad10a0c19c7">sin</a>.sin_addr, hp-&gt;h_addr, <span class="keyword">sizeof</span>(<a class="code" href="manager_8c.html#d60178c503bef15cc7591c2c82a11fe7">amis_desc</a>.<a class="code" href="structserver__args.html#7d27e4a7ca7533a3bef4fad10a0c19c7">sin</a>.sin_addr));
<a name="l03291"></a>03291             have_sslbindaddr = 1;
<a name="l03292"></a>03292          } <span class="keywordflow">else</span> {
<a name="l03293"></a>03293             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Invalid bind address '%s'\n"</span>, val);
<a name="l03294"></a>03294          }
<a name="l03295"></a>03295       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"sslcert"</span>)) {
<a name="l03296"></a>03296          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(<a class="code" href="manager_8c.html#1d13b7f019c0c316c9b46d22c8dbd337">ami_tls_cfg</a>.<a class="code" href="structtls__config.html#b239093132d939820c54744c1ca8bb55">certfile</a>);
<a name="l03297"></a>03297          <a class="code" href="manager_8c.html#1d13b7f019c0c316c9b46d22c8dbd337">ami_tls_cfg</a>.<a class="code" href="structtls__config.html#b239093132d939820c54744c1ca8bb55">certfile</a> = <a class="code" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>(val);
<a name="l03298"></a>03298       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"sslcipher"</span>)) {
<a name="l03299"></a>03299          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(<a class="code" href="manager_8c.html#1d13b7f019c0c316c9b46d22c8dbd337">ami_tls_cfg</a>.<a class="code" href="structtls__config.html#08406a6e18bdf83010ddd1187251454d">cipher</a>);
<a name="l03300"></a>03300          <a class="code" href="manager_8c.html#1d13b7f019c0c316c9b46d22c8dbd337">ami_tls_cfg</a>.<a class="code" href="structtls__config.html#08406a6e18bdf83010ddd1187251454d">cipher</a> = <a class="code" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>(val);
<a name="l03301"></a>03301       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"enabled"</span>)) {
<a name="l03302"></a>03302          <a class="code" href="group__Group__AMI.html#g7fa4f9f44eb840da897cd6df25e71ea4">manager_enabled</a> = <a class="code" href="utils_8c.html#63bb02e4d6f18c1dbeca92dc63310685">ast_true</a>(val);
<a name="l03303"></a>03303       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"block-sockets"</span>)) {
<a name="l03304"></a>03304          <a class="code" href="group__Group__AMI.html#g58780e565b16019054545fbf6ba26a24">block_sockets</a> = <a class="code" href="utils_8c.html#63bb02e4d6f18c1dbeca92dc63310685">ast_true</a>(val);
<a name="l03305"></a>03305       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"webenabled"</span>)) {
<a name="l03306"></a>03306          <a class="code" href="group__Group__AMI.html#ge48c16ca333fc1529958ca58131fd875">webmanager_enabled</a> = <a class="code" href="utils_8c.html#63bb02e4d6f18c1dbeca92dc63310685">ast_true</a>(val);
<a name="l03307"></a>03307       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"port"</span>)) {
<a name="l03308"></a>03308          <a class="code" href="manager_8c.html#300cdb1a12b392413a97b68c6e659d08">ami_desc</a>.<a class="code" href="structserver__args.html#7d27e4a7ca7533a3bef4fad10a0c19c7">sin</a>.sin_port = htons(atoi(val));
<a name="l03309"></a>03309       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"bindaddr"</span>)) {
<a name="l03310"></a>03310          <span class="keywordflow">if</span> (!inet_aton(val, &amp;<a class="code" href="manager_8c.html#300cdb1a12b392413a97b68c6e659d08">ami_desc</a>.<a class="code" href="structserver__args.html#7d27e4a7ca7533a3bef4fad10a0c19c7">sin</a>.sin_addr)) {
<a name="l03311"></a>03311             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Invalid address '%s' specified, using 0.0.0.0\n"</span>, val);
<a name="l03312"></a>03312             memset(&amp;<a class="code" href="manager_8c.html#300cdb1a12b392413a97b68c6e659d08">ami_desc</a>.<a class="code" href="structserver__args.html#7d27e4a7ca7533a3bef4fad10a0c19c7">sin</a>.sin_addr, 0, <span class="keyword">sizeof</span>(<a class="code" href="manager_8c.html#300cdb1a12b392413a97b68c6e659d08">ami_desc</a>.<a class="code" href="structserver__args.html#7d27e4a7ca7533a3bef4fad10a0c19c7">sin</a>.sin_addr));
<a name="l03313"></a>03313          }
<a name="l03314"></a>03314       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"allowmultiplelogin"</span>)) { 
<a name="l03315"></a>03315          <a class="code" href="group__Group__AMI.html#g96f294e808841cbd886011c9d0192687">allowmultiplelogin</a> = <a class="code" href="utils_8c.html#63bb02e4d6f18c1dbeca92dc63310685">ast_true</a>(val);
<a name="l03316"></a>03316       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"displayconnects"</span>)) {
<a name="l03317"></a>03317          <a class="code" href="group__Group__AMI.html#ga3b408e54a36d8024f4861b84f8648fb">displayconnects</a> = <a class="code" href="utils_8c.html#63bb02e4d6f18c1dbeca92dc63310685">ast_true</a>(val);
<a name="l03318"></a>03318       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"timestampevents"</span>)) {
<a name="l03319"></a>03319          <a class="code" href="group__Group__AMI.html#g846e7158f3a1a166b993bbea7e34c1e0">timestampevents</a> = <a class="code" href="utils_8c.html#63bb02e4d6f18c1dbeca92dc63310685">ast_true</a>(val);
<a name="l03320"></a>03320       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"debug"</span>)) {
<a name="l03321"></a>03321          <a class="code" href="group__Group__AMI.html#g065d88d3234671acf0f5980f9228b827">manager_debug</a> = <a class="code" href="utils_8c.html#63bb02e4d6f18c1dbeca92dc63310685">ast_true</a>(val);
<a name="l03322"></a>03322       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"httptimeout"</span>)) {
<a name="l03323"></a>03323          newhttptimeout = atoi(val);
<a name="l03324"></a>03324       } <span class="keywordflow">else</span> {
<a name="l03325"></a>03325          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#bbf95aad74d847cd4bcb129604f798cd">LOG_NOTICE</a>, <span class="stringliteral">"Invalid keyword &lt;%s&gt; = &lt;%s&gt; in manager.conf [general]\n"</span>,
<a name="l03326"></a>03326             var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, val);
<a name="l03327"></a>03327       }  
<a name="l03328"></a>03328    }
<a name="l03329"></a>03329 
<a name="l03330"></a>03330    <span class="keywordflow">if</span> (<a class="code" href="group__Group__AMI.html#g7fa4f9f44eb840da897cd6df25e71ea4">manager_enabled</a>)
<a name="l03331"></a>03331       <a class="code" href="manager_8c.html#300cdb1a12b392413a97b68c6e659d08">ami_desc</a>.<a class="code" href="structserver__args.html#7d27e4a7ca7533a3bef4fad10a0c19c7">sin</a>.sin_family = AF_INET;
<a name="l03332"></a>03332    <span class="keywordflow">if</span> (!have_sslbindaddr)
<a name="l03333"></a>03333       <a class="code" href="manager_8c.html#d60178c503bef15cc7591c2c82a11fe7">amis_desc</a>.<a class="code" href="structserver__args.html#7d27e4a7ca7533a3bef4fad10a0c19c7">sin</a>.sin_addr = <a class="code" href="manager_8c.html#300cdb1a12b392413a97b68c6e659d08">ami_desc</a>.<a class="code" href="structserver__args.html#7d27e4a7ca7533a3bef4fad10a0c19c7">sin</a>.sin_addr;
<a name="l03334"></a>03334    <span class="keywordflow">if</span> (<a class="code" href="manager_8c.html#1d13b7f019c0c316c9b46d22c8dbd337">ami_tls_cfg</a>.<a class="code" href="structtls__config.html#a10311459433adf322f2590a4987c423">enabled</a>)
<a name="l03335"></a>03335       <a class="code" href="manager_8c.html#d60178c503bef15cc7591c2c82a11fe7">amis_desc</a>.<a class="code" href="structserver__args.html#7d27e4a7ca7533a3bef4fad10a0c19c7">sin</a>.sin_family = AF_INET;
<a name="l03336"></a>03336 
<a name="l03337"></a>03337    
<a name="l03338"></a>03338    <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;users);
<a name="l03339"></a>03339 
<a name="l03340"></a>03340    <span class="keywordflow">while</span> ((cat = <a class="code" href="config_8c.html#38fbac9adb1c1bf165ecce251cb206a8">ast_category_browse</a>(cfg, cat))) {
<a name="l03341"></a>03341 
<a name="l03342"></a>03342       <span class="keywordflow">if</span> (!strcasecmp(cat, <span class="stringliteral">"general"</span>))
<a name="l03343"></a>03343          <span class="keywordflow">continue</span>;
<a name="l03344"></a>03344 
<a name="l03345"></a>03345       <span class="comment">/* Look for an existing entry, if none found - create one and add it to the list */</span>
<a name="l03346"></a>03346       <span class="keywordflow">if</span> (!(user = <a class="code" href="group__Group__AMI.html#gcf9022296a6e52672bd7bf89e570c7e0">get_manager_by_name_locked</a>(cat))) {
<a name="l03347"></a>03347          <span class="keywordflow">if</span> (!(user = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*user))))
<a name="l03348"></a>03348             <span class="keywordflow">break</span>;
<a name="l03349"></a>03349          <span class="comment">/* Copy name over */</span>
<a name="l03350"></a>03350          ast_copy_string(user-&gt;username, cat, <span class="keyword">sizeof</span>(user-&gt;username));
<a name="l03351"></a>03351          <span class="comment">/* Insert into list */</span>
<a name="l03352"></a>03352          <a class="code" href="linkedlists_8h.html#8de6ce8a3b9d59e7e7fddee6b62b32a7">AST_LIST_INSERT_TAIL</a>(&amp;users, user, list);
<a name="l03353"></a>03353       }
<a name="l03354"></a>03354 
<a name="l03355"></a>03355       <span class="comment">/* Make sure we keep this user and don't destroy it during cleanup */</span>
<a name="l03356"></a>03356       user-&gt;<a class="code" href="structast__manager__user.html#18ccf61d533b600bbf5a963359223fe4">keep</a> = 1;
<a name="l03357"></a>03357 
<a name="l03358"></a>03358       var = <a class="code" href="config_8c.html#65ed813ca973e0e5dd3426804249db4f">ast_variable_browse</a>(cfg, cat);
<a name="l03359"></a>03359       <span class="keywordflow">while</span> (var) {
<a name="l03360"></a>03360          <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"secret"</span>)) {
<a name="l03361"></a>03361             <span class="keywordflow">if</span> (user-&gt;<a class="code" href="structast__manager__user.html#5ebe2294ecd0e0f08eab7690d2a6ee69">secret</a>)
<a name="l03362"></a>03362                <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(user-&gt;<a class="code" href="structast__manager__user.html#5ebe2294ecd0e0f08eab7690d2a6ee69">secret</a>);
<a name="l03363"></a>03363             user-&gt;<a class="code" href="structast__manager__user.html#5ebe2294ecd0e0f08eab7690d2a6ee69">secret</a> = <a class="code" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>(var-&gt;<a class="code" href="structast__variable.html#2063c1608d6e0baf80249c42e2be5804">value</a>);
<a name="l03364"></a>03364          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"deny"</span>) ) {
<a name="l03365"></a>03365             <span class="keywordflow">if</span> (user-&gt;<a class="code" href="structast__manager__user.html#05afb6ce69b9cef1bd6ece7e4745f96c">deny</a>)
<a name="l03366"></a>03366                <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(user-&gt;<a class="code" href="structast__manager__user.html#05afb6ce69b9cef1bd6ece7e4745f96c">deny</a>);
<a name="l03367"></a>03367             user-&gt;<a class="code" href="structast__manager__user.html#05afb6ce69b9cef1bd6ece7e4745f96c">deny</a> = <a class="code" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>(var-&gt;<a class="code" href="structast__variable.html#2063c1608d6e0baf80249c42e2be5804">value</a>);
<a name="l03368"></a>03368          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"permit"</span>) ) {
<a name="l03369"></a>03369             <span class="keywordflow">if</span> (user-&gt;<a class="code" href="structast__manager__user.html#0931be4cc434934e64b1894aa2dba1ae">permit</a>)
<a name="l03370"></a>03370                <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(user-&gt;<a class="code" href="structast__manager__user.html#0931be4cc434934e64b1894aa2dba1ae">permit</a>);
<a name="l03371"></a>03371             user-&gt;<a class="code" href="structast__manager__user.html#0931be4cc434934e64b1894aa2dba1ae">permit</a> = <a class="code" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>(var-&gt;<a class="code" href="structast__variable.html#2063c1608d6e0baf80249c42e2be5804">value</a>);
<a name="l03372"></a>03372          }  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"read"</span>) ) {
<a name="l03373"></a>03373             <span class="keywordflow">if</span> (user-&gt;<a class="code" href="structast__manager__user.html#ecae13117d6f0584c25a9da6c8f8415e">read</a>)
<a name="l03374"></a>03374                <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(user-&gt;<a class="code" href="structast__manager__user.html#ecae13117d6f0584c25a9da6c8f8415e">read</a>);
<a name="l03375"></a>03375             user-&gt;<a class="code" href="structast__manager__user.html#ecae13117d6f0584c25a9da6c8f8415e">read</a> = <a class="code" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>(var-&gt;<a class="code" href="structast__variable.html#2063c1608d6e0baf80249c42e2be5804">value</a>);
<a name="l03376"></a>03376          }  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"write"</span>) ) {
<a name="l03377"></a>03377             <span class="keywordflow">if</span> (user-&gt;<a class="code" href="structast__manager__user.html#efb2a684e4afb7d55e6147fbe5a332ee">write</a>)
<a name="l03378"></a>03378                <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(user-&gt;<a class="code" href="structast__manager__user.html#efb2a684e4afb7d55e6147fbe5a332ee">write</a>);
<a name="l03379"></a>03379             user-&gt;<a class="code" href="structast__manager__user.html#efb2a684e4afb7d55e6147fbe5a332ee">write</a> = <a class="code" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>(var-&gt;<a class="code" href="structast__variable.html#2063c1608d6e0baf80249c42e2be5804">value</a>);
<a name="l03380"></a>03380          }  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"displayconnects"</span>) )
<a name="l03381"></a>03381             user-&gt;<a class="code" href="structast__manager__user.html#a3b408e54a36d8024f4861b84f8648fb">displayconnects</a> = <a class="code" href="utils_8c.html#63bb02e4d6f18c1dbeca92dc63310685">ast_true</a>(var-&gt;<a class="code" href="structast__variable.html#2063c1608d6e0baf80249c42e2be5804">value</a>);
<a name="l03382"></a>03382          <span class="keywordflow">else</span> {
<a name="l03383"></a>03383             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l03384"></a>03384                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"%s is an unknown option.\n"</span>, var-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l03385"></a>03385          }
<a name="l03386"></a>03386          var = var-&gt;<a class="code" href="structast__variable.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l03387"></a>03387       }
<a name="l03388"></a>03388    }
<a name="l03389"></a>03389 
<a name="l03390"></a>03390    <span class="comment">/* Perform cleanup - essentially prune out old users that no longer exist */</span>
<a name="l03391"></a>03391    <a class="code" href="linkedlists_8h.html#915e438a9528c8d6316c617b5bd84487">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;users, user, list) {
<a name="l03392"></a>03392       <span class="keywordflow">if</span> (user-&gt;<a class="code" href="structast__manager__user.html#18ccf61d533b600bbf5a963359223fe4">keep</a>) { <span class="comment">/* valid record. clear flag for the next round */</span>
<a name="l03393"></a>03393          user-&gt;<a class="code" href="structast__manager__user.html#18ccf61d533b600bbf5a963359223fe4">keep</a> = 0;
<a name="l03394"></a>03394          <span class="keywordflow">continue</span>;
<a name="l03395"></a>03395       }
<a name="l03396"></a>03396       <span class="comment">/* We do not need to keep this user so take them out of the list */</span>
<a name="l03397"></a>03397       <a class="code" href="linkedlists_8h.html#37f99379dafa45c921f95bf7235eb91d">AST_LIST_REMOVE_CURRENT</a>(&amp;users, list);
<a name="l03398"></a>03398       <span class="comment">/* Free their memory now */</span>
<a name="l03399"></a>03399       <span class="keywordflow">if</span> (user-&gt;<a class="code" href="structast__manager__user.html#5ebe2294ecd0e0f08eab7690d2a6ee69">secret</a>)
<a name="l03400"></a>03400          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(user-&gt;<a class="code" href="structast__manager__user.html#5ebe2294ecd0e0f08eab7690d2a6ee69">secret</a>);
<a name="l03401"></a>03401       <span class="keywordflow">if</span> (user-&gt;<a class="code" href="structast__manager__user.html#05afb6ce69b9cef1bd6ece7e4745f96c">deny</a>)
<a name="l03402"></a>03402          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(user-&gt;<a class="code" href="structast__manager__user.html#05afb6ce69b9cef1bd6ece7e4745f96c">deny</a>);
<a name="l03403"></a>03403       <span class="keywordflow">if</span> (user-&gt;<a class="code" href="structast__manager__user.html#0931be4cc434934e64b1894aa2dba1ae">permit</a>)
<a name="l03404"></a>03404          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(user-&gt;<a class="code" href="structast__manager__user.html#0931be4cc434934e64b1894aa2dba1ae">permit</a>);
<a name="l03405"></a>03405       <span class="keywordflow">if</span> (user-&gt;<a class="code" href="structast__manager__user.html#ecae13117d6f0584c25a9da6c8f8415e">read</a>)
<a name="l03406"></a>03406          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(user-&gt;<a class="code" href="structast__manager__user.html#ecae13117d6f0584c25a9da6c8f8415e">read</a>);
<a name="l03407"></a>03407       <span class="keywordflow">if</span> (user-&gt;<a class="code" href="structast__manager__user.html#efb2a684e4afb7d55e6147fbe5a332ee">write</a>)
<a name="l03408"></a>03408          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(user-&gt;<a class="code" href="structast__manager__user.html#efb2a684e4afb7d55e6147fbe5a332ee">write</a>);
<a name="l03409"></a>03409       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(user);
<a name="l03410"></a>03410    }
<a name="l03411"></a>03411    <a class="code" href="linkedlists_8h.html#a93fdadc00a2a090968004b7d9c79630">AST_LIST_TRAVERSE_SAFE_END</a>
<a name="l03412"></a>03412 
<a name="l03413"></a>03413    <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;users);
<a name="l03414"></a>03414 
<a name="l03415"></a>03415    <a class="code" href="config_8c.html#ad84c9d29ca53758c2a113d057e221a0">ast_config_destroy</a>(cfg);
<a name="l03416"></a>03416 
<a name="l03417"></a>03417    <span class="keywordflow">if</span> (<a class="code" href="group__Group__AMI.html#ge48c16ca333fc1529958ca58131fd875">webmanager_enabled</a> &amp;&amp; <a class="code" href="group__Group__AMI.html#g7fa4f9f44eb840da897cd6df25e71ea4">manager_enabled</a>) {
<a name="l03418"></a>03418       <span class="keywordflow">if</span> (!<a class="code" href="manager_8c.html#9327cfe8492c3330bf4d51ded3e8d1a8">webregged</a>) {
<a name="l03419"></a>03419          <a class="code" href="http_8c.html#6842958ab454952c76e8111211b76e5a">ast_http_uri_link</a>(&amp;<a class="code" href="manager_8c.html#8318a86553fb0a8bdb35f3f61b21eed8">rawmanuri</a>);
<a name="l03420"></a>03420          <a class="code" href="http_8c.html#6842958ab454952c76e8111211b76e5a">ast_http_uri_link</a>(&amp;<a class="code" href="manager_8c.html#813ec6aec886e6bbb6ef9a1b455d78a8">manageruri</a>);
<a name="l03421"></a>03421          <a class="code" href="http_8c.html#6842958ab454952c76e8111211b76e5a">ast_http_uri_link</a>(&amp;<a class="code" href="manager_8c.html#7b55e3a11caef236115e71b9ea5a4304">managerxmluri</a>);
<a name="l03422"></a>03422          <a class="code" href="manager_8c.html#9327cfe8492c3330bf4d51ded3e8d1a8">webregged</a> = 1;
<a name="l03423"></a>03423       }
<a name="l03424"></a>03424    } <span class="keywordflow">else</span> {
<a name="l03425"></a>03425       <span class="keywordflow">if</span> (<a class="code" href="manager_8c.html#9327cfe8492c3330bf4d51ded3e8d1a8">webregged</a>) {
<a name="l03426"></a>03426          <a class="code" href="http_8c.html#8ea490df30f4610a42a214261b1f1e99">ast_http_uri_unlink</a>(&amp;<a class="code" href="manager_8c.html#8318a86553fb0a8bdb35f3f61b21eed8">rawmanuri</a>);
<a name="l03427"></a>03427          <a class="code" href="http_8c.html#8ea490df30f4610a42a214261b1f1e99">ast_http_uri_unlink</a>(&amp;<a class="code" href="manager_8c.html#813ec6aec886e6bbb6ef9a1b455d78a8">manageruri</a>);
<a name="l03428"></a>03428          <a class="code" href="http_8c.html#8ea490df30f4610a42a214261b1f1e99">ast_http_uri_unlink</a>(&amp;<a class="code" href="manager_8c.html#7b55e3a11caef236115e71b9ea5a4304">managerxmluri</a>);
<a name="l03429"></a>03429          <a class="code" href="manager_8c.html#9327cfe8492c3330bf4d51ded3e8d1a8">webregged</a> = 0;
<a name="l03430"></a>03430       }
<a name="l03431"></a>03431    }
<a name="l03432"></a>03432 
<a name="l03433"></a>03433    <span class="keywordflow">if</span> (newhttptimeout &gt; 0)
<a name="l03434"></a>03434       <a class="code" href="group__Group__AMI.html#gff966934ba065051f34a94a400e43b17">httptimeout</a> = newhttptimeout;
<a name="l03435"></a>03435 
<a name="l03436"></a>03436    <a class="code" href="http_8c.html#78825d347437f6b39162f2bb595118fb">server_start</a>(&amp;<a class="code" href="manager_8c.html#300cdb1a12b392413a97b68c6e659d08">ami_desc</a>);
<a name="l03437"></a>03437    <span class="keywordflow">if</span> (<a class="code" href="http_8c.html#099674f856134f6c71303eceb54558dd">ssl_setup</a>(<a class="code" href="manager_8c.html#d60178c503bef15cc7591c2c82a11fe7">amis_desc</a>.<a class="code" href="structserver__args.html#4043ce151e607087eae7215e08cc837d">tls_cfg</a>))
<a name="l03438"></a>03438       <a class="code" href="http_8c.html#78825d347437f6b39162f2bb595118fb">server_start</a>(&amp;<a class="code" href="manager_8c.html#d60178c503bef15cc7591c2c82a11fe7">amis_desc</a>);
<a name="l03439"></a>03439    <span class="keywordflow">return</span> 0;
<a name="l03440"></a>03440 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="5261ebdd008364aa84e6d7254982898e"></a><!-- doxytag: member="manager.h::reload_manager" ref="5261ebdd008364aa84e6d7254982898e" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int reload_manager           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8c-source.html#l03442">3442</a> of file <a class="el" href="manager_8c-source.html">manager.c</a>.
<p>
References <a class="el" href="manager_8h-source.html#l00051">EVENT_FLAG_SYSTEM</a>, <a class="el" href="manager_8c-source.html#l03215">init_manager()</a>, and <a class="el" href="manager_8h-source.html#l00163">manager_event</a>.<div class="fragment"><pre class="fragment"><a name="l03443"></a>03443 {
<a name="l03444"></a>03444    <a class="code" href="manager_8h.html#17a8c809d5b2d04cbb8969a209134c2b">manager_event</a>(<a class="code" href="manager_8h.html#440ebd9d80179402b9cd76c426adb8d2">EVENT_FLAG_SYSTEM</a>, <span class="stringliteral">"Reload"</span>, <span class="stringliteral">"Message: Reload Requested\r\n"</span>);
<a name="l03445"></a>03445    <span class="keywordflow">return</span> <a class="code" href="manager_8c.html#31a28c522e71a1df85feb1926f943821">init_manager</a>();
<a name="l03446"></a>03446 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="98bf7d8c15784f0a3d63204441e1e2aa"></a><!-- doxytag: member="manager.h::contents" ref="98bf7d8c15784f0a3d63204441e1e2aa" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int const char const char int const char const char* <a class="el" href="manager_8h.html#98bf7d8c15784f0a3d63204441e1e2aa">contents</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00166">166</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="4119639092e62c55ea8be348e4d9260d"></a><!-- doxytag: member="manager.h::event" ref="4119639092e62c55ea8be348e4d9260d" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int const char* <a class="el" href="manager_8h.html#4119639092e62c55ea8be348e4d9260d">event</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00166">166</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l02176">action_userevent()</a>, <a class="el" href="app__adsiprog_8c-source.html#l00964">adsi_process()</a>, <a class="el" href="res__eventtest_8c-source.html#l00074">event_gen()</a>, <a class="el" href="res__eventtest_8c-source.html#l00121">event_get_cached()</a>, <a class="el" href="chan__sip_8c-source.html#l11655">handle_request_info()</a>, <a class="el" href="chan__skinny_8c-source.html#l03920">handle_soft_key_event_message()</a>, <a class="el" href="chan__skinny_8c-source.html#l03102">handle_stimulus_message()</a>, <a class="el" href="chan__mgcp_8c-source.html#l00466">has_voicemail()</a>, <a class="el" href="isdn__msg__parser_8c-source.html#l01263">isdn_msg_get_event()</a>, <a class="el" href="app__queue_8c-source.html#l04523">manager_queue_log_custom()</a>, <a class="el" href="app__adsiprog_8c-source.html#l00757">onevent()</a>, <a class="el" href="rtp_8c-source.html#l00690">process_cisco_dtmf()</a>, <a class="el" href="app__queue_8c-source.html#l03404">ql_exec()</a>, <a class="el" href="app__voicemail_8c-source.html#l04051">queue_mwi_event()</a>, <a class="el" href="app__alarmreceiver_8c-source.html#l00448">receive_ademco_contact_id()</a>, <a class="el" href="app__meetme_8c-source.html#l01263">sla_queue_event_full()</a>, <a class="el" href="app__meetme_8c-source.html#l03979">sla_thread()</a>, and <a class="el" href="chan__iax2_8c-source.html#l05757">update_registry()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="8c7dd922ad47494fc02c388e12c00eac"></a><!-- doxytag: member="manager.h::file" ref="8c7dd922ad47494fc02c388e12c00eac" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int const char const char* <a class="el" href="utils_8h.html#8c7dd922ad47494fc02c388e12c00eac">file</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00166">166</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.
<p>
Referenced by <a class="el" href="res__smdi_8c-source.html#l00092">ast_smdi_mwi_set()</a>, <a class="el" href="res__smdi_8c-source.html#l00124">ast_smdi_mwi_unset()</a>, <a class="el" href="pbx__config_8c-source.html#l00717">handle_save_dialplan()</a>, and <a class="el" href="app__readfile_8c-source.html#l00056">readfile_exec()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="7631454338ff70b1a6b1262f5f36beac"></a><!-- doxytag: member="manager.h::fmt" ref="7631454338ff70b1a6b1262f5f36beac" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void const char* <a class="el" href="strings_8h.html#7631454338ff70b1a6b1262f5f36beac">fmt</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00182">182</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.
<p>
Referenced by <a class="el" href="chan__h323_8c-source.html#l01010">__oh323_new()</a>, <a class="el" href="cdr_8c-source.html#l00222">ast_cdr_getvar()</a>, <a class="el" href="chan__iax2_8c-source.html#l04530">ast_cli_netstats()</a>, <a class="el" href="frame_8c-source.html#l01100">ast_codec_pref_getsize()</a>, <a class="el" href="channel_8c-source.html#l03063">ast_request()</a>, <a class="el" href="format__wav_8c-source.html#l00086">check_header()</a>, <a class="el" href="app__playback_8c-source.html#l00147">do_say()</a>, <a class="el" href="chan__gtalk_8c-source.html#l00902">gtalk_new()</a>, <a class="el" href="chan__iax2_8c-source.html#l08278">iax2_request()</a>, <a class="el" href="chan__jingle_8c-source.html#l00759">jingle_new()</a>, <a class="el" href="app__minivm_8c-source.html#l01501">leave_voicemail()</a>, <a class="el" href="chan__local_8c-source.html#l00593">local_new()</a>, <a class="el" href="chan__mgcp_8c-source.html#l01457">mgcp_new()</a>, <a class="el" href="chan__oss_8c-source.html#l00674">setformat()</a>, <a class="el" href="chan__sip_8c-source.html#l04179">sip_new()</a>, <a class="el" href="chan__skinny_8c-source.html#l02823">skinny_new()</a>, <a class="el" href="chan__sip_8c-source.html#l03836">try_suggested_sip_codec()</a>, and <a class="el" href="format__wav_8c-source.html#l00255">write_header()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="7df4935f4a5a2865191ef74f64df8754"></a><!-- doxytag: member="manager.h::func" ref="7df4935f4a5a2865191ef74f64df8754" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int const char const char int const char* <a class="el" href="utils_8h.html#7df4935f4a5a2865191ef74f64df8754">func</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00166">166</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02060">__ast_read()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, and <a class="el" href="chan__zap_8c-source.html#l05309">zt_indicate()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="6438c669e0d0de98e6929c2cc0fac474"></a><!-- doxytag: member="manager.h::line" ref="6438c669e0d0de98e6929c2cc0fac474" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int const char const char int <a class="el" href="manager_8h.html#6438c669e0d0de98e6929c2cc0fac474">line</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="manager_8h-source.html#l00166">166</a> of file <a class="el" href="manager_8h-source.html">manager.h</a>.
<p>
Referenced by <a class="el" href="app__dumpchan_8c-source.html#l00143">dumpchan_exec()</a>, <a class="el" href="chan__skinny_8c-source.html#l01214">find_line_by_name()</a>, <a class="el" href="app__adsiprog_8c-source.html#l00288">goto_line()</a>, <a class="el" href="app__adsiprog_8c-source.html#l00318">goto_line_rel()</a>, <a class="el" href="misdn__config_8c-source.html#l00981">misdn_cfg_update_ptp()</a>, <a class="el" href="app__adsiprog_8c-source.html#l00632">showdisplay()</a>, <a class="el" href="app__sms_8c-source.html#l00711">sms_log()</a>, and <a class="el" href="app__sms_8c-source.html#l00754">sms_readfile()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Thu May 24 22:27:37 2007 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.5 </small></address>
</body>
</html>
