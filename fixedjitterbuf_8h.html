<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (24 May 2007)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Thu May 24 22:27:29 2007</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir__2Fusr_2Flocal_2Fsrc_2Fasterisk_2Esvn_2Fastum_2Fmain_2F.html">main</a></div>
<h1>fixedjitterbuf.h File Reference</h1>Jitterbuffering algorithm. <a href="#_details">More...</a>
<p>

<p>
<a href="fixedjitterbuf_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfixed__jb__conf.html">fixed_jb_conf</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfixed__jb__frame.html">fixed_jb_frame</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fixedjitterbuf_8h.html#04b794f6eac3552c22a49516881bc85b">FIXED_JB_RESYNCH_THRESHOLD_DEFAULT</a>&nbsp;&nbsp;&nbsp;1000</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fixedjitterbuf_8h.html#15b56fa4575915b8fe245e8e068bd9d0">FIXED_JB_SIZE_DEFAULT</a>&nbsp;&nbsp;&nbsp;200</td></tr>

<tr><td colspan="2"><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516efe930258ab8156247355464673084b7b8">FIXED_JB_OK</a>, 
<a class="el" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516efbb34371ff2ee09518b69bad519136ac8">FIXED_JB_DROP</a>, 
<a class="el" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516ef6f0187fe0d7c8e6f8172e05060e385b0">FIXED_JB_INTERP</a>, 
<a class="el" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516efb172ecc29ca9a21f4cdcfea3649af220">FIXED_JB_NOFRAME</a>
 }</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fixedjitterbuf_8h.html#6d6949ffa517b3fad3ce4583cca264f0">fixed_jb_destroy</a> (struct <a class="el" href="structfixed__jb.html">fixed_jb</a> *jb)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fixedjitterbuf_8h.html#0472f4d69dbcd187714e36ae6f8d1970">fixed_jb_get</a> (struct <a class="el" href="structfixed__jb.html">fixed_jb</a> *jb, struct <a class="el" href="structfixed__jb__frame.html">fixed_jb_frame</a> *frame, long now, long interpl)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structfixed__jb.html">fixed_jb</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fixedjitterbuf_8h.html#3bd412880139360169908c9c9ad7ff7a">fixed_jb_new</a> (struct <a class="el" href="structfixed__jb__conf.html">fixed_jb_conf</a> *conf)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fixedjitterbuf_8h.html#1d21993c8b505b23d887208da5cf2175">fixed_jb_next</a> (struct <a class="el" href="structfixed__jb.html">fixed_jb</a> *jb)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fixedjitterbuf_8h.html#5677f07248abad11c3f8535b1eda0842">fixed_jb_put</a> (struct <a class="el" href="structfixed__jb.html">fixed_jb</a> *jb, void *data, long ms, long ts, long now)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fixedjitterbuf_8h.html#52159a974ec077dd6d5590965901c6dd">fixed_jb_put_first</a> (struct <a class="el" href="structfixed__jb.html">fixed_jb</a> *jb, void *data, long ms, long ts, long now)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fixedjitterbuf_8h.html#309be910248fdadcb05a3ba8c63e1211">fixed_jb_remove</a> (struct <a class="el" href="structfixed__jb.html">fixed_jb</a> *jb, struct <a class="el" href="structfixed__jb__frame.html">fixed_jb_frame</a> *frameout)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fixedjitterbuf_8h.html#ffe2410d86051de9ea5b1009d8d1f612">fixed_jb_set_force_resynch</a> (struct <a class="el" href="structfixed__jb.html">fixed_jb</a> *jb)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Jitterbuffering algorithm. 
<p>

<p>
Definition in file <a class="el" href="fixedjitterbuf_8h-source.html">fixedjitterbuf.h</a>.<hr><h2>Define Documentation</h2>
<a class="anchor" name="04b794f6eac3552c22a49516881bc85b"></a><!-- doxytag: member="fixedjitterbuf.h::FIXED_JB_RESYNCH_THRESHOLD_DEFAULT" ref="04b794f6eac3552c22a49516881bc85b" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define FIXED_JB_RESYNCH_THRESHOLD_DEFAULT&nbsp;&nbsp;&nbsp;1000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="fixedjitterbuf_8h-source.html#l00045">45</a> of file <a class="el" href="fixedjitterbuf_8h-source.html">fixedjitterbuf.h</a>.
<p>
Referenced by <a class="el" href="fixedjitterbuf_8c-source.html#l00102">fixed_jb_new()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="15b56fa4575915b8fe245e8e068bd9d0"></a><!-- doxytag: member="fixedjitterbuf.h::FIXED_JB_SIZE_DEFAULT" ref="15b56fa4575915b8fe245e8e068bd9d0" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define FIXED_JB_SIZE_DEFAULT&nbsp;&nbsp;&nbsp;200          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="fixedjitterbuf_8h-source.html#l00044">44</a> of file <a class="el" href="fixedjitterbuf_8h-source.html">fixedjitterbuf.h</a>.
<p>
Referenced by <a class="el" href="fixedjitterbuf_8c-source.html#l00102">fixed_jb_new()</a>.    </td>
  </tr>
</table>
<hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="dca29a1140aadadfd92b34a02fa516ef"></a><!-- doxytag: member="fixedjitterbuf.h::@0" ref="dca29a1140aadadfd92b34a02fa516ef" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">anonymous enum          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="dca29a1140aadadfd92b34a02fa516efe930258ab8156247355464673084b7b8"></a><!-- doxytag: member="FIXED_JB_OK" ref="dca29a1140aadadfd92b34a02fa516efe930258ab8156247355464673084b7b8" args="" -->FIXED_JB_OK</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="dca29a1140aadadfd92b34a02fa516efbb34371ff2ee09518b69bad519136ac8"></a><!-- doxytag: member="FIXED_JB_DROP" ref="dca29a1140aadadfd92b34a02fa516efbb34371ff2ee09518b69bad519136ac8" args="" -->FIXED_JB_DROP</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="dca29a1140aadadfd92b34a02fa516ef6f0187fe0d7c8e6f8172e05060e385b0"></a><!-- doxytag: member="FIXED_JB_INTERP" ref="dca29a1140aadadfd92b34a02fa516ef6f0187fe0d7c8e6f8172e05060e385b0" args="" -->FIXED_JB_INTERP</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="dca29a1140aadadfd92b34a02fa516efb172ecc29ca9a21f4cdcfea3649af220"></a><!-- doxytag: member="FIXED_JB_NOFRAME" ref="dca29a1140aadadfd92b34a02fa516efb172ecc29ca9a21f4cdcfea3649af220" args="" -->FIXED_JB_NOFRAME</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="fixedjitterbuf_8h-source.html#l00035">35</a> of file <a class="el" href="fixedjitterbuf_8h-source.html">fixedjitterbuf.h</a>.<div class="fragment"><pre class="fragment"><a name="l00035"></a>00035      {
<a name="l00036"></a>00036    <a class="code" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516efe930258ab8156247355464673084b7b8">FIXED_JB_OK</a>,
<a name="l00037"></a>00037    <a class="code" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516efbb34371ff2ee09518b69bad519136ac8">FIXED_JB_DROP</a>,
<a name="l00038"></a>00038    <a class="code" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516ef6f0187fe0d7c8e6f8172e05060e385b0">FIXED_JB_INTERP</a>,
<a name="l00039"></a>00039    <a class="code" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516efb172ecc29ca9a21f4cdcfea3649af220">FIXED_JB_NOFRAME</a>
<a name="l00040"></a>00040 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="6d6949ffa517b3fad3ce4583cca264f0"></a><!-- doxytag: member="fixedjitterbuf.h::fixed_jb_destroy" ref="6d6949ffa517b3fad3ce4583cca264f0" args="(struct fixed_jb *jb)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void fixed_jb_destroy           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structfixed__jb.html">fixed_jb</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>jb</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="fixedjitterbuf_8c-source.html#l00129">129</a> of file <a class="el" href="fixedjitterbuf_8c-source.html">fixedjitterbuf.c</a>.
<p>
References <a class="el" href="fixedjitterbuf_8c-source.html#l00046">ASSERT</a>, <a class="el" href="fixedjitterbuf_8c-source.html#l00052">fixed_jb::frames</a>, and <a class="el" href="astmm_8h-source.html#l00069">free</a>.
<p>
Referenced by <a class="el" href="abstract__jb_8c-source.html#l00628">jb_destroy_fixed()</a>.<div class="fragment"><pre class="fragment"><a name="l00130"></a>00130 {
<a name="l00131"></a>00131    <span class="comment">/* jitterbuf MUST be empty before it can be destroyed */</span>
<a name="l00132"></a>00132    <a class="code" href="fixedjitterbuf_8c.html#23c6fcefc841498464e17f23def23fdb">ASSERT</a>(jb-&gt;<a class="code" href="structfixed__jb.html#dcdc1ac079a91d513a5a759b0fb9c1dc">frames</a> == NULL);
<a name="l00133"></a>00133    
<a name="l00134"></a>00134    <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(jb);
<a name="l00135"></a>00135 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="0472f4d69dbcd187714e36ae6f8d1970"></a><!-- doxytag: member="fixedjitterbuf.h::fixed_jb_get" ref="0472f4d69dbcd187714e36ae6f8d1970" args="(struct fixed_jb *jb, struct fixed_jb_frame *frame, long now, long interpl)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int fixed_jb_get           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structfixed__jb.html">fixed_jb</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>jb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structfixed__jb__frame.html">fixed_jb_frame</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>frame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap> <em>now</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap> <em>interpl</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="fixedjitterbuf_8c-source.html#l00294">294</a> of file <a class="el" href="fixedjitterbuf_8c-source.html">fixedjitterbuf.c</a>.
<p>
References <a class="el" href="fixedjitterbuf_8c-source.html#l00046">ASSERT</a>, <a class="el" href="fixedjitterbuf_8h-source.html#l00061">fixed_jb_frame::delivery</a>, <a class="el" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516efbb34371ff2ee09518b69bad519136ac8">FIXED_JB_DROP</a>, <a class="el" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516ef6f0187fe0d7c8e6f8172e05060e385b0">FIXED_JB_INTERP</a>, <a class="el" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516efb172ecc29ca9a21f4cdcfea3649af220">FIXED_JB_NOFRAME</a>, <a class="el" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516efe930258ab8156247355464673084b7b8">FIXED_JB_OK</a>, <a class="el" href="iax2-parser_8c-source.html#l00050">frames</a>, <a class="el" href="fixedjitterbuf_8c-source.html#l00052">fixed_jb::frames</a>, <a class="el" href="fixedjitterbuf_8c-source.html#l00077">get_jb_head()</a>, <a class="el" href="fixedjitterbuf_8h-source.html#l00060">fixed_jb_frame::ms</a>, and <a class="el" href="fixedjitterbuf_8c-source.html#l00057">fixed_jb::next_delivery</a>.
<p>
Referenced by <a class="el" href="abstract__jb_8c-source.html#l00659">jb_get_fixed()</a>.<div class="fragment"><pre class="fragment"><a name="l00295"></a>00295 {
<a name="l00296"></a>00296    <a class="code" href="fixedjitterbuf_8c.html#23c6fcefc841498464e17f23def23fdb">ASSERT</a>(now &gt;= 0);
<a name="l00297"></a>00297    <a class="code" href="fixedjitterbuf_8c.html#23c6fcefc841498464e17f23def23fdb">ASSERT</a>(interpl &gt;= 2);
<a name="l00298"></a>00298    
<a name="l00299"></a>00299    <span class="keywordflow">if</span> (now &lt; jb-&gt;next_delivery) {
<a name="l00300"></a>00300       <span class="comment">/* too early for the next frame */</span>
<a name="l00301"></a>00301       <span class="keywordflow">return</span> <a class="code" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516efb172ecc29ca9a21f4cdcfea3649af220">FIXED_JB_NOFRAME</a>;
<a name="l00302"></a>00302    }
<a name="l00303"></a>00303    
<a name="l00304"></a>00304    <span class="comment">/* Is the jb empty? */</span>
<a name="l00305"></a>00305    <span class="keywordflow">if</span> (!jb-&gt;<a class="code" href="structfixed__jb.html#dcdc1ac079a91d513a5a759b0fb9c1dc">frames</a>) {
<a name="l00306"></a>00306       <span class="comment">/* should interpolate a frame */</span>
<a name="l00307"></a>00307       <span class="comment">/* update next */</span>
<a name="l00308"></a>00308       jb-&gt;<a class="code" href="structfixed__jb.html#7e719922f89b517fbd30617c5a49d78d">next_delivery</a> += interpl;
<a name="l00309"></a>00309       
<a name="l00310"></a>00310       <span class="keywordflow">return</span> <a class="code" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516ef6f0187fe0d7c8e6f8172e05060e385b0">FIXED_JB_INTERP</a>;
<a name="l00311"></a>00311    }
<a name="l00312"></a>00312    
<a name="l00313"></a>00313    <span class="comment">/* Isn't it too late for the first frame available in the jb? */</span>
<a name="l00314"></a>00314    <span class="keywordflow">if</span> (now &gt; jb-&gt;<a class="code" href="structfixed__jb.html#dcdc1ac079a91d513a5a759b0fb9c1dc">frames</a>-&gt;<a class="code" href="structfixed__jb__frame.html#7108537956afa2a526f96cc9da7b0c36">delivery</a> + jb-&gt;<a class="code" href="structfixed__jb.html#dcdc1ac079a91d513a5a759b0fb9c1dc">frames</a>-&gt;<a class="code" href="structfixed__jb__frame.html#ee33e909372d935d190f4fcb2a92d542">ms</a>) {
<a name="l00315"></a>00315       <span class="comment">/* yes - should drop this frame and update next to point the next frame (get_jb_head() does it) */</span>
<a name="l00316"></a>00316       <a class="code" href="fixedjitterbuf_8c.html#6878d904296582b6ba6d4ea2e9889685">get_jb_head</a>(jb, frame);
<a name="l00317"></a>00317       
<a name="l00318"></a>00318       <span class="keywordflow">return</span> <a class="code" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516efbb34371ff2ee09518b69bad519136ac8">FIXED_JB_DROP</a>;
<a name="l00319"></a>00319    }
<a name="l00320"></a>00320    
<a name="l00321"></a>00321    <span class="comment">/* isn't it too early to play the first frame available? */</span>
<a name="l00322"></a>00322    <span class="keywordflow">if</span> (now &lt; jb-&gt;<a class="code" href="iax2-parser_8c.html#dcdc1ac079a91d513a5a759b0fb9c1dc">frames</a>-&gt;delivery) {
<a name="l00323"></a>00323       <span class="comment">/* yes - should interpolate one frame */</span>
<a name="l00324"></a>00324       <span class="comment">/* update next */</span>
<a name="l00325"></a>00325       jb-&gt;<a class="code" href="structfixed__jb.html#7e719922f89b517fbd30617c5a49d78d">next_delivery</a> += interpl;
<a name="l00326"></a>00326       
<a name="l00327"></a>00327       <span class="keywordflow">return</span> <a class="code" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516ef6f0187fe0d7c8e6f8172e05060e385b0">FIXED_JB_INTERP</a>;
<a name="l00328"></a>00328    }
<a name="l00329"></a>00329    
<a name="l00330"></a>00330    <span class="comment">/* we have a frame for playing now (get_jb_head() updates next) */</span>
<a name="l00331"></a>00331    <a class="code" href="fixedjitterbuf_8c.html#6878d904296582b6ba6d4ea2e9889685">get_jb_head</a>(jb, frame);
<a name="l00332"></a>00332    
<a name="l00333"></a>00333    <span class="keywordflow">return</span> <a class="code" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516efe930258ab8156247355464673084b7b8">FIXED_JB_OK</a>;
<a name="l00334"></a>00334 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3bd412880139360169908c9c9ad7ff7a"></a><!-- doxytag: member="fixedjitterbuf.h::fixed_jb_new" ref="3bd412880139360169908c9c9ad7ff7a" args="(struct fixed_jb_conf *conf)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structfixed__jb.html">fixed_jb</a>* fixed_jb_new           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structfixed__jb__conf.html">fixed_jb_conf</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>conf</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="fixedjitterbuf_8c-source.html#l00102">102</a> of file <a class="el" href="fixedjitterbuf_8c-source.html">fixedjitterbuf.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="fixedjitterbuf_8h-source.html#l00045">FIXED_JB_RESYNCH_THRESHOLD_DEFAULT</a>, <a class="el" href="fixedjitterbuf_8h-source.html#l00044">FIXED_JB_SIZE_DEFAULT</a>, <a class="el" href="fixedjitterbuf_8h-source.html#l00051">fixed_jb_conf::jbsize</a>, and <a class="el" href="fixedjitterbuf_8h-source.html#l00052">fixed_jb_conf::resync_threshold</a>.
<p>
Referenced by <a class="el" href="abstract__jb_8c-source.html#l00617">jb_create_fixed()</a>.<div class="fragment"><pre class="fragment"><a name="l00103"></a>00103 {
<a name="l00104"></a>00104    <span class="keyword">struct </span><a class="code" href="structfixed__jb.html">fixed_jb</a> *jb;
<a name="l00105"></a>00105    
<a name="l00106"></a>00106    <span class="keywordflow">if</span> (!(jb = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*jb))))
<a name="l00107"></a>00107       <span class="keywordflow">return</span> NULL;
<a name="l00108"></a>00108    
<a name="l00109"></a>00109    <span class="comment">/* First copy our config */</span>
<a name="l00110"></a>00110    memcpy(&amp;jb-&gt;conf, conf, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structfixed__jb__conf.html">fixed_jb_conf</a>));
<a name="l00111"></a>00111 
<a name="l00112"></a>00112    <span class="comment">/* we dont need the passed config anymore - continue working with the saved one */</span>
<a name="l00113"></a>00113    conf = &amp;jb-&gt;conf;
<a name="l00114"></a>00114    
<a name="l00115"></a>00115    <span class="comment">/* validate the configuration */</span>
<a name="l00116"></a>00116    <span class="keywordflow">if</span> (conf-&gt;<a class="code" href="structfixed__jb__conf.html#2be1cc52550fdf7cfa300e45caeda190">jbsize</a> &lt; 1)
<a name="l00117"></a>00117       conf-&gt;<a class="code" href="structfixed__jb__conf.html#2be1cc52550fdf7cfa300e45caeda190">jbsize</a> = <a class="code" href="fixedjitterbuf_8h.html#15b56fa4575915b8fe245e8e068bd9d0">FIXED_JB_SIZE_DEFAULT</a>;
<a name="l00118"></a>00118 
<a name="l00119"></a>00119    <span class="keywordflow">if</span> (conf-&gt;<a class="code" href="structfixed__jb__conf.html#d97eebcde281eba2855bbe1308ef0944">resync_threshold</a> &lt; 1)
<a name="l00120"></a>00120       conf-&gt;<a class="code" href="structfixed__jb__conf.html#d97eebcde281eba2855bbe1308ef0944">resync_threshold</a> = <a class="code" href="fixedjitterbuf_8h.html#04b794f6eac3552c22a49516881bc85b">FIXED_JB_RESYNCH_THRESHOLD_DEFAULT</a>;
<a name="l00121"></a>00121    
<a name="l00122"></a>00122    <span class="comment">/* Set the constant delay to the jitterbuf */</span>
<a name="l00123"></a>00123    jb-&gt;delay = conf-&gt;<a class="code" href="structfixed__jb__conf.html#2be1cc52550fdf7cfa300e45caeda190">jbsize</a>;
<a name="l00124"></a>00124    
<a name="l00125"></a>00125    <span class="keywordflow">return</span> jb;
<a name="l00126"></a>00126 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1d21993c8b505b23d887208da5cf2175"></a><!-- doxytag: member="fixedjitterbuf.h::fixed_jb_next" ref="1d21993c8b505b23d887208da5cf2175" args="(struct fixed_jb *jb)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">long fixed_jb_next           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structfixed__jb.html">fixed_jb</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>jb</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="fixedjitterbuf_8c-source.html#l00337">337</a> of file <a class="el" href="fixedjitterbuf_8c-source.html">fixedjitterbuf.c</a>.
<p>
References <a class="el" href="fixedjitterbuf_8c-source.html#l00057">fixed_jb::next_delivery</a>.
<p>
Referenced by <a class="el" href="abstract__jb_8c-source.html#l00672">jb_next_fixed()</a>.<div class="fragment"><pre class="fragment"><a name="l00338"></a>00338 {
<a name="l00339"></a>00339    <span class="keywordflow">return</span> jb-&gt;<a class="code" href="structfixed__jb.html#7e719922f89b517fbd30617c5a49d78d">next_delivery</a>;
<a name="l00340"></a>00340 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="5677f07248abad11c3f8535b1eda0842"></a><!-- doxytag: member="fixedjitterbuf.h::fixed_jb_put" ref="5677f07248abad11c3f8535b1eda0842" args="(struct fixed_jb *jb, void *data, long ms, long ts, long now)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int fixed_jb_put           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structfixed__jb.html">fixed_jb</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>jb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap> <em>ms</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap> <em>ts</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap> <em>now</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="fixedjitterbuf_8c-source.html#l00200">200</a> of file <a class="el" href="fixedjitterbuf_8c-source.html">fixedjitterbuf.c</a>.
<p>
References <a class="el" href="fixedjitterbuf_8c-source.html#l00067">alloc_jb_frame()</a>, <a class="el" href="fixedjitterbuf_8c-source.html#l00046">ASSERT</a>, <a class="el" href="fixedjitterbuf_8c-source.html#l00054">fixed_jb::conf</a>, <a class="el" href="fixedjitterbuf_8h-source.html#l00058">fixed_jb_frame::data</a>, <a class="el" href="fixedjitterbuf_8c-source.html#l00056">fixed_jb::delay</a>, <a class="el" href="fixedjitterbuf_8h-source.html#l00061">fixed_jb_frame::delivery</a>, <a class="el" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516efe930258ab8156247355464673084b7b8">FIXED_JB_OK</a>, <a class="el" href="fixedjitterbuf_8c-source.html#l00058">fixed_jb::force_resynch</a>, <a class="el" href="fixedjitterbuf_8c-source.html#l00052">fixed_jb::frames</a>, <a class="el" href="fixedjitterbuf_8h-source.html#l00060">fixed_jb_frame::ms</a>, <a class="el" href="fixedjitterbuf_8h-source.html#l00062">fixed_jb_frame::next</a>, <a class="el" href="fixedjitterbuf_8c-source.html#l00057">fixed_jb::next_delivery</a>, <a class="el" href="fixedjitterbuf_8h-source.html#l00063">fixed_jb_frame::prev</a>, <a class="el" href="fixedjitterbuf_8h-source.html#l00052">fixed_jb_conf::resync_threshold</a>, <a class="el" href="fixedjitterbuf_8c-source.html#l00138">resynch_jb()</a>, <a class="el" href="fixedjitterbuf_8c-source.html#l00055">fixed_jb::rxcore</a>, <a class="el" href="fixedjitterbuf_8c-source.html#l00053">fixed_jb::tail</a>, and <a class="el" href="fixedjitterbuf_8h-source.html#l00059">fixed_jb_frame::ts</a>.
<p>
Referenced by <a class="el" href="fixedjitterbuf_8c-source.html#l00187">fixed_jb_put_first()</a>, <a class="el" href="abstract__jb_8c-source.html#l00648">jb_put_fixed()</a>, and <a class="el" href="fixedjitterbuf_8c-source.html#l00138">resynch_jb()</a>.<div class="fragment"><pre class="fragment"><a name="l00201"></a>00201 {
<a name="l00202"></a>00202    <span class="keyword">struct </span><a class="code" href="structfixed__jb__frame.html">fixed_jb_frame</a> *frame, *<a class="code" href="structfixed__jb__frame.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>, *newframe;
<a name="l00203"></a>00203    <span class="keywordtype">long</span> <a class="code" href="structfixed__jb__frame.html#7108537956afa2a526f96cc9da7b0c36">delivery</a>;
<a name="l00204"></a>00204    
<a name="l00205"></a>00205    <span class="comment">/* debug check the validity of the input params */</span>
<a name="l00206"></a>00206    <a class="code" href="fixedjitterbuf_8c.html#23c6fcefc841498464e17f23def23fdb">ASSERT</a>(<a class="code" href="structfixed__jb__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a> != NULL);
<a name="l00207"></a>00207    <span class="comment">/* do not allow frames shorter than 2 ms */</span>
<a name="l00208"></a>00208    <a class="code" href="fixedjitterbuf_8c.html#23c6fcefc841498464e17f23def23fdb">ASSERT</a>(<a class="code" href="structfixed__jb__frame.html#ee33e909372d935d190f4fcb2a92d542">ms</a> &gt;= 2);
<a name="l00209"></a>00209    <a class="code" href="fixedjitterbuf_8c.html#23c6fcefc841498464e17f23def23fdb">ASSERT</a>(<a class="code" href="structfixed__jb__frame.html#4d682ec4eed27c53849758bc13b6e179">ts</a> &gt;= 0);
<a name="l00210"></a>00210    <a class="code" href="fixedjitterbuf_8c.html#23c6fcefc841498464e17f23def23fdb">ASSERT</a>(now &gt;= 0);
<a name="l00211"></a>00211    
<a name="l00212"></a>00212    delivery = jb-&gt;<a class="code" href="structfixed__jb.html#0ebb75b3cc31467bd9289cd746556cff">rxcore</a> + jb-&gt;<a class="code" href="structfixed__jb.html#7243f8be75253afbadf7477867021f8b">delay</a> + <a class="code" href="structfixed__jb__frame.html#4d682ec4eed27c53849758bc13b6e179">ts</a>;
<a name="l00213"></a>00213    
<a name="l00214"></a>00214    <span class="comment">/* check if the new frame is not too late */</span>
<a name="l00215"></a>00215    <span class="keywordflow">if</span> (delivery &lt; jb-&gt;next_delivery) {
<a name="l00216"></a>00216       <span class="comment">/* should drop the frame, but let first resynch_jb() check if this is not a jump in ts, or</span>
<a name="l00217"></a>00217 <span class="comment">         the force resynch flag was not set. */</span>
<a name="l00218"></a>00218       <span class="keywordflow">return</span> <a class="code" href="fixedjitterbuf_8c.html#690103a8a18a8a6c2e85cdf43641605b">resynch_jb</a>(jb, <a class="code" href="structfixed__jb__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a>, <a class="code" href="structfixed__jb__frame.html#ee33e909372d935d190f4fcb2a92d542">ms</a>, <a class="code" href="structfixed__jb__frame.html#4d682ec4eed27c53849758bc13b6e179">ts</a>, now);
<a name="l00219"></a>00219    }
<a name="l00220"></a>00220    
<a name="l00221"></a>00221    <span class="comment">/* what if the delivery time is bigger than next + delay? Seems like a frame for the future.</span>
<a name="l00222"></a>00222 <span class="comment">      However, allow more resync_threshold ms in advance */</span>
<a name="l00223"></a>00223    <span class="keywordflow">if</span> (delivery &gt; jb-&gt;<a class="code" href="structfixed__jb.html#7e719922f89b517fbd30617c5a49d78d">next_delivery</a> + jb-&gt;<a class="code" href="structfixed__jb.html#7243f8be75253afbadf7477867021f8b">delay</a> + jb-&gt;<a class="code" href="structfixed__jb.html#3a8e4c06e471595f6eb262bb9b5582d9">conf</a>.<a class="code" href="structfixed__jb__conf.html#d97eebcde281eba2855bbe1308ef0944">resync_threshold</a>) {
<a name="l00224"></a>00224       <span class="comment">/* should drop the frame, but let first resynch_jb() check if this is not a jump in ts, or</span>
<a name="l00225"></a>00225 <span class="comment">         the force resynch flag was not set. */</span>
<a name="l00226"></a>00226       <span class="keywordflow">return</span> <a class="code" href="fixedjitterbuf_8c.html#690103a8a18a8a6c2e85cdf43641605b">resynch_jb</a>(jb, <a class="code" href="structfixed__jb__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a>, <a class="code" href="structfixed__jb__frame.html#ee33e909372d935d190f4fcb2a92d542">ms</a>, <a class="code" href="structfixed__jb__frame.html#4d682ec4eed27c53849758bc13b6e179">ts</a>, now);
<a name="l00227"></a>00227    }
<a name="l00228"></a>00228 
<a name="l00229"></a>00229    <span class="comment">/* find the right place in the frames list, sorted by delivery time */</span>
<a name="l00230"></a>00230    frame = jb-&gt;<a class="code" href="structfixed__jb.html#7aea2552dfe7eb84b9443b6fc9ba6e01">tail</a>;
<a name="l00231"></a>00231    <span class="keywordflow">while</span> (frame &amp;&amp; frame-&gt;<a class="code" href="structfixed__jb__frame.html#7108537956afa2a526f96cc9da7b0c36">delivery</a> &gt; delivery) {
<a name="l00232"></a>00232       frame = frame-&gt;<a class="code" href="structfixed__jb__frame.html#fcb08b164ac83e09964deb24f2d2e80b">prev</a>;
<a name="l00233"></a>00233    }
<a name="l00234"></a>00234    
<a name="l00235"></a>00235    <span class="comment">/* Check if the new delivery time is not covered already by the chosen frame */</span>
<a name="l00236"></a>00236    <span class="keywordflow">if</span> (frame &amp;&amp; (frame-&gt;<a class="code" href="structfixed__jb__frame.html#7108537956afa2a526f96cc9da7b0c36">delivery</a> == delivery ||
<a name="l00237"></a>00237                delivery &lt; frame-&gt;delivery + frame-&gt;<a class="code" href="structfixed__jb__frame.html#ee33e909372d935d190f4fcb2a92d542">ms</a> ||
<a name="l00238"></a>00238                (frame-&gt;<a class="code" href="structfixed__jb__frame.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> &amp;&amp; delivery + <a class="code" href="structfixed__jb__frame.html#ee33e909372d935d190f4fcb2a92d542">ms</a> &gt; frame-&gt;<a class="code" href="structfixed__jb__frame.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>-&gt;<a class="code" href="structfixed__jb__frame.html#7108537956afa2a526f96cc9da7b0c36">delivery</a>)))
<a name="l00239"></a>00239    {
<a name="l00240"></a>00240       <span class="comment">/* TODO: Should we check for resynch here? Be careful to do not allow threshold smaller than</span>
<a name="l00241"></a>00241 <span class="comment">         the size of the jb */</span>
<a name="l00242"></a>00242       
<a name="l00243"></a>00243       <span class="comment">/* should drop the frame, but let first resynch_jb() check if this is not a jump in ts, or</span>
<a name="l00244"></a>00244 <span class="comment">         the force resynch flag was not set. */</span>
<a name="l00245"></a>00245       <span class="keywordflow">return</span> <a class="code" href="fixedjitterbuf_8c.html#690103a8a18a8a6c2e85cdf43641605b">resynch_jb</a>(jb, <a class="code" href="structfixed__jb__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a>, <a class="code" href="structfixed__jb__frame.html#ee33e909372d935d190f4fcb2a92d542">ms</a>, <a class="code" href="structfixed__jb__frame.html#4d682ec4eed27c53849758bc13b6e179">ts</a>, now);
<a name="l00246"></a>00246    }
<a name="l00247"></a>00247    
<a name="l00248"></a>00248    <span class="comment">/* Reset the force resynch flag */</span>
<a name="l00249"></a>00249    jb-&gt;<a class="code" href="structfixed__jb.html#4c195aabe34d1d57d9948d227f4903a7">force_resynch</a> = 0;
<a name="l00250"></a>00250    
<a name="l00251"></a>00251    <span class="comment">/* Get a new frame */</span>
<a name="l00252"></a>00252    newframe = <a class="code" href="fixedjitterbuf_8c.html#6814aae9835d88ed33a989b9bbb13a55">alloc_jb_frame</a>(jb);
<a name="l00253"></a>00253    newframe-&gt;<a class="code" href="structfixed__jb__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a> = <a class="code" href="structfixed__jb__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a>;
<a name="l00254"></a>00254    newframe-&gt;<a class="code" href="structfixed__jb__frame.html#4d682ec4eed27c53849758bc13b6e179">ts</a> = <a class="code" href="structfixed__jb__frame.html#4d682ec4eed27c53849758bc13b6e179">ts</a>;
<a name="l00255"></a>00255    newframe-&gt;<a class="code" href="structfixed__jb__frame.html#ee33e909372d935d190f4fcb2a92d542">ms</a> = <a class="code" href="structfixed__jb__frame.html#ee33e909372d935d190f4fcb2a92d542">ms</a>;
<a name="l00256"></a>00256    newframe-&gt;<a class="code" href="structfixed__jb__frame.html#7108537956afa2a526f96cc9da7b0c36">delivery</a> = delivery;
<a name="l00257"></a>00257    
<a name="l00258"></a>00258    <span class="comment">/* and insert it right on place */</span>
<a name="l00259"></a>00259    <span class="keywordflow">if</span> (frame) {
<a name="l00260"></a>00260       next = frame-&gt;<a class="code" href="structfixed__jb__frame.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l00261"></a>00261       frame-&gt;<a class="code" href="structfixed__jb__frame.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = newframe;
<a name="l00262"></a>00262       <span class="keywordflow">if</span> (next) {
<a name="l00263"></a>00263          newframe-&gt;<a class="code" href="structfixed__jb__frame.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = next;
<a name="l00264"></a>00264          next-&gt;<a class="code" href="structfixed__jb__frame.html#fcb08b164ac83e09964deb24f2d2e80b">prev</a> = newframe;
<a name="l00265"></a>00265       } <span class="keywordflow">else</span> {
<a name="l00266"></a>00266          <span class="comment">/* insert after the last frame - should update tail */</span>
<a name="l00267"></a>00267          jb-&gt;<a class="code" href="structfixed__jb.html#7aea2552dfe7eb84b9443b6fc9ba6e01">tail</a> = newframe;
<a name="l00268"></a>00268          newframe-&gt;<a class="code" href="structfixed__jb__frame.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = NULL;
<a name="l00269"></a>00269       }
<a name="l00270"></a>00270       newframe-&gt;<a class="code" href="structfixed__jb__frame.html#fcb08b164ac83e09964deb24f2d2e80b">prev</a> = frame;
<a name="l00271"></a>00271       
<a name="l00272"></a>00272       <span class="keywordflow">return</span> <a class="code" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516efe930258ab8156247355464673084b7b8">FIXED_JB_OK</a>;
<a name="l00273"></a>00273    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!jb-&gt;<a class="code" href="structfixed__jb.html#dcdc1ac079a91d513a5a759b0fb9c1dc">frames</a>) {
<a name="l00274"></a>00274       <span class="comment">/* the frame list is empty or thats just the first frame ever */</span>
<a name="l00275"></a>00275       <span class="comment">/* tail should also be NULL is that case */</span>
<a name="l00276"></a>00276       <a class="code" href="fixedjitterbuf_8c.html#23c6fcefc841498464e17f23def23fdb">ASSERT</a>(jb-&gt;<a class="code" href="structfixed__jb.html#7aea2552dfe7eb84b9443b6fc9ba6e01">tail</a> == NULL);
<a name="l00277"></a>00277       jb-&gt;<a class="code" href="structfixed__jb.html#dcdc1ac079a91d513a5a759b0fb9c1dc">frames</a> = jb-&gt;<a class="code" href="structfixed__jb.html#7aea2552dfe7eb84b9443b6fc9ba6e01">tail</a> = newframe;
<a name="l00278"></a>00278       newframe-&gt;<a class="code" href="structfixed__jb__frame.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = NULL;
<a name="l00279"></a>00279       newframe-&gt;<a class="code" href="structfixed__jb__frame.html#fcb08b164ac83e09964deb24f2d2e80b">prev</a> = NULL;
<a name="l00280"></a>00280       
<a name="l00281"></a>00281       <span class="keywordflow">return</span> <a class="code" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516efe930258ab8156247355464673084b7b8">FIXED_JB_OK</a>;
<a name="l00282"></a>00282    } <span class="keywordflow">else</span> {
<a name="l00283"></a>00283       <span class="comment">/* insert on a first position - should update frames head */</span>
<a name="l00284"></a>00284       newframe-&gt;<a class="code" href="structfixed__jb__frame.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = jb-&gt;<a class="code" href="structfixed__jb.html#dcdc1ac079a91d513a5a759b0fb9c1dc">frames</a>;
<a name="l00285"></a>00285       newframe-&gt;<a class="code" href="structfixed__jb__frame.html#fcb08b164ac83e09964deb24f2d2e80b">prev</a> = NULL;
<a name="l00286"></a>00286       jb-&gt;<a class="code" href="structfixed__jb.html#dcdc1ac079a91d513a5a759b0fb9c1dc">frames</a>-&gt;<a class="code" href="structfixed__jb__frame.html#fcb08b164ac83e09964deb24f2d2e80b">prev</a> = newframe;
<a name="l00287"></a>00287       jb-&gt;<a class="code" href="structfixed__jb.html#dcdc1ac079a91d513a5a759b0fb9c1dc">frames</a> = newframe;
<a name="l00288"></a>00288       
<a name="l00289"></a>00289       <span class="keywordflow">return</span> <a class="code" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516efe930258ab8156247355464673084b7b8">FIXED_JB_OK</a>;
<a name="l00290"></a>00290    }
<a name="l00291"></a>00291 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="52159a974ec077dd6d5590965901c6dd"></a><!-- doxytag: member="fixedjitterbuf.h::fixed_jb_put_first" ref="52159a974ec077dd6d5590965901c6dd" args="(struct fixed_jb *jb, void *data, long ms, long ts, long now)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int fixed_jb_put_first           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structfixed__jb.html">fixed_jb</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>jb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap> <em>ms</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap> <em>ts</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap> <em>now</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="fixedjitterbuf_8c-source.html#l00187">187</a> of file <a class="el" href="fixedjitterbuf_8c-source.html">fixedjitterbuf.c</a>.
<p>
References <a class="el" href="fixedjitterbuf_8c-source.html#l00056">fixed_jb::delay</a>, <a class="el" href="fixedjitterbuf_8c-source.html#l00200">fixed_jb_put()</a>, <a class="el" href="fixedjitterbuf_8c-source.html#l00057">fixed_jb::next_delivery</a>, and <a class="el" href="fixedjitterbuf_8c-source.html#l00055">fixed_jb::rxcore</a>.
<p>
Referenced by <a class="el" href="abstract__jb_8c-source.html#l00637">jb_put_first_fixed()</a>, and <a class="el" href="fixedjitterbuf_8c-source.html#l00138">resynch_jb()</a>.<div class="fragment"><pre class="fragment"><a name="l00188"></a>00188 {
<a name="l00189"></a>00189    <span class="comment">/* this is our first frame - set the base of the receivers time */</span>
<a name="l00190"></a>00190    jb-&gt;<a class="code" href="structfixed__jb.html#0ebb75b3cc31467bd9289cd746556cff">rxcore</a> = now - <a class="code" href="structfixed__jb__frame.html#4d682ec4eed27c53849758bc13b6e179">ts</a>;
<a name="l00191"></a>00191    
<a name="l00192"></a>00192    <span class="comment">/* init next for a first time - it should be the time the first frame should be played */</span>
<a name="l00193"></a>00193    jb-&gt;<a class="code" href="structfixed__jb.html#7e719922f89b517fbd30617c5a49d78d">next_delivery</a> = now + jb-&gt;<a class="code" href="structfixed__jb.html#7243f8be75253afbadf7477867021f8b">delay</a>;
<a name="l00194"></a>00194    
<a name="l00195"></a>00195    <span class="comment">/* put the frame */</span>
<a name="l00196"></a>00196    <span class="keywordflow">return</span> <a class="code" href="fixedjitterbuf_8c.html#5677f07248abad11c3f8535b1eda0842">fixed_jb_put</a>(jb, <a class="code" href="structfixed__jb__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a>, <a class="code" href="structfixed__jb__frame.html#ee33e909372d935d190f4fcb2a92d542">ms</a>, ts, now);
<a name="l00197"></a>00197 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="309be910248fdadcb05a3ba8c63e1211"></a><!-- doxytag: member="fixedjitterbuf.h::fixed_jb_remove" ref="309be910248fdadcb05a3ba8c63e1211" args="(struct fixed_jb *jb, struct fixed_jb_frame *frameout)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int fixed_jb_remove           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structfixed__jb.html">fixed_jb</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>jb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structfixed__jb__frame.html">fixed_jb_frame</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>frameout</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="fixedjitterbuf_8c-source.html#l00343">343</a> of file <a class="el" href="fixedjitterbuf_8c-source.html">fixedjitterbuf.c</a>.
<p>
References <a class="el" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516efb172ecc29ca9a21f4cdcfea3649af220">FIXED_JB_NOFRAME</a>, <a class="el" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516efe930258ab8156247355464673084b7b8">FIXED_JB_OK</a>, <a class="el" href="fixedjitterbuf_8c-source.html#l00052">fixed_jb::frames</a>, and <a class="el" href="fixedjitterbuf_8c-source.html#l00077">get_jb_head()</a>.
<p>
Referenced by <a class="el" href="abstract__jb_8c-source.html#l00680">jb_remove_fixed()</a>.<div class="fragment"><pre class="fragment"><a name="l00344"></a>00344 {
<a name="l00345"></a>00345    <span class="keywordflow">if</span> (!jb-&gt;<a class="code" href="structfixed__jb.html#dcdc1ac079a91d513a5a759b0fb9c1dc">frames</a>)
<a name="l00346"></a>00346       <span class="keywordflow">return</span> <a class="code" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516efb172ecc29ca9a21f4cdcfea3649af220">FIXED_JB_NOFRAME</a>;
<a name="l00347"></a>00347    
<a name="l00348"></a>00348    <a class="code" href="fixedjitterbuf_8c.html#6878d904296582b6ba6d4ea2e9889685">get_jb_head</a>(jb, frameout);
<a name="l00349"></a>00349    
<a name="l00350"></a>00350    <span class="keywordflow">return</span> <a class="code" href="fixedjitterbuf_8h.html#dca29a1140aadadfd92b34a02fa516efe930258ab8156247355464673084b7b8">FIXED_JB_OK</a>;
<a name="l00351"></a>00351 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ffe2410d86051de9ea5b1009d8d1f612"></a><!-- doxytag: member="fixedjitterbuf.h::fixed_jb_set_force_resynch" ref="ffe2410d86051de9ea5b1009d8d1f612" args="(struct fixed_jb *jb)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void fixed_jb_set_force_resynch           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structfixed__jb.html">fixed_jb</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>jb</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="fixedjitterbuf_8c-source.html#l00181">181</a> of file <a class="el" href="fixedjitterbuf_8c-source.html">fixedjitterbuf.c</a>.
<p>
References <a class="el" href="fixedjitterbuf_8c-source.html#l00058">fixed_jb::force_resynch</a>.
<p>
Referenced by <a class="el" href="abstract__jb_8c-source.html#l00693">jb_force_resynch_fixed()</a>.<div class="fragment"><pre class="fragment"><a name="l00182"></a>00182 {
<a name="l00183"></a>00183    jb-&gt;<a class="code" href="structfixed__jb.html#4c195aabe34d1d57d9948d227f4903a7">force_resynch</a> = 1;
<a name="l00184"></a>00184 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Thu May 24 22:27:29 2007 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.5 </small></address>
</body>
</html>
