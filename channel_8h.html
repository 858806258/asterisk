<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (24 May 2007)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Thu May 24 22:27:23 2007</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir__2Fusr_2Flocal_2Fsrc_2Fasterisk_2Esvn_2Fastum_2Finclude_2F.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir__2Fusr_2Flocal_2Fsrc_2Fasterisk_2Esvn_2Fastum_2Finclude_2Fasterisk_2F.html">asterisk</a></div>
<h1>channel.h File Reference</h1>General Asterisk PBX channel definitions. <a href="#_details">More...</a>
<p>
<code>#include &quot;<a class="el" href="abstract__jb_8h-source.html">asterisk/abstract_jb.h</a>&quot;</code><br>
<code>#include &lt;unistd.h&gt;</code><br>
<code>#include &lt;sys/poll.h&gt;</code><br>
<code>#include &quot;<a class="el" href="compat_8h-source.html">asterisk/compat.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="frame_8h-source.html">asterisk/frame.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="sched_8h-source.html">asterisk/sched.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="chanvars_8h-source.html">asterisk/chanvars.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="config_8h-source.html">asterisk/config.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="lock_8h-source.html">asterisk/lock.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="cdr_8h-source.html">asterisk/cdr.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="utils_8h-source.html">asterisk/utils.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="linkedlists_8h-source.html">asterisk/linkedlists.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="stringfields_8h-source.html">asterisk/stringfields.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="compiler_8h-source.html">asterisk/compiler.h</a>&quot;</code><br>
<code>#include &lt;limits.h&gt;</code><br>

<p>
<a href="channel_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__bridge__config.html">ast_bridge_config</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">bridge configuration  <a href="structast__bridge__config.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__callerid.html">ast_callerid</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Structure for all kinds of caller ID identifications.  <a href="structast__callerid.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__channel.html">ast_channel</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Main Channel structure associated with a channel. This is the side of it mostly used by the pbx and call management.  <a href="structast__channel.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__channel__tech.html">ast_channel_tech</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Structure to describe a channel "technology", ie a channel driver See for examples:.  <a href="structast__channel__tech.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__datastore.html">ast_datastore</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Structure for a channel data store.  <a href="structast__datastore.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__datastore__info.html">ast_datastore_info</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Structure for a data store type.  <a href="structast__datastore__info.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__generator.html">ast_generator</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structoutgoing__helper.html">outgoing_helper</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#8b3a01b9f14c8af2a13dd2018f9beeac">AST_AGENT_FD</a>&nbsp;&nbsp;&nbsp;(AST_MAX_FDS-3)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#187908de5f942fe7f493a6b9b5dacfc4">AST_ALERT_FD</a>&nbsp;&nbsp;&nbsp;(AST_MAX_FDS-1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#8681ed1fe1fa7446abae5740777a5778">AST_BRIDGE_DTMF_CHANNEL_0</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Report DTMF on channel 0.  <a href="#8681ed1fe1fa7446abae5740777a5778"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#2919689ff25adb292a33ffc670ff5663">AST_BRIDGE_DTMF_CHANNEL_1</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 1)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Report DTMF on channel 1.  <a href="#2919689ff25adb292a33ffc670ff5663"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#8aeaf48a8524e827ce2842ee5e5aa8e8">AST_BRIDGE_IGNORE_SIGS</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 4)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Ignore all signal frames except NULL.  <a href="#8aeaf48a8524e827ce2842ee5e5aa8e8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#fa04b08a718273a286c8d92d9a20127d">AST_BRIDGE_REC_CHANNEL_0</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 2)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return all voice frames on channel 0.  <a href="#fa04b08a718273a286c8d92d9a20127d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#aec0971b94a79ea1fbb41a2e5f8b3fca">AST_BRIDGE_REC_CHANNEL_1</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 3)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return all voice frames on channel 1.  <a href="#aec0971b94a79ea1fbb41a2e5f8b3fca"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#57fb43d64b209037cdc198f3db578d39">AST_CHANNEL_NAME</a>&nbsp;&nbsp;&nbsp;80</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#eba2b7656ee8c07b3f916e990b567b02">AST_GENERATOR_FD</a>&nbsp;&nbsp;&nbsp;(AST_MAX_FDS-4)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#4d1ee7076af5032452aaba4ead082588">AST_MAX_CONTEXT</a>&nbsp;&nbsp;&nbsp;80</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#729d25558b5b1940c1a6ff9d806f944c">AST_MAX_EXTENSION</a>&nbsp;&nbsp;&nbsp;80</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#83204f17b88e7752d76b1a751a501a65">AST_MAX_FDS</a>&nbsp;&nbsp;&nbsp;10</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#0db74b98fb7363645274b7b92a5741f2">AST_TIMING_FD</a>&nbsp;&nbsp;&nbsp;(AST_MAX_FDS-2)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#722e76a74a7a5f5eb3efcd3cf30e7772">CHECK_BLOCKING</a>(c)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#cef2f26f7da88da7db20faa12bd436c4">CRASH</a>&nbsp;&nbsp;&nbsp;do { } while(0)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#c6e71954f351d74faf8285b775ed08af">DATASTORE_INHERIT_FOREVER</a>&nbsp;&nbsp;&nbsp;INT_MAX</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#121c28674a9262e968ca5860c9f3e511">DEBUGCHAN_FLAG</a>&nbsp;&nbsp;&nbsp;0x80000000</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#b6dc83815263d1b5a94deeee2f90ef5e">FRAMECOUNT_INC</a>(x)&nbsp;&nbsp;&nbsp;( ((x) &amp; DEBUGCHAN_FLAG) | (((x)+1) &amp; ~DEBUGCHAN_FLAG) )</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#e58be8e458052ab77a64bd7d449d0461">MAX_LANGUAGE</a>&nbsp;&nbsp;&nbsp;20</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#7c3359b925cb4caf244a7f0e7d553b13">MAX_MUSICCLASS</a>&nbsp;&nbsp;&nbsp;80</td></tr>

<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef unsigned long long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#f46fa02de8676dd1b9163c5dd428e610">ast_group_t</a></td></tr>

<tr><td colspan="2"><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="channel_8h.html#dca29a1140aadadfd92b34a02fa516efe7ae5478ca756cfa996e94241fbbc3b2">AST_CHAN_TP_WANTSJITTER</a> =  (1 &lt;&lt; 0), 
<a class="el" href="channel_8h.html#dca29a1140aadadfd92b34a02fa516ef00a93b525e73f48b2060014487b2b98c">AST_CHAN_TP_CREATESJITTER</a> =  (1 &lt;&lt; 1)
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="structast__channel__tech.html">ast_channel_tech</a> Properties  <a href="channel_8h.html#dca29a1140aadadfd92b34a02fa516ef">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <br>
&nbsp;&nbsp;<a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730023cf26f45cc26e3a993f7dc09b130f33">AST_FLAG_DEFER_DTMF</a> =  (1 &lt;&lt; 1), 
<a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730015fb5a488ff560040b677433b270fb5e">AST_FLAG_WRITE_INT</a> =  (1 &lt;&lt; 2), 
<a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a> =  (1 &lt;&lt; 3), 
<a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a> =  (1 &lt;&lt; 4), 
<br>
&nbsp;&nbsp;<a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300e16a5c3eb4b46399b147040658306ff5">AST_FLAG_EXCEPTION</a> =  (1 &lt;&lt; 5), 
<a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300613f868823a3ed1b5e95b733bb7354c4">AST_FLAG_MOH</a> =  (1 &lt;&lt; 6), 
<a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b51f1a5a94e370c4e7300d425a8684e">AST_FLAG_SPYING</a> =  (1 &lt;&lt; 7), 
<a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300b38fcf240d912cfa60d488dea99cab31">AST_FLAG_NBRIDGE</a> =  (1 &lt;&lt; 8), 
<br>
&nbsp;&nbsp;<a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73002122d39475941a27a292dfd49534d079">AST_FLAG_IN_AUTOLOOP</a> =  (1 &lt;&lt; 9), 
<a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73007a1bed17a368c12201a64ef3122bf6f6">AST_FLAG_OUTGOING</a> =  (1 &lt;&lt; 10), 
<a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730059fb89e0dc785928def8b9daa1a2d316">AST_FLAG_WHISPER</a> =  (1 &lt;&lt; 11), 
<a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300a63f30ad9ccc9888e23f0d887864fe03">AST_FLAG_IN_DTMF</a> =  (1 &lt;&lt; 12), 
<br>
&nbsp;&nbsp;<a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300f97b9e8c75156f109b64547f27eb8034">AST_FLAG_EMULATE_DTMF</a> =  (1 &lt;&lt; 13), 
<a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73000ecdf5f8a5869727e38bf9e1ca5a6cae">AST_FLAG_END_DTMF_ONLY</a> =  (1 &lt;&lt; 14)
<br>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="structast__channel.html">ast_channel</a> flags  <a href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <br>
&nbsp;&nbsp;<a class="el" href="channel_8h.html#02653d87b6fa8554fc0d1a3726fea2d04040ce118987e724063d0b58eafd9b4f">AST_FEATURE_PLAY_WARNING</a> =  (1 &lt;&lt; 0), 
<a class="el" href="channel_8h.html#02653d87b6fa8554fc0d1a3726fea2d06d1225b2615ed409be56bda96c5b71b9">AST_FEATURE_REDIRECT</a> =  (1 &lt;&lt; 1), 
<a class="el" href="channel_8h.html#02653d87b6fa8554fc0d1a3726fea2d04e55f4f77a24039b6ade9954efba0493">AST_FEATURE_DISCONNECT</a> =  (1 &lt;&lt; 2), 
<a class="el" href="channel_8h.html#02653d87b6fa8554fc0d1a3726fea2d09e4ef5f62675d335054d6f0ae302c307">AST_FEATURE_ATXFER</a> =  (1 &lt;&lt; 3), 
<br>
&nbsp;&nbsp;<a class="el" href="channel_8h.html#02653d87b6fa8554fc0d1a3726fea2d0f9a5c8452526c77703890c2cb6784eb6">AST_FEATURE_AUTOMON</a> =  (1 &lt;&lt; 4), 
<a class="el" href="channel_8h.html#02653d87b6fa8554fc0d1a3726fea2d0bc5c3869d149426e287f8f773f8d3f38">AST_FEATURE_PARKCALL</a> =  (1 &lt;&lt; 5)
<br>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="structast__bridge__config.html">ast_bridge_config</a> flags  <a href="channel_8h.html#02653d87b6fa8554fc0d1a3726fea2d0">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="channel_8h.html#1378d7d8767899287b0407055215aa4e67d5814f1a69234da1d6becf767eca14">AST_CDR_TRANSFER</a> =  (1 &lt;&lt; 0), 
<a class="el" href="channel_8h.html#1378d7d8767899287b0407055215aa4e89f0c3bfba1428a3616951be71239ef9">AST_CDR_FORWARD</a> =  (1 &lt;&lt; 1), 
<a class="el" href="channel_8h.html#1378d7d8767899287b0407055215aa4ed46cbd6986389a7008e5cfe9164e303a">AST_CDR_CALLWAIT</a> =  (1 &lt;&lt; 2), 
<a class="el" href="channel_8h.html#1378d7d8767899287b0407055215aa4e8a2e750258ff86fe8700916b551e8d59">AST_CDR_CONFERENCE</a> =  (1 &lt;&lt; 3)
 }</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <br>
&nbsp;&nbsp;<a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1cbe3f9a2385d6a31eac6abced2a9f17d">AST_SOFTHANGUP_DEV</a> =  (1 &lt;&lt; 0), 
<a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a179c1afce6cda266617f47d63393c2d71">AST_SOFTHANGUP_ASYNCGOTO</a> =  (1 &lt;&lt; 1), 
<a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1e415ee9181158293f7c3d3cd1a98f4ee">AST_SOFTHANGUP_SHUTDOWN</a> =  (1 &lt;&lt; 2), 
<a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a12709ffb7179ec4c9b3ba505519ddc84e">AST_SOFTHANGUP_TIMEOUT</a> =  (1 &lt;&lt; 3), 
<br>
&nbsp;&nbsp;<a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1a605d712c745c736f14ef4e8bfd59245">AST_SOFTHANGUP_APPUNLOAD</a> =  (1 &lt;&lt; 4), 
<a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1fe8eae384d045bee039ff9140421beb8">AST_SOFTHANGUP_EXPLICIT</a> =  (1 &lt;&lt; 5), 
<a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1f3fe293730d3200b678a1daaa67ea5c5">AST_SOFTHANGUP_UNBRIDGE</a> =  (1 &lt;&lt; 6)
<br>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#8bba128582c81d1af777c11278bd4d19">ast_bridge_result</a> { <a class="el" href="channel_8h.html#8bba128582c81d1af777c11278bd4d19fd37b17491849eb3a8d0cd996d69fe1f">AST_BRIDGE_COMPLETE</a> =  0, 
<a class="el" href="channel_8h.html#8bba128582c81d1af777c11278bd4d198b00ec8ed330d763fd4f579d7c513d1d">AST_BRIDGE_FAILED</a> =  -1, 
<a class="el" href="channel_8h.html#8bba128582c81d1af777c11278bd4d19c05a72efa9f8f1c8ebcfaf8e6fe97524">AST_BRIDGE_FAILED_NOWARN</a> =  -2, 
<a class="el" href="channel_8h.html#8bba128582c81d1af777c11278bd4d19ebe331af24cd5342764adc6f1b59fbec">AST_BRIDGE_RETRY</a> =  -3
 }</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#b0b0e02362739df53c5a11797f118a6d">ast_channel_adsicpe</a> { <a class="el" href="channel_8h.html#b0b0e02362739df53c5a11797f118a6d6a7552ab39e56e9786f9b2adbb63fc23">AST_ADSI_UNKNOWN</a>, 
<a class="el" href="channel_8h.html#b0b0e02362739df53c5a11797f118a6df141c289f651b61ee5a5bc0e3511f4c7">AST_ADSI_AVAILABLE</a>, 
<a class="el" href="channel_8h.html#b0b0e02362739df53c5a11797f118a6db29a58956d5f95b2dc9aedd6dea41b54">AST_ADSI_UNAVAILABLE</a>, 
<a class="el" href="channel_8h.html#b0b0e02362739df53c5a11797f118a6d6d363e92a37e969828525f5b5cdee041">AST_ADSI_OFFHOOKONLY</a>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a">ast_channel_state</a> { <br>
&nbsp;&nbsp;<a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a3c9bf8b90a4d4f25fc98dd1360bba58b">AST_STATE_DOWN</a>, 
<a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a75a7d9c79e4a7c2732015d1c68908536">AST_STATE_RESERVED</a>, 
<a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a71b2dab052b5015d49144d52cf580735">AST_STATE_OFFHOOK</a>, 
<a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a4f25236a25abffd53bda3ef97e96296f">AST_STATE_DIALING</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a0789c8ad2fe8eda2081eb587a0bfbe42">AST_STATE_RING</a>, 
<a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a85da5b3ea10583d638bc7ce8fe638ec2">AST_STATE_RINGING</a>, 
<a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>, 
<a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a2081397aa15f6ea9b289237043aa1d1b">AST_STATE_BUSY</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87ae69544c47419fa57cd20045b09aa5b40">AST_STATE_DIALING_OFFHOOK</a>, 
<a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a0c8ef65931fb09184de67c7484cbbf47">AST_STATE_PRERING</a>, 
<a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a86863733f407b703a3db65389e43964e">AST_STATE_MUTE</a> =  (1 &lt;&lt; 16)
<br>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="structast__channel.html">ast_channel</a> states  <a href="channel_8h.html#c04acac682ff0cff5eda96378318b87a">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#a49c7ae4d656ef2e220ceae47cb045f2">channelreloadreason</a> { <a class="el" href="channel_8h.html#a49c7ae4d656ef2e220ceae47cb045f2704c328f9fec2df0f273fc084c46bb5c">CHANNEL_MODULE_LOAD</a>, 
<a class="el" href="channel_8h.html#a49c7ae4d656ef2e220ceae47cb045f2a6546d2270d01e15c994b899c015a868">CHANNEL_MODULE_RELOAD</a>, 
<a class="el" href="channel_8h.html#a49c7ae4d656ef2e220ceae47cb045f2950ce6983714a51f62494c5b16daf99d">CHANNEL_CLI_RELOAD</a>, 
<a class="el" href="channel_8h.html#a49c7ae4d656ef2e220ceae47cb045f2ea514ee42bff74ab8030f1b4b39181f9">CHANNEL_MANAGER_RELOAD</a>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Channel reload reasons for manager events at load or reload of configuration.  <a href="channel_8h.html#a49c7ae4d656ef2e220ceae47cb045f2">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#71deef3d79d1ff4755afdf2b2cfffdda">__ast_answer</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, unsigned int delay)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#84fcc4e022cb699f8f14c9f3aaeadd2b">__ast_request_and_dial</a> (const char *<a class="el" href="chan__nbs_8c.html#a73364531569a868150462e5a44f29c8">type</a>, int <a class="el" href="cdr__custom_8c.html#b954976e6264c40232046aacb5b7c390">format</a>, void *data, int timeout, int *reason, const char *cidnum, const char *cidname, struct <a class="el" href="structoutgoing__helper.html">outgoing_helper</a> *oh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#51350b9fba7a6a2428e1b3a13a131d54">ast_activate_generator</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, struct <a class="el" href="structast__generator.html">ast_generator</a> *<a class="el" href="app__externalivr_8c.html#daffed346e29c5654f54133d1fc65ccb">gen</a>, void *params)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#126867ace3f9eaaf4d1cf954f5907451">ast_active_channels</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">returns number of active/allocated channels  <a href="#126867ace3f9eaaf4d1cf954f5907451"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#ac55a99c346024715138883ba689718c">ast_add_fd</a> (struct <a class="el" href="structpollfd.html">pollfd</a> *pfd, int fd)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">if fd is a valid descriptor, set *pfd with the descriptor  <a href="#ac55a99c346024715138883ba689718c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#9e089c979b071a1df466a09497fdfa31">ast_answer</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Answer a channel.  <a href="#9e089c979b071a1df466a09497fdfa31"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#50d164d68da7c101dd0eadd519069afd">ast_autoservice_start</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Automatically service a channel for us...  <a href="#50d164d68da7c101dd0eadd519069afd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#f982194640c676dffb9052dacb2b21fd">ast_autoservice_stop</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stop servicing a channel for us...  <a href="#f982194640c676dffb9052dacb2b21fd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#a19b056dcfc49b0b46dd14462379314d">ast_begin_shutdown</a> (int hangup)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initiate system shutdown.  <a href="#a19b056dcfc49b0b46dd14462379314d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#8aa2203afc4fb127e46d5be40718dc13">ast_best_codec</a> (int fmts)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pick the best audio codec.  <a href="#8aa2203afc4fb127e46d5be40718dc13"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#8f80b59690710acfe4fc82cfcbbf9ee9">ast_bridged_channel</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find bridged channel.  <a href="#8f80b59690710acfe4fc82cfcbbf9ee9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#37e2b9b65c43c783c6b43552cd20b438">ast_call</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, char *addr, int timeout)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Make a call.  <a href="#37e2b9b65c43c783c6b43552cd20b438"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#1e8559a1ce1e9b3a1bc50aaf1013e429">ast_cancel_shutdown</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Cancel a shutdown in progress.  <a href="#1e8559a1ce1e9b3a1bc50aaf1013e429"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#b60af18c86af040d2efe4529056c8501">ast_cause2str</a> (int <a class="el" href="structstate.html">state</a>) attribute_pure</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gives the string form of a given hangup cause.  <a href="#b60af18c86af040d2efe4529056c8501"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#897cb5bfee52c4e4dbed64b003828811">ast_change_name</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, char *newname)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Change channel name.  <a href="#897cb5bfee52c4e4dbed64b003828811"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#3e12df96f6a8fc8b7293ad03b29c729f">ast_channel_alloc</a> (int needqueue, int <a class="el" href="structstate.html">state</a>, const char *<a class="el" href="chan__skinny_8c.html#ca3c0eb6b6e898f3a32aed5de1320774">cid_num</a>, const char *<a class="el" href="chan__skinny_8c.html#70f178a59d8df82fe5e107da71415b9b">cid_name</a>, const char *acctcode, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const int amaflag, const char *name_fmt,...)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a channel structure.  <a href="#3e12df96f6a8fc8b7293ad03b29c729f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#63ab4d8e95fedaabf03d0f492368e930">ast_channel_bridge</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c0, struct <a class="el" href="structast__channel.html">ast_channel</a> *c1, struct <a class="el" href="structast__bridge__config.html">ast_bridge_config</a> *<a class="el" href="res__indications_8c.html#71d63bae4fa3507f57ae4e35f6de4c63">config</a>, struct <a class="el" href="structast__frame.html">ast_frame</a> **fo, struct <a class="el" href="structast__channel.html">ast_channel</a> **rc)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Bridge two channels together.  <a href="#63ab4d8e95fedaabf03d0f492368e930"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#49102d6d12a437bf6928bc9916194549">ast_channel_cmpwhentohangup</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, time_t <a class="el" href="chan__alsa_8c.html#7a86c157ee9713c34fbd7a1ee40f0c5a">offset</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compare a offset with the settings of when to hang a channel up.  <a href="#49102d6d12a437bf6928bc9916194549"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#cbc50cd4e716fe4486cf2dc81222e30e">ast_channel_datastore_add</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, struct <a class="el" href="structast__datastore.html">ast_datastore</a> *datastore)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a datastore to a channel.  <a href="#cbc50cd4e716fe4486cf2dc81222e30e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__datastore.html">ast_datastore</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#5a56e43ad0ea2cecbf51410e82ea7455">ast_channel_datastore_alloc</a> (const struct <a class="el" href="structast__datastore__info.html">ast_datastore_info</a> *info, char *uid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a channel datastore structure.  <a href="#5a56e43ad0ea2cecbf51410e82ea7455"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__datastore.html">ast_datastore</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#a139501a58997c4f147764f1df0dccdd">ast_channel_datastore_find</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const struct <a class="el" href="structast__datastore__info.html">ast_datastore_info</a> *info, char *uid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find a datastore on a channel.  <a href="#a139501a58997c4f147764f1df0dccdd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#9b22e546aca18fcd4e4f512843f608c5">ast_channel_datastore_free</a> (struct <a class="el" href="structast__datastore.html">ast_datastore</a> *datastore)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free a channel datastore structure.  <a href="#9b22e546aca18fcd4e4f512843f608c5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#7ccb0875d5b63754a9c968f5dbb92d99">ast_channel_datastore_inherit</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *from, struct <a class="el" href="structast__channel.html">ast_channel</a> *to)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Inherit datastores from a parent to a child.  <a href="#7ccb0875d5b63754a9c968f5dbb92d99"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#2703596e193d96ac5e31ee1f0f3ef4ce">ast_channel_datastore_remove</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, struct <a class="el" href="structast__datastore.html">ast_datastore</a> *datastore)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove a datastore from a channel.  <a href="#2703596e193d96ac5e31ee1f0f3ef4ce"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#c96b0dddc19825d46cc8a62ae92085ab">ast_channel_defer_dtmf</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set defer DTMF flag on channel.  <a href="#c96b0dddc19825d46cc8a62ae92085ab"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#4d00d0fe6e56604455705983fd7eb828">ast_channel_early_bridge</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c0, struct <a class="el" href="structast__channel.html">ast_channel</a> *c1)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Bridge two channels together (early).  <a href="#4d00d0fe6e56604455705983fd7eb828"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#b5c070531d4d02ac1e0e2b8aeaf6687e">ast_channel_free</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free a channel structure.  <a href="#b5c070531d4d02ac1e0e2b8aeaf6687e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#8fb30ace7afdc2899f9b9cdafbf49ff7">ast_channel_inherit_variables</a> (const struct <a class="el" href="structast__channel.html">ast_channel</a> *parent, struct <a class="el" href="structast__channel.html">ast_channel</a> *child)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Inherits channel variable from parent to child channel.  <a href="#8fb30ace7afdc2899f9b9cdafbf49ff7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#7481b2c2ff025b987fb82ae18bb8389e">ast_channel_make_compatible</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c0, struct <a class="el" href="structast__channel.html">ast_channel</a> *c1)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Makes two channel formats compatible.  <a href="#7481b2c2ff025b987fb82ae18bb8389e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#8e30c09190bd2388188cd8bab35ba595">ast_channel_masquerade</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *original, struct <a class="el" href="structast__channel.html">ast_channel</a> *clone)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Weird function made for call transfers.  <a href="#8e30c09190bd2388188cd8bab35ba595"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#21079feca37bb062d35f1a6f04916757">ast_channel_queryoption</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *channel, int option, void *data, int *datalen, int block)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#1187446bddf5734a294a3ca0598584df">ast_channel_register</a> (const struct <a class="el" href="structast__channel__tech.html">ast_channel_tech</a> *tech)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Register a channel technology (a new channel driver) Called by a channel module to register the kind of channels it supports.  <a href="#1187446bddf5734a294a3ca0598584df"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#0f66478027b42c17d2be4906671da404">ast_channel_sendhtml</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *channel, int subclass, const char *data, int datalen)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#3833447fb6c948c99cd67de25c565179">ast_channel_sendurl</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *channel, const char *url)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#8455f544c874bf1316d542cec38a2ab9">ast_channel_setoption</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *channel, int option, void *data, int datalen, int block)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets an option on a channel.  <a href="#8455f544c874bf1316d542cec38a2ab9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#a572798172ac3e5c4a518e6c247da125">ast_channel_setwhentohangup</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, time_t <a class="el" href="chan__alsa_8c.html#7a86c157ee9713c34fbd7a1ee40f0c5a">offset</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set when to hang a channel up.  <a href="#a572798172ac3e5c4a518e6c247da125"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__silence__generator.html">ast_silence_generator</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#df0067eebc6d6ba27b24f955cd779a7f">ast_channel_start_silence_generator</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Starts a silence generator on the given channel.  <a href="#df0067eebc6d6ba27b24f955cd779a7f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#925b5f1e2127332abaf35b5106ca9df4">ast_channel_stop_silence_generator</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, struct <a class="el" href="structast__silence__generator.html">ast_silence_generator</a> *<a class="el" href="structstate.html">state</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stops a previously-started silence generator on the given channel.  <a href="#925b5f1e2127332abaf35b5106ca9df4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#3c70e41f9d8d7f139a047a5c0db514b6">ast_channel_supports_html</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *channel)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#f73f024d0d929e70569cec47b297ee68">ast_channel_undefer_dtmf</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unset defer DTMF flag on channel.  <a href="#f73f024d0d929e70569cec47b297ee68"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#f47e36ee9d2beb6eee7be098c604caea">ast_channel_unregister</a> (const struct <a class="el" href="structast__channel__tech.html">ast_channel_tech</a> *tech)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unregister a channel technology.  <a href="#f47e36ee9d2beb6eee7be098c604caea"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#8ada12445e0d71c8bcd465f6838bf4e5">ast_channel_walk_locked</a> (const struct <a class="el" href="structast__channel.html">ast_channel</a> *prev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Browse channels in use Browse the channels currently in use.  <a href="#8ada12445e0d71c8bcd465f6838bf4e5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#c45fab3584a74234dc1c9662ba76e8f1">ast_channel_whisper_feed</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, struct <a class="el" href="structast__frame.html">ast_frame</a> *<a class="el" href="format__g726_8c.html#85b9b17a7dd34a3638c560bc9152473b">f</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Feed an audio frame into the whisper buffer on a channel.  <a href="#c45fab3584a74234dc1c9662ba76e8f1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#eadc89eb057511322a2aebad4074df6a">ast_channel_whisper_start</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Begin 'whispering' onto a channel.  <a href="#eadc89eb057511322a2aebad4074df6a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#79598f580fc373516b4489bc5ebb7b02">ast_channel_whisper_stop</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stop 'whispering' onto a channel.  <a href="#79598f580fc373516b4489bc5ebb7b02"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__variable.html">ast_variable</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#267d0942d73ed05c65b6702fd3d0f2e0">ast_channeltype_list</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">return an <a class="el" href="structast__variable.html">ast_variable</a> list of channeltypes  <a href="#267d0942d73ed05c65b6702fd3d0f2e0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#042e64a8d465783855a52ec8c56a9373">ast_check_hangup</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check to see if a channel is needing hang up.  <a href="#042e64a8d465783855a52ec8c56a9373"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#e4e0e5c1767576b38fb1a893dfd8cb2b">ast_deactivate_generator</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#1f4ea7c056969bf5b3f718be85b5f703">ast_do_masquerade</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Start masquerading a channel XXX This is a seriously whacked out operation. We're essentially putting the guts of the clone channel into the original channel. Start by killing off the original channel's backend. I'm not sure we're going to keep this function, because while the features are nice, the cost is very high in terms of pure nastiness. XXX.  <a href="#1f4ea7c056969bf5b3f718be85b5f703"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#5c4fc82db1ad1481b2bab0a7c393d53d">ast_fdisset</a> (struct <a class="el" href="structpollfd.html">pollfd</a> *pfds, int fd, int max, int *start)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Helper function for migrating select to poll.  <a href="#5c4fc82db1ad1481b2bab0a7c393d53d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#20c0f06f47ac708677674d6fe2007cc9">ast_get_channel_by_exten_locked</a> (const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get channel by exten (and optionally context) and lock it.  <a href="#20c0f06f47ac708677674d6fe2007cc9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#5bb2284c9cf122c444b25bbabaf3af97">ast_get_channel_by_name_locked</a> (const char *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get channel by name (locks channel).  <a href="#5bb2284c9cf122c444b25bbabaf3af97"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#73dcef78b8c7fc8cb85dde3ee0058c57">ast_get_channel_by_name_prefix_locked</a> (const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, const int namelen)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get channel by name prefix (locks channel).  <a href="#73dcef78b8c7fc8cb85dde3ee0058c57"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const struct <a class="el" href="structast__channel__tech.html">ast_channel_tech</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#3a695cf963066b80546be9da976d27c8">ast_get_channel_tech</a> (const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a channel technology structure by name.  <a href="#3a695cf963066b80546be9da976d27c8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="channel_8h.html#f46fa02de8676dd1b9163c5dd428e610">ast_group_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#3afd78a60ecfe19f643ed5124981a023">ast_get_group</a> (const char *s)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Hang up a channel.  <a href="#ff55e854df5692f9b3b8dc64c95a5619"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#90b88ba4c6f05bc0b655583c899c0269">ast_indicate</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, int condition)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Indicates condition of channel.  <a href="#90b88ba4c6f05bc0b655583c899c0269"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#f1b18b170d0068311ca47c2e0d0ede5c">ast_indicate_data</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, int condition, const void *data, size_t datalen)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Indicates condition of channel, with payload.  <a href="#f1b18b170d0068311ca47c2e0d0ede5c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#73d63296a76525785cf9f1f379e1d6b4">ast_internal_timing_enabled</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check if the channel can run in internal timing mode.  <a href="#73d63296a76525785cf9f1f379e1d6b4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#68e3e84e623c83dd308276466ccf7a35">ast_print_group</a> (char *<a class="el" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>, int buflen, <a class="el" href="channel_8h.html#f46fa02de8676dd1b9163c5dd428e610">ast_group_t</a> <a class="el" href="chan__agent_8c.html#db0f6f37ebeb6ea09489124345af2a45">group</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">print call- and pickup groups into buffer  <a href="#68e3e84e623c83dd308276466ccf7a35"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#1e5a4ef714eb64bfdc55813ba363bd67">ast_prod</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send empty audio to prime a channel driver.  <a href="#1e5a4ef714eb64bfdc55813ba363bd67"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#9c10dd50747025f5100adeb1da23c2e1">ast_queue_control</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, enum <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389">ast_control_frame_type</a> control)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Queue a control frame with payload.  <a href="#9c10dd50747025f5100adeb1da23c2e1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#3336b8cfda88155ef5378ba728bef5c8">ast_queue_control_data</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, enum <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389">ast_control_frame_type</a> control, const void *data, size_t datalen)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Queue a control frame with payload.  <a href="#3336b8cfda88155ef5378ba728bef5c8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#d16a30a5843812777450bd333f0ce589">ast_queue_frame</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, struct <a class="el" href="structast__frame.html">ast_frame</a> *<a class="el" href="format__g726_8c.html#85b9b17a7dd34a3638c560bc9152473b">f</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Queue an outgoing frame.  <a href="#d16a30a5843812777450bd333f0ce589"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#61f0a289387829da5c568c664f85e01c">ast_queue_hangup</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Queue a hangup frame.  <a href="#61f0a289387829da5c568c664f85e01c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#1446a8c0bddf626bf26b000fbeae117f">ast_read</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reads a frame.  <a href="#1446a8c0bddf626bf26b000fbeae117f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#ee2f7baed67b1012d314a42203fca91c">ast_read_noaudio</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reads a frame, returning AST_FRAME_NULL frame if audio.  <a href="#ee2f7baed67b1012d314a42203fca91c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#9b1cd169a6bd0641ef663976f0dc20c2">ast_readstring</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, char *s, int len, int timeout, int rtimeout, char *enders)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#92e6bac85bd90ccfe326aad8232894a5">ast_readstring_full</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, char *s, int len, int timeout, int rtimeout, char *enders, int audiofd, int ctrlfd)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#36dd07166fc2565f54fc5e7350b2fbe7">ast_recvchar</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, int timeout)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Receives a text character from a channel.  <a href="#36dd07166fc2565f54fc5e7350b2fbe7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#985b0a0ce0ab536a6d9a1f88f55ace1a">ast_recvtext</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, int timeout)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Receives a text string from a channel Read a string of text from a channel.  <a href="#985b0a0ce0ab536a6d9a1f88f55ace1a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#18fe0a44ab0842c23ceb444817baecd7">ast_request</a> (const char *<a class="el" href="chan__nbs_8c.html#a73364531569a868150462e5a44f29c8">type</a>, int <a class="el" href="cdr__custom_8c.html#b954976e6264c40232046aacb5b7c390">format</a>, void *data, int *status)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Requests a channel.  <a href="#18fe0a44ab0842c23ceb444817baecd7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#951f5f530d12c122c81bf1be5f69ba58">ast_request_and_dial</a> (const char *<a class="el" href="chan__nbs_8c.html#a73364531569a868150462e5a44f29c8">type</a>, int <a class="el" href="cdr__custom_8c.html#b954976e6264c40232046aacb5b7c390">format</a>, void *data, int timeout, int *reason, const char *cidnum, const char *cidname)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Request a channel of a given type, with data as optional information used by the low level module and attempt to place a call on it.  <a href="#951f5f530d12c122c81bf1be5f69ba58"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#24a36b04429e3cdef17e161363c13900">ast_safe_sleep</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, int ms)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Wait for a specified amount of time, looking for hangups.  <a href="#24a36b04429e3cdef17e161363c13900"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#2f6cb4adec26f68897163438dc02f2c7">ast_safe_sleep_conditional</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, int ms, int(*<a class="el" href="app__queue_8c.html#26542fb18a8b14c9775aa475f23c909f">cond</a>)(void *), void *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Wait for a specified amount of time, looking for hangups and a condition argument.  <a href="#2f6cb4adec26f68897163438dc02f2c7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#d611a8ad6ce8c46f46f564095af0f264">ast_select</a> (int nfds, fd_set *rfds, fd_set *wfds, fd_set *efds, struct timeval *tvp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Waits for activity on a group of channels.  <a href="#d611a8ad6ce8c46f46f564095af0f264"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#2f720daf878ec71dc8eed814c5128fe1">ast_senddigit</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, char digit)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send a DTMF digit to a channel Send a DTMF digit to a channel.  <a href="#2f720daf878ec71dc8eed814c5128fe1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#2fef33f939432bce542a9ccb28145652">ast_senddigit_begin</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, char digit)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send a DTMF digit to a channel Send a DTMF digit to a channel.  <a href="#2fef33f939432bce542a9ccb28145652"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#90ad873bd7f75ca212db0ab089def9f6">ast_senddigit_end</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, char digit, unsigned int duration)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send a DTMF digit to a channel.  <a href="#90ad873bd7f75ca212db0ab089def9f6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#3274faaaeb7a5646df6beead26f9ce8f">ast_sendtext</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="app__queue_8c.html#1cb251ec0d568de6a929b520c4aed8d1">text</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends text to a channel Write text to a display on a channel.  <a href="#3274faaaeb7a5646df6beead26f9ce8f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#2a53bdcc725eb9e81eb4a666ff695873">ast_set_callerid</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *cidnum, const char *cidname, const char *ani)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#b1aa4e7fc4d8ab22cc83a6b164851c56">ast_set_read_format</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, int <a class="el" href="cdr__custom_8c.html#b954976e6264c40232046aacb5b7c390">format</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets read format on channel chan Set read format for channel to whichever component of "format" is best.  <a href="#b1aa4e7fc4d8ab22cc83a6b164851c56"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#ee674fb53b907cc57dda6e54ac24a637">ast_set_variables</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, struct <a class="el" href="structast__variable.html">ast_variable</a> *vars)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">adds a list of channel variables to a channel  <a href="#ee674fb53b907cc57dda6e54ac24a637"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#56370d56599555d0f1abde0d1d9685a6">ast_set_write_format</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, int <a class="el" href="cdr__custom_8c.html#b954976e6264c40232046aacb5b7c390">format</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets write format on channel chan Set write format for channel to whichever component of "format" is best.  <a href="#56370d56599555d0f1abde0d1d9685a6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#4545ff02284db8d61db9c8cf01803b95">ast_setstate</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, enum <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a">ast_channel_state</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Change the state of a channel.  <a href="#4545ff02284db8d61db9c8cf01803b95"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#031ef8a01f979ba2f40451d97a515e80">ast_settimeout</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, int samples, int(*<a class="el" href="utils_8h.html#7df4935f4a5a2865191ef74f64df8754">func</a>)(void *data), void *data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#b9bab70de71305f125a80502da266866">ast_shutting_down</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns non-zero if Asterisk is being shut down.  <a href="#b9bab70de71305f125a80502da266866"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#a1a142039194e9f6dfb632b28a0c5eb5">ast_softhangup</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, int cause)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Softly hangup up a channel.  <a href="#a1a142039194e9f6dfb632b28a0c5eb5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#c969f5294a61165c99c9b6f65ecae173">ast_softhangup_nolock</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, int cause)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Softly hangup up a channel (no channel lock).  <a href="#c969f5294a61165c99c9b6f65ecae173"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#70f0f0cc9b725f5d2e6b99dcb2c4ea73">ast_state2str</a> (enum <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a">ast_channel_state</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gives the string form of a given channel state.  <a href="#70f0f0cc9b725f5d2e6b99dcb2c4ea73"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#bd5520dfe931a76ad3bea71e03887f59">ast_str2cause</a> (const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>) attribute_pure</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert a symbolic hangup cause to number.  <a href="#bd5520dfe931a76ad3bea71e03887f59"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#ae5bd12fec5fb4b99bf70379e02ba7a5">ast_tonepair</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, int freq1, int freq2, int duration, int vol)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#df9ad031f8e78a39603595ad088b0877">ast_tonepair_start</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, int freq1, int freq2, int duration, int vol)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#547c90e9a23e85d52e4cfacbc5cb9f73">ast_tonepair_stop</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#0a6d03e8efda8ed8121bbe278e60c7ad">ast_transfer</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, char *dest)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Transfer a channel (if supported). Returns -1 on error, 0 if not supported and 1 if supported and requested.  <a href="#0a6d03e8efda8ed8121bbe278e60c7ad"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#85bf2a2910fd484add99db6bff044f97">ast_transfercapability2str</a> (int transfercapability) attribute_const</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gives the string form of a given transfer capability.  <a href="#85bf2a2910fd484add99db6bff044f97"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#cad81a17a0fa70c35b08e0c9b40f1877">ast_waitfor</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, int ms)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Wait for input on a channel.  <a href="#cad81a17a0fa70c35b08e0c9b40f1877"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#9233eec93dd9d3660844802b767036b7">ast_waitfor_n</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> **<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, int n, int *ms)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Waits for input on a group of channels Wait for input on an array of channels for a given # of milliseconds.  <a href="#9233eec93dd9d3660844802b767036b7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#7bda1d2f937087ca98166e5463740b64">ast_waitfor_n_fd</a> (int *fds, int n, int *ms, int *exception)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Waits for input on an fd This version works on fd's only. Be careful with it.  <a href="#7bda1d2f937087ca98166e5463740b64"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#2efb5d945c0350d0fa3abe4f1838d3c3">ast_waitfor_nandfds</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> **<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, int n, int *fds, int nfds, int *exception, int *outfd, int *ms)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Waits for activity on a group of channels.  <a href="#2efb5d945c0350d0fa3abe4f1838d3c3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#b02063e7425e3cfb63ba24edf8081835">ast_waitfordigit</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, int ms)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Waits for a digit.  <a href="#b02063e7425e3cfb63ba24edf8081835"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#37046471dc78265c045a341d785ae484">ast_waitfordigit_full</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, int ms, int audiofd, int ctrlfd)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Wait for a digit Same as <a class="el" href="channel_8c.html#b02063e7425e3cfb63ba24edf8081835">ast_waitfordigit()</a> with audio fd for outputting read audio and ctrlfd to monitor for reading.  <a href="#37046471dc78265c045a341d785ae484"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#76257a964ba665c0c5ff96edd1328d85">ast_walk_channel_by_exten_locked</a> (const struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get next channel by exten (and optionally context) and lock it.  <a href="#76257a964ba665c0c5ff96edd1328d85"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#1eee0e9ee6288a0786551187875a49d2">ast_walk_channel_by_name_prefix_locked</a> (const struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, const int namelen)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get channel by name prefix (locks channel).  <a href="#1eee0e9ee6288a0786551187875a49d2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#23f7af42552121e87bc52c819df4af48">ast_write</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, struct <a class="el" href="structast__frame.html">ast_frame</a> *frame)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write a frame to a channel This function writes the given frame to the indicated channel.  <a href="#23f7af42552121e87bc52c819df4af48"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#46135c3aee6b7463d4f371ee31398e8c">ast_write_text</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, struct <a class="el" href="structast__frame.html">ast_frame</a> *frame)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write text frame to a channel This function writes the given frame to the indicated channel.  <a href="#46135c3aee6b7463d4f371ee31398e8c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#cc48da89fee89a00916d78c6fb74e525">ast_write_video</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, struct <a class="el" href="structast__frame.html">ast_frame</a> *frame)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write video frame to a channel This function writes the given frame to the indicated channel.  <a href="#cc48da89fee89a00916d78c6fb74e525"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#877faf4f25816c15c87b3b95c439ce1e">channelreloadreason2txt</a> (enum <a class="el" href="channel_8h.html#a49c7ae4d656ef2e220ceae47cb045f2">channelreloadreason</a> reason)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert enum channelreloadreason to text string for manager event.  <a href="#877faf4f25816c15c87b3b95c439ce1e"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#fb1a13eb3cfac4d9cfb7c4b0d2865bde">global_fin</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="channel_8h.html#2173c5282c13757472cb6ac76d8ecdad">global_fout</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
General Asterisk PBX channel definitions. 
<p>
<dl compact><dt><b>See also:</b></dt><dd><ul>
<li><a class="el" href="Def_Channel.html">Asterisk Channels</a> </li>
<li><a class="el" href="group__channel__drivers.html">Module: Asterisk Channel Drivers</a> </li>
</ul>
</dd></dl>

<p>
Definition in file <a class="el" href="channel_8h-source.html">channel.h</a>.<hr><h2>Define Documentation</h2>
<a class="anchor" name="8b3a01b9f14c8af2a13dd2018f9beeac"></a><!-- doxytag: member="channel.h::AST_AGENT_FD" ref="8b3a01b9f14c8af2a13dd2018f9beeac" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_AGENT_FD&nbsp;&nbsp;&nbsp;(AST_MAX_FDS-3)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
used by agents for pass through 
<p>
Definition at line <a class="el" href="channel_8h-source.html#l00167">167</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.
<p>
Referenced by <a class="el" href="chan__agent_8c-source.html#l00427">agent_read()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="187908de5f942fe7f493a6b9b5dacfc4"></a><!-- doxytag: member="channel.h::AST_ALERT_FD" ref="187908de5f942fe7f493a6b9b5dacfc4" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_ALERT_FD&nbsp;&nbsp;&nbsp;(AST_MAX_FDS-1)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
used for alertpipe 
<p>
Definition at line <a class="el" href="channel_8h-source.html#l00165">165</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l00632">ast_channel_alloc()</a>, and <a class="el" href="chan__features_8c-source.html#l00165">restore_channel()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="8681ed1fe1fa7446abae5740777a5778"></a><!-- doxytag: member="channel.h::AST_BRIDGE_DTMF_CHANNEL_0" ref="8681ed1fe1fa7446abae5740777a5778" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_BRIDGE_DTMF_CHANNEL_0&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Report DTMF on channel 0. 
<p>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l01035">1035</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l03797">ast_generic_bridge()</a>, <a class="el" href="rtp_8c-source.html#l03358">ast_rtp_bridge()</a>, <a class="el" href="rtp_8c-source.html#l02909">bridge_native_loop()</a>, <a class="el" href="rtp_8c-source.html#l03195">bridge_p2p_loop()</a>, <a class="el" href="chan__iax2_8c-source.html#l03198">iax2_bridge()</a>, <a class="el" href="chan__misdn_8c-source.html#l02789">misdn_bridge()</a>, <a class="el" href="res__features_8c-source.html#l01252">set_config_flags()</a>, and <a class="el" href="chan__zap_8c-source.html#l03412">zt_bridge()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="2919689ff25adb292a33ffc670ff5663"></a><!-- doxytag: member="channel.h::AST_BRIDGE_DTMF_CHANNEL_1" ref="2919689ff25adb292a33ffc670ff5663" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_BRIDGE_DTMF_CHANNEL_1&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 1)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Report DTMF on channel 1. 
<p>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l01037">1037</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l03797">ast_generic_bridge()</a>, <a class="el" href="rtp_8c-source.html#l03358">ast_rtp_bridge()</a>, <a class="el" href="rtp_8c-source.html#l02909">bridge_native_loop()</a>, <a class="el" href="rtp_8c-source.html#l03195">bridge_p2p_loop()</a>, <a class="el" href="chan__iax2_8c-source.html#l03198">iax2_bridge()</a>, <a class="el" href="chan__misdn_8c-source.html#l02789">misdn_bridge()</a>, <a class="el" href="res__features_8c-source.html#l01252">set_config_flags()</a>, and <a class="el" href="chan__zap_8c-source.html#l03412">zt_bridge()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="8aeaf48a8524e827ce2842ee5e5aa8e8"></a><!-- doxytag: member="channel.h::AST_BRIDGE_IGNORE_SIGS" ref="8aeaf48a8524e827ce2842ee5e5aa8e8" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_BRIDGE_IGNORE_SIGS&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 4)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Ignore all signal frames except NULL. 
<p>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l01043">1043</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l03797">ast_generic_bridge()</a>, <a class="el" href="rtp_8c-source.html#l02909">bridge_native_loop()</a>, <a class="el" href="rtp_8c-source.html#l03195">bridge_p2p_loop()</a>, and <a class="el" href="chan__iax2_8c-source.html#l03198">iax2_bridge()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="fa04b08a718273a286c8d92d9a20127d"></a><!-- doxytag: member="channel.h::AST_BRIDGE_REC_CHANNEL_0" ref="fa04b08a718273a286c8d92d9a20127d" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_BRIDGE_REC_CHANNEL_0&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 2)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return all voice frames on channel 0. 
<p>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l01039">1039</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="aec0971b94a79ea1fbb41a2e5f8b3fca"></a><!-- doxytag: member="channel.h::AST_BRIDGE_REC_CHANNEL_1" ref="aec0971b94a79ea1fbb41a2e5f8b3fca" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_BRIDGE_REC_CHANNEL_1&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 3)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return all voice frames on channel 1. 
<p>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l01041">1041</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="57fb43d64b209037cdc198f3db578d39"></a><!-- doxytag: member="channel.h::AST_CHANNEL_NAME" ref="57fb43d64b209037cdc198f3db578d39" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_CHANNEL_NAME&nbsp;&nbsp;&nbsp;80          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Max length of an <a class="el" href="structast__channel.html">ast_channel</a> name 
<p>
Definition at line <a class="el" href="channel_8h-source.html#l00141">141</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l01069">ast_channel_free()</a>, <a class="el" href="devicestate_8c-source.html#l00250">ast_parse_device_state()</a>, <a class="el" href="abstract__jb_8c-source.html#l00445">create_jb()</a>, <a class="el" href="manager_8c-source.html#l01850">fast_originate()</a>, <a class="el" href="app__page_8c-source.html#l00085">page_exec()</a>, and <a class="el" href="app__softhangup_8c-source.html#l00056">softhangup_exec()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="eba2b7656ee8c07b3f916e990b567b02"></a><!-- doxytag: member="channel.h::AST_GENERATOR_FD" ref="eba2b7656ee8c07b3f916e990b567b02" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_GENERATOR_FD&nbsp;&nbsp;&nbsp;(AST_MAX_FDS-4)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
used by generator 
<p>
Definition at line <a class="el" href="channel_8h-source.html#l00168">168</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02060">__ast_read()</a>, <a class="el" href="channel_8c-source.html#l01729">ast_deactivate_generator()</a>, and <a class="el" href="channel_8c-source.html#l03406">ast_do_masquerade()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="4d1ee7076af5032452aaba4ead082588"></a><!-- doxytag: member="channel.h::AST_MAX_CONTEXT" ref="4d1ee7076af5032452aaba4ead082588" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_MAX_CONTEXT&nbsp;&nbsp;&nbsp;80          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Max length of a context 
<p>
Definition at line <a class="el" href="channel_8h-source.html#l00140">140</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.
<p>
Referenced by <a class="el" href="app__macro_8c-source.html#l00144">_macro_exec()</a>, <a class="el" href="chan__sip_8c-source.html#l10548">cleanup_stale_contexts()</a>, <a class="el" href="app__chanspy_8c-source.html#l00465">common_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l01350">conf_run()</a>, <a class="el" href="chan__sip_8c-source.html#l17179">reload_config()</a>, and <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="729d25558b5b1940c1a6ff9d806f944c"></a><!-- doxytag: member="channel.h::AST_MAX_EXTENSION" ref="729d25558b5b1940c1a6ff9d806f944c" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_MAX_EXTENSION&nbsp;&nbsp;&nbsp;80          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Max length of an extension 
<p>
Definition at line <a class="el" href="channel_8h-source.html#l00139">139</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.
<p>
Referenced by <a class="el" href="app__voicemail_8c-source.html#l08189">advanced_options()</a>, <a class="el" href="devicestate_8c-source.html#l00478">ast_device_state_changed()</a>, <a class="el" href="pbx_8c-source.html#l01812">ast_extension_state2()</a>, <a class="el" href="pbx_8c-source.html#l01920">ast_hint_state_changed()</a>, <a class="el" href="app_8c-source.html#l01253">ast_ivr_menu_run_internal()</a>, <a class="el" href="dial_8c-source.html#l00236">begin_dial()</a>, <a class="el" href="chan__skinny_8c-source.html#l02102">build_device()</a>, <a class="el" href="app__meetme_8c-source.html#l01350">conf_run()</a>, <a class="el" href="app__meetme_8c-source.html#l04461">destroy_station()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="app__disa_8c-source.html#l00113">disa_exec()</a>, <a class="el" href="app__dial_8c-source.html#l00430">do_forward()</a>, <a class="el" href="res__features_8c-source.html#l01761">do_parking_thread()</a>, <a class="el" href="pbx__dundi_8c-source.html#l00532">dundi_lookup_local()</a>, <a class="el" href="app__voicemail_8c-source.html#l04129">forward_message()</a>, <a class="el" href="func__enum_8c-source.html#l00057">function_enum()</a>, <a class="el" href="chan__sip_8c-source.html#l09207">get_destination()</a>, <a class="el" href="res__features_8c-source.html#l02453">load_config()</a>, <a class="el" href="app__verbose_8c-source.html#l00101">log_exec()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02638">mgcp_ss()</a>, <a class="el" href="res__features_8c-source.html#l02439">park_add_hints()</a>, <a class="el" href="chan__phone_8c-source.html#l00939">phone_check_exception()</a>, <a class="el" href="pbx__realtime_8c-source.html#l00079">realtime_switch_common()</a>, <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>, <a class="el" href="chan__skinny_8c-source.html#l01719">skinny_extensionstate_cb()</a>, <a class="el" href="chan__skinny_8c-source.html#l02365">skinny_ss()</a>, <a class="el" href="app__meetme_8c-source.html#l04662">sla_build_station()</a>, <a class="el" href="app__speech__utils_8c-source.html#l00543">speech_background()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, <a class="el" href="chan__sip_8c-source.html#l07533">transmit_state_notify()</a>, <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>, <a class="el" href="app__voicemail_8c-source.html#l06295">vm_authenticate()</a>, and <a class="el" href="app__voicemail_8c-source.html#l07154">vmauthenticate()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="83204f17b88e7752d76b1a751a501a65"></a><!-- doxytag: member="channel.h::AST_MAX_FDS" ref="83204f17b88e7752d76b1a751a501a65" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_MAX_FDS&nbsp;&nbsp;&nbsp;10          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l00160">160</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l00632">ast_channel_alloc()</a>, <a class="el" href="channel_8c-source.html#l03406">ast_do_masquerade()</a>, <a class="el" href="channel_8c-source.html#l01800">ast_waitfor_nandfds()</a>, <a class="el" href="res__features_8c-source.html#l01761">do_parking_thread()</a>, and <a class="el" href="chan__features_8c-source.html#l00175">update_features()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="0db74b98fb7363645274b7b92a5741f2"></a><!-- doxytag: member="channel.h::AST_TIMING_FD" ref="0db74b98fb7363645274b7b92a5741f2" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_TIMING_FD&nbsp;&nbsp;&nbsp;(AST_MAX_FDS-2)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
used for timingfd 
<p>
Definition at line <a class="el" href="channel_8h-source.html#l00166">166</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02060">__ast_read()</a>, <a class="el" href="chan__agent_8c-source.html#l00427">agent_read()</a>, <a class="el" href="channel_8c-source.html#l00632">ast_channel_alloc()</a>, <a class="el" href="channel_8c-source.html#l03406">ast_do_masquerade()</a>, and <a class="el" href="chan__features_8c-source.html#l00165">restore_channel()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="722e76a74a7a5f5eb3efcd3cf30e7772"></a><!-- doxytag: member="channel.h::CHECK_BLOCKING" ref="722e76a74a7a5f5eb3efcd3cf30e7772" args="(c)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CHECK_BLOCKING          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">c&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l01387">1387</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02549">ast_sendtext()</a>, <a class="el" href="channel_8c-source.html#l01800">ast_waitfor_nandfds()</a>, <a class="el" href="channel_8c-source.html#l02660">ast_write()</a>, <a class="el" href="chan__phone_8c-source.html#l00564">phone_read()</a>, and <a class="el" href="chan__zap_8c-source.html#l04906">zt_read()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="cef2f26f7da88da7db20faa12bd436c4"></a><!-- doxytag: member="channel.h::CRASH" ref="cef2f26f7da88da7db20faa12bd436c4" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CRASH&nbsp;&nbsp;&nbsp;do { } while(0)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l01384">1384</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l01598">ast_hangup()</a>, <a class="el" href="channel_8c-source.html#l00795">ast_queue_frame()</a>, <a class="el" href="rtp_8c-source.html#l00893">ast_rtcp_read()</a>, <a class="el" href="rtp_8c-source.html#l01171">ast_rtp_read()</a>, <a class="el" href="sched_8c-source.html#l00259">ast_sched_del()</a>, <a class="el" href="udptl_8c-source.html#l00665">ast_udptl_read()</a>, <a class="el" href="abstract__jb_8c-source.html#l00445">create_jb()</a>, and <a class="el" href="abstract__jb_8c-source.html#l00381">jb_get_and_deliver()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="c6e71954f351d74faf8285b775ed08af"></a><!-- doxytag: member="channel.h::DATASTORE_INHERIT_FOREVER" ref="c6e71954f351d74faf8285b775ed08af" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DATASTORE_INHERIT_FOREVER&nbsp;&nbsp;&nbsp;INT_MAX          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l00158">158</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l01195">ast_channel_datastore_inherit()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="121c28674a9262e968ca5860c9f3e511"></a><!-- doxytag: member="channel.h::DEBUGCHAN_FLAG" ref="121c28674a9262e968ca5860c9f3e511" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define DEBUGCHAN_FLAG&nbsp;&nbsp;&nbsp;0x80000000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The high bit of the frame count is used as a debug marker, so increments of the counters must be done with care. Please use c-&gt;fin = FRAMECOUNT_INC(c-&gt;fin) and the same for c-&gt;fout. 
<p>
Definition at line <a class="el" href="channel_8h-source.html#l00327">327</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02060">__ast_read()</a>, <a class="el" href="channel_8c-source.html#l02660">ast_write()</a>, <a class="el" href="cli_8c-source.html#l00677">handle_core_set_debug_channel()</a>, <a class="el" href="cli_8c-source.html#l00770">handle_showchan()</a>, and <a class="el" href="app__dumpchan_8c-source.html#l00060">serialize_showchan()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="b6dc83815263d1b5a94deeee2f90ef5e"></a><!-- doxytag: member="channel.h::FRAMECOUNT_INC" ref="b6dc83815263d1b5a94deeee2f90ef5e" args="(x)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define FRAMECOUNT_INC          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">x&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;( ((x) &amp; DEBUGCHAN_FLAG) | (((x)+1) &amp; ~DEBUGCHAN_FLAG) )</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l00330">330</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02060">__ast_read()</a>, and <a class="el" href="channel_8c-source.html#l02660">ast_write()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="e58be8e458052ab77a64bd7d449d0461"></a><!-- doxytag: member="channel.h::MAX_LANGUAGE" ref="e58be8e458052ab77a64bd7d449d0461" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define MAX_LANGUAGE&nbsp;&nbsp;&nbsp;20          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Max length of the language setting 
<p>
Definition at line <a class="el" href="channel_8h-source.html#l00142">142</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="7c3359b925cb4caf244a7f0e7d553b13"></a><!-- doxytag: member="channel.h::MAX_MUSICCLASS" ref="7c3359b925cb4caf244a7f0e7d553b13" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define MAX_MUSICCLASS&nbsp;&nbsp;&nbsp;80          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Max length of the music class setting 
<p>
Definition at line <a class="el" href="channel_8h-source.html#l00143">143</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="f46fa02de8676dd1b9163c5dd428e610"></a><!-- doxytag: member="channel.h::ast_group_t" ref="f46fa02de8676dd1b9163c5dd428e610" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">typedef unsigned long long <a class="el" href="channel_8h.html#f46fa02de8676dd1b9163c5dd428e610">ast_group_t</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l00177">177</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.    </td>
  </tr>
</table>
<hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="dca29a1140aadadfd92b34a02fa516ef"></a><!-- doxytag: member="channel.h::@0" ref="dca29a1140aadadfd92b34a02fa516ef" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">anonymous enum          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<a class="el" href="structast__channel__tech.html">ast_channel_tech</a> Properties 
<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="dca29a1140aadadfd92b34a02fa516efe7ae5478ca756cfa996e94241fbbc3b2"></a><!-- doxytag: member="AST_CHAN_TP_WANTSJITTER" ref="dca29a1140aadadfd92b34a02fa516efe7ae5478ca756cfa996e94241fbbc3b2" args="" -->AST_CHAN_TP_WANTSJITTER</em>&nbsp;</td><td>
Channels have this property if they can accept input with jitter; i.e. most VoIP channels. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="dca29a1140aadadfd92b34a02fa516ef00a93b525e73f48b2060014487b2b98c"></a><!-- doxytag: member="AST_CHAN_TP_CREATESJITTER" ref="dca29a1140aadadfd92b34a02fa516ef00a93b525e73f48b2060014487b2b98c" args="" -->AST_CHAN_TP_CREATESJITTER</em>&nbsp;</td><td>
Channels have this property if they can create jitter; i.e. most VoIP channels. </td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l00499">499</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.<div class="fragment"><pre class="fragment"><a name="l00499"></a>00499      {<span class="comment"></span>
<a name="l00500"></a>00500 <span class="comment">   /*! \brief Channels have this property if they can accept input with jitter; </span>
<a name="l00501"></a>00501 <span class="comment">    *         i.e. most VoIP channels */</span>
<a name="l00502"></a>00502    <a class="code" href="channel_8h.html#dca29a1140aadadfd92b34a02fa516efe7ae5478ca756cfa996e94241fbbc3b2">AST_CHAN_TP_WANTSJITTER</a> = (1 &lt;&lt; 0),<span class="comment"></span>
<a name="l00503"></a>00503 <span class="comment">   /*! \brief Channels have this property if they can create jitter; </span>
<a name="l00504"></a>00504 <span class="comment">    *         i.e. most VoIP channels */</span>
<a name="l00505"></a>00505    <a class="code" href="channel_8h.html#dca29a1140aadadfd92b34a02fa516ef00a93b525e73f48b2060014487b2b98c">AST_CHAN_TP_CREATESJITTER</a> = (1 &lt;&lt; 1),
<a name="l00506"></a>00506 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="68986ab776eb5d6b5a809a1c005a7300"></a><!-- doxytag: member="channel.h::@1" ref="68986ab776eb5d6b5a809a1c005a7300" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">anonymous enum          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<a class="el" href="structast__channel.html">ast_channel</a> flags 
<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="68986ab776eb5d6b5a809a1c005a730023cf26f45cc26e3a993f7dc09b130f33"></a><!-- doxytag: member="AST_FLAG_DEFER_DTMF" ref="68986ab776eb5d6b5a809a1c005a730023cf26f45cc26e3a993f7dc09b130f33" args="" -->AST_FLAG_DEFER_DTMF</em>&nbsp;</td><td>
Queue incoming dtmf, to be released when this flag is turned off </td></tr>
<tr><td valign="top"><em><a class="anchor" name="68986ab776eb5d6b5a809a1c005a730015fb5a488ff560040b677433b270fb5e"></a><!-- doxytag: member="AST_FLAG_WRITE_INT" ref="68986ab776eb5d6b5a809a1c005a730015fb5a488ff560040b677433b270fb5e" args="" -->AST_FLAG_WRITE_INT</em>&nbsp;</td><td>
write should be interrupt generator </td></tr>
<tr><td valign="top"><em><a class="anchor" name="68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672"></a><!-- doxytag: member="AST_FLAG_BLOCKING" ref="68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672" args="" -->AST_FLAG_BLOCKING</em>&nbsp;</td><td>
a thread is blocking on this channel </td></tr>
<tr><td valign="top"><em><a class="anchor" name="68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5"></a><!-- doxytag: member="AST_FLAG_ZOMBIE" ref="68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5" args="" -->AST_FLAG_ZOMBIE</em>&nbsp;</td><td>
This is a zombie channel </td></tr>
<tr><td valign="top"><em><a class="anchor" name="68986ab776eb5d6b5a809a1c005a7300e16a5c3eb4b46399b147040658306ff5"></a><!-- doxytag: member="AST_FLAG_EXCEPTION" ref="68986ab776eb5d6b5a809a1c005a7300e16a5c3eb4b46399b147040658306ff5" args="" -->AST_FLAG_EXCEPTION</em>&nbsp;</td><td>
There is an exception pending </td></tr>
<tr><td valign="top"><em><a class="anchor" name="68986ab776eb5d6b5a809a1c005a7300613f868823a3ed1b5e95b733bb7354c4"></a><!-- doxytag: member="AST_FLAG_MOH" ref="68986ab776eb5d6b5a809a1c005a7300613f868823a3ed1b5e95b733bb7354c4" args="" -->AST_FLAG_MOH</em>&nbsp;</td><td>
Listening to moh XXX anthm promises me this will disappear XXX </td></tr>
<tr><td valign="top"><em><a class="anchor" name="68986ab776eb5d6b5a809a1c005a73003b51f1a5a94e370c4e7300d425a8684e"></a><!-- doxytag: member="AST_FLAG_SPYING" ref="68986ab776eb5d6b5a809a1c005a73003b51f1a5a94e370c4e7300d425a8684e" args="" -->AST_FLAG_SPYING</em>&nbsp;</td><td>
This channel is spying on another channel </td></tr>
<tr><td valign="top"><em><a class="anchor" name="68986ab776eb5d6b5a809a1c005a7300b38fcf240d912cfa60d488dea99cab31"></a><!-- doxytag: member="AST_FLAG_NBRIDGE" ref="68986ab776eb5d6b5a809a1c005a7300b38fcf240d912cfa60d488dea99cab31" args="" -->AST_FLAG_NBRIDGE</em>&nbsp;</td><td>
This channel is in a native bridge </td></tr>
<tr><td valign="top"><em><a class="anchor" name="68986ab776eb5d6b5a809a1c005a73002122d39475941a27a292dfd49534d079"></a><!-- doxytag: member="AST_FLAG_IN_AUTOLOOP" ref="68986ab776eb5d6b5a809a1c005a73002122d39475941a27a292dfd49534d079" args="" -->AST_FLAG_IN_AUTOLOOP</em>&nbsp;</td><td>
the channel is in an auto-incrementing dialplan processor, so when -&gt;priority is set, it will get incremented before finding the next priority to run </td></tr>
<tr><td valign="top"><em><a class="anchor" name="68986ab776eb5d6b5a809a1c005a73007a1bed17a368c12201a64ef3122bf6f6"></a><!-- doxytag: member="AST_FLAG_OUTGOING" ref="68986ab776eb5d6b5a809a1c005a73007a1bed17a368c12201a64ef3122bf6f6" args="" -->AST_FLAG_OUTGOING</em>&nbsp;</td><td>
This is an outgoing call </td></tr>
<tr><td valign="top"><em><a class="anchor" name="68986ab776eb5d6b5a809a1c005a730059fb89e0dc785928def8b9daa1a2d316"></a><!-- doxytag: member="AST_FLAG_WHISPER" ref="68986ab776eb5d6b5a809a1c005a730059fb89e0dc785928def8b9daa1a2d316" args="" -->AST_FLAG_WHISPER</em>&nbsp;</td><td>
This channel is being whispered on </td></tr>
<tr><td valign="top"><em><a class="anchor" name="68986ab776eb5d6b5a809a1c005a7300a63f30ad9ccc9888e23f0d887864fe03"></a><!-- doxytag: member="AST_FLAG_IN_DTMF" ref="68986ab776eb5d6b5a809a1c005a7300a63f30ad9ccc9888e23f0d887864fe03" args="" -->AST_FLAG_IN_DTMF</em>&nbsp;</td><td>
A DTMF_BEGIN frame has been read from this channel, but not yet an END </td></tr>
<tr><td valign="top"><em><a class="anchor" name="68986ab776eb5d6b5a809a1c005a7300f97b9e8c75156f109b64547f27eb8034"></a><!-- doxytag: member="AST_FLAG_EMULATE_DTMF" ref="68986ab776eb5d6b5a809a1c005a7300f97b9e8c75156f109b64547f27eb8034" args="" -->AST_FLAG_EMULATE_DTMF</em>&nbsp;</td><td>
A DTMF_END was received when not IN_DTMF, so the length of the digit is currently being emulated </td></tr>
<tr><td valign="top"><em><a class="anchor" name="68986ab776eb5d6b5a809a1c005a73000ecdf5f8a5869727e38bf9e1ca5a6cae"></a><!-- doxytag: member="AST_FLAG_END_DTMF_ONLY" ref="68986ab776eb5d6b5a809a1c005a73000ecdf5f8a5869727e38bf9e1ca5a6cae" args="" -->AST_FLAG_END_DTMF_ONLY</em>&nbsp;</td><td>
This is set to tell the channel not to generate DTMF begin frames, and to instead only generate END frames. </td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l00509">509</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.<div class="fragment"><pre class="fragment"><a name="l00509"></a>00509      {<span class="comment"></span>
<a name="l00510"></a>00510 <span class="comment">   /*! Queue incoming dtmf, to be released when this flag is turned off */</span>
<a name="l00511"></a>00511    <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730023cf26f45cc26e3a993f7dc09b130f33">AST_FLAG_DEFER_DTMF</a> =    (1 &lt;&lt; 1),<span class="comment"></span>
<a name="l00512"></a>00512 <span class="comment">   /*! write should be interrupt generator */</span>
<a name="l00513"></a>00513    <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730015fb5a488ff560040b677433b270fb5e">AST_FLAG_WRITE_INT</a> =     (1 &lt;&lt; 2),<span class="comment"></span>
<a name="l00514"></a>00514 <span class="comment">   /*! a thread is blocking on this channel */</span>
<a name="l00515"></a>00515    <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a> =      (1 &lt;&lt; 3),<span class="comment"></span>
<a name="l00516"></a>00516 <span class="comment">   /*! This is a zombie channel */</span>
<a name="l00517"></a>00517    <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a> =        (1 &lt;&lt; 4),<span class="comment"></span>
<a name="l00518"></a>00518 <span class="comment">   /*! There is an exception pending */</span>
<a name="l00519"></a>00519    <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300e16a5c3eb4b46399b147040658306ff5">AST_FLAG_EXCEPTION</a> =     (1 &lt;&lt; 5),<span class="comment"></span>
<a name="l00520"></a>00520 <span class="comment">   /*! Listening to moh XXX anthm promises me this will disappear XXX */</span>
<a name="l00521"></a>00521    <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300613f868823a3ed1b5e95b733bb7354c4">AST_FLAG_MOH</a> =           (1 &lt;&lt; 6),<span class="comment"></span>
<a name="l00522"></a>00522 <span class="comment">   /*! This channel is spying on another channel */</span>
<a name="l00523"></a>00523    <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b51f1a5a94e370c4e7300d425a8684e">AST_FLAG_SPYING</a> =        (1 &lt;&lt; 7),<span class="comment"></span>
<a name="l00524"></a>00524 <span class="comment">   /*! This channel is in a native bridge */</span>
<a name="l00525"></a>00525    <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300b38fcf240d912cfa60d488dea99cab31">AST_FLAG_NBRIDGE</a> =       (1 &lt;&lt; 8),<span class="comment"></span>
<a name="l00526"></a>00526 <span class="comment">   /*! the channel is in an auto-incrementing dialplan processor,</span>
<a name="l00527"></a>00527 <span class="comment">    *  so when -&gt;priority is set, it will get incremented before</span>
<a name="l00528"></a>00528 <span class="comment">    *  finding the next priority to run */</span>
<a name="l00529"></a>00529    <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73002122d39475941a27a292dfd49534d079">AST_FLAG_IN_AUTOLOOP</a> =   (1 &lt;&lt; 9),<span class="comment"></span>
<a name="l00530"></a>00530 <span class="comment">   /*! This is an outgoing call */</span>
<a name="l00531"></a>00531    <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73007a1bed17a368c12201a64ef3122bf6f6">AST_FLAG_OUTGOING</a> =      (1 &lt;&lt; 10),<span class="comment"></span>
<a name="l00532"></a>00532 <span class="comment">   /*! This channel is being whispered on */</span>
<a name="l00533"></a>00533    <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730059fb89e0dc785928def8b9daa1a2d316">AST_FLAG_WHISPER</a> =       (1 &lt;&lt; 11),<span class="comment"></span>
<a name="l00534"></a>00534 <span class="comment">   /*! A DTMF_BEGIN frame has been read from this channel, but not yet an END */</span>
<a name="l00535"></a>00535    <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300a63f30ad9ccc9888e23f0d887864fe03">AST_FLAG_IN_DTMF</a> =       (1 &lt;&lt; 12),<span class="comment"></span>
<a name="l00536"></a>00536 <span class="comment">   /*! A DTMF_END was received when not IN_DTMF, so the length of the digit is </span>
<a name="l00537"></a>00537 <span class="comment">    *  currently being emulated */</span>
<a name="l00538"></a>00538    <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300f97b9e8c75156f109b64547f27eb8034">AST_FLAG_EMULATE_DTMF</a> =  (1 &lt;&lt; 13),<span class="comment"></span>
<a name="l00539"></a>00539 <span class="comment">   /*! This is set to tell the channel not to generate DTMF begin frames, and</span>
<a name="l00540"></a>00540 <span class="comment">    *  to instead only generate END frames. */</span>
<a name="l00541"></a>00541    <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73000ecdf5f8a5869727e38bf9e1ca5a6cae">AST_FLAG_END_DTMF_ONLY</a> = (1 &lt;&lt; 14),
<a name="l00542"></a>00542 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="02653d87b6fa8554fc0d1a3726fea2d0"></a><!-- doxytag: member="channel.h::@2" ref="02653d87b6fa8554fc0d1a3726fea2d0" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">anonymous enum          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<a class="el" href="structast__bridge__config.html">ast_bridge_config</a> flags 
<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="02653d87b6fa8554fc0d1a3726fea2d04040ce118987e724063d0b58eafd9b4f"></a><!-- doxytag: member="AST_FEATURE_PLAY_WARNING" ref="02653d87b6fa8554fc0d1a3726fea2d04040ce118987e724063d0b58eafd9b4f" args="" -->AST_FEATURE_PLAY_WARNING</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="02653d87b6fa8554fc0d1a3726fea2d06d1225b2615ed409be56bda96c5b71b9"></a><!-- doxytag: member="AST_FEATURE_REDIRECT" ref="02653d87b6fa8554fc0d1a3726fea2d06d1225b2615ed409be56bda96c5b71b9" args="" -->AST_FEATURE_REDIRECT</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="02653d87b6fa8554fc0d1a3726fea2d04e55f4f77a24039b6ade9954efba0493"></a><!-- doxytag: member="AST_FEATURE_DISCONNECT" ref="02653d87b6fa8554fc0d1a3726fea2d04e55f4f77a24039b6ade9954efba0493" args="" -->AST_FEATURE_DISCONNECT</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="02653d87b6fa8554fc0d1a3726fea2d09e4ef5f62675d335054d6f0ae302c307"></a><!-- doxytag: member="AST_FEATURE_ATXFER" ref="02653d87b6fa8554fc0d1a3726fea2d09e4ef5f62675d335054d6f0ae302c307" args="" -->AST_FEATURE_ATXFER</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="02653d87b6fa8554fc0d1a3726fea2d0f9a5c8452526c77703890c2cb6784eb6"></a><!-- doxytag: member="AST_FEATURE_AUTOMON" ref="02653d87b6fa8554fc0d1a3726fea2d0f9a5c8452526c77703890c2cb6784eb6" args="" -->AST_FEATURE_AUTOMON</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="02653d87b6fa8554fc0d1a3726fea2d0bc5c3869d149426e287f8f773f8d3f38"></a><!-- doxytag: member="AST_FEATURE_PARKCALL" ref="02653d87b6fa8554fc0d1a3726fea2d0bc5c3869d149426e287f8f773f8d3f38" args="" -->AST_FEATURE_PARKCALL</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l00545">545</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.<div class="fragment"><pre class="fragment"><a name="l00545"></a>00545      {
<a name="l00546"></a>00546    <a class="code" href="channel_8h.html#02653d87b6fa8554fc0d1a3726fea2d04040ce118987e724063d0b58eafd9b4f">AST_FEATURE_PLAY_WARNING</a> = (1 &lt;&lt; 0),
<a name="l00547"></a>00547    <a class="code" href="channel_8h.html#02653d87b6fa8554fc0d1a3726fea2d06d1225b2615ed409be56bda96c5b71b9">AST_FEATURE_REDIRECT</a> =     (1 &lt;&lt; 1),
<a name="l00548"></a>00548    <a class="code" href="channel_8h.html#02653d87b6fa8554fc0d1a3726fea2d04e55f4f77a24039b6ade9954efba0493">AST_FEATURE_DISCONNECT</a> =   (1 &lt;&lt; 2),
<a name="l00549"></a>00549    <a class="code" href="channel_8h.html#02653d87b6fa8554fc0d1a3726fea2d09e4ef5f62675d335054d6f0ae302c307">AST_FEATURE_ATXFER</a> =       (1 &lt;&lt; 3),
<a name="l00550"></a>00550    <a class="code" href="channel_8h.html#02653d87b6fa8554fc0d1a3726fea2d0f9a5c8452526c77703890c2cb6784eb6">AST_FEATURE_AUTOMON</a> =      (1 &lt;&lt; 4),
<a name="l00551"></a>00551    <a class="code" href="channel_8h.html#02653d87b6fa8554fc0d1a3726fea2d0bc5c3869d149426e287f8f773f8d3f38">AST_FEATURE_PARKCALL</a> =     (1 &lt;&lt; 5),
<a name="l00552"></a>00552 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1378d7d8767899287b0407055215aa4e"></a><!-- doxytag: member="channel.h::@3" ref="1378d7d8767899287b0407055215aa4e" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">anonymous enum          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="1378d7d8767899287b0407055215aa4e67d5814f1a69234da1d6becf767eca14"></a><!-- doxytag: member="AST_CDR_TRANSFER" ref="1378d7d8767899287b0407055215aa4e67d5814f1a69234da1d6becf767eca14" args="" -->AST_CDR_TRANSFER</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="1378d7d8767899287b0407055215aa4e89f0c3bfba1428a3616951be71239ef9"></a><!-- doxytag: member="AST_CDR_FORWARD" ref="1378d7d8767899287b0407055215aa4e89f0c3bfba1428a3616951be71239ef9" args="" -->AST_CDR_FORWARD</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="1378d7d8767899287b0407055215aa4ed46cbd6986389a7008e5cfe9164e303a"></a><!-- doxytag: member="AST_CDR_CALLWAIT" ref="1378d7d8767899287b0407055215aa4ed46cbd6986389a7008e5cfe9164e303a" args="" -->AST_CDR_CALLWAIT</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="1378d7d8767899287b0407055215aa4e8a2e750258ff86fe8700916b551e8d59"></a><!-- doxytag: member="AST_CDR_CONFERENCE" ref="1378d7d8767899287b0407055215aa4e8a2e750258ff86fe8700916b551e8d59" args="" -->AST_CDR_CONFERENCE</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l00583">583</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.<div class="fragment"><pre class="fragment"><a name="l00583"></a>00583      {
<a name="l00584"></a>00584    <a class="code" href="channel_8h.html#1378d7d8767899287b0407055215aa4e67d5814f1a69234da1d6becf767eca14">AST_CDR_TRANSFER</a> =   (1 &lt;&lt; 0),
<a name="l00585"></a>00585    <a class="code" href="channel_8h.html#1378d7d8767899287b0407055215aa4e89f0c3bfba1428a3616951be71239ef9">AST_CDR_FORWARD</a> =    (1 &lt;&lt; 1),
<a name="l00586"></a>00586    <a class="code" href="channel_8h.html#1378d7d8767899287b0407055215aa4ed46cbd6986389a7008e5cfe9164e303a">AST_CDR_CALLWAIT</a> =   (1 &lt;&lt; 2),
<a name="l00587"></a>00587    <a class="code" href="channel_8h.html#1378d7d8767899287b0407055215aa4e8a2e750258ff86fe8700916b551e8d59">AST_CDR_CONFERENCE</a> = (1 &lt;&lt; 3),
<a name="l00588"></a>00588 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a4d79cb252987ad7f099770543e601a1"></a><!-- doxytag: member="channel.h::@4" ref="a4d79cb252987ad7f099770543e601a1" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">anonymous enum          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="a4d79cb252987ad7f099770543e601a1cbe3f9a2385d6a31eac6abced2a9f17d"></a><!-- doxytag: member="AST_SOFTHANGUP_DEV" ref="a4d79cb252987ad7f099770543e601a1cbe3f9a2385d6a31eac6abced2a9f17d" args="" -->AST_SOFTHANGUP_DEV</em>&nbsp;</td><td>
Soft hangup by device </td></tr>
<tr><td valign="top"><em><a class="anchor" name="a4d79cb252987ad7f099770543e601a179c1afce6cda266617f47d63393c2d71"></a><!-- doxytag: member="AST_SOFTHANGUP_ASYNCGOTO" ref="a4d79cb252987ad7f099770543e601a179c1afce6cda266617f47d63393c2d71" args="" -->AST_SOFTHANGUP_ASYNCGOTO</em>&nbsp;</td><td>
Soft hangup for async goto </td></tr>
<tr><td valign="top"><em><a class="anchor" name="a4d79cb252987ad7f099770543e601a1e415ee9181158293f7c3d3cd1a98f4ee"></a><!-- doxytag: member="AST_SOFTHANGUP_SHUTDOWN" ref="a4d79cb252987ad7f099770543e601a1e415ee9181158293f7c3d3cd1a98f4ee" args="" -->AST_SOFTHANGUP_SHUTDOWN</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="a4d79cb252987ad7f099770543e601a12709ffb7179ec4c9b3ba505519ddc84e"></a><!-- doxytag: member="AST_SOFTHANGUP_TIMEOUT" ref="a4d79cb252987ad7f099770543e601a12709ffb7179ec4c9b3ba505519ddc84e" args="" -->AST_SOFTHANGUP_TIMEOUT</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="a4d79cb252987ad7f099770543e601a1a605d712c745c736f14ef4e8bfd59245"></a><!-- doxytag: member="AST_SOFTHANGUP_APPUNLOAD" ref="a4d79cb252987ad7f099770543e601a1a605d712c745c736f14ef4e8bfd59245" args="" -->AST_SOFTHANGUP_APPUNLOAD</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="a4d79cb252987ad7f099770543e601a1fe8eae384d045bee039ff9140421beb8"></a><!-- doxytag: member="AST_SOFTHANGUP_EXPLICIT" ref="a4d79cb252987ad7f099770543e601a1fe8eae384d045bee039ff9140421beb8" args="" -->AST_SOFTHANGUP_EXPLICIT</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="a4d79cb252987ad7f099770543e601a1f3fe293730d3200b678a1daaa67ea5c5"></a><!-- doxytag: member="AST_SOFTHANGUP_UNBRIDGE" ref="a4d79cb252987ad7f099770543e601a1f3fe293730d3200b678a1daaa67ea5c5" args="" -->AST_SOFTHANGUP_UNBRIDGE</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l00590">590</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.<div class="fragment"><pre class="fragment"><a name="l00590"></a>00590      {<span class="comment"></span>
<a name="l00591"></a>00591 <span class="comment">   /*! Soft hangup by device */</span>
<a name="l00592"></a>00592    <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1cbe3f9a2385d6a31eac6abced2a9f17d">AST_SOFTHANGUP_DEV</a> =       (1 &lt;&lt; 0),<span class="comment"></span>
<a name="l00593"></a>00593 <span class="comment">   /*! Soft hangup for async goto */</span>
<a name="l00594"></a>00594    <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a179c1afce6cda266617f47d63393c2d71">AST_SOFTHANGUP_ASYNCGOTO</a> = (1 &lt;&lt; 1),
<a name="l00595"></a>00595    <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1e415ee9181158293f7c3d3cd1a98f4ee">AST_SOFTHANGUP_SHUTDOWN</a> =  (1 &lt;&lt; 2),
<a name="l00596"></a>00596    <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a12709ffb7179ec4c9b3ba505519ddc84e">AST_SOFTHANGUP_TIMEOUT</a> =   (1 &lt;&lt; 3),
<a name="l00597"></a>00597    <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1a605d712c745c736f14ef4e8bfd59245">AST_SOFTHANGUP_APPUNLOAD</a> = (1 &lt;&lt; 4),
<a name="l00598"></a>00598    <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1fe8eae384d045bee039ff9140421beb8">AST_SOFTHANGUP_EXPLICIT</a> =  (1 &lt;&lt; 5),
<a name="l00599"></a>00599    <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1f3fe293730d3200b678a1daaa67ea5c5">AST_SOFTHANGUP_UNBRIDGE</a> =  (1 &lt;&lt; 6),
<a name="l00600"></a>00600 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8bba128582c81d1af777c11278bd4d19"></a><!-- doxytag: member="channel.h::ast_bridge_result" ref="8bba128582c81d1af777c11278bd4d19" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="channel_8h.html#8bba128582c81d1af777c11278bd4d19">ast_bridge_result</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="8bba128582c81d1af777c11278bd4d19fd37b17491849eb3a8d0cd996d69fe1f"></a><!-- doxytag: member="AST_BRIDGE_COMPLETE" ref="8bba128582c81d1af777c11278bd4d19fd37b17491849eb3a8d0cd996d69fe1f" args="" -->AST_BRIDGE_COMPLETE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="8bba128582c81d1af777c11278bd4d198b00ec8ed330d763fd4f579d7c513d1d"></a><!-- doxytag: member="AST_BRIDGE_FAILED" ref="8bba128582c81d1af777c11278bd4d198b00ec8ed330d763fd4f579d7c513d1d" args="" -->AST_BRIDGE_FAILED</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="8bba128582c81d1af777c11278bd4d19c05a72efa9f8f1c8ebcfaf8e6fe97524"></a><!-- doxytag: member="AST_BRIDGE_FAILED_NOWARN" ref="8bba128582c81d1af777c11278bd4d19c05a72efa9f8f1c8ebcfaf8e6fe97524" args="" -->AST_BRIDGE_FAILED_NOWARN</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="8bba128582c81d1af777c11278bd4d19ebe331af24cd5342764adc6f1b59fbec"></a><!-- doxytag: member="AST_BRIDGE_RETRY" ref="8bba128582c81d1af777c11278bd4d19ebe331af24cd5342764adc6f1b59fbec" args="" -->AST_BRIDGE_RETRY</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l00170">170</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.<div class="fragment"><pre class="fragment"><a name="l00170"></a>00170                        {
<a name="l00171"></a>00171    <a class="code" href="channel_8h.html#8bba128582c81d1af777c11278bd4d19fd37b17491849eb3a8d0cd996d69fe1f">AST_BRIDGE_COMPLETE</a> = 0,
<a name="l00172"></a>00172    <a class="code" href="channel_8h.html#8bba128582c81d1af777c11278bd4d198b00ec8ed330d763fd4f579d7c513d1d">AST_BRIDGE_FAILED</a> = -1,
<a name="l00173"></a>00173    <a class="code" href="channel_8h.html#8bba128582c81d1af777c11278bd4d19c05a72efa9f8f1c8ebcfaf8e6fe97524">AST_BRIDGE_FAILED_NOWARN</a> = -2,
<a name="l00174"></a>00174    <a class="code" href="channel_8h.html#8bba128582c81d1af777c11278bd4d19ebe331af24cd5342764adc6f1b59fbec">AST_BRIDGE_RETRY</a> = -3,
<a name="l00175"></a>00175 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b0b0e02362739df53c5a11797f118a6d"></a><!-- doxytag: member="channel.h::ast_channel_adsicpe" ref="b0b0e02362739df53c5a11797f118a6d" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="channel_8h.html#b0b0e02362739df53c5a11797f118a6d">ast_channel_adsicpe</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="b0b0e02362739df53c5a11797f118a6d6a7552ab39e56e9786f9b2adbb63fc23"></a><!-- doxytag: member="AST_ADSI_UNKNOWN" ref="b0b0e02362739df53c5a11797f118a6d6a7552ab39e56e9786f9b2adbb63fc23" args="" -->AST_ADSI_UNKNOWN</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="b0b0e02362739df53c5a11797f118a6df141c289f651b61ee5a5bc0e3511f4c7"></a><!-- doxytag: member="AST_ADSI_AVAILABLE" ref="b0b0e02362739df53c5a11797f118a6df141c289f651b61ee5a5bc0e3511f4c7" args="" -->AST_ADSI_AVAILABLE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="b0b0e02362739df53c5a11797f118a6db29a58956d5f95b2dc9aedd6dea41b54"></a><!-- doxytag: member="AST_ADSI_UNAVAILABLE" ref="b0b0e02362739df53c5a11797f118a6db29a58956d5f95b2dc9aedd6dea41b54" args="" -->AST_ADSI_UNAVAILABLE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="b0b0e02362739df53c5a11797f118a6d6d363e92a37e969828525f5b5cdee041"></a><!-- doxytag: member="AST_ADSI_OFFHOOKONLY" ref="b0b0e02362739df53c5a11797f118a6d6d363e92a37e969828525f5b5cdee041" args="" -->AST_ADSI_OFFHOOKONLY</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l00338">338</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.<div class="fragment"><pre class="fragment"><a name="l00338"></a>00338                          {
<a name="l00339"></a>00339    <a class="code" href="channel_8h.html#b0b0e02362739df53c5a11797f118a6d6a7552ab39e56e9786f9b2adbb63fc23">AST_ADSI_UNKNOWN</a>,
<a name="l00340"></a>00340    <a class="code" href="channel_8h.html#b0b0e02362739df53c5a11797f118a6df141c289f651b61ee5a5bc0e3511f4c7">AST_ADSI_AVAILABLE</a>,
<a name="l00341"></a>00341    <a class="code" href="channel_8h.html#b0b0e02362739df53c5a11797f118a6db29a58956d5f95b2dc9aedd6dea41b54">AST_ADSI_UNAVAILABLE</a>,
<a name="l00342"></a>00342    <a class="code" href="channel_8h.html#b0b0e02362739df53c5a11797f118a6d6d363e92a37e969828525f5b5cdee041">AST_ADSI_OFFHOOKONLY</a>,
<a name="l00343"></a>00343 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c04acac682ff0cff5eda96378318b87a"></a><!-- doxytag: member="channel.h::ast_channel_state" ref="c04acac682ff0cff5eda96378318b87a" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a">ast_channel_state</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<a class="el" href="structast__channel.html">ast_channel</a> states 
<p>
<dl compact><dt><b>Note:</b></dt><dd>Bits 0-15 of state are reserved for the state (up/down) of the line Bits 16-32 of state are reserved for flags </dd></dl>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="c04acac682ff0cff5eda96378318b87a3c9bf8b90a4d4f25fc98dd1360bba58b"></a><!-- doxytag: member="AST_STATE_DOWN" ref="c04acac682ff0cff5eda96378318b87a3c9bf8b90a4d4f25fc98dd1360bba58b" args="" -->AST_STATE_DOWN</em>&nbsp;</td><td>
Channel is down and available </td></tr>
<tr><td valign="top"><em><a class="anchor" name="c04acac682ff0cff5eda96378318b87a75a7d9c79e4a7c2732015d1c68908536"></a><!-- doxytag: member="AST_STATE_RESERVED" ref="c04acac682ff0cff5eda96378318b87a75a7d9c79e4a7c2732015d1c68908536" args="" -->AST_STATE_RESERVED</em>&nbsp;</td><td>
Channel is down, but reserved </td></tr>
<tr><td valign="top"><em><a class="anchor" name="c04acac682ff0cff5eda96378318b87a71b2dab052b5015d49144d52cf580735"></a><!-- doxytag: member="AST_STATE_OFFHOOK" ref="c04acac682ff0cff5eda96378318b87a71b2dab052b5015d49144d52cf580735" args="" -->AST_STATE_OFFHOOK</em>&nbsp;</td><td>
Channel is off hook </td></tr>
<tr><td valign="top"><em><a class="anchor" name="c04acac682ff0cff5eda96378318b87a4f25236a25abffd53bda3ef97e96296f"></a><!-- doxytag: member="AST_STATE_DIALING" ref="c04acac682ff0cff5eda96378318b87a4f25236a25abffd53bda3ef97e96296f" args="" -->AST_STATE_DIALING</em>&nbsp;</td><td>
Digits (or equivalent) have been dialed </td></tr>
<tr><td valign="top"><em><a class="anchor" name="c04acac682ff0cff5eda96378318b87a0789c8ad2fe8eda2081eb587a0bfbe42"></a><!-- doxytag: member="AST_STATE_RING" ref="c04acac682ff0cff5eda96378318b87a0789c8ad2fe8eda2081eb587a0bfbe42" args="" -->AST_STATE_RING</em>&nbsp;</td><td>
Line is ringing </td></tr>
<tr><td valign="top"><em><a class="anchor" name="c04acac682ff0cff5eda96378318b87a85da5b3ea10583d638bc7ce8fe638ec2"></a><!-- doxytag: member="AST_STATE_RINGING" ref="c04acac682ff0cff5eda96378318b87a85da5b3ea10583d638bc7ce8fe638ec2" args="" -->AST_STATE_RINGING</em>&nbsp;</td><td>
Remote end is ringing </td></tr>
<tr><td valign="top"><em><a class="anchor" name="c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6"></a><!-- doxytag: member="AST_STATE_UP" ref="c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6" args="" -->AST_STATE_UP</em>&nbsp;</td><td>
Line is up </td></tr>
<tr><td valign="top"><em><a class="anchor" name="c04acac682ff0cff5eda96378318b87a2081397aa15f6ea9b289237043aa1d1b"></a><!-- doxytag: member="AST_STATE_BUSY" ref="c04acac682ff0cff5eda96378318b87a2081397aa15f6ea9b289237043aa1d1b" args="" -->AST_STATE_BUSY</em>&nbsp;</td><td>
Line is busy </td></tr>
<tr><td valign="top"><em><a class="anchor" name="c04acac682ff0cff5eda96378318b87ae69544c47419fa57cd20045b09aa5b40"></a><!-- doxytag: member="AST_STATE_DIALING_OFFHOOK" ref="c04acac682ff0cff5eda96378318b87ae69544c47419fa57cd20045b09aa5b40" args="" -->AST_STATE_DIALING_OFFHOOK</em>&nbsp;</td><td>
Digits (or equivalent) have been dialed while offhook </td></tr>
<tr><td valign="top"><em><a class="anchor" name="c04acac682ff0cff5eda96378318b87a0c8ef65931fb09184de67c7484cbbf47"></a><!-- doxytag: member="AST_STATE_PRERING" ref="c04acac682ff0cff5eda96378318b87a0c8ef65931fb09184de67c7484cbbf47" args="" -->AST_STATE_PRERING</em>&nbsp;</td><td>
Channel has detected an incoming call and is waiting for ring </td></tr>
<tr><td valign="top"><em><a class="anchor" name="c04acac682ff0cff5eda96378318b87a86863733f407b703a3db65389e43964e"></a><!-- doxytag: member="AST_STATE_MUTE" ref="c04acac682ff0cff5eda96378318b87a86863733f407b703a3db65389e43964e" args="" -->AST_STATE_MUTE</em>&nbsp;</td><td>
Do not transmit voice data </td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l00351">351</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.<div class="fragment"><pre class="fragment"><a name="l00351"></a>00351                        {<span class="comment"></span>
<a name="l00352"></a>00352 <span class="comment">   /*! Channel is down and available */</span>
<a name="l00353"></a>00353    <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a3c9bf8b90a4d4f25fc98dd1360bba58b">AST_STATE_DOWN</a>,<span class="comment"></span>
<a name="l00354"></a>00354 <span class="comment">   /*! Channel is down, but reserved */</span>
<a name="l00355"></a>00355    <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a75a7d9c79e4a7c2732015d1c68908536">AST_STATE_RESERVED</a>,<span class="comment"></span>
<a name="l00356"></a>00356 <span class="comment">   /*! Channel is off hook */</span>
<a name="l00357"></a>00357    <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a71b2dab052b5015d49144d52cf580735">AST_STATE_OFFHOOK</a>,<span class="comment"></span>
<a name="l00358"></a>00358 <span class="comment">   /*! Digits (or equivalent) have been dialed */</span>
<a name="l00359"></a>00359    <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a4f25236a25abffd53bda3ef97e96296f">AST_STATE_DIALING</a>,<span class="comment"></span>
<a name="l00360"></a>00360 <span class="comment">   /*! Line is ringing */</span>
<a name="l00361"></a>00361    <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a0789c8ad2fe8eda2081eb587a0bfbe42">AST_STATE_RING</a>,<span class="comment"></span>
<a name="l00362"></a>00362 <span class="comment">   /*! Remote end is ringing */</span>
<a name="l00363"></a>00363    <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a85da5b3ea10583d638bc7ce8fe638ec2">AST_STATE_RINGING</a>,<span class="comment"></span>
<a name="l00364"></a>00364 <span class="comment">   /*! Line is up */</span>
<a name="l00365"></a>00365    <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>,<span class="comment"></span>
<a name="l00366"></a>00366 <span class="comment">   /*! Line is busy */</span>
<a name="l00367"></a>00367    <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a2081397aa15f6ea9b289237043aa1d1b">AST_STATE_BUSY</a>,<span class="comment"></span>
<a name="l00368"></a>00368 <span class="comment">   /*! Digits (or equivalent) have been dialed while offhook */</span>
<a name="l00369"></a>00369    <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87ae69544c47419fa57cd20045b09aa5b40">AST_STATE_DIALING_OFFHOOK</a>,<span class="comment"></span>
<a name="l00370"></a>00370 <span class="comment">   /*! Channel has detected an incoming call and is waiting for ring */</span>
<a name="l00371"></a>00371    <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a0c8ef65931fb09184de67c7484cbbf47">AST_STATE_PRERING</a>,
<a name="l00372"></a>00372 <span class="comment"></span>
<a name="l00373"></a>00373 <span class="comment">   /*! Do not transmit voice data */</span>
<a name="l00374"></a>00374    <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a86863733f407b703a3db65389e43964e">AST_STATE_MUTE</a> = (1 &lt;&lt; 16),
<a name="l00375"></a>00375 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a49c7ae4d656ef2e220ceae47cb045f2"></a><!-- doxytag: member="channel.h::channelreloadreason" ref="a49c7ae4d656ef2e220ceae47cb045f2" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="channel_8h.html#a49c7ae4d656ef2e220ceae47cb045f2">channelreloadreason</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Channel reload reasons for manager events at load or reload of configuration. 
<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="a49c7ae4d656ef2e220ceae47cb045f2704c328f9fec2df0f273fc084c46bb5c"></a><!-- doxytag: member="CHANNEL_MODULE_LOAD" ref="a49c7ae4d656ef2e220ceae47cb045f2704c328f9fec2df0f273fc084c46bb5c" args="" -->CHANNEL_MODULE_LOAD</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="a49c7ae4d656ef2e220ceae47cb045f2a6546d2270d01e15c994b899c015a868"></a><!-- doxytag: member="CHANNEL_MODULE_RELOAD" ref="a49c7ae4d656ef2e220ceae47cb045f2a6546d2270d01e15c994b899c015a868" args="" -->CHANNEL_MODULE_RELOAD</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="a49c7ae4d656ef2e220ceae47cb045f2950ce6983714a51f62494c5b16daf99d"></a><!-- doxytag: member="CHANNEL_CLI_RELOAD" ref="a49c7ae4d656ef2e220ceae47cb045f2950ce6983714a51f62494c5b16daf99d" args="" -->CHANNEL_CLI_RELOAD</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="a49c7ae4d656ef2e220ceae47cb045f2ea514ee42bff74ab8030f1b4b39181f9"></a><!-- doxytag: member="CHANNEL_MANAGER_RELOAD" ref="a49c7ae4d656ef2e220ceae47cb045f2ea514ee42bff74ab8030f1b4b39181f9" args="" -->CHANNEL_MANAGER_RELOAD</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l00604">604</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.<div class="fragment"><pre class="fragment"><a name="l00604"></a>00604                          {
<a name="l00605"></a>00605    <a class="code" href="channel_8h.html#a49c7ae4d656ef2e220ceae47cb045f2704c328f9fec2df0f273fc084c46bb5c">CHANNEL_MODULE_LOAD</a>,
<a name="l00606"></a>00606    <a class="code" href="channel_8h.html#a49c7ae4d656ef2e220ceae47cb045f2a6546d2270d01e15c994b899c015a868">CHANNEL_MODULE_RELOAD</a>,
<a name="l00607"></a>00607    <a class="code" href="channel_8h.html#a49c7ae4d656ef2e220ceae47cb045f2950ce6983714a51f62494c5b16daf99d">CHANNEL_CLI_RELOAD</a>,
<a name="l00608"></a>00608    <a class="code" href="channel_8h.html#a49c7ae4d656ef2e220ceae47cb045f2ea514ee42bff74ab8030f1b4b39181f9">CHANNEL_MANAGER_RELOAD</a>,
<a name="l00609"></a>00609 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="71deef3d79d1ff4755afdf2b2cfffdda"></a><!-- doxytag: member="channel.h::__ast_answer" ref="71deef3d79d1ff4755afdf2b2cfffdda" args="(struct ast_channel *chan, unsigned int delay)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int __ast_answer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>delay</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01682">1682</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00435">ast_channel::_state</a>, <a class="el" href="structast__channel__tech.html#bf8caf3c591a413499e37b01bdcf07fa">ast_channel_tech::answer</a>, <a class="el" href="cdr_8c-source.html#l00633">ast_cdr_answer()</a>, <a class="el" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="channel_8c-source.html#l00325">ast_check_hangup()</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73007a1bed17a368c12201a64ef3122bf6f6">AST_FLAG_OUTGOING</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>, <a class="el" href="channel_8c-source.html#l01048">ast_safe_sleep()</a>, <a class="el" href="channel_8c-source.html#l03728">ast_setstate()</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a0789c8ad2fe8eda2081eb587a0bfbe42">AST_STATE_RING</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a85da5b3ea10583d638bc7ce8fe638ec2">AST_STATE_RINGING</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, and <a class="el" href="channel_8h-source.html#l00385">ast_channel::tech</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l01724">ast_answer()</a>, and <a class="el" href="pbx_8c-source.html#l05422">pbx_builtin_answer()</a>.<div class="fragment"><pre class="fragment"><a name="l01683"></a>01683 {
<a name="l01684"></a>01684    <span class="keywordtype">int</span> res = 0;
<a name="l01685"></a>01685 
<a name="l01686"></a>01686    <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l01687"></a>01687 
<a name="l01688"></a>01688    <span class="comment">/* You can't answer an outbound call */</span>
<a name="l01689"></a>01689    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73007a1bed17a368c12201a64ef3122bf6f6">AST_FLAG_OUTGOING</a>)) {
<a name="l01690"></a>01690       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l01691"></a>01691       <span class="keywordflow">return</span> 0;
<a name="l01692"></a>01692    }
<a name="l01693"></a>01693 
<a name="l01694"></a>01694    <span class="comment">/* Stop if we're a zombie or need a soft hangup */</span>
<a name="l01695"></a>01695    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>) || <a class="code" href="channel_8c.html#042e64a8d465783855a52ec8c56a9373">ast_check_hangup</a>(chan)) {
<a name="l01696"></a>01696       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l01697"></a>01697       <span class="keywordflow">return</span> -1;
<a name="l01698"></a>01698    }
<a name="l01699"></a>01699 
<a name="l01700"></a>01700    <span class="keywordflow">switch</span> (chan-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a>) {
<a name="l01701"></a>01701    <span class="keywordflow">case</span> <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a85da5b3ea10583d638bc7ce8fe638ec2">AST_STATE_RINGING</a>:
<a name="l01702"></a>01702    <span class="keywordflow">case</span> <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a0789c8ad2fe8eda2081eb587a0bfbe42">AST_STATE_RING</a>:
<a name="l01703"></a>01703       <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#bf8caf3c591a413499e37b01bdcf07fa">answer</a>)
<a name="l01704"></a>01704          res = chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#bf8caf3c591a413499e37b01bdcf07fa">answer</a>(chan);
<a name="l01705"></a>01705       <a class="code" href="channel_8c.html#c3e562760bdf7c23ebd561ce1352399e">ast_setstate</a>(chan, <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>);
<a name="l01706"></a>01706       <a class="code" href="cdr_8c.html#aa59616c49400bc9f58095b2b3f73781">ast_cdr_answer</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>);
<a name="l01707"></a>01707       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l01708"></a>01708       <span class="keywordflow">if</span> (delay)
<a name="l01709"></a>01709          <a class="code" href="channel_8c.html#24a36b04429e3cdef17e161363c13900">ast_safe_sleep</a>(chan, delay);
<a name="l01710"></a>01710       <span class="keywordflow">return</span> res;
<a name="l01711"></a>01711       <span class="keywordflow">break</span>;
<a name="l01712"></a>01712    <span class="keywordflow">case</span> <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>:
<a name="l01713"></a>01713       <a class="code" href="cdr_8c.html#aa59616c49400bc9f58095b2b3f73781">ast_cdr_answer</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>);
<a name="l01714"></a>01714       <span class="keywordflow">break</span>;
<a name="l01715"></a>01715    <span class="keywordflow">default</span>:
<a name="l01716"></a>01716       <span class="keywordflow">break</span>;
<a name="l01717"></a>01717    }
<a name="l01718"></a>01718 
<a name="l01719"></a>01719    <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l01720"></a>01720 
<a name="l01721"></a>01721    <span class="keywordflow">return</span> res;
<a name="l01722"></a>01722 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="84fcc4e022cb699f8f14c9f3aaeadd2b"></a><!-- doxytag: member="channel.h::__ast_request_and_dial" ref="84fcc4e022cb699f8f14c9f3aaeadd2b" args="(const char *type, int format, void *data, int timeout, int *reason, const char *cidnum, const char *cidname, struct outgoing_helper *oh)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a>* __ast_request_and_dial           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>timeout</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>reason</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cidnum</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cidname</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structoutgoing__helper.html">outgoing_helper</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>oh</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l02932">2932</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00435">ast_channel::_state</a>, <a class="el" href="channel_8h-source.html#l00578">outgoing_helper::account</a>, <a class="el" href="channel_8c-source.html#l03114">ast_call()</a>, <a class="el" href="causes_8h-source.html#l00135">AST_CAUSE_BUSY</a>, <a class="el" href="causes_8h-source.html#l00139">AST_CAUSE_CONGESTION</a>, <a class="el" href="cdr_8c-source.html#l00460">ast_cdr_alloc()</a>, <a class="el" href="cdr_8c-source.html#l00684">ast_cdr_disposition()</a>, <a class="el" href="cdr_8c-source.html#l00788">ast_cdr_end()</a>, <a class="el" href="cdr_8c-source.html#l00657">ast_cdr_failed()</a>, <a class="el" href="cdr_8c-source.html#l00763">ast_cdr_init()</a>, <a class="el" href="cdr_8c-source.html#l00834">ast_cdr_setaccount()</a>, <a class="el" href="cdr_8c-source.html#l00718">ast_cdr_setapp()</a>, <a class="el" href="cdr_8c-source.html#l00620">ast_cdr_start()</a>, <a class="el" href="cdr_8c-source.html#l00885">ast_cdr_update()</a>, <a class="el" href="channel_8c-source.html#l01195">ast_channel_datastore_inherit()</a>, <a class="el" href="channel_8c-source.html#l03341">ast_channel_inherit_variables()</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389edaaffc26d24394cd2557ddb1db10f64">AST_CONTROL_ANSWER</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3898c0ff5febeb7ff9d8880e2bc7f1d6ca1">AST_CONTROL_BUSY</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389fafe5e503d0d74218854b57e66282419">AST_CONTROL_CONGESTION</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3896a1de835fbf024ef925569eb775de67f">AST_CONTROL_HANGUP</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389dcaa1b03a8c60073c53c1b662418697f">AST_CONTROL_HOLD</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389e3f77da12f7cbd7a9abfd7c8ce7bfb2b">AST_CONTROL_PROCEEDING</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389ba3a8e0de0c6348205ffdc9e446af14f">AST_CONTROL_PROGRESS</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3895749da867c771f2391b19ce9e08f0149">AST_CONTROL_RINGING</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389582c81bc89b064f8093864a6c023a823">AST_CONTROL_UNHOLD</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3897e8f2fe3be94657a962aa673f0c449e5">AST_CONTROL_VIDUPDATE</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a>, <a class="el" href="frame_8h-source.html#l00396">ast_frfree()</a>, <a class="el" href="channel_8c-source.html#l01598">ast_hangup()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="channel_8c-source.html#l02438">ast_read()</a>, <a class="el" href="channel_8c-source.html#l03063">ast_request()</a>, <a class="el" href="channel_8c-source.html#l03694">ast_set_callerid()</a>, <a class="el" href="channel_8c-source.html#l04486">ast_set_variables()</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="channel_8c-source.html#l01952">ast_waitfor()</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, <a class="el" href="channel_8h-source.html#l00577">outgoing_helper::cid_name</a>, <a class="el" href="channel_8h-source.html#l00576">outgoing_helper::cid_num</a>, <a class="el" href="channel_8h-source.html#l00441">ast_channel::context</a>, <a class="el" href="channel_8h-source.html#l00573">outgoing_helper::context</a>, <a class="el" href="channel_8h-source.html#l00442">ast_channel::exten</a>, <a class="el" href="channel_8h-source.html#l00574">outgoing_helper::exten</a>, <a class="el" href="format__g726_8c-source.html#l00193">f</a>, <a class="el" href="frame_8h-source.html#l00131">ast_frame::frametype</a>, <a class="el" href="channel_8h-source.html#l00466">ast_channel::hangupcause</a>, <a class="el" href="logger_8h-source.html#l00106">LOG_NOTICE</a>, <a class="el" href="channel_8h-source.html#l00580">outgoing_helper::parent_channel</a>, <a class="el" href="channel_8h-source.html#l00443">ast_channel::priority</a>, <a class="el" href="channel_8h-source.html#l00575">outgoing_helper::priority</a>, <a class="el" href="frame_8h-source.html#l00133">ast_frame::subclass</a>, and <a class="el" href="channel_8h-source.html#l00579">outgoing_helper::vars</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l05150">ast_pbx_outgoing_app()</a>, <a class="el" href="pbx_8c-source.html#l04991">ast_pbx_outgoing_exten()</a>, and <a class="el" href="channel_8c-source.html#l03058">ast_request_and_dial()</a>.<div class="fragment"><pre class="fragment"><a name="l02933"></a>02933 {
<a name="l02934"></a>02934    <span class="keywordtype">int</span> dummy_outstate;
<a name="l02935"></a>02935    <span class="keywordtype">int</span> cause = 0;
<a name="l02936"></a>02936    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>;
<a name="l02937"></a>02937    <span class="keywordtype">int</span> res = 0;
<a name="l02938"></a>02938    
<a name="l02939"></a>02939    <span class="keywordflow">if</span> (outstate)
<a name="l02940"></a>02940       *outstate = 0;
<a name="l02941"></a>02941    <span class="keywordflow">else</span>
<a name="l02942"></a>02942       outstate = &amp;dummy_outstate;   <span class="comment">/* make outstate always a valid pointer */</span>
<a name="l02943"></a>02943 
<a name="l02944"></a>02944    chan = <a class="code" href="channel_8c.html#e6f72d6b14d12c48f2e224412f10fb99">ast_request</a>(<a class="code" href="rtp_8c.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, <a class="code" href="chan__alsa_8c.html#1ddcb92ade31c8fbd370001f9b29a7d9">format</a>, <a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a>, &amp;cause);
<a name="l02945"></a>02945    <span class="keywordflow">if</span> (!chan) {
<a name="l02946"></a>02946       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#bbf95aad74d847cd4bcb129604f798cd">LOG_NOTICE</a>, <span class="stringliteral">"Unable to request channel %s/%s\n"</span>, <a class="code" href="rtp_8c.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, (<span class="keywordtype">char</span> *)<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l02947"></a>02947       <span class="comment">/* compute error and return */</span>
<a name="l02948"></a>02948       <span class="keywordflow">if</span> (cause == <a class="code" href="causes_8h.html#e8b101dee08334fa50ac3eceb4261151">AST_CAUSE_BUSY</a>)
<a name="l02949"></a>02949          *outstate = <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3898c0ff5febeb7ff9d8880e2bc7f1d6ca1">AST_CONTROL_BUSY</a>;
<a name="l02950"></a>02950       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cause == <a class="code" href="causes_8h.html#a1614c968769ae08b46b0d0f000b85e8">AST_CAUSE_CONGESTION</a>)
<a name="l02951"></a>02951          *outstate = <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389fafe5e503d0d74218854b57e66282419">AST_CONTROL_CONGESTION</a>;
<a name="l02952"></a>02952       <span class="keywordflow">return</span> NULL;
<a name="l02953"></a>02953    }
<a name="l02954"></a>02954 
<a name="l02955"></a>02955    <span class="keywordflow">if</span> (oh) {
<a name="l02956"></a>02956       <span class="keywordflow">if</span> (oh-&gt;<a class="code" href="structoutgoing__helper.html#b63119da730344b345cdc8f62a4711e9">vars</a>)  
<a name="l02957"></a>02957          <a class="code" href="channel_8c.html#ee674fb53b907cc57dda6e54ac24a637">ast_set_variables</a>(chan, oh-&gt;<a class="code" href="structoutgoing__helper.html#b63119da730344b345cdc8f62a4711e9">vars</a>);
<a name="l02958"></a>02958       <span class="comment">/* XXX why is this necessary, for the parent_channel perhaps ? */</span>
<a name="l02959"></a>02959       <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(oh-&gt;<a class="code" href="structoutgoing__helper.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>) &amp;&amp; !<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(oh-&gt;<a class="code" href="structoutgoing__helper.html#51ae63e8ccffb05b130f96cc397ec7b0">cid_name</a>))
<a name="l02960"></a>02960          <a class="code" href="channel_8c.html#7f8abba078071d5d796f25ebc9198974">ast_set_callerid</a>(chan, oh-&gt;<a class="code" href="structoutgoing__helper.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>, oh-&gt;<a class="code" href="structoutgoing__helper.html#51ae63e8ccffb05b130f96cc397ec7b0">cid_name</a>, oh-&gt;<a class="code" href="structoutgoing__helper.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>);
<a name="l02961"></a>02961       <span class="keywordflow">if</span> (oh-&gt;<a class="code" href="structoutgoing__helper.html#61b4aeaf61a5a027c4783915d73aa2ae">parent_channel</a>) {
<a name="l02962"></a>02962          <a class="code" href="channel_8c.html#8fb30ace7afdc2899f9b9cdafbf49ff7">ast_channel_inherit_variables</a>(oh-&gt;<a class="code" href="structoutgoing__helper.html#61b4aeaf61a5a027c4783915d73aa2ae">parent_channel</a>, chan);
<a name="l02963"></a>02963          <a class="code" href="channel_8c.html#7ccb0875d5b63754a9c968f5dbb92d99">ast_channel_datastore_inherit</a>(oh-&gt;<a class="code" href="structoutgoing__helper.html#61b4aeaf61a5a027c4783915d73aa2ae">parent_channel</a>, chan);
<a name="l02964"></a>02964       }
<a name="l02965"></a>02965       <span class="keywordflow">if</span> (oh-&gt;<a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a>)
<a name="l02966"></a>02966          <a class="code" href="cdr_8c.html#8aa58d36e6bd15ba7d10e367d9870e60">ast_cdr_setaccount</a>(chan, oh-&gt;<a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a>); 
<a name="l02967"></a>02967    }
<a name="l02968"></a>02968    <a class="code" href="channel_8c.html#7f8abba078071d5d796f25ebc9198974">ast_set_callerid</a>(chan, <a class="code" href="chan__mgcp_8c.html#ca3c0eb6b6e898f3a32aed5de1320774">cid_num</a>, <a class="code" href="chan__mgcp_8c.html#70f178a59d8df82fe5e107da71415b9b">cid_name</a>, <a class="code" href="chan__mgcp_8c.html#ca3c0eb6b6e898f3a32aed5de1320774">cid_num</a>);
<a name="l02969"></a>02969 
<a name="l02970"></a>02970    
<a name="l02971"></a>02971 
<a name="l02972"></a>02972    <span class="keywordflow">if</span> (!chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>) { <span class="comment">/* up till now, this insertion hasn't been done. Therefore,</span>
<a name="l02973"></a>02973 <span class="comment">            to keep from throwing off the basic order of the universe,</span>
<a name="l02974"></a>02974 <span class="comment">            we will try to keep this cdr from getting posted. */</span>
<a name="l02975"></a>02975       chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a> = <a class="code" href="cdr_8c.html#0dd431954a27c67f78c6e13be8a0b136">ast_cdr_alloc</a>();
<a name="l02976"></a>02976       <a class="code" href="cdr_8c.html#4d85bb268956ffbf0b19df25915726e8">ast_cdr_init</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>, chan);
<a name="l02977"></a>02977       <a class="code" href="cdr_8c.html#56e1b7b9d5acada4d22d345813710582">ast_cdr_start</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>);
<a name="l02978"></a>02978    }
<a name="l02979"></a>02979    <span class="keywordflow">if</span> (<a class="code" href="channel_8c.html#37e2b9b65c43c783c6b43552cd20b438">ast_call</a>(chan, <a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a>, 0)) {   <span class="comment">/* ast_call failed... */</span>
<a name="l02980"></a>02980       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(LOG_NOTICE, <span class="stringliteral">"Unable to call channel %s/%s\n"</span>, <a class="code" href="rtp_8c.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, (<span class="keywordtype">char</span> *)<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l02981"></a>02981    } <span class="keywordflow">else</span> {
<a name="l02982"></a>02982       res = 1; <span class="comment">/* mark success in case chan-&gt;_state is already AST_STATE_UP */</span>
<a name="l02983"></a>02983       <span class="keywordflow">while</span> (timeout &amp;&amp; chan-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a> != <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>) {
<a name="l02984"></a>02984          <span class="keyword">struct </span><a class="code" href="structast__frame.html">ast_frame</a> *<a class="code" href="format__g726_8c.html#85b9b17a7dd34a3638c560bc9152473b">f</a>;
<a name="l02985"></a>02985          res = <a class="code" href="channel_8c.html#e02dcdf40023f275d4561a930e7a7fc9">ast_waitfor</a>(chan, timeout);
<a name="l02986"></a>02986          <span class="keywordflow">if</span> (res &lt;= 0) <span class="comment">/* error, timeout, or done */</span>
<a name="l02987"></a>02987             <span class="keywordflow">break</span>;
<a name="l02988"></a>02988          <span class="keywordflow">if</span> (timeout &gt; -1)
<a name="l02989"></a>02989             timeout = res;
<a name="l02990"></a>02990          f = <a class="code" href="channel_8c.html#1446a8c0bddf626bf26b000fbeae117f">ast_read</a>(chan);
<a name="l02991"></a>02991          <span class="keywordflow">if</span> (!f) {
<a name="l02992"></a>02992             *outstate = <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3896a1de835fbf024ef925569eb775de67f">AST_CONTROL_HANGUP</a>;
<a name="l02993"></a>02993             res = 0;
<a name="l02994"></a>02994             <span class="keywordflow">break</span>;
<a name="l02995"></a>02995          }
<a name="l02996"></a>02996          <span class="keywordflow">if</span> (f-&gt;<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a> == <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a>) {
<a name="l02997"></a>02997             <span class="keywordflow">switch</span> (f-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a>) {
<a name="l02998"></a>02998             <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3895749da867c771f2391b19ce9e08f0149">AST_CONTROL_RINGING</a>:  <span class="comment">/* record but keep going */</span>
<a name="l02999"></a>02999                *outstate = f-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a>;
<a name="l03000"></a>03000                <span class="keywordflow">break</span>;
<a name="l03001"></a>03001 
<a name="l03002"></a>03002             <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3898c0ff5febeb7ff9d8880e2bc7f1d6ca1">AST_CONTROL_BUSY</a>:
<a name="l03003"></a>03003             <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389fafe5e503d0d74218854b57e66282419">AST_CONTROL_CONGESTION</a>:
<a name="l03004"></a>03004             <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389edaaffc26d24394cd2557ddb1db10f64">AST_CONTROL_ANSWER</a>:
<a name="l03005"></a>03005                *outstate = f-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a>;
<a name="l03006"></a>03006                timeout = 0;      <span class="comment">/* trick to force exit from the while() */</span>
<a name="l03007"></a>03007                <span class="keywordflow">break</span>;
<a name="l03008"></a>03008 
<a name="l03009"></a>03009             <span class="comment">/* Ignore these */</span>
<a name="l03010"></a>03010             <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389ba3a8e0de0c6348205ffdc9e446af14f">AST_CONTROL_PROGRESS</a>:
<a name="l03011"></a>03011             <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389e3f77da12f7cbd7a9abfd7c8ce7bfb2b">AST_CONTROL_PROCEEDING</a>:
<a name="l03012"></a>03012             <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389dcaa1b03a8c60073c53c1b662418697f">AST_CONTROL_HOLD</a>:
<a name="l03013"></a>03013             <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389582c81bc89b064f8093864a6c023a823">AST_CONTROL_UNHOLD</a>:
<a name="l03014"></a>03014             <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3897e8f2fe3be94657a962aa673f0c449e5">AST_CONTROL_VIDUPDATE</a>:
<a name="l03015"></a>03015             <span class="keywordflow">case</span> -1:       <span class="comment">/* Ignore -- just stopping indications */</span>
<a name="l03016"></a>03016                <span class="keywordflow">break</span>;
<a name="l03017"></a>03017 
<a name="l03018"></a>03018             <span class="keywordflow">default</span>:
<a name="l03019"></a>03019                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(LOG_NOTICE, <span class="stringliteral">"Don't know what to do with control frame %d\n"</span>, f-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a>);
<a name="l03020"></a>03020             }
<a name="l03021"></a>03021          }
<a name="l03022"></a>03022          <a class="code" href="frame_8h.html#506c759ec4950e7f7465e8f090a6252b">ast_frfree</a>(f);
<a name="l03023"></a>03023       }
<a name="l03024"></a>03024    }
<a name="l03025"></a>03025 
<a name="l03026"></a>03026    <span class="comment">/* Final fixups */</span>
<a name="l03027"></a>03027    <span class="keywordflow">if</span> (oh) {
<a name="l03028"></a>03028       <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(oh-&gt;<a class="code" href="structoutgoing__helper.html#5c18ef72771564b7f43c497dc507aeab">context</a>))
<a name="l03029"></a>03029          ast_copy_string(chan-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, oh-&gt;<a class="code" href="structoutgoing__helper.html#5c18ef72771564b7f43c497dc507aeab">context</a>, <span class="keyword">sizeof</span>(chan-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>));
<a name="l03030"></a>03030       <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(oh-&gt;<a class="code" href="structoutgoing__helper.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>))
<a name="l03031"></a>03031          ast_copy_string(chan-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, oh-&gt;<a class="code" href="structoutgoing__helper.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>, <span class="keyword">sizeof</span>(chan-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>));
<a name="l03032"></a>03032       <span class="keywordflow">if</span> (oh-&gt;<a class="code" href="structoutgoing__helper.html#b988295c268025b49dfb3df26171ddc3">priority</a>) 
<a name="l03033"></a>03033          chan-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a> = oh-&gt;<a class="code" href="structoutgoing__helper.html#b988295c268025b49dfb3df26171ddc3">priority</a>;
<a name="l03034"></a>03034    }
<a name="l03035"></a>03035    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a> == <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>)
<a name="l03036"></a>03036       *outstate = <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389edaaffc26d24394cd2557ddb1db10f64">AST_CONTROL_ANSWER</a>;
<a name="l03037"></a>03037 
<a name="l03038"></a>03038    <span class="keywordflow">if</span> (res &lt;= 0) {
<a name="l03039"></a>03039       <span class="keywordflow">if</span> (!chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a> &amp;&amp; (chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a> = <a class="code" href="cdr_8c.html#0dd431954a27c67f78c6e13be8a0b136">ast_cdr_alloc</a>()))
<a name="l03040"></a>03040          <a class="code" href="cdr_8c.html#4d85bb268956ffbf0b19df25915726e8">ast_cdr_init</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>, chan);
<a name="l03041"></a>03041       <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>) {
<a name="l03042"></a>03042          <span class="keywordtype">char</span> tmp[256];
<a name="l03043"></a>03043          snprintf(tmp, <span class="keyword">sizeof</span>(tmp), <span class="stringliteral">"%s/%s"</span>, <a class="code" href="rtp_8c.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, (<span class="keywordtype">char</span> *)<a class="code" href="structast__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l03044"></a>03044          <a class="code" href="cdr_8c.html#018b6c8a00209b6cf1fd7386b493f930">ast_cdr_setapp</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>,<span class="stringliteral">"Dial"</span>,tmp);
<a name="l03045"></a>03045          <a class="code" href="cdr_8c.html#0247fba893abcaf42f3861b4982361db">ast_cdr_update</a>(chan);
<a name="l03046"></a>03046          <a class="code" href="cdr_8c.html#56e1b7b9d5acada4d22d345813710582">ast_cdr_start</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>);
<a name="l03047"></a>03047          <a class="code" href="cdr_8c.html#545d0bb7a87e9317b6eb3ce2245145cc">ast_cdr_end</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>);
<a name="l03048"></a>03048          <span class="comment">/* If the cause wasn't handled properly */</span>
<a name="l03049"></a>03049          <span class="keywordflow">if</span> (<a class="code" href="cdr_8c.html#995ca95113dc7070faca1a0969a72eb9">ast_cdr_disposition</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>,chan-&gt;<a class="code" href="structast__channel.html#8be5f831332d8ff714e90c2cf85171fe">hangupcause</a>))
<a name="l03050"></a>03050             <a class="code" href="cdr_8c.html#3f2e573eb7fde7a250ca8aa95a0d367d">ast_cdr_failed</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>);
<a name="l03051"></a>03051       }
<a name="l03052"></a>03052       <a class="code" href="channel_8c.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a>(chan);
<a name="l03053"></a>03053       chan = NULL;
<a name="l03054"></a>03054    }
<a name="l03055"></a>03055    <span class="keywordflow">return</span> chan;
<a name="l03056"></a>03056 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="51350b9fba7a6a2428e1b3a13a131d54"></a><!-- doxytag: member="channel.h::ast_activate_generator" ref="51350b9fba7a6a2428e1b3a13a131d54" args="(struct ast_channel *chan, struct ast_generator *gen, void *params)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_activate_generator           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__generator.html">ast_generator</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>gen</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>params</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Activate a given generator 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l01764">1764</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="structast__generator.html#ec716dadc257b3894e8a1a75177d4283">ast_generator::alloc</a>, <a class="el" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="channel_8c-source.html#l02631">ast_prod()</a>, <a class="el" href="channel_8c-source.html#l01968">ast_settimeout()</a>, <a class="el" href="channel_8h-source.html#l00404">ast_channel::generator</a>, <a class="el" href="channel_8c-source.html#l01744">generator_force()</a>, <a class="el" href="channel_8h-source.html#l00403">ast_channel::generatordata</a>, and <a class="el" href="structast__generator.html#62e15df14a257d6ac9725e39389d5b5a">ast_generator::release</a>.
<p>
Referenced by <a class="el" href="app__externalivr_8c-source.html#l00244">app_exec()</a>, <a class="el" href="channel_8c-source.html#l04654">ast_channel_start_silence_generator()</a>, <a class="el" href="app_8c-source.html#l00355">ast_linear_stream()</a>, <a class="el" href="indications_8c-source.html#l00220">ast_playtones_start()</a>, <a class="el" href="channel_8c-source.html#l04343">ast_tonepair_start()</a>, <a class="el" href="app__chanspy_8c-source.html#l00266">channel_spy()</a>, <a class="el" href="res__musiconhold_8c-source.html#l00952">local_ast_moh_start()</a>, <a class="el" href="app__milliwatt_8c-source.html#l00113">milliwatt_exec()</a>, and <a class="el" href="app__sms_8c-source.html#l01748">sms_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l01765"></a>01765 {
<a name="l01766"></a>01766    <span class="keywordtype">int</span> res = 0;
<a name="l01767"></a>01767 
<a name="l01768"></a>01768    <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l01769"></a>01769 
<a name="l01770"></a>01770    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#68e80cee708fd0cdfb20807a8663721d">generatordata</a>) {
<a name="l01771"></a>01771       <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#dac9630aec642a428cd73f4be0a03569">generator</a> &amp;&amp; chan-&gt;<a class="code" href="structast__channel.html#dac9630aec642a428cd73f4be0a03569">generator</a>-&gt;<a class="code" href="structast__generator.html#62e15df14a257d6ac9725e39389d5b5a">release</a>)
<a name="l01772"></a>01772          chan-&gt;<a class="code" href="structast__channel.html#dac9630aec642a428cd73f4be0a03569">generator</a>-&gt;<a class="code" href="structast__generator.html#62e15df14a257d6ac9725e39389d5b5a">release</a>(chan, chan-&gt;<a class="code" href="structast__channel.html#68e80cee708fd0cdfb20807a8663721d">generatordata</a>);
<a name="l01773"></a>01773       chan-&gt;<a class="code" href="structast__channel.html#68e80cee708fd0cdfb20807a8663721d">generatordata</a> = NULL;
<a name="l01774"></a>01774    }
<a name="l01775"></a>01775 
<a name="l01776"></a>01776    <a class="code" href="channel_8c.html#1e5a4ef714eb64bfdc55813ba363bd67">ast_prod</a>(chan);
<a name="l01777"></a>01777    <span class="keywordflow">if</span> (gen-&gt;<a class="code" href="structast__generator.html#ec716dadc257b3894e8a1a75177d4283">alloc</a> &amp;&amp; !(chan-&gt;<a class="code" href="structast__channel.html#68e80cee708fd0cdfb20807a8663721d">generatordata</a> = gen-&gt;<a class="code" href="structast__generator.html#ec716dadc257b3894e8a1a75177d4283">alloc</a>(chan, params))) {
<a name="l01778"></a>01778       res = -1;
<a name="l01779"></a>01779    }
<a name="l01780"></a>01780    
<a name="l01781"></a>01781    <span class="keywordflow">if</span> (!res) {
<a name="l01782"></a>01782       <a class="code" href="channel_8c.html#031ef8a01f979ba2f40451d97a515e80">ast_settimeout</a>(chan, 160, <a class="code" href="channel_8c.html#e4622c5b41999a7ddad23f05242dca4d">generator_force</a>, chan);
<a name="l01783"></a>01783       chan-&gt;<a class="code" href="structast__channel.html#dac9630aec642a428cd73f4be0a03569">generator</a> = gen;
<a name="l01784"></a>01784    }
<a name="l01785"></a>01785 
<a name="l01786"></a>01786    <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l01787"></a>01787 
<a name="l01788"></a>01788    <span class="keywordflow">return</span> res;
<a name="l01789"></a>01789 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="126867ace3f9eaaf4d1cf954f5907451"></a><!-- doxytag: member="channel.h::ast_active_channels" ref="126867ace3f9eaaf4d1cf954f5907451" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_active_channels           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
returns number of active/allocated channels 
<p>
Returns number of active/allocated channels 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l00362">362</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00038">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, and <a class="el" href="linkedlists_8h-source.html#l00104">AST_LIST_UNLOCK</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l02244">action_corestatus()</a>, <a class="el" href="asterisk_8c-source.html#l00344">handle_show_settings()</a>, and <a class="el" href="asterisk_8c-source.html#l01201">quit_handler()</a>.<div class="fragment"><pre class="fragment"><a name="l00363"></a>00363 {
<a name="l00364"></a>00364    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *c;
<a name="l00365"></a>00365    <span class="keywordtype">int</span> cnt = 0;
<a name="l00366"></a>00366    <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;channels);
<a name="l00367"></a>00367    <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;channels, c, <a class="code" href="structchan__list.html">chan_list</a>)
<a name="l00368"></a>00368       cnt++;
<a name="l00369"></a>00369    <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;channels);
<a name="l00370"></a>00370    return cnt;
<a name="l00371"></a>00371 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ac55a99c346024715138883ba689718c"></a><!-- doxytag: member="channel.h::ast_add_fd" ref="ac55a99c346024715138883ba689718c" args="(struct pollfd *pfd, int fd)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int ast_add_fd           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structpollfd.html">pollfd</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pfd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [inline, static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
if fd is a valid descriptor, set *pfd with the descriptor 
<p>
<dl compact><dt><b>Returns:</b></dt><dd>Return 1 (not -1!) if added, 0 otherwise (so we can add the return value to the index into the array) </dd></dl>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l01306">1306</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.
<p>
References <a class="el" href="poll-compat_8h-source.html#l00092">pollfd::events</a>, <a class="el" href="poll-compat_8h-source.html#l00091">pollfd::fd</a>, <a class="el" href="poll-compat_8h-source.html#l00082">POLLIN</a>, and <a class="el" href="poll-compat_8h-source.html#l00083">POLLPRI</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l01800">ast_waitfor_nandfds()</a>.<div class="fragment"><pre class="fragment"><a name="l01307"></a>01307 {
<a name="l01308"></a>01308    pfd-&gt;<a class="code" href="structpollfd.html#36eba1e1e343279857ea7f69a597324e">fd</a> = fd;
<a name="l01309"></a>01309    pfd-&gt;<a class="code" href="structpollfd.html#16908b0605f2645dfcb4c3a8d248cef3">events</a> = <a class="code" href="poll-compat_8h.html#c423ee153c4a19da179e8bc59ae48962">POLLIN</a> | <a class="code" href="poll-compat_8h.html#eb4a8029b132eaf617bfae72e35f8595">POLLPRI</a>;
<a name="l01310"></a>01310    <span class="keywordflow">return</span> fd &gt;= 0;
<a name="l01311"></a>01311 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="9e089c979b071a1df466a09497fdfa31"></a><!-- doxytag: member="channel.h::ast_answer" ref="9e089c979b071a1df466a09497fdfa31" args="(struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_answer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chan</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Answer a channel. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to answer This function answers a channel and handles all necessary call setup functions. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns 0 on success, non-zero on failure </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01724">1724</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l01682">__ast_answer()</a>.
<p>
Referenced by <a class="el" href="chan__agent_8c-source.html#l01763">__login_exec()</a>, <a class="el" href="res__features_8c-source.html#l02163">action_bridge()</a>, <a class="el" href="res__agi_8c-source.html#l02033">agi_exec_full()</a>, <a class="el" href="app__alarmreceiver_8c-source.html#l00635">alarmreceiver_exec()</a>, <a class="el" href="app__externalivr_8c-source.html#l00244">app_exec()</a>, <a class="el" href="res__features_8c-source.html#l01478">ast_bridge_call()</a>, <a class="el" href="app_8c-source.html#l00384">ast_control_streamfile()</a>, <a class="el" href="res__features_8c-source.html#l02403">ast_pickup_call()</a>, <a class="el" href="app__authenticate_8c-source.html#l00094">auth_exec()</a>, <a class="el" href="app__talkdetect_8c-source.html#l00063">background_detect_exec()</a>, <a class="el" href="res__features_8c-source.html#l02716">bridge_exec()</a>, <a class="el" href="res__features_8c-source.html#l00529">builtin_parkcall()</a>, <a class="el" href="app__chanspy_8c-source.html#l00465">common_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l02485">conf_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l02434">count_exec()</a>, <a class="el" href="app__dictate_8c-source.html#l00079">dictate_exec()</a>, <a class="el" href="app__directory_8c-source.html#l00570">directory_exec()</a>, <a class="el" href="app__disa_8c-source.html#l00113">disa_exec()</a>, <a class="el" href="chan__features_8c-source.html#l00227">features_answer()</a>, <a class="el" href="res__agi_8c-source.html#l00408">handle_answer()</a>, <a class="el" href="app__ices_8c-source.html#l00104">ices_exec()</a>, <a class="el" href="app__milliwatt_8c-source.html#l00113">milliwatt_exec()</a>, <a class="el" href="app__minivm_8c-source.html#l02065">minivm_accmess_exec()</a>, <a class="el" href="app__minivm_8c-source.html#l01818">minivm_greet_exec()</a>, <a class="el" href="app__minivm_8c-source.html#l01751">minivm_record_exec()</a>, <a class="el" href="res__features_8c-source.html#l01938">park_call_exec()</a>, <a class="el" href="pbx_8c-source.html#l05642">pbx_builtin_background()</a>, <a class="el" href="app__directed__pickup_8c-source.html#l00058">pickup_do()</a>, <a class="el" href="app__playback_8c-source.html#l00378">playback_exec()</a>, <a class="el" href="app__privacy_8c-source.html#l00078">privacy_exec()</a>, <a class="el" href="app__read_8c-source.html#l00087">read_exec()</a>, <a class="el" href="app__record_8c-source.html#l00078">record_exec()</a>, <a class="el" href="app__rpt_8c-source.html#l06759">rpt_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l03291">run_station()</a>, <a class="el" href="app__sayunixtime_8c-source.html#l00069">sayunixtime_exec()</a>, <a class="el" href="app__festival_8c-source.html#l00171">send_waveform_to_channel()</a>, <a class="el" href="app__ivrdemo_8c-source.html#l00092">skel_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l03449">sla_handle_dial_state_event()</a>, <a class="el" href="app__meetme_8c-source.html#l04166">sla_station_exec()</a>, <a class="el" href="app__sms_8c-source.html#l01748">sms_exec()</a>, <a class="el" href="app__speech__utils_8c-source.html#l00543">speech_background()</a>, <a class="el" href="app__test_8c-source.html#l00131">testclient_exec()</a>, <a class="el" href="app__test_8c-source.html#l00322">testserver_exec()</a>, <a class="el" href="app__voicemail_8c-source.html#l06944">vm_exec()</a>, <a class="el" href="app__voicemail_8c-source.html#l06398">vm_execmain()</a>, <a class="el" href="app__waitforsilence_8c-source.html#l00160">waitforsilence_exec()</a>, <a class="el" href="app__zapateller_8c-source.html#l00059">zapateller_exec()</a>, and <a class="el" href="app__zapras_8c-source.html#l00201">zapras_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l01725"></a>01725 {
<a name="l01726"></a>01726    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#71deef3d79d1ff4755afdf2b2cfffdda">__ast_answer</a>(chan, 500);
<a name="l01727"></a>01727 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="50d164d68da7c101dd0eadd519069afd"></a><!-- doxytag: member="channel.h::ast_autoservice_start" ref="50d164d68da7c101dd0eadd519069afd" args="(struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_autoservice_start           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chan</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Automatically service a channel for us... 
<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>failure, or the channel is already being autoserviced </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="autoservice_8c-source.html#l00096">96</a> of file <a class="el" href="autoservice_8c-source.html">autoservice.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="utils_8h-source.html#l00307">ast_pthread_create_background</a>, <a class="el" href="lock_8h-source.html#l00074">AST_PTHREADT_NULL</a>, <a class="el" href="linkedlists_8h-source.html#l00657">AST_RWLIST_INSERT_HEAD</a>, <a class="el" href="linkedlists_8h-source.html#l00749">AST_RWLIST_REMOVE</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="autoservice_8c-source.html#l00062">asthread</a>, <a class="el" href="autoservice_8c-source.html#l00064">autoservice_run()</a>, <a class="el" href="autoservice_8c-source.html#l00056">asent::chan</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, and <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>.
<p>
Referenced by <a class="el" href="app__macro_8c-source.html#l00144">_macro_exec()</a>, <a class="el" href="app_8c-source.html#l00236">ast_dtmf_stream()</a>, <a class="el" href="enum_8c-source.html#l00367">ast_get_enum()</a>, <a class="el" href="srv_8c-source.html#l00119">ast_get_srv()</a>, <a class="el" href="enum_8c-source.html#l00540">ast_get_txt()</a>, <a class="el" href="channel_8c-source.html#l03763">bridge_playfile()</a>, <a class="el" href="res__features_8c-source.html#l00776">builtin_atxfer()</a>, <a class="el" href="res__features_8c-source.html#l00562">builtin_automonitor()</a>, <a class="el" href="res__features_8c-source.html#l00673">builtin_blindtransfer()</a>, <a class="el" href="app__meetme_8c-source.html#l00685">conf_play()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="res__features_8c-source.html#l01098">feature_exec_app()</a>, <a class="el" href="app__osplookup_8c-source.html#l01415">osplookup_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l04166">sla_station_exec()</a>, and <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>.<div class="fragment"><pre class="fragment"><a name="l00097"></a>00097 {
<a name="l00098"></a>00098    <span class="keywordtype">int</span> res = -1;
<a name="l00099"></a>00099    <span class="keyword">struct </span><a class="code" href="structasent.html">asent</a> *as;
<a name="l00100"></a>00100 
<a name="l00101"></a>00101    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;aslist);
<a name="l00102"></a>00102 
<a name="l00103"></a>00103    <span class="comment">/* Check if the channel already has autoservice */</span>
<a name="l00104"></a>00104    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;aslist, as, list) {
<a name="l00105"></a>00105       <span class="keywordflow">if</span> (as-&gt;<a class="code" href="structasent.html#26c322652770620e64ac90682eb6504c">chan</a> == chan)
<a name="l00106"></a>00106          <span class="keywordflow">break</span>;
<a name="l00107"></a>00107    }
<a name="l00108"></a>00108 
<a name="l00109"></a>00109    <span class="comment">/* If not, start autoservice on channel */</span>
<a name="l00110"></a>00110    <span class="keywordflow">if</span> (!as &amp;&amp; (as = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*as)))) {
<a name="l00111"></a>00111       as-&gt;chan = chan;
<a name="l00112"></a>00112       <a class="code" href="linkedlists_8h.html#b4592c522c6b3831f739508553316599">AST_RWLIST_INSERT_HEAD</a>(&amp;aslist, as, list);
<a name="l00113"></a>00113       res = 0;
<a name="l00114"></a>00114       <span class="keywordflow">if</span> (<a class="code" href="autoservice_8c.html#de6a9732ddb6daf48eda1027e66c9616">asthread</a> == <a class="code" href="lock_8h.html#84e4b34008de83ea9d1fa44057758022">AST_PTHREADT_NULL</a>) { <span class="comment">/* need start the thread */</span>
<a name="l00115"></a>00115          <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#351b78c7aeb62b2b57eb447287cdd9d4">ast_pthread_create_background</a>(&amp;<a class="code" href="autoservice_8c.html#de6a9732ddb6daf48eda1027e66c9616">asthread</a>, NULL, <a class="code" href="autoservice_8c.html#eef6358ad22a1d2289abd6397cee3f1b">autoservice_run</a>, NULL)) {
<a name="l00116"></a>00116             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Unable to create autoservice thread :(\n"</span>);
<a name="l00117"></a>00117             <span class="comment">/* There will only be a single member in the list at this point,</span>
<a name="l00118"></a>00118 <span class="comment">               the one we just added. */</span>
<a name="l00119"></a>00119             <a class="code" href="linkedlists_8h.html#dd27d7fa9f70ab8e5e35161cafdd0459">AST_RWLIST_REMOVE</a>(&amp;aslist, as, list);
<a name="l00120"></a>00120             <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(as);
<a name="l00121"></a>00121             res = -1;
<a name="l00122"></a>00122          } <span class="keywordflow">else</span>
<a name="l00123"></a>00123             pthread_kill(asthread, SIGURG);
<a name="l00124"></a>00124       }
<a name="l00125"></a>00125    }
<a name="l00126"></a>00126    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;aslist);
<a name="l00127"></a>00127    <span class="keywordflow">return</span> res;
<a name="l00128"></a>00128 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="f982194640c676dffb9052dacb2b21fd"></a><!-- doxytag: member="channel.h::ast_autoservice_stop" ref="f982194640c676dffb9052dacb2b21fd" args="(struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_autoservice_stop           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chan</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Stop servicing a channel for us... 
<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>error, or the channel has been hungup </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="autoservice_8c-source.html#l00130">130</a> of file <a class="el" href="autoservice_8c-source.html">autoservice.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00414">ast_channel::_softhangup</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>, <a class="el" href="lock_8h-source.html#l00074">AST_PTHREADT_NULL</a>, <a class="el" href="linkedlists_8h-source.html#l00526">AST_RWLIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h-source.html#l00503">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h-source.html#l00556">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="autoservice_8c-source.html#l00062">asthread</a>, <a class="el" href="autoservice_8c-source.html#l00056">asent::chan</a>, and <a class="el" href="astmm_8h-source.html#l00069">free</a>.
<p>
Referenced by <a class="el" href="app__macro_8c-source.html#l00144">_macro_exec()</a>, <a class="el" href="app_8c-source.html#l00236">ast_dtmf_stream()</a>, <a class="el" href="enum_8c-source.html#l00367">ast_get_enum()</a>, <a class="el" href="srv_8c-source.html#l00119">ast_get_srv()</a>, <a class="el" href="enum_8c-source.html#l00540">ast_get_txt()</a>, <a class="el" href="channel_8c-source.html#l03763">bridge_playfile()</a>, <a class="el" href="res__features_8c-source.html#l00776">builtin_atxfer()</a>, <a class="el" href="res__features_8c-source.html#l00562">builtin_automonitor()</a>, <a class="el" href="app__meetme_8c-source.html#l00685">conf_play()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="res__features_8c-source.html#l01098">feature_exec_app()</a>, <a class="el" href="res__features_8c-source.html#l00653">finishup()</a>, <a class="el" href="app__osplookup_8c-source.html#l01415">osplookup_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l04166">sla_station_exec()</a>, and <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>.<div class="fragment"><pre class="fragment"><a name="l00131"></a>00131 {
<a name="l00132"></a>00132    <span class="keywordtype">int</span> res = -1;
<a name="l00133"></a>00133    <span class="keyword">struct </span><a class="code" href="structasent.html">asent</a> *as;
<a name="l00134"></a>00134 
<a name="l00135"></a>00135    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;aslist);
<a name="l00136"></a>00136    <a class="code" href="linkedlists_8h.html#b564f1f262db6464e1644462c38d61e3">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;aslist, as, list) {   
<a name="l00137"></a>00137       <span class="keywordflow">if</span> (as-&gt;<a class="code" href="structasent.html#26c322652770620e64ac90682eb6504c">chan</a> == chan) {
<a name="l00138"></a>00138          <a class="code" href="linkedlists_8h.html#93783e4cad722e705630e975d2e8d7f9">AST_RWLIST_REMOVE_CURRENT</a>(&amp;aslist, list);
<a name="l00139"></a>00139          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(as);
<a name="l00140"></a>00140          <span class="keywordflow">if</span> (!chan-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a>)
<a name="l00141"></a>00141             res = 0;
<a name="l00142"></a>00142          <span class="keywordflow">break</span>;
<a name="l00143"></a>00143       }
<a name="l00144"></a>00144    }
<a name="l00145"></a>00145    <a class="code" href="linkedlists_8h.html#e5be717f6b8c1586fa30a060b56403fe">AST_RWLIST_TRAVERSE_SAFE_END</a>
<a name="l00146"></a>00146 
<a name="l00147"></a>00147    <span class="keywordflow">if</span> (<a class="code" href="autoservice_8c.html#de6a9732ddb6daf48eda1027e66c9616">asthread</a> != <a class="code" href="lock_8h.html#84e4b34008de83ea9d1fa44057758022">AST_PTHREADT_NULL</a>) 
<a name="l00148"></a>00148       pthread_kill(<a class="code" href="autoservice_8c.html#de6a9732ddb6daf48eda1027e66c9616">asthread</a>, SIGURG);
<a name="l00149"></a>00149    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;aslist);
<a name="l00150"></a>00150 
<a name="l00151"></a>00151    <span class="comment">/* Wait for it to un-block */</span>
<a name="l00152"></a>00152    <span class="keywordflow">while</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>))
<a name="l00153"></a>00153       usleep(1000);
<a name="l00154"></a>00154    <span class="keywordflow">return</span> res;
<a name="l00155"></a>00155 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a19b056dcfc49b0b46dd14462379314d"></a><!-- doxytag: member="channel.h::ast_begin_shutdown" ref="a19b056dcfc49b0b46dd14462379314d" args="(int hangup)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_begin_shutdown           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hangup</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initiate system shutdown. 
<p>
Initiate system shutdown -- prevents new channels from being allocated. If "hangup" is non-zero, all existing channels will receive soft hangups 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l00349">349</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00038">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00104">AST_LIST_UNLOCK</a>, <a class="el" href="channel_8c-source.html#l01456">ast_softhangup()</a>, <a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1e415ee9181158293f7c3d3cd1a98f4ee">AST_SOFTHANGUP_SHUTDOWN</a>, and <a class="el" href="channel_8c-source.html#l00098">shutting_down</a>.
<p>
Referenced by <a class="el" href="asterisk_8c-source.html#l01201">quit_handler()</a>.<div class="fragment"><pre class="fragment"><a name="l00350"></a>00350 {
<a name="l00351"></a>00351    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *c;
<a name="l00352"></a>00352    <a class="code" href="channel_8c.html#3fda132ec997ca296e81601dde1daf98">shutting_down</a> = 1;
<a name="l00353"></a>00353    <span class="keywordflow">if</span> (hangup) {
<a name="l00354"></a>00354       <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;channels);
<a name="l00355"></a>00355       <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;channels, c, <a class="code" href="structchan__list.html">chan_list</a>)
<a name="l00356"></a>00356          <a class="code" href="channel_8c.html#a1a142039194e9f6dfb632b28a0c5eb5">ast_softhangup</a>(c, <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1e415ee9181158293f7c3d3cd1a98f4ee">AST_SOFTHANGUP_SHUTDOWN</a>);
<a name="l00357"></a>00357       <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;channels);
<a name="l00358"></a>00358    }
<a name="l00359"></a>00359 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8aa2203afc4fb127e46d5be40718dc13"></a><!-- doxytag: member="channel.h::ast_best_codec" ref="8aa2203afc4fb127e46d5be40718dc13" args="(int fmts)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_best_codec           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>fmts</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Pick the best audio codec. 
<p>
Okay, ulaw is used by all telephony equipment, so start with it<p>
Unless of course, you're a silly European, so then prefer ALAW<p>
G.722 is better then all below, but not as common as the above... so give ulaw and alaw priority<p>
Okay, well, signed linear is easy to translate into other stuff<p>
G.726 is standard ADPCM, in RFC3551 packing order<p>
G.726 is standard ADPCM, in AAL2 packing order<p>
ADPCM has great sound quality and is still pretty easy to translate<p>
Okay, we're down to vocoders now, so pick GSM because it's small and easier to translate and sounds pretty good<p>
iLBC is not too bad<p>
Speex is free, but computationally more expensive than GSM<p>
Ick, LPC10 sounds terrible, but at least we have code for it, if you're tacky enough to use it<p>
G.729a is faster than 723 and slightly less expensive<p>
Down to G.723.1 which is proprietary but at least designed for voice 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l00578">578</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="frame_8h-source.html#l00231">AST_FORMAT_ADPCM</a>, <a class="el" href="frame_8h-source.html#l00227">AST_FORMAT_ALAW</a>, <a class="el" href="frame_8h-source.html#l00249">AST_FORMAT_AUDIO_MASK</a>, <a class="el" href="frame_8h-source.html#l00245">AST_FORMAT_G722</a>, <a class="el" href="frame_8h-source.html#l00221">AST_FORMAT_G723_1</a>, <a class="el" href="frame_8h-source.html#l00243">AST_FORMAT_G726</a>, <a class="el" href="frame_8h-source.html#l00229">AST_FORMAT_G726_AAL2</a>, <a class="el" href="frame_8h-source.html#l00237">AST_FORMAT_G729A</a>, <a class="el" href="frame_8h-source.html#l00223">AST_FORMAT_GSM</a>, <a class="el" href="frame_8h-source.html#l00241">AST_FORMAT_ILBC</a>, <a class="el" href="frame_8h-source.html#l00235">AST_FORMAT_LPC10</a>, <a class="el" href="frame_8h-source.html#l00233">AST_FORMAT_SLINEAR</a>, <a class="el" href="frame_8h-source.html#l00239">AST_FORMAT_SPEEX</a>, <a class="el" href="frame_8h-source.html#l00225">AST_FORMAT_ULAW</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, and <a class="el" href="chan__iax2_8c-source.html#l00137">prefs</a>.
<p>
Referenced by <a class="el" href="chan__agent_8c-source.html#l01763">__login_exec()</a>, <a class="el" href="chan__h323_8c-source.html#l01010">__oh323_new()</a>, <a class="el" href="chan__agent_8c-source.html#l00622">agent_call()</a>, <a class="el" href="frame_8c-source.html#l01139">ast_codec_choose()</a>, <a class="el" href="chan__iax2_8c-source.html#l03426">ast_iax2_new()</a>, <a class="el" href="res__features_8c-source.html#l00776">builtin_atxfer()</a>, <a class="el" href="app__echo_8c-source.html#l00054">echo_exec()</a>, <a class="el" href="app__followme_8c-source.html#l00763">findmeexec()</a>, <a class="el" href="chan__gtalk_8c-source.html#l00902">gtalk_new()</a>, <a class="el" href="chan__skinny_8c-source.html#l03820">handle_open_receive_channel_ack_message()</a>, <a class="el" href="chan__iax2_8c-source.html#l08278">iax2_request()</a>, <a class="el" href="chan__jingle_8c-source.html#l00759">jingle_new()</a>, <a class="el" href="chan__local_8c-source.html#l00593">local_new()</a>, <a class="el" href="chan__mgcp_8c-source.html#l01457">mgcp_new()</a>, <a class="el" href="chan__sip_8c-source.html#l04179">sip_new()</a>, <a class="el" href="chan__skinny_8c-source.html#l02823">skinny_new()</a>, <a class="el" href="chan__iax2_8c-source.html#l06624">socket_process()</a>, and <a class="el" href="chan__skinny_8c-source.html#l01554">transmit_connect()</a>.<div class="fragment"><pre class="fragment"><a name="l00579"></a>00579 {
<a name="l00580"></a>00580    <span class="comment">/* This just our opinion, expressed in code.  We are asked to choose</span>
<a name="l00581"></a>00581 <span class="comment">      the best codec to use, given no information */</span>
<a name="l00582"></a>00582    <span class="keywordtype">int</span> x;
<a name="l00583"></a>00583    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="chan__iax2_8c.html#e05b8c8d37568de69ae911d9e518b24d">prefs</a>[] =
<a name="l00584"></a>00584    {<span class="comment"></span>
<a name="l00585"></a>00585 <span class="comment">      /*! Okay, ulaw is used by all telephony equipment, so start with it */</span>
<a name="l00586"></a>00586       <a class="code" href="frame_8h.html#a71706b2c864525ec1c9fcf925ae3802">AST_FORMAT_ULAW</a>,<span class="comment"></span>
<a name="l00587"></a>00587 <span class="comment">      /*! Unless of course, you're a silly European, so then prefer ALAW */</span>
<a name="l00588"></a>00588       <a class="code" href="frame_8h.html#edc237300fef31677662db961c07484b">AST_FORMAT_ALAW</a>,<span class="comment"></span>
<a name="l00589"></a>00589 <span class="comment">      /*! G.722 is better then all below, but not as common as the above... so give ulaw and alaw priority */</span>
<a name="l00590"></a>00590       <a class="code" href="frame_8h.html#b418abcb13f17e85f68a691f34e99e1a">AST_FORMAT_G722</a>,<span class="comment"></span>
<a name="l00591"></a>00591 <span class="comment">      /*! Okay, well, signed linear is easy to translate into other stuff */</span>
<a name="l00592"></a>00592       <a class="code" href="frame_8h.html#ce4d062ff9a85be84b636e7ec67a068b">AST_FORMAT_SLINEAR</a>,<span class="comment"></span>
<a name="l00593"></a>00593 <span class="comment">      /*! G.726 is standard ADPCM, in RFC3551 packing order */</span>
<a name="l00594"></a>00594       <a class="code" href="frame_8h.html#a594899d5bea5f591eda7e20b5e2c161">AST_FORMAT_G726</a>,<span class="comment"></span>
<a name="l00595"></a>00595 <span class="comment">      /*! G.726 is standard ADPCM, in AAL2 packing order */</span>
<a name="l00596"></a>00596       <a class="code" href="frame_8h.html#3c0408e35d11793967a2e178f93256cd">AST_FORMAT_G726_AAL2</a>,<span class="comment"></span>
<a name="l00597"></a>00597 <span class="comment">      /*! ADPCM has great sound quality and is still pretty easy to translate */</span>
<a name="l00598"></a>00598       <a class="code" href="frame_8h.html#b1048e305f2ee62aebab30899c88f8ce">AST_FORMAT_ADPCM</a>,<span class="comment"></span>
<a name="l00599"></a>00599 <span class="comment">      /*! Okay, we're down to vocoders now, so pick GSM because it's small and easier to</span>
<a name="l00600"></a>00600 <span class="comment">          translate and sounds pretty good */</span>
<a name="l00601"></a>00601       <a class="code" href="frame_8h.html#9864508932a19f37d9afbbc7cabd5990">AST_FORMAT_GSM</a>,<span class="comment"></span>
<a name="l00602"></a>00602 <span class="comment">      /*! iLBC is not too bad */</span>
<a name="l00603"></a>00603       <a class="code" href="frame_8h.html#c2f4d8d1a79322d795824fd91fb2706c">AST_FORMAT_ILBC</a>,<span class="comment"></span>
<a name="l00604"></a>00604 <span class="comment">      /*! Speex is free, but computationally more expensive than GSM */</span>
<a name="l00605"></a>00605       <a class="code" href="frame_8h.html#a4f3a9e622d8cbe3fe3eed2a35923d8c">AST_FORMAT_SPEEX</a>,<span class="comment"></span>
<a name="l00606"></a>00606 <span class="comment">      /*! Ick, LPC10 sounds terrible, but at least we have code for it, if you're tacky enough</span>
<a name="l00607"></a>00607 <span class="comment">          to use it */</span>
<a name="l00608"></a>00608       <a class="code" href="frame_8h.html#87eb67578117e5f22d34386b7c989e08">AST_FORMAT_LPC10</a>,<span class="comment"></span>
<a name="l00609"></a>00609 <span class="comment">      /*! G.729a is faster than 723 and slightly less expensive */</span>
<a name="l00610"></a>00610       <a class="code" href="frame_8h.html#66b369abf91a6c6519ca7cad6c657ae7">AST_FORMAT_G729A</a>,<span class="comment"></span>
<a name="l00611"></a>00611 <span class="comment">      /*! Down to G.723.1 which is proprietary but at least designed for voice */</span>
<a name="l00612"></a>00612       <a class="code" href="frame_8h.html#0b4ea457c95753454e021c511a5daecc">AST_FORMAT_G723_1</a>,
<a name="l00613"></a>00613    };
<a name="l00614"></a>00614 
<a name="l00615"></a>00615    <span class="comment">/* Strip out video */</span>
<a name="l00616"></a>00616    fmts &amp;= <a class="code" href="frame_8h.html#71a0a9732267760506de172c34d7a625">AST_FORMAT_AUDIO_MASK</a>;
<a name="l00617"></a>00617    
<a name="l00618"></a>00618    <span class="comment">/* Find the first preferred codec in the format given */</span>
<a name="l00619"></a>00619    <span class="keywordflow">for</span> (x=0; x &lt; (<span class="keyword">sizeof</span>(prefs) / <span class="keyword">sizeof</span>(prefs[0]) ); x++)
<a name="l00620"></a>00620       <span class="keywordflow">if</span> (fmts &amp; prefs[x])
<a name="l00621"></a>00621          <span class="keywordflow">return</span> prefs[x];
<a name="l00622"></a>00622    <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Don't know any of 0x%x formats\n"</span>, fmts);
<a name="l00623"></a>00623    <span class="keywordflow">return</span> 0;
<a name="l00624"></a>00624 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8f80b59690710acfe4fc82cfcbbf9ee9"></a><!-- doxytag: member="channel.h::ast_bridged_channel" ref="8f80b59690710acfe4fc82cfcbbf9ee9" args="(struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a>* ast_bridged_channel           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chan</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Find bridged channel. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>Current channel </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l03754">3754</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00409">ast_channel::_bridge</a>, <a class="el" href="structast__channel__tech.html#d068860c943a563e72d994cc95b19b33">ast_channel_tech::bridged_channel</a>, and <a class="el" href="channel_8h-source.html#l00385">ast_channel::tech</a>.
<p>
Referenced by <a class="el" href="chan__zap_8c-source.html#l04786">__zt_exception()</a>, <a class="el" href="chan__agent_8c-source.html#l01610">agents_show()</a>, <a class="el" href="chan__agent_8c-source.html#l01675">agents_show_online()</a>, <a class="el" href="channel_8c-source.html#l03270">ast_channel_masquerade()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02897">attempt_transfer()</a>, <a class="el" href="chan__local_8c-source.html#l00234">check_bridge()</a>, <a class="el" href="app__chanspy_8c-source.html#l00465">common_exec()</a>, <a class="el" href="chan__oss_8c-source.html#l01339">console_transfer()</a>, <a class="el" href="abstract__jb_8c-source.html#l00445">create_jb()</a>, <a class="el" href="chan__misdn_8c-source.html#l00493">export_aoc_vars()</a>, <a class="el" href="cli_8c-source.html#l00452">handle_chanlist()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02954">handle_hd_hf()</a>, <a class="el" href="chan__sip_8c-source.html#l13936">handle_invite_replaces()</a>, <a class="el" href="chan__sip_8c-source.html#l15145">handle_request_bye()</a>, <a class="el" href="chan__sip_8c-source.html#l11655">handle_request_info()</a>, <a class="el" href="chan__sip_8c-source.html#l14098">handle_request_invite()</a>, <a class="el" href="chan__sip_8c-source.html#l12569">handle_response_invite()</a>, <a class="el" href="cli_8c-source.html#l00770">handle_showchan()</a>, <a class="el" href="chan__sip_8c-source.html#l14615">local_attended_transfer()</a>, <a class="el" href="chan__mgcp_8c-source.html#l00942">mgcp_hangup()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02638">mgcp_ss()</a>, <a class="el" href="chan__misdn_8c-source.html#l03544">misdn_transfer_bc()</a>, <a class="el" href="app__mixmonitor_8c-source.html#l00146">mixmonitor_thread()</a>, <a class="el" href="chan__sip_8c-source.html#l04577">sip_read()</a>, <a class="el" href="chan__iax2_8c-source.html#l06624">socket_process()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, <a class="el" href="app__chanspy_8c-source.html#l00220">start_spying()</a>, <a class="el" href="app__mixmonitor_8c-source.html#l00126">startmon()</a>, <a class="el" href="chan__zap_8c-source.html#l03942">zt_handle_event()</a>, and <a class="el" href="chan__zap_8c-source.html#l02612">zt_hangup()</a>.<div class="fragment"><pre class="fragment"><a name="l03755"></a>03755 {
<a name="l03756"></a>03756    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *bridged;
<a name="l03757"></a>03757    bridged = chan-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a>;
<a name="l03758"></a>03758    <span class="keywordflow">if</span> (bridged &amp;&amp; bridged-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#d068860c943a563e72d994cc95b19b33">bridged_channel</a>)
<a name="l03759"></a>03759       bridged = bridged-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#d068860c943a563e72d994cc95b19b33">bridged_channel</a>(chan, bridged);
<a name="l03760"></a>03760    <span class="keywordflow">return</span> bridged;
<a name="l03761"></a>03761 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="37e2b9b65c43c783c6b43552cd20b438"></a><!-- doxytag: member="channel.h::ast_call" ref="37e2b9b65c43c783c6b43552cd20b438" args="(struct ast_channel *chan, char *addr, int timeout)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_call           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>timeout</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Make a call. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>which channel to make the call on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>destination of the call </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeout</em>&nbsp;</td><td>time to wait on for connect Place a call, take no longer than timeout ms. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns -1 on failure, 0 on not enough time (does not automatically stop ringing), and the number of seconds the connect took otherwise. </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l03114">3114</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="channel_8c-source.html#l00325">ast_check_hangup()</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73007a1bed17a368c12201a64ef3122bf6f6">AST_FLAG_OUTGOING</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>, <a class="el" href="utils_8h-source.html#l00074">ast_set_flag</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="structast__channel__tech.html#2293a71ef97e6c794add8e3ef252d22f">ast_channel_tech::call</a>, and <a class="el" href="channel_8h-source.html#l00385">ast_channel::tech</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="chan__agent_8c-source.html#l00622">agent_call()</a>, <a class="el" href="res__features_8c-source.html#l01295">ast_feature_request_and_dial()</a>, <a class="el" href="app__rpt_8c-source.html#l05377">attempt_reconnect()</a>, <a class="el" href="dial_8c-source.html#l00236">begin_dial()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="app__dial_8c-source.html#l00430">do_forward()</a>, <a class="el" href="chan__features_8c-source.html#l00334">features_call()</a>, <a class="el" href="app__followme_8c-source.html#l00763">findmeexec()</a>, <a class="el" href="app__rpt_8c-source.html#l02757">function_ilink()</a>, <a class="el" href="app__queue_8c-source.html#l01660">ring_entry()</a>, <a class="el" href="app__rpt_8c-source.html#l05604">rpt()</a>, <a class="el" href="app__rpt_8c-source.html#l06759">rpt_exec()</a>, and <a class="el" href="app__queue_8c-source.html#l01950">wait_for_answer()</a>.<div class="fragment"><pre class="fragment"><a name="l03115"></a>03115 {
<a name="l03116"></a>03116    <span class="comment">/* Place an outgoing call, but don't wait any longer than timeout ms before returning.</span>
<a name="l03117"></a>03117 <span class="comment">      If the remote end does not answer within the timeout, then do NOT hang up, but</span>
<a name="l03118"></a>03118 <span class="comment">      return anyway.  */</span>
<a name="l03119"></a>03119    <span class="keywordtype">int</span> res = -1;
<a name="l03120"></a>03120    <span class="comment">/* Stop if we're a zombie or need a soft hangup */</span>
<a name="l03121"></a>03121    <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l03122"></a>03122    <span class="keywordflow">if</span> (!<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>) &amp;&amp; !<a class="code" href="channel_8c.html#042e64a8d465783855a52ec8c56a9373">ast_check_hangup</a>(chan)) {
<a name="l03123"></a>03123       <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#2293a71ef97e6c794add8e3ef252d22f">call</a>)
<a name="l03124"></a>03124          res = chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#2293a71ef97e6c794add8e3ef252d22f">call</a>(chan, addr, timeout);
<a name="l03125"></a>03125       <a class="code" href="utils_8h.html#3208623241ff7b4c93907944487502a1">ast_set_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73007a1bed17a368c12201a64ef3122bf6f6">AST_FLAG_OUTGOING</a>);
<a name="l03126"></a>03126    }
<a name="l03127"></a>03127    <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l03128"></a>03128    <span class="keywordflow">return</span> res;
<a name="l03129"></a>03129 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1e8559a1ce1e9b3a1bc50aaf1013e429"></a><!-- doxytag: member="channel.h::ast_cancel_shutdown" ref="1e8559a1ce1e9b3a1bc50aaf1013e429" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_cancel_shutdown           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Cancel a shutdown in progress. 
<p>
Cancels an existing shutdown and returns to normal operation 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l00374">374</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l00098">shutting_down</a>.
<p>
Referenced by <a class="el" href="asterisk_8c-source.html#l01593">handle_abort_halt()</a>.<div class="fragment"><pre class="fragment"><a name="l00375"></a>00375 {
<a name="l00376"></a>00376    <a class="code" href="channel_8c.html#3fda132ec997ca296e81601dde1daf98">shutting_down</a> = 0;
<a name="l00377"></a>00377 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b60af18c86af040d2efe4529056c8501"></a><!-- doxytag: member="channel.h::ast_cause2str" ref="b60af18c86af040d2efe4529056c8501" args="(int state) attribute_pure" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_cause2str           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>state</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Gives the string form of a given hangup cause. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>state</em>&nbsp;</td><td>cause to get the description of Give a name to a cause code Returns the text form of the binary cause code given </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l00496">496</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c.html#1b1c2ab7cb4088770575bc4a46216449">causes</a>.
<p>
Referenced by <a class="el" href="chan__sip_8c-source.html#l06272">__transmit_response()</a>, <a class="el" href="channel_8c-source.html#l03406">ast_do_masquerade()</a>, <a class="el" href="channel_8c-source.html#l01598">ast_hangup()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, and <a class="el" href="app__followme_8c-source.html#l00763">findmeexec()</a>.<div class="fragment"><pre class="fragment"><a name="l00497"></a>00497 {
<a name="l00498"></a>00498    <span class="keywordtype">int</span> x;
<a name="l00499"></a>00499 
<a name="l00500"></a>00500    <span class="keywordflow">for</span> (x=0; x &lt; <span class="keyword">sizeof</span>(<a class="code" href="channel_8c.html#1b1c2ab7cb4088770575bc4a46216449">causes</a>) / <span class="keyword">sizeof</span>(causes[0]); x++) {
<a name="l00501"></a>00501       <span class="keywordflow">if</span> (causes[x].cause == cause)
<a name="l00502"></a>00502          <span class="keywordflow">return</span> causes[x].desc;
<a name="l00503"></a>00503    }
<a name="l00504"></a>00504 
<a name="l00505"></a>00505    <span class="keywordflow">return</span> <span class="stringliteral">"Unknown"</span>;
<a name="l00506"></a>00506 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="897cb5bfee52c4e4dbed64b003828811"></a><!-- doxytag: member="channel.h::ast_change_name" ref="897cb5bfee52c4e4dbed64b003828811" args="(struct ast_channel *chan, char *newname)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_change_name           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>newname</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Change channel name. 
<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l03335">3335</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="stringfields_8h-source.html#l00275">ast_string_field_set</a>, <a class="el" href="manager_8h-source.html#l00052">EVENT_FLAG_CALL</a>, <a class="el" href="manager_8h-source.html#l00163">manager_event</a>, and <a class="el" href="callerid_8c-source.html#l01043">name</a>.<div class="fragment"><pre class="fragment"><a name="l03336"></a>03336 {
<a name="l03337"></a>03337    <a class="code" href="manager_8h.html#17a8c809d5b2d04cbb8969a209134c2b">manager_event</a>(<a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <span class="stringliteral">"Rename"</span>, <span class="stringliteral">"Oldname: %s\r\nNewname: %s\r\nUniqueid: %s\r\n"</span>, chan-&gt;name, newname, chan-&gt;uniqueid);
<a name="l03338"></a>03338    <a class="code" href="stringfields_8h.html#af456e04e9e17dd8a300d1d3cd75b65a">ast_string_field_set</a>(chan, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, newname);
<a name="l03339"></a>03339 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3e12df96f6a8fc8b7293ad03b29c729f"></a><!-- doxytag: member="channel.h::ast_channel_alloc" ref="3e12df96f6a8fc8b7293ad03b29c729f" args="(int needqueue, int state, const char *cid_num, const char *cid_name, const char *acctcode, const char *exten, const char *context, const int amaflag, const char *name_fmt,...)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a>* ast_channel_alloc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>needqueue</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>state</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cid_num</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cid_name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>acctcode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const int&nbsp;</td>
          <td class="mdname" nowrap> <em>amaflag</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name_fmt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>...</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Create a channel structure. 
<p>
<dl compact><dt><b>Returns:</b></dt><dd>Returns NULL on failure to allocate. </dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>New channels are by default set to the "default" context and extension "s" </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l00632">632</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="chan__iax2_8c-source.html#l00235">accountcode</a>, <a class="el" href="channel_8h-source.html#l00165">AST_ALERT_FD</a>, <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="cdr_8c-source.html#l00460">ast_cdr_alloc()</a>, <a class="el" href="cdr_8c-source.html#l00763">ast_cdr_init()</a>, <a class="el" href="cdr_8c-source.html#l00620">ast_cdr_start()</a>, <a class="el" href="asterisk_8c-source.html#l00230">ast_config_AST_SYSTEM_NAME</a>, <a class="el" href="cdr_8c-source.html#l00060">ast_default_accountcode</a>, <a class="el" href="cdr_8c-source.html#l00059">ast_default_amaflags</a>, <a class="el" href="linkedlists_8h-source.html#l00620">AST_LIST_HEAD_INIT_NOLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00650">AST_LIST_INSERT_HEAD</a>, <a class="el" href="linkedlists_8h-source.html#l00038">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00104">AST_LIST_UNLOCK</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="channel_8h-source.html#l00160">AST_MAX_FDS</a>, <a class="el" href="lock_8h-source.html#l00508">ast_mutex_init()</a>, <a class="el" href="channel_8c-source.html#l00523">ast_state2str()</a>, <a class="el" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>, <a class="el" href="stringfields_8h-source.html#l00314">ast_string_field_build</a>, <a class="el" href="stringfields_8h-source.html#l00325">ast_string_field_build_va</a>, <a class="el" href="stringfields_8h-source.html#l00364">ast_string_field_free_pools</a>, <a class="el" href="stringfields_8h-source.html#l00226">ast_string_field_init</a>, <a class="el" href="stringfields_8h-source.html#l00275">ast_string_field_set</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="channel_8h-source.html#l00166">AST_TIMING_FD</a>, <a class="el" href="asterisk_8c-source.html#l00204">defaultlanguage</a>, <a class="el" href="manager_8h-source.html#l00052">EVENT_FLAG_CALL</a>, <a class="el" href="channel_8h-source.html#l00471">ast_channel::flags</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="channel_8c-source.html#l00102">global_fin</a>, <a class="el" href="channel_8c-source.html#l00102">global_fout</a>, <a class="el" href="chan__alsa_8c-source.html#l00125">language</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="manager_8h-source.html#l00163">manager_event</a>, <a class="el" href="callerid_8c-source.html#l01043">name</a>, <a class="el" href="strings_8h-source.html#l00045">S_OR</a>, <a class="el" href="sched_8c-source.html#l00075">sched_context_create()</a>, <a class="el" href="channel_8c-source.html#l00098">shutting_down</a>, and <a class="el" href="channel_8c-source.html#l00100">uniqueint</a>.
<p>
Referenced by <a class="el" href="chan__h323_8c-source.html#l01010">__oh323_new()</a>, <a class="el" href="res__features_8c-source.html#l02163">action_bridge()</a>, <a class="el" href="chan__agent_8c-source.html#l00909">agent_new()</a>, <a class="el" href="chan__alsa_8c-source.html#l00790">alsa_new()</a>, <a class="el" href="pbx_8c-source.html#l04595">ast_async_goto()</a>, <a class="el" href="chan__iax2_8c-source.html#l03426">ast_iax2_new()</a>, <a class="el" href="res__features_8c-source.html#l00473">ast_masq_park_call()</a>, <a class="el" href="pbx_8c-source.html#l04966">ast_pbx_outgoing_cdr_failed()</a>, <a class="el" href="pbx_8c-source.html#l04991">ast_pbx_outgoing_exten()</a>, <a class="el" href="res__features_8c-source.html#l02716">bridge_exec()</a>, <a class="el" href="res__features_8c-source.html#l00776">builtin_atxfer()</a>, <a class="el" href="res__features_8c-source.html#l00192">check_goto_on_transfer()</a>, <a class="el" href="chan__features_8c-source.html#l00448">features_new()</a>, <a class="el" href="chan__gtalk_8c-source.html#l00902">gtalk_new()</a>, <a class="el" href="chan__iax2_8c-source.html#l06306">iax_park()</a>, <a class="el" href="chan__jingle_8c-source.html#l00759">jingle_new()</a>, <a class="el" href="chan__local_8c-source.html#l00593">local_new()</a>, <a class="el" href="app__voicemail_8c-source.html#l01965">make_email_file()</a>, <a class="el" href="chan__mgcp_8c-source.html#l01457">mgcp_new()</a>, <a class="el" href="chan__misdn_8c-source.html#l03238">misdn_new()</a>, <a class="el" href="chan__nbs_8c-source.html#l00233">nbs_new()</a>, <a class="el" href="chan__oss_8c-source.html#l01020">oss_new()</a>, <a class="el" href="pbx_8c-source.html#l01468">pbx_substitute_variables_helper_full()</a>, <a class="el" href="chan__phone_8c-source.html#l00864">phone_new()</a>, <a class="el" href="app__minivm_8c-source.html#l00892">sendmail()</a>, <a class="el" href="app__voicemail_8c-source.html#l02166">sendpage()</a>, <a class="el" href="chan__sip_8c-source.html#l04179">sip_new()</a>, <a class="el" href="chan__sip_8c-source.html#l13574">sip_park()</a>, <a class="el" href="chan__skinny_8c-source.html#l02823">skinny_new()</a>, and <a class="el" href="chan__zap_8c-source.html#l05516">zt_new()</a>.<div class="fragment"><pre class="fragment"><a name="l00633"></a>00633 {
<a name="l00634"></a>00634    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *tmp;
<a name="l00635"></a>00635    <span class="keywordtype">int</span> x;
<a name="l00636"></a>00636    <span class="keywordtype">int</span> <a class="code" href="structast__channel.html#4e5868d676cb634aa75b125a0f741abf">flags</a>;
<a name="l00637"></a>00637    <span class="keyword">struct </span>varshead *headp;
<a name="l00638"></a>00638    va_list ap1, ap2;
<a name="l00639"></a>00639 
<a name="l00640"></a>00640    <span class="comment">/* If shutting down, don't allocate any new channels */</span>
<a name="l00641"></a>00641    <span class="keywordflow">if</span> (<a class="code" href="channel_8c.html#3fda132ec997ca296e81601dde1daf98">shutting_down</a>) {
<a name="l00642"></a>00642       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Channel allocation failed: Refusing due to active shutdown\n"</span>);
<a name="l00643"></a>00643       <span class="keywordflow">return</span> NULL;
<a name="l00644"></a>00644    }
<a name="l00645"></a>00645 
<a name="l00646"></a>00646    <span class="keywordflow">if</span> (!(tmp = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*tmp))))
<a name="l00647"></a>00647       <span class="keywordflow">return</span> NULL;
<a name="l00648"></a>00648 
<a name="l00649"></a>00649    <span class="keywordflow">if</span> (!(tmp-&gt;sched = <a class="code" href="sched_8c.html#4326fa64fd840788d03093b9931bb1fb">sched_context_create</a>())) {
<a name="l00650"></a>00650       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Channel allocation failed: Unable to create schedule context\n"</span>);
<a name="l00651"></a>00651       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(tmp);
<a name="l00652"></a>00652       <span class="keywordflow">return</span> NULL;
<a name="l00653"></a>00653    }
<a name="l00654"></a>00654    
<a name="l00655"></a>00655    <a class="code" href="stringfields_8h.html#1b408288de2c46a54ecd65b3f3f8a51c">ast_string_field_init</a>(tmp, 128);
<a name="l00656"></a>00656 
<a name="l00657"></a>00657    <span class="comment">/* Don't bother initializing the last two FD here, because they</span>
<a name="l00658"></a>00658 <span class="comment">      will *always* be set just a few lines down (AST_TIMING_FD,</span>
<a name="l00659"></a>00659 <span class="comment">      AST_ALERT_FD). */</span>
<a name="l00660"></a>00660    <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="channel_8h.html#83204f17b88e7752d76b1a751a501a65">AST_MAX_FDS</a> - 2; x++)
<a name="l00661"></a>00661       tmp-&gt;fds[x] = -1;
<a name="l00662"></a>00662 
<a name="l00663"></a>00663 <span class="preprocessor">#ifdef HAVE_ZAPTEL</span>
<a name="l00664"></a>00664 <span class="preprocessor"></span>   tmp-&gt;timingfd = open(<span class="stringliteral">"/dev/zap/timer"</span>, O_RDWR);
<a name="l00665"></a>00665    <span class="keywordflow">if</span> (tmp-&gt;timingfd &gt; -1) {
<a name="l00666"></a>00666       <span class="comment">/* Check if timing interface supports new</span>
<a name="l00667"></a>00667 <span class="comment">         ping/pong scheme */</span>
<a name="l00668"></a>00668       flags = 1;
<a name="l00669"></a>00669       <span class="keywordflow">if</span> (!ioctl(tmp-&gt;timingfd, ZT_TIMERPONG, &amp;flags))
<a name="l00670"></a>00670          needqueue = 0;
<a name="l00671"></a>00671    }
<a name="l00672"></a>00672 <span class="preprocessor">#else</span>
<a name="l00673"></a>00673 <span class="preprocessor"></span>   tmp-&gt;timingfd = -1;              
<a name="l00674"></a>00674 <span class="preprocessor">#endif               </span>
<a name="l00675"></a>00675 <span class="preprocessor"></span>
<a name="l00676"></a>00676    <span class="keywordflow">if</span> (needqueue) {
<a name="l00677"></a>00677       <span class="keywordflow">if</span> (pipe(tmp-&gt;alertpipe)) {
<a name="l00678"></a>00678          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Channel allocation failed: Can't create alert pipe!\n"</span>);
<a name="l00679"></a>00679          <a class="code" href="stringfields_8h.html#772cf76139a5b96f329a48ae8307e142">ast_string_field_free_pools</a>(tmp);
<a name="l00680"></a>00680          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(tmp);
<a name="l00681"></a>00681          <span class="keywordflow">return</span> NULL;
<a name="l00682"></a>00682       } <span class="keywordflow">else</span> {
<a name="l00683"></a>00683          flags = fcntl(tmp-&gt;alertpipe[0], F_GETFL);
<a name="l00684"></a>00684          fcntl(tmp-&gt;alertpipe[0], F_SETFL, flags | O_NONBLOCK);
<a name="l00685"></a>00685          flags = fcntl(tmp-&gt;alertpipe[1], F_GETFL);
<a name="l00686"></a>00686          fcntl(tmp-&gt;alertpipe[1], F_SETFL, flags | O_NONBLOCK);
<a name="l00687"></a>00687       }
<a name="l00688"></a>00688    } <span class="keywordflow">else</span>   <span class="comment">/* Make sure we've got it done right if they don't */</span>
<a name="l00689"></a>00689       tmp-&gt;alertpipe[0] = tmp-&gt;alertpipe[1] = -1;
<a name="l00690"></a>00690 
<a name="l00691"></a>00691    <span class="comment">/* Always watch the alertpipe */</span>
<a name="l00692"></a>00692    tmp-&gt;fds[<a class="code" href="channel_8h.html#187908de5f942fe7f493a6b9b5dacfc4">AST_ALERT_FD</a>] = tmp-&gt;alertpipe[0];
<a name="l00693"></a>00693    <span class="comment">/* And timing pipe */</span>
<a name="l00694"></a>00694    tmp-&gt;fds[<a class="code" href="channel_8h.html#0db74b98fb7363645274b7b92a5741f2">AST_TIMING_FD</a>] = tmp-&gt;timingfd;
<a name="l00695"></a>00695    <a class="code" href="stringfields_8h.html#af456e04e9e17dd8a300d1d3cd75b65a">ast_string_field_set</a>(tmp, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="stringliteral">"**Unknown**"</span>);
<a name="l00696"></a>00696 
<a name="l00697"></a>00697    <span class="comment">/* Initial state */</span>
<a name="l00698"></a>00698    tmp-&gt;_state = <a class="code" href="structstate.html">state</a>;
<a name="l00699"></a>00699 
<a name="l00700"></a>00700    tmp-&gt;streamid = -1;
<a name="l00701"></a>00701    
<a name="l00702"></a>00702    tmp-&gt;fin = <a class="code" href="channel_8c.html#fb1a13eb3cfac4d9cfb7c4b0d2865bde">global_fin</a>;
<a name="l00703"></a>00703    tmp-&gt;fout = <a class="code" href="channel_8c.html#2173c5282c13757472cb6ac76d8ecdad">global_fout</a>;
<a name="l00704"></a>00704 
<a name="l00705"></a>00705    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(<a class="code" href="asterisk_8c.html#0a0f8ba4c757a1da509a0cae1830025b">ast_config_AST_SYSTEM_NAME</a>)) {
<a name="l00706"></a>00706       <a class="code" href="stringfields_8h.html#4bcfc9a923120ec2704f7c6049e497f7">ast_string_field_build</a>(tmp, uniqueid, <span class="stringliteral">"%li.%d"</span>, (<span class="keywordtype">long</span>) time(NULL), 
<a name="l00707"></a>00707                    ast_atomic_fetchadd_int(&amp;<a class="code" href="channel_8c.html#49bb87cf832afb4af43db414e0391d75">uniqueint</a>, 1));
<a name="l00708"></a>00708    } <span class="keywordflow">else</span> {
<a name="l00709"></a>00709       <a class="code" href="stringfields_8h.html#4bcfc9a923120ec2704f7c6049e497f7">ast_string_field_build</a>(tmp, uniqueid, <span class="stringliteral">"%s-%li.%d"</span>, <a class="code" href="asterisk_8c.html#0a0f8ba4c757a1da509a0cae1830025b">ast_config_AST_SYSTEM_NAME</a>, 
<a name="l00710"></a>00710                    (<span class="keywordtype">long</span>) time(NULL), ast_atomic_fetchadd_int(&amp;<a class="code" href="channel_8c.html#49bb87cf832afb4af43db414e0391d75">uniqueint</a>, 1));
<a name="l00711"></a>00711    }
<a name="l00712"></a>00712 
<a name="l00713"></a>00713    tmp-&gt;cid.cid_name = <a class="code" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>(<a class="code" href="chan__mgcp_8c.html#70f178a59d8df82fe5e107da71415b9b">cid_name</a>);
<a name="l00714"></a>00714    tmp-&gt;cid.cid_num = <a class="code" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>(<a class="code" href="chan__mgcp_8c.html#ca3c0eb6b6e898f3a32aed5de1320774">cid_num</a>);
<a name="l00715"></a>00715    
<a name="l00716"></a>00716    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(name_fmt)) {
<a name="l00717"></a>00717       <span class="comment">/* Almost every channel is calling this function, and setting the name via the ast_string_field_build() call.</span>
<a name="l00718"></a>00718 <span class="comment">       * And they all use slightly different formats for their name string.</span>
<a name="l00719"></a>00719 <span class="comment">       * This means, to set the name here, we have to accept variable args, and call the string_field_build from here.</span>
<a name="l00720"></a>00720 <span class="comment">       * This means, that the stringfields must have a routine that takes the va_lists directly, and </span>
<a name="l00721"></a>00721 <span class="comment">       * uses them to build the string, instead of forming the va_lists internally from the vararg ... list.</span>
<a name="l00722"></a>00722 <span class="comment">       * This new function was written so this can be accomplished.</span>
<a name="l00723"></a>00723 <span class="comment">       */</span>
<a name="l00724"></a>00724       va_start(ap1, name_fmt);
<a name="l00725"></a>00725       va_start(ap2, name_fmt);
<a name="l00726"></a>00726       <a class="code" href="stringfields_8h.html#3c5e6dc0f1ef6c2e2c9dac4ee837d108">ast_string_field_build_va</a>(tmp, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, name_fmt, ap1, ap2);
<a name="l00727"></a>00727       va_end(ap1);
<a name="l00728"></a>00728       va_end(ap2);
<a name="l00729"></a>00729 
<a name="l00730"></a>00730       <span class="comment">/* and now, since the channel structure is built, and has its name, let's call the</span>
<a name="l00731"></a>00731 <span class="comment">       * manager event generator with this Newchannel event. This is the proper and correct</span>
<a name="l00732"></a>00732 <span class="comment">       * place to make this call, but you sure do have to pass a lot of data into this func</span>
<a name="l00733"></a>00733 <span class="comment">       * to do it here!</span>
<a name="l00734"></a>00734 <span class="comment">       */</span>
<a name="l00735"></a>00735       <a class="code" href="manager_8h.html#17a8c809d5b2d04cbb8969a209134c2b">manager_event</a>(<a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <span class="stringliteral">"Newchannel"</span>,
<a name="l00736"></a>00736                <span class="stringliteral">"Channel: %s\r\n"</span>
<a name="l00737"></a>00737                <span class="stringliteral">"State: %s\r\n"</span>
<a name="l00738"></a>00738                <span class="stringliteral">"CallerIDNum: %s\r\n"</span>
<a name="l00739"></a>00739                <span class="stringliteral">"CallerIDName: %s\r\n"</span>
<a name="l00740"></a>00740                <span class="stringliteral">"Uniqueid: %s\r\n"</span>,
<a name="l00741"></a>00741                tmp-&gt;name, <a class="code" href="channel_8c.html#1c242fd13329f5600ccd56263aba7272">ast_state2str</a>(<a class="code" href="structstate.html">state</a>),
<a name="l00742"></a>00742                <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(<a class="code" href="chan__mgcp_8c.html#ca3c0eb6b6e898f3a32aed5de1320774">cid_num</a>, <span class="stringliteral">"&lt;unknown&gt;"</span>),
<a name="l00743"></a>00743                <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(<a class="code" href="chan__mgcp_8c.html#70f178a59d8df82fe5e107da71415b9b">cid_name</a>, <span class="stringliteral">"&lt;unknown&gt;"</span>),
<a name="l00744"></a>00744                tmp-&gt;uniqueid);
<a name="l00745"></a>00745    }
<a name="l00746"></a>00746 
<a name="l00747"></a>00747    <span class="comment">/* Reminder for the future: under what conditions do we NOT want to track cdrs on channels? */</span>
<a name="l00748"></a>00748 
<a name="l00749"></a>00749    <span class="comment">/* These 4 variables need to be set up for the cdr_init() to work right */</span>
<a name="l00750"></a>00750    <span class="keywordflow">if</span> (amaflag)
<a name="l00751"></a>00751       tmp-&gt;amaflags = amaflag;
<a name="l00752"></a>00752    <span class="keywordflow">else</span>
<a name="l00753"></a>00753       tmp-&gt;amaflags = <a class="code" href="cdr_8c.html#d5268e5dc9c134f0ce5f28da7a447335">ast_default_amaflags</a>;
<a name="l00754"></a>00754    
<a name="l00755"></a>00755    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(acctcode))
<a name="l00756"></a>00756       <a class="code" href="stringfields_8h.html#af456e04e9e17dd8a300d1d3cd75b65a">ast_string_field_set</a>(tmp, <a class="code" href="chan__iax2_8c.html#6c4d520c88ca77ed2acc04ae1add9f8e">accountcode</a>, acctcode);
<a name="l00757"></a>00757    <span class="keywordflow">else</span>
<a name="l00758"></a>00758       <a class="code" href="stringfields_8h.html#af456e04e9e17dd8a300d1d3cd75b65a">ast_string_field_set</a>(tmp, <a class="code" href="chan__iax2_8c.html#6c4d520c88ca77ed2acc04ae1add9f8e">accountcode</a>, <a class="code" href="cdr_8c.html#77219a32a253309bd3900aedd6cf8d07">ast_default_accountcode</a>);
<a name="l00759"></a>00759       
<a name="l00760"></a>00760    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>))
<a name="l00761"></a>00761       ast_copy_string(tmp-&gt;context, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <span class="keyword">sizeof</span>(tmp-&gt;context));
<a name="l00762"></a>00762    <span class="keywordflow">else</span>
<a name="l00763"></a>00763       strcpy(tmp-&gt;context, <span class="stringliteral">"default"</span>);
<a name="l00764"></a>00764 
<a name="l00765"></a>00765    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>))
<a name="l00766"></a>00766       ast_copy_string(tmp-&gt;exten, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <span class="keyword">sizeof</span>(tmp-&gt;exten));
<a name="l00767"></a>00767    <span class="keywordflow">else</span>
<a name="l00768"></a>00768       strcpy(tmp-&gt;exten, <span class="stringliteral">"s"</span>);
<a name="l00769"></a>00769 
<a name="l00770"></a>00770    tmp-&gt;priority = 1;
<a name="l00771"></a>00771       
<a name="l00772"></a>00772    tmp-&gt;cdr = <a class="code" href="cdr_8c.html#0dd431954a27c67f78c6e13be8a0b136">ast_cdr_alloc</a>();
<a name="l00773"></a>00773    <a class="code" href="cdr_8c.html#4d85bb268956ffbf0b19df25915726e8">ast_cdr_init</a>(tmp-&gt;cdr, tmp);
<a name="l00774"></a>00774    <a class="code" href="cdr_8c.html#56e1b7b9d5acada4d22d345813710582">ast_cdr_start</a>(tmp-&gt;cdr);
<a name="l00775"></a>00775    
<a name="l00776"></a>00776    headp = &amp;tmp-&gt;varshead;
<a name="l00777"></a>00777    <a class="code" href="linkedlists_8h.html#0ae37ea56ca862f6504390fd49b9839f">AST_LIST_HEAD_INIT_NOLOCK</a>(headp);
<a name="l00778"></a>00778    
<a name="l00779"></a>00779    <a class="code" href="lock_8h.html#33e99ac90b0ca47211841b5cab79ffc4">ast_mutex_init</a>(&amp;tmp-&gt;lock);
<a name="l00780"></a>00780    
<a name="l00781"></a>00781    <a class="code" href="linkedlists_8h.html#0ae37ea56ca862f6504390fd49b9839f">AST_LIST_HEAD_INIT_NOLOCK</a>(&amp;tmp-&gt;datastores);
<a name="l00782"></a>00782    
<a name="l00783"></a>00783    <a class="code" href="stringfields_8h.html#af456e04e9e17dd8a300d1d3cd75b65a">ast_string_field_set</a>(tmp, <a class="code" href="chan__alsa_8c.html#8e5b6b627f81f1981fc6d241d6b3dd21">language</a>, <a class="code" href="asterisk_8c.html#c8061c1fd1af2a0a5e244cf0bbae5043">defaultlanguage</a>);
<a name="l00784"></a>00784 
<a name="l00785"></a>00785    tmp-&gt;tech = &amp;<a class="code" href="channel_8c.html#688c6fbaa15436ff07568d12eac14d5b">null_tech</a>;
<a name="l00786"></a>00786 
<a name="l00787"></a>00787    <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;channels);
<a name="l00788"></a>00788    <a class="code" href="linkedlists_8h.html#5df56040a8838bdc841ef8eb179b7609">AST_LIST_INSERT_HEAD</a>(&amp;channels, tmp, <a class="code" href="structchan__list.html">chan_list</a>);
<a name="l00789"></a>00789    <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;channels);
<a name="l00790"></a>00790 
<a name="l00791"></a>00791    <span class="keywordflow">return</span> tmp;
<a name="l00792"></a>00792 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="63ab4d8e95fedaabf03d0f492368e930"></a><!-- doxytag: member="channel.h::ast_channel_bridge" ref="63ab4d8e95fedaabf03d0f492368e930" args="(struct ast_channel *c0, struct ast_channel *c1, struct ast_bridge_config *config, struct ast_frame **fo, struct ast_channel **rc)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_channel_bridge           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c0</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__bridge__config.html">ast_bridge_config</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>config</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__frame.html">ast_frame</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>fo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__channel.html">ast_channel</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>rc</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Bridge two channels together. 
<p>
Bridge two channels together <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c0</em>&nbsp;</td><td>first channel to bridge </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>c1</em>&nbsp;</td><td>second channel to bridge </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>config</em>&nbsp;</td><td>config for the channels </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fo</em>&nbsp;</td><td>destination frame(?) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rc</em>&nbsp;</td><td>destination channel(?) Bridge two channels (c0 and c1) together. If an important frame occurs, we return that frame in rf (remember, it could be NULL) and which channel (0 or 1) in rc </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l03953">3953</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00409">ast_channel::_bridge</a>, <a class="el" href="channel_8h-source.html#l00414">ast_channel::_softhangup</a>, <a class="el" href="channel_8h.html#8bba128582c81d1af777c11278bd4d19fd37b17491849eb3a8d0cd996d69fe1f">AST_BRIDGE_COMPLETE</a>, <a class="el" href="channel_8h.html#8bba128582c81d1af777c11278bd4d198b00ec8ed330d763fd4f579d7c513d1d">AST_BRIDGE_FAILED</a>, <a class="el" href="channel_8h.html#8bba128582c81d1af777c11278bd4d19c05a72efa9f8f1c8ebcfaf8e6fe97524">AST_BRIDGE_FAILED_NOWARN</a>, <a class="el" href="channel_8h.html#8bba128582c81d1af777c11278bd4d19ebe331af24cd5342764adc6f1b59fbec">AST_BRIDGE_RETRY</a>, <a class="el" href="channel_8c-source.html#l03253">ast_channel_make_compatible()</a>, <a class="el" href="channel_8c-source.html#l00325">ast_check_hangup()</a>, <a class="el" href="channel_8c-source.html#l00339">ast_check_hangup_locked()</a>, <a class="el" href="utils_8h-source.html#l00081">ast_clear_flag</a>, <a class="el" href="channel_8h.html#02653d87b6fa8554fc0d1a3726fea2d04040ce118987e724063d0b58eafd9b4f">AST_FEATURE_PLAY_WARNING</a>, <a class="el" href="channel_8h.html#02653d87b6fa8554fc0d1a3726fea2d06d1225b2615ed409be56bda96c5b71b9">AST_FEATURE_REDIRECT</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73000ecdf5f8a5869727e38bf9e1ca5a6cae">AST_FLAG_END_DTMF_ONLY</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300b38fcf240d912cfa60d488dea99cab31">AST_FLAG_NBRIDGE</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>, <a class="el" href="channel_8c-source.html#l03797">ast_generic_bridge()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="utils_8h-source.html#l00074">ast_set_flag</a>, <a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1f3fe293730d3200b678a1daaa67ea5c5">AST_SOFTHANGUP_UNBRIDGE</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="utils_8c-source.html#l00778">ast_tvadd()</a>, <a class="el" href="utils_8c-source.html#l00792">ast_tvsub()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="structast__channel__tech.html#4c0be0704b102072d0c6885e304ee6a3">ast_channel_tech::bridge</a>, <a class="el" href="channel_8c-source.html#l03763">bridge_playfile()</a>, <a class="el" href="channel_8h-source.html#l00437">ast_channel::cid</a>, <a class="el" href="channel_8h-source.html#l00212">ast_callerid::cid_num</a>, <a class="el" href="channel_8h-source.html#l00564">ast_bridge_config::end_sound</a>, <a class="el" href="manager_8h-source.html#l00052">EVENT_FLAG_CALL</a>, <a class="el" href="channel_8h-source.html#l00559">ast_bridge_config::feature_timer</a>, <a class="el" href="channel_8h-source.html#l00557">ast_bridge_config::features_callee</a>, <a class="el" href="channel_8h-source.html#l00556">ast_bridge_config::features_caller</a>, <a class="el" href="channel_8h-source.html#l00566">ast_bridge_config::firstpass</a>, <a class="el" href="channel_8h-source.html#l00567">ast_bridge_config::flags</a>, <a class="el" href="channel_8h-source.html#l00404">ast_channel::generator</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="manager_8h-source.html#l00163">manager_event</a>, <a class="el" href="channel_8h-source.html#l00457">ast_channel::monitor</a>, <a class="el" href="channel_8h-source.html#l00476">ast_channel::nativeformats</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="channel_8h-source.html#l00561">ast_bridge_config::play_warning</a>, <a class="el" href="channel_8h-source.html#l00477">ast_channel::readformat</a>, <a class="el" href="structast__channel__tech.html#6ae7eea3e6476134e4193e09abb5dff3">ast_channel_tech::send_digit_begin</a>, <a class="el" href="channel_8h-source.html#l00484">ast_channel::spies</a>, <a class="el" href="channel_8h-source.html#l00565">ast_bridge_config::start_sound</a>, <a class="el" href="channel_8h-source.html#l00558">ast_bridge_config::start_time</a>, <a class="el" href="channel_8h-source.html#l00385">ast_channel::tech</a>, <a class="el" href="channel_8h-source.html#l00560">ast_bridge_config::timelimit</a>, <a class="el" href="logger_8h-source.html#l00045">VERBOSE_PREFIX_3</a>, <a class="el" href="channel_8h-source.html#l00562">ast_bridge_config::warning_freq</a>, <a class="el" href="channel_8h-source.html#l00563">ast_bridge_config::warning_sound</a>, and <a class="el" href="channel_8h-source.html#l00478">ast_channel::writeformat</a>.
<p>
Referenced by <a class="el" href="res__features_8c-source.html#l01478">ast_bridge_call()</a>.<div class="fragment"><pre class="fragment"><a name="l03955"></a>03955 {
<a name="l03956"></a>03956    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *who = NULL;
<a name="l03957"></a>03957    <span class="keyword">enum</span> <a class="code" href="channel_8h.html#8bba128582c81d1af777c11278bd4d19">ast_bridge_result</a> res = <a class="code" href="channel_8h.html#8bba128582c81d1af777c11278bd4d19fd37b17491849eb3a8d0cd996d69fe1f">AST_BRIDGE_COMPLETE</a>;
<a name="l03958"></a>03958    <span class="keywordtype">int</span> nativefailed=0;
<a name="l03959"></a>03959    <span class="keywordtype">int</span> firstpass;
<a name="l03960"></a>03960    <span class="keywordtype">int</span> o0nativeformats;
<a name="l03961"></a>03961    <span class="keywordtype">int</span> o1nativeformats;
<a name="l03962"></a>03962    <span class="keywordtype">long</span> time_left_ms=0;
<a name="l03963"></a>03963    <span class="keyword">struct </span>timeval nexteventts = { 0, };
<a name="l03964"></a>03964    <span class="keywordtype">char</span> caller_warning = 0;
<a name="l03965"></a>03965    <span class="keywordtype">char</span> callee_warning = 0;
<a name="l03966"></a>03966 
<a name="l03967"></a>03967    <span class="keywordflow">if</span> (c0-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a>) {
<a name="l03968"></a>03968       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"%s is already in a bridge with %s\n"</span>,
<a name="l03969"></a>03969          c0-&gt;name, c0-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a>-&gt;name);
<a name="l03970"></a>03970       <span class="keywordflow">return</span> -1;
<a name="l03971"></a>03971    }
<a name="l03972"></a>03972    <span class="keywordflow">if</span> (c1-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a>) {
<a name="l03973"></a>03973       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"%s is already in a bridge with %s\n"</span>,
<a name="l03974"></a>03974          c1-&gt;name, c1-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a>-&gt;name);
<a name="l03975"></a>03975       <span class="keywordflow">return</span> -1;
<a name="l03976"></a>03976    }
<a name="l03977"></a>03977    
<a name="l03978"></a>03978    <span class="comment">/* Stop if we're a zombie or need a soft hangup */</span>
<a name="l03979"></a>03979    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(c0, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>) || <a class="code" href="channel_8c.html#f72ecf6c6a107f089ffe657ff4c1e9b2">ast_check_hangup_locked</a>(c0) ||
<a name="l03980"></a>03980        <a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(c1, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>) || <a class="code" href="channel_8c.html#f72ecf6c6a107f089ffe657ff4c1e9b2">ast_check_hangup_locked</a>(c1))
<a name="l03981"></a>03981       <span class="keywordflow">return</span> -1;
<a name="l03982"></a>03982 
<a name="l03983"></a>03983    *fo = NULL;
<a name="l03984"></a>03984    firstpass = config-&gt;<a class="code" href="structast__bridge__config.html#b9313589eca257aaed154d3517ab7f0f">firstpass</a>;
<a name="l03985"></a>03985    config-&gt;<a class="code" href="structast__bridge__config.html#b9313589eca257aaed154d3517ab7f0f">firstpass</a> = 0;
<a name="l03986"></a>03986 
<a name="l03987"></a>03987    <span class="keywordflow">if</span> (ast_tvzero(config-&gt;<a class="code" href="structast__bridge__config.html#c4d98dbd5badae901761ab6422fa3e70">start_time</a>))
<a name="l03988"></a>03988       config-&gt;<a class="code" href="structast__bridge__config.html#c4d98dbd5badae901761ab6422fa3e70">start_time</a> = ast_tvnow();
<a name="l03989"></a>03989    time_left_ms = config-&gt;<a class="code" href="structast__bridge__config.html#c20456384feb648b4692b700ec570d42">timelimit</a>;
<a name="l03990"></a>03990 
<a name="l03991"></a>03991    caller_warning = <a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(&amp;config-&gt;<a class="code" href="structast__bridge__config.html#9775c13d5cb338f60cdd1eeebf66c249">features_caller</a>, <a class="code" href="channel_8h.html#02653d87b6fa8554fc0d1a3726fea2d04040ce118987e724063d0b58eafd9b4f">AST_FEATURE_PLAY_WARNING</a>);
<a name="l03992"></a>03992    callee_warning = <a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(&amp;config-&gt;<a class="code" href="structast__bridge__config.html#fa6efc124166cce0351265506b27ec86">features_callee</a>, <a class="code" href="channel_8h.html#02653d87b6fa8554fc0d1a3726fea2d04040ce118987e724063d0b58eafd9b4f">AST_FEATURE_PLAY_WARNING</a>);
<a name="l03993"></a>03993 
<a name="l03994"></a>03994    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="structast__bridge__config.html#2dd6d1b658d4294b5eefd558b669488e">start_sound</a> &amp;&amp; firstpass) {
<a name="l03995"></a>03995       <span class="keywordflow">if</span> (caller_warning)
<a name="l03996"></a>03996          <a class="code" href="channel_8c.html#5acc06bc5b686545ac14a9906edd53fb">bridge_playfile</a>(c0, c1, config-&gt;<a class="code" href="structast__bridge__config.html#2dd6d1b658d4294b5eefd558b669488e">start_sound</a>, time_left_ms / 1000);
<a name="l03997"></a>03997       <span class="keywordflow">if</span> (callee_warning)
<a name="l03998"></a>03998          <a class="code" href="channel_8c.html#5acc06bc5b686545ac14a9906edd53fb">bridge_playfile</a>(c1, c0, config-&gt;<a class="code" href="structast__bridge__config.html#2dd6d1b658d4294b5eefd558b669488e">start_sound</a>, time_left_ms / 1000);
<a name="l03999"></a>03999    }
<a name="l04000"></a>04000 
<a name="l04001"></a>04001    <span class="comment">/* Keep track of bridge */</span>
<a name="l04002"></a>04002    c0-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a> = c1;
<a name="l04003"></a>04003    c1-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a> = c0;
<a name="l04004"></a>04004 
<a name="l04005"></a>04005    <span class="comment">/* \todo  XXX here should check that cid_num is not NULL */</span>
<a name="l04006"></a>04006    <a class="code" href="manager_8h.html#17a8c809d5b2d04cbb8969a209134c2b">manager_event</a>(<a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <span class="stringliteral">"Link"</span>,
<a name="l04007"></a>04007             <span class="stringliteral">"Channel1: %s\r\n"</span>
<a name="l04008"></a>04008             <span class="stringliteral">"Channel2: %s\r\n"</span>
<a name="l04009"></a>04009             <span class="stringliteral">"Uniqueid1: %s\r\n"</span>
<a name="l04010"></a>04010             <span class="stringliteral">"Uniqueid2: %s\r\n"</span>
<a name="l04011"></a>04011             <span class="stringliteral">"CallerID1: %s\r\n"</span>
<a name="l04012"></a>04012             <span class="stringliteral">"CallerID2: %s\r\n"</span>,
<a name="l04013"></a>04013             c0-&gt;name, c1-&gt;name, c0-&gt;uniqueid, c1-&gt;uniqueid, c0-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>, c1-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>);
<a name="l04014"></a>04014 
<a name="l04015"></a>04015    o0nativeformats = c0-&gt;<a class="code" href="structast__channel.html#adbc0bbfec600539582f92b30ed1ecd7">nativeformats</a>;
<a name="l04016"></a>04016    o1nativeformats = c1-&gt;<a class="code" href="structast__channel.html#adbc0bbfec600539582f92b30ed1ecd7">nativeformats</a>;
<a name="l04017"></a>04017 
<a name="l04018"></a>04018    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="structast__bridge__config.html#dfe9693aa0a7a7c3ac9558a7fc78338f">feature_timer</a>) {
<a name="l04019"></a>04019       nexteventts = <a class="code" href="utils_8c.html#f3d6e948bdc914615d61b50418162c81">ast_tvadd</a>(config-&gt;<a class="code" href="structast__bridge__config.html#c4d98dbd5badae901761ab6422fa3e70">start_time</a>, ast_samp2tv(config-&gt;<a class="code" href="structast__bridge__config.html#dfe9693aa0a7a7c3ac9558a7fc78338f">feature_timer</a>, 1000));
<a name="l04020"></a>04020    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="structast__bridge__config.html#c20456384feb648b4692b700ec570d42">timelimit</a>) {
<a name="l04021"></a>04021       nexteventts = <a class="code" href="utils_8c.html#f3d6e948bdc914615d61b50418162c81">ast_tvadd</a>(config-&gt;<a class="code" href="structast__bridge__config.html#c4d98dbd5badae901761ab6422fa3e70">start_time</a>, ast_samp2tv(config-&gt;<a class="code" href="structast__bridge__config.html#c20456384feb648b4692b700ec570d42">timelimit</a>, 1000));
<a name="l04022"></a>04022       <span class="keywordflow">if</span> (caller_warning || callee_warning)
<a name="l04023"></a>04023          nexteventts = <a class="code" href="utils_8c.html#fd14d2161a764b21024b6623154e5f9d">ast_tvsub</a>(nexteventts, ast_samp2tv(config-&gt;<a class="code" href="structast__bridge__config.html#09928184e097afa29194fffb0063815f">play_warning</a>, 1000));
<a name="l04024"></a>04024    }
<a name="l04025"></a>04025 
<a name="l04026"></a>04026    <span class="keywordflow">if</span> (!c0-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#6ae7eea3e6476134e4193e09abb5dff3">send_digit_begin</a>)
<a name="l04027"></a>04027       <a class="code" href="utils_8h.html#3208623241ff7b4c93907944487502a1">ast_set_flag</a>(c1, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73000ecdf5f8a5869727e38bf9e1ca5a6cae">AST_FLAG_END_DTMF_ONLY</a>);
<a name="l04028"></a>04028    <span class="keywordflow">if</span> (!c1-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#6ae7eea3e6476134e4193e09abb5dff3">send_digit_begin</a>)
<a name="l04029"></a>04029       <a class="code" href="utils_8h.html#3208623241ff7b4c93907944487502a1">ast_set_flag</a>(c0, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73000ecdf5f8a5869727e38bf9e1ca5a6cae">AST_FLAG_END_DTMF_ONLY</a>);
<a name="l04030"></a>04030 
<a name="l04031"></a>04031    <span class="keywordflow">for</span> (<span class="comment">/* ever */</span>;;) {
<a name="l04032"></a>04032       <span class="keyword">struct </span>timeval now = { 0, };
<a name="l04033"></a>04033       <span class="keywordtype">int</span> to;
<a name="l04034"></a>04034 
<a name="l04035"></a>04035       to = -1;
<a name="l04036"></a>04036 
<a name="l04037"></a>04037       <span class="keywordflow">if</span> (!ast_tvzero(nexteventts)) {
<a name="l04038"></a>04038          now = ast_tvnow();
<a name="l04039"></a>04039          to = ast_tvdiff_ms(nexteventts, now);
<a name="l04040"></a>04040          <span class="keywordflow">if</span> (to &lt;= 0) {
<a name="l04041"></a>04041             <span class="keywordflow">if</span> (!config-&gt;<a class="code" href="structast__bridge__config.html#c20456384feb648b4692b700ec570d42">timelimit</a>) {
<a name="l04042"></a>04042                res = <a class="code" href="channel_8h.html#8bba128582c81d1af777c11278bd4d19fd37b17491849eb3a8d0cd996d69fe1f">AST_BRIDGE_COMPLETE</a>;
<a name="l04043"></a>04043                <span class="keywordflow">break</span>;
<a name="l04044"></a>04044             }
<a name="l04045"></a>04045             to = 0;
<a name="l04046"></a>04046          }
<a name="l04047"></a>04047       }
<a name="l04048"></a>04048 
<a name="l04049"></a>04049       <span class="keywordflow">if</span> (config-&gt;<a class="code" href="structast__bridge__config.html#c20456384feb648b4692b700ec570d42">timelimit</a>) {
<a name="l04050"></a>04050          time_left_ms = config-&gt;<a class="code" href="structast__bridge__config.html#c20456384feb648b4692b700ec570d42">timelimit</a> - ast_tvdiff_ms(now, config-&gt;<a class="code" href="structast__bridge__config.html#c4d98dbd5badae901761ab6422fa3e70">start_time</a>);
<a name="l04051"></a>04051          <span class="keywordflow">if</span> (time_left_ms &lt; to)
<a name="l04052"></a>04052             to = time_left_ms;
<a name="l04053"></a>04053 
<a name="l04054"></a>04054          <span class="keywordflow">if</span> (time_left_ms &lt;= 0) {
<a name="l04055"></a>04055             <span class="keywordflow">if</span> (caller_warning &amp;&amp; config-&gt;<a class="code" href="structast__bridge__config.html#9a91b3041002dbc3bdeef606ad9a28be">end_sound</a>)
<a name="l04056"></a>04056                <a class="code" href="channel_8c.html#5acc06bc5b686545ac14a9906edd53fb">bridge_playfile</a>(c0, c1, config-&gt;<a class="code" href="structast__bridge__config.html#9a91b3041002dbc3bdeef606ad9a28be">end_sound</a>, 0);
<a name="l04057"></a>04057             <span class="keywordflow">if</span> (callee_warning &amp;&amp; config-&gt;<a class="code" href="structast__bridge__config.html#9a91b3041002dbc3bdeef606ad9a28be">end_sound</a>)
<a name="l04058"></a>04058                <a class="code" href="channel_8c.html#5acc06bc5b686545ac14a9906edd53fb">bridge_playfile</a>(c1, c0, config-&gt;<a class="code" href="structast__bridge__config.html#9a91b3041002dbc3bdeef606ad9a28be">end_sound</a>, 0);
<a name="l04059"></a>04059             *fo = NULL;
<a name="l04060"></a>04060             <span class="keywordflow">if</span> (who)
<a name="l04061"></a>04061                *rc = who;
<a name="l04062"></a>04062             res = 0;
<a name="l04063"></a>04063             <span class="keywordflow">break</span>;
<a name="l04064"></a>04064          }
<a name="l04065"></a>04065          
<a name="l04066"></a>04066          <span class="keywordflow">if</span> (!to) {
<a name="l04067"></a>04067             <span class="keywordflow">if</span> (time_left_ms &gt;= 5000 &amp;&amp; config-&gt;<a class="code" href="structast__bridge__config.html#9e189dff12c1fb230c009fc4ab527943">warning_sound</a> &amp;&amp; config-&gt;<a class="code" href="structast__bridge__config.html#09928184e097afa29194fffb0063815f">play_warning</a>) {
<a name="l04068"></a>04068                <span class="keywordtype">int</span> t = (time_left_ms + 500) / 1000; <span class="comment">/* round to nearest second */</span>
<a name="l04069"></a>04069                <span class="keywordflow">if</span> (caller_warning)
<a name="l04070"></a>04070                   <a class="code" href="channel_8c.html#5acc06bc5b686545ac14a9906edd53fb">bridge_playfile</a>(c0, c1, config-&gt;<a class="code" href="structast__bridge__config.html#9e189dff12c1fb230c009fc4ab527943">warning_sound</a>, t);
<a name="l04071"></a>04071                <span class="keywordflow">if</span> (callee_warning)
<a name="l04072"></a>04072                   <a class="code" href="channel_8c.html#5acc06bc5b686545ac14a9906edd53fb">bridge_playfile</a>(c1, c0, config-&gt;<a class="code" href="structast__bridge__config.html#9e189dff12c1fb230c009fc4ab527943">warning_sound</a>, t);
<a name="l04073"></a>04073             }
<a name="l04074"></a>04074             <span class="keywordflow">if</span> (config-&gt;<a class="code" href="structast__bridge__config.html#fcf98f20f13092d41dfe08cb2aec545b">warning_freq</a> &amp;&amp; (time_left_ms &gt; (config-&gt;<a class="code" href="structast__bridge__config.html#fcf98f20f13092d41dfe08cb2aec545b">warning_freq</a> + 5000)))
<a name="l04075"></a>04075                nexteventts = <a class="code" href="utils_8c.html#f3d6e948bdc914615d61b50418162c81">ast_tvadd</a>(nexteventts, ast_samp2tv(config-&gt;<a class="code" href="structast__bridge__config.html#fcf98f20f13092d41dfe08cb2aec545b">warning_freq</a>, 1000));
<a name="l04076"></a>04076             <span class="keywordflow">else</span>
<a name="l04077"></a>04077                nexteventts = <a class="code" href="utils_8c.html#f3d6e948bdc914615d61b50418162c81">ast_tvadd</a>(config-&gt;<a class="code" href="structast__bridge__config.html#c4d98dbd5badae901761ab6422fa3e70">start_time</a>, ast_samp2tv(config-&gt;<a class="code" href="structast__bridge__config.html#c20456384feb648b4692b700ec570d42">timelimit</a>, 1000));
<a name="l04078"></a>04078          }
<a name="l04079"></a>04079       }
<a name="l04080"></a>04080 
<a name="l04081"></a>04081       <span class="keywordflow">if</span> (c0-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> == <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1f3fe293730d3200b678a1daaa67ea5c5">AST_SOFTHANGUP_UNBRIDGE</a> || c1-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> == <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1f3fe293730d3200b678a1daaa67ea5c5">AST_SOFTHANGUP_UNBRIDGE</a>) {
<a name="l04082"></a>04082          <span class="keywordflow">if</span> (c0-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> == <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1f3fe293730d3200b678a1daaa67ea5c5">AST_SOFTHANGUP_UNBRIDGE</a>)
<a name="l04083"></a>04083             c0-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> = 0;
<a name="l04084"></a>04084          <span class="keywordflow">if</span> (c1-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> == <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1f3fe293730d3200b678a1daaa67ea5c5">AST_SOFTHANGUP_UNBRIDGE</a>)
<a name="l04085"></a>04085             c1-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> = 0;
<a name="l04086"></a>04086          c0-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a> = c1;
<a name="l04087"></a>04087          c1-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a> = c0;
<a name="l04088"></a>04088          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l04089"></a>04089             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Unbridge signal received. Ending native bridge.\n"</span>);
<a name="l04090"></a>04090          <span class="keywordflow">continue</span>;
<a name="l04091"></a>04091       }
<a name="l04092"></a>04092       
<a name="l04093"></a>04093       <span class="comment">/* Stop if we're a zombie or need a soft hangup */</span>
<a name="l04094"></a>04094       <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(c0, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>) || <a class="code" href="channel_8c.html#f72ecf6c6a107f089ffe657ff4c1e9b2">ast_check_hangup_locked</a>(c0) ||
<a name="l04095"></a>04095           <a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(c1, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>) || <a class="code" href="channel_8c.html#f72ecf6c6a107f089ffe657ff4c1e9b2">ast_check_hangup_locked</a>(c1)) {
<a name="l04096"></a>04096          *fo = NULL;
<a name="l04097"></a>04097          <span class="keywordflow">if</span> (who)
<a name="l04098"></a>04098             *rc = who;
<a name="l04099"></a>04099          res = 0;
<a name="l04100"></a>04100          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l04101"></a>04101             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Bridge stops because we're zombie or need a soft hangup: c0=%s, c1=%s, flags: %s,%s,%s,%s\n"</span>,
<a name="l04102"></a>04102                c0-&gt;name, c1-&gt;name,
<a name="l04103"></a>04103                <a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(c0, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>) ? <span class="stringliteral">"Yes"</span> : <span class="stringliteral">"No"</span>,
<a name="l04104"></a>04104                <a class="code" href="channel_8c.html#042e64a8d465783855a52ec8c56a9373">ast_check_hangup</a>(c0) ? <span class="stringliteral">"Yes"</span> : <span class="stringliteral">"No"</span>,
<a name="l04105"></a>04105                <a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(c1, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>) ? <span class="stringliteral">"Yes"</span> : <span class="stringliteral">"No"</span>,
<a name="l04106"></a>04106                <a class="code" href="channel_8c.html#042e64a8d465783855a52ec8c56a9373">ast_check_hangup</a>(c1) ? <span class="stringliteral">"Yes"</span> : <span class="stringliteral">"No"</span>);
<a name="l04107"></a>04107          <span class="keywordflow">break</span>;
<a name="l04108"></a>04108       }
<a name="l04109"></a>04109 
<a name="l04110"></a>04110       <span class="keywordflow">if</span> (c0-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#4c0be0704b102072d0c6885e304ee6a3">bridge</a> &amp;&amp;
<a name="l04111"></a>04111           (config-&gt;<a class="code" href="structast__bridge__config.html#c20456384feb648b4692b700ec570d42">timelimit</a> == 0) &amp;&amp;
<a name="l04112"></a>04112           (c0-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#4c0be0704b102072d0c6885e304ee6a3">bridge</a> == c1-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#4c0be0704b102072d0c6885e304ee6a3">bridge</a>) &amp;&amp;
<a name="l04113"></a>04113           !nativefailed &amp;&amp; !c0-&gt;<a class="code" href="structast__channel.html#08b5411f848a2581a41672a759c87380">monitor</a> &amp;&amp; !c1-&gt;<a class="code" href="structast__channel.html#08b5411f848a2581a41672a759c87380">monitor</a> &amp;&amp;
<a name="l04114"></a>04114           !c0-&gt;<a class="code" href="structast__channel.html#5e6a55de0bea527db5f05883c77f39a6">spies</a> &amp;&amp; !c1-&gt;<a class="code" href="structast__channel.html#5e6a55de0bea527db5f05883c77f39a6">spies</a> &amp;&amp; !<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(&amp;(config-&gt;<a class="code" href="structast__bridge__config.html#fa6efc124166cce0351265506b27ec86">features_callee</a>),<a class="code" href="channel_8h.html#02653d87b6fa8554fc0d1a3726fea2d06d1225b2615ed409be56bda96c5b71b9">AST_FEATURE_REDIRECT</a>) &amp;&amp;
<a name="l04115"></a>04115           !<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(&amp;(config-&gt;<a class="code" href="structast__bridge__config.html#9775c13d5cb338f60cdd1eeebf66c249">features_caller</a>),<a class="code" href="channel_8h.html#02653d87b6fa8554fc0d1a3726fea2d06d1225b2615ed409be56bda96c5b71b9">AST_FEATURE_REDIRECT</a>) ) {
<a name="l04116"></a>04116          <span class="comment">/* Looks like they share a bridge method and nothing else is in the way */</span>
<a name="l04117"></a>04117          <a class="code" href="utils_8h.html#3208623241ff7b4c93907944487502a1">ast_set_flag</a>(c0, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300b38fcf240d912cfa60d488dea99cab31">AST_FLAG_NBRIDGE</a>);
<a name="l04118"></a>04118          <a class="code" href="utils_8h.html#3208623241ff7b4c93907944487502a1">ast_set_flag</a>(c1, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300b38fcf240d912cfa60d488dea99cab31">AST_FLAG_NBRIDGE</a>);
<a name="l04119"></a>04119          <span class="keywordflow">if</span> ((res = c0-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#4c0be0704b102072d0c6885e304ee6a3">bridge</a>(c0, c1, config-&gt;<a class="code" href="structast__bridge__config.html#4e5868d676cb634aa75b125a0f741abf">flags</a>, fo, rc, to)) == <a class="code" href="channel_8h.html#8bba128582c81d1af777c11278bd4d19fd37b17491849eb3a8d0cd996d69fe1f">AST_BRIDGE_COMPLETE</a>) {
<a name="l04120"></a>04120             <span class="comment">/* \todo  XXX here should check that cid_num is not NULL */</span>
<a name="l04121"></a>04121             <a class="code" href="manager_8h.html#17a8c809d5b2d04cbb8969a209134c2b">manager_event</a>(<a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <span class="stringliteral">"Unlink"</span>,
<a name="l04122"></a>04122                      <span class="stringliteral">"Channel1: %s\r\n"</span>
<a name="l04123"></a>04123                      <span class="stringliteral">"Channel2: %s\r\n"</span>
<a name="l04124"></a>04124                      <span class="stringliteral">"Uniqueid1: %s\r\n"</span>
<a name="l04125"></a>04125                      <span class="stringliteral">"Uniqueid2: %s\r\n"</span>
<a name="l04126"></a>04126                      <span class="stringliteral">"CallerID1: %s\r\n"</span>
<a name="l04127"></a>04127                      <span class="stringliteral">"CallerID2: %s\r\n"</span>,
<a name="l04128"></a>04128                      c0-&gt;name, c1-&gt;name, c0-&gt;uniqueid, c1-&gt;uniqueid, c0-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>, c1-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>);
<a name="l04129"></a>04129             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l04130"></a>04130                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(LOG_DEBUG, <span class="stringliteral">"Returning from native bridge, channels: %s, %s\n"</span>, c0-&gt;name, c1-&gt;name);
<a name="l04131"></a>04131 
<a name="l04132"></a>04132             <a class="code" href="utils_8h.html#c2399a33be6ffb658bcf7c6a35531732">ast_clear_flag</a>(c0, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300b38fcf240d912cfa60d488dea99cab31">AST_FLAG_NBRIDGE</a>);
<a name="l04133"></a>04133             <a class="code" href="utils_8h.html#c2399a33be6ffb658bcf7c6a35531732">ast_clear_flag</a>(c1, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300b38fcf240d912cfa60d488dea99cab31">AST_FLAG_NBRIDGE</a>);
<a name="l04134"></a>04134 
<a name="l04135"></a>04135             <span class="keywordflow">if</span> (c0-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> == <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1f3fe293730d3200b678a1daaa67ea5c5">AST_SOFTHANGUP_UNBRIDGE</a> || c1-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> == <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1f3fe293730d3200b678a1daaa67ea5c5">AST_SOFTHANGUP_UNBRIDGE</a>)
<a name="l04136"></a>04136                <span class="keywordflow">continue</span>;
<a name="l04137"></a>04137 
<a name="l04138"></a>04138             c0-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a> = NULL;
<a name="l04139"></a>04139             c1-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a> = NULL;
<a name="l04140"></a>04140 
<a name="l04141"></a>04141             <span class="keywordflow">return</span> res;
<a name="l04142"></a>04142          } <span class="keywordflow">else</span> {
<a name="l04143"></a>04143             <a class="code" href="utils_8h.html#c2399a33be6ffb658bcf7c6a35531732">ast_clear_flag</a>(c0, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300b38fcf240d912cfa60d488dea99cab31">AST_FLAG_NBRIDGE</a>);
<a name="l04144"></a>04144             <a class="code" href="utils_8h.html#c2399a33be6ffb658bcf7c6a35531732">ast_clear_flag</a>(c1, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300b38fcf240d912cfa60d488dea99cab31">AST_FLAG_NBRIDGE</a>);
<a name="l04145"></a>04145          }
<a name="l04146"></a>04146          <span class="keywordflow">switch</span> (res) {
<a name="l04147"></a>04147          <span class="keywordflow">case</span> <a class="code" href="channel_8h.html#8bba128582c81d1af777c11278bd4d19ebe331af24cd5342764adc6f1b59fbec">AST_BRIDGE_RETRY</a>:
<a name="l04148"></a>04148             <span class="keywordflow">continue</span>;
<a name="l04149"></a>04149          <span class="keywordflow">default</span>:
<a name="l04150"></a>04150             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 2)
<a name="l04151"></a>04151                <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#aefd5a67b7464040f5352e4ecdc535ca">VERBOSE_PREFIX_3</a> <span class="stringliteral">"Native bridging %s and %s ended\n"</span>,
<a name="l04152"></a>04152                       c0-&gt;name, c1-&gt;name);
<a name="l04153"></a>04153             <span class="comment">/* fallthrough */</span>
<a name="l04154"></a>04154          <span class="keywordflow">case</span> <a class="code" href="channel_8h.html#8bba128582c81d1af777c11278bd4d19c05a72efa9f8f1c8ebcfaf8e6fe97524">AST_BRIDGE_FAILED_NOWARN</a>:
<a name="l04155"></a>04155             nativefailed++;
<a name="l04156"></a>04156             <span class="keywordflow">break</span>;
<a name="l04157"></a>04157          }
<a name="l04158"></a>04158       }
<a name="l04159"></a>04159    
<a name="l04160"></a>04160       <span class="keywordflow">if</span> (((c0-&gt;<a class="code" href="structast__channel.html#45a38ca474a4f1df88fe13d68bbb0b44">writeformat</a> != c1-&gt;<a class="code" href="structast__channel.html#c9d2702466074da94d21f26822247ed8">readformat</a>) || (c0-&gt;<a class="code" href="structast__channel.html#c9d2702466074da94d21f26822247ed8">readformat</a> != c1-&gt;<a class="code" href="structast__channel.html#45a38ca474a4f1df88fe13d68bbb0b44">writeformat</a>) ||
<a name="l04161"></a>04161           (c0-&gt;<a class="code" href="structast__channel.html#adbc0bbfec600539582f92b30ed1ecd7">nativeformats</a> != o0nativeformats) || (c1-&gt;<a class="code" href="structast__channel.html#adbc0bbfec600539582f92b30ed1ecd7">nativeformats</a> != o1nativeformats)) &amp;&amp;
<a name="l04162"></a>04162           !(c0-&gt;<a class="code" href="structast__channel.html#dac9630aec642a428cd73f4be0a03569">generator</a> || c1-&gt;<a class="code" href="structast__channel.html#dac9630aec642a428cd73f4be0a03569">generator</a>)) {
<a name="l04163"></a>04163          <span class="keywordflow">if</span> (<a class="code" href="channel_8c.html#d8ebadafdad36d56ae069bd9bbcf7c42">ast_channel_make_compatible</a>(c0, c1)) {
<a name="l04164"></a>04164             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Can't make %s and %s compatible\n"</span>, c0-&gt;name, c1-&gt;name);
<a name="l04165"></a>04165             <span class="comment">/* \todo  XXX here should check that cid_num is not NULL */</span>
<a name="l04166"></a>04166                                 <a class="code" href="manager_8h.html#17a8c809d5b2d04cbb8969a209134c2b">manager_event</a>(<a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <span class="stringliteral">"Unlink"</span>,
<a name="l04167"></a>04167                      <span class="stringliteral">"Channel1: %s\r\n"</span>
<a name="l04168"></a>04168                      <span class="stringliteral">"Channel2: %s\r\n"</span>
<a name="l04169"></a>04169                      <span class="stringliteral">"Uniqueid1: %s\r\n"</span>
<a name="l04170"></a>04170                      <span class="stringliteral">"Uniqueid2: %s\r\n"</span>
<a name="l04171"></a>04171                      <span class="stringliteral">"CallerID1: %s\r\n"</span>
<a name="l04172"></a>04172                      <span class="stringliteral">"CallerID2: %s\r\n"</span>,
<a name="l04173"></a>04173                      c0-&gt;name, c1-&gt;name, c0-&gt;uniqueid, c1-&gt;uniqueid, c0-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>, c1-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>);
<a name="l04174"></a>04174             <span class="keywordflow">return</span> <a class="code" href="channel_8h.html#8bba128582c81d1af777c11278bd4d198b00ec8ed330d763fd4f579d7c513d1d">AST_BRIDGE_FAILED</a>;
<a name="l04175"></a>04175          }
<a name="l04176"></a>04176          o0nativeformats = c0-&gt;<a class="code" href="structast__channel.html#adbc0bbfec600539582f92b30ed1ecd7">nativeformats</a>;
<a name="l04177"></a>04177          o1nativeformats = c1-&gt;<a class="code" href="structast__channel.html#adbc0bbfec600539582f92b30ed1ecd7">nativeformats</a>;
<a name="l04178"></a>04178       }
<a name="l04179"></a>04179       res = <a class="code" href="channel_8c.html#4f79ef2dc27d26c29b18b9ab40b5d56b">ast_generic_bridge</a>(c0, c1, config, fo, rc, nexteventts);
<a name="l04180"></a>04180       <span class="keywordflow">if</span> (res != <a class="code" href="channel_8h.html#8bba128582c81d1af777c11278bd4d19ebe331af24cd5342764adc6f1b59fbec">AST_BRIDGE_RETRY</a>)
<a name="l04181"></a>04181          <span class="keywordflow">break</span>;
<a name="l04182"></a>04182    }
<a name="l04183"></a>04183 
<a name="l04184"></a>04184    <a class="code" href="utils_8h.html#c2399a33be6ffb658bcf7c6a35531732">ast_clear_flag</a>(c0, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73000ecdf5f8a5869727e38bf9e1ca5a6cae">AST_FLAG_END_DTMF_ONLY</a>);
<a name="l04185"></a>04185    <a class="code" href="utils_8h.html#c2399a33be6ffb658bcf7c6a35531732">ast_clear_flag</a>(c1, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73000ecdf5f8a5869727e38bf9e1ca5a6cae">AST_FLAG_END_DTMF_ONLY</a>);
<a name="l04186"></a>04186 
<a name="l04187"></a>04187    c0-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a> = NULL;
<a name="l04188"></a>04188    c1-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a> = NULL;
<a name="l04189"></a>04189 
<a name="l04190"></a>04190    <span class="comment">/* \todo  XXX here should check that cid_num is not NULL */</span>
<a name="l04191"></a>04191    <a class="code" href="manager_8h.html#17a8c809d5b2d04cbb8969a209134c2b">manager_event</a>(<a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <span class="stringliteral">"Unlink"</span>,
<a name="l04192"></a>04192             <span class="stringliteral">"Channel1: %s\r\n"</span>
<a name="l04193"></a>04193             <span class="stringliteral">"Channel2: %s\r\n"</span>
<a name="l04194"></a>04194             <span class="stringliteral">"Uniqueid1: %s\r\n"</span>
<a name="l04195"></a>04195             <span class="stringliteral">"Uniqueid2: %s\r\n"</span>
<a name="l04196"></a>04196             <span class="stringliteral">"CallerID1: %s\r\n"</span>
<a name="l04197"></a>04197             <span class="stringliteral">"CallerID2: %s\r\n"</span>,
<a name="l04198"></a>04198             c0-&gt;name, c1-&gt;name, c0-&gt;uniqueid, c1-&gt;uniqueid, c0-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>, c1-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>);
<a name="l04199"></a>04199    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l04200"></a>04200       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(LOG_DEBUG, <span class="stringliteral">"Bridge stops bridging channels %s and %s\n"</span>, c0-&gt;name, c1-&gt;name);
<a name="l04201"></a>04201 
<a name="l04202"></a>04202    <span class="keywordflow">return</span> res;
<a name="l04203"></a>04203 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="49102d6d12a437bf6928bc9916194549"></a><!-- doxytag: member="channel.h::ast_channel_cmpwhentohangup" ref="49102d6d12a437bf6928bc9916194549" args="(struct ast_channel *chan, time_t offset)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_channel_cmpwhentohangup           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>time_t&nbsp;</td>
          <td class="mdname" nowrap> <em>offset</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Compare a offset with the settings of when to hang a channel up. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel on which to check for hang up </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>offset</em>&nbsp;</td><td>offset in seconds from current time </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>1, 0, or -1 This function compares a offset from current time with the absolute time out on a channel (when to hang up). If the absolute time out on a channel is earlier than current time plus the offset, it returns 1, if the two time values are equal, it return 0, otherwise, it return -1. </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l00394">394</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00416">ast_channel::whentohangup</a>.<div class="fragment"><pre class="fragment"><a name="l00395"></a>00395 {
<a name="l00396"></a>00396    time_t whentohangup;
<a name="l00397"></a>00397 
<a name="l00398"></a>00398    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#1272db9c0584f07eb3c6bae4e21fc7c8">whentohangup</a> == 0) {
<a name="l00399"></a>00399       <span class="keywordflow">return</span> (<a class="code" href="chan__alsa_8c.html#7a86c157ee9713c34fbd7a1ee40f0c5a">offset</a> == 0) ? 0 : -1;
<a name="l00400"></a>00400    } <span class="keywordflow">else</span> {
<a name="l00401"></a>00401       <span class="keywordflow">if</span> (<a class="code" href="chan__alsa_8c.html#7a86c157ee9713c34fbd7a1ee40f0c5a">offset</a> == 0)  <span class="comment">/* XXX why is this special ? */</span>
<a name="l00402"></a>00402          <span class="keywordflow">return</span> (1);
<a name="l00403"></a>00403       <span class="keywordflow">else</span> {
<a name="l00404"></a>00404          whentohangup = <a class="code" href="chan__alsa_8c.html#7a86c157ee9713c34fbd7a1ee40f0c5a">offset</a> + time (NULL);
<a name="l00405"></a>00405          <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#1272db9c0584f07eb3c6bae4e21fc7c8">whentohangup</a> &lt; whentohangup)
<a name="l00406"></a>00406             <span class="keywordflow">return</span> (1);
<a name="l00407"></a>00407          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#1272db9c0584f07eb3c6bae4e21fc7c8">whentohangup</a> == whentohangup)
<a name="l00408"></a>00408             <span class="keywordflow">return</span> (0);
<a name="l00409"></a>00409          <span class="keywordflow">else</span>
<a name="l00410"></a>00410             <span class="keywordflow">return</span> (-1);
<a name="l00411"></a>00411       }
<a name="l00412"></a>00412    }
<a name="l00413"></a>00413 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="cbc50cd4e716fe4486cf2dc81222e30e"></a><!-- doxytag: member="channel.h::ast_channel_datastore_add" ref="cbc50cd4e716fe4486cf2dc81222e30e" args="(struct ast_channel *chan, struct ast_datastore *datastore)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_channel_datastore_add           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__datastore.html">ast_datastore</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>datastore</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add a datastore to a channel. 
<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01212">1212</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00650">AST_LIST_INSERT_HEAD</a>.
<p>
Referenced by <a class="el" href="pbx__dundi_8c-source.html#l03869">dundi_query_read()</a>, <a class="el" href="func__enum_8c-source.html#l00155">enum_query_read()</a>, <a class="el" href="app__stack_8c-source.html#l00193">gosub_exec()</a>, and <a class="el" href="app__speech__utils_8c-source.html#l00346">speech_create()</a>.<div class="fragment"><pre class="fragment"><a name="l01213"></a>01213 {
<a name="l01214"></a>01214    <span class="keywordtype">int</span> res = 0;
<a name="l01215"></a>01215 
<a name="l01216"></a>01216    <a class="code" href="linkedlists_8h.html#5df56040a8838bdc841ef8eb179b7609">AST_LIST_INSERT_HEAD</a>(&amp;chan-&gt;datastores, datastore, entry);
<a name="l01217"></a>01217 
<a name="l01218"></a>01218    <span class="keywordflow">return</span> res;
<a name="l01219"></a>01219 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="5a56e43ad0ea2cecbf51410e82ea7455"></a><!-- doxytag: member="channel.h::ast_channel_datastore_alloc" ref="5a56e43ad0ea2cecbf51410e82ea7455" args="(const struct ast_datastore_info *info, char *uid)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__datastore.html">ast_datastore</a>* ast_channel_datastore_alloc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const struct <a class="el" href="structast__datastore__info.html">ast_datastore_info</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>uid</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Create a channel datastore structure. 
<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01151">1151</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, and <a class="el" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l01195">ast_channel_datastore_inherit()</a>, <a class="el" href="pbx__dundi_8c-source.html#l03869">dundi_query_read()</a>, <a class="el" href="func__enum_8c-source.html#l00155">enum_query_read()</a>, <a class="el" href="app__stack_8c-source.html#l00193">gosub_exec()</a>, and <a class="el" href="app__speech__utils_8c-source.html#l00346">speech_create()</a>.<div class="fragment"><pre class="fragment"><a name="l01152"></a>01152 {
<a name="l01153"></a>01153    <span class="keyword">struct </span><a class="code" href="structast__datastore.html">ast_datastore</a> *datastore = NULL;
<a name="l01154"></a>01154 
<a name="l01155"></a>01155    <span class="comment">/* Make sure we at least have type so we can identify this */</span>
<a name="l01156"></a>01156    <span class="keywordflow">if</span> (info == NULL) {
<a name="l01157"></a>01157       <span class="keywordflow">return</span> NULL;
<a name="l01158"></a>01158    }
<a name="l01159"></a>01159 
<a name="l01160"></a>01160    <span class="comment">/* Allocate memory for datastore and clear it */</span>
<a name="l01161"></a>01161    datastore = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*datastore));
<a name="l01162"></a>01162    <span class="keywordflow">if</span> (datastore == NULL) {
<a name="l01163"></a>01163       <span class="keywordflow">return</span> NULL;
<a name="l01164"></a>01164    }
<a name="l01165"></a>01165 
<a name="l01166"></a>01166    datastore-&gt;<a class="code" href="structast__datastore.html#caf9b6b99962bf5c2264824231d7a40c">info</a> = info;
<a name="l01167"></a>01167 
<a name="l01168"></a>01168    datastore-&gt;<a class="code" href="structast__datastore.html#9871d3a2c554b27151cacf1422eec048">uid</a> = <a class="code" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>(<a class="code" href="structast__datastore.html#9871d3a2c554b27151cacf1422eec048">uid</a>);
<a name="l01169"></a>01169 
<a name="l01170"></a>01170    <span class="keywordflow">return</span> datastore;
<a name="l01171"></a>01171 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a139501a58997c4f147764f1df0dccdd"></a><!-- doxytag: member="channel.h::ast_channel_datastore_find" ref="a139501a58997c4f147764f1df0dccdd" args="(struct ast_channel *chan, const struct ast_datastore_info *info, char *uid)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__datastore.html">ast_datastore</a>* ast_channel_datastore_find           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const struct <a class="el" href="structast__datastore__info.html">ast_datastore_info</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>info</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>uid</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Find a datastore on a channel. 
<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01239">1239</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00491">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h-source.html#l00554">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="channel_8h-source.html#l00200">ast_datastore::info</a>, and <a class="el" href="channel_8h-source.html#l00198">ast_datastore::uid</a>.
<p>
Referenced by <a class="el" href="pbx__dundi_8c-source.html#l03947">dundi_result_read()</a>, <a class="el" href="func__enum_8c-source.html#l00222">enum_result_read()</a>, <a class="el" href="app__speech__utils_8c-source.html#l00115">find_speech()</a>, <a class="el" href="app__stack_8c-source.html#l00193">gosub_exec()</a>, <a class="el" href="app__stack_8c-source.html#l00139">pop_exec()</a>, <a class="el" href="app__stack_8c-source.html#l00163">return_exec()</a>, <a class="el" href="app__speech__utils_8c-source.html#l00543">speech_background()</a>, and <a class="el" href="app__speech__utils_8c-source.html#l00775">speech_destroy()</a>.<div class="fragment"><pre class="fragment"><a name="l01240"></a>01240 {
<a name="l01241"></a>01241    <span class="keyword">struct </span><a class="code" href="structast__datastore.html">ast_datastore</a> *datastore = NULL;
<a name="l01242"></a>01242    
<a name="l01243"></a>01243    <span class="keywordflow">if</span> (info == NULL)
<a name="l01244"></a>01244       <span class="keywordflow">return</span> NULL;
<a name="l01245"></a>01245 
<a name="l01246"></a>01246    <a class="code" href="linkedlists_8h.html#915e438a9528c8d6316c617b5bd84487">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;chan-&gt;datastores, datastore, entry) {
<a name="l01247"></a>01247       <span class="keywordflow">if</span> (datastore-&gt;<a class="code" href="structast__datastore.html#caf9b6b99962bf5c2264824231d7a40c">info</a> == info) {
<a name="l01248"></a>01248          <span class="keywordflow">if</span> (<a class="code" href="structast__datastore.html#9871d3a2c554b27151cacf1422eec048">uid</a> != NULL &amp;&amp; datastore-&gt;<a class="code" href="structast__datastore.html#9871d3a2c554b27151cacf1422eec048">uid</a> != NULL) {
<a name="l01249"></a>01249             <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="structast__datastore.html#9871d3a2c554b27151cacf1422eec048">uid</a>, datastore-&gt;<a class="code" href="structast__datastore.html#9871d3a2c554b27151cacf1422eec048">uid</a>)) {
<a name="l01250"></a>01250                <span class="comment">/* Matched by type AND uid */</span>
<a name="l01251"></a>01251                <span class="keywordflow">break</span>;
<a name="l01252"></a>01252             }
<a name="l01253"></a>01253          } <span class="keywordflow">else</span> {
<a name="l01254"></a>01254             <span class="comment">/* Matched by type at least */</span>
<a name="l01255"></a>01255             <span class="keywordflow">break</span>;
<a name="l01256"></a>01256          }
<a name="l01257"></a>01257       }
<a name="l01258"></a>01258    }
<a name="l01259"></a>01259    <a class="code" href="linkedlists_8h.html#a93fdadc00a2a090968004b7d9c79630">AST_LIST_TRAVERSE_SAFE_END</a>
<a name="l01260"></a>01260 
<a name="l01261"></a>01261    <span class="keywordflow">return</span> datastore;
<a name="l01262"></a>01262 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="9b22e546aca18fcd4e4f512843f608c5"></a><!-- doxytag: member="channel.h::ast_channel_datastore_free" ref="9b22e546aca18fcd4e4f512843f608c5" args="(struct ast_datastore *datastore)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_channel_datastore_free           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__datastore.html">ast_datastore</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>datastore</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Free a channel datastore structure. 
<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01173">1173</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="utils_8h-source.html#l00344">ast_free</a>, <a class="el" href="channel_8h-source.html#l00199">ast_datastore::data</a>, <a class="el" href="structast__datastore__info.html#dcb7bbbeb2d36e8fbe0c9d592a992fd5">ast_datastore_info::destroy</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="channel_8h-source.html#l00200">ast_datastore::info</a>, and <a class="el" href="channel_8h-source.html#l00198">ast_datastore::uid</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l01069">ast_channel_free()</a>, and <a class="el" href="app__stack_8c-source.html#l00193">gosub_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l01174"></a>01174 {
<a name="l01175"></a>01175    <span class="keywordtype">int</span> res = 0;
<a name="l01176"></a>01176 
<a name="l01177"></a>01177    <span class="comment">/* Using the destroy function (if present) destroy the data */</span>
<a name="l01178"></a>01178    <span class="keywordflow">if</span> (datastore-&gt;<a class="code" href="structast__datastore.html#caf9b6b99962bf5c2264824231d7a40c">info</a>-&gt;<a class="code" href="structast__datastore__info.html#dcb7bbbeb2d36e8fbe0c9d592a992fd5">destroy</a> != NULL &amp;&amp; datastore-&gt;<a class="code" href="structast__datastore.html#8d777f385d3dfec8815d20f7496026dc">data</a> != NULL) {
<a name="l01179"></a>01179       datastore-&gt;<a class="code" href="structast__datastore.html#caf9b6b99962bf5c2264824231d7a40c">info</a>-&gt;<a class="code" href="structast__datastore__info.html#dcb7bbbeb2d36e8fbe0c9d592a992fd5">destroy</a>(datastore-&gt;<a class="code" href="structast__datastore.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l01180"></a>01180       datastore-&gt;<a class="code" href="structast__datastore.html#8d777f385d3dfec8815d20f7496026dc">data</a> = NULL;
<a name="l01181"></a>01181    }
<a name="l01182"></a>01182 
<a name="l01183"></a>01183    <span class="comment">/* Free allocated UID memory */</span>
<a name="l01184"></a>01184    <span class="keywordflow">if</span> (datastore-&gt;<a class="code" href="structast__datastore.html#9871d3a2c554b27151cacf1422eec048">uid</a> != NULL) {
<a name="l01185"></a>01185       <a class="code" href="utils_8h.html#801d8022c2922d0d4f73ba9e72c93865">ast_free</a>(datastore-&gt;<a class="code" href="structast__datastore.html#9871d3a2c554b27151cacf1422eec048">uid</a>);
<a name="l01186"></a>01186       datastore-&gt;<a class="code" href="structast__datastore.html#9871d3a2c554b27151cacf1422eec048">uid</a> = NULL;
<a name="l01187"></a>01187    }
<a name="l01188"></a>01188 
<a name="l01189"></a>01189    <span class="comment">/* Finally free memory used by ourselves */</span>
<a name="l01190"></a>01190    <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(datastore);
<a name="l01191"></a>01191 
<a name="l01192"></a>01192    <span class="keywordflow">return</span> res;
<a name="l01193"></a>01193 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="7ccb0875d5b63754a9c968f5dbb92d99"></a><!-- doxytag: member="channel.h::ast_channel_datastore_inherit" ref="7ccb0875d5b63754a9c968f5dbb92d99" args="(struct ast_channel *from, struct ast_channel *to)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_channel_datastore_inherit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>from</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>to</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Inherit datastores from a parent to a child. 
<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01195">1195</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l01151">ast_channel_datastore_alloc()</a>, <a class="el" href="linkedlists_8h-source.html#l00670">AST_LIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="channel_8h-source.html#l00199">ast_datastore::data</a>, <a class="el" href="channel_8h-source.html#l00158">DATASTORE_INHERIT_FOREVER</a>, <a class="el" href="structast__datastore__info.html#5269cd2ce9244cb1fe12923590c62067">ast_datastore_info::duplicate</a>, <a class="el" href="channel_8h-source.html#l00200">ast_datastore::info</a>, <a class="el" href="channel_8h-source.html#l00201">ast_datastore::inheritance</a>, and <a class="el" href="channel_8h-source.html#l00198">ast_datastore::uid</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>.<div class="fragment"><pre class="fragment"><a name="l01196"></a>01196 {
<a name="l01197"></a>01197    <span class="keyword">struct </span><a class="code" href="structast__datastore.html">ast_datastore</a> *datastore = NULL, *datastore2;
<a name="l01198"></a>01198 
<a name="l01199"></a>01199    <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;from-&gt;datastores, datastore, entry) {
<a name="l01200"></a>01200       <span class="keywordflow">if</span> (datastore-&gt;<a class="code" href="structast__datastore.html#5fed3411faf832174ef1f040028b2c21">inheritance</a> &gt; 0) {
<a name="l01201"></a>01201          datastore2 = <a class="code" href="channel_8c.html#5a56e43ad0ea2cecbf51410e82ea7455">ast_channel_datastore_alloc</a>(datastore-&gt;<a class="code" href="structast__datastore.html#caf9b6b99962bf5c2264824231d7a40c">info</a>, datastore-&gt;<a class="code" href="structast__datastore.html#9871d3a2c554b27151cacf1422eec048">uid</a>);
<a name="l01202"></a>01202          <span class="keywordflow">if</span> (datastore2) {
<a name="l01203"></a>01203             datastore2-&gt;data = datastore-&gt;<a class="code" href="structast__datastore.html#caf9b6b99962bf5c2264824231d7a40c">info</a>-&gt;<a class="code" href="structast__datastore__info.html#5269cd2ce9244cb1fe12923590c62067">duplicate</a>(datastore-&gt;<a class="code" href="structast__datastore.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l01204"></a>01204             datastore2-&gt;inheritance = datastore-&gt;<a class="code" href="structast__datastore.html#5fed3411faf832174ef1f040028b2c21">inheritance</a> == <a class="code" href="channel_8h.html#c6e71954f351d74faf8285b775ed08af">DATASTORE_INHERIT_FOREVER</a> ? <a class="code" href="channel_8h.html#c6e71954f351d74faf8285b775ed08af">DATASTORE_INHERIT_FOREVER</a> : datastore-&gt;<a class="code" href="structast__datastore.html#5fed3411faf832174ef1f040028b2c21">inheritance</a> - 1;
<a name="l01205"></a>01205             <a class="code" href="linkedlists_8h.html#8de6ce8a3b9d59e7e7fddee6b62b32a7">AST_LIST_INSERT_TAIL</a>(&amp;to-&gt;datastores, datastore2, entry);
<a name="l01206"></a>01206          }
<a name="l01207"></a>01207       }
<a name="l01208"></a>01208    }
<a name="l01209"></a>01209    <span class="keywordflow">return</span> 0;
<a name="l01210"></a>01210 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2703596e193d96ac5e31ee1f0f3ef4ce"></a><!-- doxytag: member="channel.h::ast_channel_datastore_remove" ref="2703596e193d96ac5e31ee1f0f3ef4ce" args="(struct ast_channel *chan, struct ast_datastore *datastore)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_channel_datastore_remove           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__datastore.html">ast_datastore</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>datastore</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Remove a datastore from a channel. 
<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01221">1221</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00516">AST_LIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h-source.html#l00491">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, and <a class="el" href="linkedlists_8h-source.html#l00554">AST_LIST_TRAVERSE_SAFE_END</a>.
<p>
Referenced by <a class="el" href="app__speech__utils_8c-source.html#l00543">speech_background()</a>, and <a class="el" href="app__speech__utils_8c-source.html#l00775">speech_destroy()</a>.<div class="fragment"><pre class="fragment"><a name="l01222"></a>01222 {
<a name="l01223"></a>01223    <span class="keyword">struct </span><a class="code" href="structast__datastore.html">ast_datastore</a> *datastore2 = NULL;
<a name="l01224"></a>01224    <span class="keywordtype">int</span> res = -1;
<a name="l01225"></a>01225 
<a name="l01226"></a>01226    <span class="comment">/* Find our position and remove ourselves */</span>
<a name="l01227"></a>01227    <a class="code" href="linkedlists_8h.html#915e438a9528c8d6316c617b5bd84487">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;chan-&gt;datastores, datastore2, entry) {
<a name="l01228"></a>01228       <span class="keywordflow">if</span> (datastore2 == datastore) {
<a name="l01229"></a>01229          <a class="code" href="linkedlists_8h.html#37f99379dafa45c921f95bf7235eb91d">AST_LIST_REMOVE_CURRENT</a>(&amp;chan-&gt;datastores, entry);
<a name="l01230"></a>01230          res = 0;
<a name="l01231"></a>01231          <span class="keywordflow">break</span>;
<a name="l01232"></a>01232       }
<a name="l01233"></a>01233    }
<a name="l01234"></a>01234    <a class="code" href="linkedlists_8h.html#a93fdadc00a2a090968004b7d9c79630">AST_LIST_TRAVERSE_SAFE_END</a>
<a name="l01235"></a>01235 
<a name="l01236"></a>01236    <span class="keywordflow">return</span> res;
<a name="l01237"></a>01237 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c96b0dddc19825d46cc8a62ae92085ab"></a><!-- doxytag: member="channel.h::ast_channel_defer_dtmf" ref="c96b0dddc19825d46cc8a62ae92085ab" args="(struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_channel_defer_dtmf           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chan</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set defer DTMF flag on channel. 
<p>
Defer DTMF so that you only read things like hangups and audio. Returns non-zero if channel was already DTMF-deferred or 0 if channel is just now being DTMF-deferred 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l00886">886</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730023cf26f45cc26e3a993f7dc09b130f33">AST_FLAG_DEFER_DTMF</a>, <a class="el" href="utils_8h-source.html#l00074">ast_set_flag</a>, and <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>.
<p>
Referenced by <a class="el" href="chan__iax2_8c-source.html#l09693">find_cache()</a>.<div class="fragment"><pre class="fragment"><a name="l00887"></a>00887 {
<a name="l00888"></a>00888    <span class="keywordtype">int</span> pre = 0;
<a name="l00889"></a>00889 
<a name="l00890"></a>00890    <span class="keywordflow">if</span> (chan) {
<a name="l00891"></a>00891       pre = <a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730023cf26f45cc26e3a993f7dc09b130f33">AST_FLAG_DEFER_DTMF</a>);
<a name="l00892"></a>00892       <a class="code" href="utils_8h.html#3208623241ff7b4c93907944487502a1">ast_set_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730023cf26f45cc26e3a993f7dc09b130f33">AST_FLAG_DEFER_DTMF</a>);
<a name="l00893"></a>00893    }
<a name="l00894"></a>00894    <span class="keywordflow">return</span> pre;
<a name="l00895"></a>00895 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4d00d0fe6e56604455705983fd7eb828"></a><!-- doxytag: member="channel.h::ast_channel_early_bridge" ref="4d00d0fe6e56604455705983fd7eb828" args="(struct ast_channel *c0, struct ast_channel *c1)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_channel_early_bridge           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c0</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c1</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Bridge two channels together (early). 
<p>
Bridge two channels together (early) <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c0</em>&nbsp;</td><td>first channel to bridge </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>c1</em>&nbsp;</td><td>second channel to bridge Bridge two channels (c0 and c1) together early. This implies either side may not be answered yet. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns 0 on success and -1 if it could not be done </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l03943">3943</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="structast__channel__tech.html#e648abe892e6f95be12bfc78cf0bf5fe">ast_channel_tech::early_bridge</a>, and <a class="el" href="channel_8h-source.html#l00385">ast_channel::tech</a>.
<p>
Referenced by <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, and <a class="el" href="app__dial_8c-source.html#l00532">wait_for_answer()</a>.<div class="fragment"><pre class="fragment"><a name="l03944"></a>03944 {
<a name="l03945"></a>03945    <span class="comment">/* Make sure we can early bridge, if not error out */</span>
<a name="l03946"></a>03946    <span class="keywordflow">if</span> (!c0-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#e648abe892e6f95be12bfc78cf0bf5fe">early_bridge</a> || (c1 &amp;&amp; (!c1-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#e648abe892e6f95be12bfc78cf0bf5fe">early_bridge</a> || c0-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#e648abe892e6f95be12bfc78cf0bf5fe">early_bridge</a> != c1-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#e648abe892e6f95be12bfc78cf0bf5fe">early_bridge</a>)))
<a name="l03947"></a>03947       <span class="keywordflow">return</span> -1;
<a name="l03948"></a>03948 
<a name="l03949"></a>03949    <span class="keywordflow">return</span> c0-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#e648abe892e6f95be12bfc78cf0bf5fe">early_bridge</a>(c0, c1);
<a name="l03950"></a>03950 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b5c070531d4d02ac1e0e2b8aeaf6687e"></a><!-- doxytag: member="channel.h::ast_channel_free" ref="b5c070531d4d02ac1e0e2b8aeaf6687e" args="(struct ast_channel *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_channel_free           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Free a channel structure. 
<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01069">1069</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00474">ast_channel::alertpipe</a>, <a class="el" href="app_8c-source.html#l00911">ast_app_group_discard()</a>, <a class="el" href="channel_8c-source.html#l01173">ast_channel_datastore_free()</a>, <a class="el" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>, <a class="el" href="channel_8h-source.html#l00141">AST_CHANNEL_NAME</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="channel_8c-source.html#l04909">ast_channel_whisper_stop()</a>, <a class="el" href="devicestate_8c-source.html#l00470">ast_device_state_changed_literal()</a>, <a class="el" href="frame_8h-source.html#l00396">ast_frfree()</a>, <a class="el" href="abstract__jb_8c-source.html#l00525">ast_jb_destroy()</a>, <a class="el" href="linkedlists_8h-source.html#l00620">AST_LIST_HEAD_INIT_NOLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00038">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00731">AST_LIST_REMOVE</a>, <a class="el" href="linkedlists_8h-source.html#l00710">AST_LIST_REMOVE_HEAD</a>, <a class="el" href="linkedlists_8h-source.html#l00104">AST_LIST_UNLOCK</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="channel_8c-source.html#l04449">ast_moh_cleanup()</a>, <a class="el" href="lock_8h-source.html#l00525">ast_mutex_destroy()</a>, <a class="el" href="stringfields_8h-source.html#l00364">ast_string_field_free_pools</a>, <a class="el" href="translate_8c-source.html#l00245">ast_translator_free_path()</a>, <a class="el" href="chanvars_8c-source.html#l00056">ast_var_delete()</a>, <a class="el" href="channel_8h-source.html#l00437">ast_channel::cid</a>, <a class="el" href="format__g726_8c-source.html#l00193">f</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="channel_8c-source.html#l01053">free_cid()</a>, <a class="el" href="channel_8h-source.html#l00418">ast_channel::lock</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="channel_8h-source.html#l00457">ast_channel::monitor</a>, <a class="el" href="channel_8h-source.html#l00402">ast_channel::music_state</a>, <a class="el" href="callerid_8c-source.html#l01043">name</a>, <a class="el" href="channel_8h-source.html#l00449">ast_channel::pbx</a>, <a class="el" href="channel_8h-source.html#l00480">ast_channel::readtrans</a>, <a class="el" href="channel_8h-source.html#l00424">ast_channel::sched</a>, <a class="el" href="sched_8c-source.html#l00088">sched_context_destroy()</a>, <a class="el" href="structast__channel__monitor.html#172ba70dfc80c54f386c2fa13574a011">ast_channel_monitor::stop</a>, <a class="el" href="channel_8h-source.html#l00388">ast_channel::tech_pvt</a>, <a class="el" href="channel_8h-source.html#l00431">ast_channel::timingfd</a>, <a class="el" href="channel_8h-source.html#l00467">ast_channel::varshead</a>, <a class="el" href="channel_8h-source.html#l00485">ast_channel::whisper</a>, and <a class="el" href="channel_8h-source.html#l00479">ast_channel::writetrans</a>.
<p>
Referenced by <a class="el" href="res__features_8c-source.html#l02163">action_bridge()</a>, <a class="el" href="chan__agent_8c-source.html#l00368">agent_cleanup()</a>, <a class="el" href="chan__agent_8c-source.html#l00909">agent_new()</a>, <a class="el" href="channel_8c-source.html#l03406">ast_do_masquerade()</a>, <a class="el" href="channel_8c-source.html#l01598">ast_hangup()</a>, <a class="el" href="pbx_8c-source.html#l04966">ast_pbx_outgoing_cdr_failed()</a>, <a class="el" href="chan__local_8c-source.html#l00593">local_new()</a>, <a class="el" href="app__voicemail_8c-source.html#l01965">make_email_file()</a>, <a class="el" href="pbx_8c-source.html#l01468">pbx_substitute_variables_helper_full()</a>, <a class="el" href="app__minivm_8c-source.html#l00892">sendmail()</a>, and <a class="el" href="app__voicemail_8c-source.html#l02166">sendpage()</a>.<div class="fragment"><pre class="fragment"><a name="l01070"></a>01070 {
<a name="l01071"></a>01071    <span class="keywordtype">int</span> fd;
<a name="l01072"></a>01072    <span class="keyword">struct </span><a class="code" href="structast__var__t.html">ast_var_t</a> *vardata;
<a name="l01073"></a>01073    <span class="keyword">struct </span><a class="code" href="structast__frame.html">ast_frame</a> *<a class="code" href="format__g726_8c.html#85b9b17a7dd34a3638c560bc9152473b">f</a>;
<a name="l01074"></a>01074    <span class="keyword">struct </span>varshead *headp;
<a name="l01075"></a>01075    <span class="keyword">struct </span><a class="code" href="structast__datastore.html">ast_datastore</a> *datastore = NULL;
<a name="l01076"></a>01076    <span class="keywordtype">char</span> <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>[<a class="code" href="channel_8h.html#57fb43d64b209037cdc198f3db578d39">AST_CHANNEL_NAME</a>];
<a name="l01077"></a>01077    
<a name="l01078"></a>01078    headp=&amp;<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>;
<a name="l01079"></a>01079    
<a name="l01080"></a>01080    <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;channels);
<a name="l01081"></a>01081    <a class="code" href="linkedlists_8h.html#d4a4c53d3b264b4e1c5e3fdd84cd8b5a">AST_LIST_REMOVE</a>(&amp;channels, <a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, <a class="code" href="structchan__list.html">chan_list</a>);
<a name="l01082"></a>01082    <span class="comment">/* Lock and unlock the channel just to be sure nobody</span>
<a name="l01083"></a>01083 <span class="comment">      has it locked still */</span>
<a name="l01084"></a>01084    <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>);
<a name="l01085"></a>01085    <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>);
<a name="l01086"></a>01086    <span class="keywordflow">if</span> (<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#25ab83fd9a6fe57f4133e359f88bb9d1">tech_pvt</a>) {
<a name="l01087"></a>01087       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Channel '%s' may not have been hung up properly\n"</span>, <a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;name);
<a name="l01088"></a>01088       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#25ab83fd9a6fe57f4133e359f88bb9d1">tech_pvt</a>);
<a name="l01089"></a>01089    }
<a name="l01090"></a>01090 
<a name="l01091"></a>01091    <span class="keywordflow">if</span> (<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#47721f99ae60cbec027428e52ad7ca39">sched</a>)
<a name="l01092"></a>01092       <a class="code" href="sched_8c.html#89e2eb9653fa462ad4ff62e05ad36050">sched_context_destroy</a>(<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#47721f99ae60cbec027428e52ad7ca39">sched</a>);
<a name="l01093"></a>01093 
<a name="l01094"></a>01094    ast_copy_string(name, <a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;name, <span class="keyword">sizeof</span>(name));
<a name="l01095"></a>01095 
<a name="l01096"></a>01096    <span class="comment">/* Stop monitoring */</span>
<a name="l01097"></a>01097    <span class="keywordflow">if</span> (<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#08b5411f848a2581a41672a759c87380">monitor</a>)
<a name="l01098"></a>01098       <a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#08b5411f848a2581a41672a759c87380">monitor</a>-&gt;<a class="code" href="structast__channel__monitor.html#172ba70dfc80c54f386c2fa13574a011">stop</a>( <a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, 0 );
<a name="l01099"></a>01099 
<a name="l01100"></a>01100    <span class="comment">/* If there is native format music-on-hold state, free it */</span>
<a name="l01101"></a>01101    <span class="keywordflow">if</span> (<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#e15d64fee78c33c64ef107f1bef4edd0">music_state</a>)
<a name="l01102"></a>01102       <a class="code" href="channel_8c.html#3c4d4ffc411bd181677307e95b6b8c7b">ast_moh_cleanup</a>(<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>);
<a name="l01103"></a>01103 
<a name="l01104"></a>01104    <span class="comment">/* if someone is whispering on the channel, stop them */</span>
<a name="l01105"></a>01105    <span class="keywordflow">if</span> (<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>)
<a name="l01106"></a>01106       <a class="code" href="channel_8c.html#79598f580fc373516b4489bc5ebb7b02">ast_channel_whisper_stop</a>(<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>);
<a name="l01107"></a>01107 
<a name="l01108"></a>01108    <span class="comment">/* Free translators */</span>
<a name="l01109"></a>01109    <span class="keywordflow">if</span> (<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#2c3e2372b54538a2ddf46c00fd6a0f8b">readtrans</a>)
<a name="l01110"></a>01110       <a class="code" href="translate_8c.html#8f7ccc974f6f91b750a59c4353700191">ast_translator_free_path</a>(<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#2c3e2372b54538a2ddf46c00fd6a0f8b">readtrans</a>);
<a name="l01111"></a>01111    <span class="keywordflow">if</span> (<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#539a57bca8693e9a17639bc306123548">writetrans</a>)
<a name="l01112"></a>01112       <a class="code" href="translate_8c.html#8f7ccc974f6f91b750a59c4353700191">ast_translator_free_path</a>(<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#539a57bca8693e9a17639bc306123548">writetrans</a>);
<a name="l01113"></a>01113    <span class="keywordflow">if</span> (<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#569f7a090087f9e7071a247a24ea0809">pbx</a>)
<a name="l01114"></a>01114       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"PBX may not have been terminated properly on '%s'\n"</span>, <a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;name);
<a name="l01115"></a>01115    <a class="code" href="channel_8c.html#ccea08979c0c8d9565d95c97bd022408">free_cid</a>(&amp;<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>);
<a name="l01116"></a>01116    <a class="code" href="lock_8h.html#1b27af7774f46859ffe2b1340ee7c082">ast_mutex_destroy</a>(&amp;<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l01117"></a>01117    <span class="comment">/* Close pipes if appropriate */</span>
<a name="l01118"></a>01118    <span class="keywordflow">if</span> ((fd = <a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#edfa4b7986a2ee7cd0db044fa4f67e8e">alertpipe</a>[0]) &gt; -1)
<a name="l01119"></a>01119       close(fd);
<a name="l01120"></a>01120    <span class="keywordflow">if</span> ((fd = <a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#edfa4b7986a2ee7cd0db044fa4f67e8e">alertpipe</a>[1]) &gt; -1)
<a name="l01121"></a>01121       close(fd);
<a name="l01122"></a>01122    <span class="keywordflow">if</span> ((fd = <a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#4cd06d1a010b6a371149b4a0adb2f884">timingfd</a>) &gt; -1)
<a name="l01123"></a>01123       close(fd);
<a name="l01124"></a>01124    <span class="keywordflow">while</span> ((f = <a class="code" href="linkedlists_8h.html#beec347da29fe6b0d7fdb3e80b851f90">AST_LIST_REMOVE_HEAD</a>(&amp;<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;readq, frame_list)))
<a name="l01125"></a>01125       <a class="code" href="frame_8h.html#506c759ec4950e7f7465e8f090a6252b">ast_frfree</a>(f);
<a name="l01126"></a>01126    
<a name="l01127"></a>01127    <span class="comment">/* Get rid of each of the data stores on the channel */</span>
<a name="l01128"></a>01128    <span class="keywordflow">while</span> ((datastore = <a class="code" href="linkedlists_8h.html#beec347da29fe6b0d7fdb3e80b851f90">AST_LIST_REMOVE_HEAD</a>(&amp;<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;datastores, entry)))
<a name="l01129"></a>01129       <span class="comment">/* Free the data store */</span>
<a name="l01130"></a>01130       <a class="code" href="channel_8c.html#9b22e546aca18fcd4e4f512843f608c5">ast_channel_datastore_free</a>(datastore);
<a name="l01131"></a>01131    <a class="code" href="linkedlists_8h.html#0ae37ea56ca862f6504390fd49b9839f">AST_LIST_HEAD_INIT_NOLOCK</a>(&amp;<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;datastores);
<a name="l01132"></a>01132 
<a name="l01133"></a>01133    <span class="comment">/* loop over the variables list, freeing all data and deleting list items */</span>
<a name="l01134"></a>01134    <span class="comment">/* no need to lock the list, as the channel is already locked */</span>
<a name="l01135"></a>01135    
<a name="l01136"></a>01136    <span class="keywordflow">while</span> ((vardata = <a class="code" href="linkedlists_8h.html#beec347da29fe6b0d7fdb3e80b851f90">AST_LIST_REMOVE_HEAD</a>(headp, entries)))
<a name="l01137"></a>01137       <a class="code" href="chanvars_8c.html#32e018d32324bab845a9cac601c175d8">ast_var_delete</a>(vardata);
<a name="l01138"></a>01138 
<a name="l01139"></a>01139    <a class="code" href="app_8c.html#3004a5d883799913a0f73f5bbf16b3fd">ast_app_group_discard</a>(<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>);
<a name="l01140"></a>01140 
<a name="l01141"></a>01141    <span class="comment">/* Destroy the jitterbuffer */</span>
<a name="l01142"></a>01142    <a class="code" href="abstract__jb_8c.html#38a4eb32a5c1425119f290654b6a4b0e">ast_jb_destroy</a>(<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>);
<a name="l01143"></a>01143 
<a name="l01144"></a>01144    <a class="code" href="stringfields_8h.html#772cf76139a5b96f329a48ae8307e142">ast_string_field_free_pools</a>(<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>);
<a name="l01145"></a>01145    <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>);
<a name="l01146"></a>01146    <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;channels);
<a name="l01147"></a>01147 
<a name="l01148"></a>01148    <a class="code" href="devicestate_8c.html#2416b5bb0bcab6392204637700a2d280">ast_device_state_changed_literal</a>(name);
<a name="l01149"></a>01149 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8fb30ace7afdc2899f9b9cdafbf49ff7"></a><!-- doxytag: member="channel.h::ast_channel_inherit_variables" ref="8fb30ace7afdc2899f9b9cdafbf49ff7" args="(const struct ast_channel *parent, struct ast_channel *child)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_channel_inherit_variables           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>parent</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>child</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Inherits channel variable from parent to child channel. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>parent</em>&nbsp;</td><td>Parent channel </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>child</em>&nbsp;</td><td>Child channel</td></tr>
  </table>
</dl>
Scans all channel variables in the parent channel, looking for those that should be copied into the child channel. Variables whose names begin with a single '_' are copied into the child channel with the prefix removed. Variables whose names begin with '__' are copied into the child channel with their names unchanged. 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l03341">3341</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00670">AST_LIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="chanvars_8c-source.html#l00039">ast_var_assign()</a>, <a class="el" href="chanvars_8c-source.html#l00077">ast_var_full_name()</a>, <a class="el" href="chanvars_8c-source.html#l00062">ast_var_name()</a>, <a class="el" href="chanvars_8c-source.html#l00082">ast_var_value()</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, and <a class="el" href="channel_8h-source.html#l00467">ast_channel::varshead</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="chan__agent_8c-source.html#l00622">agent_call()</a>, <a class="el" href="res__features_8c-source.html#l01295">ast_feature_request_and_dial()</a>, <a class="el" href="dial_8c-source.html#l00236">begin_dial()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="app__dial_8c-source.html#l00430">do_forward()</a>, <a class="el" href="app__followme_8c-source.html#l00763">findmeexec()</a>, <a class="el" href="app__queue_8c-source.html#l01660">ring_entry()</a>, and <a class="el" href="app__queue_8c-source.html#l01950">wait_for_answer()</a>.<div class="fragment"><pre class="fragment"><a name="l03342"></a>03342 {
<a name="l03343"></a>03343    <span class="keyword">struct </span><a class="code" href="structast__var__t.html">ast_var_t</a> *current, *newvar;
<a name="l03344"></a>03344    <span class="keyword">const</span> <span class="keywordtype">char</span> *varname;
<a name="l03345"></a>03345 
<a name="l03346"></a>03346    <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;parent-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>, current, entries) {
<a name="l03347"></a>03347       <span class="keywordtype">int</span> vartype = 0;
<a name="l03348"></a>03348 
<a name="l03349"></a>03349       varname = <a class="code" href="chanvars_8c.html#3ba7832cf0571fcb31d671de79e3210f">ast_var_full_name</a>(current);
<a name="l03350"></a>03350       <span class="keywordflow">if</span> (!varname)
<a name="l03351"></a>03351          <span class="keywordflow">continue</span>;
<a name="l03352"></a>03352 
<a name="l03353"></a>03353       <span class="keywordflow">if</span> (varname[0] == <span class="charliteral">'_'</span>) {
<a name="l03354"></a>03354          vartype = 1;
<a name="l03355"></a>03355          <span class="keywordflow">if</span> (varname[1] == <span class="charliteral">'_'</span>)
<a name="l03356"></a>03356             vartype = 2;
<a name="l03357"></a>03357       }
<a name="l03358"></a>03358 
<a name="l03359"></a>03359       <span class="keywordflow">switch</span> (vartype) {
<a name="l03360"></a>03360       <span class="keywordflow">case</span> 1:
<a name="l03361"></a>03361          newvar = <a class="code" href="chanvars_8c.html#4d0028e2dbd755ae38d2fe4204ad9071">ast_var_assign</a>(&amp;varname[1], <a class="code" href="chanvars_8c.html#6aa089cff5424a26ade21a520e443f82">ast_var_value</a>(current));
<a name="l03362"></a>03362          <span class="keywordflow">if</span> (newvar) {
<a name="l03363"></a>03363             <a class="code" href="linkedlists_8h.html#8de6ce8a3b9d59e7e7fddee6b62b32a7">AST_LIST_INSERT_TAIL</a>(&amp;child-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>, newvar, entries);
<a name="l03364"></a>03364             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l03365"></a>03365                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Copying soft-transferable variable %s.\n"</span>, <a class="code" href="chanvars_8c.html#29d40dfad3c6b59de315b3a0d2ed0a23">ast_var_name</a>(newvar));
<a name="l03366"></a>03366          }
<a name="l03367"></a>03367          <span class="keywordflow">break</span>;
<a name="l03368"></a>03368       <span class="keywordflow">case</span> 2:
<a name="l03369"></a>03369          newvar = <a class="code" href="chanvars_8c.html#4d0028e2dbd755ae38d2fe4204ad9071">ast_var_assign</a>(<a class="code" href="chanvars_8c.html#3ba7832cf0571fcb31d671de79e3210f">ast_var_full_name</a>(current), <a class="code" href="chanvars_8c.html#6aa089cff5424a26ade21a520e443f82">ast_var_value</a>(current));
<a name="l03370"></a>03370          <span class="keywordflow">if</span> (newvar) {
<a name="l03371"></a>03371             <a class="code" href="linkedlists_8h.html#8de6ce8a3b9d59e7e7fddee6b62b32a7">AST_LIST_INSERT_TAIL</a>(&amp;child-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>, newvar, entries);
<a name="l03372"></a>03372             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l03373"></a>03373                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Copying hard-transferable variable %s.\n"</span>, <a class="code" href="chanvars_8c.html#29d40dfad3c6b59de315b3a0d2ed0a23">ast_var_name</a>(newvar));
<a name="l03374"></a>03374          }
<a name="l03375"></a>03375          <span class="keywordflow">break</span>;
<a name="l03376"></a>03376       <span class="keywordflow">default</span>:
<a name="l03377"></a>03377          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l03378"></a>03378             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Not copying variable %s.\n"</span>, <a class="code" href="chanvars_8c.html#29d40dfad3c6b59de315b3a0d2ed0a23">ast_var_name</a>(current));
<a name="l03379"></a>03379          <span class="keywordflow">break</span>;
<a name="l03380"></a>03380       }
<a name="l03381"></a>03381    }
<a name="l03382"></a>03382 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="7481b2c2ff025b987fb82ae18bb8389e"></a><!-- doxytag: member="channel.h::ast_channel_make_compatible" ref="7481b2c2ff025b987fb82ae18bb8389e" args="(struct ast_channel *c0, struct ast_channel *c1)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_channel_make_compatible           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c0</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c1</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Makes two channel formats compatible. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c0</em>&nbsp;</td><td>first channel to make compatible </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>c1</em>&nbsp;</td><td>other channel to make compatible Set two channels to compatible formats -- call before ast_channel_bridge in general . </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns 0 on success and -1 if it could not be done </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l03253">3253</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l03222">ast_channel_make_compatible_helper()</a>.
<p>
Referenced by <a class="el" href="res__features_8c-source.html#l02163">action_bridge()</a>, <a class="el" href="app__followme_8c-source.html#l00909">app_exec()</a>, <a class="el" href="channel_8c-source.html#l03953">ast_channel_bridge()</a>, <a class="el" href="res__features_8c-source.html#l02716">bridge_exec()</a>, <a class="el" href="res__features_8c-source.html#l00765">check_compat()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="app__dial_8c-source.html#l00430">do_forward()</a>, <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>, and <a class="el" href="app__dial_8c-source.html#l00532">wait_for_answer()</a>.<div class="fragment"><pre class="fragment"><a name="l03254"></a>03254 {
<a name="l03255"></a>03255    <span class="comment">/* Some callers do not check return code, and we must try to set all call legs correctly */</span>
<a name="l03256"></a>03256    <span class="keywordtype">int</span> rc = 0;
<a name="l03257"></a>03257 
<a name="l03258"></a>03258    <span class="comment">/* Set up translation from the chan to the peer */</span>
<a name="l03259"></a>03259    rc = <a class="code" href="channel_8c.html#363733c9ea643796300b9d91632d97ea">ast_channel_make_compatible_helper</a>(<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, peer);
<a name="l03260"></a>03260 
<a name="l03261"></a>03261    <span class="keywordflow">if</span> (rc &lt; 0)
<a name="l03262"></a>03262       <span class="keywordflow">return</span> rc;
<a name="l03263"></a>03263 
<a name="l03264"></a>03264    <span class="comment">/* Set up translation from the peer to the chan */</span>
<a name="l03265"></a>03265    rc = <a class="code" href="channel_8c.html#363733c9ea643796300b9d91632d97ea">ast_channel_make_compatible_helper</a>(peer, <a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>);
<a name="l03266"></a>03266 
<a name="l03267"></a>03267    <span class="keywordflow">return</span> rc;
<a name="l03268"></a>03268 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8e30c09190bd2388188cd8bab35ba595"></a><!-- doxytag: member="channel.h::ast_channel_masquerade" ref="8e30c09190bd2388188cd8bab35ba595" args="(struct ast_channel *original, struct ast_channel *clone)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_channel_masquerade           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>original</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>clone</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Weird function made for call transfers. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>original</em>&nbsp;</td><td>channel to make a copy of </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>clone</em>&nbsp;</td><td>copy of the original channel This is a very strange and freaky function used primarily for transfer. Suppose that "original" and "clone" are two channels in random situations. This function takes the guts out of "clone" and puts them into the "original" channel, then alerts the channel driver of the change, asking it to fixup any private information (like the p-&gt;owner pointer) that is affected by the change. The physical layer of the original channel is hung up. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l03270">3270</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00409">ast_channel::_bridge</a>, <a class="el" href="channel_8c-source.html#l03754">ast_bridged_channel()</a>, <a class="el" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>, <a class="el" href="lock_8h.html#ed66db8089c98c0615ab831f4eba520a">ast_channel_trylock</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="frame_8c-source.html#l00142">ast_null_frame</a>, <a class="el" href="channel_8c-source.html#l00795">ast_queue_frame()</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="channel_8h-source.html#l00410">ast_channel::masq</a>, <a class="el" href="channel_8h-source.html#l00411">ast_channel::masqr</a>, and <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04595">ast_async_goto()</a>, <a class="el" href="res__features_8c-source.html#l00473">ast_masq_park_call()</a>, <a class="el" href="res__features_8c-source.html#l02403">ast_pickup_call()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02897">attempt_transfer()</a>, <a class="el" href="res__features_8c-source.html#l00776">builtin_atxfer()</a>, <a class="el" href="chan__agent_8c-source.html#l01153">check_availability()</a>, <a class="el" href="chan__local_8c-source.html#l00234">check_bridge()</a>, <a class="el" href="res__features_8c-source.html#l00192">check_goto_on_transfer()</a>, <a class="el" href="res__features_8c-source.html#l02147">do_bridge_masquerade()</a>, <a class="el" href="chan__sip_8c-source.html#l13936">handle_invite_replaces()</a>, <a class="el" href="chan__iax2_8c-source.html#l06306">iax_park()</a>, <a class="el" href="chan__misdn_8c-source.html#l03544">misdn_transfer_bc()</a>, <a class="el" href="app__directed__pickup_8c-source.html#l00058">pickup_do()</a>, and <a class="el" href="chan__sip_8c-source.html#l13574">sip_park()</a>.<div class="fragment"><pre class="fragment"><a name="l03271"></a>03271 {
<a name="l03272"></a>03272    <span class="keywordtype">int</span> res = -1;
<a name="l03273"></a>03273    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *final_orig = original, *final_clone = clone;
<a name="l03274"></a>03274 
<a name="l03275"></a>03275    <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(original);
<a name="l03276"></a>03276    <span class="keywordflow">while</span> (<a class="code" href="lock_8h.html#ed66db8089c98c0615ab831f4eba520a">ast_channel_trylock</a>(clone)) {
<a name="l03277"></a>03277       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(original);
<a name="l03278"></a>03278       usleep(1);
<a name="l03279"></a>03279       <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(original);
<a name="l03280"></a>03280    }
<a name="l03281"></a>03281 
<a name="l03282"></a>03282    <span class="comment">/* each of these channels may be sitting behind a channel proxy (i.e. chan_agent)</span>
<a name="l03283"></a>03283 <span class="comment">      and if so, we don't really want to masquerade it, but its proxy */</span>
<a name="l03284"></a>03284    <span class="keywordflow">if</span> (original-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a> &amp;&amp; (original-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a> != <a class="code" href="channel_8c.html#8f80b59690710acfe4fc82cfcbbf9ee9">ast_bridged_channel</a>(original)) &amp;&amp; (original-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a>-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a> != original))
<a name="l03285"></a>03285       final_orig = original-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a>;
<a name="l03286"></a>03286 
<a name="l03287"></a>03287    <span class="keywordflow">if</span> (clone-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a> &amp;&amp; (clone-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a> != <a class="code" href="channel_8c.html#8f80b59690710acfe4fc82cfcbbf9ee9">ast_bridged_channel</a>(clone)) &amp;&amp; (clone-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a>-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a> != clone))
<a name="l03288"></a>03288       final_clone = clone-&gt;<a class="code" href="structast__channel.html#d1256a036a9f1d1bb86a04aa3e2c35dd">_bridge</a>;
<a name="l03289"></a>03289 
<a name="l03290"></a>03290    <span class="keywordflow">if</span> ((final_orig != original) || (final_clone != clone)) {
<a name="l03291"></a>03291       <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(final_orig);
<a name="l03292"></a>03292       <span class="keywordflow">while</span> (<a class="code" href="lock_8h.html#ed66db8089c98c0615ab831f4eba520a">ast_channel_trylock</a>(final_clone)) {
<a name="l03293"></a>03293          <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(final_orig);
<a name="l03294"></a>03294          usleep(1);
<a name="l03295"></a>03295          <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(final_orig);
<a name="l03296"></a>03296       }
<a name="l03297"></a>03297       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(clone);
<a name="l03298"></a>03298       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(original);
<a name="l03299"></a>03299       original = final_orig;
<a name="l03300"></a>03300       clone = final_clone;
<a name="l03301"></a>03301    }
<a name="l03302"></a>03302 
<a name="l03303"></a>03303    <span class="keywordflow">if</span> (original == clone) {
<a name="l03304"></a>03304       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Can't masquerade channel '%s' into itself!\n"</span>, original-&gt;name);
<a name="l03305"></a>03305       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(clone);
<a name="l03306"></a>03306       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(original);
<a name="l03307"></a>03307       <span class="keywordflow">return</span> -1;
<a name="l03308"></a>03308    }
<a name="l03309"></a>03309 
<a name="l03310"></a>03310    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l03311"></a>03311       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Planning to masquerade channel %s into the structure of %s\n"</span>,
<a name="l03312"></a>03312          clone-&gt;name, original-&gt;name);
<a name="l03313"></a>03313    <span class="keywordflow">if</span> (original-&gt;<a class="code" href="structast__channel.html#f980faa30a783f7d18ceb4783afc1c69">masq</a>) {
<a name="l03314"></a>03314       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"%s is already going to masquerade as %s\n"</span>,
<a name="l03315"></a>03315          original-&gt;<a class="code" href="structast__channel.html#f980faa30a783f7d18ceb4783afc1c69">masq</a>-&gt;name, original-&gt;name);
<a name="l03316"></a>03316    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (clone-&gt;<a class="code" href="structast__channel.html#407a336ed0d13fc2cea1c71a81ad05df">masqr</a>) {
<a name="l03317"></a>03317       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"%s is already going to masquerade as %s\n"</span>,
<a name="l03318"></a>03318          clone-&gt;name, clone-&gt;<a class="code" href="structast__channel.html#407a336ed0d13fc2cea1c71a81ad05df">masqr</a>-&gt;name);
<a name="l03319"></a>03319    } <span class="keywordflow">else</span> {
<a name="l03320"></a>03320       original-&gt;<a class="code" href="structast__channel.html#f980faa30a783f7d18ceb4783afc1c69">masq</a> = clone;
<a name="l03321"></a>03321       clone-&gt;<a class="code" href="structast__channel.html#407a336ed0d13fc2cea1c71a81ad05df">masqr</a> = original;
<a name="l03322"></a>03322       <a class="code" href="channel_8c.html#c02f134e64b4fc85c1efd80b8685b635">ast_queue_frame</a>(original, &amp;<a class="code" href="frame_8c.html#8bfe1415e256ff41d93a3ce9396e815f">ast_null_frame</a>);
<a name="l03323"></a>03323       <a class="code" href="channel_8c.html#c02f134e64b4fc85c1efd80b8685b635">ast_queue_frame</a>(clone, &amp;<a class="code" href="frame_8c.html#8bfe1415e256ff41d93a3ce9396e815f">ast_null_frame</a>);
<a name="l03324"></a>03324       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l03325"></a>03325          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Done planning to masquerade channel %s into the structure of %s\n"</span>, clone-&gt;name, original-&gt;name);
<a name="l03326"></a>03326       res = 0;
<a name="l03327"></a>03327    }
<a name="l03328"></a>03328 
<a name="l03329"></a>03329    <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(clone);
<a name="l03330"></a>03330    <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(original);
<a name="l03331"></a>03331 
<a name="l03332"></a>03332    <span class="keywordflow">return</span> res;
<a name="l03333"></a>03333 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="21079feca37bb062d35f1a6f04916757"></a><!-- doxytag: member="channel.h::ast_channel_queryoption" ref="21079feca37bb062d35f1a6f04916757" args="(struct ast_channel *channel, int option, void *data, int *datalen, int block)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__frame.html">ast_frame</a>* ast_channel_queryoption           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>channel</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>option</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>datalen</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>block</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Query the value of an option, optionally blocking until a reply is received Works similarly to setoption except only reads the options.     </td>
  </tr>
</table>
<a class="anchor" name="1187446bddf5734a294a3ca0598584df"></a><!-- doxytag: member="channel.h::ast_channel_register" ref="1187446bddf5734a294a3ca0598584df" args="(const struct ast_channel_tech *tech)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_channel_register           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const struct <a class="el" href="structast__channel__tech.html">ast_channel_tech</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>tech</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Register a channel technology (a new channel driver) Called by a channel module to register the kind of channels it supports. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tech</em>&nbsp;</td><td>Structure defining channel technology or "type" </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns 0 on success, -1 on failure. </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l00416">416</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="linkedlists_8h-source.html#l00650">AST_LIST_INSERT_HEAD</a>, <a class="el" href="linkedlists_8h-source.html#l00038">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00104">AST_LIST_UNLOCK</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="adsistub_8c-source.html#l00055">chan</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="channel_8c-source.html#l00120">chanlist::tech</a>, <a class="el" href="channel_8h-source.html#l00235">ast_channel_tech::type</a>, and <a class="el" href="logger_8h-source.html#l00044">VERBOSE_PREFIX_2</a>.
<p>
Referenced by <a class="el" href="chan__agent_8c-source.html#l02476">load_module()</a>, and <a class="el" href="chan__mgcp_8c-source.html#l04344">unload_module()</a>.<div class="fragment"><pre class="fragment"><a name="l00417"></a>00417 {
<a name="l00418"></a>00418    <span class="keyword">struct </span><a class="code" href="structchanlist.html">chanlist</a> *<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>;
<a name="l00419"></a>00419 
<a name="l00420"></a>00420    <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;channels);
<a name="l00421"></a>00421 
<a name="l00422"></a>00422    <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;backends, chan, list) {
<a name="l00423"></a>00423       <span class="keywordflow">if</span> (!strcasecmp(tech-&gt;<a class="code" href="structast__channel__tech.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, chan-&gt;<a class="code" href="structchanlist.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>)) {
<a name="l00424"></a>00424          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Already have a handler for type '%s'\n"</span>, tech-&gt;<a class="code" href="structast__channel__tech.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>);
<a name="l00425"></a>00425          <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;channels);
<a name="l00426"></a>00426          <span class="keywordflow">return</span> -1;
<a name="l00427"></a>00427       }
<a name="l00428"></a>00428    }
<a name="l00429"></a>00429    
<a name="l00430"></a>00430    <span class="keywordflow">if</span> (!(chan = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*chan)))) {
<a name="l00431"></a>00431       <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;channels);
<a name="l00432"></a>00432       <span class="keywordflow">return</span> -1;
<a name="l00433"></a>00433    }
<a name="l00434"></a>00434    chan-&gt;tech = tech;
<a name="l00435"></a>00435    <a class="code" href="linkedlists_8h.html#5df56040a8838bdc841ef8eb179b7609">AST_LIST_INSERT_HEAD</a>(&amp;backends, chan, list);
<a name="l00436"></a>00436 
<a name="l00437"></a>00437    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l00438"></a>00438       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Registered handler for '%s' (%s)\n"</span>, chan-&gt;tech-&gt;type, chan-&gt;tech-&gt;description);
<a name="l00439"></a>00439 
<a name="l00440"></a>00440    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 1)
<a name="l00441"></a>00441       <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Registered channel type '%s' (%s)\n"</span>, chan-&gt;tech-&gt;type,
<a name="l00442"></a>00442              chan-&gt;tech-&gt;description);
<a name="l00443"></a>00443 
<a name="l00444"></a>00444    <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;channels);
<a name="l00445"></a>00445    <span class="keywordflow">return</span> 0;
<a name="l00446"></a>00446 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="0f66478027b42c17d2be4906671da404"></a><!-- doxytag: member="channel.h::ast_channel_sendhtml" ref="0f66478027b42c17d2be4906671da404" args="(struct ast_channel *channel, int subclass, const char *data, int datalen)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_channel_sendhtml           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>channel</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>subclass</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>datalen</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Send HTML or URL on link. Returns 0 on success or -1 on failure 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l03209">3209</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="structast__channel__tech.html#b5688a161e75fbbe138b4d165d4b75f5">ast_channel_tech::send_html</a>, and <a class="el" href="channel_8h-source.html#l00385">ast_channel::tech</a>.
<p>
Referenced by <a class="el" href="chan__agent_8c-source.html#l00529">agent_sendhtml()</a>, <a class="el" href="channel_8c-source.html#l03216">ast_channel_sendurl()</a>, and <a class="el" href="app__dial_8c-source.html#l00532">wait_for_answer()</a>.<div class="fragment"><pre class="fragment"><a name="l03210"></a>03210 {
<a name="l03211"></a>03211    <span class="keywordflow">if</span> (<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#b5688a161e75fbbe138b4d165d4b75f5">send_html</a>)
<a name="l03212"></a>03212       <span class="keywordflow">return</span> <a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#b5688a161e75fbbe138b4d165d4b75f5">send_html</a>(<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, subclass, data, datalen);
<a name="l03213"></a>03213    <span class="keywordflow">return</span> -1;
<a name="l03214"></a>03214 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3833447fb6c948c99cd67de25c565179"></a><!-- doxytag: member="channel.h::ast_channel_sendurl" ref="3833447fb6c948c99cd67de25c565179" args="(struct ast_channel *channel, const char *url)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_channel_sendurl           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>channel</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>url</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Send URL on link. Returns 0 on success or -1 on failure 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l03216">3216</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l03209">ast_channel_sendhtml()</a>, and <a class="el" href="frame_8h-source.html#l00201">AST_HTML_URL</a>.
<p>
Referenced by <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="app__url_8c-source.html#l00070">sendurl_exec()</a>, and <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>.<div class="fragment"><pre class="fragment"><a name="l03217"></a>03217 {
<a name="l03218"></a>03218    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#117e5372c6521fad97e632610e428451">ast_channel_sendhtml</a>(<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, <a class="code" href="frame_8h.html#5049521fc1c798b9ff0afb2b34eca0b4">AST_HTML_URL</a>, url, strlen(url) + 1);
<a name="l03219"></a>03219 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8455f544c874bf1316d542cec38a2ab9"></a><!-- doxytag: member="channel.h::ast_channel_setoption" ref="8455f544c874bf1316d542cec38a2ab9" args="(struct ast_channel *channel, int option, void *data, int datalen, int block)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_channel_setoption           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>channel</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>option</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>datalen</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>block</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sets an option on a channel. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>channel</em>&nbsp;</td><td>channel to set options on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>option</em>&nbsp;</td><td>option to change </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>data specific to option </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>datalen</em>&nbsp;</td><td>length of the data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>block</em>&nbsp;</td><td>blocking or not Set an option on a channel (see <a class="el" href="frame_8h.html">frame.h</a>), optionally blocking awaiting the reply Returns 0 on success and -1 on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l04206">4206</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, <a class="el" href="structast__channel__tech.html#23d58d6d97fa0932dda059f8b09d62e0">ast_channel_tech::setoption</a>, and <a class="el" href="channel_8h-source.html#l00385">ast_channel::tech</a>.
<p>
Referenced by <a class="el" href="res__features_8c-source.html#l01478">ast_bridge_call()</a>, <a class="el" href="app__chanspy_8c-source.html#l00465">common_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l01350">conf_run()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="res__agi_8c-source.html#l00486">handle_tddmode()</a>, <a class="el" href="app__minivm_8c-source.html#l01278">play_record_review()</a>, <a class="el" href="app__meetme_8c-source.html#l00677">reset_volumes()</a>, <a class="el" href="app__rpt_8c-source.html#l05604">rpt()</a>, <a class="el" href="app__meetme_8c-source.html#l00606">set_listen_volume()</a>, <a class="el" href="app__meetme_8c-source.html#l00594">set_talk_volume()</a>, <a class="el" href="app__chanspy_8c-source.html#l00256">set_volume()</a>, <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>, <a class="el" href="app__voicemail_8c-source.html#l03966">vm_forwardoptions()</a>, and <a class="el" href="chan__zap_8c-source.html#l02612">zt_hangup()</a>.<div class="fragment"><pre class="fragment"><a name="l04207"></a>04207 {
<a name="l04208"></a>04208    <span class="keywordtype">int</span> res;
<a name="l04209"></a>04209 
<a name="l04210"></a>04210    <span class="keywordflow">if</span> (<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#23d58d6d97fa0932dda059f8b09d62e0">setoption</a>) {
<a name="l04211"></a>04211       res = <a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#23d58d6d97fa0932dda059f8b09d62e0">setoption</a>(<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, option, data, datalen);
<a name="l04212"></a>04212       <span class="keywordflow">if</span> (res &lt; 0)
<a name="l04213"></a>04213          <span class="keywordflow">return</span> res;
<a name="l04214"></a>04214    } <span class="keywordflow">else</span> {
<a name="l04215"></a>04215       errno = ENOSYS;
<a name="l04216"></a>04216       <span class="keywordflow">return</span> -1;
<a name="l04217"></a>04217    }
<a name="l04218"></a>04218    <span class="keywordflow">if</span> (block) {
<a name="l04219"></a>04219       <span class="comment">/* XXX Implement blocking -- just wait for our option frame reply, discarding</span>
<a name="l04220"></a>04220 <span class="comment">         intermediate packets. XXX */</span>
<a name="l04221"></a>04221       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"XXX Blocking not implemented yet XXX\n"</span>);
<a name="l04222"></a>04222       <span class="keywordflow">return</span> -1;
<a name="l04223"></a>04223    }
<a name="l04224"></a>04224    <span class="keywordflow">return</span> 0;
<a name="l04225"></a>04225 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a572798172ac3e5c4a518e6c247da125"></a><!-- doxytag: member="channel.h::ast_channel_setwhentohangup" ref="a572798172ac3e5c4a518e6c247da125" args="(struct ast_channel *chan, time_t offset)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_channel_setwhentohangup           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>time_t&nbsp;</td>
          <td class="mdname" nowrap> <em>offset</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set when to hang a channel up. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel on which to check for hang up </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>offset</em>&nbsp;</td><td>offset in seconds from current time of when to hang up This function sets the absolute time out on a channel (when to hang up). </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l00386">386</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="frame_8c-source.html#l00142">ast_null_frame</a>, <a class="el" href="channel_8c-source.html#l00795">ast_queue_frame()</a>, and <a class="el" href="channel_8h-source.html#l00416">ast_channel::whentohangup</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l02116">action_timeout()</a>, and <a class="el" href="func__timeout_8c-source.html#l00090">timeout_write()</a>.<div class="fragment"><pre class="fragment"><a name="l00387"></a>00387 {
<a name="l00388"></a>00388    chan-&gt;<a class="code" href="structast__channel.html#1272db9c0584f07eb3c6bae4e21fc7c8">whentohangup</a> = <a class="code" href="chan__alsa_8c.html#7a86c157ee9713c34fbd7a1ee40f0c5a">offset</a> ? time(NULL) + <a class="code" href="chan__alsa_8c.html#7a86c157ee9713c34fbd7a1ee40f0c5a">offset</a> : 0;
<a name="l00389"></a>00389    <a class="code" href="channel_8c.html#c02f134e64b4fc85c1efd80b8685b635">ast_queue_frame</a>(chan, &amp;<a class="code" href="frame_8c.html#8bfe1415e256ff41d93a3ce9396e815f">ast_null_frame</a>);
<a name="l00390"></a>00390    <span class="keywordflow">return</span>;
<a name="l00391"></a>00391 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="df0067eebc6d6ba27b24f955cd779a7f"></a><!-- doxytag: member="channel.h::ast_channel_start_silence_generator" ref="df0067eebc6d6ba27b24f955cd779a7f" args="(struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__silence__generator.html">ast_silence_generator</a>* ast_channel_start_silence_generator           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chan</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Starts a silence generator on the given channel. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>The channel to generate silence on </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>An <a class="el" href="structast__silence__generator.html">ast_silence_generator</a> pointer, or NULL if an error occurs</dd></dl>
This function will cause SLINEAR silence to be generated on the supplied channel until it is disabled; if the channel cannot be put into SLINEAR mode then the function will fail.<p>
The pointer returned by this function must be preserved and passed to ast_channel_stop_silence_generator when you wish to stop the silence generation. 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l04654">4654</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l01764">ast_activate_generator()</a>, <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="frame_8h-source.html#l00233">AST_FORMAT_SLINEAR</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="channel_8c-source.html#l02926">ast_set_write_format()</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, <a class="el" href="channel_8c-source.html#l04651">ast_silence_generator::old_write_format</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, and <a class="el" href="channel_8h-source.html#l00478">ast_channel::writeformat</a>.
<p>
Referenced by <a class="el" href="app_8c-source.html#l00509">__ast_play_and_record()</a>, <a class="el" href="app__chanspy_8c-source.html#l00266">channel_spy()</a>, and <a class="el" href="app__record_8c-source.html#l00078">record_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l04655"></a>04655 {
<a name="l04656"></a>04656    <span class="keyword">struct </span><a class="code" href="structast__silence__generator.html">ast_silence_generator</a> *<a class="code" href="structstate.html">state</a>;
<a name="l04657"></a>04657 
<a name="l04658"></a>04658    <span class="keywordflow">if</span> (!(state = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*state)))) {
<a name="l04659"></a>04659       <span class="keywordflow">return</span> NULL;
<a name="l04660"></a>04660    }
<a name="l04661"></a>04661 
<a name="l04662"></a>04662    state-&gt;old_write_format = chan-&gt;<a class="code" href="structast__channel.html#45a38ca474a4f1df88fe13d68bbb0b44">writeformat</a>;
<a name="l04663"></a>04663 
<a name="l04664"></a>04664    <span class="keywordflow">if</span> (<a class="code" href="channel_8c.html#ebcd70a10759c189c265a97b5a9f78c3">ast_set_write_format</a>(chan, <a class="code" href="frame_8h.html#ce4d062ff9a85be84b636e7ec67a068b">AST_FORMAT_SLINEAR</a>) &lt; 0) {
<a name="l04665"></a>04665       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Could not set write format to SLINEAR\n"</span>);
<a name="l04666"></a>04666       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(state);
<a name="l04667"></a>04667       <span class="keywordflow">return</span> NULL;
<a name="l04668"></a>04668    }
<a name="l04669"></a>04669 
<a name="l04670"></a>04670    <a class="code" href="channel_8c.html#51350b9fba7a6a2428e1b3a13a131d54">ast_activate_generator</a>(chan, &amp;<a class="code" href="channel_8c.html#f6b0b17253eb9e88697ec93cd107f232">silence_generator</a>, state);
<a name="l04671"></a>04671 
<a name="l04672"></a>04672    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l04673"></a>04673       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Started silence generator on '%s'\n"</span>, chan-&gt;name);
<a name="l04674"></a>04674 
<a name="l04675"></a>04675    <span class="keywordflow">return</span> state;
<a name="l04676"></a>04676 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="925b5f1e2127332abaf35b5106ca9df4"></a><!-- doxytag: member="channel.h::ast_channel_stop_silence_generator" ref="925b5f1e2127332abaf35b5106ca9df4" args="(struct ast_channel *chan, struct ast_silence_generator *state)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_channel_stop_silence_generator           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__silence__generator.html">ast_silence_generator</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>state</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Stops a previously-started silence generator on the given channel. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>The channel to operate on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>state</em>&nbsp;</td><td>The <a class="el" href="structast__silence__generator.html">ast_silence_generator</a> pointer return by a previous call to ast_channel_start_silence_generator. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>nothing</dd></dl>
This function will stop the operating silence generator and return the channel to its previous write format. 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l04678">4678</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l01729">ast_deactivate_generator()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="channel_8c-source.html#l02926">ast_set_write_format()</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, <a class="el" href="channel_8c-source.html#l04651">ast_silence_generator::old_write_format</a>, and <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>.
<p>
Referenced by <a class="el" href="app_8c-source.html#l00509">__ast_play_and_record()</a>, <a class="el" href="app__chanspy_8c-source.html#l00266">channel_spy()</a>, and <a class="el" href="app__record_8c-source.html#l00078">record_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l04679"></a>04679 {
<a name="l04680"></a>04680    <span class="keywordflow">if</span> (!state)
<a name="l04681"></a>04681       <span class="keywordflow">return</span>;
<a name="l04682"></a>04682 
<a name="l04683"></a>04683    <a class="code" href="channel_8c.html#e4e0e5c1767576b38fb1a893dfd8cb2b">ast_deactivate_generator</a>(chan);
<a name="l04684"></a>04684 
<a name="l04685"></a>04685    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l04686"></a>04686       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Stopped silence generator on '%s'\n"</span>, chan-&gt;name);
<a name="l04687"></a>04687 
<a name="l04688"></a>04688    <span class="keywordflow">if</span> (<a class="code" href="channel_8c.html#ebcd70a10759c189c265a97b5a9f78c3">ast_set_write_format</a>(chan, state-&gt;<a class="code" href="structast__silence__generator.html#ad9a1725ddc8a612d7c0f0c273901cc5">old_write_format</a>) &lt; 0)
<a name="l04689"></a>04689       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Could not return write format to its original state\n"</span>);
<a name="l04690"></a>04690 
<a name="l04691"></a>04691    <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(state);
<a name="l04692"></a>04692 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3c70e41f9d8d7f139a047a5c0db514b6"></a><!-- doxytag: member="channel.h::ast_channel_supports_html" ref="3c70e41f9d8d7f139a047a5c0db514b6" args="(struct ast_channel *channel)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_channel_supports_html           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>channel</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns 0 if channel does not support HTML or non-zero if it does 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l03204">3204</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="structast__channel__tech.html#b5688a161e75fbbe138b4d165d4b75f5">ast_channel_tech::send_html</a>, and <a class="el" href="channel_8h-source.html#l00385">ast_channel::tech</a>.
<p>
Referenced by <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="app__url_8c-source.html#l00070">sendurl_exec()</a>, and <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>.<div class="fragment"><pre class="fragment"><a name="l03205"></a>03205 {
<a name="l03206"></a>03206    <span class="keywordflow">return</span> (<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#b5688a161e75fbbe138b4d165d4b75f5">send_html</a>) ? 1 : 0;
<a name="l03207"></a>03207 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="f73f024d0d929e70569cec47b297ee68"></a><!-- doxytag: member="channel.h::ast_channel_undefer_dtmf" ref="f73f024d0d929e70569cec47b297ee68" args="(struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_channel_undefer_dtmf           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chan</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unset defer DTMF flag on channel. 
<p>
Undo defer. ast_read will return any dtmf characters that were queued 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l00898">898</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="utils_8h-source.html#l00081">ast_clear_flag</a>, and <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730023cf26f45cc26e3a993f7dc09b130f33">AST_FLAG_DEFER_DTMF</a>.
<p>
Referenced by <a class="el" href="chan__iax2_8c-source.html#l09693">find_cache()</a>, and <a class="el" href="app__rpt_8c-source.html#l02483">rpt_call()</a>.<div class="fragment"><pre class="fragment"><a name="l00899"></a>00899 {
<a name="l00900"></a>00900    <span class="keywordflow">if</span> (chan)
<a name="l00901"></a>00901       <a class="code" href="utils_8h.html#c2399a33be6ffb658bcf7c6a35531732">ast_clear_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730023cf26f45cc26e3a993f7dc09b130f33">AST_FLAG_DEFER_DTMF</a>);
<a name="l00902"></a>00902 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="f47e36ee9d2beb6eee7be098c604caea"></a><!-- doxytag: member="channel.h::ast_channel_unregister" ref="f47e36ee9d2beb6eee7be098c604caea" args="(const struct ast_channel_tech *tech)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_channel_unregister           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const struct <a class="el" href="structast__channel__tech.html">ast_channel_tech</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>tech</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unregister a channel technology. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tech</em>&nbsp;</td><td>Structure defining channel technology or "type" that was previously registered </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>No return value. </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l00449">449</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00038">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00516">AST_LIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h-source.html#l00491">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h-source.html#l00554">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h-source.html#l00104">AST_LIST_UNLOCK</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="adsistub_8c-source.html#l00055">chan</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="channel_8c-source.html#l00120">chanlist::tech</a>, <a class="el" href="channel_8h-source.html#l00235">ast_channel_tech::type</a>, and <a class="el" href="logger_8h-source.html#l00044">VERBOSE_PREFIX_2</a>.
<p>
Referenced by <a class="el" href="chan__iax2_8c-source.html#l10340">__unload_module()</a>, and <a class="el" href="chan__agent_8c-source.html#l02513">unload_module()</a>.<div class="fragment"><pre class="fragment"><a name="l00450"></a>00450 {
<a name="l00451"></a>00451    <span class="keyword">struct </span><a class="code" href="structchanlist.html">chanlist</a> *<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>;
<a name="l00452"></a>00452 
<a name="l00453"></a>00453    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l00454"></a>00454       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Unregistering channel type '%s'\n"</span>, tech-&gt;<a class="code" href="structast__channel__tech.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>);
<a name="l00455"></a>00455 
<a name="l00456"></a>00456    <a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;channels);
<a name="l00457"></a>00457 
<a name="l00458"></a>00458    <a class="code" href="linkedlists_8h.html#915e438a9528c8d6316c617b5bd84487">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;backends, chan, list) {
<a name="l00459"></a>00459       <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structchanlist.html#d9f9133fb120cd6096870bc2b496805b">tech</a> == tech) {
<a name="l00460"></a>00460          <a class="code" href="linkedlists_8h.html#37f99379dafa45c921f95bf7235eb91d">AST_LIST_REMOVE_CURRENT</a>(&amp;backends, list);
<a name="l00461"></a>00461          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(chan);
<a name="l00462"></a>00462          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 1)
<a name="l00463"></a>00463             <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Unregistered channel type '%s'\n"</span>, tech-&gt;<a class="code" href="structast__channel__tech.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>);
<a name="l00464"></a>00464          <span class="keywordflow">break</span>;   
<a name="l00465"></a>00465       }
<a name="l00466"></a>00466    }
<a name="l00467"></a>00467    <a class="code" href="linkedlists_8h.html#a93fdadc00a2a090968004b7d9c79630">AST_LIST_TRAVERSE_SAFE_END</a>
<a name="l00468"></a>00468 
<a name="l00469"></a>00469    <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;channels);
<a name="l00470"></a>00470 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8ada12445e0d71c8bcd465f6838bf4e5"></a><!-- doxytag: member="channel.h::ast_channel_walk_locked" ref="8ada12445e0d71c8bcd465f6838bf4e5" args="(const struct ast_channel *prev)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a>* ast_channel_walk_locked           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>prev</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Browse channels in use Browse the channels currently in use. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>prev</em>&nbsp;</td><td>where you want to start in the channel list </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns the next channel in the list, NULL on end. If it returns a channel, that channel *has been locked*! </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l00989">989</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l00928">channel_find_locked()</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l01587">action_status()</a>, <a class="el" href="cli_8c-source.html#l00873">ast_complete_channels()</a>, <a class="el" href="res__features_8c-source.html#l02403">ast_pickup_call()</a>, <a class="el" href="chan__misdn_8c-source.html#l01377">complete_ch_helper()</a>, <a class="el" href="cli_8c-source.html#l00452">handle_chanlist()</a>, <a class="el" href="cli_8c-source.html#l00677">handle_core_set_debug_channel()</a>, <a class="el" href="res__musiconhold_8c-source.html#l01127">moh_on_off()</a>, <a class="el" href="app__chanspy_8c-source.html#l00443">next_channel()</a>, <a class="el" href="app__directed__pickup_8c-source.html#l00093">pickup_by_exten()</a>, <a class="el" href="app__directed__pickup_8c-source.html#l00113">pickup_by_mark()</a>, and <a class="el" href="app__softhangup_8c-source.html#l00056">softhangup_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l00990"></a>00990 {
<a name="l00991"></a>00991    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#188578d17e5577beb5ec3575458d3f71">channel_find_locked</a>(prev, NULL, 0, NULL, NULL);
<a name="l00992"></a>00992 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c45fab3584a74234dc1c9662ba76e8f1"></a><!-- doxytag: member="channel.h::ast_channel_whisper_feed" ref="c45fab3584a74234dc1c9662ba76e8f1" args="(struct ast_channel *chan, struct ast_frame *f)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_channel_whisper_feed           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>f</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Feed an audio frame into the whisper buffer on a channel. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>The channel to whisper onto </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>f</em>&nbsp;</td><td>The frame to to whisper onto chan </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 for success, non-zero for failure </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l04897">4897</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="lock_8h-source.html#l00530">ast_mutex_lock()</a>, <a class="el" href="lock_8h-source.html#l00520">ast_mutex_unlock()</a>, <a class="el" href="slinfactory_8c-source.html#l00057">ast_slinfactory_feed()</a>, <a class="el" href="channel_8c-source.html#l00085">ast_channel_whisper_buffer::lock</a>, <a class="el" href="channel_8c-source.html#l00086">ast_channel_whisper_buffer::sf</a>, and <a class="el" href="channel_8h-source.html#l00485">ast_channel::whisper</a>.
<p>
Referenced by <a class="el" href="app__chanspy_8c-source.html#l00266">channel_spy()</a>.<div class="fragment"><pre class="fragment"><a name="l04898"></a>04898 {
<a name="l04899"></a>04899    <span class="keywordflow">if</span> (!chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>)
<a name="l04900"></a>04900       <span class="keywordflow">return</span> -1;
<a name="l04901"></a>04901 
<a name="l04902"></a>04902    <a class="code" href="lock_8h.html#b3c5e3093b325167f88db93c8b4b2421">ast_mutex_lock</a>(&amp;chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l04903"></a>04903    <a class="code" href="slinfactory_8c.html#9fc1819fc7a7eae55d77524c91133126">ast_slinfactory_feed</a>(&amp;chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#60d31eb37595dd44584be5ef363283e3">sf</a>, f);
<a name="l04904"></a>04904    <a class="code" href="lock_8h.html#1d33e3caf152f0901c5ebdb69c2d4d26">ast_mutex_unlock</a>(&amp;chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l04905"></a>04905 
<a name="l04906"></a>04906    <span class="keywordflow">return</span> 0;
<a name="l04907"></a>04907 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="eadc89eb057511322a2aebad4074df6a"></a><!-- doxytag: member="channel.h::ast_channel_whisper_start" ref="eadc89eb057511322a2aebad4074df6a" args="(struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_channel_whisper_start           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chan</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Begin 'whispering' onto a channel. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>The channel to whisper onto </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 for success, non-zero for failure</dd></dl>
This function will add a whisper buffer onto a channel and set a flag causing writes to the channel to reduce the volume level of the written audio samples, and then to mix in audio from the whisper buffer if it is available.<p>
<dl compact><dt><b>Note:</b></dt><dd>Note: This function performs no locking; you must hold the channel's lock before calling this function. </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l04882">4882</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730059fb89e0dc785928def8b9daa1a2d316">AST_FLAG_WHISPER</a>, <a class="el" href="lock_8h-source.html#l00508">ast_mutex_init()</a>, <a class="el" href="utils_8h-source.html#l00074">ast_set_flag</a>, <a class="el" href="slinfactory_8c-source.html#l00038">ast_slinfactory_init()</a>, <a class="el" href="channel_8c-source.html#l00085">ast_channel_whisper_buffer::lock</a>, <a class="el" href="channel_8c-source.html#l00086">ast_channel_whisper_buffer::sf</a>, and <a class="el" href="channel_8h-source.html#l00485">ast_channel::whisper</a>.
<p>
Referenced by <a class="el" href="app__chanspy_8c-source.html#l00266">channel_spy()</a>.<div class="fragment"><pre class="fragment"><a name="l04883"></a>04883 {
<a name="l04884"></a>04884    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>)
<a name="l04885"></a>04885       <span class="keywordflow">return</span> -1;
<a name="l04886"></a>04886 
<a name="l04887"></a>04887    <span class="keywordflow">if</span> (!(chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a> = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>))))
<a name="l04888"></a>04888       <span class="keywordflow">return</span> -1;
<a name="l04889"></a>04889 
<a name="l04890"></a>04890    <a class="code" href="lock_8h.html#33e99ac90b0ca47211841b5cab79ffc4">ast_mutex_init</a>(&amp;chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l04891"></a>04891    <a class="code" href="slinfactory_8c.html#8d2bd2b35c60c1eac6e16829d6c013f8">ast_slinfactory_init</a>(&amp;chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#60d31eb37595dd44584be5ef363283e3">sf</a>);
<a name="l04892"></a>04892    <a class="code" href="utils_8h.html#3208623241ff7b4c93907944487502a1">ast_set_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730059fb89e0dc785928def8b9daa1a2d316">AST_FLAG_WHISPER</a>);
<a name="l04893"></a>04893 
<a name="l04894"></a>04894    <span class="keywordflow">return</span> 0;
<a name="l04895"></a>04895 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="79598f580fc373516b4489bc5ebb7b02"></a><!-- doxytag: member="channel.h::ast_channel_whisper_stop" ref="79598f580fc373516b4489bc5ebb7b02" args="(struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_channel_whisper_stop           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chan</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Stop 'whispering' onto a channel. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>The channel to whisper onto </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 for success, non-zero for failure</dd></dl>
Note: This function performs no locking; you must hold the channel's lock before calling this function. 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l04909">4909</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="utils_8h-source.html#l00081">ast_clear_flag</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730059fb89e0dc785928def8b9daa1a2d316">AST_FLAG_WHISPER</a>, <a class="el" href="frame_8h-source.html#l00233">AST_FORMAT_SLINEAR</a>, <a class="el" href="lock_8h-source.html#l00525">ast_mutex_destroy()</a>, <a class="el" href="channel_8c-source.html#l02926">ast_set_write_format()</a>, <a class="el" href="slinfactory_8c-source.html#l00044">ast_slinfactory_destroy()</a>, <a class="el" href="translate_8c-source.html#l00245">ast_translator_free_path()</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="channel_8c-source.html#l00087">ast_channel_whisper_buffer::original_format</a>, <a class="el" href="channel_8c-source.html#l00088">ast_channel_whisper_buffer::path</a>, <a class="el" href="channel_8h-source.html#l00485">ast_channel::whisper</a>, and <a class="el" href="channel_8h-source.html#l00478">ast_channel::writeformat</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l01069">ast_channel_free()</a>, <a class="el" href="channel_8c-source.html#l03406">ast_do_masquerade()</a>, and <a class="el" href="app__chanspy_8c-source.html#l00266">channel_spy()</a>.<div class="fragment"><pre class="fragment"><a name="l04910"></a>04910 {
<a name="l04911"></a>04911    <span class="keywordflow">if</span> (!chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>)
<a name="l04912"></a>04912       <span class="keywordflow">return</span>;
<a name="l04913"></a>04913 
<a name="l04914"></a>04914    <a class="code" href="utils_8h.html#c2399a33be6ffb658bcf7c6a35531732">ast_clear_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730059fb89e0dc785928def8b9daa1a2d316">AST_FLAG_WHISPER</a>);
<a name="l04915"></a>04915    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#d6fe1d0be6347b8ef2427fa629c04485">path</a>)
<a name="l04916"></a>04916       <a class="code" href="translate_8c.html#8f7ccc974f6f91b750a59c4353700191">ast_translator_free_path</a>(chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#d6fe1d0be6347b8ef2427fa629c04485">path</a>);
<a name="l04917"></a>04917    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#c8ae1c62d224b4f0a5c49e99a77ed792">original_format</a> &amp;&amp; chan-&gt;<a class="code" href="structast__channel.html#45a38ca474a4f1df88fe13d68bbb0b44">writeformat</a> == <a class="code" href="frame_8h.html#ce4d062ff9a85be84b636e7ec67a068b">AST_FORMAT_SLINEAR</a>)
<a name="l04918"></a>04918       <a class="code" href="channel_8c.html#ebcd70a10759c189c265a97b5a9f78c3">ast_set_write_format</a>(chan, chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#c8ae1c62d224b4f0a5c49e99a77ed792">original_format</a>);
<a name="l04919"></a>04919    <a class="code" href="slinfactory_8c.html#da832a838a40d7af123a1611df14aaea">ast_slinfactory_destroy</a>(&amp;chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#60d31eb37595dd44584be5ef363283e3">sf</a>);
<a name="l04920"></a>04920    <a class="code" href="lock_8h.html#1b27af7774f46859ffe2b1340ee7c082">ast_mutex_destroy</a>(&amp;chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l04921"></a>04921    <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>);
<a name="l04922"></a>04922    chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a> = NULL;
<a name="l04923"></a>04923 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="267d0942d73ed05c65b6702fd3d0f2e0"></a><!-- doxytag: member="channel.h::ast_channeltype_list" ref="267d0942d73ed05c65b6702fd3d0f2e0" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__variable.html">ast_variable</a>* ast_channeltype_list           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
return an <a class="el" href="structast__variable.html">ast_variable</a> list of channeltypes 
<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l00186">186</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="config_8c-source.html#l00183">ast_variable_new()</a>, <a class="el" href="channel_8h-source.html#l00236">ast_channel_tech::description</a>, <a class="el" href="channel_8c-source.html#l00120">chanlist::tech</a>, <a class="el" href="channel_8h-source.html#l00235">ast_channel_tech::type</a>, and <a class="el" href="ast__expr2f_8c-source.html#l01417">var</a>.<div class="fragment"><pre class="fragment"><a name="l00187"></a>00187 {
<a name="l00188"></a>00188    <span class="keyword">struct </span><a class="code" href="structchanlist.html">chanlist</a> *cl;
<a name="l00189"></a>00189    <span class="keyword">struct </span><a class="code" href="structast__variable.html">ast_variable</a> *<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>=NULL, *prev = NULL;
<a name="l00190"></a>00190    <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;backends, cl, list) {
<a name="l00191"></a>00191       <span class="keywordflow">if</span> (prev)  {
<a name="l00192"></a>00192          <span class="keywordflow">if</span> ((prev-&gt;next = <a class="code" href="config_8c.html#c21fb3a90ccd9ec4f8708c3b67b3c654">ast_variable_new</a>(cl-&gt;<a class="code" href="structchanlist.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, cl-&gt;<a class="code" href="structchanlist.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#67daf92c833c41c95db874e18fcb2786">description</a>)))
<a name="l00193"></a>00193             prev = prev-&gt;next;
<a name="l00194"></a>00194       } <span class="keywordflow">else</span> {
<a name="l00195"></a>00195          var = <a class="code" href="config_8c.html#c21fb3a90ccd9ec4f8708c3b67b3c654">ast_variable_new</a>(cl-&gt;<a class="code" href="structchanlist.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, cl-&gt;<a class="code" href="structchanlist.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#67daf92c833c41c95db874e18fcb2786">description</a>);
<a name="l00196"></a>00196          prev = var;
<a name="l00197"></a>00197       }
<a name="l00198"></a>00198    }
<a name="l00199"></a>00199    <span class="keywordflow">return</span> var;
<a name="l00200"></a>00200 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="042e64a8d465783855a52ec8c56a9373"></a><!-- doxytag: member="channel.h::ast_check_hangup" ref="042e64a8d465783855a52ec8c56a9373" args="(struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_check_hangup           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chan</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Check to see if a channel is needing hang up. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel on which to check for hang up This function determines if the channel is being requested to be hung up. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns 0 if not, or 1 if hang up is requested (including time-out). </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l00325">325</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00414">ast_channel::_softhangup</a>, <a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a12709ffb7179ec4c9b3ba505519ddc84e">AST_SOFTHANGUP_TIMEOUT</a>, <a class="el" href="channel_8h-source.html#l00388">ast_channel::tech_pvt</a>, and <a class="el" href="channel_8h-source.html#l00416">ast_channel::whentohangup</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l01682">__ast_answer()</a>, <a class="el" href="channel_8c-source.html#l02060">__ast_read()</a>, <a class="el" href="manager_8c-source.html#l01726">action_redirect()</a>, <a class="el" href="app__externalivr_8c-source.html#l00244">app_exec()</a>, <a class="el" href="res__features_8c-source.html#l00231">ast_bridge_call_thread()</a>, <a class="el" href="channel_8c-source.html#l03114">ast_call()</a>, <a class="el" href="cdr_8c-source.html#l00885">ast_cdr_update()</a>, <a class="el" href="channel_8c-source.html#l03953">ast_channel_bridge()</a>, <a class="el" href="channel_8c-source.html#l00339">ast_check_hangup_locked()</a>, <a class="el" href="res__features_8c-source.html#l01295">ast_feature_request_and_dial()</a>, <a class="el" href="channel_8c-source.html#l02453">ast_indicate_data()</a>, <a class="el" href="channel_8c-source.html#l03161">ast_readstring_full()</a>, <a class="el" href="channel_8c-source.html#l02522">ast_recvtext()</a>, <a class="el" href="channel_8c-source.html#l02549">ast_sendtext()</a>, <a class="el" href="channel_8c-source.html#l03138">ast_transfer()</a>, <a class="el" href="channel_8c-source.html#l01987">ast_waitfordigit_full()</a>, <a class="el" href="channel_8c-source.html#l02660">ast_write()</a>, <a class="el" href="res__features_8c-source.html#l02716">bridge_exec()</a>, <a class="el" href="rtp_8c-source.html#l02909">bridge_native_loop()</a>, <a class="el" href="rtp_8c-source.html#l03195">bridge_p2p_loop()</a>, <a class="el" href="res__features_8c-source.html#l00776">builtin_atxfer()</a>, <a class="el" href="app__chanspy_8c-source.html#l00266">channel_spy()</a>, <a class="el" href="app__chanspy_8c-source.html#l00465">common_exec()</a>, <a class="el" href="res__agi_8c-source.html#l00507">handle_sendimage()</a>, <a class="el" href="chan__iax2_8c-source.html#l03198">iax2_bridge()</a>, <a class="el" href="pbx_8c-source.html#l00509">pbx_exec()</a>, <a class="el" href="app__rpt_8c-source.html#l05604">rpt()</a>, <a class="el" href="app__rpt_8c-source.html#l06759">rpt_exec()</a>, <a class="el" href="app__dial_8c-source.html#l00532">wait_for_answer()</a>, <a class="el" href="chan__zap_8c-source.html#l12829">zt_sendtext()</a>, and <a class="el" href="chan__zap_8c-source.html#l03075">zt_setoption()</a>.<div class="fragment"><pre class="fragment"><a name="l00326"></a>00326 {
<a name="l00327"></a>00327    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a>)     <span class="comment">/* yes if soft hangup flag set */</span>
<a name="l00328"></a>00328       <span class="keywordflow">return</span> 1;
<a name="l00329"></a>00329    <span class="keywordflow">if</span> (!chan-&gt;<a class="code" href="structast__channel.html#25ab83fd9a6fe57f4133e359f88bb9d1">tech_pvt</a>)    <span class="comment">/* yes if no technology private data */</span>
<a name="l00330"></a>00330       <span class="keywordflow">return</span> 1;
<a name="l00331"></a>00331    <span class="keywordflow">if</span> (!chan-&gt;<a class="code" href="structast__channel.html#1272db9c0584f07eb3c6bae4e21fc7c8">whentohangup</a>)   <span class="comment">/* no if no hangup scheduled */</span>
<a name="l00332"></a>00332       <span class="keywordflow">return</span> 0;
<a name="l00333"></a>00333    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#1272db9c0584f07eb3c6bae4e21fc7c8">whentohangup</a> &gt; time(NULL))   <span class="comment">/* no if hangup time has not come yet. */</span>
<a name="l00334"></a>00334       <span class="keywordflow">return</span> 0;
<a name="l00335"></a>00335    chan-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> |= <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a12709ffb7179ec4c9b3ba505519ddc84e">AST_SOFTHANGUP_TIMEOUT</a>; <span class="comment">/* record event */</span>
<a name="l00336"></a>00336    <span class="keywordflow">return</span> 1;
<a name="l00337"></a>00337 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="e4e0e5c1767576b38fb1a893dfd8cb2b"></a><!-- doxytag: member="channel.h::ast_deactivate_generator" ref="e4e0e5c1767576b38fb1a893dfd8cb2b" args="(struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_deactivate_generator           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chan</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Deactivate an active generator 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l01729">1729</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="utils_8h-source.html#l00081">ast_clear_flag</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730015fb5a488ff560040b677433b270fb5e">AST_FLAG_WRITE_INT</a>, <a class="el" href="channel_8h-source.html#l00168">AST_GENERATOR_FD</a>, <a class="el" href="channel_8c-source.html#l01968">ast_settimeout()</a>, <a class="el" href="channel_8h-source.html#l00400">ast_channel::fds</a>, <a class="el" href="channel_8h-source.html#l00404">ast_channel::generator</a>, <a class="el" href="channel_8h-source.html#l00403">ast_channel::generatordata</a>, and <a class="el" href="structast__generator.html#62e15df14a257d6ac9725e39389d5b5a">ast_generator::release</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02060">__ast_read()</a>, <a class="el" href="app__externalivr_8c-source.html#l00244">app_exec()</a>, <a class="el" href="channel_8c-source.html#l04678">ast_channel_stop_silence_generator()</a>, <a class="el" href="file_8c-source.html#l00529">ast_openstream_full()</a>, <a class="el" href="indications_8c-source.html#l00333">ast_playtones_stop()</a>, <a class="el" href="chan__sip_8c-source.html#l13662">ast_quiet_chan()</a>, <a class="el" href="channel_8c-source.html#l04356">ast_tonepair_stop()</a>, <a class="el" href="channel_8c-source.html#l02660">ast_write()</a>, <a class="el" href="app__chanspy_8c-source.html#l00266">channel_spy()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="channel_8c-source.html#l01744">generator_force()</a>, <a class="el" href="res__musiconhold_8c-source.html#l00993">local_ast_moh_stop()</a>, <a class="el" href="app__milliwatt_8c-source.html#l00113">milliwatt_exec()</a>, <a class="el" href="res__musiconhold_8c-source.html#l01127">moh_on_off()</a>, and <a class="el" href="app__dial_8c-source.html#l00532">wait_for_answer()</a>.<div class="fragment"><pre class="fragment"><a name="l01730"></a>01730 {
<a name="l01731"></a>01731    <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l01732"></a>01732    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#68e80cee708fd0cdfb20807a8663721d">generatordata</a>) {
<a name="l01733"></a>01733       <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#dac9630aec642a428cd73f4be0a03569">generator</a> &amp;&amp; chan-&gt;<a class="code" href="structast__channel.html#dac9630aec642a428cd73f4be0a03569">generator</a>-&gt;<a class="code" href="structast__generator.html#62e15df14a257d6ac9725e39389d5b5a">release</a>)
<a name="l01734"></a>01734          chan-&gt;<a class="code" href="structast__channel.html#dac9630aec642a428cd73f4be0a03569">generator</a>-&gt;<a class="code" href="structast__generator.html#62e15df14a257d6ac9725e39389d5b5a">release</a>(chan, chan-&gt;<a class="code" href="structast__channel.html#68e80cee708fd0cdfb20807a8663721d">generatordata</a>);
<a name="l01735"></a>01735       chan-&gt;<a class="code" href="structast__channel.html#68e80cee708fd0cdfb20807a8663721d">generatordata</a> = NULL;
<a name="l01736"></a>01736       chan-&gt;<a class="code" href="structast__channel.html#dac9630aec642a428cd73f4be0a03569">generator</a> = NULL;
<a name="l01737"></a>01737       chan-&gt;<a class="code" href="structast__channel.html#33e8e7d77d33bb6375690c9b23527f82">fds</a>[<a class="code" href="channel_8h.html#eba2b7656ee8c07b3f916e990b567b02">AST_GENERATOR_FD</a>] = -1;
<a name="l01738"></a>01738       <a class="code" href="utils_8h.html#c2399a33be6ffb658bcf7c6a35531732">ast_clear_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730015fb5a488ff560040b677433b270fb5e">AST_FLAG_WRITE_INT</a>);
<a name="l01739"></a>01739       <a class="code" href="channel_8c.html#031ef8a01f979ba2f40451d97a515e80">ast_settimeout</a>(chan, 0, NULL, NULL);
<a name="l01740"></a>01740    }
<a name="l01741"></a>01741    <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l01742"></a>01742 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1f4ea7c056969bf5b3f718be85b5f703"></a><!-- doxytag: member="channel.h::ast_do_masquerade" ref="1f4ea7c056969bf5b3f718be85b5f703" args="(struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_do_masquerade           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>original</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Start masquerading a channel XXX This is a seriously whacked out operation. We're essentially putting the guts of the clone channel into the original channel. Start by killing off the original channel's backend. I'm not sure we're going to keep this function, because while the features are nice, the cost is very high in terms of pure nastiness. XXX. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>Assumes channel will be locked when called </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l03406">3406</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00414">ast_channel::_softhangup</a>, <a class="el" href="channel_8h-source.html#l00435">ast_channel::_state</a>, <a class="el" href="channel_8h-source.html#l00452">ast_channel::adsicpe</a>, <a class="el" href="channel_8h-source.html#l00474">ast_channel::alertpipe</a>, <a class="el" href="app_8c-source.html#l00897">ast_app_group_update()</a>, <a class="el" href="channel_8c-source.html#l00496">ast_cause2str()</a>, <a class="el" href="channel_8c-source.html#l01069">ast_channel_free()</a>, <a class="el" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="channel_8c-source.html#l04909">ast_channel_whisper_stop()</a>, <a class="el" href="utils_8h-source.html#l00081">ast_clear_flag</a>, <a class="el" href="utils_8h-source.html#l00088">ast_copy_flags</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300e16a5c3eb4b46399b147040658306ff5">AST_FLAG_EXCEPTION</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730059fb89e0dc785928def8b9daa1a2d316">AST_FLAG_WHISPER</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>, <a class="el" href="channel_8h-source.html#l00168">AST_GENERATOR_FD</a>, <a class="el" href="linkedlists_8h-source.html#l00385">AST_LIST_FIRST</a>, <a class="el" href="linkedlists_8h-source.html#l00620">AST_LIST_HEAD_INIT_NOLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00352">AST_LIST_HEAD_SET_NOLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00670">AST_LIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="channel_8h-source.html#l00160">AST_MAX_FDS</a>, <a class="el" href="lock_8h-source.html#l00530">ast_mutex_lock()</a>, <a class="el" href="lock_8h-source.html#l00520">ast_mutex_unlock()</a>, <a class="el" href="frame_8c-source.html#l00142">ast_null_frame</a>, <a class="el" href="channel_8c-source.html#l00795">ast_queue_frame()</a>, <a class="el" href="utils_8h-source.html#l00074">ast_set_flag</a>, <a class="el" href="channel_8c-source.html#l02920">ast_set_read_format()</a>, <a class="el" href="channel_8c-source.html#l02926">ast_set_write_format()</a>, <a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1cbe3f9a2385d6a31eac6abced2a9f17d">AST_SOFTHANGUP_DEV</a>, <a class="el" href="channel_8c-source.html#l00523">ast_state2str()</a>, <a class="el" href="stringfields_8h-source.html#l00275">ast_string_field_set</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="channel_8h-source.html#l00166">AST_TIMING_FD</a>, <a class="el" href="channel_8h-source.html#l00417">ast_channel::blocker</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, <a class="el" href="chanspy_8h-source.html#l00061">ast_channel_spy::chan</a>, <a class="el" href="channel_8h-source.html#l00437">ast_channel::cid</a>, <a class="el" href="channel_8c-source.html#l03393">clone_variables()</a>, <a class="el" href="manager_8h-source.html#l00052">EVENT_FLAG_CALL</a>, <a class="el" href="channel_8h-source.html#l00423">ast_channel::fdno</a>, <a class="el" href="channel_8h-source.html#l00400">ast_channel::fds</a>, <a class="el" href="structast__channel__tech.html#b40e56e9e5c13638ad74ddab4b82747c">ast_channel_tech::fixup</a>, <a class="el" href="channel_8c-source.html#l01585">free_translation()</a>, <a class="el" href="structast__channel__tech.html#453321d0ff441f44936f3ce5e7c059d6">ast_channel_tech::hangup</a>, <a class="el" href="channel_8h-source.html#l00466">ast_channel::hangupcause</a>, <a class="el" href="chan__alsa_8c-source.html#l00125">language</a>, <a class="el" href="chanspy_8h-source.html#l00059">ast_channel_spy::lock</a>, <a class="el" href="channel_8h-source.html#l00418">ast_channel::lock</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="manager_8h-source.html#l00163">manager_event</a>, <a class="el" href="channel_8h-source.html#l00410">ast_channel::masq</a>, <a class="el" href="channel_8h-source.html#l00411">ast_channel::masqr</a>, <a class="el" href="channel_8h-source.html#l00457">ast_channel::monitor</a>, <a class="el" href="chan__mgcp_8c-source.html#l00157">musicclass</a>, <a class="el" href="callerid_8c-source.html#l01043">name</a>, <a class="el" href="channel_8h-source.html#l00476">ast_channel::nativeformats</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="channel_8h-source.html#l00481">ast_channel::rawreadformat</a>, <a class="el" href="channel_8h-source.html#l00482">ast_channel::rawwriteformat</a>, <a class="el" href="channel_8h-source.html#l00477">ast_channel::readformat</a>, <a class="el" href="channel_8h-source.html#l00484">ast_channel::spies</a>, <a class="el" href="channel_8h-source.html#l00385">ast_channel::tech</a>, <a class="el" href="channel_8h-source.html#l00388">ast_channel::tech_pvt</a>, <a class="el" href="channel_8h-source.html#l00431">ast_channel::timingfd</a>, <a class="el" href="channel_8h-source.html#l00235">ast_channel_tech::type</a>, <a class="el" href="channel_8h-source.html#l00467">ast_channel::varshead</a>, <a class="el" href="channel_8h-source.html#l00485">ast_channel::whisper</a>, and <a class="el" href="channel_8h-source.html#l00478">ast_channel::writeformat</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02060">__ast_read()</a>, <a class="el" href="pbx_8c-source.html#l04595">ast_async_goto()</a>, <a class="el" href="channel_8c-source.html#l01598">ast_hangup()</a>, <a class="el" href="channel_8c-source.html#l01800">ast_waitfor_nandfds()</a>, <a class="el" href="channel_8c-source.html#l02660">ast_write()</a>, <a class="el" href="res__features_8c-source.html#l02147">do_bridge_masquerade()</a>, <a class="el" href="chan__iax2_8c-source.html#l06306">iax_park()</a>, <a class="el" href="chan__sip_8c-source.html#l13574">sip_park()</a>, and <a class="el" href="chan__sip_8c-source.html#l13507">sip_park_thread()</a>.<div class="fragment"><pre class="fragment"><a name="l03407"></a>03407 {
<a name="l03408"></a>03408    <span class="keywordtype">int</span> x,i;
<a name="l03409"></a>03409    <span class="keywordtype">int</span> res=0;
<a name="l03410"></a>03410    <span class="keywordtype">int</span> origstate;
<a name="l03411"></a>03411    <span class="keyword">struct </span><a class="code" href="structast__frame.html">ast_frame</a> *cur;
<a name="l03412"></a>03412    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structast__channel__tech.html">ast_channel_tech</a> *t;
<a name="l03413"></a>03413    <span class="keywordtype">void</span> *t_pvt;
<a name="l03414"></a>03414    <span class="keyword">struct </span><a class="code" href="structast__callerid.html">ast_callerid</a> tmpcid;
<a name="l03415"></a>03415    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *clone = original-&gt;<a class="code" href="structast__channel.html#f980faa30a783f7d18ceb4783afc1c69">masq</a>;
<a name="l03416"></a>03416    <span class="keyword">struct </span><a class="code" href="structast__channel__spy__list.html">ast_channel_spy_list</a> *spy_list = NULL;
<a name="l03417"></a>03417    <span class="keyword">struct </span><a class="code" href="structast__channel__spy.html">ast_channel_spy</a> *spy = NULL;
<a name="l03418"></a>03418    <span class="keyword">struct </span><a class="code" href="structast__cdr.html">ast_cdr</a> *cdr;
<a name="l03419"></a>03419    <span class="keywordtype">int</span> rformat = original-&gt;<a class="code" href="structast__channel.html#c9d2702466074da94d21f26822247ed8">readformat</a>;
<a name="l03420"></a>03420    <span class="keywordtype">int</span> wformat = original-&gt;<a class="code" href="structast__channel.html#45a38ca474a4f1df88fe13d68bbb0b44">writeformat</a>;
<a name="l03421"></a>03421    <span class="keywordtype">char</span> newn[100];
<a name="l03422"></a>03422    <span class="keywordtype">char</span> orig[100];
<a name="l03423"></a>03423    <span class="keywordtype">char</span> masqn[100];
<a name="l03424"></a>03424    <span class="keywordtype">char</span> zombn[100];
<a name="l03425"></a>03425 
<a name="l03426"></a>03426    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a> &gt; 3)
<a name="l03427"></a>03427       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Actually Masquerading %s(%d) into the structure of %s(%d)\n"</span>,
<a name="l03428"></a>03428          clone-&gt;name, clone-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a>, original-&gt;name, original-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a>);
<a name="l03429"></a>03429 
<a name="l03430"></a>03430    <a class="code" href="manager_8h.html#17a8c809d5b2d04cbb8969a209134c2b">manager_event</a>(<a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <span class="stringliteral">"Masquerade"</span>, <span class="stringliteral">"Clone: %s\r\nCloneState: %s\r\nOriginal: %s\r\nOriginalState: %s\r\n"</span>,
<a name="l03431"></a>03431             clone-&gt;name, <a class="code" href="channel_8c.html#1c242fd13329f5600ccd56263aba7272">ast_state2str</a>(clone-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a>), original-&gt;name, <a class="code" href="channel_8c.html#1c242fd13329f5600ccd56263aba7272">ast_state2str</a>(original-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a>));
<a name="l03432"></a>03432 
<a name="l03433"></a>03433    <span class="comment">/* XXX This is a seriously wacked out operation.  We're essentially putting the guts of</span>
<a name="l03434"></a>03434 <span class="comment">      the clone channel into the original channel.  Start by killing off the original</span>
<a name="l03435"></a>03435 <span class="comment">      channel's backend.   I'm not sure we're going to keep this function, because</span>
<a name="l03436"></a>03436 <span class="comment">      while the features are nice, the cost is very high in terms of pure nastiness. XXX */</span>
<a name="l03437"></a>03437 
<a name="l03438"></a>03438    <span class="comment">/* We need the clone's lock, too */</span>
<a name="l03439"></a>03439    <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(clone);
<a name="l03440"></a>03440 
<a name="l03441"></a>03441    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a> &gt; 1)
<a name="l03442"></a>03442       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Got clone lock for masquerade on '%s' at %p\n"</span>, clone-&gt;name, &amp;clone-&gt;<a class="code" href="structast__channel.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l03443"></a>03443 
<a name="l03444"></a>03444    <span class="comment">/* Having remembered the original read/write formats, we turn off any translation on either</span>
<a name="l03445"></a>03445 <span class="comment">      one */</span>
<a name="l03446"></a>03446    <a class="code" href="channel_8c.html#58f25e1132c752853fc0e73a67964c37">free_translation</a>(clone);
<a name="l03447"></a>03447    <a class="code" href="channel_8c.html#58f25e1132c752853fc0e73a67964c37">free_translation</a>(original);
<a name="l03448"></a>03448 
<a name="l03449"></a>03449 
<a name="l03450"></a>03450    <span class="comment">/* Unlink the masquerade */</span>
<a name="l03451"></a>03451    original-&gt;<a class="code" href="structast__channel.html#f980faa30a783f7d18ceb4783afc1c69">masq</a> = NULL;
<a name="l03452"></a>03452    clone-&gt;<a class="code" href="structast__channel.html#407a336ed0d13fc2cea1c71a81ad05df">masqr</a> = NULL;
<a name="l03453"></a>03453    
<a name="l03454"></a>03454    <span class="comment">/* Save the original name */</span>
<a name="l03455"></a>03455    ast_copy_string(orig, original-&gt;name, <span class="keyword">sizeof</span>(orig));
<a name="l03456"></a>03456    <span class="comment">/* Save the new name */</span>
<a name="l03457"></a>03457    ast_copy_string(newn, clone-&gt;name, <span class="keyword">sizeof</span>(newn));
<a name="l03458"></a>03458    <span class="comment">/* Create the masq name */</span>
<a name="l03459"></a>03459    snprintf(masqn, <span class="keyword">sizeof</span>(masqn), <span class="stringliteral">"%s&lt;MASQ&gt;"</span>, newn);
<a name="l03460"></a>03460       
<a name="l03461"></a>03461    <span class="comment">/* Copy the name from the clone channel */</span>
<a name="l03462"></a>03462    <a class="code" href="stringfields_8h.html#af456e04e9e17dd8a300d1d3cd75b65a">ast_string_field_set</a>(original, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, newn);
<a name="l03463"></a>03463 
<a name="l03464"></a>03464    <span class="comment">/* Mangle the name of the clone channel */</span>
<a name="l03465"></a>03465    <a class="code" href="stringfields_8h.html#af456e04e9e17dd8a300d1d3cd75b65a">ast_string_field_set</a>(clone, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, masqn);
<a name="l03466"></a>03466    
<a name="l03467"></a>03467    <span class="comment">/* Notify any managers of the change, first the masq then the other */</span>
<a name="l03468"></a>03468    <a class="code" href="manager_8h.html#17a8c809d5b2d04cbb8969a209134c2b">manager_event</a>(<a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <span class="stringliteral">"Rename"</span>, <span class="stringliteral">"Oldname: %s\r\nNewname: %s\r\nUniqueid: %s\r\n"</span>, newn, masqn, clone-&gt;uniqueid);
<a name="l03469"></a>03469    <a class="code" href="manager_8h.html#17a8c809d5b2d04cbb8969a209134c2b">manager_event</a>(<a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <span class="stringliteral">"Rename"</span>, <span class="stringliteral">"Oldname: %s\r\nNewname: %s\r\nUniqueid: %s\r\n"</span>, orig, newn, original-&gt;uniqueid);
<a name="l03470"></a>03470 
<a name="l03471"></a>03471    <span class="comment">/* Swap the technologies */</span>   
<a name="l03472"></a>03472    t = original-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>;
<a name="l03473"></a>03473    original-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a> = clone-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>;
<a name="l03474"></a>03474    clone-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a> = t;
<a name="l03475"></a>03475 
<a name="l03476"></a>03476    <span class="comment">/* Swap the cdrs */</span>
<a name="l03477"></a>03477    cdr = original-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>;
<a name="l03478"></a>03478    original-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a> = clone-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>;
<a name="l03479"></a>03479    clone-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a> = cdr;
<a name="l03480"></a>03480 
<a name="l03481"></a>03481    t_pvt = original-&gt;<a class="code" href="structast__channel.html#25ab83fd9a6fe57f4133e359f88bb9d1">tech_pvt</a>;
<a name="l03482"></a>03482    original-&gt;<a class="code" href="structast__channel.html#25ab83fd9a6fe57f4133e359f88bb9d1">tech_pvt</a> = clone-&gt;<a class="code" href="structast__channel.html#25ab83fd9a6fe57f4133e359f88bb9d1">tech_pvt</a>;
<a name="l03483"></a>03483    clone-&gt;<a class="code" href="structast__channel.html#25ab83fd9a6fe57f4133e359f88bb9d1">tech_pvt</a> = t_pvt;
<a name="l03484"></a>03484 
<a name="l03485"></a>03485    <span class="comment">/* Swap the readq's */</span>
<a name="l03486"></a>03486    cur = <a class="code" href="linkedlists_8h.html#e4deb7f32ef480cbc3b2e9b7e4ceff6c">AST_LIST_FIRST</a>(&amp;original-&gt;readq);
<a name="l03487"></a>03487    <a class="code" href="linkedlists_8h.html#96c2ff3700d9bb6033bdf522c7984566">AST_LIST_HEAD_SET_NOLOCK</a>(&amp;original-&gt;readq, <a class="code" href="linkedlists_8h.html#e4deb7f32ef480cbc3b2e9b7e4ceff6c">AST_LIST_FIRST</a>(&amp;clone-&gt;readq));
<a name="l03488"></a>03488    <a class="code" href="linkedlists_8h.html#96c2ff3700d9bb6033bdf522c7984566">AST_LIST_HEAD_SET_NOLOCK</a>(&amp;clone-&gt;readq, cur);
<a name="l03489"></a>03489 
<a name="l03490"></a>03490    <span class="comment">/* Swap the alertpipes */</span>
<a name="l03491"></a>03491    <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++) {
<a name="l03492"></a>03492       x = original-&gt;<a class="code" href="structast__channel.html#edfa4b7986a2ee7cd0db044fa4f67e8e">alertpipe</a>[i];
<a name="l03493"></a>03493       original-&gt;<a class="code" href="structast__channel.html#edfa4b7986a2ee7cd0db044fa4f67e8e">alertpipe</a>[i] = clone-&gt;<a class="code" href="structast__channel.html#edfa4b7986a2ee7cd0db044fa4f67e8e">alertpipe</a>[i];
<a name="l03494"></a>03494       clone-&gt;<a class="code" href="structast__channel.html#edfa4b7986a2ee7cd0db044fa4f67e8e">alertpipe</a>[i] = x;
<a name="l03495"></a>03495    }
<a name="l03496"></a>03496 
<a name="l03497"></a>03497    <span class="comment">/* Swap the raw formats */</span>
<a name="l03498"></a>03498    x = original-&gt;<a class="code" href="structast__channel.html#48a7f76581d0241312dff0e2a647a9a1">rawreadformat</a>;
<a name="l03499"></a>03499    original-&gt;<a class="code" href="structast__channel.html#48a7f76581d0241312dff0e2a647a9a1">rawreadformat</a> = clone-&gt;<a class="code" href="structast__channel.html#48a7f76581d0241312dff0e2a647a9a1">rawreadformat</a>;
<a name="l03500"></a>03500    clone-&gt;<a class="code" href="structast__channel.html#48a7f76581d0241312dff0e2a647a9a1">rawreadformat</a> = x;
<a name="l03501"></a>03501    x = original-&gt;<a class="code" href="structast__channel.html#331ec3b1c98b3ffed254938780cac119">rawwriteformat</a>;
<a name="l03502"></a>03502    original-&gt;<a class="code" href="structast__channel.html#331ec3b1c98b3ffed254938780cac119">rawwriteformat</a> = clone-&gt;<a class="code" href="structast__channel.html#331ec3b1c98b3ffed254938780cac119">rawwriteformat</a>;
<a name="l03503"></a>03503    clone-&gt;<a class="code" href="structast__channel.html#331ec3b1c98b3ffed254938780cac119">rawwriteformat</a> = x;
<a name="l03504"></a>03504 
<a name="l03505"></a>03505    <span class="comment">/* Swap the spies */</span>
<a name="l03506"></a>03506    spy_list = original-&gt;<a class="code" href="structast__channel.html#5e6a55de0bea527db5f05883c77f39a6">spies</a>;
<a name="l03507"></a>03507    original-&gt;<a class="code" href="structast__channel.html#5e6a55de0bea527db5f05883c77f39a6">spies</a> = clone-&gt;<a class="code" href="structast__channel.html#5e6a55de0bea527db5f05883c77f39a6">spies</a>;
<a name="l03508"></a>03508    clone-&gt;<a class="code" href="structast__channel.html#5e6a55de0bea527db5f05883c77f39a6">spies</a> = spy_list;
<a name="l03509"></a>03509 
<a name="l03510"></a>03510    <span class="comment">/* Update channel on respective spy lists if present */</span>
<a name="l03511"></a>03511    <span class="keywordflow">if</span> (original-&gt;<a class="code" href="structast__channel.html#5e6a55de0bea527db5f05883c77f39a6">spies</a>) {
<a name="l03512"></a>03512       <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;original-&gt;<a class="code" href="structast__channel.html#5e6a55de0bea527db5f05883c77f39a6">spies</a>-&gt;list, spy, list) {
<a name="l03513"></a>03513          <a class="code" href="lock_8h.html#b3c5e3093b325167f88db93c8b4b2421">ast_mutex_lock</a>(&amp;spy-&gt;<a class="code" href="structast__channel__spy.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l03514"></a>03514          spy-&gt;<a class="code" href="structast__channel__spy.html#26c322652770620e64ac90682eb6504c">chan</a> = original;
<a name="l03515"></a>03515          <a class="code" href="lock_8h.html#1d33e3caf152f0901c5ebdb69c2d4d26">ast_mutex_unlock</a>(&amp;spy-&gt;<a class="code" href="structast__channel__spy.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l03516"></a>03516       }
<a name="l03517"></a>03517    }
<a name="l03518"></a>03518    <span class="keywordflow">if</span> (clone-&gt;<a class="code" href="structast__channel.html#5e6a55de0bea527db5f05883c77f39a6">spies</a>) {
<a name="l03519"></a>03519       <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;clone-&gt;<a class="code" href="structast__channel.html#5e6a55de0bea527db5f05883c77f39a6">spies</a>-&gt;list, spy, list) {
<a name="l03520"></a>03520          <a class="code" href="lock_8h.html#b3c5e3093b325167f88db93c8b4b2421">ast_mutex_lock</a>(&amp;spy-&gt;<a class="code" href="structast__channel__spy.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l03521"></a>03521          spy-&gt;<a class="code" href="structast__channel__spy.html#26c322652770620e64ac90682eb6504c">chan</a> = clone;
<a name="l03522"></a>03522          <a class="code" href="lock_8h.html#1d33e3caf152f0901c5ebdb69c2d4d26">ast_mutex_unlock</a>(&amp;spy-&gt;<a class="code" href="structast__channel__spy.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l03523"></a>03523       }
<a name="l03524"></a>03524    }
<a name="l03525"></a>03525 
<a name="l03526"></a>03526    <span class="comment">/* Save any pending frames on both sides.  Start by counting</span>
<a name="l03527"></a>03527 <span class="comment">    * how many we're going to need... */</span>
<a name="l03528"></a>03528    x = 0;
<a name="l03529"></a>03529    <span class="keywordflow">if</span> (original-&gt;<a class="code" href="structast__channel.html#edfa4b7986a2ee7cd0db044fa4f67e8e">alertpipe</a>[1] &gt; -1) {
<a name="l03530"></a>03530       <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;clone-&gt;readq, cur, frame_list)
<a name="l03531"></a>03531          x++;
<a name="l03532"></a>03532    }
<a name="l03533"></a>03533 
<a name="l03534"></a>03534    <span class="comment">/* If we had any, prepend them to the ones already in the queue, and </span>
<a name="l03535"></a>03535 <span class="comment">    * load up the alertpipe */</span>
<a name="l03536"></a>03536    if (<a class="code" href="linkedlists_8h.html#e4deb7f32ef480cbc3b2e9b7e4ceff6c">AST_LIST_FIRST</a>(&amp;clone-&gt;readq)) {
<a name="l03537"></a>03537       <a class="code" href="linkedlists_8h.html#8de6ce8a3b9d59e7e7fddee6b62b32a7">AST_LIST_INSERT_TAIL</a>(&amp;clone-&gt;readq, <a class="code" href="linkedlists_8h.html#e4deb7f32ef480cbc3b2e9b7e4ceff6c">AST_LIST_FIRST</a>(&amp;original-&gt;readq), frame_list);
<a name="l03538"></a>03538       <a class="code" href="linkedlists_8h.html#96c2ff3700d9bb6033bdf522c7984566">AST_LIST_HEAD_SET_NOLOCK</a>(&amp;original-&gt;readq, <a class="code" href="linkedlists_8h.html#e4deb7f32ef480cbc3b2e9b7e4ceff6c">AST_LIST_FIRST</a>(&amp;clone-&gt;readq));
<a name="l03539"></a>03539       <a class="code" href="linkedlists_8h.html#96c2ff3700d9bb6033bdf522c7984566">AST_LIST_HEAD_SET_NOLOCK</a>(&amp;clone-&gt;readq, NULL);
<a name="l03540"></a>03540       <span class="keywordflow">for</span> (i = 0; i &lt; x; i++)
<a name="l03541"></a>03541          write(original-&gt;<a class="code" href="structast__channel.html#edfa4b7986a2ee7cd0db044fa4f67e8e">alertpipe</a>[1], &amp;x, <span class="keyword">sizeof</span>(x));
<a name="l03542"></a>03542    }
<a name="l03543"></a>03543    
<a name="l03544"></a>03544    clone-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> = <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1cbe3f9a2385d6a31eac6abced2a9f17d">AST_SOFTHANGUP_DEV</a>;
<a name="l03545"></a>03545 
<a name="l03546"></a>03546 
<a name="l03547"></a>03547    <span class="comment">/* And of course, so does our current state.  Note we need not</span>
<a name="l03548"></a>03548 <span class="comment">      call ast_setstate since the event manager doesn't really consider</span>
<a name="l03549"></a>03549 <span class="comment">      these separate.  We do this early so that the clone has the proper</span>
<a name="l03550"></a>03550 <span class="comment">      state of the original channel. */</span>
<a name="l03551"></a>03551    origstate = original-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a>;
<a name="l03552"></a>03552    original-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a> = clone-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a>;
<a name="l03553"></a>03553    clone-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a> = origstate;
<a name="l03554"></a>03554 
<a name="l03555"></a>03555    <span class="keywordflow">if</span> (clone-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#b40e56e9e5c13638ad74ddab4b82747c">fixup</a>){
<a name="l03556"></a>03556       res = clone-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#b40e56e9e5c13638ad74ddab4b82747c">fixup</a>(original, clone);
<a name="l03557"></a>03557       <span class="keywordflow">if</span> (res)
<a name="l03558"></a>03558          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Fixup failed on channel %s, strange things may happen.\n"</span>, clone-&gt;name);
<a name="l03559"></a>03559    }
<a name="l03560"></a>03560 
<a name="l03561"></a>03561    <span class="comment">/* Start by disconnecting the original's physical side */</span>
<a name="l03562"></a>03562    <span class="keywordflow">if</span> (clone-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#453321d0ff441f44936f3ce5e7c059d6">hangup</a>)
<a name="l03563"></a>03563       res = clone-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#453321d0ff441f44936f3ce5e7c059d6">hangup</a>(clone);
<a name="l03564"></a>03564    <span class="keywordflow">if</span> (res) {
<a name="l03565"></a>03565       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Hangup failed!  Strange things may happen!\n"</span>);
<a name="l03566"></a>03566       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(clone);
<a name="l03567"></a>03567       <span class="keywordflow">return</span> -1;
<a name="l03568"></a>03568    }
<a name="l03569"></a>03569    
<a name="l03570"></a>03570    snprintf(zombn, <span class="keyword">sizeof</span>(zombn), <span class="stringliteral">"%s&lt;ZOMBIE&gt;"</span>, orig);
<a name="l03571"></a>03571    <span class="comment">/* Mangle the name of the clone channel */</span>
<a name="l03572"></a>03572    <a class="code" href="stringfields_8h.html#af456e04e9e17dd8a300d1d3cd75b65a">ast_string_field_set</a>(clone, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, zombn);
<a name="l03573"></a>03573    <a class="code" href="manager_8h.html#17a8c809d5b2d04cbb8969a209134c2b">manager_event</a>(<a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <span class="stringliteral">"Rename"</span>, <span class="stringliteral">"Oldname: %s\r\nNewname: %s\r\nUniqueid: %s\r\n"</span>, masqn, zombn, clone-&gt;uniqueid);
<a name="l03574"></a>03574 
<a name="l03575"></a>03575    <span class="comment">/* Update the type. */</span>
<a name="l03576"></a>03576    t_pvt = original-&gt;<a class="code" href="structast__channel.html#08b5411f848a2581a41672a759c87380">monitor</a>;
<a name="l03577"></a>03577    original-&gt;<a class="code" href="structast__channel.html#08b5411f848a2581a41672a759c87380">monitor</a> = clone-&gt;<a class="code" href="structast__channel.html#08b5411f848a2581a41672a759c87380">monitor</a>;
<a name="l03578"></a>03578    clone-&gt;<a class="code" href="structast__channel.html#08b5411f848a2581a41672a759c87380">monitor</a> = t_pvt;
<a name="l03579"></a>03579    
<a name="l03580"></a>03580    <span class="comment">/* Keep the same language.  */</span>
<a name="l03581"></a>03581    <a class="code" href="stringfields_8h.html#af456e04e9e17dd8a300d1d3cd75b65a">ast_string_field_set</a>(original, <a class="code" href="chan__alsa_8c.html#8e5b6b627f81f1981fc6d241d6b3dd21">language</a>, clone-&gt;language);
<a name="l03582"></a>03582    <span class="comment">/* Copy the FD's other than the generator fd */</span>
<a name="l03583"></a>03583    <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="channel_8h.html#83204f17b88e7752d76b1a751a501a65">AST_MAX_FDS</a>; x++) {
<a name="l03584"></a>03584       <span class="keywordflow">if</span> (x != <a class="code" href="channel_8h.html#eba2b7656ee8c07b3f916e990b567b02">AST_GENERATOR_FD</a>)
<a name="l03585"></a>03585          original-&gt;<a class="code" href="structast__channel.html#33e8e7d77d33bb6375690c9b23527f82">fds</a>[x] = clone-&gt;<a class="code" href="structast__channel.html#33e8e7d77d33bb6375690c9b23527f82">fds</a>[x];
<a name="l03586"></a>03586    }
<a name="l03587"></a>03587 
<a name="l03588"></a>03588    <a class="code" href="app_8c.html#c94bb500018ff1d24a0e380554d74899">ast_app_group_update</a>(clone, original);
<a name="l03589"></a>03589 
<a name="l03590"></a>03590    <span class="comment">/* move any whisperer over */</span>
<a name="l03591"></a>03591    <a class="code" href="channel_8c.html#79598f580fc373516b4489bc5ebb7b02">ast_channel_whisper_stop</a>(original);
<a name="l03592"></a>03592    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(clone, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730059fb89e0dc785928def8b9daa1a2d316">AST_FLAG_WHISPER</a>)) {
<a name="l03593"></a>03593       original-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a> = clone-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>;
<a name="l03594"></a>03594       <a class="code" href="utils_8h.html#3208623241ff7b4c93907944487502a1">ast_set_flag</a>(original, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730059fb89e0dc785928def8b9daa1a2d316">AST_FLAG_WHISPER</a>);
<a name="l03595"></a>03595       clone-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a> = NULL;
<a name="l03596"></a>03596       <a class="code" href="utils_8h.html#c2399a33be6ffb658bcf7c6a35531732">ast_clear_flag</a>(clone, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730059fb89e0dc785928def8b9daa1a2d316">AST_FLAG_WHISPER</a>);
<a name="l03597"></a>03597    }
<a name="l03598"></a>03598 
<a name="l03599"></a>03599    <span class="comment">/* Move data stores over */</span>
<a name="l03600"></a>03600    <span class="keywordflow">if</span> (<a class="code" href="linkedlists_8h.html#e4deb7f32ef480cbc3b2e9b7e4ceff6c">AST_LIST_FIRST</a>(&amp;clone-&gt;datastores))
<a name="l03601"></a>03601                 <a class="code" href="linkedlists_8h.html#8de6ce8a3b9d59e7e7fddee6b62b32a7">AST_LIST_INSERT_TAIL</a>(&amp;original-&gt;datastores, <a class="code" href="linkedlists_8h.html#e4deb7f32ef480cbc3b2e9b7e4ceff6c">AST_LIST_FIRST</a>(&amp;clone-&gt;datastores), entry);
<a name="l03602"></a>03602    <a class="code" href="linkedlists_8h.html#0ae37ea56ca862f6504390fd49b9839f">AST_LIST_HEAD_INIT_NOLOCK</a>(&amp;clone-&gt;datastores);
<a name="l03603"></a>03603 
<a name="l03604"></a>03604    <a class="code" href="channel_8c.html#07c73c9b04242eaffbf7168469004920">clone_variables</a>(original, clone);
<a name="l03605"></a>03605    <a class="code" href="linkedlists_8h.html#0ae37ea56ca862f6504390fd49b9839f">AST_LIST_HEAD_INIT_NOLOCK</a>(&amp;clone-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>);
<a name="l03606"></a>03606    <span class="comment">/* Presense of ADSI capable CPE follows clone */</span>
<a name="l03607"></a>03607    original-&gt;<a class="code" href="structast__channel.html#89c64e070078b5f6dcd6e241d2eb986e">adsicpe</a> = clone-&gt;<a class="code" href="structast__channel.html#89c64e070078b5f6dcd6e241d2eb986e">adsicpe</a>;
<a name="l03608"></a>03608    <span class="comment">/* Bridge remains the same */</span>
<a name="l03609"></a>03609    <span class="comment">/* CDR fields remain the same */</span>
<a name="l03610"></a>03610    <span class="comment">/* XXX What about blocking, softhangup, blocker, and lock and blockproc? XXX */</span>
<a name="l03611"></a>03611    <span class="comment">/* Application and data remain the same */</span>
<a name="l03612"></a>03612    <span class="comment">/* Clone exception  becomes real one, as with fdno */</span>
<a name="l03613"></a>03613    <a class="code" href="utils_8h.html#7963ad5058a8544f02f00fc94199cbc3">ast_copy_flags</a>(original, clone, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300e16a5c3eb4b46399b147040658306ff5">AST_FLAG_EXCEPTION</a>);
<a name="l03614"></a>03614    original-&gt;<a class="code" href="structast__channel.html#105e7c128b4aa547fdb820f23269be2e">fdno</a> = clone-&gt;<a class="code" href="structast__channel.html#105e7c128b4aa547fdb820f23269be2e">fdno</a>;
<a name="l03615"></a>03615    <span class="comment">/* Schedule context remains the same */</span>
<a name="l03616"></a>03616    <span class="comment">/* Stream stuff stays the same */</span>
<a name="l03617"></a>03617    <span class="comment">/* Keep the original state.  The fixup code will need to work with it most likely */</span>
<a name="l03618"></a>03618 
<a name="l03619"></a>03619    <span class="comment">/* Just swap the whole structures, nevermind the allocations, they'll work themselves</span>
<a name="l03620"></a>03620 <span class="comment">      out. */</span>
<a name="l03621"></a>03621    tmpcid = original-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>;
<a name="l03622"></a>03622    original-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a> = clone-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>;
<a name="l03623"></a>03623    clone-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a> = tmpcid;
<a name="l03624"></a>03624    
<a name="l03625"></a>03625    <span class="comment">/* Restore original timing file descriptor */</span>
<a name="l03626"></a>03626    original-&gt;<a class="code" href="structast__channel.html#33e8e7d77d33bb6375690c9b23527f82">fds</a>[<a class="code" href="channel_8h.html#0db74b98fb7363645274b7b92a5741f2">AST_TIMING_FD</a>] = original-&gt;<a class="code" href="structast__channel.html#4cd06d1a010b6a371149b4a0adb2f884">timingfd</a>;
<a name="l03627"></a>03627    
<a name="l03628"></a>03628    <span class="comment">/* Our native formats are different now */</span>
<a name="l03629"></a>03629    original-&gt;<a class="code" href="structast__channel.html#adbc0bbfec600539582f92b30ed1ecd7">nativeformats</a> = clone-&gt;<a class="code" href="structast__channel.html#adbc0bbfec600539582f92b30ed1ecd7">nativeformats</a>;
<a name="l03630"></a>03630    
<a name="l03631"></a>03631    <span class="comment">/* Context, extension, priority, app data, jump table,  remain the same */</span>
<a name="l03632"></a>03632    <span class="comment">/* pvt switches.  pbx stays the same, as does next */</span>
<a name="l03633"></a>03633    
<a name="l03634"></a>03634    <span class="comment">/* Set the write format */</span>
<a name="l03635"></a>03635    <a class="code" href="channel_8c.html#ebcd70a10759c189c265a97b5a9f78c3">ast_set_write_format</a>(original, wformat);
<a name="l03636"></a>03636 
<a name="l03637"></a>03637    <span class="comment">/* Set the read format */</span>
<a name="l03638"></a>03638    <a class="code" href="channel_8c.html#8f102047453fca4cd6813696be1b9843">ast_set_read_format</a>(original, rformat);
<a name="l03639"></a>03639 
<a name="l03640"></a>03640    <span class="comment">/* Copy the music class */</span>
<a name="l03641"></a>03641    <a class="code" href="stringfields_8h.html#af456e04e9e17dd8a300d1d3cd75b65a">ast_string_field_set</a>(original, <a class="code" href="chan__mgcp_8c.html#80439b02fbec6ba43c0438ad4d67348d">musicclass</a>, clone-&gt;musicclass);
<a name="l03642"></a>03642 
<a name="l03643"></a>03643    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l03644"></a>03644       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Putting channel %s in %d/%d formats\n"</span>, original-&gt;name, wformat, rformat);
<a name="l03645"></a>03645 
<a name="l03646"></a>03646    <span class="comment">/* Okay.  Last thing is to let the channel driver know about all this mess, so he</span>
<a name="l03647"></a>03647 <span class="comment">      can fix up everything as best as possible */</span>
<a name="l03648"></a>03648    <span class="keywordflow">if</span> (original-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#b40e56e9e5c13638ad74ddab4b82747c">fixup</a>) {
<a name="l03649"></a>03649       res = original-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#b40e56e9e5c13638ad74ddab4b82747c">fixup</a>(clone, original);
<a name="l03650"></a>03650       <span class="keywordflow">if</span> (res) {
<a name="l03651"></a>03651          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Channel for type '%s' could not fixup channel %s\n"</span>,
<a name="l03652"></a>03652             original-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, original-&gt;name);
<a name="l03653"></a>03653          <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(clone);
<a name="l03654"></a>03654          <span class="keywordflow">return</span> -1;
<a name="l03655"></a>03655       }
<a name="l03656"></a>03656    } <span class="keywordflow">else</span>
<a name="l03657"></a>03657       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Channel type '%s' does not have a fixup routine (for %s)!  Bad things may happen.\n"</span>,
<a name="l03658"></a>03658          original-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, original-&gt;name);
<a name="l03659"></a>03659    
<a name="l03660"></a>03660    <span class="comment">/* Now, at this point, the "clone" channel is totally F'd up.  We mark it as</span>
<a name="l03661"></a>03661 <span class="comment">      a zombie so nothing tries to touch it.  If it's already been marked as a</span>
<a name="l03662"></a>03662 <span class="comment">      zombie, then free it now (since it already is considered invalid). */</span>
<a name="l03663"></a>03663    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(clone, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>)) {
<a name="l03664"></a>03664       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l03665"></a>03665          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Destroying channel clone '%s'\n"</span>, clone-&gt;name);
<a name="l03666"></a>03666       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(clone);
<a name="l03667"></a>03667       <a class="code" href="manager_8h.html#17a8c809d5b2d04cbb8969a209134c2b">manager_event</a>(<a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <span class="stringliteral">"Hangup"</span>,
<a name="l03668"></a>03668          <span class="stringliteral">"Channel: %s\r\n"</span>
<a name="l03669"></a>03669          <span class="stringliteral">"Uniqueid: %s\r\n"</span>
<a name="l03670"></a>03670          <span class="stringliteral">"Cause: %d\r\n"</span>
<a name="l03671"></a>03671          <span class="stringliteral">"Cause-txt: %s\r\n"</span>,
<a name="l03672"></a>03672          clone-&gt;name,
<a name="l03673"></a>03673          clone-&gt;uniqueid,
<a name="l03674"></a>03674          clone-&gt;<a class="code" href="structast__channel.html#8be5f831332d8ff714e90c2cf85171fe">hangupcause</a>,
<a name="l03675"></a>03675          <a class="code" href="channel_8c.html#817c0e10b26cbcb773516bb6583fb694">ast_cause2str</a>(clone-&gt;<a class="code" href="structast__channel.html#8be5f831332d8ff714e90c2cf85171fe">hangupcause</a>)
<a name="l03676"></a>03676          );
<a name="l03677"></a>03677       <a class="code" href="channel_8c.html#230a804b09060fecdf699c2c9613fff7">ast_channel_free</a>(clone);
<a name="l03678"></a>03678    } <span class="keywordflow">else</span> {
<a name="l03679"></a>03679       <span class="keywordflow">if</span> (option_debug)
<a name="l03680"></a>03680          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Released clone lock on '%s'\n"</span>, clone-&gt;name);
<a name="l03681"></a>03681       <a class="code" href="utils_8h.html#3208623241ff7b4c93907944487502a1">ast_set_flag</a>(clone, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>);
<a name="l03682"></a>03682       <a class="code" href="channel_8c.html#c02f134e64b4fc85c1efd80b8685b635">ast_queue_frame</a>(clone, &amp;<a class="code" href="frame_8c.html#8bfe1415e256ff41d93a3ce9396e815f">ast_null_frame</a>);
<a name="l03683"></a>03683       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(clone);
<a name="l03684"></a>03684    }
<a name="l03685"></a>03685    
<a name="l03686"></a>03686    <span class="comment">/* Signal any blocker */</span>
<a name="l03687"></a>03687    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(original, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>))
<a name="l03688"></a>03688       pthread_kill(original-&gt;<a class="code" href="structast__channel.html#a38ba46bb4909bc27602645297913d86">blocker</a>, SIGURG);
<a name="l03689"></a>03689    <span class="keywordflow">if</span> (option_debug)
<a name="l03690"></a>03690       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Done Masquerading %s (%d)\n"</span>, original-&gt;name, original-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a>);
<a name="l03691"></a>03691    <span class="keywordflow">return</span> 0;
<a name="l03692"></a>03692 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="5c4fc82db1ad1481b2bab0a7c393d53d"></a><!-- doxytag: member="channel.h::ast_fdisset" ref="5c4fc82db1ad1481b2bab0a7c393d53d" args="(struct pollfd *pfds, int fd, int max, int *start)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int ast_fdisset           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structpollfd.html">pollfd</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pfds</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>max</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>start</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [inline, static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Helper function for migrating select to poll. 
<p>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l01314">1314</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.
<p>
References <a class="el" href="poll-compat_8h-source.html#l00093">pollfd::revents</a>.
<p>
Referenced by <a class="el" href="chan__zap_8c-source.html#l07134">do_monitor()</a>.<div class="fragment"><pre class="fragment"><a name="l01315"></a>01315 {
<a name="l01316"></a>01316    <span class="keywordtype">int</span> x;
<a name="l01317"></a>01317    <span class="keywordtype">int</span> dummy=0;
<a name="l01318"></a>01318 
<a name="l01319"></a>01319    <span class="keywordflow">if</span> (fd &lt; 0)
<a name="l01320"></a>01320       <span class="keywordflow">return</span> 0;
<a name="l01321"></a>01321    <span class="keywordflow">if</span> (!<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a>)
<a name="l01322"></a>01322       <a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a> = &amp;dummy;
<a name="l01323"></a>01323    <span class="keywordflow">for</span> (x = *<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a>; x&lt;max; x++)
<a name="l01324"></a>01324       <span class="keywordflow">if</span> (pfds[x].fd == fd) {
<a name="l01325"></a>01325          <span class="keywordflow">if</span> (x == *<a class="code" href="structast__cdr.html#ea2b2676c28c0db26d39331a336c6b92">start</a>)
<a name="l01326"></a>01326             (*start)++;
<a name="l01327"></a>01327          <span class="keywordflow">return</span> pfds[x].<a class="code" href="structpollfd.html#7c6f5b9f008b99872b2aff44748410c8">revents</a>;
<a name="l01328"></a>01328       }
<a name="l01329"></a>01329    <span class="keywordflow">return</span> 0;
<a name="l01330"></a>01330 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="20c0f06f47ac708677674d6fe2007cc9"></a><!-- doxytag: member="channel.h::ast_get_channel_by_exten_locked" ref="20c0f06f47ac708677674d6fe2007cc9" args="(const char *exten, const char *context)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a>* ast_get_channel_by_exten_locked           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get channel by exten (and optionally context) and lock it. 
<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01014">1014</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l00928">channel_find_locked()</a>.<div class="fragment"><pre class="fragment"><a name="l01015"></a>01015 {
<a name="l01016"></a>01016    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#188578d17e5577beb5ec3575458d3f71">channel_find_locked</a>(NULL, NULL, 0, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>);
<a name="l01017"></a>01017 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="5bb2284c9cf122c444b25bbabaf3af97"></a><!-- doxytag: member="channel.h::ast_get_channel_by_name_locked" ref="5bb2284c9cf122c444b25bbabaf3af97" args="(const char *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a>* ast_get_channel_by_name_locked           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chan</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get channel by name (locks channel). 
<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l00995">995</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l00928">channel_find_locked()</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l01548">action_getvar()</a>, <a class="el" href="manager_8c-source.html#l01480">action_hangup()</a>, <a class="el" href="manager_8c-source.html#l01726">action_redirect()</a>, <a class="el" href="manager_8c-source.html#l01681">action_sendtext()</a>, <a class="el" href="manager_8c-source.html#l01506">action_setvar()</a>, <a class="el" href="manager_8c-source.html#l01587">action_status()</a>, <a class="el" href="manager_8c-source.html#l02116">action_timeout()</a>, <a class="el" href="pbx_8c-source.html#l04641">ast_async_goto_by_name()</a>, <a class="el" href="app__channelredirect_8c-source.html#l00052">asyncgoto_exec()</a>, <a class="el" href="res__monitor_8c-source.html#l00566">change_monitor_action()</a>, <a class="el" href="res__monitor_8c-source.html#l00606">do_pause_or_unpause()</a>, <a class="el" href="app__zapscan_8c-source.html#l00074">get_zap_channel_locked()</a>, <a class="el" href="res__agi_8c-source.html#l01155">handle_channelstatus()</a>, <a class="el" href="cli_8c-source.html#l00677">handle_core_set_debug_channel()</a>, <a class="el" href="res__agi_8c-source.html#l01210">handle_getvariablefull()</a>, <a class="el" href="res__agi_8c-source.html#l01084">handle_hangup()</a>, <a class="el" href="cli_8c-source.html#l00770">handle_showchan()</a>, <a class="el" href="cli_8c-source.html#l00588">handle_softhangup()</a>, <a class="el" href="res__features_8c-source.html#l02348">manager_park()</a>, <a class="el" href="app__senddtmf_8c-source.html#l00097">manager_play_dtmf()</a>, <a class="el" href="pbx_8c-source.html#l05901">pbx_builtin_importvar()</a>, <a class="el" href="res__monitor_8c-source.html#l00481">start_monitor_action()</a>, and <a class="el" href="res__monitor_8c-source.html#l00534">stop_monitor_action()</a>.<div class="fragment"><pre class="fragment"><a name="l00996"></a>00996 {
<a name="l00997"></a>00997    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#188578d17e5577beb5ec3575458d3f71">channel_find_locked</a>(NULL, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, 0, NULL, NULL);
<a name="l00998"></a>00998 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="73dcef78b8c7fc8cb85dde3ee0058c57"></a><!-- doxytag: member="channel.h::ast_get_channel_by_name_prefix_locked" ref="73dcef78b8c7fc8cb85dde3ee0058c57" args="(const char *name, const int namelen)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a>* ast_get_channel_by_name_prefix_locked           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const int&nbsp;</td>
          <td class="mdname" nowrap> <em>namelen</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get channel by name prefix (locks channel). 
<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01001">1001</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l00928">channel_find_locked()</a>.
<p>
Referenced by <a class="el" href="res__features_8c-source.html#l02163">action_bridge()</a>, <a class="el" href="devicestate_8c-source.html#l00250">ast_parse_device_state()</a>, <a class="el" href="res__features_8c-source.html#l02716">bridge_exec()</a>, <a class="el" href="app__chanspy_8c-source.html#l00465">common_exec()</a>, and <a class="el" href="app__mixmonitor_8c-source.html#l00399">mixmonitor_cli()</a>.<div class="fragment"><pre class="fragment"><a name="l01002"></a>01002 {
<a name="l01003"></a>01003    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#188578d17e5577beb5ec3575458d3f71">channel_find_locked</a>(NULL, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, namelen, NULL, NULL);
<a name="l01004"></a>01004 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3a695cf963066b80546be9da976d27c8"></a><!-- doxytag: member="channel.h::ast_get_channel_tech" ref="3a695cf963066b80546be9da976d27c8" args="(const char *name)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const struct <a class="el" href="structast__channel__tech.html">ast_channel_tech</a>* ast_get_channel_tech           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>name</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get a channel technology structure by name. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>name of technology to find </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>a pointer to the structure, or NULL if no matching technology found </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l00473">473</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00038">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00104">AST_LIST_UNLOCK</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="channel_8c-source.html#l00120">chanlist::tech</a>, and <a class="el" href="channel_8h-source.html#l00235">ast_channel_tech::type</a>.
<p>
Referenced by <a class="el" href="devicestate_8c-source.html#l00274">ast_device_state()</a>.<div class="fragment"><pre class="fragment"><a name="l00474"></a>00474 {
<a name="l00475"></a>00475    <span class="keyword">struct </span><a class="code" href="structchanlist.html">chanlist</a> *chanls;
<a name="l00476"></a>00476    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structast__channel__tech.html">ast_channel_tech</a> *ret = NULL;
<a name="l00477"></a>00477 
<a name="l00478"></a>00478    <span class="keywordflow">if</span> (<a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;channels)) {
<a name="l00479"></a>00479       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Unable to lock channel tech list\n"</span>);
<a name="l00480"></a>00480       <span class="keywordflow">return</span> NULL;
<a name="l00481"></a>00481    }
<a name="l00482"></a>00482 
<a name="l00483"></a>00483    <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;backends, chanls, list) {
<a name="l00484"></a>00484       <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, chanls-&gt;<a class="code" href="structchanlist.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>)) {
<a name="l00485"></a>00485          ret = chanls-&gt;<a class="code" href="structchanlist.html#d9f9133fb120cd6096870bc2b496805b">tech</a>;
<a name="l00486"></a>00486          <span class="keywordflow">break</span>;
<a name="l00487"></a>00487       }
<a name="l00488"></a>00488    }
<a name="l00489"></a>00489 
<a name="l00490"></a>00490    <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;channels);
<a name="l00491"></a>00491    
<a name="l00492"></a>00492    <span class="keywordflow">return</span> ret;
<a name="l00493"></a>00493 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3afd78a60ecfe19f643ed5124981a023"></a><!-- doxytag: member="channel.h::ast_get_group" ref="3afd78a60ecfe19f643ed5124981a023" args="(const char *s)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="channel_8h.html#f46fa02de8676dd1b9163c5dd428e610">ast_group_t</a> ast_get_group           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>s</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l04379">4379</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>, <a class="el" href="chan__agent_8c-source.html#l00143">group</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, and <a class="el" href="strcompat_8c-source.html#l00035">strsep()</a>.
<p>
Referenced by <a class="el" href="misdn__config_8c-source.html#l00844">_parse()</a>, <a class="el" href="res__astum_8c-source.html#l01424">aum_build_group()</a>, <a class="el" href="res__astum_8c-source.html#l01229">aum_build_user()</a>, <a class="el" href="chan__skinny_8c-source.html#l02102">build_device()</a>, <a class="el" href="chan__mgcp_8c-source.html#l03593">build_gateway()</a>, <a class="el" href="chan__sip_8c-source.html#l16894">build_peer()</a>, <a class="el" href="chan__sip_8c-source.html#l16717">build_user()</a>, <a class="el" href="chan__zap_8c-source.html#l11882">process_zap()</a>, and <a class="el" href="chan__agent_8c-source.html#l01004">read_agent_config()</a>.<div class="fragment"><pre class="fragment"><a name="l04380"></a>04380 {
<a name="l04381"></a>04381    <span class="keywordtype">char</span> *piece;
<a name="l04382"></a>04382    <span class="keywordtype">char</span> *c;
<a name="l04383"></a>04383    <span class="keywordtype">int</span> start=0, finish=0, x;
<a name="l04384"></a>04384    <a class="code" href="channel_8h.html#f46fa02de8676dd1b9163c5dd428e610">ast_group_t</a> <a class="code" href="chan__agent_8c.html#db0f6f37ebeb6ea09489124345af2a45">group</a> = 0;
<a name="l04385"></a>04385 
<a name="l04386"></a>04386    c = <a class="code" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>(<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>);
<a name="l04387"></a>04387    
<a name="l04388"></a>04388    <span class="keywordflow">while</span> ((piece = <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;c, <span class="stringliteral">","</span>))) {
<a name="l04389"></a>04389       <span class="keywordflow">if</span> (sscanf(piece, <span class="stringliteral">"%d-%d"</span>, &amp;start, &amp;finish) == 2) {
<a name="l04390"></a>04390          <span class="comment">/* Range */</span>
<a name="l04391"></a>04391       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sscanf(piece, <span class="stringliteral">"%d"</span>, &amp;start)) {
<a name="l04392"></a>04392          <span class="comment">/* Just one */</span>
<a name="l04393"></a>04393          finish = start;
<a name="l04394"></a>04394       } <span class="keywordflow">else</span> {
<a name="l04395"></a>04395          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Syntax error parsing group configuration '%s' at '%s'. Ignoring.\n"</span>, <a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>, piece);
<a name="l04396"></a>04396          <span class="keywordflow">continue</span>;
<a name="l04397"></a>04397       }
<a name="l04398"></a>04398       <span class="keywordflow">for</span> (x = start; x &lt;= finish; x++) {
<a name="l04399"></a>04399          <span class="keywordflow">if</span> ((x &gt; 63) || (x &lt; 0)) {
<a name="l04400"></a>04400             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Ignoring invalid group %d (maximum group is 63)\n"</span>, x);
<a name="l04401"></a>04401          } <span class="keywordflow">else</span>
<a name="l04402"></a>04402             group |= ((<a class="code" href="channel_8h.html#f46fa02de8676dd1b9163c5dd428e610">ast_group_t</a>) 1 &lt;&lt; x);
<a name="l04403"></a>04403       }
<a name="l04404"></a>04404    }
<a name="l04405"></a>04405    <span class="keywordflow">return</span> group;
<a name="l04406"></a>04406 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ff55e854df5692f9b3b8dc64c95a5619"></a><!-- doxytag: member="channel.h::ast_hangup" ref="ff55e854df5692f9b3b8dc64c95a5619" args="(struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_hangup           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chan</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Hang up a channel. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>This function performs a hard hangup on a channel. Unlike the soft-hangup, this function performs all stream stopping, etc, on the channel that needs to end. chan is no longer valid after this call. </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to hang up </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns 0 on success, -1 on failure. </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01598">1598</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l00496">ast_cause2str()</a>, <a class="el" href="cdr_8c-source.html#l01087">ast_cdr_detach()</a>, <a class="el" href="cdr_8c-source.html#l00788">ast_cdr_end()</a>, <a class="el" href="channel_8c-source.html#l01069">ast_channel_free()</a>, <a class="el" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="file_8c-source.html#l00701">ast_closestream()</a>, <a class="el" href="channel_8c-source.html#l03406">ast_do_masquerade()</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="utils_8h-source.html#l00074">ast_set_flag</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="channel_8h-source.html#l00417">ast_channel::blocker</a>, <a class="el" href="channel_8h-source.html#l00419">ast_channel::blockproc</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, <a class="el" href="channel_8h-source.html#l01384">CRASH</a>, <a class="el" href="channel_8c-source.html#l01425">detach_spies()</a>, <a class="el" href="manager_8h-source.html#l00052">EVENT_FLAG_CALL</a>, <a class="el" href="channel_8c-source.html#l01585">free_translation()</a>, <a class="el" href="channel_8h-source.html#l00404">ast_channel::generator</a>, <a class="el" href="channel_8h-source.html#l00403">ast_channel::generatordata</a>, <a class="el" href="structast__channel__tech.html#453321d0ff441f44936f3ce5e7c059d6">ast_channel_tech::hangup</a>, <a class="el" href="channel_8h-source.html#l00466">ast_channel::hangupcause</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="manager_8h-source.html#l00163">manager_event</a>, <a class="el" href="channel_8h-source.html#l00410">ast_channel::masq</a>, <a class="el" href="channel_8h-source.html#l00411">ast_channel::masqr</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="structast__generator.html#62e15df14a257d6ac9725e39389d5b5a">ast_generator::release</a>, <a class="el" href="channel_8h-source.html#l00424">ast_channel::sched</a>, <a class="el" href="sched_8c-source.html#l00088">sched_context_destroy()</a>, <a class="el" href="channel_8h-source.html#l00426">ast_channel::stream</a>, <a class="el" href="channel_8h-source.html#l00385">ast_channel::tech</a>, and <a class="el" href="channel_8h-source.html#l00428">ast_channel::vstream</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>, <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="chan__h323_8c-source.html#l01010">__oh323_new()</a>, <a class="el" href="res__features_8c-source.html#l02163">action_bridge()</a>, <a class="el" href="chan__agent_8c-source.html#l00717">agent_hangup()</a>, <a class="el" href="chan__agent_8c-source.html#l00427">agent_read()</a>, <a class="el" href="chan__alsa_8c-source.html#l00790">alsa_new()</a>, <a class="el" href="app__followme_8c-source.html#l00909">app_exec()</a>, <a class="el" href="pbx_8c-source.html#l04595">ast_async_goto()</a>, <a class="el" href="res__features_8c-source.html#l00231">ast_bridge_call_thread()</a>, <a class="el" href="dial_8c-source.html#l00686">ast_dial_destroy()</a>, <a class="el" href="dial_8c-source.html#l00664">ast_dial_hangup()</a>, <a class="el" href="chan__iax2_8c-source.html#l03426">ast_iax2_new()</a>, <a class="el" href="pbx_8c-source.html#l05150">ast_pbx_outgoing_app()</a>, <a class="el" href="pbx_8c-source.html#l04991">ast_pbx_outgoing_exten()</a>, <a class="el" href="pbx_8c-source.html#l05134">ast_pbx_run_app()</a>, <a class="el" href="pbx_8c-source.html#l04903">async_wait()</a>, <a class="el" href="dial_8c-source.html#l00236">begin_dial()</a>, <a class="el" href="res__features_8c-source.html#l02716">bridge_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l00732">build_conf()</a>, <a class="el" href="res__features_8c-source.html#l00776">builtin_atxfer()</a>, <a class="el" href="app__chanisavail_8c-source.html#l00069">chanavail_exec()</a>, <a class="el" href="res__features_8c-source.html#l00765">check_compat()</a>, <a class="el" href="res__features_8c-source.html#l00192">check_goto_on_transfer()</a>, <a class="el" href="app__followme_8c-source.html#l00428">clear_caller()</a>, <a class="el" href="app__meetme_8c-source.html#l01211">conf_free()</a>, <a class="el" href="app__meetme_8c-source.html#l01350">conf_run()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="app__dial_8c-source.html#l00430">do_forward()</a>, <a class="el" href="app__queue_8c-source.html#l01616">do_hang()</a>, <a class="el" href="res__features_8c-source.html#l01761">do_parking_thread()</a>, <a class="el" href="chan__features_8c-source.html#l00364">features_hangup()</a>, <a class="el" href="app__followme_8c-source.html#l00763">findmeexec()</a>, <a class="el" href="app__rpt_8c-source.html#l02757">function_ilink()</a>, <a class="el" href="chan__gtalk_8c-source.html#l00902">gtalk_new()</a>, <a class="el" href="dial_8c-source.html#l00318">handle_frame()</a>, <a class="el" href="dial_8c-source.html#l00391">handle_frame_ownerless()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02954">handle_hd_hf()</a>, <a class="el" href="chan__zap_8c-source.html#l06934">handle_init_event()</a>, <a class="el" href="chan__sip_8c-source.html#l13936">handle_invite_replaces()</a>, <a class="el" href="chan__skinny_8c-source.html#l03385">handle_offhook_message()</a>, <a class="el" href="chan__sip_8c-source.html#l14098">handle_request_invite()</a>, <a class="el" href="chan__skinny_8c-source.html#l03920">handle_soft_key_event_message()</a>, <a class="el" href="chan__skinny_8c-source.html#l03102">handle_stimulus_message()</a>, <a class="el" href="chan__misdn_8c-source.html#l03439">hangup_chan()</a>, <a class="el" href="app__queue_8c-source.html#l01521">hangupcalls()</a>, <a class="el" href="app__dial_8c-source.html#l00305">hanguptree()</a>, <a class="el" href="chan__iax2_8c-source.html#l08278">iax2_request()</a>, <a class="el" href="chan__iax2_8c-source.html#l06306">iax_park()</a>, <a class="el" href="chan__iax2_8c-source.html#l06286">iax_park_thread()</a>, <a class="el" href="chan__jingle_8c-source.html#l00759">jingle_new()</a>, <a class="el" href="chan__sip_8c-source.html#l14615">local_attended_transfer()</a>, <a class="el" href="chan__local_8c-source.html#l00488">local_hangup()</a>, <a class="el" href="chan__mgcp_8c-source.html#l01457">mgcp_new()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02638">mgcp_ss()</a>, <a class="el" href="dial_8c-source.html#l00440">monitor_dial()</a>, <a class="el" href="chan__nbs_8c-source.html#l00233">nbs_new()</a>, <a class="el" href="chan__oss_8c-source.html#l01020">oss_new()</a>, <a class="el" href="chan__phone_8c-source.html#l00864">phone_new()</a>, <a class="el" href="app__rpt_8c-source.html#l05604">rpt()</a>, <a class="el" href="app__rpt_8c-source.html#l02483">rpt_call()</a>, <a class="el" href="app__rpt_8c-source.html#l06759">rpt_exec()</a>, <a class="el" href="app__rpt_8c-source.html#l01860">rpt_tele_thread()</a>, <a class="el" href="chan__sip_8c-source.html#l04179">sip_new()</a>, <a class="el" href="chan__sip_8c-source.html#l13574">sip_park()</a>, <a class="el" href="chan__sip_8c-source.html#l13507">sip_park_thread()</a>, <a class="el" href="chan__skinny_8c-source.html#l02823">skinny_new()</a>, <a class="el" href="chan__skinny_8c-source.html#l02365">skinny_ss()</a>, <a class="el" href="chan__iax2_8c-source.html#l06624">socket_process()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>, <a class="el" href="app__dial_8c-source.html#l00532">wait_for_answer()</a>, <a class="el" href="app__followme_8c-source.html#l00470">wait_for_winner()</a>, <a class="el" href="chan__zap_8c-source.html#l03942">zt_handle_event()</a>, and <a class="el" href="chan__zap_8c-source.html#l05516">zt_new()</a>.<div class="fragment"><pre class="fragment"><a name="l01599"></a>01599 {
<a name="l01600"></a>01600    <span class="keywordtype">int</span> res = 0;
<a name="l01601"></a>01601 
<a name="l01602"></a>01602    <span class="comment">/* Don't actually hang up a channel that will masquerade as someone else, or</span>
<a name="l01603"></a>01603 <span class="comment">      if someone is going to masquerade as us */</span>
<a name="l01604"></a>01604    <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l01605"></a>01605 
<a name="l01606"></a>01606    <a class="code" href="channel_8c.html#f40ac2c82018d2d1726231f39a54f380">detach_spies</a>(chan);     <span class="comment">/* get rid of spies */</span>
<a name="l01607"></a>01607 
<a name="l01608"></a>01608    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#f980faa30a783f7d18ceb4783afc1c69">masq</a>) {
<a name="l01609"></a>01609       <span class="keywordflow">if</span> (<a class="code" href="channel_8c.html#f788595bd51a58be12bb3c3b28a950ec">ast_do_masquerade</a>(chan))
<a name="l01610"></a>01610          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Failed to perform masquerade\n"</span>);
<a name="l01611"></a>01611    }
<a name="l01612"></a>01612 
<a name="l01613"></a>01613    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#f980faa30a783f7d18ceb4783afc1c69">masq</a>) {
<a name="l01614"></a>01614       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"%s getting hung up, but someone is trying to masq into us?!?\n"</span>, chan-&gt;name);
<a name="l01615"></a>01615       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l01616"></a>01616       <span class="keywordflow">return</span> 0;
<a name="l01617"></a>01617    }
<a name="l01618"></a>01618    <span class="comment">/* If this channel is one which will be masqueraded into something,</span>
<a name="l01619"></a>01619 <span class="comment">      mark it as a zombie already, so we know to free it later */</span>
<a name="l01620"></a>01620    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#407a336ed0d13fc2cea1c71a81ad05df">masqr</a>) {
<a name="l01621"></a>01621       <a class="code" href="utils_8h.html#3208623241ff7b4c93907944487502a1">ast_set_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>);
<a name="l01622"></a>01622       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l01623"></a>01623       <span class="keywordflow">return</span> 0;
<a name="l01624"></a>01624    }
<a name="l01625"></a>01625    <a class="code" href="channel_8c.html#58f25e1132c752853fc0e73a67964c37">free_translation</a>(chan);
<a name="l01626"></a>01626    <span class="comment">/* Close audio stream */</span>
<a name="l01627"></a>01627    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#f7b44cfafd5c52223d5498196c8a2e7b">stream</a>) {
<a name="l01628"></a>01628       <a class="code" href="file_8c.html#8d18ac7b6bb79201e6321c4b5cfadde2">ast_closestream</a>(chan-&gt;<a class="code" href="structast__channel.html#f7b44cfafd5c52223d5498196c8a2e7b">stream</a>);
<a name="l01629"></a>01629       chan-&gt;<a class="code" href="structast__channel.html#f7b44cfafd5c52223d5498196c8a2e7b">stream</a> = NULL;
<a name="l01630"></a>01630    }
<a name="l01631"></a>01631    <span class="comment">/* Close video stream */</span>
<a name="l01632"></a>01632    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#a4853768f8d245b7d0d327cb620b8f52">vstream</a>) {
<a name="l01633"></a>01633       <a class="code" href="file_8c.html#8d18ac7b6bb79201e6321c4b5cfadde2">ast_closestream</a>(chan-&gt;<a class="code" href="structast__channel.html#a4853768f8d245b7d0d327cb620b8f52">vstream</a>);
<a name="l01634"></a>01634       chan-&gt;<a class="code" href="structast__channel.html#a4853768f8d245b7d0d327cb620b8f52">vstream</a> = NULL;
<a name="l01635"></a>01635    }
<a name="l01636"></a>01636    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#47721f99ae60cbec027428e52ad7ca39">sched</a>) {
<a name="l01637"></a>01637       <a class="code" href="sched_8c.html#89e2eb9653fa462ad4ff62e05ad36050">sched_context_destroy</a>(chan-&gt;<a class="code" href="structast__channel.html#47721f99ae60cbec027428e52ad7ca39">sched</a>);
<a name="l01638"></a>01638       chan-&gt;<a class="code" href="structast__channel.html#47721f99ae60cbec027428e52ad7ca39">sched</a> = NULL;
<a name="l01639"></a>01639    }
<a name="l01640"></a>01640    
<a name="l01641"></a>01641    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#68e80cee708fd0cdfb20807a8663721d">generatordata</a>)   <span class="comment">/* Clear any tone stuff remaining */</span>
<a name="l01642"></a>01642       <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#dac9630aec642a428cd73f4be0a03569">generator</a> &amp;&amp; chan-&gt;<a class="code" href="structast__channel.html#dac9630aec642a428cd73f4be0a03569">generator</a>-&gt;<a class="code" href="structast__generator.html#62e15df14a257d6ac9725e39389d5b5a">release</a>)
<a name="l01643"></a>01643          chan-&gt;<a class="code" href="structast__channel.html#dac9630aec642a428cd73f4be0a03569">generator</a>-&gt;<a class="code" href="structast__generator.html#62e15df14a257d6ac9725e39389d5b5a">release</a>(chan, chan-&gt;<a class="code" href="structast__channel.html#68e80cee708fd0cdfb20807a8663721d">generatordata</a>);
<a name="l01644"></a>01644    chan-&gt;<a class="code" href="structast__channel.html#68e80cee708fd0cdfb20807a8663721d">generatordata</a> = NULL;
<a name="l01645"></a>01645    chan-&gt;<a class="code" href="structast__channel.html#dac9630aec642a428cd73f4be0a03569">generator</a> = NULL;
<a name="l01646"></a>01646    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>) {     <span class="comment">/* End the CDR if it hasn't already */</span>
<a name="l01647"></a>01647       <a class="code" href="cdr_8c.html#545d0bb7a87e9317b6eb3ce2245145cc">ast_cdr_end</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>);
<a name="l01648"></a>01648       <a class="code" href="cdr_8c.html#b20947a5170d08a12a3cee0498e07614">ast_cdr_detach</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>); <span class="comment">/* Post and Free the CDR */</span>
<a name="l01649"></a>01649       chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a> = NULL;
<a name="l01650"></a>01650    }
<a name="l01651"></a>01651    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>)) {
<a name="l01652"></a>01652       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Hard hangup called by thread %ld on %s, while fd "</span>
<a name="l01653"></a>01653                <span class="stringliteral">"is blocked by thread %ld in procedure %s!  Expect a failure\n"</span>,
<a name="l01654"></a>01654                (<span class="keywordtype">long</span>)pthread_self(), chan-&gt;name, (<span class="keywordtype">long</span>)chan-&gt;<a class="code" href="structast__channel.html#a38ba46bb4909bc27602645297913d86">blocker</a>, chan-&gt;<a class="code" href="structast__channel.html#0c1ba8c20fea058c120da59f7730055e">blockproc</a>);
<a name="l01655"></a>01655       <a class="code" href="channel_8h.html#cef2f26f7da88da7db20faa12bd436c4">CRASH</a>;
<a name="l01656"></a>01656    }
<a name="l01657"></a>01657    <span class="keywordflow">if</span> (!<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>)) {
<a name="l01658"></a>01658       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l01659"></a>01659          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Hanging up channel '%s'\n"</span>, chan-&gt;name);
<a name="l01660"></a>01660       <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#453321d0ff441f44936f3ce5e7c059d6">hangup</a>)
<a name="l01661"></a>01661          res = chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#453321d0ff441f44936f3ce5e7c059d6">hangup</a>(chan);
<a name="l01662"></a>01662    } <span class="keywordflow">else</span> {
<a name="l01663"></a>01663       <span class="keywordflow">if</span> (option_debug)
<a name="l01664"></a>01664          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Hanging up zombie '%s'\n"</span>, chan-&gt;name);
<a name="l01665"></a>01665    }
<a name="l01666"></a>01666          
<a name="l01667"></a>01667    <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l01668"></a>01668    <a class="code" href="manager_8h.html#17a8c809d5b2d04cbb8969a209134c2b">manager_event</a>(<a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <span class="stringliteral">"Hangup"</span>,
<a name="l01669"></a>01669          <span class="stringliteral">"Channel: %s\r\n"</span>
<a name="l01670"></a>01670          <span class="stringliteral">"Uniqueid: %s\r\n"</span>
<a name="l01671"></a>01671          <span class="stringliteral">"Cause: %d\r\n"</span>
<a name="l01672"></a>01672          <span class="stringliteral">"Cause-txt: %s\r\n"</span>,
<a name="l01673"></a>01673          chan-&gt;name,
<a name="l01674"></a>01674          chan-&gt;uniqueid,
<a name="l01675"></a>01675          chan-&gt;<a class="code" href="structast__channel.html#8be5f831332d8ff714e90c2cf85171fe">hangupcause</a>,
<a name="l01676"></a>01676          <a class="code" href="channel_8c.html#817c0e10b26cbcb773516bb6583fb694">ast_cause2str</a>(chan-&gt;<a class="code" href="structast__channel.html#8be5f831332d8ff714e90c2cf85171fe">hangupcause</a>)
<a name="l01677"></a>01677          );
<a name="l01678"></a>01678    <a class="code" href="channel_8c.html#230a804b09060fecdf699c2c9613fff7">ast_channel_free</a>(chan);
<a name="l01679"></a>01679    <span class="keywordflow">return</span> res;
<a name="l01680"></a>01680 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="90b88ba4c6f05bc0b655583c899c0269"></a><!-- doxytag: member="channel.h::ast_indicate" ref="90b88ba4c6f05bc0b655583c899c0269" args="(struct ast_channel *chan, int condition)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_indicate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>condition</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Indicates condition of channel. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>Indicate a condition such as AST_CONTROL_BUSY, AST_CONTROL_RINGING, or AST_CONTROL_CONGESTION on a channel </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to change the indication </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>condition</em>&nbsp;</td><td>which condition to indicate on the channel </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns 0 on success, -1 on failure </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l02448">2448</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l02453">ast_indicate_data()</a>.
<p>
Referenced by <a class="el" href="app_8c-source.html#l00509">__ast_play_and_record()</a>, <a class="el" href="res__features_8c-source.html#l01478">ast_bridge_call()</a>, <a class="el" href="app_8c-source.html#l00236">ast_dtmf_stream()</a>, <a class="el" href="res__features_8c-source.html#l01295">ast_feature_request_and_dial()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02897">attempt_transfer()</a>, <a class="el" href="res__features_8c-source.html#l00776">builtin_atxfer()</a>, <a class="el" href="res__features_8c-source.html#l00673">builtin_blindtransfer()</a>, <a class="el" href="app__meetme_8c-source.html#l01350">conf_run()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="res__features_8c-source.html#l01761">do_parking_thread()</a>, <a class="el" href="chan__features_8c-source.html#l00288">features_indicate()</a>, <a class="el" href="res__features_8c-source.html#l00653">finishup()</a>, <a class="el" href="app__rpt_8c-source.html#l04577">function_remote()</a>, <a class="el" href="dial_8c-source.html#l00318">handle_frame()</a>, <a class="el" href="res__agi_8c-source.html#l00889">handle_recordfile()</a>, <a class="el" href="app__rpt_8c-source.html#l05320">handle_remote_data()</a>, <a class="el" href="app__rpt_8c-source.html#l05353">handle_remote_phone_dtmf()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02638">mgcp_ss()</a>, <a class="el" href="dial_8c-source.html#l00440">monitor_dial()</a>, <a class="el" href="pbx_8c-source.html#l05394">pbx_builtin_busy()</a>, <a class="el" href="pbx_8c-source.html#l05408">pbx_builtin_congestion()</a>, <a class="el" href="pbx_8c-source.html#l05376">pbx_builtin_progress()</a>, <a class="el" href="pbx_8c-source.html#l05385">pbx_builtin_ringing()</a>, <a class="el" href="pbx_8c-source.html#l05584">pbx_builtin_waitexten()</a>, <a class="el" href="app__queue_8c-source.html#l03443">queue_exec()</a>, <a class="el" href="app__record_8c-source.html#l00078">record_exec()</a>, <a class="el" href="app__rpt_8c-source.html#l04527">rmt_telem_finish()</a>, <a class="el" href="app__rpt_8c-source.html#l04515">rmt_telem_start()</a>, <a class="el" href="app__rpt_8c-source.html#l05604">rpt()</a>, <a class="el" href="app__rpt_8c-source.html#l06759">rpt_exec()</a>, <a class="el" href="app__festival_8c-source.html#l00171">send_waveform_to_channel()</a>, <a class="el" href="chan__skinny_8c-source.html#l02365">skinny_ss()</a>, <a class="el" href="app__meetme_8c-source.html#l03767">sla_handle_hold_event()</a>, <a class="el" href="app__meetme_8c-source.html#l04166">sla_station_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l04326">sla_trunk_exec()</a>, and <a class="el" href="app__dial_8c-source.html#l00532">wait_for_answer()</a>.<div class="fragment"><pre class="fragment"><a name="l02449"></a>02449 {
<a name="l02450"></a>02450    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#f1b18b170d0068311ca47c2e0d0ede5c">ast_indicate_data</a>(chan, condition, NULL, 0);
<a name="l02451"></a>02451 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="f1b18b170d0068311ca47c2e0d0ede5c"></a><!-- doxytag: member="channel.h::ast_indicate_data" ref="f1b18b170d0068311ca47c2e0d0ede5c" args="(struct ast_channel *chan, int condition, const void *data, size_t datalen)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_indicate_data           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>condition</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>datalen</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Indicates condition of channel, with payload. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>Indicate a condition such as AST_CONTROL_HOLD with payload being music on hold class </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to change the indication </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>condition</em>&nbsp;</td><td>which condition to indicate on the channel </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>pointer to payload data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>datalen</em>&nbsp;</td><td>size of payload data </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns 0 on success, -1 on failure </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l02453">2453</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="channel_8c-source.html#l00325">ast_check_hangup()</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3898c0ff5febeb7ff9d8880e2bc7f1d6ca1">AST_CONTROL_BUSY</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389fafe5e503d0d74218854b57e66282419">AST_CONTROL_CONGESTION</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389dcaa1b03a8c60073c53c1b662418697f">AST_CONTROL_HOLD</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389e3f77da12f7cbd7a9abfd7c8ce7bfb2b">AST_CONTROL_PROCEEDING</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389ba3a8e0de0c6348205ffdc9e446af14f">AST_CONTROL_PROGRESS</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3895749da867c771f2391b19ce9e08f0149">AST_CONTROL_RINGING</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389582c81bc89b064f8093864a6c023a823">AST_CONTROL_UNHOLD</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3897e8f2fe3be94657a962aa673f0c449e5">AST_CONTROL_VIDUPDATE</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>, <a class="el" href="indications_8c-source.html#l00423">ast_get_indication_tone()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="indications_8c-source.html#l00220">ast_playtones_start()</a>, <a class="el" href="indications_8c-source.html#l00333">ast_playtones_stop()</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="indications_8h-source.html#l00045">ind_tone_zone_sound::data</a>, <a class="el" href="structast__channel__tech.html#3d2fea14faebc9196821215b29f70fbd">ast_channel_tech::indicate</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="channel_8h-source.html#l00385">ast_channel::tech</a>, and <a class="el" href="channel_8h-source.html#l00454">ast_channel::zone</a>.
<p>
Referenced by <a class="el" href="chan__agent_8c-source.html#l01763">__login_exec()</a>, <a class="el" href="chan__agent_8c-source.html#l00717">agent_hangup()</a>, <a class="el" href="channel_8c-source.html#l03797">ast_generic_bridge()</a>, <a class="el" href="channel_8c-source.html#l02448">ast_indicate()</a>, <a class="el" href="res__features_8c-source.html#l00342">ast_park_call()</a>, <a class="el" href="rtp_8c-source.html#l02909">bridge_native_loop()</a>, <a class="el" href="rtp_8c-source.html#l03195">bridge_p2p_loop()</a>, <a class="el" href="res__features_8c-source.html#l01761">do_parking_thread()</a>, <a class="el" href="pbx_8c-source.html#l05584">pbx_builtin_waitexten()</a>, and <a class="el" href="app__dial_8c-source.html#l00532">wait_for_answer()</a>.<div class="fragment"><pre class="fragment"><a name="l02454"></a>02454 {
<a name="l02455"></a>02455    <span class="keywordtype">int</span> res = -1;
<a name="l02456"></a>02456 
<a name="l02457"></a>02457    <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l02458"></a>02458    <span class="comment">/* Stop if we're a zombie or need a soft hangup */</span>
<a name="l02459"></a>02459    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>) || <a class="code" href="channel_8c.html#042e64a8d465783855a52ec8c56a9373">ast_check_hangup</a>(chan)) {
<a name="l02460"></a>02460       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l02461"></a>02461       <span class="keywordflow">return</span> -1;
<a name="l02462"></a>02462    }
<a name="l02463"></a>02463    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#3d2fea14faebc9196821215b29f70fbd">indicate</a>)
<a name="l02464"></a>02464       res = chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#3d2fea14faebc9196821215b29f70fbd">indicate</a>(chan, condition, data, datalen);
<a name="l02465"></a>02465    <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l02466"></a>02466    <span class="keywordflow">if</span> (!chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#3d2fea14faebc9196821215b29f70fbd">indicate</a> || res) {
<a name="l02467"></a>02467       <span class="comment">/*</span>
<a name="l02468"></a>02468 <span class="comment">       * Device does not support (that) indication, lets fake</span>
<a name="l02469"></a>02469 <span class="comment">       * it by doing our own tone generation. (PM2002)</span>
<a name="l02470"></a>02470 <span class="comment">       */</span>
<a name="l02471"></a>02471       <span class="keywordflow">if</span> (condition &lt; 0)
<a name="l02472"></a>02472          <a class="code" href="indications_8c.html#58be04c13701ac7140bfeec76ba55ce9">ast_playtones_stop</a>(chan);
<a name="l02473"></a>02473       <span class="keywordflow">else</span> {
<a name="l02474"></a>02474          <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structind__tone__zone__sound.html">ind_tone_zone_sound</a> *ts = NULL;
<a name="l02475"></a>02475          <span class="keywordflow">switch</span> (condition) {
<a name="l02476"></a>02476          <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3895749da867c771f2391b19ce9e08f0149">AST_CONTROL_RINGING</a>:
<a name="l02477"></a>02477             ts = <a class="code" href="indications_8c.html#f8dc11a7ba1a39a19fc805ef5d914c4d">ast_get_indication_tone</a>(chan-&gt;<a class="code" href="structast__channel.html#a84e5f25e7f6d5de9b82ce3f64d1b8fa">zone</a>, <span class="stringliteral">"ring"</span>);
<a name="l02478"></a>02478             <span class="keywordflow">break</span>;
<a name="l02479"></a>02479          <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3898c0ff5febeb7ff9d8880e2bc7f1d6ca1">AST_CONTROL_BUSY</a>:
<a name="l02480"></a>02480             ts = <a class="code" href="indications_8c.html#f8dc11a7ba1a39a19fc805ef5d914c4d">ast_get_indication_tone</a>(chan-&gt;<a class="code" href="structast__channel.html#a84e5f25e7f6d5de9b82ce3f64d1b8fa">zone</a>, <span class="stringliteral">"busy"</span>);
<a name="l02481"></a>02481             <span class="keywordflow">break</span>;
<a name="l02482"></a>02482          <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389fafe5e503d0d74218854b57e66282419">AST_CONTROL_CONGESTION</a>:
<a name="l02483"></a>02483             ts = <a class="code" href="indications_8c.html#f8dc11a7ba1a39a19fc805ef5d914c4d">ast_get_indication_tone</a>(chan-&gt;<a class="code" href="structast__channel.html#a84e5f25e7f6d5de9b82ce3f64d1b8fa">zone</a>, <span class="stringliteral">"congestion"</span>);
<a name="l02484"></a>02484             <span class="keywordflow">break</span>;
<a name="l02485"></a>02485          }
<a name="l02486"></a>02486          <span class="keywordflow">if</span> (ts &amp;&amp; ts-&gt;<a class="code" href="structind__tone__zone__sound.html#8d777f385d3dfec8815d20f7496026dc">data</a>[0]) {
<a name="l02487"></a>02487             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l02488"></a>02488                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Driver for channel '%s' does not support indication %d, emulating it\n"</span>, chan-&gt;name, condition);
<a name="l02489"></a>02489             <a class="code" href="indications_8c.html#aa5c984fda65782cd8ea1dd4101a15c3">ast_playtones_start</a>(chan,0,ts-&gt;<a class="code" href="structind__tone__zone__sound.html#8d777f385d3dfec8815d20f7496026dc">data</a>, 1);
<a name="l02490"></a>02490             res = 0;
<a name="l02491"></a>02491          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (condition == <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389ba3a8e0de0c6348205ffdc9e446af14f">AST_CONTROL_PROGRESS</a>) {
<a name="l02492"></a>02492             <span class="comment">/* ast_playtones_stop(chan); */</span>
<a name="l02493"></a>02493          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (condition == <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389e3f77da12f7cbd7a9abfd7c8ce7bfb2b">AST_CONTROL_PROCEEDING</a>) {
<a name="l02494"></a>02494             <span class="comment">/* Do nothing, really */</span>
<a name="l02495"></a>02495          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (condition == <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389dcaa1b03a8c60073c53c1b662418697f">AST_CONTROL_HOLD</a>) {
<a name="l02496"></a>02496             <span class="comment">/* Do nothing.... */</span>
<a name="l02497"></a>02497          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (condition == <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389582c81bc89b064f8093864a6c023a823">AST_CONTROL_UNHOLD</a>) {
<a name="l02498"></a>02498             <span class="comment">/* Do nothing.... */</span>
<a name="l02499"></a>02499          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (condition == <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3897e8f2fe3be94657a962aa673f0c449e5">AST_CONTROL_VIDUPDATE</a>) {
<a name="l02500"></a>02500             <span class="comment">/* Do nothing.... */</span>
<a name="l02501"></a>02501          } <span class="keywordflow">else</span> {
<a name="l02502"></a>02502             <span class="comment">/* not handled */</span>
<a name="l02503"></a>02503             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Unable to handle indication %d for '%s'\n"</span>, condition, chan-&gt;name);
<a name="l02504"></a>02504             res = -1;
<a name="l02505"></a>02505          }
<a name="l02506"></a>02506       }
<a name="l02507"></a>02507    }
<a name="l02508"></a>02508    <span class="keywordflow">return</span> res;
<a name="l02509"></a>02509 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="73d63296a76525785cf9f1f379e1d6b4"></a><!-- doxytag: member="channel.h::ast_internal_timing_enabled" ref="73d63296a76525785cf9f1f379e1d6b4" args="(struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_internal_timing_enabled           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chan</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Check if the channel can run in internal timing mode. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>The channel to check </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>boolean</dd></dl>
This function will return 1 if internal timing is enabled and the timing device is available. 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l02430">2430</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="options_8h-source.html#l00106">ast_opt_internal_timing</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, and <a class="el" href="channel_8h-source.html#l00431">ast_channel::timingfd</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02060">__ast_read()</a>.<div class="fragment"><pre class="fragment"><a name="l02431"></a>02431 {
<a name="l02432"></a>02432    <span class="keywordtype">int</span> ret = <a class="code" href="options_8h.html#f869989ac3f79ef2a407cdc298ad9e5c">ast_opt_internal_timing</a> &amp;&amp; chan-&gt;<a class="code" href="structast__channel.html#4cd06d1a010b6a371149b4a0adb2f884">timingfd</a> &gt; -1;
<a name="l02433"></a>02433    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a> &gt; 4)
<a name="l02434"></a>02434       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Internal timing is %s (option_internal_timing=%d chan-&gt;timingfd=%d)\n"</span>, ret? <span class="stringliteral">"enabled"</span>: <span class="stringliteral">"disabled"</span>, <a class="code" href="options_8h.html#f869989ac3f79ef2a407cdc298ad9e5c">ast_opt_internal_timing</a>, chan-&gt;<a class="code" href="structast__channel.html#4cd06d1a010b6a371149b4a0adb2f884">timingfd</a>);
<a name="l02435"></a>02435    <span class="keywordflow">return</span> ret;
<a name="l02436"></a>02436 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="68e3e84e623c83dd308276466ccf7a35"></a><!-- doxytag: member="channel.h::ast_print_group" ref="68e3e84e623c83dd308276466ccf7a35" args="(char *buf, int buflen, ast_group_t group)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char* ast_print_group           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>buflen</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="channel_8h.html#f46fa02de8676dd1b9163c5dd428e610">ast_group_t</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>group</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
print call- and pickup groups into buffer 
<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l04461">4461</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="adsistub_8c-source.html#l00083">num</a>.
<p>
Referenced by <a class="el" href="chan__sip_8c-source.html#l10808">_sip_show_peer()</a>, <a class="el" href="chan__sip_8c-source.html#l12333">function_sippeer()</a>, <a class="el" href="misdn__config_8c-source.html#l00719">misdn_cfg_get_config_string()</a>, <a class="el" href="chan__sip_8c-source.html#l10510">print_group()</a>, <a class="el" href="chan__misdn_8c-source.html#l01714">read_config()</a>, and <a class="el" href="app__dumpchan_8c-source.html#l00060">serialize_showchan()</a>.<div class="fragment"><pre class="fragment"><a name="l04462"></a>04462 {
<a name="l04463"></a>04463    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;
<a name="l04464"></a>04464    <span class="keywordtype">int</span> first=1;
<a name="l04465"></a>04465    <span class="keywordtype">char</span> <a class="code" href="adsistub_8c.html#0fc3cfbc27e91ea60a787de13dae3e3c">num</a>[3];
<a name="l04466"></a>04466 
<a name="l04467"></a>04467    <a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>[0] = <span class="charliteral">'\0'</span>;
<a name="l04468"></a>04468    
<a name="l04469"></a>04469    <span class="keywordflow">if</span> (!<a class="code" href="chan__agent_8c.html#db0f6f37ebeb6ea09489124345af2a45">group</a>) <span class="comment">/* Return empty string if no group */</span>
<a name="l04470"></a>04470       <span class="keywordflow">return</span> <a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>;
<a name="l04471"></a>04471 
<a name="l04472"></a>04472    <span class="keywordflow">for</span> (i = 0; i &lt;= 63; i++) {   <span class="comment">/* Max group is 63 */</span>
<a name="l04473"></a>04473       <span class="keywordflow">if</span> (<a class="code" href="chan__agent_8c.html#db0f6f37ebeb6ea09489124345af2a45">group</a> &amp; ((<a class="code" href="channel_8h.html#f46fa02de8676dd1b9163c5dd428e610">ast_group_t</a>) 1 &lt;&lt; i)) {
<a name="l04474"></a>04474             <span class="keywordflow">if</span> (!first) {
<a name="l04475"></a>04475             strncat(<a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>, <span class="stringliteral">", "</span>, buflen);
<a name="l04476"></a>04476          } <span class="keywordflow">else</span> {
<a name="l04477"></a>04477             first=0;
<a name="l04478"></a>04478          }
<a name="l04479"></a>04479          snprintf(num, <span class="keyword">sizeof</span>(num), <span class="stringliteral">"%u"</span>, i);
<a name="l04480"></a>04480          strncat(<a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>, num, buflen);
<a name="l04481"></a>04481       }
<a name="l04482"></a>04482    }
<a name="l04483"></a>04483    <span class="keywordflow">return</span> <a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>;
<a name="l04484"></a>04484 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1e5a4ef714eb64bfdc55813ba363bd67"></a><!-- doxytag: member="channel.h::ast_prod" ref="1e5a4ef714eb64bfdc55813ba363bd67" args="(struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_prod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chan</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Send empty audio to prime a channel driver. 
<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l02631">2631</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00435">ast_channel::_state</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f9264fc4720a7b3982e2d4bf246fe3d9924">AST_FRAME_VOICE</a>, <a class="el" href="frame_8h-source.html#l00181">AST_FRIENDLY_OFFSET</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>, <a class="el" href="channel_8c-source.html#l02660">ast_write()</a>, <a class="el" href="frame_8h-source.html#l00147">ast_frame::data</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="channel_8h-source.html#l00482">ast_channel::rawwriteformat</a>, <a class="el" href="frame_8h-source.html#l00145">ast_frame::src</a>, and <a class="el" href="frame_8h-source.html#l00133">ast_frame::subclass</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l01764">ast_activate_generator()</a>.<div class="fragment"><pre class="fragment"><a name="l02632"></a>02632 {
<a name="l02633"></a>02633    <span class="keyword">struct </span><a class="code" href="structast__frame.html">ast_frame</a> a = { <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f9264fc4720a7b3982e2d4bf246fe3d9924">AST_FRAME_VOICE</a> };
<a name="l02634"></a>02634    <span class="keywordtype">char</span> nothing[128];
<a name="l02635"></a>02635 
<a name="l02636"></a>02636    <span class="comment">/* Send an empty audio frame to get things moving */</span>
<a name="l02637"></a>02637    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a> != <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>) {
<a name="l02638"></a>02638       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l02639"></a>02639          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Prodding channel '%s'\n"</span>, chan-&gt;name);
<a name="l02640"></a>02640       a.<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> = chan-&gt;<a class="code" href="structast__channel.html#331ec3b1c98b3ffed254938780cac119">rawwriteformat</a>;
<a name="l02641"></a>02641       a.<a class="code" href="structast__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a> = nothing + <a class="code" href="frame_8h.html#2d81423482d14a11460b216109864d5b">AST_FRIENDLY_OFFSET</a>;
<a name="l02642"></a>02642       a.<a class="code" href="structast__frame.html#25d902c24283ab8cfbac54dfa101ad31">src</a> = <span class="stringliteral">"ast_prod"</span>;
<a name="l02643"></a>02643       <span class="keywordflow">if</span> (<a class="code" href="channel_8c.html#57a74c4c7b7e25ad61a4f461e3c73158">ast_write</a>(chan, &amp;a))
<a name="l02644"></a>02644          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Prodding channel '%s' failed\n"</span>, chan-&gt;name);
<a name="l02645"></a>02645    }
<a name="l02646"></a>02646    <span class="keywordflow">return</span> 0;
<a name="l02647"></a>02647 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="9c10dd50747025f5100adeb1da23c2e1"></a><!-- doxytag: member="channel.h::ast_queue_control" ref="9c10dd50747025f5100adeb1da23c2e1" args="(struct ast_channel *chan, enum ast_control_frame_type control)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_queue_control           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>enum <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389">ast_control_frame_type</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>control</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Queue a control frame with payload. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to queue frame onto </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>control</em>&nbsp;</td><td>type of control frame </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>zero on success, non-zero on failure </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l00863">863</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a>, <a class="el" href="channel_8c-source.html#l00795">ast_queue_frame()</a>, and <a class="el" href="frame_8h-source.html#l00133">ast_frame::subclass</a>.
<p>
Referenced by <a class="el" href="chan__h323_8c-source.html#l00342">__oh323_update_info()</a>, <a class="el" href="chan__zap_8c-source.html#l04786">__zt_exception()</a>, <a class="el" href="res__features_8c-source.html#l02403">ast_pickup_call()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02897">attempt_transfer()</a>, <a class="el" href="chan__sip_8c-source.html#l03147">auto_congest()</a>, <a class="el" href="chan__gtalk_8c-source.html#l00601">gtalk_is_answered()</a>, <a class="el" href="chan__gtalk_8c-source.html#l00500">gtalk_ringing_ack()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02954">handle_hd_hf()</a>, <a class="el" href="chan__skinny_8c-source.html#l03385">handle_offhook_message()</a>, <a class="el" href="chan__sip_8c-source.html#l15145">handle_request_bye()</a>, <a class="el" href="chan__sip_8c-source.html#l11655">handle_request_info()</a>, <a class="el" href="chan__sip_8c-source.html#l13135">handle_response()</a>, <a class="el" href="chan__sip_8c-source.html#l12569">handle_response_invite()</a>, <a class="el" href="chan__sip_8c-source.html#l12873">handle_response_refer()</a>, <a class="el" href="chan__skinny_8c-source.html#l03920">handle_soft_key_event_message()</a>, <a class="el" href="chan__skinny_8c-source.html#l03102">handle_stimulus_message()</a>, <a class="el" href="chan__jingle_8c-source.html#l00487">jingle_is_answered()</a>, <a class="el" href="chan__jingle_8c-source.html#l00385">jingle_ringing_ack()</a>, <a class="el" href="chan__mgcp_8c-source.html#l00849">mgcp_call()</a>, <a class="el" href="chan__nbs_8c-source.html#l00093">nbs_call()</a>, <a class="el" href="app__directed__pickup_8c-source.html#l00058">pickup_do()</a>, <a class="el" href="chan__sip_8c-source.html#l05180">process_sdp()</a>, <a class="el" href="chan__h323_8c-source.html#l01833">receive_digit()</a>, <a class="el" href="chan__h323_8c-source.html#l02506">remote_hold()</a>, <a class="el" href="chan__misdn_8c-source.html#l03621">send_cause2ast()</a>, <a class="el" href="chan__h323_8c-source.html#l01954">setup_rtp_connection()</a>, <a class="el" href="chan__skinny_8c-source.html#l02460">skinny_call()</a>, <a class="el" href="chan__skinny_8c-source.html#l02949">skinny_unhold()</a>, <a class="el" href="chan__iax2_8c-source.html#l06624">socket_process()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, <a class="el" href="chan__h323_8c-source.html#l01182">update_state()</a>, <a class="el" href="chan__zap_8c-source.html#l03942">zt_handle_event()</a>, and <a class="el" href="chan__zap_8c-source.html#l02612">zt_hangup()</a>.<div class="fragment"><pre class="fragment"><a name="l00864"></a>00864 {
<a name="l00865"></a>00865    <span class="keyword">struct </span><a class="code" href="structast__frame.html">ast_frame</a> f = { <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a>, };
<a name="l00866"></a>00866 
<a name="l00867"></a>00867    f.<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> = control;
<a name="l00868"></a>00868 
<a name="l00869"></a>00869    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#c02f134e64b4fc85c1efd80b8685b635">ast_queue_frame</a>(chan, &amp;f);
<a name="l00870"></a>00870 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3336b8cfda88155ef5378ba728bef5c8"></a><!-- doxytag: member="channel.h::ast_queue_control_data" ref="3336b8cfda88155ef5378ba728bef5c8" args="(struct ast_channel *chan, enum ast_control_frame_type control, const void *data, size_t datalen)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_queue_control_data           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>enum <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389">ast_control_frame_type</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>control</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>datalen</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Queue a control frame with payload. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to queue frame onto </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>control</em>&nbsp;</td><td>type of control frame </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>pointer to payload data to be included in frame </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>datalen</em>&nbsp;</td><td>number of bytes of payload data </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>zero on success, non-zero on failure</dd></dl>
The supplied payload data is copied into the frame, so the caller's copy is not modified nor freed, and the resulting frame will retain a copy of the data even if the caller frees their local copy.<p>
<dl compact><dt><b>Note:</b></dt><dd>This method should be treated as a 'network transport'; in other words, your frames may be transferred across an IAX2 channel to another system, which may be a different endianness than yours. Because of this, you should ensure that either your frames will never be expected to work across systems, or that you always put your payload data into 'network byte order' before calling this function. </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l00873">873</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a>, <a class="el" href="channel_8c-source.html#l00795">ast_queue_frame()</a>, <a class="el" href="frame_8h-source.html#l00147">ast_frame::data</a>, <a class="el" href="frame_8h-source.html#l00135">ast_frame::datalen</a>, and <a class="el" href="frame_8h-source.html#l00133">ast_frame::subclass</a>.
<p>
Referenced by <a class="el" href="chan__sip_8c-source.html#l05180">process_sdp()</a>, <a class="el" href="chan__skinny_8c-source.html#l02909">skinny_hold()</a>, <a class="el" href="chan__iax2_8c-source.html#l06624">socket_process()</a>, <a class="el" href="chan__zap_8c-source.html#l03942">zt_handle_event()</a>, and <a class="el" href="chan__zap_8c-source.html#l02612">zt_hangup()</a>.<div class="fragment"><pre class="fragment"><a name="l00875"></a>00875 {
<a name="l00876"></a>00876    <span class="keyword">struct </span><a class="code" href="structast__frame.html">ast_frame</a> f = { <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a>, };
<a name="l00877"></a>00877 
<a name="l00878"></a>00878    f.<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> = control;
<a name="l00879"></a>00879    f.<a class="code" href="structast__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a> = (<span class="keywordtype">void</span> *) <a class="code" href="structast__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a>;
<a name="l00880"></a>00880    f.<a class="code" href="structast__frame.html#106553e2afb20bec4268dd6bd02c952d">datalen</a> = <a class="code" href="structast__frame.html#106553e2afb20bec4268dd6bd02c952d">datalen</a>;
<a name="l00881"></a>00881 
<a name="l00882"></a>00882    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#c02f134e64b4fc85c1efd80b8685b635">ast_queue_frame</a>(chan, &amp;f);
<a name="l00883"></a>00883 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d16a30a5843812777450bd333f0ce589"></a><!-- doxytag: member="channel.h::ast_queue_frame" ref="d16a30a5843812777450bd333f0ce589" args="(struct ast_channel *chan, struct ast_frame *f)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_queue_frame           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>f</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Queue an outgoing frame. 
<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l00795">795</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00474">ast_channel::alertpipe</a>, <a class="el" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3896a1de835fbf024ef925569eb775de67f">AST_CONTROL_HANGUP</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f9264fc4720a7b3982e2d4bf246fe3d9924">AST_FRAME_VOICE</a>, <a class="el" href="frame_8c-source.html#l00439">ast_frdup()</a>, <a class="el" href="frame_8h-source.html#l00396">ast_frfree()</a>, <a class="el" href="linkedlists_8h-source.html#l00670">AST_LIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h-source.html#l00393">AST_LIST_LAST</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="channel_8h-source.html#l00417">ast_channel::blocker</a>, <a class="el" href="channel_8h-source.html#l01384">CRASH</a>, <a class="el" href="format__g726_8c-source.html#l00193">f</a>, <a class="el" href="frame_8h-source.html#l00131">ast_frame::frametype</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="frame_8h-source.html#l00133">ast_frame::subclass</a>, and <a class="el" href="channel_8h-source.html#l00431">ast_channel::timingfd</a>.
<p>
Referenced by <a class="el" href="chan__h323_8c-source.html#l00962">__oh323_rtp_create()</a>, <a class="el" href="chan__h323_8c-source.html#l00342">__oh323_update_info()</a>, <a class="el" href="chan__agent_8c-source.html#l00909">agent_new()</a>, <a class="el" href="chan__alsa_8c-source.html#l00523">alsa_call()</a>, <a class="el" href="channel_8c-source.html#l03270">ast_channel_masquerade()</a>, <a class="el" href="channel_8c-source.html#l00386">ast_channel_setwhentohangup()</a>, <a class="el" href="channel_8c-source.html#l03406">ast_do_masquerade()</a>, <a class="el" href="dsp_8c-source.html#l01413">ast_dsp_process()</a>, <a class="el" href="channel_8c-source.html#l00863">ast_queue_control()</a>, <a class="el" href="channel_8c-source.html#l00873">ast_queue_control_data()</a>, <a class="el" href="channel_8c-source.html#l00851">ast_queue_hangup()</a>, <a class="el" href="channel_8c-source.html#l01442">ast_softhangup_nolock()</a>, <a class="el" href="chan__alsa_8c-source.html#l00891">console_answer()</a>, <a class="el" href="chan__alsa_8c-source.html#l01004">console_dial()</a>, <a class="el" href="chan__oss_8c-source.html#l01235">console_flash()</a>, <a class="el" href="chan__alsa_8c-source.html#l00927">console_sendtext()</a>, <a class="el" href="app__dictate_8c-source.html#l00079">dictate_exec()</a>, <a class="el" href="chan__misdn_8c-source.html#l03558">do_immediate_setup()</a>, <a class="el" href="chan__gtalk_8c-source.html#l00626">gtalk_handle_dtmf()</a>, <a class="el" href="chan__skinny_8c-source.html#l03032">handle_keypad_button_message()</a>, <a class="el" href="chan__sip_8c-source.html#l11655">handle_request_info()</a>, <a class="el" href="chan__sip_8c-source.html#l14098">handle_request_invite()</a>, <a class="el" href="chan__sip_8c-source.html#l12569">handle_response_invite()</a>, <a class="el" href="chan__iax2_8c-source.html#l01396">iax2_queue_frame()</a>, <a class="el" href="chan__jingle_8c-source.html#l00508">jingle_handle_dtmf()</a>, <a class="el" href="chan__local_8c-source.html#l00165">local_queue_frame()</a>, <a class="el" href="chan__mgcp_8c-source.html#l00591">mgcp_queue_frame()</a>, <a class="el" href="chan__h323_8c-source.html#l00310">oh323_simulate_dtmf_end()</a>, <a class="el" href="chan__oss_8c-source.html#l00804">oss_call()</a>, <a class="el" href="chan__sip_8c-source.html#l05180">process_sdp()</a>, <a class="el" href="chan__h323_8c-source.html#l01833">receive_digit()</a>, <a class="el" href="chan__sip_8c-source.html#l10131">receive_message()</a>, <a class="el" href="chan__zap_8c-source.html#l00876">wakeup_sub()</a>, and <a class="el" href="chan__zap_8c-source.html#l00903">zap_queue_frame()</a>.<div class="fragment"><pre class="fragment"><a name="l00796"></a>00796 {
<a name="l00797"></a>00797    <span class="keyword">struct </span><a class="code" href="structast__frame.html">ast_frame</a> *f;
<a name="l00798"></a>00798    <span class="keyword">struct </span><a class="code" href="structast__frame.html">ast_frame</a> *cur;
<a name="l00799"></a>00799    <span class="keywordtype">int</span> blah = 1;
<a name="l00800"></a>00800    <span class="keywordtype">int</span> qlen = 0;
<a name="l00801"></a>00801 
<a name="l00802"></a>00802    <span class="comment">/* Build us a copy and free the original one */</span>
<a name="l00803"></a>00803    <span class="keywordflow">if</span> (!(f = <a class="code" href="frame_8c.html#e7f7f3d8f817e56bbaf43b0b1ecf8997">ast_frdup</a>(fin))) {
<a name="l00804"></a>00804       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Unable to duplicate frame\n"</span>);
<a name="l00805"></a>00805       <span class="keywordflow">return</span> -1;
<a name="l00806"></a>00806    }
<a name="l00807"></a>00807    <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l00808"></a>00808 
<a name="l00809"></a>00809    <span class="comment">/* See if the last frame on the queue is a hangup, if so don't queue anything */</span>
<a name="l00810"></a>00810    <span class="keywordflow">if</span> ((cur = <a class="code" href="linkedlists_8h.html#59bb7a6b664d9bb9678434fc0e6eefb7">AST_LIST_LAST</a>(&amp;chan-&gt;readq)) &amp;&amp; (cur-&gt;<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a> == <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a>) &amp;&amp; (cur-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> == <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3896a1de835fbf024ef925569eb775de67f">AST_CONTROL_HANGUP</a>)) {
<a name="l00811"></a>00811       <a class="code" href="frame_8h.html#506c759ec4950e7f7465e8f090a6252b">ast_frfree</a>(f);
<a name="l00812"></a>00812       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l00813"></a>00813       <span class="keywordflow">return</span> 0;
<a name="l00814"></a>00814    }
<a name="l00815"></a>00815 
<a name="l00816"></a>00816    <span class="comment">/* Count how many frames exist on the queue */</span>
<a name="l00817"></a>00817    <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;chan-&gt;readq, cur, frame_list) {
<a name="l00818"></a>00818       qlen++;
<a name="l00819"></a>00819    }
<a name="l00820"></a>00820 
<a name="l00821"></a>00821    <span class="comment">/* Allow up to 96 voice frames outstanding, and up to 128 total frames */</span>
<a name="l00822"></a>00822    <span class="keywordflow">if</span> (((fin-&gt;frametype == <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f9264fc4720a7b3982e2d4bf246fe3d9924">AST_FRAME_VOICE</a>) &amp;&amp; (qlen &gt; 96)) || (qlen  &gt; 128)) {
<a name="l00823"></a>00823       <span class="keywordflow">if</span> (fin-&gt;frametype != <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f9264fc4720a7b3982e2d4bf246fe3d9924">AST_FRAME_VOICE</a>) {
<a name="l00824"></a>00824          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Exceptionally long queue length queuing to %s\n"</span>, chan-&gt;name);
<a name="l00825"></a>00825          <a class="code" href="channel_8h.html#cef2f26f7da88da7db20faa12bd436c4">CRASH</a>;
<a name="l00826"></a>00826       } <span class="keywordflow">else</span> {
<a name="l00827"></a>00827          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l00828"></a>00828             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Dropping voice to exceptionally long queue on %s\n"</span>, chan-&gt;name);
<a name="l00829"></a>00829          <a class="code" href="frame_8h.html#506c759ec4950e7f7465e8f090a6252b">ast_frfree</a>(f);
<a name="l00830"></a>00830          <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l00831"></a>00831          <span class="keywordflow">return</span> 0;
<a name="l00832"></a>00832       }
<a name="l00833"></a>00833    }
<a name="l00834"></a>00834    <a class="code" href="linkedlists_8h.html#8de6ce8a3b9d59e7e7fddee6b62b32a7">AST_LIST_INSERT_TAIL</a>(&amp;chan-&gt;readq, f, frame_list);
<a name="l00835"></a>00835    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#edfa4b7986a2ee7cd0db044fa4f67e8e">alertpipe</a>[1] &gt; -1) {
<a name="l00836"></a>00836       <span class="keywordflow">if</span> (write(chan-&gt;<a class="code" href="structast__channel.html#edfa4b7986a2ee7cd0db044fa4f67e8e">alertpipe</a>[1], &amp;blah, <span class="keyword">sizeof</span>(blah)) != <span class="keyword">sizeof</span>(blah))
<a name="l00837"></a>00837          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Unable to write to alert pipe on %s, frametype/subclass %d/%d (qlen = %d): %s!\n"</span>,
<a name="l00838"></a>00838             chan-&gt;name, f-&gt;<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a>, f-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a>, qlen, strerror(errno));
<a name="l00839"></a>00839 <span class="preprocessor">#ifdef HAVE_ZAPTEL</span>
<a name="l00840"></a>00840 <span class="preprocessor"></span>   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#4cd06d1a010b6a371149b4a0adb2f884">timingfd</a> &gt; -1) {
<a name="l00841"></a>00841       ioctl(chan-&gt;<a class="code" href="structast__channel.html#4cd06d1a010b6a371149b4a0adb2f884">timingfd</a>, ZT_TIMERPING, &amp;blah);
<a name="l00842"></a>00842 <span class="preprocessor">#endif            </span>
<a name="l00843"></a>00843 <span class="preprocessor"></span>   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>)) {
<a name="l00844"></a>00844       pthread_kill(chan-&gt;<a class="code" href="structast__channel.html#a38ba46bb4909bc27602645297913d86">blocker</a>, SIGURG);
<a name="l00845"></a>00845    }
<a name="l00846"></a>00846    <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l00847"></a>00847    <span class="keywordflow">return</span> 0;
<a name="l00848"></a>00848 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="61f0a289387829da5c568c664f85e01c"></a><!-- doxytag: member="channel.h::ast_queue_hangup" ref="61f0a289387829da5c568c664f85e01c" args="(struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_queue_hangup           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chan</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Queue a hangup frame. 
<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l00851">851</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00414">ast_channel::_softhangup</a>, <a class="el" href="lock_8h.html#ed66db8089c98c0615ab831f4eba520a">ast_channel_trylock</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3896a1de835fbf024ef925569eb775de67f">AST_CONTROL_HANGUP</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a>, <a class="el" href="channel_8c-source.html#l00795">ast_queue_frame()</a>, and <a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1cbe3f9a2385d6a31eac6abced2a9f17d">AST_SOFTHANGUP_DEV</a>.
<p>
Referenced by <a class="el" href="chan__h323_8c-source.html#l00342">__oh323_update_info()</a>, <a class="el" href="chan__sip_8c-source.html#l02183">__sip_autodestruct()</a>, <a class="el" href="chan__h323_8c-source.html#l02355">cleanup_connection()</a>, <a class="el" href="chan__alsa_8c-source.html#l00972">console_hangup()</a>, <a class="el" href="chan__gtalk_8c-source.html#l00679">gtalk_hangup_farend()</a>, <a class="el" href="chan__skinny_8c-source.html#l03457">handle_onhook_message()</a>, <a class="el" href="chan__sip_8c-source.html#l15145">handle_request_bye()</a>, <a class="el" href="chan__sip_8c-source.html#l15049">handle_request_cancel()</a>, <a class="el" href="chan__sip_8c-source.html#l13135">handle_response()</a>, <a class="el" href="chan__sip_8c-source.html#l12569">handle_response_invite()</a>, <a class="el" href="chan__skinny_8c-source.html#l03920">handle_soft_key_event_message()</a>, <a class="el" href="chan__misdn_8c-source.html#l03439">hangup_chan()</a>, <a class="el" href="chan__h323_8c-source.html#l02405">hangup_connection()</a>, <a class="el" href="chan__iax2_8c-source.html#l01823">iax2_destroy()</a>, <a class="el" href="chan__iax2_8c-source.html#l01799">iax2_predestroy()</a>, <a class="el" href="chan__jingle_8c-source.html#l00556">jingle_hangup_farend()</a>, <a class="el" href="chan__mgcp_8c-source.html#l00609">mgcp_queue_hangup()</a>, <a class="el" href="chan__misdn_8c-source.html#l02107">misdn_answer()</a>, <a class="el" href="chan__sip_8c-source.html#l02026">retrans_pkt()</a>, and <a class="el" href="chan__zap_8c-source.html#l03942">zt_handle_event()</a>.<div class="fragment"><pre class="fragment"><a name="l00852"></a>00852 {
<a name="l00853"></a>00853    <span class="keyword">struct </span><a class="code" href="structast__frame.html">ast_frame</a> f = { <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a>, <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3896a1de835fbf024ef925569eb775de67f">AST_CONTROL_HANGUP</a> };
<a name="l00854"></a>00854    <span class="comment">/* Yeah, let's not change a lock-critical value without locking */</span>
<a name="l00855"></a>00855    <span class="keywordflow">if</span> (!<a class="code" href="lock_8h.html#ed66db8089c98c0615ab831f4eba520a">ast_channel_trylock</a>(chan)) {
<a name="l00856"></a>00856       chan-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> |= <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1cbe3f9a2385d6a31eac6abced2a9f17d">AST_SOFTHANGUP_DEV</a>;
<a name="l00857"></a>00857       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l00858"></a>00858    }
<a name="l00859"></a>00859    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#c02f134e64b4fc85c1efd80b8685b635">ast_queue_frame</a>(chan, &amp;f);
<a name="l00860"></a>00860 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1446a8c0bddf626bf26b000fbeae117f"></a><!-- doxytag: member="channel.h::ast_read" ref="1446a8c0bddf626bf26b000fbeae117f" args="(struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__frame.html">ast_frame</a>* ast_read           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chan</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Reads a frame. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to read a frame from </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns a frame, or NULL on error. If it returns NULL, you best just stop reading frames and assume the channel has been disconnected. </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l02438">2438</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l02060">__ast_read()</a>.
<p>
Referenced by <a class="el" href="res__adsi_8c-source.html#l00198">__adsi_transmit_messages()</a>, <a class="el" href="app_8c-source.html#l00509">__ast_play_and_record()</a>, <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="res__adsi_8c-source.html#l00127">adsi_careful_send()</a>, <a class="el" href="chan__agent_8c-source.html#l00850">agent_ack_sleep()</a>, <a class="el" href="chan__agent_8c-source.html#l00427">agent_read()</a>, <a class="el" href="app__externalivr_8c-source.html#l00244">app_exec()</a>, <a class="el" href="res__features_8c-source.html#l01295">ast_feature_request_and_dial()</a>, <a class="el" href="channel_8c-source.html#l03797">ast_generic_bridge()</a>, <a class="el" href="res__features_8c-source.html#l00473">ast_masq_park_call()</a>, <a class="el" href="channel_8c-source.html#l02522">ast_recvtext()</a>, <a class="el" href="channel_8c-source.html#l01027">ast_safe_sleep_conditional()</a>, <a class="el" href="channel_8c-source.html#l04361">ast_tonepair()</a>, <a class="el" href="channel_8c-source.html#l01987">ast_waitfordigit_full()</a>, <a class="el" href="pbx_8c-source.html#l04903">async_wait()</a>, <a class="el" href="autoservice_8c-source.html#l00064">autoservice_run()</a>, <a class="el" href="app__talkdetect_8c-source.html#l00063">background_detect_exec()</a>, <a class="el" href="rtp_8c-source.html#l02909">bridge_native_loop()</a>, <a class="el" href="rtp_8c-source.html#l03195">bridge_p2p_loop()</a>, <a class="el" href="res__features_8c-source.html#l00776">builtin_atxfer()</a>, <a class="el" href="app__chanspy_8c-source.html#l00266">channel_spy()</a>, <a class="el" href="res__features_8c-source.html#l00192">check_goto_on_transfer()</a>, <a class="el" href="app__meetme_8c-source.html#l01180">conf_flush()</a>, <a class="el" href="app__zapbarge_8c-source.html#l00093">conf_run()</a>, <a class="el" href="app__dictate_8c-source.html#l00079">dictate_exec()</a>, <a class="el" href="app__disa_8c-source.html#l00113">disa_exec()</a>, <a class="el" href="res__features_8c-source.html#l01761">do_parking_thread()</a>, <a class="el" href="app__waitforsilence_8c-source.html#l00078">do_waiting()</a>, <a class="el" href="app__echo_8c-source.html#l00054">echo_exec()</a>, <a class="el" href="chan__features_8c-source.html#l00241">features_read()</a>, <a class="el" href="chan__iax2_8c-source.html#l09693">find_cache()</a>, <a class="el" href="chan__sip_8c-source.html#l13936">handle_invite_replaces()</a>, <a class="el" href="res__agi_8c-source.html#l00889">handle_recordfile()</a>, <a class="el" href="chan__iax2_8c-source.html#l03198">iax2_bridge()</a>, <a class="el" href="chan__iax2_8c-source.html#l06286">iax_park_thread()</a>, <a class="el" href="app__ices_8c-source.html#l00104">ices_exec()</a>, <a class="el" href="app__amd_8c-source.html#l00097">isAnsweringMachine()</a>, <a class="el" href="app__test_8c-source.html#l00064">measurenoise()</a>, <a class="el" href="chan__misdn_8c-source.html#l02789">misdn_bridge()</a>, <a class="el" href="dial_8c-source.html#l00440">monitor_dial()</a>, <a class="el" href="app__mp3_8c-source.html#l00125">mp3_exec()</a>, <a class="el" href="app__nbscat_8c-source.html#l00116">NBScat_exec()</a>, <a class="el" href="app__alarmreceiver_8c-source.html#l00238">receive_dtmf_digits()</a>, <a class="el" href="app__record_8c-source.html#l00078">record_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l03045">recordthread()</a>, <a class="el" href="app__rpt_8c-source.html#l05604">rpt()</a>, <a class="el" href="app__rpt_8c-source.html#l06759">rpt_exec()</a>, <a class="el" href="res__agi_8c-source.html#l01833">run_agi()</a>, <a class="el" href="app__alarmreceiver_8c-source.html#l00170">send_tone_burst()</a>, <a class="el" href="app__festival_8c-source.html#l00171">send_waveform_to_channel()</a>, <a class="el" href="app__url_8c-source.html#l00070">sendurl_exec()</a>, <a class="el" href="app__sms_8c-source.html#l01748">sms_exec()</a>, <a class="el" href="app__speech__utils_8c-source.html#l00543">speech_background()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, <a class="el" href="app__dial_8c-source.html#l00532">wait_for_answer()</a>, <a class="el" href="pbx_8c-source.html#l05351">wait_for_hangup()</a>, <a class="el" href="app__followme_8c-source.html#l00470">wait_for_winner()</a>, <a class="el" href="app__waitforring_8c-source.html#l00056">waitforring_exec()</a>, <a class="el" href="file_8c-source.html#l00983">waitstream_core()</a>, and <a class="el" href="chan__zap_8c-source.html#l03412">zt_bridge()</a>.<div class="fragment"><pre class="fragment"><a name="l02439"></a>02439 {
<a name="l02440"></a>02440    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#89920218d5243f8f1f37ffd60cfa5f2b">__ast_read</a>(chan, 0);
<a name="l02441"></a>02441 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ee2f7baed67b1012d314a42203fca91c"></a><!-- doxytag: member="channel.h::ast_read_noaudio" ref="ee2f7baed67b1012d314a42203fca91c" args="(struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__frame.html">ast_frame</a>* ast_read_noaudio           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chan</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Reads a frame, returning AST_FRAME_NULL frame if audio. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to read a frame from </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns a frame, or NULL on error. If it returns NULL, you best just stop reading frames and assume the channel has been disconnected. </dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>Audio is replaced with AST_FRAME_NULL to avoid transcode when the resulting audio is not necessary. </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l02443">2443</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l02060">__ast_read()</a>.<div class="fragment"><pre class="fragment"><a name="l02444"></a>02444 {
<a name="l02445"></a>02445    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#89920218d5243f8f1f37ffd60cfa5f2b">__ast_read</a>(chan, 1);
<a name="l02446"></a>02446 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="9b1cd169a6bd0641ef663976f0dc20c2"></a><!-- doxytag: member="channel.h::ast_readstring" ref="9b1cd169a6bd0641ef663976f0dc20c2" args="(struct ast_channel *c, char *s, int len, int timeout, int rtimeout, char *enders)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_readstring           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>timeout</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>rtimeout</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>enders</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Reads multiple digits <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>channel to read from </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td>string to read in to. Must be at least the size of your length </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>how many digits to read (maximum) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeout</em>&nbsp;</td><td>how long to timeout between digits </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rtimeout</em>&nbsp;</td><td>timeout to wait on the first digit </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>enders</em>&nbsp;</td><td>digits to end the string Read in a digit string "s", max length "len", maximum timeout between digits "timeout" (-1 for none), terminated by anything in "enders". Give them rtimeout for the first digit. Returns 0 on normal return, or 1 on a timeout. In the case of a timeout, any digits that were read before the timeout will still be available in s. RETURNS 2 in full version when ctrlfd is available, NOT 1 </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l03156">3156</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l03161">ast_readstring_full()</a>.
<p>
Referenced by <a class="el" href="res__adsi_8c-source.html#l00337">_ast_adsi_begin_download()</a>, <a class="el" href="res__adsi_8c-source.html#l00661">_ast_adsi_get_cpeinfo()</a>, <a class="el" href="res__adsi_8c-source.html#l00993">_ast_adsi_load_session()</a>, <a class="el" href="app_8c-source.html#l00107">ast_app_getdata()</a>, <a class="el" href="app__voicemail_8c-source.html#l08128">dialout()</a>, <a class="el" href="app__directory_8c-source.html#l00400">do_directory()</a>, <a class="el" href="app__voicemail_8c-source.html#l04129">forward_message()</a>, <a class="el" href="app__privacy_8c-source.html#l00078">privacy_exec()</a>, <a class="el" href="app__voicemail_8c-source.html#l06295">vm_authenticate()</a>, <a class="el" href="app__voicemail_8c-source.html#l05923">vm_newuser()</a>, and <a class="el" href="app__voicemail_8c-source.html#l06010">vm_options()</a>.<div class="fragment"><pre class="fragment"><a name="l03157"></a>03157 {
<a name="l03158"></a>03158    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#1f31f24701fb6ddcecb9ccb05ad327b8">ast_readstring_full</a>(c, <a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>, <a class="code" href="utils_8h.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a>, timeout, ftimeout, enders, -1, -1);
<a name="l03159"></a>03159 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="92e6bac85bd90ccfe326aad8232894a5"></a><!-- doxytag: member="channel.h::ast_readstring_full" ref="92e6bac85bd90ccfe326aad8232894a5" args="(struct ast_channel *c, char *s, int len, int timeout, int rtimeout, char *enders, int audiofd, int ctrlfd)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_readstring_full           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>timeout</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>rtimeout</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>enders</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>audiofd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>ctrlfd</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l03161">3161</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l00325">ast_check_hangup()</a>, <a class="el" href="file_8h-source.html#l00040">AST_DIGIT_ANY</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>, <a class="el" href="file_8c-source.html#l00131">ast_stopstream()</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="channel_8c-source.html#l01987">ast_waitfordigit_full()</a>, <a class="el" href="file_8c-source.html#l01094">ast_waitstream_full()</a>, and <a class="el" href="channel_8h-source.html#l00426">ast_channel::stream</a>.
<p>
Referenced by <a class="el" href="app_8c-source.html#l00152">ast_app_getdata_full()</a>, and <a class="el" href="channel_8c-source.html#l03156">ast_readstring()</a>.<div class="fragment"><pre class="fragment"><a name="l03162"></a>03162 {
<a name="l03163"></a>03163    <span class="keywordtype">int</span> pos = 0;   <span class="comment">/* index in the buffer where we accumulate digits */</span>
<a name="l03164"></a>03164    <span class="keywordtype">int</span> to = ftimeout;
<a name="l03165"></a>03165 
<a name="l03166"></a>03166    <span class="comment">/* Stop if we're a zombie or need a soft hangup */</span>
<a name="l03167"></a>03167    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(c, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>) || <a class="code" href="channel_8c.html#042e64a8d465783855a52ec8c56a9373">ast_check_hangup</a>(c))
<a name="l03168"></a>03168       <span class="keywordflow">return</span> -1;
<a name="l03169"></a>03169    <span class="keywordflow">if</span> (!<a class="code" href="utils_8h.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a>)
<a name="l03170"></a>03170       <span class="keywordflow">return</span> -1;
<a name="l03171"></a>03171    <span class="keywordflow">for</span> (;;) {
<a name="l03172"></a>03172       <span class="keywordtype">int</span> d;
<a name="l03173"></a>03173       <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structast__channel.html#f7b44cfafd5c52223d5498196c8a2e7b">stream</a>) {
<a name="l03174"></a>03174          d = <a class="code" href="file_8c.html#7be3107f4ff5bc2975b1f52fa552cb6a">ast_waitstream_full</a>(c, <a class="code" href="file_8h.html#4da2b9e8d896d755e4003168efa23b45">AST_DIGIT_ANY</a>, audiofd, ctrlfd);
<a name="l03175"></a>03175          <a class="code" href="file_8c.html#460c61941bbb0132a2513ec9d5529e0c">ast_stopstream</a>(c);
<a name="l03176"></a>03176          usleep(1000);
<a name="l03177"></a>03177          <span class="keywordflow">if</span> (!d)
<a name="l03178"></a>03178             d = <a class="code" href="channel_8c.html#6db20c648edfddb833ffa4d313257275">ast_waitfordigit_full</a>(c, to, audiofd, ctrlfd);
<a name="l03179"></a>03179       } <span class="keywordflow">else</span> {
<a name="l03180"></a>03180          d = <a class="code" href="channel_8c.html#6db20c648edfddb833ffa4d313257275">ast_waitfordigit_full</a>(c, to, audiofd, ctrlfd);
<a name="l03181"></a>03181       }
<a name="l03182"></a>03182       <span class="keywordflow">if</span> (d &lt; 0)
<a name="l03183"></a>03183          <span class="keywordflow">return</span> -1;
<a name="l03184"></a>03184       <span class="keywordflow">if</span> (d == 0) {
<a name="l03185"></a>03185          <a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>[pos]=<span class="charliteral">'\0'</span>;
<a name="l03186"></a>03186          <span class="keywordflow">return</span> 1;
<a name="l03187"></a>03187       }
<a name="l03188"></a>03188       <span class="keywordflow">if</span> (d == 1) {
<a name="l03189"></a>03189          <a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>[pos]=<span class="charliteral">'\0'</span>;
<a name="l03190"></a>03190          <span class="keywordflow">return</span> 2;
<a name="l03191"></a>03191       }
<a name="l03192"></a>03192       <span class="keywordflow">if</span> (!strchr(enders, d))
<a name="l03193"></a>03193          <a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>[pos++] = d;
<a name="l03194"></a>03194       <span class="keywordflow">if</span> (strchr(enders, d) || (pos &gt;= <a class="code" href="utils_8h.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a>)) {
<a name="l03195"></a>03195          <a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>[pos]=<span class="charliteral">'\0'</span>;
<a name="l03196"></a>03196          <span class="keywordflow">return</span> 0;
<a name="l03197"></a>03197       }
<a name="l03198"></a>03198       to = timeout;
<a name="l03199"></a>03199    }
<a name="l03200"></a>03200    <span class="comment">/* Never reached */</span>
<a name="l03201"></a>03201    <span class="keywordflow">return</span> 0;
<a name="l03202"></a>03202 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="36dd07166fc2565f54fc5e7350b2fbe7"></a><!-- doxytag: member="channel.h::ast_recvchar" ref="36dd07166fc2565f54fc5e7350b2fbe7" args="(struct ast_channel *chan, int timeout)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_recvchar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>timeout</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Receives a text character from a channel. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to act upon </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeout</em>&nbsp;</td><td>timeout in milliseconds (0 for infinite wait) Read a char of text from a channel Returns 0 on success, -1 on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l02511">2511</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l02522">ast_recvtext()</a>, <a class="el" href="adsistub_8c-source.html#l00065">buf</a>, and <a class="el" href="astmm_8h-source.html#l00069">free</a>.
<p>
Referenced by <a class="el" href="res__agi_8c-source.html#l00450">handle_recvchar()</a>.<div class="fragment"><pre class="fragment"><a name="l02512"></a>02512 {
<a name="l02513"></a>02513    <span class="keywordtype">int</span> c;
<a name="l02514"></a>02514    <span class="keywordtype">char</span> *<a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a> = <a class="code" href="channel_8c.html#985b0a0ce0ab536a6d9a1f88f55ace1a">ast_recvtext</a>(chan, timeout);
<a name="l02515"></a>02515    <span class="keywordflow">if</span> (buf == NULL)
<a name="l02516"></a>02516       <span class="keywordflow">return</span> -1;  <span class="comment">/* error or timeout */</span>
<a name="l02517"></a>02517    c = *(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)buf;
<a name="l02518"></a>02518    <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(buf);
<a name="l02519"></a>02519    <span class="keywordflow">return</span> c;
<a name="l02520"></a>02520 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="985b0a0ce0ab536a6d9a1f88f55ace1a"></a><!-- doxytag: member="channel.h::ast_recvtext" ref="985b0a0ce0ab536a6d9a1f88f55ace1a" args="(struct ast_channel *chan, int timeout)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char* ast_recvtext           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>timeout</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Receives a text string from a channel Read a string of text from a channel. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to act upon </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeout</em>&nbsp;</td><td>timeout in milliseconds (0 for infinite wait) </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the received text, or NULL to signify failure. </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l02522">2522</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l00325">ast_check_hangup()</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3896a1de835fbf024ef925569eb775de67f">AST_CONTROL_HANGUP</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92696800d27feca415d5c80113fb740f44">AST_FRAME_TEXT</a>, <a class="el" href="frame_8h-source.html#l00396">ast_frfree()</a>, <a class="el" href="channel_8c-source.html#l02438">ast_read()</a>, <a class="el" href="utils_8h.html#be543d8da561eeb7942ffd9c42d319c0">ast_strndup</a>, <a class="el" href="channel_8c-source.html#l01952">ast_waitfor()</a>, <a class="el" href="adsistub_8c-source.html#l00065">buf</a>, <a class="el" href="frame_8h-source.html#l00147">ast_frame::data</a>, <a class="el" href="frame_8h-source.html#l00135">ast_frame::datalen</a>, <a class="el" href="format__g726_8c-source.html#l00193">f</a>, <a class="el" href="frame_8h-source.html#l00131">ast_frame::frametype</a>, and <a class="el" href="frame_8h-source.html#l00133">ast_frame::subclass</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02511">ast_recvchar()</a>, and <a class="el" href="res__agi_8c-source.html#l00470">handle_recvtext()</a>.<div class="fragment"><pre class="fragment"><a name="l02523"></a>02523 {
<a name="l02524"></a>02524    <span class="keywordtype">int</span> res, done = 0;
<a name="l02525"></a>02525    <span class="keywordtype">char</span> *<a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a> = NULL;
<a name="l02526"></a>02526    
<a name="l02527"></a>02527    <span class="keywordflow">while</span> (!done) {
<a name="l02528"></a>02528       <span class="keyword">struct </span><a class="code" href="structast__frame.html">ast_frame</a> *<a class="code" href="format__g726_8c.html#85b9b17a7dd34a3638c560bc9152473b">f</a>;
<a name="l02529"></a>02529       <span class="keywordflow">if</span> (<a class="code" href="channel_8c.html#042e64a8d465783855a52ec8c56a9373">ast_check_hangup</a>(chan))
<a name="l02530"></a>02530          <span class="keywordflow">break</span>;
<a name="l02531"></a>02531       res = <a class="code" href="channel_8c.html#e02dcdf40023f275d4561a930e7a7fc9">ast_waitfor</a>(chan, timeout);
<a name="l02532"></a>02532       <span class="keywordflow">if</span> (res &lt;= 0) <span class="comment">/* timeout or error */</span>
<a name="l02533"></a>02533          <span class="keywordflow">break</span>;
<a name="l02534"></a>02534       timeout = res; <span class="comment">/* update timeout */</span>
<a name="l02535"></a>02535       f = <a class="code" href="channel_8c.html#1446a8c0bddf626bf26b000fbeae117f">ast_read</a>(chan);
<a name="l02536"></a>02536       <span class="keywordflow">if</span> (f == NULL)
<a name="l02537"></a>02537          <span class="keywordflow">break</span>; <span class="comment">/* no frame */</span>
<a name="l02538"></a>02538       <span class="keywordflow">if</span> (f-&gt;<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a> == <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a> &amp;&amp; f-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> == <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3896a1de835fbf024ef925569eb775de67f">AST_CONTROL_HANGUP</a>)
<a name="l02539"></a>02539          done = 1;   <span class="comment">/* force a break */</span>
<a name="l02540"></a>02540       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (f-&gt;<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a> == <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92696800d27feca415d5c80113fb740f44">AST_FRAME_TEXT</a>) {      <span class="comment">/* what we want */</span>
<a name="l02541"></a>02541          buf = <a class="code" href="utils_8h.html#be543d8da561eeb7942ffd9c42d319c0">ast_strndup</a>((<span class="keywordtype">char</span> *) f-&gt;<a class="code" href="structast__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a>, f-&gt;<a class="code" href="structast__frame.html#106553e2afb20bec4268dd6bd02c952d">datalen</a>);   <span class="comment">/* dup and break */</span>
<a name="l02542"></a>02542          done = 1;
<a name="l02543"></a>02543       }
<a name="l02544"></a>02544       <a class="code" href="frame_8h.html#506c759ec4950e7f7465e8f090a6252b">ast_frfree</a>(f);
<a name="l02545"></a>02545    }
<a name="l02546"></a>02546    <span class="keywordflow">return</span> buf;
<a name="l02547"></a>02547 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="18fe0a44ab0842c23ceb444817baecd7"></a><!-- doxytag: member="channel.h::ast_request" ref="18fe0a44ab0842c23ceb444817baecd7" args="(const char *type, int format, void *data, int *status)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a>* ast_request           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Requests a channel. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>type</em>&nbsp;</td><td>type of channel to request </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>format</em>&nbsp;</td><td>requested channel format (codec) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>data to pass to the channel requester </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>status</em>&nbsp;</td><td>status Request a channel of a given type, with data as optional information used by the low level module </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns an <a class="el" href="structast__channel.html">ast_channel</a> on success, NULL on failure. </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l03063">3063</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="causes_8h-source.html#l00116">AST_CAUSE_BEARERCAPABILITY_NOTAVAIL</a>, <a class="el" href="causes_8h-source.html#l00142">AST_CAUSE_NOSUCHDRIVER</a>, <a class="el" href="causes_8h-source.html#l00141">AST_CAUSE_NOTDEFINED</a>, <a class="el" href="frame_8h-source.html#l00249">AST_FORMAT_AUDIO_MASK</a>, <a class="el" href="frame_8h-source.html#l00271">AST_FORMAT_TEXT_MASK</a>, <a class="el" href="frame_8h-source.html#l00266">AST_FORMAT_VIDEO_MASK</a>, <a class="el" href="linkedlists_8h-source.html#l00038">AST_LIST_LOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00104">AST_LIST_UNLOCK</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="translate_8c-source.html#l00714">ast_translator_best_choice()</a>, <a class="el" href="channel_8h-source.html#l00238">ast_channel_tech::capabilities</a>, <a class="el" href="res__jabber_8c-source.html#l00165">capabilities</a>, <a class="el" href="manager_8h-source.html#l00182">fmt</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="structast__channel__tech.html#19015c7009167d3f93d33c1c1e5fe0f7">ast_channel_tech::requester</a>, <a class="el" href="channel_8c-source.html#l00120">chanlist::tech</a>, and <a class="el" href="channel_8h-source.html#l00235">ast_channel_tech::type</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="chan__agent_8c-source.html#l01289">agent_request()</a>, <a class="el" href="res__features_8c-source.html#l01295">ast_feature_request_and_dial()</a>, <a class="el" href="app__rpt_8c-source.html#l05377">attempt_reconnect()</a>, <a class="el" href="dial_8c-source.html#l00236">begin_dial()</a>, <a class="el" href="app__meetme_8c-source.html#l00732">build_conf()</a>, <a class="el" href="app__chanisavail_8c-source.html#l00069">chanavail_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l01350">conf_run()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="app__dial_8c-source.html#l00430">do_forward()</a>, <a class="el" href="chan__features_8c-source.html#l00397">features_alloc()</a>, <a class="el" href="app__followme_8c-source.html#l00763">findmeexec()</a>, <a class="el" href="app__rpt_8c-source.html#l02757">function_ilink()</a>, <a class="el" href="app__queue_8c-source.html#l01660">ring_entry()</a>, <a class="el" href="app__rpt_8c-source.html#l05604">rpt()</a>, <a class="el" href="app__rpt_8c-source.html#l02483">rpt_call()</a>, <a class="el" href="app__rpt_8c-source.html#l06759">rpt_exec()</a>, <a class="el" href="app__rpt_8c-source.html#l01860">rpt_tele_thread()</a>, and <a class="el" href="app__queue_8c-source.html#l01950">wait_for_answer()</a>.<div class="fragment"><pre class="fragment"><a name="l03064"></a>03064 {
<a name="l03065"></a>03065    <span class="keyword">struct </span><a class="code" href="structchanlist.html">chanlist</a> *<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>;
<a name="l03066"></a>03066    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *c;
<a name="l03067"></a>03067    <span class="keywordtype">int</span> <a class="code" href="res__jabber_8c.html#f7b11037f2050959293aafb493b7653c">capabilities</a>;
<a name="l03068"></a>03068    <span class="keywordtype">int</span> <a class="code" href="manager_8h.html#7631454338ff70b1a6b1262f5f36beac">fmt</a>;
<a name="l03069"></a>03069    <span class="keywordtype">int</span> res;
<a name="l03070"></a>03070    <span class="keywordtype">int</span> foo;
<a name="l03071"></a>03071    <span class="keywordtype">int</span> videoformat = <a class="code" href="chan__alsa_8c.html#1ddcb92ade31c8fbd370001f9b29a7d9">format</a> &amp; <a class="code" href="frame_8h.html#1d77bc03d9b7e7ec73ac3d49ff1d0360">AST_FORMAT_VIDEO_MASK</a>;
<a name="l03072"></a>03072    <span class="keywordtype">int</span> textformat = <a class="code" href="chan__alsa_8c.html#1ddcb92ade31c8fbd370001f9b29a7d9">format</a> &amp; <a class="code" href="frame_8h.html#dd3aa8954987a10a8e400f853cda70b8">AST_FORMAT_TEXT_MASK</a>;
<a name="l03073"></a>03073 
<a name="l03074"></a>03074    <span class="keywordflow">if</span> (!cause)
<a name="l03075"></a>03075       cause = &amp;foo;
<a name="l03076"></a>03076    *cause = <a class="code" href="causes_8h.html#26616baee17891fc7244df139b296b4d">AST_CAUSE_NOTDEFINED</a>;
<a name="l03077"></a>03077 
<a name="l03078"></a>03078    <span class="keywordflow">if</span> (<a class="code" href="linkedlists_8h.html#44d46016bec4f7c50450973666ce638d">AST_LIST_LOCK</a>(&amp;channels)) {
<a name="l03079"></a>03079       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Unable to lock channel list\n"</span>);
<a name="l03080"></a>03080       <span class="keywordflow">return</span> NULL;
<a name="l03081"></a>03081    }
<a name="l03082"></a>03082 
<a name="l03083"></a>03083    <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;backends, chan, list) {
<a name="l03084"></a>03084       <span class="keywordflow">if</span> (strcasecmp(<a class="code" href="rtp_8c.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, chan-&gt;<a class="code" href="structchanlist.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>))
<a name="l03085"></a>03085          <span class="keywordflow">continue</span>;
<a name="l03086"></a>03086 
<a name="l03087"></a>03087       capabilities = chan-&gt;<a class="code" href="structchanlist.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#f7b11037f2050959293aafb493b7653c">capabilities</a>;
<a name="l03088"></a>03088       fmt = <a class="code" href="chan__alsa_8c.html#1ddcb92ade31c8fbd370001f9b29a7d9">format</a> &amp; <a class="code" href="frame_8h.html#71a0a9732267760506de172c34d7a625">AST_FORMAT_AUDIO_MASK</a>;
<a name="l03089"></a>03089       res = <a class="code" href="translate_8c.html#e244e18a275707185dba3f62a32a6eca">ast_translator_best_choice</a>(&amp;fmt, &amp;capabilities);
<a name="l03090"></a>03090       <span class="keywordflow">if</span> (res &lt; 0) {
<a name="l03091"></a>03091          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"No translator path exists for channel type %s (native %d) to %d\n"</span>, <a class="code" href="rtp_8c.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, chan-&gt;<a class="code" href="structchanlist.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#f7b11037f2050959293aafb493b7653c">capabilities</a>, <a class="code" href="chan__alsa_8c.html#1ddcb92ade31c8fbd370001f9b29a7d9">format</a>);
<a name="l03092"></a>03092          *cause = <a class="code" href="causes_8h.html#541f6970916b30e7429bb6c1fce86d1d">AST_CAUSE_BEARERCAPABILITY_NOTAVAIL</a>;
<a name="l03093"></a>03093          <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;channels);
<a name="l03094"></a>03094          <span class="keywordflow">return</span> NULL;
<a name="l03095"></a>03095       }
<a name="l03096"></a>03096       <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;channels);
<a name="l03097"></a>03097       <span class="keywordflow">if</span> (!chan-&gt;<a class="code" href="structchanlist.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#19015c7009167d3f93d33c1c1e5fe0f7">requester</a>)
<a name="l03098"></a>03098          <span class="keywordflow">return</span> NULL;
<a name="l03099"></a>03099       
<a name="l03100"></a>03100       <span class="keywordflow">if</span> (!(c = chan-&gt;<a class="code" href="structchanlist.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#19015c7009167d3f93d33c1c1e5fe0f7">requester</a>(<a class="code" href="rtp_8c.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, capabilities | videoformat | textformat, <a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a>, cause)))
<a name="l03101"></a>03101          <span class="keywordflow">return</span> NULL;
<a name="l03102"></a>03102       
<a name="l03103"></a>03103       <span class="comment">/* no need to generate a Newchannel event here; it is done in the channel_alloc call */</span>
<a name="l03104"></a>03104       <span class="keywordflow">return</span> c;
<a name="l03105"></a>03105    }
<a name="l03106"></a>03106 
<a name="l03107"></a>03107    <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"No channel type registered for '%s'\n"</span>, <a class="code" href="rtp_8c.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>);
<a name="l03108"></a>03108    *cause = <a class="code" href="causes_8h.html#bffef2c3175892d112f3522e10ec08b1">AST_CAUSE_NOSUCHDRIVER</a>;
<a name="l03109"></a>03109    <a class="code" href="linkedlists_8h.html#1829cc3d91ee394b65b7379f68ab3dad">AST_LIST_UNLOCK</a>(&amp;channels);
<a name="l03110"></a>03110 
<a name="l03111"></a>03111    <span class="keywordflow">return</span> NULL;
<a name="l03112"></a>03112 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="951f5f530d12c122c81bf1be5f69ba58"></a><!-- doxytag: member="channel.h::ast_request_and_dial" ref="951f5f530d12c122c81bf1be5f69ba58" args="(const char *type, int format, void *data, int timeout, int *reason, const char *cidnum, const char *cidname)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a>* ast_request_and_dial           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>timeout</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>reason</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cidnum</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cidname</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Request a channel of a given type, with data as optional information used by the low level module and attempt to place a call on it. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>type</em>&nbsp;</td><td>type of channel to request </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>format</em>&nbsp;</td><td>requested channel format </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>data to pass to the channel requester </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeout</em>&nbsp;</td><td>maximum amount of time to wait for an answer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>reason</em>&nbsp;</td><td>why unsuccessful (if unsuccessful) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cidnum</em>&nbsp;</td><td>Caller-ID Number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cidname</em>&nbsp;</td><td>Caller-ID Name </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns an <a class="el" href="structast__channel.html">ast_channel</a> on success or no answer, NULL on failure. Check the value of chan-&gt;_state to know if the call was answered or not. </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l03058">3058</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04991">ast_pbx_outgoing_exten()</a>.<div class="fragment"><pre class="fragment"><a name="l03059"></a>03059 {
<a name="l03060"></a>03060    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#8537f62a5cf4153cbafae491fb365303">__ast_request_and_dial</a>(<a class="code" href="rtp_8c.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, <a class="code" href="chan__alsa_8c.html#1ddcb92ade31c8fbd370001f9b29a7d9">format</a>, <a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a>, timeout, outstate, cidnum, cidname, NULL);
<a name="l03061"></a>03061 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="24a36b04429e3cdef17e161363c13900"></a><!-- doxytag: member="channel.h::ast_safe_sleep" ref="24a36b04429e3cdef17e161363c13900" args="(struct ast_channel *chan, int ms)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_safe_sleep           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>ms</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Wait for a specified amount of time, looking for hangups. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to wait for </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ms</em>&nbsp;</td><td>length of time in milliseconds to sleep Waits for a specified amount of time, servicing the channel as required. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>returns -1 on hangup, otherwise 0. </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01048">1048</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l01027">ast_safe_sleep_conditional()</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l01682">__ast_answer()</a>, <a class="el" href="chan__agent_8c-source.html#l01763">__login_exec()</a>, <a class="el" href="res__adsi_8c-source.html#l00370">_ast_adsi_transmit_message_full()</a>, <a class="el" href="app__alarmreceiver_8c-source.html#l00635">alarmreceiver_exec()</a>, <a class="el" href="app_8c-source.html#l00236">ast_dtmf_stream()</a>, <a class="el" href="channel_8c-source.html#l02621">ast_senddigit()</a>, <a class="el" href="res__features_8c-source.html#l00776">builtin_atxfer()</a>, <a class="el" href="res__features_8c-source.html#l00529">builtin_parkcall()</a>, <a class="el" href="app__dictate_8c-source.html#l00079">dictate_exec()</a>, <a class="el" href="app__flash_8c-source.html#l00072">flash_exec()</a>, <a class="el" href="app__rpt_8c-source.html#l02757">function_ilink()</a>, <a class="el" href="app__rpt_8c-source.html#l04577">function_remote()</a>, <a class="el" href="app__rpt_8c-source.html#l05320">handle_remote_data()</a>, <a class="el" href="app__rpt_8c-source.html#l05353">handle_remote_phone_dtmf()</a>, <a class="el" href="app__milliwatt_8c-source.html#l00113">milliwatt_exec()</a>, <a class="el" href="res__musiconhold_8c-source.html#l00605">moh0_exec()</a>, <a class="el" href="res__musiconhold_8c-source.html#l00616">moh1_exec()</a>, <a class="el" href="res__features_8c-source.html#l01938">park_call_exec()</a>, <a class="el" href="pbx_8c-source.html#l05568">pbx_builtin_wait()</a>, <a class="el" href="app__rpt_8c-source.html#l01435">play_tone_pair()</a>, <a class="el" href="app__morsecode_8c-source.html#l00100">playtone()</a>, <a class="el" href="app__privacy_8c-source.html#l00078">privacy_exec()</a>, <a class="el" href="app__alarmreceiver_8c-source.html#l00448">receive_ademco_contact_id()</a>, <a class="el" href="app__rpt_8c-source.html#l04515">rmt_telem_start()</a>, <a class="el" href="app__rpt_8c-source.html#l02483">rpt_call()</a>, <a class="el" href="app__rpt_8c-source.html#l06759">rpt_exec()</a>, <a class="el" href="app__rpt_8c-source.html#l01461">send_morse()</a>, <a class="el" href="app__rpt_8c-source.html#l01622">send_tone_telemetry()</a>, <a class="el" href="chan__skinny_8c-source.html#l02365">skinny_ss()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, <a class="el" href="app__test_8c-source.html#l00131">testclient_exec()</a>, <a class="el" href="app__test_8c-source.html#l00322">testserver_exec()</a>, <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>, <a class="el" href="pbx_8c-source.html#l05351">wait_for_hangup()</a>, <a class="el" href="app__rpt_8c-source.html#l01846">wait_interval()</a>, and <a class="el" href="app__zapateller_8c-source.html#l00059">zapateller_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l01049"></a>01049 {
<a name="l01050"></a>01050    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#2f6cb4adec26f68897163438dc02f2c7">ast_safe_sleep_conditional</a>(chan, ms, NULL, NULL);
<a name="l01051"></a>01051 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2f6cb4adec26f68897163438dc02f2c7"></a><!-- doxytag: member="channel.h::ast_safe_sleep_conditional" ref="2f6cb4adec26f68897163438dc02f2c7" args="(struct ast_channel *chan, int ms, int(*cond)(void *), void *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_safe_sleep_conditional           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>ms</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int(*)(void *)&nbsp;</td>
          <td class="mdname" nowrap> <em>cond</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Wait for a specified amount of time, looking for hangups and a condition argument. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to wait for </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ms</em>&nbsp;</td><td>length of time in milliseconds to sleep </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cond</em>&nbsp;</td><td>a function pointer for testing continue condition </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>argument to be passed to the condition test function </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>returns -1 on hangup, otherwise 0. Waits for a specified amount of time, servicing the channel as required. If cond returns 0, this function returns. </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01027">1027</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="frame_8h-source.html#l00396">ast_frfree()</a>, <a class="el" href="channel_8c-source.html#l02438">ast_read()</a>, <a class="el" href="channel_8c-source.html#l01952">ast_waitfor()</a>, and <a class="el" href="format__g726_8c-source.html#l00193">f</a>.
<p>
Referenced by <a class="el" href="chan__agent_8c-source.html#l01763">__login_exec()</a>, and <a class="el" href="channel_8c-source.html#l01048">ast_safe_sleep()</a>.<div class="fragment"><pre class="fragment"><a name="l01028"></a>01028 {
<a name="l01029"></a>01029    <span class="keyword">struct </span><a class="code" href="structast__frame.html">ast_frame</a> *<a class="code" href="format__g726_8c.html#85b9b17a7dd34a3638c560bc9152473b">f</a>;
<a name="l01030"></a>01030 
<a name="l01031"></a>01031    <span class="keywordflow">while</span> (ms &gt; 0) {
<a name="l01032"></a>01032       <span class="keywordflow">if</span> (<a class="code" href="event_8c.html#26542fb18a8b14c9775aa475f23c909f">cond</a> &amp;&amp; ((*<a class="code" href="event_8c.html#26542fb18a8b14c9775aa475f23c909f">cond</a>)(<a class="code" href="structast__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a>) == 0))
<a name="l01033"></a>01033          <span class="keywordflow">return</span> 0;
<a name="l01034"></a>01034       ms = <a class="code" href="channel_8c.html#e02dcdf40023f275d4561a930e7a7fc9">ast_waitfor</a>(chan, ms);
<a name="l01035"></a>01035       <span class="keywordflow">if</span> (ms &lt; 0)
<a name="l01036"></a>01036          <span class="keywordflow">return</span> -1;
<a name="l01037"></a>01037       <span class="keywordflow">if</span> (ms &gt; 0) {
<a name="l01038"></a>01038          f = <a class="code" href="channel_8c.html#1446a8c0bddf626bf26b000fbeae117f">ast_read</a>(chan);
<a name="l01039"></a>01039          <span class="keywordflow">if</span> (!f)
<a name="l01040"></a>01040             <span class="keywordflow">return</span> -1;
<a name="l01041"></a>01041          <a class="code" href="frame_8h.html#506c759ec4950e7f7465e8f090a6252b">ast_frfree</a>(f);
<a name="l01042"></a>01042       }
<a name="l01043"></a>01043    }
<a name="l01044"></a>01044    <span class="keywordflow">return</span> 0;
<a name="l01045"></a>01045 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d611a8ad6ce8c46f46f564095af0f264"></a><!-- doxytag: member="channel.h::ast_select" ref="d611a8ad6ce8c46f46f564095af0f264" args="(int nfds, fd_set *rfds, fd_set *wfds, fd_set *efds, struct timeval *tvp)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static int ast_select           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>nfds</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>fd_set *&nbsp;</td>
          <td class="mdname" nowrap> <em>rfds</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>fd_set *&nbsp;</td>
          <td class="mdname" nowrap> <em>wfds</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>fd_set *&nbsp;</td>
          <td class="mdname" nowrap> <em>efds</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct timeval *&nbsp;</td>
          <td class="mdname" nowrap> <em>tvp</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [inline, static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Waits for activity on a group of channels. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>nfds</em>&nbsp;</td><td>the maximum number of file descriptors in the sets </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rfds</em>&nbsp;</td><td>file descriptors to check for read availability </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>wfds</em>&nbsp;</td><td>file descriptors to check for write availability </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>efds</em>&nbsp;</td><td>file descriptors to check for exceptions (OOB data) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tvp</em>&nbsp;</td><td>timeout while waiting for events This is the same as a standard select(), except it guarantees the behaviour where the passed struct timeval is updated with how much time was not slept while waiting for the specified events </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="channel_8h-source.html#l01355">1355</a> of file <a class="el" href="channel_8h-source.html">channel.h</a>.
<p>
Referenced by <a class="el" href="chan__phone_8c-source.html#l01034">do_monitor()</a>, <a class="el" href="res__features_8c-source.html#l01761">do_parking_thread()</a>, and <a class="el" href="chan__alsa_8c-source.html#l00276">sound_thread()</a>.<div class="fragment"><pre class="fragment"><a name="l01356"></a>01356 {
<a name="l01357"></a>01357 <span class="preprocessor">#ifdef __linux__</span>
<a name="l01358"></a>01358 <span class="preprocessor"></span>   <span class="keywordflow">return</span> select(nfds, rfds, wfds, efds, tvp);
<a name="l01359"></a>01359 <span class="preprocessor">#else</span>
<a name="l01360"></a>01360 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (tvp) {
<a name="l01361"></a>01361       <span class="keyword">struct </span>timeval tv, tvstart, tvend, tvlen;
<a name="l01362"></a>01362       <span class="keywordtype">int</span> res;
<a name="l01363"></a>01363 
<a name="l01364"></a>01364       tv = *tvp;
<a name="l01365"></a>01365       gettimeofday(&amp;tvstart, NULL);
<a name="l01366"></a>01366       res = select(nfds, rfds, wfds, efds, tvp);
<a name="l01367"></a>01367       gettimeofday(&amp;tvend, NULL);
<a name="l01368"></a>01368       timersub(&amp;tvend, &amp;tvstart, &amp;tvlen);
<a name="l01369"></a>01369       timersub(&amp;tv, &amp;tvlen, tvp);
<a name="l01370"></a>01370       <span class="keywordflow">if</span> (tvp-&gt;tv_sec &lt; 0 || (tvp-&gt;tv_sec == 0 &amp;&amp; tvp-&gt;tv_usec &lt; 0)) {
<a name="l01371"></a>01371          tvp-&gt;tv_sec = 0;
<a name="l01372"></a>01372          tvp-&gt;tv_usec = 0;
<a name="l01373"></a>01373       }
<a name="l01374"></a>01374       <span class="keywordflow">return</span> res;
<a name="l01375"></a>01375    }
<a name="l01376"></a>01376    <span class="keywordflow">else</span>
<a name="l01377"></a>01377       <span class="keywordflow">return</span> select(nfds, rfds, wfds, efds, NULL);
<a name="l01378"></a>01378 <span class="preprocessor">#endif</span>
<a name="l01379"></a>01379 <span class="preprocessor"></span>}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2f720daf878ec71dc8eed814c5128fe1"></a><!-- doxytag: member="channel.h::ast_senddigit" ref="2f720daf878ec71dc8eed814c5128fe1" args="(struct ast_channel *chan, char digit)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_senddigit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char&nbsp;</td>
          <td class="mdname" nowrap> <em>digit</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Send a DTMF digit to a channel Send a DTMF digit to a channel. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to act upon </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>digit</em>&nbsp;</td><td>the DTMF digit to send, encoded in ASCII </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns 0 on success, -1 on failure </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l02621">2621</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l01048">ast_safe_sleep()</a>, <a class="el" href="channel_8c-source.html#l02562">ast_senddigit_begin()</a>, <a class="el" href="channel_8c-source.html#l02608">ast_senddigit_end()</a>, <a class="el" href="structast__channel__tech.html#6ae7eea3e6476134e4193e09abb5dff3">ast_channel_tech::send_digit_begin</a>, and <a class="el" href="channel_8h-source.html#l00385">ast_channel::tech</a>.
<p>
Referenced by <a class="el" href="app_8c-source.html#l00236">ast_dtmf_stream()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, and <a class="el" href="app__senddtmf_8c-source.html#l00097">manager_play_dtmf()</a>.<div class="fragment"><pre class="fragment"><a name="l02622"></a>02622 {
<a name="l02623"></a>02623    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#6ae7eea3e6476134e4193e09abb5dff3">send_digit_begin</a>) {
<a name="l02624"></a>02624       <a class="code" href="channel_8c.html#2fef33f939432bce542a9ccb28145652">ast_senddigit_begin</a>(chan, digit);
<a name="l02625"></a>02625       <a class="code" href="channel_8c.html#24a36b04429e3cdef17e161363c13900">ast_safe_sleep</a>(chan, 100); <span class="comment">/* XXX 100ms ... probably should be configurable */</span>
<a name="l02626"></a>02626    }
<a name="l02627"></a>02627    
<a name="l02628"></a>02628    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#90ad873bd7f75ca212db0ab089def9f6">ast_senddigit_end</a>(chan, digit, 100);
<a name="l02629"></a>02629 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2fef33f939432bce542a9ccb28145652"></a><!-- doxytag: member="channel.h::ast_senddigit_begin" ref="2fef33f939432bce542a9ccb28145652" args="(struct ast_channel *chan, char digit)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_senddigit_begin           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char&nbsp;</td>
          <td class="mdname" nowrap> <em>digit</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Send a DTMF digit to a channel Send a DTMF digit to a channel. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to act upon </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>digit</em>&nbsp;</td><td>the DTMF digit to send, encoded in ASCII </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns 0 on success, -1 on failure </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l02562">2562</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="indications_8c-source.html#l00220">ast_playtones_start()</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="structast__channel__tech.html#6ae7eea3e6476134e4193e09abb5dff3">ast_channel_tech::send_digit_begin</a>, and <a class="el" href="channel_8h-source.html#l00385">ast_channel::tech</a>.
<p>
Referenced by <a class="el" href="chan__agent_8c-source.html#l00604">agent_digit_begin()</a>, <a class="el" href="channel_8c-source.html#l02621">ast_senddigit()</a>, <a class="el" href="channel_8c-source.html#l02660">ast_write()</a>, and <a class="el" href="chan__features_8c-source.html#l00303">features_digit_begin()</a>.<div class="fragment"><pre class="fragment"><a name="l02563"></a>02563 {
<a name="l02564"></a>02564    <span class="comment">/* Device does not support DTMF tones, lets fake</span>
<a name="l02565"></a>02565 <span class="comment">    * it by doing our own generation. */</span>
<a name="l02566"></a>02566    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* dtmf_tones[] = {
<a name="l02567"></a>02567       <span class="stringliteral">"941+1336"</span>, <span class="comment">/* 0 */</span>
<a name="l02568"></a>02568       <span class="stringliteral">"697+1209"</span>, <span class="comment">/* 1 */</span>
<a name="l02569"></a>02569       <span class="stringliteral">"697+1336"</span>, <span class="comment">/* 2 */</span>
<a name="l02570"></a>02570       <span class="stringliteral">"697+1477"</span>, <span class="comment">/* 3 */</span>
<a name="l02571"></a>02571       <span class="stringliteral">"770+1209"</span>, <span class="comment">/* 4 */</span>
<a name="l02572"></a>02572       <span class="stringliteral">"770+1336"</span>, <span class="comment">/* 5 */</span>
<a name="l02573"></a>02573       <span class="stringliteral">"770+1477"</span>, <span class="comment">/* 6 */</span>
<a name="l02574"></a>02574       <span class="stringliteral">"852+1209"</span>, <span class="comment">/* 7 */</span>
<a name="l02575"></a>02575       <span class="stringliteral">"852+1336"</span>, <span class="comment">/* 8 */</span>
<a name="l02576"></a>02576       <span class="stringliteral">"852+1477"</span>, <span class="comment">/* 9 */</span>
<a name="l02577"></a>02577       <span class="stringliteral">"697+1633"</span>, <span class="comment">/* A */</span>
<a name="l02578"></a>02578       <span class="stringliteral">"770+1633"</span>, <span class="comment">/* B */</span>
<a name="l02579"></a>02579       <span class="stringliteral">"852+1633"</span>, <span class="comment">/* C */</span>
<a name="l02580"></a>02580       <span class="stringliteral">"941+1633"</span>, <span class="comment">/* D */</span>
<a name="l02581"></a>02581       <span class="stringliteral">"941+1209"</span>, <span class="comment">/* * */</span>
<a name="l02582"></a>02582       <span class="stringliteral">"941+1477"</span>  <span class="comment">/* # */</span>
<a name="l02583"></a>02583    };
<a name="l02584"></a>02584 
<a name="l02585"></a>02585    <span class="keywordflow">if</span> (!chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#6ae7eea3e6476134e4193e09abb5dff3">send_digit_begin</a>)
<a name="l02586"></a>02586       <span class="keywordflow">return</span> 0;
<a name="l02587"></a>02587 
<a name="l02588"></a>02588    <span class="keywordflow">if</span> (!chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#6ae7eea3e6476134e4193e09abb5dff3">send_digit_begin</a>(chan, digit))
<a name="l02589"></a>02589       <span class="keywordflow">return</span> 0;
<a name="l02590"></a>02590 
<a name="l02591"></a>02591    <span class="keywordflow">if</span> (digit &gt;= <span class="charliteral">'0'</span> &amp;&amp; digit &lt;=<span class="charliteral">'9'</span>)
<a name="l02592"></a>02592       <a class="code" href="indications_8c.html#aa5c984fda65782cd8ea1dd4101a15c3">ast_playtones_start</a>(chan, 0, dtmf_tones[digit-<span class="charliteral">'0'</span>], 0);
<a name="l02593"></a>02593    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (digit &gt;= <span class="charliteral">'A'</span> &amp;&amp; digit &lt;= <span class="charliteral">'D'</span>)
<a name="l02594"></a>02594       <a class="code" href="indications_8c.html#aa5c984fda65782cd8ea1dd4101a15c3">ast_playtones_start</a>(chan, 0, dtmf_tones[digit-<span class="charliteral">'A'</span>+10], 0);
<a name="l02595"></a>02595    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (digit == <span class="charliteral">'*'</span>)
<a name="l02596"></a>02596       <a class="code" href="indications_8c.html#aa5c984fda65782cd8ea1dd4101a15c3">ast_playtones_start</a>(chan, 0, dtmf_tones[14], 0);
<a name="l02597"></a>02597    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (digit == <span class="charliteral">'#'</span>)
<a name="l02598"></a>02598       <a class="code" href="indications_8c.html#aa5c984fda65782cd8ea1dd4101a15c3">ast_playtones_start</a>(chan, 0, dtmf_tones[15], 0);
<a name="l02599"></a>02599    <span class="keywordflow">else</span> {
<a name="l02600"></a>02600       <span class="comment">/* not handled */</span>
<a name="l02601"></a>02601       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l02602"></a>02602          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Unable to generate DTMF tone '%c' for '%s'\n"</span>, digit, chan-&gt;name);
<a name="l02603"></a>02603    }
<a name="l02604"></a>02604 
<a name="l02605"></a>02605    <span class="keywordflow">return</span> 0;
<a name="l02606"></a>02606 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="90ad873bd7f75ca212db0ab089def9f6"></a><!-- doxytag: member="channel.h::ast_senddigit_end" ref="90ad873bd7f75ca212db0ab089def9f6" args="(struct ast_channel *chan, char digit, unsigned int duration)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_senddigit_end           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char&nbsp;</td>
          <td class="mdname" nowrap> <em>digit</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>duration</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Send a DTMF digit to a channel. 
<p>
Send a DTMF digit to a channel. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to act upon </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>digit</em>&nbsp;</td><td>the DTMF digit to send, encoded in ASCII </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>duration</em>&nbsp;</td><td>the duration of the digit ending in ms </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns 0 on success, -1 on failure </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l02608">2608</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="indications_8c-source.html#l00333">ast_playtones_stop()</a>, <a class="el" href="channel_8h-source.html#l00404">ast_channel::generator</a>, <a class="el" href="structast__channel__tech.html#761141281062bdfd42f6bab526b73892">ast_channel_tech::send_digit_end</a>, and <a class="el" href="channel_8h-source.html#l00385">ast_channel::tech</a>.
<p>
Referenced by <a class="el" href="chan__agent_8c-source.html#l00613">agent_digit_end()</a>, <a class="el" href="channel_8c-source.html#l02621">ast_senddigit()</a>, <a class="el" href="channel_8c-source.html#l02660">ast_write()</a>, and <a class="el" href="chan__features_8c-source.html#l00319">features_digit_end()</a>.<div class="fragment"><pre class="fragment"><a name="l02609"></a>02609 {
<a name="l02610"></a>02610    <span class="keywordtype">int</span> res = -1;
<a name="l02611"></a>02611 
<a name="l02612"></a>02612    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#761141281062bdfd42f6bab526b73892">send_digit_end</a>)
<a name="l02613"></a>02613       res = chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#761141281062bdfd42f6bab526b73892">send_digit_end</a>(chan, digit, duration);
<a name="l02614"></a>02614 
<a name="l02615"></a>02615    <span class="keywordflow">if</span> (res &amp;&amp; chan-&gt;<a class="code" href="structast__channel.html#dac9630aec642a428cd73f4be0a03569">generator</a>)
<a name="l02616"></a>02616       <a class="code" href="indications_8c.html#58be04c13701ac7140bfeec76ba55ce9">ast_playtones_stop</a>(chan);
<a name="l02617"></a>02617    
<a name="l02618"></a>02618    <span class="keywordflow">return</span> 0;
<a name="l02619"></a>02619 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3274faaaeb7a5646df6beead26f9ce8f"></a><!-- doxytag: member="channel.h::ast_sendtext" ref="3274faaaeb7a5646df6beead26f9ce8f" args="(struct ast_channel *chan, const char *text)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_sendtext           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>text</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends text to a channel Write text to a display on a channel. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to act upon </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>text</em>&nbsp;</td><td>string of text to send on the channel </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns 0 on success, -1 on failure </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l02549">2549</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l00325">ast_check_hangup()</a>, <a class="el" href="utils_8h-source.html#l00081">ast_clear_flag</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="channel_8h-source.html#l01387">CHECK_BLOCKING</a>, <a class="el" href="structast__channel__tech.html#fd5ce4dd24c70a0d6226a30b49fcf84b">ast_channel_tech::send_text</a>, and <a class="el" href="channel_8h-source.html#l00385">ast_channel::tech</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l01681">action_sendtext()</a>, <a class="el" href="chan__agent_8c-source.html#l00540">agent_sendtext()</a>, <a class="el" href="res__agi_8c-source.html#l00433">handle_sendtext()</a>, and <a class="el" href="app__sendtext_8c-source.html#l00067">sendtext_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l02550"></a>02550 {
<a name="l02551"></a>02551    <span class="keywordtype">int</span> res = 0;
<a name="l02552"></a>02552    <span class="comment">/* Stop if we're a zombie or need a soft hangup */</span>
<a name="l02553"></a>02553    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>) || <a class="code" href="channel_8c.html#042e64a8d465783855a52ec8c56a9373">ast_check_hangup</a>(chan))
<a name="l02554"></a>02554       <span class="keywordflow">return</span> -1;
<a name="l02555"></a>02555    <a class="code" href="channel_8h.html#722e76a74a7a5f5eb3efcd3cf30e7772">CHECK_BLOCKING</a>(chan);
<a name="l02556"></a>02556    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#fd5ce4dd24c70a0d6226a30b49fcf84b">send_text</a>)
<a name="l02557"></a>02557       res = chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#fd5ce4dd24c70a0d6226a30b49fcf84b">send_text</a>(chan, <a class="code" href="app__queue_8c.html#1cb251ec0d568de6a929b520c4aed8d1">text</a>);
<a name="l02558"></a>02558    <a class="code" href="utils_8h.html#c2399a33be6ffb658bcf7c6a35531732">ast_clear_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>);
<a name="l02559"></a>02559    <span class="keywordflow">return</span> res;
<a name="l02560"></a>02560 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2a53bdcc725eb9e81eb4a666ff695873"></a><!-- doxytag: member="channel.h::ast_set_callerid" ref="2a53bdcc725eb9e81eb4a666ff695873" args="(struct ast_channel *chan, const char *cidnum, const char *cidname, const char *ani)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_set_callerid           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cidnum</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cidname</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>ani</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l03694">3694</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="cdr_8c-source.html#l00754">ast_cdr_setcid()</a>, <a class="el" href="callerid_8c-source.html#l01078">ast_describe_caller_presentation()</a>, <a class="el" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, <a class="el" href="channel_8h-source.html#l00437">ast_channel::cid</a>, <a class="el" href="channel_8h-source.html#l00214">ast_callerid::cid_ani</a>, <a class="el" href="channel_8h-source.html#l00213">ast_callerid::cid_name</a>, <a class="el" href="channel_8h-source.html#l00212">ast_callerid::cid_num</a>, <a class="el" href="channel_8h-source.html#l00216">ast_callerid::cid_pres</a>, <a class="el" href="manager_8h-source.html#l00052">EVENT_FLAG_CALL</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="manager_8h-source.html#l00163">manager_event</a>, and <a class="el" href="strings_8h-source.html#l00045">S_OR</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="chan__agent_8c-source.html#l00622">agent_call()</a>, <a class="el" href="res__features_8c-source.html#l01295">ast_feature_request_and_dial()</a>, <a class="el" href="func__callerid_8c-source.html#l00118">callerid_write()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="app__dial_8c-source.html#l00430">do_forward()</a>, <a class="el" href="app__followme_8c-source.html#l00763">findmeexec()</a>, <a class="el" href="res__agi_8c-source.html#l01134">handle_setcallerid()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02638">mgcp_ss()</a>, <a class="el" href="app__privacy_8c-source.html#l00078">privacy_exec()</a>, <a class="el" href="app__rpt_8c-source.html#l06759">rpt_exec()</a>, <a class="el" href="chan__skinny_8c-source.html#l02342">skinny_newcall()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, and <a class="el" href="chan__zap_8c-source.html#l04906">zt_read()</a>.<div class="fragment"><pre class="fragment"><a name="l03695"></a>03695 {
<a name="l03696"></a>03696    <span class="keywordflow">if</span> (callerid) {
<a name="l03697"></a>03697       <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>)
<a name="l03698"></a>03698          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(chan-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>);
<a name="l03699"></a>03699       chan-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a> = <a class="code" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>(callerid);
<a name="l03700"></a>03700    }
<a name="l03701"></a>03701    <span class="keywordflow">if</span> (calleridname) {
<a name="l03702"></a>03702       <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#51ae63e8ccffb05b130f96cc397ec7b0">cid_name</a>)
<a name="l03703"></a>03703          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(chan-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#51ae63e8ccffb05b130f96cc397ec7b0">cid_name</a>);
<a name="l03704"></a>03704       chan-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#51ae63e8ccffb05b130f96cc397ec7b0">cid_name</a> = <a class="code" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>(calleridname);
<a name="l03705"></a>03705    }
<a name="l03706"></a>03706    <span class="keywordflow">if</span> (ani) {
<a name="l03707"></a>03707       <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#b38bd57df01e654d73ee2c204e0208d2">cid_ani</a>)
<a name="l03708"></a>03708          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(chan-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#b38bd57df01e654d73ee2c204e0208d2">cid_ani</a>);
<a name="l03709"></a>03709       chan-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#b38bd57df01e654d73ee2c204e0208d2">cid_ani</a> = <a class="code" href="utils_8h.html#d67aacdb581292a9d103cf349d0d2862">ast_strdup</a>(ani);
<a name="l03710"></a>03710    }
<a name="l03711"></a>03711    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>)
<a name="l03712"></a>03712       <a class="code" href="cdr_8c.html#845a92535bcaac4752ddee76f665e408">ast_cdr_setcid</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>, chan);
<a name="l03713"></a>03713    <a class="code" href="manager_8h.html#17a8c809d5b2d04cbb8969a209134c2b">manager_event</a>(<a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>, <span class="stringliteral">"Newcallerid"</span>,
<a name="l03714"></a>03714             <span class="stringliteral">"Channel: %s\r\n"</span>
<a name="l03715"></a>03715             <span class="stringliteral">"CallerIDNum: %s\r\n"</span>
<a name="l03716"></a>03716             <span class="stringliteral">"CallerIDName: %s\r\n"</span>
<a name="l03717"></a>03717             <span class="stringliteral">"Uniqueid: %s\r\n"</span>
<a name="l03718"></a>03718             <span class="stringliteral">"CID-CallingPres: %d (%s)\r\n"</span>,
<a name="l03719"></a>03719             chan-&gt;name,
<a name="l03720"></a>03720             <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(chan-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>, <span class="stringliteral">"&lt;Unknown&gt;"</span>),
<a name="l03721"></a>03721             <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(chan-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#51ae63e8ccffb05b130f96cc397ec7b0">cid_name</a>, <span class="stringliteral">"&lt;Unknown&gt;"</span>),
<a name="l03722"></a>03722             chan-&gt;uniqueid,
<a name="l03723"></a>03723             chan-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#872e42fb90e7d76ff7350f6741f567ff">cid_pres</a>,
<a name="l03724"></a>03724             <a class="code" href="callerid_8c.html#b5dfc57cf569e2ba434a743b1d53af4f">ast_describe_caller_presentation</a>(chan-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#872e42fb90e7d76ff7350f6741f567ff">cid_pres</a>)
<a name="l03725"></a>03725             );
<a name="l03726"></a>03726 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b1aa4e7fc4d8ab22cc83a6b164851c56"></a><!-- doxytag: member="channel.h::ast_set_read_format" ref="b1aa4e7fc4d8ab22cc83a6b164851c56" args="(struct ast_channel *chan, int format)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_set_read_format           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>format</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sets read format on channel chan Set read format for channel to whichever component of "format" is best. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to change </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>format</em>&nbsp;</td><td>format to change to </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns 0 on success, -1 on failure </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l02920">2920</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00481">ast_channel::rawreadformat</a>, <a class="el" href="channel_8h-source.html#l00477">ast_channel::readformat</a>, <a class="el" href="channel_8h-source.html#l00480">ast_channel::readtrans</a>, and <a class="el" href="channel_8c-source.html#l02867">set_format()</a>.
<p>
Referenced by <a class="el" href="app_8c-source.html#l00509">__ast_play_and_record()</a>, <a class="el" href="chan__agent_8c-source.html#l01763">__login_exec()</a>, <a class="el" href="chan__h323_8c-source.html#l00342">__oh323_update_info()</a>, <a class="el" href="res__adsi_8c-source.html#l00370">_ast_adsi_transmit_message_full()</a>, <a class="el" href="chan__agent_8c-source.html#l00622">agent_call()</a>, <a class="el" href="app__alarmreceiver_8c-source.html#l00635">alarmreceiver_exec()</a>, <a class="el" href="channel_8c-source.html#l03222">ast_channel_make_compatible_helper()</a>, <a class="el" href="channel_8c-source.html#l03406">ast_do_masquerade()</a>, <a class="el" href="app__rpt_8c-source.html#l05377">attempt_reconnect()</a>, <a class="el" href="app__talkdetect_8c-source.html#l00063">background_detect_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l00732">build_conf()</a>, <a class="el" href="app__meetme_8c-source.html#l01350">conf_run()</a>, <a class="el" href="app__dictate_8c-source.html#l00079">dictate_exec()</a>, <a class="el" href="app__disa_8c-source.html#l00113">disa_exec()</a>, <a class="el" href="app__waitforsilence_8c-source.html#l00078">do_waiting()</a>, <a class="el" href="res__agi_8c-source.html#l02108">eagi_exec()</a>, <a class="el" href="app__echo_8c-source.html#l00054">echo_exec()</a>, <a class="el" href="app__rpt_8c-source.html#l02757">function_ilink()</a>, <a class="el" href="chan__gtalk_8c-source.html#l01270">gtalk_rtp_read()</a>, <a class="el" href="res__agi_8c-source.html#l00889">handle_recordfile()</a>, <a class="el" href="app__ices_8c-source.html#l00104">ices_exec()</a>, <a class="el" href="app__amd_8c-source.html#l00097">isAnsweringMachine()</a>, <a class="el" href="chan__jingle_8c-source.html#l01079">jingle_rtp_read()</a>, <a class="el" href="app__test_8c-source.html#l00064">measurenoise()</a>, <a class="el" href="chan__mgcp_8c-source.html#l01218">mgcp_rtp_read()</a>, <a class="el" href="app__milliwatt_8c-source.html#l00113">milliwatt_exec()</a>, <a class="el" href="chan__h323_8c-source.html#l00763">oh323_rtp_read()</a>, <a class="el" href="chan__sip_8c-source.html#l05180">process_sdp()</a>, <a class="el" href="app__record_8c-source.html#l00078">record_exec()</a>, <a class="el" href="app__rpt_8c-source.html#l05604">rpt()</a>, <a class="el" href="app__rpt_8c-source.html#l06759">rpt_exec()</a>, <a class="el" href="chan__h323_8c-source.html#l01954">setup_rtp_connection()</a>, <a class="el" href="app__sms_8c-source.html#l01748">sms_exec()</a>, <a class="el" href="chan__iax2_8c-source.html#l06624">socket_process()</a>, <a class="el" href="app__speech__utils_8c-source.html#l00543">speech_background()</a>, and <a class="el" href="chan__features_8c-source.html#l00175">update_features()</a>.<div class="fragment"><pre class="fragment"><a name="l02921"></a>02921 {
<a name="l02922"></a>02922    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#18a87d054f2631c20245c5b935f0bf7d">set_format</a>(chan, <a class="code" href="manager_8h.html#7631454338ff70b1a6b1262f5f36beac">fmt</a>, &amp;chan-&gt;rawreadformat, &amp;chan-&gt;readformat,
<a name="l02923"></a>02923            &amp;chan-&gt;readtrans, 0);
<a name="l02924"></a>02924 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ee674fb53b907cc57dda6e54ac24a637"></a><!-- doxytag: member="channel.h::ast_set_variables" ref="ee674fb53b907cc57dda6e54ac24a637" args="(struct ast_channel *chan, struct ast_variable *vars)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_set_variables           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__variable.html">ast_variable</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>vars</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
adds a list of channel variables to a channel 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>the channel </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>vars</em>&nbsp;</td><td>a linked list of variables</td></tr>
  </table>
</dl>
Variable names can be for a regular channel variable or a dialplan function that has the ability to be written to. 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l04486">4486</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="config_8h-source.html#l00039">ast_variable::name</a>, <a class="el" href="config_8h-source.html#l00046">ast_variable::next</a>, <a class="el" href="pbx_8c-source.html#l05821">pbx_builtin_setvar_helper()</a>, and <a class="el" href="config_8h-source.html#l00040">ast_variable::value</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="pbx_8c-source.html#l05150">ast_pbx_outgoing_app()</a>, and <a class="el" href="pbx_8c-source.html#l04991">ast_pbx_outgoing_exten()</a>.<div class="fragment"><pre class="fragment"><a name="l04487"></a>04487 {
<a name="l04488"></a>04488    <span class="keyword">struct </span><a class="code" href="structast__variable.html">ast_variable</a> *cur;
<a name="l04489"></a>04489 
<a name="l04490"></a>04490    <span class="keywordflow">for</span> (cur = vars; cur; cur = cur-&gt;<a class="code" href="structast__variable.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>)
<a name="l04491"></a>04491       <a class="code" href="pbx_8c.html#64407c916a2de6ae3f0efeca471c1b1d">pbx_builtin_setvar_helper</a>(chan, cur-&gt;<a class="code" href="structast__variable.html#b068931cc450442b63f5b3d276ea4297">name</a>, cur-&gt;<a class="code" href="structast__variable.html#2063c1608d6e0baf80249c42e2be5804">value</a>);  
<a name="l04492"></a>04492 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="56370d56599555d0f1abde0d1d9685a6"></a><!-- doxytag: member="channel.h::ast_set_write_format" ref="56370d56599555d0f1abde0d1d9685a6" args="(struct ast_channel *chan, int format)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_set_write_format           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>format</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sets write format on channel chan Set write format for channel to whichever component of "format" is best. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to change </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>format</em>&nbsp;</td><td>new format for writing </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns 0 on success, -1 on failure </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l02926">2926</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00482">ast_channel::rawwriteformat</a>, <a class="el" href="channel_8c-source.html#l02867">set_format()</a>, <a class="el" href="channel_8h-source.html#l00478">ast_channel::writeformat</a>, and <a class="el" href="channel_8h-source.html#l00479">ast_channel::writetrans</a>.
<p>
Referenced by <a class="el" href="chan__agent_8c-source.html#l01763">__login_exec()</a>, <a class="el" href="chan__h323_8c-source.html#l00342">__oh323_update_info()</a>, <a class="el" href="res__adsi_8c-source.html#l00370">_ast_adsi_transmit_message_full()</a>, <a class="el" href="chan__agent_8c-source.html#l00622">agent_call()</a>, <a class="el" href="app__alarmreceiver_8c-source.html#l00635">alarmreceiver_exec()</a>, <a class="el" href="channel_8c-source.html#l03222">ast_channel_make_compatible_helper()</a>, <a class="el" href="channel_8c-source.html#l04654">ast_channel_start_silence_generator()</a>, <a class="el" href="channel_8c-source.html#l04678">ast_channel_stop_silence_generator()</a>, <a class="el" href="channel_8c-source.html#l04909">ast_channel_whisper_stop()</a>, <a class="el" href="channel_8c-source.html#l03406">ast_do_masquerade()</a>, <a class="el" href="file_8c-source.html#l00529">ast_openstream_full()</a>, <a class="el" href="file_8c-source.html#l00131">ast_stopstream()</a>, <a class="el" href="channel_8c-source.html#l02660">ast_write()</a>, <a class="el" href="app__rpt_8c-source.html#l05377">attempt_reconnect()</a>, <a class="el" href="app__meetme_8c-source.html#l00732">build_conf()</a>, <a class="el" href="app__chanspy_8c-source.html#l00266">channel_spy()</a>, <a class="el" href="app__chanspy_8c-source.html#l00626">chanspy_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l01350">conf_run()</a>, <a class="el" href="app__disa_8c-source.html#l00113">disa_exec()</a>, <a class="el" href="app__echo_8c-source.html#l00054">echo_exec()</a>, <a class="el" href="app__chanspy_8c-source.html#l00708">extenspy_exec()</a>, <a class="el" href="app__rpt_8c-source.html#l02757">function_ilink()</a>, <a class="el" href="chan__gtalk_8c-source.html#l01270">gtalk_rtp_read()</a>, <a class="el" href="chan__jingle_8c-source.html#l01079">jingle_rtp_read()</a>, <a class="el" href="app_8c-source.html#l00328">linear_alloc()</a>, <a class="el" href="app_8c-source.html#l00290">linear_release()</a>, <a class="el" href="chan__mgcp_8c-source.html#l01218">mgcp_rtp_read()</a>, <a class="el" href="app__milliwatt_8c-source.html#l00113">milliwatt_exec()</a>, <a class="el" href="res__musiconhold_8c-source.html#l00724">moh_alloc()</a>, <a class="el" href="res__musiconhold_8c-source.html#l00196">moh_files_release()</a>, <a class="el" href="res__musiconhold_8c-source.html#l00703">moh_release()</a>, <a class="el" href="app__mp3_8c-source.html#l00125">mp3_exec()</a>, <a class="el" href="app__nbscat_8c-source.html#l00116">NBScat_exec()</a>, <a class="el" href="chan__h323_8c-source.html#l00763">oh323_rtp_read()</a>, <a class="el" href="indications_8c-source.html#l00116">playtones_alloc()</a>, <a class="el" href="indications_8c-source.html#l00104">playtones_release()</a>, <a class="el" href="chan__sip_8c-source.html#l05180">process_sdp()</a>, <a class="el" href="app__rpt_8c-source.html#l05604">rpt()</a>, <a class="el" href="app__rpt_8c-source.html#l06759">rpt_exec()</a>, <a class="el" href="app__festival_8c-source.html#l00171">send_waveform_to_channel()</a>, <a class="el" href="chan__h323_8c-source.html#l01954">setup_rtp_connection()</a>, <a class="el" href="app__sms_8c-source.html#l01748">sms_exec()</a>, <a class="el" href="channel_8c-source.html#l04261">tonepair_alloc()</a>, <a class="el" href="channel_8c-source.html#l04252">tonepair_release()</a>, and <a class="el" href="chan__features_8c-source.html#l00175">update_features()</a>.<div class="fragment"><pre class="fragment"><a name="l02927"></a>02927 {
<a name="l02928"></a>02928    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#18a87d054f2631c20245c5b935f0bf7d">set_format</a>(chan, <a class="code" href="manager_8h.html#7631454338ff70b1a6b1262f5f36beac">fmt</a>, &amp;chan-&gt;rawwriteformat, &amp;chan-&gt;writeformat,
<a name="l02929"></a>02929            &amp;chan-&gt;writetrans, 1);
<a name="l02930"></a>02930 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4545ff02284db8d61db9c8cf01803b95"></a><!-- doxytag: member="channel.h::ast_setstate" ref="4545ff02284db8d61db9c8cf01803b95" args="(struct ast_channel *chan, enum ast_channel_state)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_setstate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>enum&nbsp;</td>
          <td class="mdname" nowrap> <em>ast_channel_state</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Change the state of a channel. 
<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l03728">3728</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00435">ast_channel::_state</a>, <a class="el" href="devicestate_8c-source.html#l00470">ast_device_state_changed_literal()</a>, <a class="el" href="channel_8c-source.html#l00523">ast_state2str()</a>, <a class="el" href="channel_8h-source.html#l00437">ast_channel::cid</a>, <a class="el" href="channel_8h-source.html#l00213">ast_callerid::cid_name</a>, <a class="el" href="channel_8h-source.html#l00212">ast_callerid::cid_num</a>, <a class="el" href="manager_8h-source.html#l00052">EVENT_FLAG_CALL</a>, <a class="el" href="manager_8h-source.html#l00163">manager_event</a>, and <a class="el" href="strings_8h-source.html#l00045">S_OR</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l01682">__ast_answer()</a>, <a class="el" href="channel_8c-source.html#l02060">__ast_read()</a>, <a class="el" href="chan__h323_8c-source.html#l00342">__oh323_update_info()</a>, <a class="el" href="chan__zap_8c-source.html#l04786">__zt_exception()</a>, <a class="el" href="chan__agent_8c-source.html#l00622">agent_call()</a>, <a class="el" href="chan__alsa_8c-source.html#l00562">alsa_answer()</a>, <a class="el" href="chan__agent_8c-source.html#l01153">check_availability()</a>, <a class="el" href="res__features_8c-source.html#l02147">do_bridge_masquerade()</a>, <a class="el" href="chan__gtalk_8c-source.html#l01474">gtalk_call()</a>, <a class="el" href="chan__gtalk_8c-source.html#l01070">gtalk_newcall()</a>, <a class="el" href="chan__sip_8c-source.html#l13936">handle_invite_replaces()</a>, <a class="el" href="chan__skinny_8c-source.html#l03385">handle_offhook_message()</a>, <a class="el" href="chan__sip_8c-source.html#l14098">handle_request_invite()</a>, <a class="el" href="chan__sip_8c-source.html#l12569">handle_response_invite()</a>, <a class="el" href="chan__skinny_8c-source.html#l03920">handle_soft_key_event_message()</a>, <a class="el" href="chan__skinny_8c-source.html#l03102">handle_stimulus_message()</a>, <a class="el" href="chan__iax2_8c-source.html#l02914">iax2_call()</a>, <a class="el" href="chan__jingle_8c-source.html#l01322">jingle_call()</a>, <a class="el" href="chan__jingle_8c-source.html#l00911">jingle_newcall()</a>, <a class="el" href="chan__mgcp_8c-source.html#l01189">mgcp_answer()</a>, <a class="el" href="chan__mgcp_8c-source.html#l00849">mgcp_call()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02638">mgcp_ss()</a>, <a class="el" href="chan__misdn_8c-source.html#l01948">misdn_call()</a>, <a class="el" href="chan__misdn_8c-source.html#l02246">misdn_indication()</a>, <a class="el" href="chan__nbs_8c-source.html#l00093">nbs_call()</a>, <a class="el" href="chan__nbs_8c-source.html#l00173">nbs_hangup()</a>, <a class="el" href="chan__h323_8c-source.html#l00673">oh323_answer()</a>, <a class="el" href="chan__oss_8c-source.html#l00844">oss_answer()</a>, <a class="el" href="pbx_8c-source.html#l05394">pbx_builtin_busy()</a>, <a class="el" href="pbx_8c-source.html#l05408">pbx_builtin_congestion()</a>, <a class="el" href="chan__phone_8c-source.html#l00464">phone_answer()</a>, <a class="el" href="chan__phone_8c-source.html#l00501">phone_exception()</a>, <a class="el" href="chan__phone_8c-source.html#l00345">phone_hangup()</a>, <a class="el" href="chan__phone_8c-source.html#l00663">phone_write()</a>, <a class="el" href="chan__misdn_8c-source.html#l03477">release_chan()</a>, <a class="el" href="chan__sip_8c-source.html#l03860">sip_answer()</a>, <a class="el" href="chan__skinny_8c-source.html#l02558">skinny_answer()</a>, <a class="el" href="chan__skinny_8c-source.html#l02460">skinny_call()</a>, <a class="el" href="chan__skinny_8c-source.html#l02342">skinny_newcall()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, <a class="el" href="chan__h323_8c-source.html#l01182">update_state()</a>, <a class="el" href="chan__zap_8c-source.html#l02976">zt_answer()</a>, <a class="el" href="chan__zap_8c-source.html#l01923">zt_call()</a>, <a class="el" href="chan__zap_8c-source.html#l03942">zt_handle_event()</a>, <a class="el" href="chan__zap_8c-source.html#l05309">zt_indicate()</a>, and <a class="el" href="chan__zap_8c-source.html#l04906">zt_read()</a>.<div class="fragment"><pre class="fragment"><a name="l03729"></a>03729 {
<a name="l03730"></a>03730    <span class="keywordtype">int</span> oldstate = chan-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a>;
<a name="l03731"></a>03731 
<a name="l03732"></a>03732    <span class="keywordflow">if</span> (oldstate == <a class="code" href="structstate.html">state</a>)
<a name="l03733"></a>03733       <span class="keywordflow">return</span> 0;
<a name="l03734"></a>03734 
<a name="l03735"></a>03735    chan-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a> = <a class="code" href="structstate.html">state</a>;
<a name="l03736"></a>03736    <a class="code" href="devicestate_8c.html#2416b5bb0bcab6392204637700a2d280">ast_device_state_changed_literal</a>(chan-&gt;name);
<a name="l03737"></a>03737    <span class="comment">/* setstate used to conditionally report Newchannel; this is no more */</span>
<a name="l03738"></a>03738    <a class="code" href="manager_8h.html#17a8c809d5b2d04cbb8969a209134c2b">manager_event</a>(<a class="code" href="manager_8h.html#c81a36aac6503176bd649993386b23e4">EVENT_FLAG_CALL</a>,
<a name="l03739"></a>03739             <span class="stringliteral">"Newstate"</span>,
<a name="l03740"></a>03740             <span class="stringliteral">"Channel: %s\r\n"</span>
<a name="l03741"></a>03741             <span class="stringliteral">"State: %s\r\n"</span>
<a name="l03742"></a>03742             <span class="stringliteral">"CallerIDNum: %s\r\n"</span>
<a name="l03743"></a>03743             <span class="stringliteral">"CallerIDName: %s\r\n"</span>
<a name="l03744"></a>03744             <span class="stringliteral">"Uniqueid: %s\r\n"</span>,
<a name="l03745"></a>03745             chan-&gt;name, <a class="code" href="channel_8c.html#1c242fd13329f5600ccd56263aba7272">ast_state2str</a>(chan-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a>),
<a name="l03746"></a>03746             <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(chan-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>, <span class="stringliteral">"&lt;unknown&gt;"</span>),
<a name="l03747"></a>03747             <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(chan-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#51ae63e8ccffb05b130f96cc397ec7b0">cid_name</a>, <span class="stringliteral">"&lt;unknown&gt;"</span>),
<a name="l03748"></a>03748             chan-&gt;uniqueid);
<a name="l03749"></a>03749 
<a name="l03750"></a>03750    <span class="keywordflow">return</span> 0;
<a name="l03751"></a>03751 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="031ef8a01f979ba2f40451d97a515e80"></a><!-- doxytag: member="channel.h::ast_settimeout" ref="031ef8a01f979ba2f40451d97a515e80" args="(struct ast_channel *c, int samples, int(*func)(void *data), void *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_settimeout           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>samples</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int(*)(void *data)&nbsp;</td>
          <td class="mdname" nowrap> <em>func</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01968">1968</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="channel_8h-source.html#l00433">ast_channel::timingdata</a>, <a class="el" href="channel_8h-source.html#l00431">ast_channel::timingfd</a>, and <a class="el" href="structast__channel.html#a576c60b7b1ab7e59be8ad75ecc55ef9">ast_channel::timingfunc</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l02060">__ast_read()</a>, <a class="el" href="channel_8c-source.html#l01764">ast_activate_generator()</a>, <a class="el" href="file_8c-source.html#l00701">ast_closestream()</a>, <a class="el" href="channel_8c-source.html#l01729">ast_deactivate_generator()</a>, and <a class="el" href="file_8c-source.html#l00609">ast_readaudio_callback()</a>.<div class="fragment"><pre class="fragment"><a name="l01969"></a>01969 {
<a name="l01970"></a>01970    <span class="keywordtype">int</span> res = -1;
<a name="l01971"></a>01971 <span class="preprocessor">#ifdef HAVE_ZAPTEL</span>
<a name="l01972"></a>01972 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structast__channel.html#4cd06d1a010b6a371149b4a0adb2f884">timingfd</a> &gt; -1) {
<a name="l01973"></a>01973       <span class="keywordflow">if</span> (!<a class="code" href="manager_8h.html#7df4935f4a5a2865191ef74f64df8754">func</a>) {
<a name="l01974"></a>01974          samples = 0;
<a name="l01975"></a>01975          data = 0;
<a name="l01976"></a>01976       }
<a name="l01977"></a>01977       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l01978"></a>01978          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Scheduling timer at %d sample intervals\n"</span>, samples);
<a name="l01979"></a>01979       res = ioctl(c-&gt;<a class="code" href="structast__channel.html#4cd06d1a010b6a371149b4a0adb2f884">timingfd</a>, ZT_TIMERCONFIG, &amp;samples);
<a name="l01980"></a>01980       c-&gt;<a class="code" href="structast__channel.html#a576c60b7b1ab7e59be8ad75ecc55ef9">timingfunc</a> = <a class="code" href="manager_8h.html#7df4935f4a5a2865191ef74f64df8754">func</a>;
<a name="l01981"></a>01981       c-&gt;<a class="code" href="structast__channel.html#3de60c1425f97e3ddc8b149272742e6d">timingdata</a> = data;
<a name="l01982"></a>01982    }
<a name="l01983"></a>01983 <span class="preprocessor">#endif   </span>
<a name="l01984"></a>01984 <span class="preprocessor"></span>   <span class="keywordflow">return</span> res;
<a name="l01985"></a>01985 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b9bab70de71305f125a80502da266866"></a><!-- doxytag: member="channel.h::ast_shutting_down" ref="b9bab70de71305f125a80502da266866" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_shutting_down           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns non-zero if Asterisk is being shut down. 
<p>
Returns non-zero if Asterisk is being shut down 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l00380">380</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l00098">shutting_down</a>.<div class="fragment"><pre class="fragment"><a name="l00381"></a>00381 {
<a name="l00382"></a>00382    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#3fda132ec997ca296e81601dde1daf98">shutting_down</a>;
<a name="l00383"></a>00383 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a1a142039194e9f6dfb632b28a0c5eb5"></a><!-- doxytag: member="channel.h::ast_softhangup" ref="a1a142039194e9f6dfb632b28a0c5eb5" args="(struct ast_channel *chan, int cause)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_softhangup           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cause</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Softly hangup up a channel. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to be soft-hung-up Call the protocol layer, but don't destroy the channel structure (use this if you are trying to safely hangup a channel managed by another thread. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cause</em>&nbsp;</td><td>Ast hangupcause for hangup </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns 0 regardless </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01456">1456</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, and <a class="el" href="channel_8c-source.html#l01442">ast_softhangup_nolock()</a>.
<p>
Referenced by <a class="el" href="loader_8c-source.html#l00209">__ast_module_user_hangup_all()</a>, <a class="el" href="chan__phone_8c-source.html#l01304">__unload_module()</a>, <a class="el" href="manager_8c-source.html#l01480">action_hangup()</a>, <a class="el" href="chan__agent_8c-source.html#l00717">agent_hangup()</a>, <a class="el" href="chan__agent_8c-source.html#l01512">agent_logoff()</a>, <a class="el" href="channel_8c-source.html#l00349">ast_begin_shutdown()</a>, <a class="el" href="app__rpt_8c-source.html#l02757">function_ilink()</a>, <a class="el" href="res__agi_8c-source.html#l01084">handle_hangup()</a>, <a class="el" href="app__rpt_8c-source.html#l03406">handle_link_data()</a>, <a class="el" href="cli_8c-source.html#l00588">handle_softhangup()</a>, <a class="el" href="res__features_8c-source.html#l02348">manager_park()</a>, <a class="el" href="app__rpt_8c-source.html#l05604">rpt()</a>, <a class="el" href="app__rpt_8c-source.html#l02483">rpt_call()</a>, <a class="el" href="app__rpt_8c-source.html#l01422">rpt_do_restart()</a>, <a class="el" href="app__meetme_8c-source.html#l03767">sla_handle_hold_event()</a>, <a class="el" href="app__softhangup_8c-source.html#l00056">softhangup_exec()</a>, <a class="el" href="app__chanspy_8c-source.html#l00220">start_spying()</a>, <a class="el" href="app__mixmonitor_8c-source.html#l00126">startmon()</a>, <a class="el" href="chan__agent_8c-source.html#l02513">unload_module()</a>, and <a class="el" href="chan__zap_8c-source.html#l03942">zt_handle_event()</a>.<div class="fragment"><pre class="fragment"><a name="l01457"></a>01457 {
<a name="l01458"></a>01458    <span class="keywordtype">int</span> res;
<a name="l01459"></a>01459    <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l01460"></a>01460    res = <a class="code" href="channel_8c.html#c969f5294a61165c99c9b6f65ecae173">ast_softhangup_nolock</a>(chan, cause);
<a name="l01461"></a>01461    <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l01462"></a>01462    <span class="keywordflow">return</span> res;
<a name="l01463"></a>01463 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c969f5294a61165c99c9b6f65ecae173"></a><!-- doxytag: member="channel.h::ast_softhangup_nolock" ref="c969f5294a61165c99c9b6f65ecae173" args="(struct ast_channel *chan, int cause)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_softhangup_nolock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cause</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Softly hangup up a channel (no channel lock). 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to be soft-hung-up </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cause</em>&nbsp;</td><td>Ast hangupcause for hangup (see cause.h) </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01442">1442</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00414">ast_channel::_softhangup</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="frame_8c-source.html#l00142">ast_null_frame</a>, <a class="el" href="channel_8c-source.html#l00795">ast_queue_frame()</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="channel_8h-source.html#l00417">ast_channel::blocker</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, and <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04595">ast_async_goto()</a>, <a class="el" href="channel_8c-source.html#l01456">ast_softhangup()</a>, <a class="el" href="chan__sip_8c-source.html#l13672">attempt_transfer()</a>, <a class="el" href="chan__sip_8c-source.html#l15965">check_rtp_timeout()</a>, <a class="el" href="chan__h323_8c-source.html#l00871">oh323_indicate()</a>, <a class="el" href="chan__sip_8c-source.html#l04083">sip_indicate()</a>, and <a class="el" href="chan__skinny_8c-source.html#l02754">skinny_indicate()</a>.<div class="fragment"><pre class="fragment"><a name="l01443"></a>01443 {
<a name="l01444"></a>01444    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l01445"></a>01445       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Soft-Hanging up channel '%s'\n"</span>, chan-&gt;name);
<a name="l01446"></a>01446    <span class="comment">/* Inform channel driver that we need to be hung up, if it cares */</span>
<a name="l01447"></a>01447    chan-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> |= cause;
<a name="l01448"></a>01448    <a class="code" href="channel_8c.html#c02f134e64b4fc85c1efd80b8685b635">ast_queue_frame</a>(chan, &amp;<a class="code" href="frame_8c.html#8bfe1415e256ff41d93a3ce9396e815f">ast_null_frame</a>);
<a name="l01449"></a>01449    <span class="comment">/* Interrupt any poll call or such */</span>
<a name="l01450"></a>01450    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>))
<a name="l01451"></a>01451       pthread_kill(chan-&gt;<a class="code" href="structast__channel.html#a38ba46bb4909bc27602645297913d86">blocker</a>, SIGURG);
<a name="l01452"></a>01452    <span class="keywordflow">return</span> 0;
<a name="l01453"></a>01453 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="70f0f0cc9b725f5d2e6b99dcb2c4ea73"></a><!-- doxytag: member="channel.h::ast_state2str" ref="70f0f0cc9b725f5d2e6b99dcb2c4ea73" args="(enum ast_channel_state)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_state2str           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">enum <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a">ast_channel_state</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>state</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Gives the string form of a given channel state. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>This function is not reentrant. </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l00523">523</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a2081397aa15f6ea9b289237043aa1d1b">AST_STATE_BUSY</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a4f25236a25abffd53bda3ef97e96296f">AST_STATE_DIALING</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87ae69544c47419fa57cd20045b09aa5b40">AST_STATE_DIALING_OFFHOOK</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a3c9bf8b90a4d4f25fc98dd1360bba58b">AST_STATE_DOWN</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a71b2dab052b5015d49144d52cf580735">AST_STATE_OFFHOOK</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a0c8ef65931fb09184de67c7484cbbf47">AST_STATE_PRERING</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a75a7d9c79e4a7c2732015d1c68908536">AST_STATE_RESERVED</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a0789c8ad2fe8eda2081eb587a0bfbe42">AST_STATE_RING</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a85da5b3ea10583d638bc7ce8fe638ec2">AST_STATE_RINGING</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>, <a class="el" href="adsistub_8c-source.html#l00065">buf</a>, and <a class="el" href="channel_8c-source.html#l00105">STATE2STR_BUFSIZE</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l01587">action_status()</a>, <a class="el" href="chan__agent_8c-source.html#l00717">agent_hangup()</a>, <a class="el" href="channel_8c-source.html#l00632">ast_channel_alloc()</a>, <a class="el" href="channel_8c-source.html#l03406">ast_do_masquerade()</a>, <a class="el" href="channel_8c-source.html#l03728">ast_setstate()</a>, <a class="el" href="chan__sip_8c-source.html#l13672">attempt_transfer()</a>, <a class="el" href="cli_8c-source.html#l00452">handle_chanlist()</a>, <a class="el" href="chan__sip_8c-source.html#l13936">handle_invite_replaces()</a>, <a class="el" href="cli_8c-source.html#l00770">handle_showchan()</a>, <a class="el" href="chan__sip_8c-source.html#l14615">local_attended_transfer()</a>, <a class="el" href="chan__mgcp_8c-source.html#l01457">mgcp_new()</a>, <a class="el" href="app__dumpchan_8c-source.html#l00060">serialize_showchan()</a>, and <a class="el" href="chan__sip_8c-source.html#l03676">sip_hangup()</a>.<div class="fragment"><pre class="fragment"><a name="l00524"></a>00524 {
<a name="l00525"></a>00525    <span class="keywordtype">char</span> *<a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>;
<a name="l00526"></a>00526 
<a name="l00527"></a>00527    <span class="keywordflow">switch</span> (<a class="code" href="structstate.html">state</a>) {
<a name="l00528"></a>00528    <span class="keywordflow">case</span> <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a3c9bf8b90a4d4f25fc98dd1360bba58b">AST_STATE_DOWN</a>:
<a name="l00529"></a>00529       <span class="keywordflow">return</span> <span class="stringliteral">"Down"</span>;
<a name="l00530"></a>00530    <span class="keywordflow">case</span> <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a75a7d9c79e4a7c2732015d1c68908536">AST_STATE_RESERVED</a>:
<a name="l00531"></a>00531       <span class="keywordflow">return</span> <span class="stringliteral">"Rsrvd"</span>;
<a name="l00532"></a>00532    <span class="keywordflow">case</span> <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a71b2dab052b5015d49144d52cf580735">AST_STATE_OFFHOOK</a>:
<a name="l00533"></a>00533       <span class="keywordflow">return</span> <span class="stringliteral">"OffHook"</span>;
<a name="l00534"></a>00534    <span class="keywordflow">case</span> <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a4f25236a25abffd53bda3ef97e96296f">AST_STATE_DIALING</a>:
<a name="l00535"></a>00535       <span class="keywordflow">return</span> <span class="stringliteral">"Dialing"</span>;
<a name="l00536"></a>00536    <span class="keywordflow">case</span> <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a0789c8ad2fe8eda2081eb587a0bfbe42">AST_STATE_RING</a>:
<a name="l00537"></a>00537       <span class="keywordflow">return</span> <span class="stringliteral">"Ring"</span>;
<a name="l00538"></a>00538    <span class="keywordflow">case</span> <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a85da5b3ea10583d638bc7ce8fe638ec2">AST_STATE_RINGING</a>:
<a name="l00539"></a>00539       <span class="keywordflow">return</span> <span class="stringliteral">"Ringing"</span>;
<a name="l00540"></a>00540    <span class="keywordflow">case</span> <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>:
<a name="l00541"></a>00541       <span class="keywordflow">return</span> <span class="stringliteral">"Up"</span>;
<a name="l00542"></a>00542    <span class="keywordflow">case</span> <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a2081397aa15f6ea9b289237043aa1d1b">AST_STATE_BUSY</a>:
<a name="l00543"></a>00543       <span class="keywordflow">return</span> <span class="stringliteral">"Busy"</span>;
<a name="l00544"></a>00544    <span class="keywordflow">case</span> <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87ae69544c47419fa57cd20045b09aa5b40">AST_STATE_DIALING_OFFHOOK</a>:
<a name="l00545"></a>00545       <span class="keywordflow">return</span> <span class="stringliteral">"Dialing Offhook"</span>;
<a name="l00546"></a>00546    <span class="keywordflow">case</span> <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a0c8ef65931fb09184de67c7484cbbf47">AST_STATE_PRERING</a>:
<a name="l00547"></a>00547       <span class="keywordflow">return</span> <span class="stringliteral">"Pre-ring"</span>;
<a name="l00548"></a>00548    <span class="keywordflow">default</span>:
<a name="l00549"></a>00549       <span class="keywordflow">if</span> (!(buf = ast_threadstorage_get(&amp;state2str_threadbuf, <a class="code" href="channel_8c.html#1e6dec0e2fbda212b36612175c9eebc3">STATE2STR_BUFSIZE</a>)))
<a name="l00550"></a>00550          <span class="keywordflow">return</span> <span class="stringliteral">"Unknown"</span>;
<a name="l00551"></a>00551       snprintf(buf, <a class="code" href="channel_8c.html#1e6dec0e2fbda212b36612175c9eebc3">STATE2STR_BUFSIZE</a>, <span class="stringliteral">"Unknown (%d)"</span>, <a class="code" href="structstate.html">state</a>);
<a name="l00552"></a>00552       <span class="keywordflow">return</span> buf;
<a name="l00553"></a>00553    }
<a name="l00554"></a>00554 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="bd5520dfe931a76ad3bea71e03887f59"></a><!-- doxytag: member="channel.h::ast_str2cause" ref="bd5520dfe931a76ad3bea71e03887f59" args="(const char *name) attribute_pure" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_str2cause           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>name</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Convert a symbolic hangup cause to number. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>string form of the cause Returns the cause code </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l00509">509</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c.html#1b1c2ab7cb4088770575bc4a46216449">causes</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l05469">pbx_builtin_hangup()</a>.<div class="fragment"><pre class="fragment"><a name="l00510"></a>00510 {
<a name="l00511"></a>00511    <span class="keywordtype">int</span> x;
<a name="l00512"></a>00512 
<a name="l00513"></a>00513    <span class="keywordflow">for</span> (x = 0; x &lt; <span class="keyword">sizeof</span>(<a class="code" href="channel_8c.html#1b1c2ab7cb4088770575bc4a46216449">causes</a>) / <span class="keyword">sizeof</span>(causes[0]); x++)
<a name="l00514"></a>00514       <span class="keywordflow">if</span> (strncasecmp(causes[x].<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, name, strlen(causes[x].name)) == 0)
<a name="l00515"></a>00515          <span class="keywordflow">return</span> causes[x].cause;
<a name="l00516"></a>00516 
<a name="l00517"></a>00517    <span class="keywordflow">return</span> -1;
<a name="l00518"></a>00518 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ae5bd12fec5fb4b99bf70379e02ba7a5"></a><!-- doxytag: member="channel.h::ast_tonepair" ref="ae5bd12fec5fb4b99bf70379e02ba7a5" args="(struct ast_channel *chan, int freq1, int freq2, int duration, int vol)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_tonepair           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>freq1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>freq2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>duration</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>vol</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Play a tone pair for a given amount of time 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l04361">4361</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="frame_8h-source.html#l00396">ast_frfree()</a>, <a class="el" href="channel_8c-source.html#l02438">ast_read()</a>, <a class="el" href="channel_8c-source.html#l04343">ast_tonepair_start()</a>, <a class="el" href="channel_8c-source.html#l01952">ast_waitfor()</a>, <a class="el" href="format__g726_8c-source.html#l00193">f</a>, and <a class="el" href="channel_8h-source.html#l00403">ast_channel::generatordata</a>.
<p>
Referenced by <a class="el" href="app__zapateller_8c-source.html#l00059">zapateller_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l04362"></a>04362 {
<a name="l04363"></a>04363    <span class="keywordtype">int</span> res;
<a name="l04364"></a>04364 
<a name="l04365"></a>04365    <span class="keywordflow">if</span> ((res = <a class="code" href="channel_8c.html#df9ad031f8e78a39603595ad088b0877">ast_tonepair_start</a>(chan, freq1, freq2, duration, vol)))
<a name="l04366"></a>04366       <span class="keywordflow">return</span> res;
<a name="l04367"></a>04367 
<a name="l04368"></a>04368    <span class="comment">/* Give us some wiggle room */</span>
<a name="l04369"></a>04369    <span class="keywordflow">while</span> (chan-&gt;<a class="code" href="structast__channel.html#68e80cee708fd0cdfb20807a8663721d">generatordata</a> &amp;&amp; <a class="code" href="channel_8c.html#e02dcdf40023f275d4561a930e7a7fc9">ast_waitfor</a>(chan, 100) &gt;= 0) {
<a name="l04370"></a>04370       <span class="keyword">struct </span><a class="code" href="structast__frame.html">ast_frame</a> *<a class="code" href="format__g726_8c.html#85b9b17a7dd34a3638c560bc9152473b">f</a> = <a class="code" href="channel_8c.html#1446a8c0bddf626bf26b000fbeae117f">ast_read</a>(chan);
<a name="l04371"></a>04371       <span class="keywordflow">if</span> (f)
<a name="l04372"></a>04372          <a class="code" href="frame_8h.html#506c759ec4950e7f7465e8f090a6252b">ast_frfree</a>(f);
<a name="l04373"></a>04373       <span class="keywordflow">else</span>
<a name="l04374"></a>04374          <span class="keywordflow">return</span> -1;
<a name="l04375"></a>04375    }
<a name="l04376"></a>04376    <span class="keywordflow">return</span> 0;
<a name="l04377"></a>04377 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="df9ad031f8e78a39603595ad088b0877"></a><!-- doxytag: member="channel.h::ast_tonepair_start" ref="df9ad031f8e78a39603595ad088b0877" args="(struct ast_channel *chan, int freq1, int freq2, int duration, int vol)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_tonepair_start           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>freq1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>freq2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>duration</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>vol</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Start a tone going 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l04343">4343</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l01764">ast_activate_generator()</a>, <a class="el" href="channel_8c-source.html#l04230">tonepair_def::duration</a>, <a class="el" href="channel_8c-source.html#l04228">tonepair_def::freq1</a>, <a class="el" href="channel_8c-source.html#l04229">tonepair_def::freq2</a>, and <a class="el" href="channel_8c-source.html#l04231">tonepair_def::vol</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l04361">ast_tonepair()</a>, <a class="el" href="app__disa_8c-source.html#l00100">play_dialtone()</a>, <a class="el" href="app__rpt_8c-source.html#l01435">play_tone_pair()</a>, and <a class="el" href="app__test_8c-source.html#l00120">sendnoise()</a>.<div class="fragment"><pre class="fragment"><a name="l04344"></a>04344 {
<a name="l04345"></a>04345    <span class="keyword">struct </span><a class="code" href="structtonepair__def.html">tonepair_def</a> d = { 0, };
<a name="l04346"></a>04346 
<a name="l04347"></a>04347    d.<a class="code" href="structtonepair__def.html#e7594ca7647a7bdd1b06f415835a5f57">freq1</a> = <a class="code" href="structtonepair__def.html#e7594ca7647a7bdd1b06f415835a5f57">freq1</a>;
<a name="l04348"></a>04348    d.<a class="code" href="structtonepair__def.html#122628a6eae120b13983ec3feb760420">freq2</a> = <a class="code" href="structtonepair__def.html#122628a6eae120b13983ec3feb760420">freq2</a>;
<a name="l04349"></a>04349    d.<a class="code" href="structtonepair__def.html#b85ec314bf443b797ef8a66b3b03f8a4">duration</a> = <a class="code" href="structtonepair__def.html#b85ec314bf443b797ef8a66b3b03f8a4">duration</a>;
<a name="l04350"></a>04350    d.<a class="code" href="structtonepair__def.html#0acf8be1231e24946c3d10b649fb576f">vol</a> = (<a class="code" href="structtonepair__def.html#0acf8be1231e24946c3d10b649fb576f">vol</a> &lt; 1) ? 8192 : <a class="code" href="structtonepair__def.html#0acf8be1231e24946c3d10b649fb576f">vol</a>; <span class="comment">/* force invalid to 8192 */</span>
<a name="l04351"></a>04351    <span class="keywordflow">if</span> (<a class="code" href="channel_8c.html#51350b9fba7a6a2428e1b3a13a131d54">ast_activate_generator</a>(chan, &amp;<a class="code" href="channel_8c.html#eb7077a8acd7946b1f81a9d8665b16ef">tonepair</a>, &amp;d))
<a name="l04352"></a>04352       <span class="keywordflow">return</span> -1;
<a name="l04353"></a>04353    <span class="keywordflow">return</span> 0;
<a name="l04354"></a>04354 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="547c90e9a23e85d52e4cfacbc5cb9f73"></a><!-- doxytag: member="channel.h::ast_tonepair_stop" ref="547c90e9a23e85d52e4cfacbc5cb9f73" args="(struct ast_channel *chan)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_tonepair_stop           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>chan</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Stop a tone from playing 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l04356">4356</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l01729">ast_deactivate_generator()</a>.
<p>
Referenced by <a class="el" href="app__test_8c-source.html#l00120">sendnoise()</a>.<div class="fragment"><pre class="fragment"><a name="l04357"></a>04357 {
<a name="l04358"></a>04358    <a class="code" href="channel_8c.html#e4e0e5c1767576b38fb1a893dfd8cb2b">ast_deactivate_generator</a>(chan);
<a name="l04359"></a>04359 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="0a6d03e8efda8ed8121bbe278e60c7ad"></a><!-- doxytag: member="channel.h::ast_transfer" ref="0a6d03e8efda8ed8121bbe278e60c7ad" args="(struct ast_channel *chan, char *dest)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_transfer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>dest</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Transfer a channel (if supported). Returns -1 on error, 0 if not supported and 1 if supported and requested. 
<p>
Called by: <ul>
<li>app_transfer </li>
<li>the manager interface </li>
</ul>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l03138">3138</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="channel_8c-source.html#l00325">ast_check_hangup()</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="channel_8h-source.html#l00385">ast_channel::tech</a>, and <a class="el" href="structast__channel__tech.html#a63038a10451f49a8611b19e6c577d90">ast_channel_tech::transfer</a>.
<p>
Referenced by <a class="el" href="app__transfer_8c-source.html#l00068">transfer_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l03139"></a>03139 {
<a name="l03140"></a>03140    <span class="keywordtype">int</span> res = -1;
<a name="l03141"></a>03141 
<a name="l03142"></a>03142    <span class="comment">/* Stop if we're a zombie or need a soft hangup */</span>
<a name="l03143"></a>03143    <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l03144"></a>03144    <span class="keywordflow">if</span> (!<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>) &amp;&amp; !<a class="code" href="channel_8c.html#042e64a8d465783855a52ec8c56a9373">ast_check_hangup</a>(chan)) {
<a name="l03145"></a>03145       <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#a63038a10451f49a8611b19e6c577d90">transfer</a>) {
<a name="l03146"></a>03146          res = chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#a63038a10451f49a8611b19e6c577d90">transfer</a>(chan, dest);
<a name="l03147"></a>03147          <span class="keywordflow">if</span> (!res)
<a name="l03148"></a>03148             res = 1;
<a name="l03149"></a>03149       } <span class="keywordflow">else</span>
<a name="l03150"></a>03150          res = 0;
<a name="l03151"></a>03151    }
<a name="l03152"></a>03152    <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l03153"></a>03153    <span class="keywordflow">return</span> res;
<a name="l03154"></a>03154 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="85bf2a2910fd484add99db6bff044f97"></a><!-- doxytag: member="channel.h::ast_transfercapability2str" ref="85bf2a2910fd484add99db6bff044f97" args="(int transfercapability) attribute_const" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">char* ast_transfercapability2str           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>transfercapability</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Gives the string form of a given transfer capability. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>transfercapability</em>&nbsp;</td><td>transfercapabilty to get the name of Give a name to a transfercapbility See above Returns the text form of the binary transfer capbaility </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l00557">557</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="transcap_8h-source.html#l00034">AST_TRANS_CAP_3_1K_AUDIO</a>, <a class="el" href="transcap_8h-source.html#l00032">AST_TRANS_CAP_DIGITAL</a>, <a class="el" href="transcap_8h-source.html#l00036">AST_TRANS_CAP_DIGITAL_W_TONES</a>, <a class="el" href="transcap_8h-source.html#l00033">AST_TRANS_CAP_RESTRICTED_DIGITAL</a>, <a class="el" href="transcap_8h-source.html#l00031">AST_TRANS_CAP_SPEECH</a>, and <a class="el" href="transcap_8h-source.html#l00037">AST_TRANS_CAP_VIDEO</a>.
<p>
Referenced by <a class="el" href="chan__misdn_8c-source.html#l01948">misdn_call()</a>, <a class="el" href="chan__h323_8c-source.html#l00594">oh323_call()</a>, <a class="el" href="chan__zap_8c-source.html#l01923">zt_call()</a>, and <a class="el" href="chan__zap_8c-source.html#l05516">zt_new()</a>.<div class="fragment"><pre class="fragment"><a name="l00558"></a>00558 {
<a name="l00559"></a>00559    <span class="keywordflow">switch</span> (transfercapability) {
<a name="l00560"></a>00560    <span class="keywordflow">case</span> <a class="code" href="transcap_8h.html#bfe67e9f7b726989840f83c68b0f5265">AST_TRANS_CAP_SPEECH</a>:
<a name="l00561"></a>00561       <span class="keywordflow">return</span> <span class="stringliteral">"SPEECH"</span>;
<a name="l00562"></a>00562    <span class="keywordflow">case</span> <a class="code" href="transcap_8h.html#e58ab5d4b1bec6f3bfacfb3ddca7caed">AST_TRANS_CAP_DIGITAL</a>:
<a name="l00563"></a>00563       <span class="keywordflow">return</span> <span class="stringliteral">"DIGITAL"</span>;
<a name="l00564"></a>00564    <span class="keywordflow">case</span> <a class="code" href="transcap_8h.html#697c16bed779a43f064dc72aa887d4fe">AST_TRANS_CAP_RESTRICTED_DIGITAL</a>:
<a name="l00565"></a>00565       <span class="keywordflow">return</span> <span class="stringliteral">"RESTRICTED_DIGITAL"</span>;
<a name="l00566"></a>00566    <span class="keywordflow">case</span> <a class="code" href="transcap_8h.html#9bdb9646f688f88d627d0b9e41d46955">AST_TRANS_CAP_3_1K_AUDIO</a>:
<a name="l00567"></a>00567       <span class="keywordflow">return</span> <span class="stringliteral">"3K1AUDIO"</span>;
<a name="l00568"></a>00568    <span class="keywordflow">case</span> <a class="code" href="transcap_8h.html#5295f404719293b4dc5ee05a5905bb9d">AST_TRANS_CAP_DIGITAL_W_TONES</a>:
<a name="l00569"></a>00569       <span class="keywordflow">return</span> <span class="stringliteral">"DIGITAL_W_TONES"</span>;
<a name="l00570"></a>00570    <span class="keywordflow">case</span> <a class="code" href="transcap_8h.html#36aa5cbfceeb15947818d618f7ec164d">AST_TRANS_CAP_VIDEO</a>:
<a name="l00571"></a>00571       <span class="keywordflow">return</span> <span class="stringliteral">"VIDEO"</span>;
<a name="l00572"></a>00572    <span class="keywordflow">default</span>:
<a name="l00573"></a>00573       <span class="keywordflow">return</span> <span class="stringliteral">"UNKNOWN"</span>;
<a name="l00574"></a>00574    }
<a name="l00575"></a>00575 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="cad81a17a0fa70c35b08e0c9b40f1877"></a><!-- doxytag: member="channel.h::ast_waitfor" ref="cad81a17a0fa70c35b08e0c9b40f1877" args="(struct ast_channel *chan, int ms)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_waitfor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>ms</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Wait for input on a channel. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>channel to wait on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ms</em>&nbsp;</td><td>length of time to wait on the channel Wait for input on a channel for a given # of milliseconds (&lt;0 for indefinite). </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns &lt; 0 on failure, 0 if nothing ever arrived, and the # of ms remaining otherwise </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01952">1952</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l01800">ast_waitfor_nandfds()</a>.
<p>
Referenced by <a class="el" href="res__adsi_8c-source.html#l00198">__adsi_transmit_messages()</a>, <a class="el" href="app_8c-source.html#l00509">__ast_play_and_record()</a>, <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="res__adsi_8c-source.html#l00127">adsi_careful_send()</a>, <a class="el" href="chan__agent_8c-source.html#l00850">agent_ack_sleep()</a>, <a class="el" href="app_8c-source.html#l00236">ast_dtmf_stream()</a>, <a class="el" href="channel_8c-source.html#l02522">ast_recvtext()</a>, <a class="el" href="channel_8c-source.html#l01027">ast_safe_sleep_conditional()</a>, <a class="el" href="channel_8c-source.html#l04361">ast_tonepair()</a>, <a class="el" href="pbx_8c-source.html#l04903">async_wait()</a>, <a class="el" href="app__talkdetect_8c-source.html#l00063">background_detect_exec()</a>, <a class="el" href="app__chanspy_8c-source.html#l00266">channel_spy()</a>, <a class="el" href="app__meetme_8c-source.html#l01180">conf_flush()</a>, <a class="el" href="app__dictate_8c-source.html#l00079">dictate_exec()</a>, <a class="el" href="app__disa_8c-source.html#l00113">disa_exec()</a>, <a class="el" href="app__waitforsilence_8c-source.html#l00078">do_waiting()</a>, <a class="el" href="app__echo_8c-source.html#l00054">echo_exec()</a>, <a class="el" href="res__agi_8c-source.html#l00889">handle_recordfile()</a>, <a class="el" href="app__ices_8c-source.html#l00104">ices_exec()</a>, <a class="el" href="app__amd_8c-source.html#l00097">isAnsweringMachine()</a>, <a class="el" href="app__test_8c-source.html#l00064">measurenoise()</a>, <a class="el" href="app__mp3_8c-source.html#l00125">mp3_exec()</a>, <a class="el" href="app__nbscat_8c-source.html#l00116">NBScat_exec()</a>, <a class="el" href="app__alarmreceiver_8c-source.html#l00238">receive_dtmf_digits()</a>, <a class="el" href="app__record_8c-source.html#l00078">record_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l03045">recordthread()</a>, <a class="el" href="app__alarmreceiver_8c-source.html#l00170">send_tone_burst()</a>, <a class="el" href="app__festival_8c-source.html#l00171">send_waveform_to_channel()</a>, <a class="el" href="app__url_8c-source.html#l00070">sendurl_exec()</a>, <a class="el" href="app__sms_8c-source.html#l01748">sms_exec()</a>, <a class="el" href="app__speech__utils_8c-source.html#l00543">speech_background()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, <a class="el" href="pbx_8c-source.html#l05351">wait_for_hangup()</a>, <a class="el" href="app__waitforring_8c-source.html#l00056">waitforring_exec()</a>, and <a class="el" href="file_8c-source.html#l00983">waitstream_core()</a>.<div class="fragment"><pre class="fragment"><a name="l01953"></a>01953 {
<a name="l01954"></a>01954    <span class="keywordtype">int</span> oldms = ms;   <span class="comment">/* -1 if no timeout */</span>
<a name="l01955"></a>01955 
<a name="l01956"></a>01956    <a class="code" href="channel_8c.html#d1d8604e3228763d140c1bd188e3618d">ast_waitfor_nandfds</a>(&amp;c, 1, NULL, 0, NULL, NULL, &amp;ms);
<a name="l01957"></a>01957    <span class="keywordflow">if</span> ((ms &lt; 0) &amp;&amp; (oldms &lt; 0))
<a name="l01958"></a>01958       ms = 0;
<a name="l01959"></a>01959    <span class="keywordflow">return</span> ms;
<a name="l01960"></a>01960 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="9233eec93dd9d3660844802b767036b7"></a><!-- doxytag: member="channel.h::ast_waitfor_n" ref="9233eec93dd9d3660844802b767036b7" args="(struct ast_channel **chan, int n, int *ms)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a>* ast_waitfor_n           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>ms</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Waits for input on a group of channels Wait for input on an array of channels for a given # of milliseconds. 
<p>
<dl compact><dt><b>Returns:</b></dt><dd>Return channel with activity, or NULL if none has activity. </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>an array of pointers to channels </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>n</em>&nbsp;</td><td>number of channels that are to be waited upon </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ms</em>&nbsp;</td><td>time "ms" is modified in-place, if applicable </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01947">1947</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l01800">ast_waitfor_nandfds()</a>.
<p>
Referenced by <a class="el" href="res__features_8c-source.html#l01295">ast_feature_request_and_dial()</a>, <a class="el" href="channel_8c-source.html#l03797">ast_generic_bridge()</a>, <a class="el" href="autoservice_8c-source.html#l00064">autoservice_run()</a>, <a class="el" href="rtp_8c-source.html#l02909">bridge_native_loop()</a>, <a class="el" href="rtp_8c-source.html#l03195">bridge_p2p_loop()</a>, <a class="el" href="chan__iax2_8c-source.html#l03198">iax2_bridge()</a>, <a class="el" href="chan__misdn_8c-source.html#l02789">misdn_bridge()</a>, <a class="el" href="dial_8c-source.html#l00440">monitor_dial()</a>, <a class="el" href="app__rpt_8c-source.html#l05604">rpt()</a>, <a class="el" href="app__rpt_8c-source.html#l06759">rpt_exec()</a>, <a class="el" href="app__dial_8c-source.html#l00532">wait_for_answer()</a>, <a class="el" href="app__followme_8c-source.html#l00470">wait_for_winner()</a>, and <a class="el" href="chan__zap_8c-source.html#l03412">zt_bridge()</a>.<div class="fragment"><pre class="fragment"><a name="l01948"></a>01948 {
<a name="l01949"></a>01949    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#d1d8604e3228763d140c1bd188e3618d">ast_waitfor_nandfds</a>(c, n, NULL, 0, NULL, NULL, ms);
<a name="l01950"></a>01950 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="7bda1d2f937087ca98166e5463740b64"></a><!-- doxytag: member="channel.h::ast_waitfor_n_fd" ref="7bda1d2f937087ca98166e5463740b64" args="(int *fds, int n, int *ms, int *exception)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_waitfor_n_fd           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int *&nbsp;</td>
          <td class="mdname" nowrap> <em>fds</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>ms</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>exception</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Waits for input on an fd This version works on fd's only. Be careful with it. 
<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01792">1792</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l01800">ast_waitfor_nandfds()</a>.
<p>
Referenced by <a class="el" href="pbx__dundi_8c-source.html#l03639">dundi_precache_internal()</a>.<div class="fragment"><pre class="fragment"><a name="l01793"></a>01793 {
<a name="l01794"></a>01794    <span class="keywordtype">int</span> winner = -1;
<a name="l01795"></a>01795    <a class="code" href="channel_8c.html#d1d8604e3228763d140c1bd188e3618d">ast_waitfor_nandfds</a>(NULL, 0, fds, n, exception, &amp;winner, ms);
<a name="l01796"></a>01796    <span class="keywordflow">return</span> winner;
<a name="l01797"></a>01797 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2efb5d945c0350d0fa3abe4f1838d3c3"></a><!-- doxytag: member="channel.h::ast_waitfor_nandfds" ref="2efb5d945c0350d0fa3abe4f1838d3c3" args="(struct ast_channel **chan, int n, int *fds, int nfds, int *exception, int *outfd, int *ms)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a>* ast_waitfor_nandfds           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>fds</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>nfds</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>exception</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>outfd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>ms</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Waits for activity on a group of channels. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>an array of pointers to channels </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>n</em>&nbsp;</td><td>number of channels that are to be waited upon </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fds</em>&nbsp;</td><td>an array of fds to wait upon </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nfds</em>&nbsp;</td><td>the number of fds to wait upon </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>exception</em>&nbsp;</td><td>exception flag </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outfd</em>&nbsp;</td><td>fd that had activity on it </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ms</em>&nbsp;</td><td>how long the wait was Big momma function here. Wait for activity on any of the n channels, or any of the nfds file descriptors. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns the channel with activity, or NULL on error or if an FD came first. If the FD came first, it will be returned in outfd, otherwise, outfd will be -1 </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01800">1800</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00414">ast_channel::_softhangup</a>, <a class="el" href="channel_8h-source.html#l01306">ast_add_fd()</a>, <a class="el" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="utils_8h-source.html#l00081">ast_clear_flag</a>, <a class="el" href="channel_8c-source.html#l03406">ast_do_masquerade()</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300e16a5c3eb4b46399b147040658306ff5">AST_FLAG_EXCEPTION</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="channel_8h-source.html#l00160">AST_MAX_FDS</a>, <a class="el" href="utils_8h-source.html#l00074">ast_set_flag</a>, <a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a12709ffb7179ec4c9b3ba505519ddc84e">AST_SOFTHANGUP_TIMEOUT</a>, <a class="el" href="channel_8h-source.html#l01387">CHECK_BLOCKING</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="poll_8c-source.html#l00264">poll()</a>, <a class="el" href="poll-compat_8h-source.html#l00083">POLLPRI</a>, and <a class="el" href="channel_8h-source.html#l00416">ast_channel::whentohangup</a>.
<p>
Referenced by <a class="el" href="app__externalivr_8c-source.html#l00244">app_exec()</a>, <a class="el" href="channel_8c-source.html#l01952">ast_waitfor()</a>, <a class="el" href="channel_8c-source.html#l01947">ast_waitfor_n()</a>, <a class="el" href="channel_8c-source.html#l01792">ast_waitfor_n_fd()</a>, <a class="el" href="channel_8c-source.html#l01987">ast_waitfordigit_full()</a>, <a class="el" href="app__meetme_8c-source.html#l01350">conf_run()</a>, <a class="el" href="chan__iax2_8c-source.html#l09693">find_cache()</a>, <a class="el" href="res__agi_8c-source.html#l01833">run_agi()</a>, and <a class="el" href="file_8c-source.html#l00983">waitstream_core()</a>.<div class="fragment"><pre class="fragment"><a name="l01802"></a>01802 {
<a name="l01803"></a>01803    <span class="keyword">struct </span>timeval start = { 0 , 0 };
<a name="l01804"></a>01804    <span class="keyword">struct </span><a class="code" href="structpollfd.html">pollfd</a> *pfds;
<a name="l01805"></a>01805    <span class="keywordtype">int</span> res;
<a name="l01806"></a>01806    <span class="keywordtype">long</span> rms;
<a name="l01807"></a>01807    <span class="keywordtype">int</span> x, y, max;
<a name="l01808"></a>01808    <span class="keywordtype">int</span> sz;
<a name="l01809"></a>01809    time_t now = 0;
<a name="l01810"></a>01810    <span class="keywordtype">long</span> whentohangup = 0, diff;
<a name="l01811"></a>01811    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *winner = NULL;
<a name="l01812"></a>01812    <span class="keyword">struct </span>fdmap {
<a name="l01813"></a>01813       <span class="keywordtype">int</span> chan;
<a name="l01814"></a>01814       <span class="keywordtype">int</span> fdno;
<a name="l01815"></a>01815    } *fdmap;
<a name="l01816"></a>01816 
<a name="l01817"></a>01817    sz = n * <a class="code" href="channel_8h.html#83204f17b88e7752d76b1a751a501a65">AST_MAX_FDS</a> + nfds;
<a name="l01818"></a>01818    pfds = alloca(<span class="keyword">sizeof</span>(*pfds) * sz);
<a name="l01819"></a>01819    fdmap = alloca(<span class="keyword">sizeof</span>(*fdmap) * sz);
<a name="l01820"></a>01820 
<a name="l01821"></a>01821    <span class="keywordflow">if</span> (outfd)
<a name="l01822"></a>01822       *outfd = -99999;
<a name="l01823"></a>01823    <span class="keywordflow">if</span> (exception)
<a name="l01824"></a>01824       *exception = 0;
<a name="l01825"></a>01825    
<a name="l01826"></a>01826    <span class="comment">/* Perform any pending masquerades */</span>
<a name="l01827"></a>01827    <span class="keywordflow">for</span> (x=0; x &lt; n; x++) {
<a name="l01828"></a>01828       <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(c[x]);
<a name="l01829"></a>01829       <span class="keywordflow">if</span> (c[x]-&gt;masq) {
<a name="l01830"></a>01830          <span class="keywordflow">if</span> (<a class="code" href="channel_8c.html#f788595bd51a58be12bb3c3b28a950ec">ast_do_masquerade</a>(c[x])) {
<a name="l01831"></a>01831             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Masquerade failed\n"</span>);
<a name="l01832"></a>01832             *ms = -1;
<a name="l01833"></a>01833             <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(c[x]);
<a name="l01834"></a>01834             <span class="keywordflow">return</span> NULL;
<a name="l01835"></a>01835          }
<a name="l01836"></a>01836       }
<a name="l01837"></a>01837       <span class="keywordflow">if</span> (c[x]-&gt;whentohangup) {
<a name="l01838"></a>01838          <span class="keywordflow">if</span> (!whentohangup)
<a name="l01839"></a>01839             time(&amp;now);
<a name="l01840"></a>01840          diff = c[x]-&gt;whentohangup - now;
<a name="l01841"></a>01841          <span class="keywordflow">if</span> (diff &lt; 1) {
<a name="l01842"></a>01842             <span class="comment">/* Should already be hungup */</span>
<a name="l01843"></a>01843             c[x]-&gt;_softhangup |= <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a12709ffb7179ec4c9b3ba505519ddc84e">AST_SOFTHANGUP_TIMEOUT</a>;
<a name="l01844"></a>01844             <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(c[x]);
<a name="l01845"></a>01845             <span class="keywordflow">return</span> c[x];
<a name="l01846"></a>01846          }
<a name="l01847"></a>01847          <span class="keywordflow">if</span> (!whentohangup || (diff &lt; whentohangup))
<a name="l01848"></a>01848             whentohangup = diff;
<a name="l01849"></a>01849       }
<a name="l01850"></a>01850       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(c[x]);
<a name="l01851"></a>01851    }
<a name="l01852"></a>01852    <span class="comment">/* Wait full interval */</span>
<a name="l01853"></a>01853    rms = *ms;
<a name="l01854"></a>01854    <span class="keywordflow">if</span> (whentohangup) {
<a name="l01855"></a>01855       rms = whentohangup * 1000;              <span class="comment">/* timeout in milliseconds */</span>
<a name="l01856"></a>01856       <span class="keywordflow">if</span> (*ms &gt;= 0 &amp;&amp; *ms &lt; rms)    <span class="comment">/* original *ms still smaller */</span>
<a name="l01857"></a>01857          rms =  *ms;
<a name="l01858"></a>01858    }
<a name="l01859"></a>01859    <span class="comment">/*</span>
<a name="l01860"></a>01860 <span class="comment">    * Build the pollfd array, putting the channels' fds first,</span>
<a name="l01861"></a>01861 <span class="comment">    * followed by individual fds. Order is important because</span>
<a name="l01862"></a>01862 <span class="comment">    * individual fd's must have priority over channel fds.</span>
<a name="l01863"></a>01863 <span class="comment">    */</span>
<a name="l01864"></a>01864    max = 0;
<a name="l01865"></a>01865    <span class="keywordflow">for</span> (x=0; x&lt;n; x++) {
<a name="l01866"></a>01866       <span class="keywordflow">for</span> (y=0; y&lt;<a class="code" href="channel_8h.html#83204f17b88e7752d76b1a751a501a65">AST_MAX_FDS</a>; y++) {
<a name="l01867"></a>01867          fdmap[max].fdno = y;  <span class="comment">/* fd y is linked to this pfds */</span>
<a name="l01868"></a>01868          fdmap[max].chan = x;  <span class="comment">/* channel x is linked to this pfds */</span>
<a name="l01869"></a>01869          max += <a class="code" href="channel_8h.html#ac55a99c346024715138883ba689718c">ast_add_fd</a>(&amp;pfds[max], c[x]-&gt;fds[y]);
<a name="l01870"></a>01870       }
<a name="l01871"></a>01871       <a class="code" href="channel_8h.html#722e76a74a7a5f5eb3efcd3cf30e7772">CHECK_BLOCKING</a>(c[x]);
<a name="l01872"></a>01872    }
<a name="l01873"></a>01873    <span class="comment">/* Add the individual fds */</span>
<a name="l01874"></a>01874    <span class="keywordflow">for</span> (x=0; x&lt;nfds; x++) {
<a name="l01875"></a>01875       fdmap[max].chan = -1;
<a name="l01876"></a>01876       max += <a class="code" href="channel_8h.html#ac55a99c346024715138883ba689718c">ast_add_fd</a>(&amp;pfds[max], fds[x]);
<a name="l01877"></a>01877    }
<a name="l01878"></a>01878 
<a name="l01879"></a>01879    <span class="keywordflow">if</span> (*ms &gt; 0)
<a name="l01880"></a>01880       start = ast_tvnow();
<a name="l01881"></a>01881    
<a name="l01882"></a>01882    <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) == 4) { <span class="comment">/* XXX fix timeout &gt; 600000 on linux x86-32 */</span>
<a name="l01883"></a>01883       <span class="keywordflow">do</span> {
<a name="l01884"></a>01884          <span class="keywordtype">int</span> kbrms = rms;
<a name="l01885"></a>01885          <span class="keywordflow">if</span> (kbrms &gt; 600000)
<a name="l01886"></a>01886             kbrms = 600000;
<a name="l01887"></a>01887          res = <a class="code" href="poll_8c.html#490c34aebc91a7dfe2524a13104fd13e">poll</a>(pfds, max, kbrms);
<a name="l01888"></a>01888          <span class="keywordflow">if</span> (!res)
<a name="l01889"></a>01889             rms -= kbrms;
<a name="l01890"></a>01890       } <span class="keywordflow">while</span> (!res &amp;&amp; (rms &gt; 0));
<a name="l01891"></a>01891    } <span class="keywordflow">else</span> {
<a name="l01892"></a>01892       res = <a class="code" href="poll_8c.html#490c34aebc91a7dfe2524a13104fd13e">poll</a>(pfds, max, rms);
<a name="l01893"></a>01893    }
<a name="l01894"></a>01894    <span class="keywordflow">for</span> (x=0; x&lt;n; x++)
<a name="l01895"></a>01895       <a class="code" href="utils_8h.html#c2399a33be6ffb658bcf7c6a35531732">ast_clear_flag</a>(c[x], <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>);
<a name="l01896"></a>01896    <span class="keywordflow">if</span> (res &lt; 0) { <span class="comment">/* Simulate a timeout if we were interrupted */</span>
<a name="l01897"></a>01897       <span class="keywordflow">if</span> (errno != EINTR)
<a name="l01898"></a>01898          *ms = -1;
<a name="l01899"></a>01899       <span class="keywordflow">return</span> NULL;
<a name="l01900"></a>01900    }
<a name="l01901"></a>01901    <span class="keywordflow">if</span> (whentohangup) {   <span class="comment">/* if we have a timeout, check who expired */</span>
<a name="l01902"></a>01902       time(&amp;now);
<a name="l01903"></a>01903       <span class="keywordflow">for</span> (x=0; x&lt;n; x++) {
<a name="l01904"></a>01904          <span class="keywordflow">if</span> (c[x]-&gt;whentohangup &amp;&amp; now &gt;= c[x]-&gt;whentohangup) {
<a name="l01905"></a>01905             c[x]-&gt;_softhangup |= <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a12709ffb7179ec4c9b3ba505519ddc84e">AST_SOFTHANGUP_TIMEOUT</a>;
<a name="l01906"></a>01906             <span class="keywordflow">if</span> (winner == NULL)
<a name="l01907"></a>01907                winner = c[x];
<a name="l01908"></a>01908          }
<a name="l01909"></a>01909       }
<a name="l01910"></a>01910    }
<a name="l01911"></a>01911    <span class="keywordflow">if</span> (res == 0) { <span class="comment">/* no fd ready, reset timeout and done */</span>
<a name="l01912"></a>01912       *ms = 0; <span class="comment">/* XXX use 0 since we may not have an exact timeout. */</span>
<a name="l01913"></a>01913       <span class="keywordflow">return</span> winner;
<a name="l01914"></a>01914    }
<a name="l01915"></a>01915    <span class="comment">/*</span>
<a name="l01916"></a>01916 <span class="comment">    * Then check if any channel or fd has a pending event.</span>
<a name="l01917"></a>01917 <span class="comment">    * Remember to check channels first and fds last, as they</span>
<a name="l01918"></a>01918 <span class="comment">    * must have priority on setting 'winner'</span>
<a name="l01919"></a>01919 <span class="comment">    */</span>
<a name="l01920"></a>01920    <span class="keywordflow">for</span> (x = 0; x &lt; max; x++) {
<a name="l01921"></a>01921       res = pfds[x].<a class="code" href="structpollfd.html#7c6f5b9f008b99872b2aff44748410c8">revents</a>;
<a name="l01922"></a>01922       <span class="keywordflow">if</span> (res == 0)
<a name="l01923"></a>01923          <span class="keywordflow">continue</span>;
<a name="l01924"></a>01924       <span class="keywordflow">if</span> (fdmap[x].chan &gt;= 0) {  <span class="comment">/* this is a channel */</span>
<a name="l01925"></a>01925          winner = c[fdmap[x].chan]; <span class="comment">/* override previous winners */</span>
<a name="l01926"></a>01926          <span class="keywordflow">if</span> (res &amp; <a class="code" href="poll-compat_8h.html#eb4a8029b132eaf617bfae72e35f8595">POLLPRI</a>)
<a name="l01927"></a>01927             <a class="code" href="utils_8h.html#3208623241ff7b4c93907944487502a1">ast_set_flag</a>(winner, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300e16a5c3eb4b46399b147040658306ff5">AST_FLAG_EXCEPTION</a>);
<a name="l01928"></a>01928          <span class="keywordflow">else</span>
<a name="l01929"></a>01929             <a class="code" href="utils_8h.html#c2399a33be6ffb658bcf7c6a35531732">ast_clear_flag</a>(winner, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300e16a5c3eb4b46399b147040658306ff5">AST_FLAG_EXCEPTION</a>);
<a name="l01930"></a>01930          winner-&gt;<a class="code" href="structast__channel.html#105e7c128b4aa547fdb820f23269be2e">fdno</a> = fdmap[x].fdno;
<a name="l01931"></a>01931       } <span class="keywordflow">else</span> {       <span class="comment">/* this is an fd */</span>
<a name="l01932"></a>01932          <span class="keywordflow">if</span> (outfd)
<a name="l01933"></a>01933             *outfd = pfds[x].<a class="code" href="structpollfd.html#36eba1e1e343279857ea7f69a597324e">fd</a>;
<a name="l01934"></a>01934          <span class="keywordflow">if</span> (exception)
<a name="l01935"></a>01935             *exception = (res &amp; <a class="code" href="poll-compat_8h.html#eb4a8029b132eaf617bfae72e35f8595">POLLPRI</a>) ? -1 : 0;
<a name="l01936"></a>01936          winner = NULL;
<a name="l01937"></a>01937       }
<a name="l01938"></a>01938    }
<a name="l01939"></a>01939    <span class="keywordflow">if</span> (*ms &gt; 0) {
<a name="l01940"></a>01940       *ms -= ast_tvdiff_ms(ast_tvnow(), start);
<a name="l01941"></a>01941       <span class="keywordflow">if</span> (*ms &lt; 0)
<a name="l01942"></a>01942          *ms = 0;
<a name="l01943"></a>01943    }
<a name="l01944"></a>01944    <span class="keywordflow">return</span> winner;
<a name="l01945"></a>01945 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b02063e7425e3cfb63ba24edf8081835"></a><!-- doxytag: member="channel.h::ast_waitfordigit" ref="b02063e7425e3cfb63ba24edf8081835" args="(struct ast_channel *c, int ms)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_waitfordigit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>ms</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Waits for a digit. 
<p>
!<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>channel to wait for a digit on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ms</em>&nbsp;</td><td>how many milliseconds to wait </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns &lt;0 on error, 0 on no entry, and the digit on success. </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01963">1963</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l01987">ast_waitfordigit_full()</a>.
<p>
Referenced by <a class="el" href="res__adsi_8c-source.html#l00629">_ast_adsi_get_cpeid()</a>, <a class="el" href="res__adsi_8c-source.html#l00661">_ast_adsi_get_cpeinfo()</a>, <a class="el" href="res__adsi_8c-source.html#l00973">_ast_adsi_print()</a>, <a class="el" href="res__adsi_8c-source.html#l00594">_ast_adsi_read_encoded_dtmf()</a>, <a class="el" href="res__adsi_8c-source.html#l00370">_ast_adsi_transmit_message_full()</a>, <a class="el" href="app__while_8c-source.html#l00164">_while_exec()</a>, <a class="el" href="app__voicemail_8c-source.html#l08189">advanced_options()</a>, <a class="el" href="app_8c-source.html#l00065">ast_app_dtget()</a>, <a class="el" href="app_8c-source.html#l00384">ast_control_streamfile()</a>, <a class="el" href="app_8c-source.html#l01046">ast_record_review()</a>, <a class="el" href="res__features_8c-source.html#l00776">builtin_atxfer()</a>, <a class="el" href="pbx_8c-source.html#l02224">collect_digits()</a>, <a class="el" href="app__chanspy_8c-source.html#l00465">common_exec()</a>, <a class="el" href="app__getcpeid_8c-source.html#l00066">cpeid_exec()</a>, <a class="el" href="app__voicemail_8c-source.html#l08128">dialout()</a>, <a class="el" href="app__directory_8c-source.html#l00570">directory_exec()</a>, <a class="el" href="app__voicemail_8c-source.html#l04129">forward_message()</a>, <a class="el" href="app__voicemail_8c-source.html#l03926">get_folder()</a>, <a class="el" href="app_8c-source.html#l01149">ivr_dispatch()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02638">mgcp_ss()</a>, <a class="el" href="chan__zap_8c-source.html#l05707">my_getsigstr()</a>, <a class="el" href="pbx_8c-source.html#l05584">pbx_builtin_waitexten()</a>, <a class="el" href="app__directory_8c-source.html#l00261">play_mailbox_owner()</a>, <a class="el" href="app__minivm_8c-source.html#l01278">play_record_review()</a>, <a class="el" href="app__read_8c-source.html#l00087">read_exec()</a>, <a class="el" href="app_8c-source.html#l01236">read_newoption()</a>, <a class="el" href="app__dial_8c-source.html#l01747">retrydial_exec()</a>, <a class="el" href="app__test_8c-source.html#l00120">sendnoise()</a>, <a class="el" href="chan__skinny_8c-source.html#l02365">skinny_ss()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, <a class="el" href="app__test_8c-source.html#l00131">testclient_exec()</a>, <a class="el" href="app__test_8c-source.html#l00322">testserver_exec()</a>, <a class="el" href="app__voicemail_8c-source.html#l06398">vm_execmain()</a>, <a class="el" href="app__voicemail_8c-source.html#l03966">vm_forwardoptions()</a>, <a class="el" href="app__voicemail_8c-source.html#l05876">vm_instructions()</a>, <a class="el" href="app__voicemail_8c-source.html#l06010">vm_options()</a>, <a class="el" href="app__voicemail_8c-source.html#l06109">vm_tempgreeting()</a>, <a class="el" href="app__queue_8c-source.html#l02854">wait_a_bit()</a>, and <a class="el" href="app__queue_8c-source.html#l02256">wait_our_turn()</a>.<div class="fragment"><pre class="fragment"><a name="l01964"></a>01964 {
<a name="l01965"></a>01965    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#6db20c648edfddb833ffa4d313257275">ast_waitfordigit_full</a>(c, ms, -1, -1);
<a name="l01966"></a>01966 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="37046471dc78265c045a341d785ae484"></a><!-- doxytag: member="channel.h::ast_waitfordigit_full" ref="37046471dc78265c045a341d785ae484" args="(struct ast_channel *c, int ms, int audiofd, int ctrlfd)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_waitfordigit_full           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>ms</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>audiofd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>ctrlfd</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Wait for a digit Same as <a class="el" href="channel_8c.html#b02063e7425e3cfb63ba24edf8081835">ast_waitfordigit()</a> with audio fd for outputting read audio and ctrlfd to monitor for reading. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>channel to wait for a digit on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ms</em>&nbsp;</td><td>how many milliseconds to wait </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>audiofd</em>&nbsp;</td><td>audio file descriptor to write to if audio frames are received </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ctrlfd</em>&nbsp;</td><td>control file descriptor to monitor for reading </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns 1 if ctrlfd becomes available </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01987">1987</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l00325">ast_check_hangup()</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389edaaffc26d24394cd2557ddb1db10f64">AST_CONTROL_ANSWER</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3896a1de835fbf024ef925569eb775de67f">AST_CONTROL_HANGUP</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3895749da867c771f2391b19ce9e08f0149">AST_CONTROL_RINGING</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a>, <a class="el" href="frame_8h-source.html#l00125">AST_FRAME_DTMF</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f9264fc4720a7b3982e2d4bf246fe3d9924">AST_FRAME_VOICE</a>, <a class="el" href="frame_8h-source.html#l00396">ast_frfree()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="channel_8c-source.html#l02438">ast_read()</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="channel_8c-source.html#l01800">ast_waitfor_nandfds()</a>, <a class="el" href="frame_8h-source.html#l00147">ast_frame::data</a>, <a class="el" href="frame_8h-source.html#l00135">ast_frame::datalen</a>, <a class="el" href="format__g726_8c-source.html#l00193">f</a>, <a class="el" href="frame_8h-source.html#l00131">ast_frame::frametype</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, and <a class="el" href="frame_8h-source.html#l00133">ast_frame::subclass</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l03161">ast_readstring_full()</a>, <a class="el" href="channel_8c-source.html#l01963">ast_waitfordigit()</a>, <a class="el" href="res__agi_8c-source.html#l00621">handle_getoption()</a>, and <a class="el" href="res__agi_8c-source.html#l00420">handle_waitfordigit()</a>.<div class="fragment"><pre class="fragment"><a name="l01988"></a>01988 {
<a name="l01989"></a>01989 
<a name="l01990"></a>01990    <span class="comment">/* Stop if we're a zombie or need a soft hangup */</span>
<a name="l01991"></a>01991    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(c, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>) || <a class="code" href="channel_8c.html#042e64a8d465783855a52ec8c56a9373">ast_check_hangup</a>(c))
<a name="l01992"></a>01992       <span class="keywordflow">return</span> -1;
<a name="l01993"></a>01993    <span class="comment">/* Wait for a digit, no more than ms milliseconds total. */</span>
<a name="l01994"></a>01994    <span class="keywordflow">while</span> (ms) {
<a name="l01995"></a>01995       <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *rchan;
<a name="l01996"></a>01996       <span class="keywordtype">int</span> outfd;
<a name="l01997"></a>01997 
<a name="l01998"></a>01998       errno = 0;
<a name="l01999"></a>01999       rchan = <a class="code" href="channel_8c.html#d1d8604e3228763d140c1bd188e3618d">ast_waitfor_nandfds</a>(&amp;c, 1, &amp;cmdfd, (cmdfd &gt; -1) ? 1 : 0, NULL, &amp;outfd, &amp;ms);
<a name="l02000"></a>02000       <span class="keywordflow">if</span> (!rchan &amp;&amp; outfd &lt; 0 &amp;&amp; ms) {
<a name="l02001"></a>02001          <span class="keywordflow">if</span> (errno == 0 || errno == EINTR)
<a name="l02002"></a>02002             <span class="keywordflow">continue</span>;
<a name="l02003"></a>02003          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Wait failed (%s)\n"</span>, strerror(errno));
<a name="l02004"></a>02004          <span class="keywordflow">return</span> -1;
<a name="l02005"></a>02005       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (outfd &gt; -1) {
<a name="l02006"></a>02006          <span class="comment">/* The FD we were watching has something waiting */</span>
<a name="l02007"></a>02007          <span class="keywordflow">return</span> 1;
<a name="l02008"></a>02008       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rchan) {
<a name="l02009"></a>02009          <span class="keywordtype">int</span> res;
<a name="l02010"></a>02010          <span class="keyword">struct </span><a class="code" href="structast__frame.html">ast_frame</a> *<a class="code" href="format__g726_8c.html#85b9b17a7dd34a3638c560bc9152473b">f</a> = <a class="code" href="channel_8c.html#1446a8c0bddf626bf26b000fbeae117f">ast_read</a>(c);
<a name="l02011"></a>02011          <span class="keywordflow">if</span> (!f)
<a name="l02012"></a>02012             <span class="keywordflow">return</span> -1;
<a name="l02013"></a>02013 
<a name="l02014"></a>02014          <span class="keywordflow">switch</span> (f-&gt;<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a>) {
<a name="l02015"></a>02015          <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#41e7a80287a24ece13159c2d8b1b9375">AST_FRAME_DTMF</a>:
<a name="l02016"></a>02016             res = f-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a>;
<a name="l02017"></a>02017             <a class="code" href="frame_8h.html#506c759ec4950e7f7465e8f090a6252b">ast_frfree</a>(f);
<a name="l02018"></a>02018             <span class="keywordflow">return</span> res;
<a name="l02019"></a>02019          <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a>:
<a name="l02020"></a>02020             <span class="keywordflow">switch</span> (f-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a>) {
<a name="l02021"></a>02021             <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3896a1de835fbf024ef925569eb775de67f">AST_CONTROL_HANGUP</a>:
<a name="l02022"></a>02022                <a class="code" href="frame_8h.html#506c759ec4950e7f7465e8f090a6252b">ast_frfree</a>(f);
<a name="l02023"></a>02023                <span class="keywordflow">return</span> -1;
<a name="l02024"></a>02024             <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f3895749da867c771f2391b19ce9e08f0149">AST_CONTROL_RINGING</a>:
<a name="l02025"></a>02025             <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389edaaffc26d24394cd2557ddb1db10f64">AST_CONTROL_ANSWER</a>:
<a name="l02026"></a>02026                <span class="comment">/* Unimportant */</span>
<a name="l02027"></a>02027                <span class="keywordflow">break</span>;
<a name="l02028"></a>02028             <span class="keywordflow">default</span>:
<a name="l02029"></a>02029                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Unexpected control subclass '%d'\n"</span>, f-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a>);
<a name="l02030"></a>02030                <span class="keywordflow">break</span>;
<a name="l02031"></a>02031             }
<a name="l02032"></a>02032             <span class="keywordflow">break</span>;
<a name="l02033"></a>02033          <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f9264fc4720a7b3982e2d4bf246fe3d9924">AST_FRAME_VOICE</a>:
<a name="l02034"></a>02034             <span class="comment">/* Write audio if appropriate */</span>
<a name="l02035"></a>02035             <span class="keywordflow">if</span> (audiofd &gt; -1)
<a name="l02036"></a>02036                write(audiofd, f-&gt;<a class="code" href="structast__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a>, f-&gt;<a class="code" href="structast__frame.html#106553e2afb20bec4268dd6bd02c952d">datalen</a>);
<a name="l02037"></a>02037          <span class="keywordflow">default</span>:
<a name="l02038"></a>02038             <span class="comment">/* Ignore */</span>
<a name="l02039"></a>02039             <span class="keywordflow">break</span>;
<a name="l02040"></a>02040          }
<a name="l02041"></a>02041          <a class="code" href="frame_8h.html#506c759ec4950e7f7465e8f090a6252b">ast_frfree</a>(f);
<a name="l02042"></a>02042       }
<a name="l02043"></a>02043    }
<a name="l02044"></a>02044    <span class="keywordflow">return</span> 0; <span class="comment">/* Time is up */</span>
<a name="l02045"></a>02045 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="76257a964ba665c0c5ff96edd1328d85"></a><!-- doxytag: member="channel.h::ast_walk_channel_by_exten_locked" ref="76257a964ba665c0c5ff96edd1328d85" args="(const struct ast_channel *chan, const char *exten, const char *context)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a>* ast_walk_channel_by_exten_locked           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get next channel by exten (and optionally context) and lock it. 
<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01020">1020</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l00928">channel_find_locked()</a>.
<p>
Referenced by <a class="el" href="app__chanspy_8c-source.html#l00443">next_channel()</a>.<div class="fragment"><pre class="fragment"><a name="l01022"></a>01022 {
<a name="l01023"></a>01023    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#188578d17e5577beb5ec3575458d3f71">channel_find_locked</a>(chan, NULL, 0, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>);
<a name="l01024"></a>01024 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1eee0e9ee6288a0786551187875a49d2"></a><!-- doxytag: member="channel.h::ast_walk_channel_by_name_prefix_locked" ref="1eee0e9ee6288a0786551187875a49d2" args="(const struct ast_channel *chan, const char *name, const int namelen)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a>* ast_walk_channel_by_name_prefix_locked           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const int&nbsp;</td>
          <td class="mdname" nowrap> <em>namelen</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get channel by name prefix (locks channel). 
<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l01007">1007</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l00928">channel_find_locked()</a>.
<p>
Referenced by <a class="el" href="app__chanspy_8c-source.html#l00443">next_channel()</a>.<div class="fragment"><pre class="fragment"><a name="l01009"></a>01009 {
<a name="l01010"></a>01010    <span class="keywordflow">return</span> <a class="code" href="channel_8c.html#188578d17e5577beb5ec3575458d3f71">channel_find_locked</a>(chan, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, namelen, NULL, NULL);
<a name="l01011"></a>01011 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="23f7af42552121e87bc52c819df4af48"></a><!-- doxytag: member="channel.h::ast_write" ref="23f7af42552121e87bc52c819df4af48" args="(struct ast_channel *chan, struct ast_frame *frame)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_write           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>fr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Write a frame to a channel This function writes the given frame to the indicated channel. 
<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>XXX should return 0 maybe ? </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l02660">2660</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00414">ast_channel::_softhangup</a>, <a class="el" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="channel_8c-source.html#l00325">ast_check_hangup()</a>, <a class="el" href="utils_8h-source.html#l00081">ast_clear_flag</a>, <a class="el" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389582c81bc89b064f8093864a6c023a823">AST_CONTROL_UNHOLD</a>, <a class="el" href="channel_8c-source.html#l01729">ast_deactivate_generator()</a>, <a class="el" href="channel_8c-source.html#l03406">ast_do_masquerade()</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730059fb89e0dc785928def8b9daa1a2d316">AST_FLAG_WHISPER</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730015fb5a488ff560040b677433b270fb5e">AST_FLAG_WRITE_INT</a>, <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>, <a class="el" href="frame_8h-source.html#l00233">AST_FORMAT_SLINEAR</a>, <a class="el" href="frame_8h-source.html#l00268">AST_FORMAT_T140</a>, <a class="el" href="frame_8c-source.html#l01441">ast_frame_adjust_volume()</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f923c709a87ba681b04d6a6285d6d0af892">AST_FRAME_DTMF_BEGIN</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f927fc7453b6ac78761e7a4e46b3fcfa557">AST_FRAME_DTMF_END</a>, <a class="el" href="frame_8c-source.html#l00698">ast_frame_dump()</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92a9ac2233f0025ec1b3d23e720cee92be">AST_FRAME_HTML</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92bf1d9c403ffb2c4b26845d97d1bce16e">AST_FRAME_IAX</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f9258a9185f9370d3f1076917c963b0de50">AST_FRAME_MODEM</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92eaf38b643259d44fcc0a869ab36609b1">AST_FRAME_NULL</a>, <a class="el" href="frame_8c-source.html#l01464">ast_frame_slinear_sum()</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92696800d27feca415d5c80113fb740f44">AST_FRAME_TEXT</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92f3104666df07b461099e43be37983393">AST_FRAME_VIDEO</a>, <a class="el" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f9264fc4720a7b3982e2d4bf246fe3d9924">AST_FRAME_VOICE</a>, <a class="el" href="frame_8h-source.html#l00396">ast_frfree()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="monitor_8h.html#68c252a4174f79a63bcedd9f1c0050884352f541f9b1e83d30923f2cec1777ef">AST_MONITOR_RUNNING</a>, <a class="el" href="lock_8h-source.html#l00530">ast_mutex_lock()</a>, <a class="el" href="lock_8h-source.html#l00520">ast_mutex_unlock()</a>, <a class="el" href="file_8c-source.html#l00676">ast_seekstream()</a>, <a class="el" href="channel_8c-source.html#l02562">ast_senddigit_begin()</a>, <a class="el" href="channel_8c-source.html#l02608">ast_senddigit_end()</a>, <a class="el" href="channel_8c-source.html#l02926">ast_set_write_format()</a>, <a class="el" href="slinfactory_8c-source.html#l00142">ast_slinfactory_available()</a>, <a class="el" href="slinfactory_8c-source.html#l00091">ast_slinfactory_read()</a>, <a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1cbe3f9a2385d6a31eac6abced2a9f17d">AST_SOFTHANGUP_DEV</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="translate_8c-source.html#l00295">ast_translate()</a>, <a class="el" href="translate_8c-source.html#l00255">ast_translator_build_path()</a>, <a class="el" href="translate_8c-source.html#l00245">ast_translator_free_path()</a>, <a class="el" href="file_8c-source.html#l00148">ast_writestream()</a>, <a class="el" href="adsistub_8c-source.html#l00065">buf</a>, <a class="el" href="channel_8h-source.html#l01387">CHECK_BLOCKING</a>, <a class="el" href="frame_8h-source.html#l00147">ast_frame::data</a>, <a class="el" href="frame_8h-source.html#l00135">ast_frame::datalen</a>, <a class="el" href="channel_8h-source.html#l00327">DEBUGCHAN_FLAG</a>, <a class="el" href="format__g726_8c-source.html#l00193">f</a>, <a class="el" href="channel_8h-source.html#l00464">ast_channel::fout</a>, <a class="el" href="channel_8h-source.html#l00330">FRAMECOUNT_INC</a>, <a class="el" href="frame_8h-source.html#l00131">ast_frame::frametype</a>, <a class="el" href="channel_8h-source.html#l00403">ast_channel::generatordata</a>, <a class="el" href="structast__channel__tech.html#3d2fea14faebc9196821215b29f70fbd">ast_channel_tech::indicate</a>, <a class="el" href="channel_8h-source.html#l00459">ast_channel::insmpl</a>, <a class="el" href="frame_8h-source.html#l00157">ast_frame::len</a>, <a class="el" href="channel_8c-source.html#l00085">ast_channel_whisper_buffer::lock</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="channel_8h-source.html#l00410">ast_channel::masq</a>, <a class="el" href="channel_8h-source.html#l00411">ast_channel::masqr</a>, <a class="el" href="channel_8h-source.html#l00457">ast_channel::monitor</a>, <a class="el" href="channel_8c-source.html#l00087">ast_channel_whisper_buffer::original_format</a>, <a class="el" href="channel_8h-source.html#l00460">ast_channel::outsmpl</a>, <a class="el" href="channel_8c-source.html#l00088">ast_channel_whisper_buffer::path</a>, <a class="el" href="channel_8c-source.html#l01472">queue_frame_to_spies()</a>, <a class="el" href="channel_8h-source.html#l00482">ast_channel::rawwriteformat</a>, <a class="el" href="frame_8h-source.html#l00137">ast_frame::samples</a>, <a class="el" href="file_8h-source.html#l00138">SEEK_FORCECUR</a>, <a class="el" href="channel_8c-source.html#l02047">send_dtmf_event()</a>, <a class="el" href="structast__channel__tech.html#b5688a161e75fbbe138b4d165d4b75f5">ast_channel_tech::send_html</a>, <a class="el" href="structast__channel__tech.html#fd5ce4dd24c70a0d6226a30b49fcf84b">ast_channel_tech::send_text</a>, <a class="el" href="channel_8c-source.html#l00086">ast_channel_whisper_buffer::sf</a>, <a class="el" href="channel_8h-source.html#l00484">ast_channel::spies</a>, <a class="el" href="channel_8c.html#3b5e30bd80e0b933a8ec0690ee5ba886e3b4d6702d1998b494bbab2603e96bcc">SPY_WRITE</a>, <a class="el" href="monitor_8h-source.html#l00043">ast_channel_monitor::state</a>, <a class="el" href="frame_8h-source.html#l00133">ast_frame::subclass</a>, <a class="el" href="channel_8h-source.html#l00385">ast_channel::tech</a>, <a class="el" href="channel_8h-source.html#l00485">ast_channel::whisper</a>, <a class="el" href="structast__channel__tech.html#dd9091ec5b5622ed21050e04562a2efe">ast_channel_tech::write</a>, <a class="el" href="monitor_8h-source.html#l00036">ast_channel_monitor::write_stream</a>, <a class="el" href="structast__channel__tech.html#a2427e74e53df159c998ddc8ab87124c">ast_channel_tech::write_text</a>, <a class="el" href="structast__channel__tech.html#b07ef32caa20658e63dce83d24dfdd1b">ast_channel_tech::write_video</a>, <a class="el" href="channel_8h-source.html#l00478">ast_channel::writeformat</a>, and <a class="el" href="channel_8h-source.html#l00479">ast_channel::writetrans</a>.
<p>
Referenced by <a class="el" href="res__adsi_8c-source.html#l00127">adsi_careful_send()</a>, <a class="el" href="chan__agent_8c-source.html#l00551">agent_write()</a>, <a class="el" href="channel_8c-source.html#l03797">ast_generic_bridge()</a>, <a class="el" href="channel_8c-source.html#l02631">ast_prod()</a>, <a class="el" href="file_8c-source.html#l00609">ast_readaudio_callback()</a>, <a class="el" href="file_8c-source.html#l00639">ast_readvideo_callback()</a>, <a class="el" href="channel_8c-source.html#l02649">ast_write_video()</a>, <a class="el" href="rtp_8c-source.html#l02909">bridge_native_loop()</a>, <a class="el" href="rtp_8c-source.html#l03195">bridge_p2p_loop()</a>, <a class="el" href="app__meetme_8c-source.html#l01250">conf_queue_dtmf()</a>, <a class="el" href="app__zapbarge_8c-source.html#l00093">conf_run()</a>, <a class="el" href="app__echo_8c-source.html#l00054">echo_exec()</a>, <a class="el" href="chan__features_8c-source.html#l00258">features_write()</a>, <a class="el" href="app__rpt_8c-source.html#l02757">function_ilink()</a>, <a class="el" href="app__externalivr_8c-source.html#l00201">gen_generate()</a>, <a class="el" href="app__rpt_8c-source.html#l03406">handle_link_data()</a>, <a class="el" href="chan__iax2_8c-source.html#l03198">iax2_bridge()</a>, <a class="el" href="abstract__jb_8c-source.html#l00381">jb_get_and_deliver()</a>, <a class="el" href="app_8c-source.html#l00301">linear_generator()</a>, <a class="el" href="app__milliwatt_8c-source.html#l00066">milliwatt_generate()</a>, <a class="el" href="chan__misdn_8c-source.html#l02789">misdn_bridge()</a>, <a class="el" href="res__musiconhold_8c-source.html#l00275">moh_files_generator()</a>, <a class="el" href="res__musiconhold_8c-source.html#l00742">moh_generate()</a>, <a class="el" href="app__mp3_8c-source.html#l00125">mp3_exec()</a>, <a class="el" href="app__nbscat_8c-source.html#l00116">NBScat_exec()</a>, <a class="el" href="indications_8c-source.html#l00147">playtones_generator()</a>, <a class="el" href="app__rpt_8c-source.html#l05604">rpt()</a>, <a class="el" href="app__rpt_8c-source.html#l02483">rpt_call()</a>, <a class="el" href="app__rpt_8c-source.html#l06759">rpt_exec()</a>, <a class="el" href="app__rpt_8c-source.html#l02713">send_link_dtmf()</a>, <a class="el" href="app__alarmreceiver_8c-source.html#l00170">send_tone_burst()</a>, <a class="el" href="app__festival_8c-source.html#l00171">send_waveform_to_channel()</a>, <a class="el" href="channel_8c-source.html#l04628">silence_generator_generate()</a>, <a class="el" href="app__sms_8c-source.html#l01489">sms_generate()</a>, <a class="el" href="app__chanspy_8c-source.html#l00185">spy_generate()</a>, <a class="el" href="channel_8c-source.html#l04290">tonepair_generator()</a>, <a class="el" href="app__dial_8c-source.html#l00532">wait_for_answer()</a>, and <a class="el" href="chan__zap_8c-source.html#l03412">zt_bridge()</a>.<div class="fragment"><pre class="fragment"><a name="l02661"></a>02661 {
<a name="l02662"></a>02662    <span class="keywordtype">int</span> res = -1;
<a name="l02663"></a>02663    <span class="keyword">struct </span><a class="code" href="structast__frame.html">ast_frame</a> *<a class="code" href="format__g726_8c.html#85b9b17a7dd34a3638c560bc9152473b">f</a> = NULL;
<a name="l02664"></a>02664 
<a name="l02665"></a>02665    <span class="comment">/* Stop if we're a zombie or need a soft hangup */</span>
<a name="l02666"></a>02666    <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l02667"></a>02667    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73003b8f6382b28b120cf101972539ed03d5">AST_FLAG_ZOMBIE</a>) || <a class="code" href="channel_8c.html#042e64a8d465783855a52ec8c56a9373">ast_check_hangup</a>(chan))
<a name="l02668"></a>02668       <span class="keywordflow">goto</span> done;
<a name="l02669"></a>02669 
<a name="l02670"></a>02670    <span class="comment">/* Handle any pending masquerades */</span>
<a name="l02671"></a>02671    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#f980faa30a783f7d18ceb4783afc1c69">masq</a> &amp;&amp; <a class="code" href="channel_8c.html#f788595bd51a58be12bb3c3b28a950ec">ast_do_masquerade</a>(chan)) {
<a name="l02672"></a>02672       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Failed to perform masquerade\n"</span>);
<a name="l02673"></a>02673       <span class="keywordflow">goto</span> done;
<a name="l02674"></a>02674    }
<a name="l02675"></a>02675    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#407a336ed0d13fc2cea1c71a81ad05df">masqr</a>) {
<a name="l02676"></a>02676       res = 0; <span class="comment">/* XXX explain, why 0 ? */</span>
<a name="l02677"></a>02677       <span class="keywordflow">goto</span> done;
<a name="l02678"></a>02678    }
<a name="l02679"></a>02679    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#68e80cee708fd0cdfb20807a8663721d">generatordata</a>) {
<a name="l02680"></a>02680       <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730015fb5a488ff560040b677433b270fb5e">AST_FLAG_WRITE_INT</a>))
<a name="l02681"></a>02681          <a class="code" href="channel_8c.html#e4e0e5c1767576b38fb1a893dfd8cb2b">ast_deactivate_generator</a>(chan);
<a name="l02682"></a>02682       <span class="keywordflow">else</span> {
<a name="l02683"></a>02683          <span class="keywordflow">if</span> (fr-&gt;<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a> == <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f927fc7453b6ac78761e7a4e46b3fcfa557">AST_FRAME_DTMF_END</a>) {
<a name="l02684"></a>02684             <span class="comment">/* There is a generator running while we're in the middle of a digit.</span>
<a name="l02685"></a>02685 <span class="comment">             * It's probably inband DTMF, so go ahead and pass it so it can</span>
<a name="l02686"></a>02686 <span class="comment">             * stop the generator */</span>
<a name="l02687"></a>02687             <a class="code" href="utils_8h.html#c2399a33be6ffb658bcf7c6a35531732">ast_clear_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>);
<a name="l02688"></a>02688             <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l02689"></a>02689             res = <a class="code" href="channel_8c.html#90ad873bd7f75ca212db0ab089def9f6">ast_senddigit_end</a>(chan, fr-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a>, fr-&gt;<a class="code" href="structast__frame.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a>);
<a name="l02690"></a>02690             <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l02691"></a>02691             <a class="code" href="channel_8h.html#722e76a74a7a5f5eb3efcd3cf30e7772">CHECK_BLOCKING</a>(chan);
<a name="l02692"></a>02692          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fr-&gt;<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a> == <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a> &amp;&amp; fr-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> == <a class="code" href="frame_8h.html#2d127e187c7a98c4396c337f2d76f389582c81bc89b064f8093864a6c023a823">AST_CONTROL_UNHOLD</a>) {
<a name="l02693"></a>02693             <span class="comment">/* This is a side case where Echo is basically being called and the person put themselves on hold and took themselves off hold */</span>
<a name="l02694"></a>02694             res = (chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#3d2fea14faebc9196821215b29f70fbd">indicate</a> == NULL) ? 0 :
<a name="l02695"></a>02695                chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#3d2fea14faebc9196821215b29f70fbd">indicate</a>(chan, fr-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a>, fr-&gt;<a class="code" href="structast__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a>, fr-&gt;<a class="code" href="structast__frame.html#106553e2afb20bec4268dd6bd02c952d">datalen</a>);
<a name="l02696"></a>02696          }
<a name="l02697"></a>02697          res = 0; <span class="comment">/* XXX explain, why 0 ? */</span>
<a name="l02698"></a>02698          <span class="keywordflow">goto</span> done;
<a name="l02699"></a>02699       }
<a name="l02700"></a>02700    }
<a name="l02701"></a>02701    <span class="comment">/* High bit prints debugging */</span>
<a name="l02702"></a>02702    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#048e72dbb3bdc2353732740741a72fe4">fout</a> &amp; <a class="code" href="channel_8h.html#121c28674a9262e968ca5860c9f3e511">DEBUGCHAN_FLAG</a>)
<a name="l02703"></a>02703       <a class="code" href="frame_8c.html#11dff4ae984427c6c3511b38359fe34a">ast_frame_dump</a>(chan-&gt;name, fr, <span class="stringliteral">"&gt;&gt;"</span>);
<a name="l02704"></a>02704    <a class="code" href="channel_8h.html#722e76a74a7a5f5eb3efcd3cf30e7772">CHECK_BLOCKING</a>(chan);
<a name="l02705"></a>02705    <span class="keywordflow">switch</span> (fr-&gt;<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a>) {
<a name="l02706"></a>02706    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92d7fbcef5adafabe47c2e42258e4f019e">AST_FRAME_CONTROL</a>:
<a name="l02707"></a>02707       res = (chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#3d2fea14faebc9196821215b29f70fbd">indicate</a> == NULL) ? 0 :
<a name="l02708"></a>02708          chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#3d2fea14faebc9196821215b29f70fbd">indicate</a>(chan, fr-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a>, fr-&gt;<a class="code" href="structast__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a>, fr-&gt;<a class="code" href="structast__frame.html#106553e2afb20bec4268dd6bd02c952d">datalen</a>);
<a name="l02709"></a>02709       <span class="keywordflow">break</span>;
<a name="l02710"></a>02710    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f923c709a87ba681b04d6a6285d6d0af892">AST_FRAME_DTMF_BEGIN</a>:
<a name="l02711"></a>02711       <a class="code" href="channel_8c.html#3b05b7a251816dfb6e4ded85a57f083b">send_dtmf_event</a>(chan, <span class="stringliteral">"Sent"</span>, fr-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a>, <span class="stringliteral">"Yes"</span>, <span class="stringliteral">"No"</span>);
<a name="l02712"></a>02712       <a class="code" href="utils_8h.html#c2399a33be6ffb658bcf7c6a35531732">ast_clear_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>);
<a name="l02713"></a>02713       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l02714"></a>02714       res = <a class="code" href="channel_8c.html#2fef33f939432bce542a9ccb28145652">ast_senddigit_begin</a>(chan, fr-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a>);
<a name="l02715"></a>02715       <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l02716"></a>02716       <a class="code" href="channel_8h.html#722e76a74a7a5f5eb3efcd3cf30e7772">CHECK_BLOCKING</a>(chan);
<a name="l02717"></a>02717       <span class="keywordflow">break</span>;
<a name="l02718"></a>02718    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f927fc7453b6ac78761e7a4e46b3fcfa557">AST_FRAME_DTMF_END</a>:
<a name="l02719"></a>02719       <a class="code" href="channel_8c.html#3b05b7a251816dfb6e4ded85a57f083b">send_dtmf_event</a>(chan, <span class="stringliteral">"Sent"</span>, fr-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a>, <span class="stringliteral">"No"</span>, <span class="stringliteral">"Yes"</span>);
<a name="l02720"></a>02720       <a class="code" href="utils_8h.html#c2399a33be6ffb658bcf7c6a35531732">ast_clear_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>);
<a name="l02721"></a>02721       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l02722"></a>02722       res = <a class="code" href="channel_8c.html#90ad873bd7f75ca212db0ab089def9f6">ast_senddigit_end</a>(chan, fr-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a>, fr-&gt;<a class="code" href="structast__frame.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a>);
<a name="l02723"></a>02723       <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l02724"></a>02724       <a class="code" href="channel_8h.html#722e76a74a7a5f5eb3efcd3cf30e7772">CHECK_BLOCKING</a>(chan);
<a name="l02725"></a>02725       <span class="keywordflow">break</span>;
<a name="l02726"></a>02726    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92696800d27feca415d5c80113fb740f44">AST_FRAME_TEXT</a>:
<a name="l02727"></a>02727       <span class="keywordflow">if</span> (fr-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> == <a class="code" href="frame_8h.html#e6ebe929c12bba52018c17fa9fdf2265">AST_FORMAT_T140</a>) {
<a name="l02728"></a>02728          res = (chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#a2427e74e53df159c998ddc8ab87124c">write_text</a> == NULL) ? 0 :
<a name="l02729"></a>02729             chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#a2427e74e53df159c998ddc8ab87124c">write_text</a>(chan, fr);
<a name="l02730"></a>02730       } <span class="keywordflow">else</span> {
<a name="l02731"></a>02731          res = (chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#fd5ce4dd24c70a0d6226a30b49fcf84b">send_text</a> == NULL) ? 0 :
<a name="l02732"></a>02732             chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#fd5ce4dd24c70a0d6226a30b49fcf84b">send_text</a>(chan, (<span class="keywordtype">char</span> *) fr-&gt;<a class="code" href="structast__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l02733"></a>02733       }
<a name="l02734"></a>02734       <span class="keywordflow">break</span>;
<a name="l02735"></a>02735    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92a9ac2233f0025ec1b3d23e720cee92be">AST_FRAME_HTML</a>:
<a name="l02736"></a>02736       res = (chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#b5688a161e75fbbe138b4d165d4b75f5">send_html</a> == NULL) ? 0 :
<a name="l02737"></a>02737          chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#b5688a161e75fbbe138b4d165d4b75f5">send_html</a>(chan, fr-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a>, (<span class="keywordtype">char</span> *) fr-&gt;<a class="code" href="structast__frame.html#8d777f385d3dfec8815d20f7496026dc">data</a>, fr-&gt;<a class="code" href="structast__frame.html#106553e2afb20bec4268dd6bd02c952d">datalen</a>);
<a name="l02738"></a>02738       <span class="keywordflow">break</span>;
<a name="l02739"></a>02739    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92f3104666df07b461099e43be37983393">AST_FRAME_VIDEO</a>:
<a name="l02740"></a>02740       <span class="comment">/* XXX Handle translation of video codecs one day XXX */</span>
<a name="l02741"></a>02741       res = (chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#b07ef32caa20658e63dce83d24dfdd1b">write_video</a> == NULL) ? 0 :
<a name="l02742"></a>02742          chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#b07ef32caa20658e63dce83d24dfdd1b">write_video</a>(chan, fr);
<a name="l02743"></a>02743       <span class="keywordflow">break</span>;
<a name="l02744"></a>02744    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f9258a9185f9370d3f1076917c963b0de50">AST_FRAME_MODEM</a>:
<a name="l02745"></a>02745       res = (chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#dd9091ec5b5622ed21050e04562a2efe">write</a> == NULL) ? 0 :
<a name="l02746"></a>02746          chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#dd9091ec5b5622ed21050e04562a2efe">write</a>(chan, fr);
<a name="l02747"></a>02747       <span class="keywordflow">break</span>;
<a name="l02748"></a>02748    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f9264fc4720a7b3982e2d4bf246fe3d9924">AST_FRAME_VOICE</a>:
<a name="l02749"></a>02749       <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#dd9091ec5b5622ed21050e04562a2efe">write</a> == NULL)
<a name="l02750"></a>02750          <span class="keywordflow">break</span>;   <span class="comment">/*! \todo XXX should return 0 maybe ? */</span>
<a name="l02751"></a>02751 
<a name="l02752"></a>02752       <span class="comment">/* If someone is whispering on this channel then we must ensure that we are always getting signed linear frames */</span>
<a name="l02753"></a>02753       <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730059fb89e0dc785928def8b9daa1a2d316">AST_FLAG_WHISPER</a>)) {
<a name="l02754"></a>02754          <span class="keywordflow">if</span> (fr-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> == <a class="code" href="frame_8h.html#ce4d062ff9a85be84b636e7ec67a068b">AST_FORMAT_SLINEAR</a>)
<a name="l02755"></a>02755             f = fr;
<a name="l02756"></a>02756          <span class="keywordflow">else</span> {
<a name="l02757"></a>02757             <a class="code" href="lock_8h.html#b3c5e3093b325167f88db93c8b4b2421">ast_mutex_lock</a>(&amp;chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l02758"></a>02758             <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#45a38ca474a4f1df88fe13d68bbb0b44">writeformat</a> != <a class="code" href="frame_8h.html#ce4d062ff9a85be84b636e7ec67a068b">AST_FORMAT_SLINEAR</a>) {
<a name="l02759"></a>02759                <span class="comment">/* Rebuild the translation path and set our write format back to signed linear */</span>
<a name="l02760"></a>02760                chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#c8ae1c62d224b4f0a5c49e99a77ed792">original_format</a> = chan-&gt;<a class="code" href="structast__channel.html#45a38ca474a4f1df88fe13d68bbb0b44">writeformat</a>;
<a name="l02761"></a>02761                <a class="code" href="channel_8c.html#ebcd70a10759c189c265a97b5a9f78c3">ast_set_write_format</a>(chan, <a class="code" href="frame_8h.html#ce4d062ff9a85be84b636e7ec67a068b">AST_FORMAT_SLINEAR</a>);
<a name="l02762"></a>02762                <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#d6fe1d0be6347b8ef2427fa629c04485">path</a>)
<a name="l02763"></a>02763                   <a class="code" href="translate_8c.html#8f7ccc974f6f91b750a59c4353700191">ast_translator_free_path</a>(chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#d6fe1d0be6347b8ef2427fa629c04485">path</a>);
<a name="l02764"></a>02764                chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#d6fe1d0be6347b8ef2427fa629c04485">path</a> = <a class="code" href="translate_8c.html#46306313154b293cae4c398153ef6f75">ast_translator_build_path</a>(<a class="code" href="frame_8h.html#ce4d062ff9a85be84b636e7ec67a068b">AST_FORMAT_SLINEAR</a>, chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#c8ae1c62d224b4f0a5c49e99a77ed792">original_format</a>);
<a name="l02765"></a>02765             }
<a name="l02766"></a>02766             <span class="comment">/* Translate frame using the above translation path */</span>
<a name="l02767"></a>02767             f = (chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#d6fe1d0be6347b8ef2427fa629c04485">path</a>) ? <a class="code" href="translate_8c.html#4c9e58469c9d65c1da8ecbe9cf52e749">ast_translate</a>(chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#d6fe1d0be6347b8ef2427fa629c04485">path</a>, fr, 0) : fr;
<a name="l02768"></a>02768             <a class="code" href="lock_8h.html#1d33e3caf152f0901c5ebdb69c2d4d26">ast_mutex_unlock</a>(&amp;chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l02769"></a>02769          }
<a name="l02770"></a>02770       } <span class="keywordflow">else</span> {
<a name="l02771"></a>02771          <span class="comment">/* If the frame is in the raw write format, then it's easy... just use the frame - otherwise we will have to translate */</span>
<a name="l02772"></a>02772          <span class="keywordflow">if</span> (fr-&gt;<a class="code" href="structast__frame.html#c00578b472e008b51fd24237785fa428">subclass</a> == chan-&gt;<a class="code" href="structast__channel.html#331ec3b1c98b3ffed254938780cac119">rawwriteformat</a>)
<a name="l02773"></a>02773             f = fr;
<a name="l02774"></a>02774          <span class="keywordflow">else</span>
<a name="l02775"></a>02775             f = (chan-&gt;<a class="code" href="structast__channel.html#539a57bca8693e9a17639bc306123548">writetrans</a>) ? <a class="code" href="translate_8c.html#4c9e58469c9d65c1da8ecbe9cf52e749">ast_translate</a>(chan-&gt;<a class="code" href="structast__channel.html#539a57bca8693e9a17639bc306123548">writetrans</a>, fr, 0) : fr;
<a name="l02776"></a>02776       }
<a name="l02777"></a>02777 
<a name="l02778"></a>02778       <span class="comment">/* If we have no frame of audio, then we have to bail out */</span>
<a name="l02779"></a>02779       <span class="keywordflow">if</span> (f == NULL) {
<a name="l02780"></a>02780          res = 0;
<a name="l02781"></a>02781          <span class="keywordflow">break</span>;
<a name="l02782"></a>02782       }
<a name="l02783"></a>02783 
<a name="l02784"></a>02784       <span class="comment">/* If spies are on the channel then queue the frame out to them */</span>
<a name="l02785"></a>02785       <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#5e6a55de0bea527db5f05883c77f39a6">spies</a>)
<a name="l02786"></a>02786          <a class="code" href="channel_8c.html#b9e289822f77fb0615938e04d36255c1">queue_frame_to_spies</a>(chan, f, <a class="code" href="channel_8c.html#3b5e30bd80e0b933a8ec0690ee5ba886e3b4d6702d1998b494bbab2603e96bcc">SPY_WRITE</a>);
<a name="l02787"></a>02787 
<a name="l02788"></a>02788       <span class="comment">/* If Monitor is running on this channel, then we have to write frames out there too */</span>
<a name="l02789"></a>02789       <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#08b5411f848a2581a41672a759c87380">monitor</a> &amp;&amp; chan-&gt;<a class="code" href="structast__channel.html#08b5411f848a2581a41672a759c87380">monitor</a>-&gt;<a class="code" href="structast__channel__monitor.html#439686cdff7be7eda400c1d1ed373c9d">write_stream</a>) {
<a name="l02790"></a>02790          <span class="comment">/* XXX must explain this code */</span>
<a name="l02791"></a>02791 <span class="preprocessor">#ifndef MONITOR_CONSTANT_DELAY</span>
<a name="l02792"></a>02792 <span class="preprocessor"></span>         <span class="keywordtype">int</span> jump = chan-&gt;<a class="code" href="structast__channel.html#04c934dbb3734166a2e68efce91d9b23">insmpl</a> - chan-&gt;<a class="code" href="structast__channel.html#9a22e94d51f281bd5308fb3ca9384735">outsmpl</a> - 4 * f-&gt;<a class="code" href="structast__frame.html#6ef9161b900632671022358216c7dfe7">samples</a>;
<a name="l02793"></a>02793          <span class="keywordflow">if</span> (jump &gt;= 0) {
<a name="l02794"></a>02794             jump = chan-&gt;<a class="code" href="structast__channel.html#04c934dbb3734166a2e68efce91d9b23">insmpl</a> - chan-&gt;<a class="code" href="structast__channel.html#9a22e94d51f281bd5308fb3ca9384735">outsmpl</a>;
<a name="l02795"></a>02795             <span class="keywordflow">if</span> (<a class="code" href="file_8c.html#02e10962dcfcb69e23bfaf15dce32393">ast_seekstream</a>(chan-&gt;<a class="code" href="structast__channel.html#08b5411f848a2581a41672a759c87380">monitor</a>-&gt;<a class="code" href="structast__channel__monitor.html#439686cdff7be7eda400c1d1ed373c9d">write_stream</a>, jump, <a class="code" href="file_8h.html#c499fc238ba5577289a5455d9118a510">SEEK_FORCECUR</a>) == -1)
<a name="l02796"></a>02796                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Failed to perform seek in monitoring write stream, synchronization between the files may be broken\n"</span>);
<a name="l02797"></a>02797             chan-&gt;<a class="code" href="structast__channel.html#9a22e94d51f281bd5308fb3ca9384735">outsmpl</a> += jump + f-&gt;<a class="code" href="structast__frame.html#6ef9161b900632671022358216c7dfe7">samples</a>;
<a name="l02798"></a>02798          } <span class="keywordflow">else</span>
<a name="l02799"></a>02799             chan-&gt;<a class="code" href="structast__channel.html#9a22e94d51f281bd5308fb3ca9384735">outsmpl</a> += f-&gt;<a class="code" href="structast__frame.html#6ef9161b900632671022358216c7dfe7">samples</a>;
<a name="l02800"></a>02800 <span class="preprocessor">#else</span>
<a name="l02801"></a>02801 <span class="preprocessor"></span>         <span class="keywordtype">int</span> jump = chan-&gt;<a class="code" href="structast__channel.html#04c934dbb3734166a2e68efce91d9b23">insmpl</a> - chan-&gt;<a class="code" href="structast__channel.html#9a22e94d51f281bd5308fb3ca9384735">outsmpl</a>;
<a name="l02802"></a>02802          <span class="keywordflow">if</span> (jump - MONITOR_DELAY &gt;= 0) {
<a name="l02803"></a>02803             <span class="keywordflow">if</span> (<a class="code" href="file_8c.html#02e10962dcfcb69e23bfaf15dce32393">ast_seekstream</a>(chan-&gt;<a class="code" href="structast__channel.html#08b5411f848a2581a41672a759c87380">monitor</a>-&gt;<a class="code" href="structast__channel__monitor.html#439686cdff7be7eda400c1d1ed373c9d">write_stream</a>, jump - f-&gt;<a class="code" href="structast__frame.html#6ef9161b900632671022358216c7dfe7">samples</a>, <a class="code" href="file_8h.html#c499fc238ba5577289a5455d9118a510">SEEK_FORCECUR</a>) == -1)
<a name="l02804"></a>02804                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Failed to perform seek in monitoring write stream, synchronization between the files may be broken\n"</span>);
<a name="l02805"></a>02805             chan-&gt;<a class="code" href="structast__channel.html#9a22e94d51f281bd5308fb3ca9384735">outsmpl</a> += jump;
<a name="l02806"></a>02806          } <span class="keywordflow">else</span>
<a name="l02807"></a>02807             chan-&gt;<a class="code" href="structast__channel.html#9a22e94d51f281bd5308fb3ca9384735">outsmpl</a> += f-&gt;<a class="code" href="structast__frame.html#6ef9161b900632671022358216c7dfe7">samples</a>;
<a name="l02808"></a>02808 <span class="preprocessor">#endif</span>
<a name="l02809"></a>02809 <span class="preprocessor"></span>         <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#08b5411f848a2581a41672a759c87380">monitor</a>-&gt;<a class="code" href="structast__channel__monitor.html#9ed39e2ea931586b6a985a6942ef573e">state</a> == <a class="code" href="monitor_8h.html#68c252a4174f79a63bcedd9f1c0050884352f541f9b1e83d30923f2cec1777ef">AST_MONITOR_RUNNING</a>) {
<a name="l02810"></a>02810             <span class="keywordflow">if</span> (<a class="code" href="file_8c.html#89845762896f1b8df8786e386b3a7493">ast_writestream</a>(chan-&gt;<a class="code" href="structast__channel.html#08b5411f848a2581a41672a759c87380">monitor</a>-&gt;<a class="code" href="structast__channel__monitor.html#439686cdff7be7eda400c1d1ed373c9d">write_stream</a>, f) &lt; 0)
<a name="l02811"></a>02811                <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Failed to write data to channel monitor write stream\n"</span>);
<a name="l02812"></a>02812          }
<a name="l02813"></a>02813       }
<a name="l02814"></a>02814 
<a name="l02815"></a>02815       <span class="comment">/* Finally the good part! Write this out to the channel */</span>
<a name="l02816"></a>02816       <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a730059fb89e0dc785928def8b9daa1a2d316">AST_FLAG_WHISPER</a>)) {
<a name="l02817"></a>02817          <span class="comment">/* frame is assumed to be in SLINEAR, since that is</span>
<a name="l02818"></a>02818 <span class="comment">            required for whisper mode */</span>
<a name="l02819"></a>02819          <a class="code" href="frame_8c.html#0f5d115410bf7f582584378b94d8d37b">ast_frame_adjust_volume</a>(f, -2);
<a name="l02820"></a>02820          <span class="keywordflow">if</span> (<a class="code" href="slinfactory_8c.html#2bcf3999b8a7aee054494209c1a709dd">ast_slinfactory_available</a>(&amp;chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#60d31eb37595dd44584be5ef363283e3">sf</a>) &gt;= f-&gt;<a class="code" href="structast__frame.html#6ef9161b900632671022358216c7dfe7">samples</a>) {
<a name="l02821"></a>02821             <span class="keywordtype">short</span> <a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>[f-&gt;<a class="code" href="structast__frame.html#6ef9161b900632671022358216c7dfe7">samples</a>];
<a name="l02822"></a>02822             <span class="keyword">struct </span><a class="code" href="structast__frame.html">ast_frame</a> whisper = {
<a name="l02823"></a>02823                .<a class="code" href="structast__frame.html#9574009b02f8256934a1a25cbac10e1d">frametype</a> = <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f9264fc4720a7b3982e2d4bf246fe3d9924">AST_FRAME_VOICE</a>,
<a name="l02824"></a>02824                .subclass = <a class="code" href="frame_8h.html#ce4d062ff9a85be84b636e7ec67a068b">AST_FORMAT_SLINEAR</a>,
<a name="l02825"></a>02825                .data = buf,
<a name="l02826"></a>02826                .datalen = <span class="keyword">sizeof</span>(buf),
<a name="l02827"></a>02827                .<a class="code" href="structast__frame.html#6ef9161b900632671022358216c7dfe7">samples</a> = f-&gt;<a class="code" href="structast__frame.html#6ef9161b900632671022358216c7dfe7">samples</a>,
<a name="l02828"></a>02828             };
<a name="l02829"></a>02829             
<a name="l02830"></a>02830             <a class="code" href="lock_8h.html#b3c5e3093b325167f88db93c8b4b2421">ast_mutex_lock</a>(&amp;chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l02831"></a>02831             <span class="keywordflow">if</span> (<a class="code" href="slinfactory_8c.html#baa9b4f450e0462abfe22b6f31e8c006">ast_slinfactory_read</a>(&amp;chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#60d31eb37595dd44584be5ef363283e3">sf</a>, buf, f-&gt;<a class="code" href="structast__frame.html#6ef9161b900632671022358216c7dfe7">samples</a>))
<a name="l02832"></a>02832                <a class="code" href="frame_8c.html#8a78ed734b1cafea2ab42e1363a330d0">ast_frame_slinear_sum</a>(f, &amp;whisper);
<a name="l02833"></a>02833             <a class="code" href="lock_8h.html#1d33e3caf152f0901c5ebdb69c2d4d26">ast_mutex_unlock</a>(&amp;chan-&gt;<a class="code" href="structast__channel.html#24412aa365632abdcbf6a6b047647146">whisper</a>-&gt;<a class="code" href="structast__channel__whisper__buffer.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l02834"></a>02834          }
<a name="l02835"></a>02835          <span class="comment">/* and now put it through the regular translator */</span>
<a name="l02836"></a>02836          f = (chan-&gt;<a class="code" href="structast__channel.html#539a57bca8693e9a17639bc306123548">writetrans</a>) ? <a class="code" href="translate_8c.html#4c9e58469c9d65c1da8ecbe9cf52e749">ast_translate</a>(chan-&gt;<a class="code" href="structast__channel.html#539a57bca8693e9a17639bc306123548">writetrans</a>, f, 0) : f;
<a name="l02837"></a>02837       }
<a name="l02838"></a>02838       res = f ? chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#dd9091ec5b5622ed21050e04562a2efe">write</a>(chan, f) : 0;
<a name="l02839"></a>02839       <span class="keywordflow">break</span>;
<a name="l02840"></a>02840    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92eaf38b643259d44fcc0a869ab36609b1">AST_FRAME_NULL</a>:
<a name="l02841"></a>02841    <span class="keywordflow">case</span> <a class="code" href="frame_8h.html#006fc84d03b57b7c7d571d6c0db69f92bf1d9c403ffb2c4b26845d97d1bce16e">AST_FRAME_IAX</a>:
<a name="l02842"></a>02842       <span class="comment">/* Ignore these */</span>
<a name="l02843"></a>02843       res = 0;
<a name="l02844"></a>02844       <span class="keywordflow">break</span>;
<a name="l02845"></a>02845    <span class="keywordflow">default</span>:
<a name="l02846"></a>02846       <span class="comment">/* At this point, fr is the incoming frame and f is NULL.  Channels do</span>
<a name="l02847"></a>02847 <span class="comment">       * not expect to get NULL as a frame pointer and will segfault.  Hence,</span>
<a name="l02848"></a>02848 <span class="comment">       * we output the original frame passed in. */</span>
<a name="l02849"></a>02849       res = chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#dd9091ec5b5622ed21050e04562a2efe">write</a>(chan, fr);
<a name="l02850"></a>02850       <span class="keywordflow">break</span>;
<a name="l02851"></a>02851    }
<a name="l02852"></a>02852 
<a name="l02853"></a>02853    <span class="keywordflow">if</span> (f &amp;&amp; f != fr)
<a name="l02854"></a>02854       <a class="code" href="frame_8h.html#506c759ec4950e7f7465e8f090a6252b">ast_frfree</a>(f);
<a name="l02855"></a>02855    <a class="code" href="utils_8h.html#c2399a33be6ffb658bcf7c6a35531732">ast_clear_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a7300770f2eb0c3db1b6cd4b4d1b9cf363672">AST_FLAG_BLOCKING</a>);
<a name="l02856"></a>02856    <span class="comment">/* Consider a write failure to force a soft hangup */</span>
<a name="l02857"></a>02857    <span class="keywordflow">if</span> (res &lt; 0)
<a name="l02858"></a>02858       chan-&gt;<a class="code" href="structast__channel.html#639992b4f019d91b38ac20bc55e05805">_softhangup</a> |= <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a1cbe3f9a2385d6a31eac6abced2a9f17d">AST_SOFTHANGUP_DEV</a>;
<a name="l02859"></a>02859    <span class="keywordflow">else</span> {
<a name="l02860"></a>02860       chan-&gt;<a class="code" href="structast__channel.html#048e72dbb3bdc2353732740741a72fe4">fout</a> = <a class="code" href="channel_8h.html#b6dc83815263d1b5a94deeee2f90ef5e">FRAMECOUNT_INC</a>(chan-&gt;<a class="code" href="structast__channel.html#048e72dbb3bdc2353732740741a72fe4">fout</a>);
<a name="l02861"></a>02861    }
<a name="l02862"></a>02862 done:
<a name="l02863"></a>02863    <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l02864"></a>02864    <span class="keywordflow">return</span> res;
<a name="l02865"></a>02865 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="46135c3aee6b7463d4f371ee31398e8c"></a><!-- doxytag: member="channel.h::ast_write_text" ref="46135c3aee6b7463d4f371ee31398e8c" args="(struct ast_channel *chan, struct ast_frame *frame)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_write_text           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>frame</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Write text frame to a channel This function writes the given frame to the indicated channel. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>destination channel of the frame </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>frame</em>&nbsp;</td><td>frame that will be written </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>It returns 1 on success, 0 if not implemented, and -1 on failure. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="cc48da89fee89a00916d78c6fb74e525"></a><!-- doxytag: member="channel.h::ast_write_video" ref="cc48da89fee89a00916d78c6fb74e525" args="(struct ast_channel *chan, struct ast_frame *frame)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_write_video           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__frame.html">ast_frame</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>frame</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Write video frame to a channel This function writes the given frame to the indicated channel. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>destination channel of the frame </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>frame</em>&nbsp;</td><td>frame that will be written </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>It returns 1 on success, 0 if not implemented, and -1 on failure. </dd></dl>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l02649">2649</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l02660">ast_write()</a>, <a class="el" href="channel_8h-source.html#l00385">ast_channel::tech</a>, and <a class="el" href="structast__channel__tech.html#b07ef32caa20658e63dce83d24dfdd1b">ast_channel_tech::write_video</a>.<div class="fragment"><pre class="fragment"><a name="l02650"></a>02650 {
<a name="l02651"></a>02651    <span class="keywordtype">int</span> res;
<a name="l02652"></a>02652    <span class="keywordflow">if</span> (!chan-&gt;<a class="code" href="structast__channel.html#d9f9133fb120cd6096870bc2b496805b">tech</a>-&gt;<a class="code" href="structast__channel__tech.html#b07ef32caa20658e63dce83d24dfdd1b">write_video</a>)
<a name="l02653"></a>02653       <span class="keywordflow">return</span> 0;
<a name="l02654"></a>02654    res = <a class="code" href="channel_8c.html#57a74c4c7b7e25ad61a4f461e3c73158">ast_write</a>(chan, fr);
<a name="l02655"></a>02655    <span class="keywordflow">if</span> (!res)
<a name="l02656"></a>02656       res = 1;
<a name="l02657"></a>02657    <span class="keywordflow">return</span> res;
<a name="l02658"></a>02658 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="877faf4f25816c15c87b3b95c439ce1e"></a><!-- doxytag: member="channel.h::channelreloadreason2txt" ref="877faf4f25816c15c87b3b95c439ce1e" args="(enum channelreloadreason reason)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* channelreloadreason2txt           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">enum <a class="el" href="channel_8h.html#a49c7ae4d656ef2e220ceae47cb045f2">channelreloadreason</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>reason</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Convert enum channelreloadreason to text string for manager event. 
<p>
\ brief Convert channel reloadreason (ENUM) to text string for manager event 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l04696">4696</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
References <a class="el" href="channel_8h.html#a49c7ae4d656ef2e220ceae47cb045f2950ce6983714a51f62494c5b16daf99d">CHANNEL_CLI_RELOAD</a>, <a class="el" href="channel_8h.html#a49c7ae4d656ef2e220ceae47cb045f2704c328f9fec2df0f273fc084c46bb5c">CHANNEL_MODULE_LOAD</a>, and <a class="el" href="channel_8h.html#a49c7ae4d656ef2e220ceae47cb045f2a6546d2270d01e15c994b899c015a868">CHANNEL_MODULE_RELOAD</a>.
<p>
Referenced by <a class="el" href="chan__sip_8c-source.html#l17179">reload_config()</a>.<div class="fragment"><pre class="fragment"><a name="l04697"></a>04697 {
<a name="l04698"></a>04698    <span class="keywordflow">switch</span> (reason) {
<a name="l04699"></a>04699    <span class="keywordflow">case</span> <a class="code" href="channel_8h.html#a49c7ae4d656ef2e220ceae47cb045f2704c328f9fec2df0f273fc084c46bb5c">CHANNEL_MODULE_LOAD</a>:
<a name="l04700"></a>04700       <span class="keywordflow">return</span> <span class="stringliteral">"LOAD (Channel module load)"</span>;
<a name="l04701"></a>04701 
<a name="l04702"></a>04702    <span class="keywordflow">case</span> <a class="code" href="channel_8h.html#a49c7ae4d656ef2e220ceae47cb045f2a6546d2270d01e15c994b899c015a868">CHANNEL_MODULE_RELOAD</a>:
<a name="l04703"></a>04703       <span class="keywordflow">return</span> <span class="stringliteral">"RELOAD (Channel module reload)"</span>;
<a name="l04704"></a>04704 
<a name="l04705"></a>04705    <span class="keywordflow">case</span> <a class="code" href="channel_8h.html#a49c7ae4d656ef2e220ceae47cb045f2950ce6983714a51f62494c5b16daf99d">CHANNEL_CLI_RELOAD</a>:
<a name="l04706"></a>04706       <span class="keywordflow">return</span> <span class="stringliteral">"CLIRELOAD (Channel module reload by CLI command)"</span>;
<a name="l04707"></a>04707 
<a name="l04708"></a>04708    <span class="keywordflow">default</span>:
<a name="l04709"></a>04709       <span class="keywordflow">return</span> <span class="stringliteral">"MANAGERRELOAD (Channel module reload by manager)"</span>;
<a name="l04710"></a>04710    }
<a name="l04711"></a>04711 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="fb1a13eb3cfac4d9cfb7c4b0d2865bde"></a><!-- doxytag: member="channel.h::global_fin" ref="fb1a13eb3cfac4d9cfb7c4b0d2865bde" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">unsigned long <a class="el" href="channel_8h.html#fb1a13eb3cfac4d9cfb7c4b0d2865bde">global_fin</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The current value of the debug flags is stored in the two variables global_fin and global_fout (declared in main/channel.c) 
<p>
Definition at line <a class="el" href="channel_8c-source.html#l00102">102</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l00632">ast_channel_alloc()</a>, and <a class="el" href="cli_8c-source.html#l00677">handle_core_set_debug_channel()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="2173c5282c13757472cb6ac76d8ecdad"></a><!-- doxytag: member="channel.h::global_fout" ref="2173c5282c13757472cb6ac76d8ecdad" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">unsigned long <a class="el" href="channel_8h.html#2173c5282c13757472cb6ac76d8ecdad">global_fout</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="channel_8c-source.html#l00102">102</a> of file <a class="el" href="channel_8c-source.html">channel.c</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l00632">ast_channel_alloc()</a>, and <a class="el" href="cli_8c-source.html#l00677">handle_core_set_debug_channel()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Thu May 24 22:27:24 2007 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.5 </small></address>
</body>
</html>
