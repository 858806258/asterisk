<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (24 May 2007)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Thu May 24 22:27:39 2007</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir__2Fusr_2Flocal_2Fsrc_2Fasterisk_2Esvn_2Fastum_2Finclude_2F.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir__2Fusr_2Flocal_2Fsrc_2Fasterisk_2Esvn_2Fastum_2Finclude_2Fasterisk_2F.html">asterisk</a></div>
<h1>pbx.h File Reference</h1>Core PBX routines and definitions. <a href="#_details">More...</a>
<p>
<code>#include &quot;<a class="el" href="sched_8h-source.html">asterisk/sched.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="channel_8h-source.html">asterisk/channel.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="linkedlists_8h-source.html">asterisk/linkedlists.h</a>&quot;</code><br>

<p>
<a href="pbx_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__custom__function.html">ast_custom_function</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Data structure associated with a custom dialplan function.  <a href="structast__custom__function.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__pbx.html">ast_pbx</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__switch.html">ast_switch</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structast__timing.html">ast_timing</a></td></tr>

<tr><td colspan="2">Functions for returning values from structures <br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#61636cd55acce8616de92323b8a427b9">ast_get_extension_context</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#4318ec15d92ac47de94902f6aba4c114">ast_get_extension_name</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#8362b5fbecbf06d68596f1361a817971">ast_get_ignorepat_name</a> (struct <a class="el" href="structast__ignorepat.html">ast_ignorepat</a> *ip)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#4a816e24ecefa880d77ecdb16ad2deb5">ast_get_include_name</a> (struct <a class="el" href="structast__include.html">ast_include</a> *include)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#ee960249076eea022f3aaa855b0a2475">ast_get_switch_data</a> (struct <a class="el" href="structast__sw.html">ast_sw</a> *sw)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#e78e1da5bf7f86cd550128a0cc440658">ast_get_switch_name</a> (struct <a class="el" href="structast__sw.html">ast_sw</a> *sw)</td></tr>

<tr><td colspan="2"><br><h2>Registrar info functions ...</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#76308d8bcceb0331e0d4736df41b1412">ast_get_context_registrar</a> (struct <a class="el" href="structast__context.html">ast_context</a> *c)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#20537e2517918a112d0b738d8c70cae2">ast_get_extension_registrar</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *e)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#ecf759381e5bb2d13dbf2188d6728217">ast_get_ignorepat_registrar</a> (struct <a class="el" href="structast__ignorepat.html">ast_ignorepat</a> *ip)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#a10e2a34982bf1e3c4df8fbf94a8f858">ast_get_include_registrar</a> (struct <a class="el" href="structast__include.html">ast_include</a> *i)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#6e9fbaaa189820f4a0c36a1ad4dfca6d">ast_get_switch_registrar</a> (struct <a class="el" href="structast__sw.html">ast_sw</a> *sw)</td></tr>

<tr><td colspan="2"><br><h2>Other Extension stuff</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#c8eaa4fc248390fee258e7d2b2ff3490">ast_get_extension_app</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *e)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#4a723bd9d782fe0a3fb16d00268ec5a4">ast_get_extension_app_data</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *e)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#05032ac07f5935587193e7da044e30de">ast_get_extension_cidmatch</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *e)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#ec068be9b53a7d12a6e733c4c49c3f43">ast_get_extension_label</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *e)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#8c7f1a8dd6fbdb6df987ac164ef7fdfc">ast_get_extension_matchcid</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *e)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#ecebedf381a09dd2630dc03e49b83112">ast_get_extension_priority</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>)</td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#a973a2fecfe2da6df7aaf2d5be3ea548">AST_MAX_APP</a>&nbsp;&nbsp;&nbsp;32</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#b4f6b32260006d527a95b442625161f2">AST_PBX_KEEP</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#60ed4b0965b6f9aa117240879d402201">AST_PBX_KEEPALIVE</a>&nbsp;&nbsp;&nbsp;10</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Special return values from applications to the PBX {.  <a href="#60ed4b0965b6f9aa117240879d402201"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#5e2459a77c1072ded5128a9c607a9e95">AST_PBX_NO_HANGUP_PEER</a>&nbsp;&nbsp;&nbsp;11</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#96251919ed68f34ea9b3a48b6166256b">AST_PBX_REPLACE</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#ab1e94ec9073ecc8bcedd7b11dd82001">PRIORITY_HINT</a>&nbsp;&nbsp;&nbsp;-1</td></tr>

<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef int(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#a083658b5411c328227915675531df43">ast_state_cb_type</a> )(char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, char *<a class="el" href="app__queue_8c.html#b80bb7740288fda1f201890375a60c8f">id</a>, enum <a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75">ast_extension_states</a> <a class="el" href="structstate.html">state</a>, void *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Typedef for devicestate and hint callbacks.  <a href="#a083658b5411c328227915675531df43"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef int(&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#9ca45d5d91ac596db3ca4ad7325420d9">ast_switch_f</a> )(struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority, const char *callerid, const char *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">All switch functions have the same interface, so define a type for them.  <a href="#9ca45d5d91ac596db3ca4ad7325420d9"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75">ast_extension_states</a> { <br>
&nbsp;&nbsp;<a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f7564c0d9d79bfb21b4578eb245ddcecd9a">AST_EXTENSION_REMOVED</a> =  -2, 
<a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75ba2a7d54f03c58c97ed6230623a70d4b">AST_EXTENSION_DEACTIVATED</a> =  -1, 
<a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f755fc09a563f5aee5b8cc58e535cbe6957">AST_EXTENSION_NOT_INUSE</a> =  0, 
<a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75af76c61ff1afcc94e335402cda274f0c">AST_EXTENSION_INUSE</a> =  1 &lt;&lt; 0, 
<br>
&nbsp;&nbsp;<a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75721f2af8b4a4abcc783fce2791af6d13">AST_EXTENSION_BUSY</a> =  1 &lt;&lt; 1, 
<a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75555002246e0b0325196808797905c17d">AST_EXTENSION_UNAVAILABLE</a> =  1 &lt;&lt; 2, 
<a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75dfc0eb724f114235813e772b93bca550">AST_EXTENSION_RINGING</a> =  1 &lt;&lt; 3, 
<a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f7541e76c8a6fe6c7824228f2613672c524">AST_EXTENSION_ONHOLD</a> =  1 &lt;&lt; 4
<br>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extension states.  <a href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912">ast_pbx_result</a> { <a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912c86643c5e19588b3eb7dce58a2b4145a">AST_PBX_SUCCESS</a> =  0, 
<a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912f5f5d3987a33fd6012262bab9c332519">AST_PBX_FAILED</a> =  -1, 
<a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a9126d32a4969792a16a712111cd4664d1c8">AST_PBX_CALL_LIMIT</a> =  -2
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The result codes when starting the PBX on a channel with <a class="el" href="pbx_8c.html#c55e82ff3dabed89efd77f20209b1006">ast_pbx_start()</a>.  <a href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#12b93bee10e4fd5d30576d7a6877e12b">ast_active_calls</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve the number of active calls.  <a href="#12b93bee10e4fd5d30576d7a6877e12b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#b77a5344eb4a1e2404c81a2a593deff5">ast_add_extension</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, int replace, const char *extension, int priority, const char *label, const char *callerid, const char *application, void *data, void(*datad)(void *), const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add and extension to an extension context.  <a href="#b77a5344eb4a1e2404c81a2a593deff5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#0985a9a977ba8aa4f370da3a495437ae">ast_add_extension2</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, int replace, const char *extension, int priority, const char *label, const char *callerid, const char *application, void *data, void(*datad)(void *), const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add an extension to an extension context, this time with an <a class="el" href="structast__context.html">ast_context</a> *.  <a href="#0985a9a977ba8aa4f370da3a495437ae"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#563b92a651459898f8ccfdc367746147">ast_async_goto</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#bd461ad63e07348133ddb0e31198452e">ast_async_goto_by_name</a> (const char *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#26ff43c7d96ccf5b00248d0793ce93f5">ast_async_goto_if_exists</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#0d09633715f9b26a7c4922f1a12ff102">ast_build_timing</a> (struct <a class="el" href="structast__timing.html">ast_timing</a> *i, const char *info)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#8cdcfc880eae31c1eaa91e154491b5bc">ast_canmatch_extension</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority, const char *callerid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Looks for a valid matching extension.  <a href="#8cdcfc880eae31c1eaa91e154491b5bc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#4dee27d639900ebea4f8b3c0366a197f">ast_check_timing</a> (const struct <a class="el" href="structast__timing.html">ast_timing</a> *i)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#d6db132e358d62d48a7379a59ebb9d19">ast_context_add_ignorepat</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *ignorepat, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add an ignorepat.  <a href="#d6db132e358d62d48a7379a59ebb9d19"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#e9036391e21fdf739d18ea7c2fced9e1">ast_context_add_ignorepat2</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, const char *ignorepat, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#ccdd98c0e8816634393437aad7cc5e01">ast_context_add_include</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *include, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a context include.  <a href="#ccdd98c0e8816634393437aad7cc5e01"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#626649005def49b89252e8b9ad0c3d46">ast_context_add_include2</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, const char *include, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a context include.  <a href="#626649005def49b89252e8b9ad0c3d46"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#afa734254246b0a5d03b045767bf645c">ast_context_add_switch</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *sw, const char *data, int eval, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a switch.  <a href="#afa734254246b0a5d03b045767bf645c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#28ff3bafac28fac8abda2d03f0f154ec">ast_context_add_switch2</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, const char *sw, const char *data, int eval, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds a switch (first param is a <a class="el" href="structast__context.html">ast_context</a>).  <a href="#28ff3bafac28fac8abda2d03f0f154ec"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#9b7261abb02956903bb17c5bf8af265a">ast_context_create</a> (struct <a class="el" href="structast__context.html">ast_context</a> **extcontexts, const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Register a new context.  <a href="#9b7261abb02956903bb17c5bf8af265a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#ac0d672d0448b82e3b3eac25b400d4d2">ast_context_destroy</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destroy a context (matches the specified context (or ANY context if NULL).  <a href="#ac0d672d0448b82e3b3eac25b400d4d2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#f8c5b4e7d06b7aff72707b5d7d7c94e1">ast_context_find</a> (const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find a context.  <a href="#f8c5b4e7d06b7aff72707b5d7d7c94e1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#773dc5d298a6de227dfddae824e996d7">ast_context_find_or_create</a> (struct <a class="el" href="structast__context.html">ast_context</a> **extcontexts, const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Register a new context or find an existing one.  <a href="#773dc5d298a6de227dfddae824e996d7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#35f43efa8b6f025e116b28e16d7cd355">ast_context_lockmacro</a> (const char *macrocontext)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">locks the macrolock in the given given context  <a href="#35f43efa8b6f025e116b28e16d7cd355"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#ed70bf6c908a1c70415454997c0d7902">ast_context_remove_extension</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *extension, int priority, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Simply remove extension from context.  <a href="#ed70bf6c908a1c70415454997c0d7902"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#c1d85c0d2ff75a7c476fa8379affd931">ast_context_remove_extension2</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, const char *extension, int priority, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This functionc locks given context, search for the right extension and fires out all peer in this extensions with given priority. If priority is set to 0, all peers are removed. After that, unlock context and return.  <a href="#c1d85c0d2ff75a7c476fa8379affd931"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#041875d3b92a3d0f748b8a0203e042a0">ast_context_remove_ignorepat</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *ignorepat, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#ad389cee2e8dda09b52d35340ddd294b">ast_context_remove_ignorepat2</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, const char *ignorepat, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#4318ec7b57c8064d746a1a395b5459bb">ast_context_remove_include</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *include, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove a context include.  <a href="#4318ec7b57c8064d746a1a395b5459bb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#c9afd67fae6ebbdc4e991024f69cff82">ast_context_remove_include2</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, const char *include, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Removes an include by an <a class="el" href="structast__context.html">ast_context</a> structure.  <a href="#c9afd67fae6ebbdc4e991024f69cff82"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#2db384d8d5d6a3155584ba62248a466a">ast_context_remove_switch</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *sw, const char *data, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove a switch.  <a href="#2db384d8d5d6a3155584ba62248a466a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#70c9b3efb9b5ad9ac26580cc90536fff">ast_context_remove_switch2</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, const char *sw, const char *data, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function locks given context, removes switch, unlock context and return.  <a href="#70c9b3efb9b5ad9ac26580cc90536fff"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#31dbf16f2aa0ba7d3e7173e851a13437">ast_context_unlockmacro</a> (const char *macrocontext)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unlocks the macrolock in the given context.  <a href="#31dbf16f2aa0ba7d3e7173e851a13437"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#d08532bf153875f677d2d3c59b13397f">ast_context_verify_includes</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Verifies includes in an ast_contect structure.  <a href="#d08532bf153875f677d2d3c59b13397f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__custom__function.html">ast_custom_function</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#2f6033daa3dd2a6a51ee380a86a783ba">ast_custom_function_find</a> (const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#93b5bf1865d6f3290372ca5ee3274391">ast_custom_function_register</a> (struct <a class="el" href="structast__custom__function.html">ast_custom_function</a> *acf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reigster a custom function.  <a href="#93b5bf1865d6f3290372ca5ee3274391"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#cfc1bbe0fad0bcf852611eaee79b2d03">ast_custom_function_unregister</a> (struct <a class="el" href="structast__custom__function.html">ast_custom_function</a> *acf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unregister a custom function.  <a href="#cfc1bbe0fad0bcf852611eaee79b2d03"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#90b58be34145fcfd99652f0c3ae7377d">ast_exists_extension</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority, const char *callerid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Determine whether an extension exists.  <a href="#90b58be34145fcfd99652f0c3ae7377d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#1e0079c7f2934dd7ebe801fefe4057da">ast_explicit_goto</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#a82c6deae96c20bc56e29d921d6e036f">ast_extension_close</a> (const char *pattern, const char *data, int needmore)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#07a807af656bad67ca8118e88987b263">ast_extension_match</a> (const char *pattern, const char *extension)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Determine if a given extension matches a given pattern (in NXX format).  <a href="#07a807af656bad67ca8118e88987b263"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#3c3c36826d708839388bcc4c935de3a6">ast_extension_patmatch</a> (const char *pattern, const char *data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#16769dc669e528ae10a063594fb7f4ae">ast_extension_state</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Uses hint and devicestate callback to get the state of an extension.  <a href="#16769dc669e528ae10a063594fb7f4ae"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#c4e2c1f2a0862db3fb3faa3d5dd9350c">ast_extension_state2str</a> (int extension_state)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return string representation of the state of an extension.  <a href="#c4e2c1f2a0862db3fb3faa3d5dd9350c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#14f63100164300fc4b55b09d6c3474fd">ast_extension_state_add</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="el" href="pbx_8h.html#a083658b5411c328227915675531df43">ast_state_cb_type</a> callback, void *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Registers a state change callback.  <a href="#14f63100164300fc4b55b09d6c3474fd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#2eee51fa21b14e53302712d806421fbb">ast_extension_state_del</a> (int <a class="el" href="app__queue_8c.html#b80bb7740288fda1f201890375a60c8f">id</a>, <a class="el" href="pbx_8h.html#a083658b5411c328227915675531df43">ast_state_cb_type</a> callback)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deletes a registered state change callback by ID.  <a href="#2eee51fa21b14e53302712d806421fbb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#6f1b63f69b489517c49ccfecdbe1642e">ast_findlabel_extension</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, const char *label, const char *callerid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find the priority of an extension that has the specified label.  <a href="#6f1b63f69b489517c49ccfecdbe1642e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#7139f616e9b477dc630ba7cec0c22df4">ast_findlabel_extension2</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, struct <a class="el" href="structast__context.html">ast_context</a> *con, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, const char *label, const char *callerid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find the priority of an extension that has the specified label.  <a href="#7139f616e9b477dc630ba7cec0c22df4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#fc067f1890b3fdeeacbc538e92a39fbd">ast_func_read</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *function, char *workspace, size_t len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">executes a read operation on a function  <a href="#fc067f1890b3fdeeacbc538e92a39fbd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#2432c0e88181cb3ba2c1a2764b0a6238">ast_func_write</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *function, const char *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">executes a write operation on a function  <a href="#2432c0e88181cb3ba2c1a2764b0a6238"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#3afea100b9227e24b1334dced9595864">ast_get_hint</a> (char *hint, int maxlen, char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, int maxnamelen, struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">If an extension hint exists, return non-zero.  <a href="#3afea100b9227e24b1334dced9595864"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#66e271b78f5b09452a521e220c223e1e">ast_goto_if_exists</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#5bc7455c31be4c32a90e55a101009fdf">ast_hint_state_changed</a> (const char *device)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#3c8a7255ea36a7270c24fd5ccccc56f6">ast_ignore_pattern</a> (const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *pattern)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Checks to see if a number should be ignored.  <a href="#3c8a7255ea36a7270c24fd5ccccc56f6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#6e9c6f3a112b82510968f729fa3765bc">ast_matchmore_extension</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority, const char *callerid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Looks to see if adding anything to this extension might match something. (exists ^ canmatch).  <a href="#6e9c6f3a112b82510968f729fa3765bc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#6a86443aa2d56a55b117b3f985565bcb">ast_merge_contexts_and_delete</a> (struct <a class="el" href="structast__context.html">ast_context</a> **extcontexts, const char *<a class="el" href="res__features_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Merge the temporary contexts into a global contexts list and delete from the global list the ones that are being added.  <a href="#6a86443aa2d56a55b117b3f985565bcb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#86eba1ec3178373f61c082e1f1f12b68">ast_parseable_goto</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *goto_string)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#8bd05d7cdf218eaecfb4a33dd0eb32d8">ast_pbx_outgoing_app</a> (const char *<a class="el" href="chan__nbs_8c.html#a73364531569a868150462e5a44f29c8">type</a>, int <a class="el" href="cdr__custom_8c.html#b954976e6264c40232046aacb5b7c390">format</a>, void *data, int timeout, const char *<a class="el" href="res__agi_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>, const char *appdata, int *reason, int sync, const char *<a class="el" href="chan__skinny_8c.html#ca3c0eb6b6e898f3a32aed5de1320774">cid_num</a>, const char *<a class="el" href="chan__skinny_8c.html#70f178a59d8df82fe5e107da71415b9b">cid_name</a>, struct <a class="el" href="structast__variable.html">ast_variable</a> *vars, const char *account, struct <a class="el" href="structast__channel.html">ast_channel</a> **locked_channel)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#6258fddab1409e4a7b96577ece3f2364">ast_pbx_outgoing_exten</a> (const char *<a class="el" href="chan__nbs_8c.html#a73364531569a868150462e5a44f29c8">type</a>, int <a class="el" href="cdr__custom_8c.html#b954976e6264c40232046aacb5b7c390">format</a>, void *data, int timeout, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority, int *reason, int sync, const char *<a class="el" href="chan__skinny_8c.html#ca3c0eb6b6e898f3a32aed5de1320774">cid_num</a>, const char *<a class="el" href="chan__skinny_8c.html#70f178a59d8df82fe5e107da71415b9b">cid_name</a>, struct <a class="el" href="structast__variable.html">ast_variable</a> *vars, const char *account, struct <a class="el" href="structast__channel.html">ast_channel</a> **locked_channel)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">enum <a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912">ast_pbx_result</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#235c18a381a9501a4dc41b06b080c24f">ast_pbx_run</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Execute the PBX in the current thread.  <a href="#235c18a381a9501a4dc41b06b080c24f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum <a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912">ast_pbx_result</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#c55e82ff3dabed89efd77f20209b1006">ast_pbx_start</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a new thread and start the PBX.  <a href="#c55e82ff3dabed89efd77f20209b1006"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#a09f0d0ac316a1ae5c74d6958d2b913e">ast_rdlock_context</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read locks a given context.  <a href="#a09f0d0ac316a1ae5c74d6958d2b913e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#74950b58e1607aa4ba6cf1f2d2f5813d">ast_rdlock_contexts</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read locks the context list.  <a href="#74950b58e1607aa4ba6cf1f2d2f5813d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#f8e9b339fed38c405332f222cceeec40">ast_register_application</a> (const char *<a class="el" href="res__agi_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>, int(*execute)(struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *), const char *<a class="el" href="res__features_8c.html#512fbb4e7b617c04031f58b631f2b05d">synopsis</a>, const char *description)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Register an application.  <a href="#f8e9b339fed38c405332f222cceeec40"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#ce9b1b9b9951df409f13e9c6c9a94d71">ast_register_switch</a> (struct <a class="el" href="structast__switch.html">ast_switch</a> *sw)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Register an alternative dialplan switch.  <a href="#ce9b1b9b9951df409f13e9c6c9a94d71"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#63a99eec1b6004791bd2013ad855eea8">ast_spawn_extension</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority, const char *callerid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Launch a new extension (i.e. new stack).  <a href="#63a99eec1b6004791bd2013ad855eea8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#3551033115b63707d99ce90e97df42df">ast_unlock_contexts</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unlocks contexts.  <a href="#3551033115b63707d99ce90e97df42df"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#4fc9ac8a7093a1f73637df0b9d6d6de9">ast_unregister_application</a> (const char *<a class="el" href="res__agi_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unregister an application.  <a href="#4fc9ac8a7093a1f73637df0b9d6d6de9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#dfce547713eae00cf11fd0b876adb7f7">ast_unregister_switch</a> (struct <a class="el" href="structast__switch.html">ast_switch</a> *sw)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unregister an alternative switch.  <a href="#dfce547713eae00cf11fd0b876adb7f7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#95639736856685dd7cd10d145e595c0a">ast_walk_context_extensions</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, struct <a class="el" href="structast__exten.html">ast_exten</a> *priority)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__ignorepat.html">ast_ignorepat</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#78f92771f39acc0696f7d12053ff4304">ast_walk_context_ignorepats</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, struct <a class="el" href="structast__ignorepat.html">ast_ignorepat</a> *ip)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__include.html">ast_include</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#ff52371424397442d32568beb910e153">ast_walk_context_includes</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, struct <a class="el" href="structast__include.html">ast_include</a> *inc)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__sw.html">ast_sw</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#6cbdae284c7bcff5b16d687a1f60b61b">ast_walk_context_switches</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con, struct <a class="el" href="structast__sw.html">ast_sw</a> *sw)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#709c9b64f2da1eaace237db32a5e1445">ast_walk_contexts</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#2ae60ad33dfd510584655331ac42b890">ast_walk_extension_priorities</a> (struct <a class="el" href="structast__exten.html">ast_exten</a> *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, struct <a class="el" href="structast__exten.html">ast_exten</a> *priority)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#18884df37a7c36a24fd0b5f4225d1112">ast_wrlock_context</a> (struct <a class="el" href="structast__context.html">ast_context</a> *con)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write locks a given context.  <a href="#18884df37a7c36a24fd0b5f4225d1112"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#7f2720f357b0f5e3f098635da99ed7a7">ast_wrlock_contexts</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write locks the context list.  <a href="#7f2720f357b0f5e3f098635da99ed7a7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#70b34943ce7b4a596f724e9d2e5463f6">pbx_builtin_clear_globals</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#944d18aa90701f025b30e63d9644e448">pbx_builtin_getvar_helper</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#314bde51a938aa39daab1c3379eed3c7">pbx_builtin_pushvar_helper</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, const char *value)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#54b5d868be87581f886aee1b5fed126a">pbx_builtin_serialize_variables</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, struct <a class="el" href="structast__str.html">ast_str</a> **<a class="el" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#069eef65dcddfd8f88fa71b904f52e7a">pbx_builtin_setvar</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, void *data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#64407c916a2de6ae3f0efeca471c1b1d">pbx_builtin_setvar_helper</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, const char *value)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#356fc557c1fe7c36e2773ba403e7625a">pbx_checkcondition</a> (const char *condition)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Evaluate a condition.  <a href="#356fc557c1fe7c36e2773ba403e7625a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#5970fbcb6a776848d11bf1c8ddb1c948">pbx_exec</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, struct <a class="el" href="structast__app.html">ast_app</a> *<a class="el" href="res__agi_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>, void *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Execute an application.  <a href="#5970fbcb6a776848d11bf1c8ddb1c948"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structast__app.html">ast_app</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#d407cf204ec8fc50e5a578c8c17e0cb5">pbx_findapp</a> (const char *<a class="el" href="res__agi_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Look up an application.  <a href="#d407cf204ec8fc50e5a578c8c17e0cb5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#2753b759766c3d305e2551f63e403677">pbx_retrieve_variable</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *var, char **ret, char *workspace, int workspacelen, struct varshead *headp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Support for Asterisk built-in variables in the dialplan.  <a href="#2753b759766c3d305e2551f63e403677"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#ea7c4ebeb23de4a6efa64ef901058db6">pbx_set_autofallthrough</a> (int newval)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#7f62e5d5f926a2eeedb559b6afd3d80a">pbx_substitute_variables_helper</a> (struct <a class="el" href="structast__channel.html">ast_channel</a> *c, const char *cp1, char *cp2, int count)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pbx_8h.html#9c87adf1e75b8a9298ffc59378531172">pbx_substitute_variables_varshead</a> (struct varshead *headp, const char *cp1, char *cp2, int count)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Core PBX routines and definitions. 
<p>

<p>
Definition in file <a class="el" href="pbx_8h-source.html">pbx.h</a>.<hr><h2>Define Documentation</h2>
<a class="anchor" name="a973a2fecfe2da6df7aaf2d5be3ea548"></a><!-- doxytag: member="pbx.h::AST_MAX_APP" ref="a973a2fecfe2da6df7aaf2d5be3ea548" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_MAX_APP&nbsp;&nbsp;&nbsp;32          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Max length of an application 
<p>
Definition at line <a class="el" href="pbx_8h-source.html#l00034">34</a> of file <a class="el" href="pbx_8h-source.html">pbx.h</a>.
<p>
Referenced by <a class="el" href="app__meetme_8c-source.html#l04461">destroy_station()</a>, <a class="el" href="pbx_8c-source.html#l03021">handle_show_application()</a>, <a class="el" href="pbx_8c-source.html#l01269">handle_show_function()</a>, and <a class="el" href="app__meetme_8c-source.html#l04662">sla_build_station()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="b4f6b32260006d527a95b442625161f2"></a><!-- doxytag: member="pbx.h::AST_PBX_KEEP" ref="b4f6b32260006d527a95b442625161f2" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_PBX_KEEP&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8h-source.html#l00036">36</a> of file <a class="el" href="pbx_8h-source.html">pbx.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="60ed4b0965b6f9aa117240879d402201"></a><!-- doxytag: member="pbx.h::AST_PBX_KEEPALIVE" ref="60ed4b0965b6f9aa117240879d402201" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_PBX_KEEPALIVE&nbsp;&nbsp;&nbsp;10          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Special return values from applications to the PBX {. 
<p>
Destroy the thread, but don't hang up the channel 
<p>
Definition at line <a class="el" href="pbx_8h-source.html#l00040">40</a> of file <a class="el" href="pbx_8h-source.html">pbx.h</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>, <a class="el" href="res__agi_8c-source.html#l01801">agi_handle_command()</a>, <a class="el" href="res__features_8c-source.html#l00673">builtin_blindtransfer()</a>, <a class="el" href="res__features_8c-source.html#l00529">builtin_parkcall()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="res__features_8c-source.html#l01098">feature_exec_app()</a>, <a class="el" href="res__features_8c-source.html#l01938">park_call_exec()</a>, <a class="el" href="app__queue_8c-source.html#l03443">queue_exec()</a>, <a class="el" href="app__rpt_8c-source.html#l06759">rpt_exec()</a>, and <a class="el" href="res__agi_8c-source.html#l01833">run_agi()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="5e2459a77c1072ded5128a9c607a9e95"></a><!-- doxytag: member="pbx.h::AST_PBX_NO_HANGUP_PEER" ref="5e2459a77c1072ded5128a9c607a9e95" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_PBX_NO_HANGUP_PEER&nbsp;&nbsp;&nbsp;11          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8h-source.html#l00041">41</a> of file <a class="el" href="pbx_8h-source.html">pbx.h</a>.
<p>
Referenced by <a class="el" href="res__features_8c-source.html#l00673">builtin_blindtransfer()</a>, <a class="el" href="res__features_8c-source.html#l00529">builtin_parkcall()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="res__features_8c-source.html#l01098">feature_exec_app()</a>, and <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="96251919ed68f34ea9b3a48b6166256b"></a><!-- doxytag: member="pbx.h::AST_PBX_REPLACE" ref="96251919ed68f34ea9b3a48b6166256b" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define AST_PBX_REPLACE&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8h-source.html#l00037">37</a> of file <a class="el" href="pbx_8h-source.html">pbx.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="ab1e94ec9073ecc8bcedd7b11dd82001"></a><!-- doxytag: member="pbx.h::PRIORITY_HINT" ref="ab1e94ec9073ecc8bcedd7b11dd82001" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define PRIORITY_HINT&nbsp;&nbsp;&nbsp;-1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
} Special Priority for a hint 
<p>
Definition at line <a class="el" href="pbx_8h-source.html#l00044">44</a> of file <a class="el" href="pbx_8h-source.html">pbx.h</a>.
<p>
Referenced by <a class="el" href="pbx__ael_8c-source.html#l03652">add_extensions()</a>, <a class="el" href="pbx_8c-source.html#l04681">add_pri()</a>, <a class="el" href="pbx_8c-source.html#l04765">ast_add_extension2()</a>, <a class="el" href="pbx_8c-source.html#l01799">ast_hint_extension()</a>, <a class="el" href="pbx_8c-source.html#l02521">destroy_exten()</a>, <a class="el" href="app__meetme_8c-source.html#l04461">destroy_station()</a>, <a class="el" href="pbx__config_8c-source.html#l00938">handle_context_add_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l00335">handle_context_remove_extension()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, <a class="el" href="res__features_8c-source.html#l02439">park_add_hints()</a>, <a class="el" href="pbx__config_8c-source.html#l01332">pbx_load_config()</a>, <a class="el" href="pbx_8c-source.html#l03315">print_ext()</a>, and <a class="el" href="app__meetme_8c-source.html#l04662">sla_build_station()</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a083658b5411c328227915675531df43"></a><!-- doxytag: member="pbx.h::ast_state_cb_type" ref="a083658b5411c328227915675531df43" args=")(char *context, char *id, enum ast_extension_states state, void *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">typedef int(* <a class="el" href="pbx_8h.html#a083658b5411c328227915675531df43">ast_state_cb_type</a>)(char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, char *<a class="el" href="app__queue_8c.html#b80bb7740288fda1f201890375a60c8f">id</a>, enum <a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75">ast_extension_states</a> <a class="el" href="structstate.html">state</a>, void *data)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Typedef for devicestate and hint callbacks. 
<p>

<p>
Definition at line <a class="el" href="pbx_8h-source.html#l00069">69</a> of file <a class="el" href="pbx_8h-source.html">pbx.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="9ca45d5d91ac596db3ca4ad7325420d9"></a><!-- doxytag: member="pbx.h::ast_switch_f" ref="9ca45d5d91ac596db3ca4ad7325420d9" args=")(struct ast_channel *chan, const char *context, const char *exten, int priority, const char *callerid, const char *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">typedef int( <a class="el" href="pbx_8h.html#9ca45d5d91ac596db3ca4ad7325420d9">ast_switch_f</a>)(struct <a class="el" href="structast__channel.html">ast_channel</a> *<a class="el" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>, const char *<a class="el" href="cdr__tds_8c.html#5c18ef72771564b7f43c497dc507aeab">context</a>, const char *<a class="el" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, int priority, const char *callerid, const char *data)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
All switch functions have the same interface, so define a type for them. 
<p>
Data structure associated with an Asterisk switch 
<p>
Definition at line <a class="el" href="pbx_8h-source.html#l00083">83</a> of file <a class="el" href="pbx_8h-source.html">pbx.h</a>.    </td>
  </tr>
</table>
<hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="f571613d99899b77c0f4d4c18f112f75"></a><!-- doxytag: member="pbx.h::ast_extension_states" ref="f571613d99899b77c0f4d4c18f112f75" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75">ast_extension_states</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Extension states. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>States can be combined<ul>
<li><a class="el" href="AstExtState.html">Extension and device states in Asterisk</a> </li></ul>
</dd></dl>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="f571613d99899b77c0f4d4c18f112f7564c0d9d79bfb21b4578eb245ddcecd9a"></a><!-- doxytag: member="AST_EXTENSION_REMOVED" ref="f571613d99899b77c0f4d4c18f112f7564c0d9d79bfb21b4578eb245ddcecd9a" args="" -->AST_EXTENSION_REMOVED</em>&nbsp;</td><td>
Extension removed </td></tr>
<tr><td valign="top"><em><a class="anchor" name="f571613d99899b77c0f4d4c18f112f75ba2a7d54f03c58c97ed6230623a70d4b"></a><!-- doxytag: member="AST_EXTENSION_DEACTIVATED" ref="f571613d99899b77c0f4d4c18f112f75ba2a7d54f03c58c97ed6230623a70d4b" args="" -->AST_EXTENSION_DEACTIVATED</em>&nbsp;</td><td>
Extension hint removed </td></tr>
<tr><td valign="top"><em><a class="anchor" name="f571613d99899b77c0f4d4c18f112f755fc09a563f5aee5b8cc58e535cbe6957"></a><!-- doxytag: member="AST_EXTENSION_NOT_INUSE" ref="f571613d99899b77c0f4d4c18f112f755fc09a563f5aee5b8cc58e535cbe6957" args="" -->AST_EXTENSION_NOT_INUSE</em>&nbsp;</td><td>
No device INUSE or BUSY </td></tr>
<tr><td valign="top"><em><a class="anchor" name="f571613d99899b77c0f4d4c18f112f75af76c61ff1afcc94e335402cda274f0c"></a><!-- doxytag: member="AST_EXTENSION_INUSE" ref="f571613d99899b77c0f4d4c18f112f75af76c61ff1afcc94e335402cda274f0c" args="" -->AST_EXTENSION_INUSE</em>&nbsp;</td><td>
One or more devices INUSE </td></tr>
<tr><td valign="top"><em><a class="anchor" name="f571613d99899b77c0f4d4c18f112f75721f2af8b4a4abcc783fce2791af6d13"></a><!-- doxytag: member="AST_EXTENSION_BUSY" ref="f571613d99899b77c0f4d4c18f112f75721f2af8b4a4abcc783fce2791af6d13" args="" -->AST_EXTENSION_BUSY</em>&nbsp;</td><td>
All devices BUSY </td></tr>
<tr><td valign="top"><em><a class="anchor" name="f571613d99899b77c0f4d4c18f112f75555002246e0b0325196808797905c17d"></a><!-- doxytag: member="AST_EXTENSION_UNAVAILABLE" ref="f571613d99899b77c0f4d4c18f112f75555002246e0b0325196808797905c17d" args="" -->AST_EXTENSION_UNAVAILABLE</em>&nbsp;</td><td>
All devices UNAVAILABLE/UNREGISTERED </td></tr>
<tr><td valign="top"><em><a class="anchor" name="f571613d99899b77c0f4d4c18f112f75dfc0eb724f114235813e772b93bca550"></a><!-- doxytag: member="AST_EXTENSION_RINGING" ref="f571613d99899b77c0f4d4c18f112f75dfc0eb724f114235813e772b93bca550" args="" -->AST_EXTENSION_RINGING</em>&nbsp;</td><td>
All devices RINGING </td></tr>
<tr><td valign="top"><em><a class="anchor" name="f571613d99899b77c0f4d4c18f112f7541e76c8a6fe6c7824228f2613672c524"></a><!-- doxytag: member="AST_EXTENSION_ONHOLD" ref="f571613d99899b77c0f4d4c18f112f7541e76c8a6fe6c7824228f2613672c524" args="" -->AST_EXTENSION_ONHOLD</em>&nbsp;</td><td>
All devices ONHOLD </td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8h-source.html#l00050">50</a> of file <a class="el" href="pbx_8h-source.html">pbx.h</a>.<div class="fragment"><pre class="fragment"><a name="l00050"></a>00050                           {
<a name="l00051"></a>00051    <a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f7564c0d9d79bfb21b4578eb245ddcecd9a">AST_EXTENSION_REMOVED</a> = -2,   <span class="comment">/*!&lt; Extension removed */</span>
<a name="l00052"></a>00052    <a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75ba2a7d54f03c58c97ed6230623a70d4b">AST_EXTENSION_DEACTIVATED</a> = -1,  <span class="comment">/*!&lt; Extension hint removed */</span>
<a name="l00053"></a>00053    <a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f755fc09a563f5aee5b8cc58e535cbe6957">AST_EXTENSION_NOT_INUSE</a> = 0,  <span class="comment">/*!&lt; No device INUSE or BUSY  */</span>
<a name="l00054"></a>00054    <a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75af76c61ff1afcc94e335402cda274f0c">AST_EXTENSION_INUSE</a> = 1 &lt;&lt; 0, <span class="comment">/*!&lt; One or more devices INUSE */</span>
<a name="l00055"></a>00055    <a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75721f2af8b4a4abcc783fce2791af6d13">AST_EXTENSION_BUSY</a> = 1 &lt;&lt; 1,  <span class="comment">/*!&lt; All devices BUSY */</span>
<a name="l00056"></a>00056    <a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75555002246e0b0325196808797905c17d">AST_EXTENSION_UNAVAILABLE</a> = 1 &lt;&lt; 2, <span class="comment">/*!&lt; All devices UNAVAILABLE/UNREGISTERED */</span>
<a name="l00057"></a>00057    <a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f75dfc0eb724f114235813e772b93bca550">AST_EXTENSION_RINGING</a> = 1 &lt;&lt; 3,  <span class="comment">/*!&lt; All devices RINGING */</span>
<a name="l00058"></a>00058    <a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f7541e76c8a6fe6c7824228f2613672c524">AST_EXTENSION_ONHOLD</a> = 1 &lt;&lt; 4,   <span class="comment">/*!&lt; All devices ONHOLD */</span>
<a name="l00059"></a>00059 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="bc3ba53eb07b914cc39444bfcf88a912"></a><!-- doxytag: member="pbx.h::ast_pbx_result" ref="bc3ba53eb07b914cc39444bfcf88a912" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912">ast_pbx_result</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The result codes when starting the PBX on a channel with <a class="el" href="pbx_8c.html#c55e82ff3dabed89efd77f20209b1006">ast_pbx_start()</a>. 
<p>
AST_PBX_CALL_LIMIT refers to the maxcalls call limit in asterisk.conf <dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="bc3ba53eb07b914cc39444bfcf88a912c86643c5e19588b3eb7dce58a2b4145a"></a><!-- doxytag: member="AST_PBX_SUCCESS" ref="bc3ba53eb07b914cc39444bfcf88a912c86643c5e19588b3eb7dce58a2b4145a" args="" -->AST_PBX_SUCCESS</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="bc3ba53eb07b914cc39444bfcf88a912f5f5d3987a33fd6012262bab9c332519"></a><!-- doxytag: member="AST_PBX_FAILED" ref="bc3ba53eb07b914cc39444bfcf88a912f5f5d3987a33fd6012262bab9c332519" args="" -->AST_PBX_FAILED</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="bc3ba53eb07b914cc39444bfcf88a9126d32a4969792a16a712111cd4664d1c8"></a><!-- doxytag: member="AST_PBX_CALL_LIMIT" ref="bc3ba53eb07b914cc39444bfcf88a9126d32a4969792a16a712111cd4664d1c8" args="" -->AST_PBX_CALL_LIMIT</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8h-source.html#l00236">236</a> of file <a class="el" href="pbx_8h-source.html">pbx.h</a>.<div class="fragment"><pre class="fragment"><a name="l00236"></a>00236                     {
<a name="l00237"></a>00237    <a class="code" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912c86643c5e19588b3eb7dce58a2b4145a">AST_PBX_SUCCESS</a> = 0,
<a name="l00238"></a>00238    <a class="code" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912f5f5d3987a33fd6012262bab9c332519">AST_PBX_FAILED</a> = -1,
<a name="l00239"></a>00239    <a class="code" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a9126d32a4969792a16a712111cd4664d1c8">AST_PBX_CALL_LIMIT</a> = -2,
<a name="l00240"></a>00240 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="12b93bee10e4fd5d30576d7a6877e12b"></a><!-- doxytag: member="pbx.h::ast_active_calls" ref="12b93bee10e4fd5d30576d7a6877e12b" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_active_calls           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Retrieve the number of active calls. 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02585">2585</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00252">countcalls</a>.
<p>
Referenced by <a class="el" href="cli_8c-source.html#l00452">handle_chanlist()</a>.<div class="fragment"><pre class="fragment"><a name="l02586"></a>02586 {
<a name="l02587"></a>02587    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#a3a9f90f51c55c02ddf6ad8e26249341">countcalls</a>;
<a name="l02588"></a>02588 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b77a5344eb4a1e2404c81a2a593deff5"></a><!-- doxytag: member="pbx.h::ast_add_extension" ref="b77a5344eb4a1e2404c81a2a593deff5" args="(const char *context, int replace, const char *extension, int priority, const char *label, const char *callerid, const char *application, void *data, void(*datad)(void *), const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_add_extension           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>replace</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>extension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>label</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>callerid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>application</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void(*)(void *)&nbsp;</td>
          <td class="mdname" nowrap> <em>datad</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add and extension to an extension context. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>context to add the extension to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>replace</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>extension</em>&nbsp;</td><td>extension to add </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>priority</em>&nbsp;</td><td>priority level of extension addition </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>label</em>&nbsp;</td><td>extension label </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callerid</em>&nbsp;</td><td>pattern to match CallerID, or NULL to match any CallerID </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>application</em>&nbsp;</td><td>application to run on the extension with that priority level </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>data to pass to the application </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>datad</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>registrar</em>&nbsp;</td><td>who registered the extension</td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04561">4561</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l04765">ast_add_extension2()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l00938">handle_context_add_extension()</a>, <a class="el" href="res__features_8c-source.html#l02439">park_add_hints()</a>, and <a class="el" href="chan__iax2_8c-source.html#l05647">register_peer_exten()</a>.<div class="fragment"><pre class="fragment"><a name="l04564"></a>04564 {
<a name="l04565"></a>04565    <span class="keywordtype">int</span> ret = -1;
<a name="l04566"></a>04566    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = <a class="code" href="pbx_8c.html#4669bd753e060c6bb15a0c63c4e3785a">find_context_locked</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l04567"></a>04567 
<a name="l04568"></a>04568    <span class="keywordflow">if</span> (c) {
<a name="l04569"></a>04569       ret = <a class="code" href="pbx_8c.html#0985a9a977ba8aa4f370da3a495437ae">ast_add_extension2</a>(c, replace, extension, priority, label, callerid,
<a name="l04570"></a>04570          application, data, datad, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l04571"></a>04571       <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l04572"></a>04572    }
<a name="l04573"></a>04573    <span class="keywordflow">return</span> ret;
<a name="l04574"></a>04574 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="0985a9a977ba8aa4f370da3a495437ae"></a><!-- doxytag: member="pbx.h::ast_add_extension2" ref="0985a9a977ba8aa4f370da3a495437ae" args="(struct ast_context *con, int replace, const char *extension, int priority, const char *label, const char *callerid, const char *application, void *data, void(*datad)(void *), const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_add_extension2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>replace</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>extension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>label</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>callerid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>application</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void(*)(void *)&nbsp;</td>
          <td class="mdname" nowrap> <em>datad</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add an extension to an extension context, this time with an <a class="el" href="structast__context.html">ast_context</a> *. 
<p>
We sort extensions in order of matching preference, so that we can stop the search as soon as we find a suitable match. This ordering also takes care of wildcards such as '.' (meaning "one or more of any character") and '!' (which is 'earlymatch', meaning "zero or more of any character" but also impacts the return value from CANMATCH and EARLYMATCH.<p>
The extension match rules defined in the devmeeting 2006.05.05 are quite simple: WE SELECT THE LONGEST MATCH. In detail, "longest" means the number of matched characters in the extension. In case of ties (e.g. _XXX and 333) in the length of a pattern, we give priority to entries with the smallest cardinality (e.g, [5-9] comes before [2-8] before the former has only 5 elements, while the latter has 7, etc. In case of same cardinality, the first element in the range counts. If we still have a tie, any final '!' will make this as a possibly less specific pattern.<p>
EBUSY - can't lock EEXIST - extension with the same priority exist and no replace is set 
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04765">4765</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l04681">add_pri()</a>, <a class="el" href="pbx_8c-source.html#l00125">ast_exten::app</a>, <a class="el" href="pbx_8c-source.html#l02076">ast_add_hint()</a>, <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="linkedlists_8h-source.html#l00385">AST_LIST_FIRST</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="lock_8h-source.html#l00642">ast_rwlock_rdlock()</a>, <a class="el" href="lock_8h-source.html#l00637">ast_rwlock_unlock()</a>, <a class="el" href="pbx_8c-source.html#l06092">ast_unlock_context()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="pbx_8c-source.html#l06082">ast_wrlock_context()</a>, <a class="el" href="pbx_8c-source.html#l00121">ast_exten::cidmatch</a>, <a class="el" href="pbx_8c-source.html#l00127">ast_exten::data</a>, <a class="el" href="structast__exten.html#7c342dda03b7a7df3e7dc1603c4916d1">ast_exten::datad</a>, <a class="el" href="asterisk_8c-source.html#l00199">el</a>, <a class="el" href="pbx_8c-source.html#l00716">ext_cmp()</a>, <a class="el" href="pbx_8c-source.html#l04655">ext_strncpy()</a>, <a class="el" href="pbx_8c-source.html#l00119">ast_exten::exten</a>, <a class="el" href="pbx_8c-source.html#l00123">ast_exten::label</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="pbx_8c-source.html#l00120">ast_exten::matchcid</a>, <a class="el" href="pbx_8c-source.html#l00131">ast_exten::next</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="pbx_8c-source.html#l00124">ast_exten::parent</a>, <a class="el" href="pbx_8c-source.html#l01665">pbx_substitute_variables_varshead()</a>, <a class="el" href="pbx_8c-source.html#l00122">ast_exten::priority</a>, <a class="el" href="pbx_8h-source.html#l00044">PRIORITY_HINT</a>, <a class="el" href="pbx_8c-source.html#l00130">ast_exten::registrar</a>, <a class="el" href="pbx_8c-source.html#l00167">ast_context::root</a>, <a class="el" href="pbx_8c-source.html#l00132">ast_exten::stuff</a>, <a class="el" href="pbx_8c-source.html#l00085">VAR_BUF_SIZE</a>, and <a class="el" href="logger_8h-source.html#l00045">VERBOSE_PREFIX_3</a>.
<p>
Referenced by <a class="el" href="pbx__ael_8c-source.html#l03652">add_extensions()</a>, <a class="el" href="pbx_8c-source.html#l04561">ast_add_extension()</a>, <a class="el" href="res__features_8c-source.html#l00342">ast_park_call()</a>, <a class="el" href="res__features_8c-source.html#l01761">do_parking_thread()</a>, <a class="el" href="res__features_8c-source.html#l02453">load_config()</a>, <a class="el" href="pbx__config_8c-source.html#l01332">pbx_load_config()</a>, <a class="el" href="pbx__config_8c-source.html#l01510">pbx_load_users()</a>, <a class="el" href="app__meetme_8c-source.html#l04662">sla_build_station()</a>, and <a class="el" href="app__meetme_8c-source.html#l04527">sla_build_trunk()</a>.<div class="fragment"><pre class="fragment"><a name="l04769"></a>04769 {
<a name="l04770"></a>04770    <span class="comment">/*</span>
<a name="l04771"></a>04771 <span class="comment">    * Sort extensions (or patterns) according to the rules indicated above.</span>
<a name="l04772"></a>04772 <span class="comment">    * These are implemented by the function ext_cmp()).</span>
<a name="l04773"></a>04773 <span class="comment">    * All priorities for the same ext/pattern/cid are kept in a list,</span>
<a name="l04774"></a>04774 <span class="comment">    * using the 'peer' field  as a link field..</span>
<a name="l04775"></a>04775 <span class="comment">    */</span>
<a name="l04776"></a>04776    <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *tmp, *e, *<a class="code" href="asterisk_8c.html#65c10911d8b8591219a21ebacf46da01">el</a> = NULL;
<a name="l04777"></a>04777    <span class="keywordtype">int</span> res;
<a name="l04778"></a>04778    <span class="keywordtype">int</span> length;
<a name="l04779"></a>04779    <span class="keywordtype">char</span> *p;
<a name="l04780"></a>04780    <span class="keywordtype">char</span> expand_buf[<a class="code" href="pbx_8c.html#970eeb66b59dcceec190d4d3147cb12f">VAR_BUF_SIZE</a>] = { 0, };
<a name="l04781"></a>04781 
<a name="l04782"></a>04782    <span class="comment">/* if we are adding a hint, and there are global variables, and the hint</span>
<a name="l04783"></a>04783 <span class="comment">      contains variable references, then expand them</span>
<a name="l04784"></a>04784 <span class="comment">   */</span>
<a name="l04785"></a>04785    <a class="code" href="lock_8h.html#f4b8158bcd471d4f28b380768e3ee073">ast_rwlock_rdlock</a>(&amp;globalslock);
<a name="l04786"></a>04786    <span class="keywordflow">if</span> (<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a> == <a class="code" href="pbx_8h.html#ab1e94ec9073ecc8bcedd7b11dd82001">PRIORITY_HINT</a> &amp;&amp; <a class="code" href="linkedlists_8h.html#e4deb7f32ef480cbc3b2e9b7e4ceff6c">AST_LIST_FIRST</a>(&amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>) &amp;&amp; strstr(application, <span class="stringliteral">"${"</span>)) {
<a name="l04787"></a>04787       <a class="code" href="pbx_8c.html#9c87adf1e75b8a9298ffc59378531172">pbx_substitute_variables_varshead</a>(&amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>, application, expand_buf, <span class="keyword">sizeof</span>(expand_buf));
<a name="l04788"></a>04788       application = expand_buf;
<a name="l04789"></a>04789    }
<a name="l04790"></a>04790    <a class="code" href="lock_8h.html#97ed909ef0a0582cf3870dd0629852c8">ast_rwlock_unlock</a>(&amp;globalslock);
<a name="l04791"></a>04791 
<a name="l04792"></a>04792    length = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a>);
<a name="l04793"></a>04793    length += strlen(extension) + 1;
<a name="l04794"></a>04794    length += strlen(application) + 1;
<a name="l04795"></a>04795    <span class="keywordflow">if</span> (<a class="code" href="structast__exten.html#d304ba20e96d87411588eeabac850e34">label</a>)
<a name="l04796"></a>04796       length += strlen(<a class="code" href="structast__exten.html#d304ba20e96d87411588eeabac850e34">label</a>) + 1;
<a name="l04797"></a>04797    <span class="keywordflow">if</span> (callerid)
<a name="l04798"></a>04798       length += strlen(callerid) + 1;
<a name="l04799"></a>04799    <span class="keywordflow">else</span>
<a name="l04800"></a>04800       length ++;  <span class="comment">/* just the '\0' */</span>
<a name="l04801"></a>04801 
<a name="l04802"></a>04802    <span class="comment">/* Be optimistic:  Build the extension structure first */</span>
<a name="l04803"></a>04803    <span class="keywordflow">if</span> (!(tmp = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, length)))
<a name="l04804"></a>04804       <span class="keywordflow">return</span> -1;
<a name="l04805"></a>04805 
<a name="l04806"></a>04806    <span class="comment">/* use p as dst in assignments, as the fields are const char * */</span>
<a name="l04807"></a>04807    p = tmp-&gt;<a class="code" href="structast__exten.html#3d111ff6c918c5cbdf2b3e843726ec71">stuff</a>;
<a name="l04808"></a>04808    <span class="keywordflow">if</span> (<a class="code" href="structast__exten.html#d304ba20e96d87411588eeabac850e34">label</a>) {
<a name="l04809"></a>04809       tmp-&gt;<a class="code" href="structast__exten.html#d304ba20e96d87411588eeabac850e34">label</a> = p;
<a name="l04810"></a>04810       strcpy(p, <a class="code" href="structast__exten.html#d304ba20e96d87411588eeabac850e34">label</a>);
<a name="l04811"></a>04811       p += strlen(<a class="code" href="structast__exten.html#d304ba20e96d87411588eeabac850e34">label</a>) + 1;
<a name="l04812"></a>04812    }
<a name="l04813"></a>04813    tmp-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a> = p;
<a name="l04814"></a>04814    p += <a class="code" href="pbx_8c.html#34cd75f9b635d6fb74649e8e456dcef9">ext_strncpy</a>(p, extension, strlen(extension) + 1) + 1;
<a name="l04815"></a>04815    tmp-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a> = <a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a>;
<a name="l04816"></a>04816    tmp-&gt;<a class="code" href="structast__exten.html#2ef4524f32df05033fd0502689de872e">cidmatch</a> = p;   <span class="comment">/* but use p for assignments below */</span>
<a name="l04817"></a>04817    <span class="keywordflow">if</span> (callerid) {
<a name="l04818"></a>04818       p += <a class="code" href="pbx_8c.html#34cd75f9b635d6fb74649e8e456dcef9">ext_strncpy</a>(p, callerid, strlen(callerid) + 1) + 1;
<a name="l04819"></a>04819       tmp-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a> = 1;
<a name="l04820"></a>04820    } <span class="keywordflow">else</span> {
<a name="l04821"></a>04821       *p++ = <span class="charliteral">'\0'</span>;
<a name="l04822"></a>04822       tmp-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a> = 0;
<a name="l04823"></a>04823    }
<a name="l04824"></a>04824    tmp-&gt;<a class="code" href="structast__exten.html#d2a57dc1d883fd21fb9951699df71cc7">app</a> = p;
<a name="l04825"></a>04825    strcpy(p, application);
<a name="l04826"></a>04826    tmp-&gt;<a class="code" href="structast__exten.html#d0e45878043844ffc41aac437e86b602">parent</a> = con;
<a name="l04827"></a>04827    tmp-&gt;<a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a> = <a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a>;
<a name="l04828"></a>04828    tmp-&gt;<a class="code" href="structast__exten.html#7c342dda03b7a7df3e7dc1603c4916d1">datad</a> = <a class="code" href="structast__exten.html#7c342dda03b7a7df3e7dc1603c4916d1">datad</a>;
<a name="l04829"></a>04829    tmp-&gt;<a class="code" href="structast__exten.html#5940569cd1d60781f856f93235b072ee">registrar</a> = <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>;
<a name="l04830"></a>04830 
<a name="l04831"></a>04831    <a class="code" href="pbx_8c.html#18884df37a7c36a24fd0b5f4225d1112">ast_wrlock_context</a>(con);
<a name="l04832"></a>04832    res = 0; <span class="comment">/* some compilers will think it is uninitialized otherwise */</span>
<a name="l04833"></a>04833    <span class="keywordflow">for</span> (e = con-&gt;<a class="code" href="structast__context.html#63a9f0ea7bb98050796b649e85481845">root</a>; e; el = e, e = e-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {   <span class="comment">/* scan the extension list */</span>
<a name="l04834"></a>04834       res = <a class="code" href="pbx_8c.html#fa125f786a7a85619f88c85292d5412f">ext_cmp</a>(e-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>, extension);
<a name="l04835"></a>04835       <span class="keywordflow">if</span> (res == 0) { <span class="comment">/* extension match, now look at cidmatch */</span>
<a name="l04836"></a>04836          <span class="keywordflow">if</span> (!e-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a> &amp;&amp; !tmp-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a>)
<a name="l04837"></a>04837             res = 0;
<a name="l04838"></a>04838          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tmp-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a> &amp;&amp; !e-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a>)
<a name="l04839"></a>04839             res = 1;
<a name="l04840"></a>04840          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a> &amp;&amp; !tmp-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a>)
<a name="l04841"></a>04841             res = -1;
<a name="l04842"></a>04842          <span class="keywordflow">else</span>
<a name="l04843"></a>04843             res = strcasecmp(e-&gt;<a class="code" href="structast__exten.html#2ef4524f32df05033fd0502689de872e">cidmatch</a>, tmp-&gt;<a class="code" href="structast__exten.html#2ef4524f32df05033fd0502689de872e">cidmatch</a>);
<a name="l04844"></a>04844       }
<a name="l04845"></a>04845       <span class="keywordflow">if</span> (res &gt;= 0)
<a name="l04846"></a>04846          <span class="keywordflow">break</span>;
<a name="l04847"></a>04847    }
<a name="l04848"></a>04848    <span class="keywordflow">if</span> (e &amp;&amp; res == 0) { <span class="comment">/* exact match, insert in the pri chain */</span>
<a name="l04849"></a>04849       res = <a class="code" href="pbx_8c.html#2a729b6bbfa875032679e02260957526">add_pri</a>(con, tmp, el, e, replace);
<a name="l04850"></a>04850       <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l04851"></a>04851       <span class="keywordflow">if</span> (res &lt; 0) {
<a name="l04852"></a>04852          errno = EEXIST;   <span class="comment">/* XXX do we care ? */</span>
<a name="l04853"></a>04853          <span class="keywordflow">return</span> 0; <span class="comment">/* XXX should we return -1 maybe ? */</span>
<a name="l04854"></a>04854       }
<a name="l04855"></a>04855    } <span class="keywordflow">else</span> {
<a name="l04856"></a>04856       <span class="comment">/*</span>
<a name="l04857"></a>04857 <span class="comment">       * not an exact match, this is the first entry with this pattern,</span>
<a name="l04858"></a>04858 <span class="comment">       * so insert in the main list right before 'e' (if any)</span>
<a name="l04859"></a>04859 <span class="comment">       */</span>
<a name="l04860"></a>04860       tmp-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = e;
<a name="l04861"></a>04861       <span class="keywordflow">if</span> (el)
<a name="l04862"></a>04862          el-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = tmp;
<a name="l04863"></a>04863       <span class="keywordflow">else</span>
<a name="l04864"></a>04864          con-&gt;<a class="code" href="structast__context.html#63a9f0ea7bb98050796b649e85481845">root</a> = tmp;
<a name="l04865"></a>04865       <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l04866"></a>04866       <span class="keywordflow">if</span> (tmp-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a> == <a class="code" href="pbx_8h.html#ab1e94ec9073ecc8bcedd7b11dd82001">PRIORITY_HINT</a>)
<a name="l04867"></a>04867          <a class="code" href="pbx_8c.html#b1882754d395928d10d8d94200dfffd1">ast_add_hint</a>(tmp);
<a name="l04868"></a>04868    }
<a name="l04869"></a>04869    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>) {
<a name="l04870"></a>04870       <span class="keywordflow">if</span> (tmp-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a>) {
<a name="l04871"></a>04871          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l04872"></a>04872             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Added extension '%s' priority %d (CID match '%s') to %s\n"</span>,
<a name="l04873"></a>04873                tmp-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>, tmp-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a>, tmp-&gt;<a class="code" href="structast__exten.html#2ef4524f32df05033fd0502689de872e">cidmatch</a>, con-&gt;name);
<a name="l04874"></a>04874       } <span class="keywordflow">else</span> {
<a name="l04875"></a>04875          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l04876"></a>04876             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Added extension '%s' priority %d to %s\n"</span>,
<a name="l04877"></a>04877                tmp-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>, tmp-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a>, con-&gt;name);
<a name="l04878"></a>04878       }
<a name="l04879"></a>04879    }
<a name="l04880"></a>04880    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 2) {
<a name="l04881"></a>04881       <span class="keywordflow">if</span> (tmp-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a>) {
<a name="l04882"></a>04882          <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>( <a class="code" href="logger_8h.html#aefd5a67b7464040f5352e4ecdc535ca">VERBOSE_PREFIX_3</a> <span class="stringliteral">"Added extension '%s' priority %d (CID match '%s')to %s\n"</span>,
<a name="l04883"></a>04883             tmp-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>, tmp-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a>, tmp-&gt;<a class="code" href="structast__exten.html#2ef4524f32df05033fd0502689de872e">cidmatch</a>, con-&gt;name);
<a name="l04884"></a>04884       } <span class="keywordflow">else</span> {
<a name="l04885"></a>04885          <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>( <a class="code" href="logger_8h.html#aefd5a67b7464040f5352e4ecdc535ca">VERBOSE_PREFIX_3</a> <span class="stringliteral">"Added extension '%s' priority %d to %s\n"</span>,
<a name="l04886"></a>04886             tmp-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>, tmp-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a>, con-&gt;name);
<a name="l04887"></a>04887       }
<a name="l04888"></a>04888    }
<a name="l04889"></a>04889    <span class="keywordflow">return</span> 0;
<a name="l04890"></a>04890 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="563b92a651459898f8ccfdc367746147"></a><!-- doxytag: member="pbx.h::ast_async_goto" ref="563b92a651459898f8ccfdc367746147" args="(struct ast_channel *chan, const char *context, const char *exten, int priority)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_async_goto           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04595">4595</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00435">ast_channel::_state</a>, <a class="el" href="channel_8h-source.html#l00450">ast_channel::amaflags</a>, <a class="el" href="cdr_8c-source.html#l00171">ast_cdr_dup()</a>, <a class="el" href="channel_8c-source.html#l00632">ast_channel_alloc()</a>, <a class="el" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>, <a class="el" href="channel_8c-source.html#l03270">ast_channel_masquerade()</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="channel_8c-source.html#l03406">ast_do_masquerade()</a>, <a class="el" href="pbx_8c-source.html#l04576">ast_explicit_goto()</a>, <a class="el" href="channel_8c-source.html#l01598">ast_hangup()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="pbx_8c-source.html#l02551">ast_pbx_start()</a>, <a class="el" href="channel_8h.html#a4d79cb252987ad7f099770543e601a179c1afce6cda266617f47d63393c2d71">AST_SOFTHANGUP_ASYNCGOTO</a>, <a class="el" href="channel_8c-source.html#l01442">ast_softhangup_nolock()</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, <a class="el" href="channel_8h-source.html#l00441">ast_channel::context</a>, <a class="el" href="channel_8h-source.html#l00442">ast_channel::exten</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="channel_8h-source.html#l00449">ast_channel::pbx</a>, <a class="el" href="channel_8h-source.html#l00477">ast_channel::readformat</a>, <a class="el" href="strings_8h-source.html#l00045">S_OR</a>, and <a class="el" href="channel_8h-source.html#l00478">ast_channel::writeformat</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l06258">__ast_goto_if_exists()</a>, <a class="el" href="manager_8c-source.html#l01726">action_redirect()</a>, <a class="el" href="pbx_8c-source.html#l04641">ast_async_goto_by_name()</a>, <a class="el" href="res__features_8c-source.html#l00673">builtin_blindtransfer()</a>, <a class="el" href="chan__oss_8c-source.html#l01339">console_transfer()</a>, <a class="el" href="chan__sip_8c-source.html#l15145">handle_request_bye()</a>, <a class="el" href="chan__misdn_8c-source.html#l02539">process_ast_dsp()</a>, and <a class="el" href="chan__zap_8c-source.html#l03875">zt_handle_dtmfup()</a>.<div class="fragment"><pre class="fragment"><a name="l04596"></a>04596 {
<a name="l04597"></a>04597    <span class="keywordtype">int</span> res = 0;
<a name="l04598"></a>04598 
<a name="l04599"></a>04599    <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l04600"></a>04600 
<a name="l04601"></a>04601    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#569f7a090087f9e7071a247a24ea0809">pbx</a>) { <span class="comment">/* This channel is currently in the PBX */</span>
<a name="l04602"></a>04602       <a class="code" href="pbx_8c.html#1e0079c7f2934dd7ebe801fefe4057da">ast_explicit_goto</a>(chan, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a>);
<a name="l04603"></a>04603       <a class="code" href="channel_8c.html#c969f5294a61165c99c9b6f65ecae173">ast_softhangup_nolock</a>(chan, <a class="code" href="channel_8h.html#a4d79cb252987ad7f099770543e601a179c1afce6cda266617f47d63393c2d71">AST_SOFTHANGUP_ASYNCGOTO</a>);
<a name="l04604"></a>04604    } <span class="keywordflow">else</span> {
<a name="l04605"></a>04605       <span class="comment">/* In order to do it when the channel doesn't really exist within</span>
<a name="l04606"></a>04606 <span class="comment">         the PBX, we have to make a new channel, masquerade, and start the PBX</span>
<a name="l04607"></a>04607 <span class="comment">         at the new location */</span>
<a name="l04608"></a>04608       <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *tmpchan = <a class="code" href="channel_8c.html#3e12df96f6a8fc8b7293ad03b29c729f">ast_channel_alloc</a>(0, chan-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a>, 0, 0, chan-&gt;accountcode, chan-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, chan-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, chan-&gt;<a class="code" href="structast__channel.html#d5aa4bb1461fe3d863bd95fb137e2284">amaflags</a>, <span class="stringliteral">"AsyncGoto/%s"</span>, chan-&gt;name);
<a name="l04609"></a>04609       <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>) {
<a name="l04610"></a>04610          tmpchan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a> = <a class="code" href="cdr_8c.html#8538ec9cb930d571cf367e372726d706">ast_cdr_dup</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>);
<a name="l04611"></a>04611       }
<a name="l04612"></a>04612       <span class="keywordflow">if</span> (!tmpchan)
<a name="l04613"></a>04613          res = -1;
<a name="l04614"></a>04614       <span class="keywordflow">else</span> {
<a name="l04615"></a>04615          <span class="comment">/* Make formats okay */</span>
<a name="l04616"></a>04616          tmpchan-&gt;<a class="code" href="structast__channel.html#c9d2702466074da94d21f26822247ed8">readformat</a> = chan-&gt;<a class="code" href="structast__channel.html#c9d2702466074da94d21f26822247ed8">readformat</a>;
<a name="l04617"></a>04617          tmpchan-&gt;<a class="code" href="structast__channel.html#45a38ca474a4f1df88fe13d68bbb0b44">writeformat</a> = chan-&gt;<a class="code" href="structast__channel.html#45a38ca474a4f1df88fe13d68bbb0b44">writeformat</a>;
<a name="l04618"></a>04618          <span class="comment">/* Setup proper location */</span>
<a name="l04619"></a>04619          <a class="code" href="pbx_8c.html#1e0079c7f2934dd7ebe801fefe4057da">ast_explicit_goto</a>(tmpchan,
<a name="l04620"></a>04620             <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, chan-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>), <a class="code" href="strings_8h.html#a5b939153ec133be2de0e3647df143f4">S_OR</a>(<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, chan-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>), <a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>);
<a name="l04621"></a>04621 
<a name="l04622"></a>04622          <span class="comment">/* Masquerade into temp channel */</span>
<a name="l04623"></a>04623          <a class="code" href="channel_8c.html#8e30c09190bd2388188cd8bab35ba595">ast_channel_masquerade</a>(tmpchan, chan);
<a name="l04624"></a>04624 
<a name="l04625"></a>04625          <span class="comment">/* Grab the locks and get going */</span>
<a name="l04626"></a>04626          <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(tmpchan);
<a name="l04627"></a>04627          <a class="code" href="channel_8c.html#f788595bd51a58be12bb3c3b28a950ec">ast_do_masquerade</a>(tmpchan);
<a name="l04628"></a>04628          <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(tmpchan);
<a name="l04629"></a>04629          <span class="comment">/* Start the PBX going on our stolen channel */</span>
<a name="l04630"></a>04630          <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#c55e82ff3dabed89efd77f20209b1006">ast_pbx_start</a>(tmpchan)) {
<a name="l04631"></a>04631             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Unable to start PBX on %s\n"</span>, tmpchan-&gt;name);
<a name="l04632"></a>04632             <a class="code" href="channel_8c.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a>(tmpchan);
<a name="l04633"></a>04633             res = -1;
<a name="l04634"></a>04634          }
<a name="l04635"></a>04635       }
<a name="l04636"></a>04636    }
<a name="l04637"></a>04637    <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l04638"></a>04638    <span class="keywordflow">return</span> res;
<a name="l04639"></a>04639 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="bd461ad63e07348133ddb0e31198452e"></a><!-- doxytag: member="pbx.h::ast_async_goto_by_name" ref="bd461ad63e07348133ddb0e31198452e" args="(const char *chan, const char *context, const char *exten, int priority)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_async_goto_by_name           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04641">4641</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l04595">ast_async_goto()</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, and <a class="el" href="channel_8c-source.html#l00995">ast_get_channel_by_name_locked()</a>.<div class="fragment"><pre class="fragment"><a name="l04642"></a>04642 {
<a name="l04643"></a>04643    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>;
<a name="l04644"></a>04644    <span class="keywordtype">int</span> res = -1;
<a name="l04645"></a>04645 
<a name="l04646"></a>04646    chan = <a class="code" href="channel_8c.html#e01fecb172f34785571d94adbc5c6558">ast_get_channel_by_name_locked</a>(channame);
<a name="l04647"></a>04647    <span class="keywordflow">if</span> (chan) {
<a name="l04648"></a>04648       res = <a class="code" href="pbx_8c.html#563b92a651459898f8ccfdc367746147">ast_async_goto</a>(chan, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>);
<a name="l04649"></a>04649       <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l04650"></a>04650    }
<a name="l04651"></a>04651    <span class="keywordflow">return</span> res;
<a name="l04652"></a>04652 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="26ff43c7d96ccf5b00248d0793ce93f5"></a><!-- doxytag: member="pbx.h::ast_async_goto_if_exists" ref="26ff43c7d96ccf5b00248d0793ce93f5" args="(struct ast_channel *chan, const char *context, const char *exten, int priority)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_async_goto_if_exists           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06282">6282</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06258">__ast_goto_if_exists()</a>.
<p>
Referenced by <a class="el" href="app__channelredirect_8c-source.html#l00052">asyncgoto_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l06283"></a>06283 {
<a name="l06284"></a>06284    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#ea67e0eddc31f7145c5c9c7991255636">__ast_goto_if_exists</a>(chan, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>, 1);
<a name="l06285"></a>06285 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="0d09633715f9b26a7c4922f1a12ff102"></a><!-- doxytag: member="pbx.h::ast_build_timing" ref="0d09633715f9b26a7c4922f1a12ff102" args="(struct ast_timing *i, const char *info)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_build_timing           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__timing.html">ast_timing</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>info</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04236">4236</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="pbx_8c-source.html#l04207">days</a>, <a class="el" href="pbx_8c-source.html#l04076">get_range()</a>, <a class="el" href="pbx_8c-source.html#l04122">get_timerange()</a>, <a class="el" href="pbx_8c-source.html#l04219">months</a>, and <a class="el" href="strcompat_8c-source.html#l00035">strsep()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04304">ast_context_add_include2()</a>, <a class="el" href="func__logic_8c-source.html#l00059">iftime()</a>, <a class="el" href="pbx_8c-source.html#l05525">pbx_builtin_execiftime()</a>, and <a class="el" href="pbx_8c-source.html#l05499">pbx_builtin_gotoiftime()</a>.<div class="fragment"><pre class="fragment"><a name="l04237"></a>04237 {
<a name="l04238"></a>04238    <span class="keywordtype">char</span> info_save[256];
<a name="l04239"></a>04239    <span class="keywordtype">char</span> *info;
<a name="l04240"></a>04240 
<a name="l04241"></a>04241    <span class="comment">/* Check for empty just in case */</span>
<a name="l04242"></a>04242    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(info_in))
<a name="l04243"></a>04243       <span class="keywordflow">return</span> 0;
<a name="l04244"></a>04244    <span class="comment">/* make a copy just in case we were passed a static string */</span>
<a name="l04245"></a>04245    ast_copy_string(info_save, info_in, <span class="keyword">sizeof</span>(info_save));
<a name="l04246"></a>04246    info = info_save;
<a name="l04247"></a>04247    <span class="comment">/* Assume everything except time */</span>
<a name="l04248"></a>04248    i-&gt;<a class="code" href="structast__timing.html#172e0a07579e3432c1fd51e89212d053">monthmask</a> = 0xfff;   <span class="comment">/* 12 bits */</span>
<a name="l04249"></a>04249    i-&gt;<a class="code" href="structast__timing.html#8668879f841e75be72d8089c58da1084">daymask</a> = 0x7fffffffU; <span class="comment">/* 31 bits */</span>
<a name="l04250"></a>04250    i-&gt;<a class="code" href="structast__timing.html#6b1c01be5fdf58e2c3f68567c3e20479">dowmask</a> = 0x7f; <span class="comment">/* 7 bits */</span>
<a name="l04251"></a>04251    <span class="comment">/* on each call, use strsep() to move info to the next argument */</span>
<a name="l04252"></a>04252    <a class="code" href="pbx_8c.html#997d3ca719932cc6dbf54c26337a0b3c">get_timerange</a>(i, <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;info, <span class="stringliteral">"|"</span>));
<a name="l04253"></a>04253    <span class="keywordflow">if</span> (info)
<a name="l04254"></a>04254       i-&gt;<a class="code" href="structast__timing.html#6b1c01be5fdf58e2c3f68567c3e20479">dowmask</a> = <a class="code" href="pbx_8c.html#1d96b045db44a1d8881f22cd211d4099">get_range</a>(<a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;info, <span class="stringliteral">"|"</span>), 7, <a class="code" href="pbx_8c.html#b926d07cd15d8fd1bdf2ab377f30ee25">days</a>, <span class="stringliteral">"day of week"</span>);
<a name="l04255"></a>04255    <span class="keywordflow">if</span> (info)
<a name="l04256"></a>04256       i-&gt;<a class="code" href="structast__timing.html#8668879f841e75be72d8089c58da1084">daymask</a> = <a class="code" href="pbx_8c.html#1d96b045db44a1d8881f22cd211d4099">get_range</a>(<a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;info, <span class="stringliteral">"|"</span>), 31, NULL, <span class="stringliteral">"day"</span>);
<a name="l04257"></a>04257    <span class="keywordflow">if</span> (info)
<a name="l04258"></a>04258       i-&gt;<a class="code" href="structast__timing.html#172e0a07579e3432c1fd51e89212d053">monthmask</a> = <a class="code" href="pbx_8c.html#1d96b045db44a1d8881f22cd211d4099">get_range</a>(<a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;info, <span class="stringliteral">"|"</span>), 12, <a class="code" href="pbx_8c.html#aab8c6e8889bb80d928fd716f4406fe7">months</a>, <span class="stringliteral">"month"</span>);
<a name="l04259"></a>04259    <span class="keywordflow">return</span> 1;
<a name="l04260"></a>04260 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8cdcfc880eae31c1eaa91e154491b5bc"></a><!-- doxytag: member="pbx.h::ast_canmatch_extension" ref="8cdcfc880eae31c1eaa91e154491b5bc" args="(struct ast_channel *c, const char *context, const char *exten, int priority, const char *callerid)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_canmatch_extension           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>callerid</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Looks for a valid matching extension. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>not really important </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>context to serach within </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>exten</em>&nbsp;</td><td>extension to check </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>priority</em>&nbsp;</td><td>priority of extension path </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callerid</em>&nbsp;</td><td>callerid of extension being searched for</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>If "exten" *could be* a valid extension in this context with or without some more digits, return non-zero. Basically, when this returns 0, no matter what you add to exten, it's not going to be a valid extension anymore </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02198">2198</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fee9684886238bd81a61f3358030326178">E_CANMATCH</a>, and <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>.
<p>
Referenced by <a class="el" href="app__talkdetect_8c-source.html#l00063">background_detect_exec()</a>, <a class="el" href="chan__iax2_8c-source.html#l06220">dp_lookup()</a>, <a class="el" href="pbx__dundi_8c-source.html#l00532">dundi_lookup_local()</a>, <a class="el" href="chan__sip_8c-source.html#l09533">get_also_info()</a>, <a class="el" href="chan__sip_8c-source.html#l09207">get_destination()</a>, <a class="el" href="app__rpt_8c-source.html#l03406">handle_link_data()</a>, <a class="el" href="app__rpt_8c-source.html#l03557">handle_link_phone_dtmf()</a>, <a class="el" href="pbx__loopback_8c-source.html#l00133">loopback_canmatch()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02638">mgcp_ss()</a>, <a class="el" href="chan__phone_8c-source.html#l00939">phone_check_exception()</a>, <a class="el" href="chan__skinny_8c-source.html#l02365">skinny_ss()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, and <a class="el" href="app__queue_8c-source.html#l01320">valid_exit()</a>.<div class="fragment"><pre class="fragment"><a name="l02199"></a>02199 {
<a name="l02200"></a>02200    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#2377c7b979811bdd54ebf819e5d2037b">pbx_extension_helper</a>(c, NULL, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>, NULL, callerid, <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fee9684886238bd81a61f3358030326178">E_CANMATCH</a>);
<a name="l02201"></a>02201 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4dee27d639900ebea4f8b3c0366a197f"></a><!-- doxytag: member="pbx.h::ast_check_timing" ref="4dee27d639900ebea4f8b3c0366a197f" args="(const struct ast_timing *i)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_check_timing           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const struct <a class="el" href="structast__timing.html">ast_timing</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>i</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04262">4262</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="pbx_8h-source.html#l00101">ast_timing::daymask</a>, <a class="el" href="pbx_8h-source.html#l00102">ast_timing::dowmask</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="pbx_8h-source.html#l00103">ast_timing::minmask</a>, and <a class="el" href="pbx_8h-source.html#l00100">ast_timing::monthmask</a>.
<p>
Referenced by <a class="el" href="func__logic_8c-source.html#l00059">iftime()</a>, <a class="el" href="pbx_8c-source.html#l00575">include_valid()</a>, <a class="el" href="pbx_8c-source.html#l05525">pbx_builtin_execiftime()</a>, and <a class="el" href="pbx_8c-source.html#l05499">pbx_builtin_gotoiftime()</a>.<div class="fragment"><pre class="fragment"><a name="l04263"></a>04263 {
<a name="l04264"></a>04264    <span class="keyword">struct </span>tm tm;
<a name="l04265"></a>04265    time_t t = time(NULL);
<a name="l04266"></a>04266 
<a name="l04267"></a>04267    localtime_r(&amp;t,&amp;tm);
<a name="l04268"></a>04268 
<a name="l04269"></a>04269    <span class="comment">/* If it's not the right month, return */</span>
<a name="l04270"></a>04270    <span class="keywordflow">if</span> (!(i-&gt;<a class="code" href="structast__timing.html#172e0a07579e3432c1fd51e89212d053">monthmask</a> &amp; (1 &lt;&lt; tm.tm_mon)))
<a name="l04271"></a>04271       <span class="keywordflow">return</span> 0;
<a name="l04272"></a>04272 
<a name="l04273"></a>04273    <span class="comment">/* If it's not that time of the month.... */</span>
<a name="l04274"></a>04274    <span class="comment">/* Warning, tm_mday has range 1..31! */</span>
<a name="l04275"></a>04275    <span class="keywordflow">if</span> (!(i-&gt;<a class="code" href="structast__timing.html#8668879f841e75be72d8089c58da1084">daymask</a> &amp; (1 &lt;&lt; (tm.tm_mday-1))))
<a name="l04276"></a>04276       <span class="keywordflow">return</span> 0;
<a name="l04277"></a>04277 
<a name="l04278"></a>04278    <span class="comment">/* If it's not the right day of the week */</span>
<a name="l04279"></a>04279    <span class="keywordflow">if</span> (!(i-&gt;<a class="code" href="structast__timing.html#6b1c01be5fdf58e2c3f68567c3e20479">dowmask</a> &amp; (1 &lt;&lt; tm.tm_wday)))
<a name="l04280"></a>04280       <span class="keywordflow">return</span> 0;
<a name="l04281"></a>04281 
<a name="l04282"></a>04282    <span class="comment">/* Sanity check the hour just to be safe */</span>
<a name="l04283"></a>04283    <span class="keywordflow">if</span> ((tm.tm_hour &lt; 0) || (tm.tm_hour &gt; 23)) {
<a name="l04284"></a>04284       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Insane time...\n"</span>);
<a name="l04285"></a>04285       <span class="keywordflow">return</span> 0;
<a name="l04286"></a>04286    }
<a name="l04287"></a>04287 
<a name="l04288"></a>04288    <span class="comment">/* Now the tough part, we calculate if it fits</span>
<a name="l04289"></a>04289 <span class="comment">      in the right time based on min/hour */</span>
<a name="l04290"></a>04290    <span class="keywordflow">if</span> (!(i-&gt;<a class="code" href="structast__timing.html#abad86ac50409185e19bcfa94e974d51">minmask</a>[tm.tm_hour] &amp; (1 &lt;&lt; (tm.tm_min / 2))))
<a name="l04291"></a>04291       <span class="keywordflow">return</span> 0;
<a name="l04292"></a>04292 
<a name="l04293"></a>04293    <span class="comment">/* If we got this far, then we're good */</span>
<a name="l04294"></a>04294    <span class="keywordflow">return</span> 1;
<a name="l04295"></a>04295 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d6db132e358d62d48a7379a59ebb9d19"></a><!-- doxytag: member="pbx.h::ast_context_add_ignorepat" ref="d6db132e358d62d48a7379a59ebb9d19" args="(const char *context, const char *ignorepat, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_add_ignorepat           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>ignorepat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add an ignorepat. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>which context to add the ignorpattern to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ignorepat</em>&nbsp;</td><td>ignorepattern to set up for the extension </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>registrar</em>&nbsp;</td><td>registrar of the ignore pattern</td></tr>
  </table>
</dl>
Adds an ignore pattern to a particular context.<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04497">4497</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l04509">ast_context_add_ignorepat2()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01065">handle_context_add_ignorepat()</a>.<div class="fragment"><pre class="fragment"><a name="l04498"></a>04498 {
<a name="l04499"></a>04499    <span class="keywordtype">int</span> ret = -1;
<a name="l04500"></a>04500    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = <a class="code" href="pbx_8c.html#4669bd753e060c6bb15a0c63c4e3785a">find_context_locked</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l04501"></a>04501 
<a name="l04502"></a>04502    <span class="keywordflow">if</span> (c) {
<a name="l04503"></a>04503       ret = <a class="code" href="pbx_8c.html#8837e61e90b56e79023e89ddb6b26fb1">ast_context_add_ignorepat2</a>(c, value, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l04504"></a>04504       <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l04505"></a>04505    }
<a name="l04506"></a>04506    <span class="keywordflow">return</span> ret;
<a name="l04507"></a>04507 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="e9036391e21fdf739d18ea7c2fced9e1"></a><!-- doxytag: member="pbx.h::ast_context_add_ignorepat2" ref="e9036391e21fdf739d18ea7c2fced9e1" args="(struct ast_context *con, const char *ignorepat, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_add_ignorepat2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>ignorepat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04509">4509</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="pbx_8c-source.html#l06092">ast_unlock_context()</a>, <a class="el" href="pbx_8c-source.html#l06082">ast_wrlock_context()</a>, <a class="el" href="pbx_8c-source.html#l00170">ast_context::ignorepats</a>, <a class="el" href="pbx_8c-source.html#l00160">ast_ignorepat::next</a>, <a class="el" href="pbx_8c-source.html#l00161">ast_ignorepat::pattern</a>, and <a class="el" href="pbx_8c-source.html#l00159">ast_ignorepat::registrar</a>.
<p>
Referenced by <a class="el" href="pbx__ael_8c-source.html#l03836">ast_compile_ael2()</a>, <a class="el" href="pbx_8c-source.html#l04497">ast_context_add_ignorepat()</a>, and <a class="el" href="pbx__config_8c-source.html#l01332">pbx_load_config()</a>.<div class="fragment"><pre class="fragment"><a name="l04510"></a>04510 {
<a name="l04511"></a>04511    <span class="keyword">struct </span><a class="code" href="structast__ignorepat.html">ast_ignorepat</a> *ignorepat, *ignorepatc, *ignorepatl = NULL;
<a name="l04512"></a>04512    <span class="keywordtype">int</span> length;
<a name="l04513"></a>04513    length = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structast__ignorepat.html">ast_ignorepat</a>);
<a name="l04514"></a>04514    length += strlen(value) + 1;
<a name="l04515"></a>04515    <span class="keywordflow">if</span> (!(ignorepat = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, length)))
<a name="l04516"></a>04516       <span class="keywordflow">return</span> -1;
<a name="l04517"></a>04517    <span class="comment">/* The cast to char * is because we need to write the initial value.</span>
<a name="l04518"></a>04518 <span class="comment">    * The field is not supposed to be modified otherwise</span>
<a name="l04519"></a>04519 <span class="comment">    */</span>
<a name="l04520"></a>04520    strcpy((<span class="keywordtype">char</span> *)ignorepat-&gt;<a class="code" href="structast__ignorepat.html#6ed092b904da0ceba9109608322e7880">pattern</a>, value);
<a name="l04521"></a>04521    ignorepat-&gt;<a class="code" href="structast__ignorepat.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = NULL;
<a name="l04522"></a>04522    ignorepat-&gt;<a class="code" href="structast__ignorepat.html#5940569cd1d60781f856f93235b072ee">registrar</a> = <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>;
<a name="l04523"></a>04523    <a class="code" href="pbx_8c.html#18884df37a7c36a24fd0b5f4225d1112">ast_wrlock_context</a>(con);
<a name="l04524"></a>04524    <span class="keywordflow">for</span> (ignorepatc = con-&gt;<a class="code" href="structast__context.html#79a69e07731e7d02c0f52f19bab94dcb">ignorepats</a>; ignorepatc; ignorepatc = ignorepatc-&gt;<a class="code" href="structast__ignorepat.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l04525"></a>04525       ignorepatl = ignorepatc;
<a name="l04526"></a>04526       <span class="keywordflow">if</span> (!strcasecmp(ignorepatc-&gt;<a class="code" href="structast__ignorepat.html#6ed092b904da0ceba9109608322e7880">pattern</a>, value)) {
<a name="l04527"></a>04527          <span class="comment">/* Already there */</span>
<a name="l04528"></a>04528          <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l04529"></a>04529          errno = EEXIST;
<a name="l04530"></a>04530          <span class="keywordflow">return</span> -1;
<a name="l04531"></a>04531       }
<a name="l04532"></a>04532    }
<a name="l04533"></a>04533    <span class="keywordflow">if</span> (ignorepatl)
<a name="l04534"></a>04534       ignorepatl-&gt;<a class="code" href="structast__ignorepat.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = ignorepat;
<a name="l04535"></a>04535    <span class="keywordflow">else</span>
<a name="l04536"></a>04536       con-&gt;<a class="code" href="structast__context.html#79a69e07731e7d02c0f52f19bab94dcb">ignorepats</a> = ignorepat;
<a name="l04537"></a>04537    <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l04538"></a>04538    <span class="keywordflow">return</span> 0;
<a name="l04539"></a>04539 
<a name="l04540"></a>04540 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ccdd98c0e8816634393437aad7cc5e01"></a><!-- doxytag: member="pbx.h::ast_context_add_include" ref="ccdd98c0e8816634393437aad7cc5e01" args="(const char *context, const char *include, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_add_include           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>include</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add a context include. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>context to add include to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>include</em>&nbsp;</td><td>new include to add </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>registrar</em>&nbsp;</td><td>who's registering it</td></tr>
  </table>
</dl>
Adds an include taking a char * string as the context parameter<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on error </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04042">4042</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l04304">ast_context_add_include2()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l00574">handle_context_add_include()</a>.<div class="fragment"><pre class="fragment"><a name="l04043"></a>04043 {
<a name="l04044"></a>04044    <span class="keywordtype">int</span> ret = -1;
<a name="l04045"></a>04045    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = <a class="code" href="pbx_8c.html#4669bd753e060c6bb15a0c63c4e3785a">find_context_locked</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l04046"></a>04046 
<a name="l04047"></a>04047    <span class="keywordflow">if</span> (c) {
<a name="l04048"></a>04048       ret = <a class="code" href="pbx_8c.html#b594e19215ace51bec1a5726a0801d07">ast_context_add_include2</a>(c, include, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l04049"></a>04049       <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l04050"></a>04050    }
<a name="l04051"></a>04051    <span class="keywordflow">return</span> ret;
<a name="l04052"></a>04052 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="626649005def49b89252e8b9ad0c3d46"></a><!-- doxytag: member="pbx.h::ast_context_add_include2" ref="626649005def49b89252e8b9ad0c3d46" args="(struct ast_context *con, const char *include, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_add_include2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>include</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add a context include. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>con</em>&nbsp;</td><td>context to add the include to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>include</em>&nbsp;</td><td>include to add </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>registrar</em>&nbsp;</td><td>who registered the context</td></tr>
  </table>
</dl>
Adds an include taking a struct <a class="el" href="structast__context.html">ast_context</a> as the first parameter<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04304">4304</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l04236">ast_build_timing()</a>, <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="pbx_8c-source.html#l06100">ast_get_context_name()</a>, <a class="el" href="pbx_8c-source.html#l06092">ast_unlock_context()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="pbx_8c-source.html#l06082">ast_wrlock_context()</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="pbx_8c-source.html#l00140">ast_include::hastime</a>, <a class="el" href="pbx_8c-source.html#l00169">ast_context::includes</a>, <a class="el" href="pbx_8c-source.html#l00137">ast_include::name</a>, <a class="el" href="pbx_8c-source.html#l00142">ast_include::next</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="pbx_8c-source.html#l00139">ast_include::registrar</a>, <a class="el" href="pbx_8c-source.html#l00138">ast_include::rname</a>, <a class="el" href="pbx_8c-source.html#l00143">ast_include::stuff</a>, <a class="el" href="pbx_8c-source.html#l00141">ast_include::timing</a>, and <a class="el" href="logger_8h-source.html#l00045">VERBOSE_PREFIX_3</a>.
<p>
Referenced by <a class="el" href="pbx__ael_8c-source.html#l03836">ast_compile_ael2()</a>, <a class="el" href="pbx_8c-source.html#l04042">ast_context_add_include()</a>, and <a class="el" href="pbx__config_8c-source.html#l01332">pbx_load_config()</a>.<div class="fragment"><pre class="fragment"><a name="l04306"></a>04306 {
<a name="l04307"></a>04307    <span class="keyword">struct </span><a class="code" href="structast__include.html">ast_include</a> *new_include;
<a name="l04308"></a>04308    <span class="keywordtype">char</span> *c;
<a name="l04309"></a>04309    <span class="keyword">struct </span><a class="code" href="structast__include.html">ast_include</a> *i, *il = NULL; <span class="comment">/* include, include_last */</span>
<a name="l04310"></a>04310    <span class="keywordtype">int</span> length;
<a name="l04311"></a>04311    <span class="keywordtype">char</span> *p;
<a name="l04312"></a>04312 
<a name="l04313"></a>04313    length = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structast__include.html">ast_include</a>);
<a name="l04314"></a>04314    length += 2 * (strlen(value) + 1);
<a name="l04315"></a>04315 
<a name="l04316"></a>04316    <span class="comment">/* allocate new include structure ... */</span>
<a name="l04317"></a>04317    <span class="keywordflow">if</span> (!(new_include = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, length)))
<a name="l04318"></a>04318       <span class="keywordflow">return</span> -1;
<a name="l04319"></a>04319    <span class="comment">/* Fill in this structure. Use 'p' for assignments, as the fields</span>
<a name="l04320"></a>04320 <span class="comment">    * in the structure are 'const char *'</span>
<a name="l04321"></a>04321 <span class="comment">    */</span>
<a name="l04322"></a>04322    p = new_include-&gt;<a class="code" href="structast__include.html#3d111ff6c918c5cbdf2b3e843726ec71">stuff</a>;
<a name="l04323"></a>04323    new_include-&gt;<a class="code" href="structast__include.html#b068931cc450442b63f5b3d276ea4297">name</a> = p;
<a name="l04324"></a>04324    strcpy(p, value);
<a name="l04325"></a>04325    p += strlen(value) + 1;
<a name="l04326"></a>04326    new_include-&gt;<a class="code" href="structast__include.html#c626d8954194dd0136691c301dcf7ece">rname</a> = p;
<a name="l04327"></a>04327    strcpy(p, value);
<a name="l04328"></a>04328    <span class="comment">/* Strip off timing info, and process if it is there */</span>
<a name="l04329"></a>04329    <span class="keywordflow">if</span> ( (c = strchr(p, <span class="charliteral">'|'</span>)) ) {
<a name="l04330"></a>04330       *c++ = <span class="charliteral">'\0'</span>;
<a name="l04331"></a>04331            new_include-&gt;<a class="code" href="structast__include.html#afa6dfc2de3a5a43456abec2b5972ab0">hastime</a> = <a class="code" href="pbx_8c.html#b45b278cc04e70970e83433d6e9c60a8">ast_build_timing</a>(&amp;(new_include-&gt;<a class="code" href="structast__include.html#4ad8aa3a3571ea912a6ec5ea5fdcc93c">timing</a>), c);
<a name="l04332"></a>04332    }
<a name="l04333"></a>04333    new_include-&gt;<a class="code" href="structast__include.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>      = NULL;
<a name="l04334"></a>04334    new_include-&gt;<a class="code" href="structast__include.html#5940569cd1d60781f856f93235b072ee">registrar</a> = <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>;
<a name="l04335"></a>04335 
<a name="l04336"></a>04336    <a class="code" href="pbx_8c.html#18884df37a7c36a24fd0b5f4225d1112">ast_wrlock_context</a>(con);
<a name="l04337"></a>04337 
<a name="l04338"></a>04338    <span class="comment">/* ... go to last include and check if context is already included too... */</span>
<a name="l04339"></a>04339    <span class="keywordflow">for</span> (i = con-&gt;<a class="code" href="structast__context.html#bb2b21ef7774df8687ff02b0284505c6">includes</a>; i; i = i-&gt;<a class="code" href="structast__include.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l04340"></a>04340       <span class="keywordflow">if</span> (!strcasecmp(i-&gt;<a class="code" href="structast__include.html#b068931cc450442b63f5b3d276ea4297">name</a>, new_include-&gt;<a class="code" href="structast__include.html#b068931cc450442b63f5b3d276ea4297">name</a>)) {
<a name="l04341"></a>04341          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(new_include);
<a name="l04342"></a>04342          <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l04343"></a>04343          errno = EEXIST;
<a name="l04344"></a>04344          <span class="keywordflow">return</span> -1;
<a name="l04345"></a>04345       }
<a name="l04346"></a>04346       il = i;
<a name="l04347"></a>04347    }
<a name="l04348"></a>04348 
<a name="l04349"></a>04349    <span class="comment">/* ... include new context into context list, unlock, return */</span>
<a name="l04350"></a>04350    <span class="keywordflow">if</span> (il)
<a name="l04351"></a>04351       il-&gt;<a class="code" href="structast__include.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = new_include;
<a name="l04352"></a>04352    <span class="keywordflow">else</span>
<a name="l04353"></a>04353       con-&gt;<a class="code" href="structast__context.html#bb2b21ef7774df8687ff02b0284505c6">includes</a> = new_include;
<a name="l04354"></a>04354    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 2)
<a name="l04355"></a>04355       <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#aefd5a67b7464040f5352e4ecdc535ca">VERBOSE_PREFIX_3</a> <span class="stringliteral">"Including context '%s' in context '%s'\n"</span>, new_include-&gt;<a class="code" href="structast__include.html#b068931cc450442b63f5b3d276ea4297">name</a>, <a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(con));
<a name="l04356"></a>04356 
<a name="l04357"></a>04357    <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l04358"></a>04358 
<a name="l04359"></a>04359    <span class="keywordflow">return</span> 0;
<a name="l04360"></a>04360 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="afa734254246b0a5d03b045767bf645c"></a><!-- doxytag: member="pbx.h::ast_context_add_switch" ref="afa734254246b0a5d03b045767bf645c" args="(const char *context, const char *sw, const char *data, int eval, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_add_switch           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>sw</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>eval</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add a switch. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>context to which to add the switch </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sw</em>&nbsp;</td><td>switch to add </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>data to pass to switch </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>eval</em>&nbsp;</td><td>whether to evaluate variables when running switch </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>registrar</em>&nbsp;</td><td>whoever registered the switch</td></tr>
  </table>
</dl>
This function registers a switch with the asterisk switch architecture<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04367">4367</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l04386">ast_context_add_switch2()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>.<div class="fragment"><pre class="fragment"><a name="l04368"></a>04368 {
<a name="l04369"></a>04369    <span class="keywordtype">int</span> ret = -1;
<a name="l04370"></a>04370    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = <a class="code" href="pbx_8c.html#4669bd753e060c6bb15a0c63c4e3785a">find_context_locked</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l04371"></a>04371 
<a name="l04372"></a>04372    <span class="keywordflow">if</span> (c) { <span class="comment">/* found, add switch to this context */</span>
<a name="l04373"></a>04373       ret = <a class="code" href="pbx_8c.html#6fae5ece5f5f729b48d4a8e0bd73b642">ast_context_add_switch2</a>(c, sw, data, eval, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l04374"></a>04374       <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l04375"></a>04375    }
<a name="l04376"></a>04376    <span class="keywordflow">return</span> ret;
<a name="l04377"></a>04377 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="28ff3bafac28fac8abda2d03f0f154ec"></a><!-- doxytag: member="pbx.h::ast_context_add_switch2" ref="28ff3bafac28fac8abda2d03f0f154ec" args="(struct ast_context *con, const char *sw, const char *data, int eval, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_add_switch2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>sw</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>eval</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Adds a switch (first param is a <a class="el" href="structast__context.html">ast_context</a>). 
<p>
<dl compact><dt><b>Note:</b></dt><dd>See <a class="el" href="pbx_8c.html#afa734254246b0a5d03b045767bf645c">ast_context_add_switch()</a> for argument information, with the exception of the first argument. In this case, it's a pointer to an <a class="el" href="structast__context.html">ast_context</a> structure as opposed to the name. </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04386">4386</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="pbx_8c-source.html#l06100">ast_get_context_name()</a>, <a class="el" href="linkedlists_8h-source.html#l00670">AST_LIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="pbx_8c-source.html#l06092">ast_unlock_context()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="pbx_8c-source.html#l06082">ast_wrlock_context()</a>, <a class="el" href="pbx_8c-source.html#l00150">ast_sw::data</a>, <a class="el" href="pbx_8c-source.html#l00151">ast_sw::eval</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="pbx_8c-source.html#l00148">ast_sw::name</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="pbx_8c-source.html#l00149">ast_sw::registrar</a>, <a class="el" href="pbx_8c-source.html#l00083">SWITCH_DATA_LENGTH</a>, and <a class="el" href="logger_8h-source.html#l00045">VERBOSE_PREFIX_3</a>.
<p>
Referenced by <a class="el" href="pbx__ael_8c-source.html#l03836">ast_compile_ael2()</a>, <a class="el" href="pbx_8c-source.html#l04367">ast_context_add_switch()</a>, and <a class="el" href="pbx__config_8c-source.html#l01332">pbx_load_config()</a>.<div class="fragment"><pre class="fragment"><a name="l04388"></a>04388 {
<a name="l04389"></a>04389    <span class="keyword">struct </span><a class="code" href="structast__sw.html">ast_sw</a> *new_sw;
<a name="l04390"></a>04390    <span class="keyword">struct </span><a class="code" href="structast__sw.html">ast_sw</a> *i;
<a name="l04391"></a>04391    <span class="keywordtype">int</span> length;
<a name="l04392"></a>04392    <span class="keywordtype">char</span> *p;
<a name="l04393"></a>04393 
<a name="l04394"></a>04394    length = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structast__sw.html">ast_sw</a>);
<a name="l04395"></a>04395    length += strlen(value) + 1;
<a name="l04396"></a>04396    <span class="keywordflow">if</span> (<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>)
<a name="l04397"></a>04397       length += strlen(<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l04398"></a>04398    length++;
<a name="l04399"></a>04399    <span class="keywordflow">if</span> (<a class="code" href="structast__sw.html#2eed1fe0db36d674643b5f84d2adf46e">eval</a>) {
<a name="l04400"></a>04400       <span class="comment">/* Create buffer for evaluation of variables */</span>
<a name="l04401"></a>04401       length += <a class="code" href="pbx_8c.html#27dc176701e9014e219fe586c4f546e5">SWITCH_DATA_LENGTH</a>;
<a name="l04402"></a>04402       length++;
<a name="l04403"></a>04403    }
<a name="l04404"></a>04404 
<a name="l04405"></a>04405    <span class="comment">/* allocate new sw structure ... */</span>
<a name="l04406"></a>04406    <span class="keywordflow">if</span> (!(new_sw = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, length)))
<a name="l04407"></a>04407       <span class="keywordflow">return</span> -1;
<a name="l04408"></a>04408    <span class="comment">/* ... fill in this structure ... */</span>
<a name="l04409"></a>04409    p = new_sw-&gt;stuff;
<a name="l04410"></a>04410    new_sw-&gt;<a class="code" href="structast__sw.html#b068931cc450442b63f5b3d276ea4297">name</a> = p;
<a name="l04411"></a>04411    strcpy(new_sw-&gt;<a class="code" href="structast__sw.html#b068931cc450442b63f5b3d276ea4297">name</a>, value);
<a name="l04412"></a>04412    p += strlen(value) + 1;
<a name="l04413"></a>04413    new_sw-&gt;<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a> = p;
<a name="l04414"></a>04414    <span class="keywordflow">if</span> (<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>) {
<a name="l04415"></a>04415       strcpy(new_sw-&gt;<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>, <a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l04416"></a>04416       p += strlen(<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>) + 1;
<a name="l04417"></a>04417    } <span class="keywordflow">else</span> {
<a name="l04418"></a>04418       strcpy(new_sw-&gt;<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>, <span class="stringliteral">""</span>);
<a name="l04419"></a>04419       p++;
<a name="l04420"></a>04420    }
<a name="l04421"></a>04421    <span class="keywordflow">if</span> (<a class="code" href="structast__sw.html#2eed1fe0db36d674643b5f84d2adf46e">eval</a>)
<a name="l04422"></a>04422       new_sw-&gt;tmpdata = p;
<a name="l04423"></a>04423    new_sw-&gt;<a class="code" href="structast__sw.html#2eed1fe0db36d674643b5f84d2adf46e">eval</a>     = <a class="code" href="structast__sw.html#2eed1fe0db36d674643b5f84d2adf46e">eval</a>;
<a name="l04424"></a>04424    new_sw-&gt;<a class="code" href="structast__sw.html#5940569cd1d60781f856f93235b072ee">registrar</a> = <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>;
<a name="l04425"></a>04425 
<a name="l04426"></a>04426    <span class="comment">/* ... try to lock this context ... */</span>
<a name="l04427"></a>04427    <a class="code" href="pbx_8c.html#18884df37a7c36a24fd0b5f4225d1112">ast_wrlock_context</a>(con);
<a name="l04428"></a>04428 
<a name="l04429"></a>04429    <span class="comment">/* ... go to last sw and check if context is already swd too... */</span>
<a name="l04430"></a>04430    <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;con-&gt;alts, i, list) {
<a name="l04431"></a>04431       <span class="keywordflow">if</span> (!strcasecmp(i-&gt;<a class="code" href="structast__sw.html#b068931cc450442b63f5b3d276ea4297">name</a>, new_sw-&gt;<a class="code" href="structast__sw.html#b068931cc450442b63f5b3d276ea4297">name</a>) &amp;&amp; !strcasecmp(i-&gt;<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>, new_sw-&gt;<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>)) {
<a name="l04432"></a>04432          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(new_sw);
<a name="l04433"></a>04433          <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l04434"></a>04434          errno = EEXIST;
<a name="l04435"></a>04435          <span class="keywordflow">return</span> -1;
<a name="l04436"></a>04436       }
<a name="l04437"></a>04437    }
<a name="l04438"></a>04438 
<a name="l04439"></a>04439    <span class="comment">/* ... sw new context into context list, unlock, return */</span>
<a name="l04440"></a>04440    <a class="code" href="linkedlists_8h.html#8de6ce8a3b9d59e7e7fddee6b62b32a7">AST_LIST_INSERT_TAIL</a>(&amp;con-&gt;alts, new_sw, list);
<a name="l04441"></a>04441 
<a name="l04442"></a>04442    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 2)
<a name="l04443"></a>04443       <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#aefd5a67b7464040f5352e4ecdc535ca">VERBOSE_PREFIX_3</a> <span class="stringliteral">"Including switch '%s/%s' in context '%s'\n"</span>, new_sw-&gt;<a class="code" href="structast__sw.html#b068931cc450442b63f5b3d276ea4297">name</a>, new_sw-&gt;<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>, <a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(con));
<a name="l04444"></a>04444 
<a name="l04445"></a>04445    <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l04446"></a>04446 
<a name="l04447"></a>04447    <span class="keywordflow">return</span> 0;
<a name="l04448"></a>04448 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="9b7261abb02956903bb17c5bf8af265a"></a><!-- doxytag: member="pbx.h::ast_context_create" ref="9b7261abb02956903bb17c5bf8af265a" args="(struct ast_context **extcontexts, const char *name, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a>* ast_context_create           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>extcontexts</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Register a new context. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>extcontexts</em>&nbsp;</td><td>pointer to the <a class="el" href="structast__context.html">ast_context</a> structure pointer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>name of the new context </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>registrar</em>&nbsp;</td><td>registrar of the context</td></tr>
  </table>
</dl>
This will first search for a context with your name. If it exists already, it will not create a new one. If it does not exist, it will create a new one with the given name and registrar.<p>
<dl compact><dt><b>Returns:</b></dt><dd>NULL on failure, and an <a class="el" href="structast__context.html">ast_context</a> structure on success </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03913">3913</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l03870">__ast_context_create()</a>.
<p>
Referenced by <a class="el" href="pbx__ael_8c-source.html#l03836">ast_compile_ael2()</a>, <a class="el" href="res__features_8c-source.html#l00342">ast_park_call()</a>, <a class="el" href="res__features_8c-source.html#l01761">do_parking_thread()</a>, <a class="el" href="res__features_8c-source.html#l02453">load_config()</a>, and <a class="el" href="chan__sip_8c-source.html#l17179">reload_config()</a>.<div class="fragment"><pre class="fragment"><a name="l03914"></a>03914 {
<a name="l03915"></a>03915    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#04aa8a1856d1ec89ebff7bd112b037eb">__ast_context_create</a>(extcontexts, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>, 0);
<a name="l03916"></a>03916 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ac0d672d0448b82e3b3eac25b400d4d2"></a><!-- doxytag: member="pbx.h::ast_context_destroy" ref="ac0d672d0448b82e3b3eac25b400d4d2" args="(struct ast_context *con, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_context_destroy           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Destroy a context (matches the specified context (or ANY context if NULL). 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>con</em>&nbsp;</td><td>context to destroy </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>registrar</em>&nbsp;</td><td>who registered it</td></tr>
  </table>
</dl>
You can optionally leave out either parameter. It will find it based on either the <a class="el" href="structast__context.html">ast_context</a> or the registrar name.<p>
<dl compact><dt><b>Returns:</b></dt><dd>nothing </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05344">5344</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l05285">__ast_context_destroy()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l06064">ast_wrlock_contexts()</a>.
<p>
Referenced by <a class="el" href="chan__sip_8c-source.html#l10548">cleanup_stale_contexts()</a>, and <a class="el" href="pbx__ael_8c-source.html#l04125">unload_module()</a>.<div class="fragment"><pre class="fragment"><a name="l05345"></a>05345 {
<a name="l05346"></a>05346    <a class="code" href="pbx_8c.html#6f41efd0c2fa84486ef11fef33681139">ast_wrlock_contexts</a>();
<a name="l05347"></a>05347    <a class="code" href="pbx_8c.html#e2faf43e79194dd93e6200a86f08d563">__ast_context_destroy</a>(con,<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l05348"></a>05348    <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l05349"></a>05349 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="f8c5b4e7d06b7aff72707b5d7d7c94e1"></a><!-- doxytag: member="pbx.h::ast_context_find" ref="f8c5b4e7d06b7aff72707b5d7d7c94e1" args="(const char *name)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a>* ast_context_find           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>name</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Find a context. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>name of the context to find</td></tr>
  </table>
</dl>
Will search for the context with the given name.<p>
<dl compact><dt><b>Returns:</b></dt><dd>the <a class="el" href="structast__context.html">ast_context</a> on success, NULL on failure. </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00889">889</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06069">ast_rdlock_contexts()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l06196">ast_walk_contexts()</a>.
<p>
Referenced by <a class="el" href="app__macro_8c-source.html#l00144">_macro_exec()</a>, <a class="el" href="pbx_8c-source.html#l06243">ast_context_verify_includes()</a>, <a class="el" href="pbx_8c-source.html#l04542">ast_ignore_pattern()</a>, <a class="el" href="res__features_8c-source.html#l00342">ast_park_call()</a>, <a class="el" href="chan__sip_8c-source.html#l10548">cleanup_stale_contexts()</a>, <a class="el" href="res__features_8c-source.html#l01761">do_parking_thread()</a>, <a class="el" href="res__features_8c-source.html#l02453">load_config()</a>, <a class="el" href="chan__sip_8c-source.html#l02646">register_peer_exten()</a>, and <a class="el" href="chan__sip_8c-source.html#l17179">reload_config()</a>.<div class="fragment"><pre class="fragment"><a name="l00890"></a>00890 {
<a name="l00891"></a>00891    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *tmp = NULL;
<a name="l00892"></a>00892    <a class="code" href="pbx_8c.html#1b60f4b570102084989c86fd02ca6536">ast_rdlock_contexts</a>();
<a name="l00893"></a>00893    <span class="keywordflow">while</span> ( (tmp = <a class="code" href="pbx_8c.html#709c9b64f2da1eaace237db32a5e1445">ast_walk_contexts</a>(tmp)) ) {
<a name="l00894"></a>00894       <span class="keywordflow">if</span> (!<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a> || !strcasecmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, tmp-&gt;name))
<a name="l00895"></a>00895          <span class="keywordflow">break</span>;
<a name="l00896"></a>00896    }
<a name="l00897"></a>00897    <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l00898"></a>00898    <span class="keywordflow">return</span> tmp;
<a name="l00899"></a>00899 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="773dc5d298a6de227dfddae824e996d7"></a><!-- doxytag: member="pbx.h::ast_context_find_or_create" ref="773dc5d298a6de227dfddae824e996d7" args="(struct ast_context **extcontexts, const char *name, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a>* ast_context_find_or_create           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>extcontexts</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Register a new context or find an existing one. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>extcontexts</em>&nbsp;</td><td>pointer to the <a class="el" href="structast__context.html">ast_context</a> structure pointer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>name of the new context </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>registrar</em>&nbsp;</td><td>registrar of the context</td></tr>
  </table>
</dl>
This will first search for a context with your name. If it exists already, it will not create a new one. If it does not exist, it will create a new one with the given name and registrar.<p>
<dl compact><dt><b>Returns:</b></dt><dd>NULL on failure, and an <a class="el" href="structast__context.html">ast_context</a> structure on success </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03918">3918</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l03870">__ast_context_create()</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01332">pbx_load_config()</a>, <a class="el" href="pbx__config_8c-source.html#l01510">pbx_load_users()</a>, <a class="el" href="app__meetme_8c-source.html#l04662">sla_build_station()</a>, and <a class="el" href="app__meetme_8c-source.html#l04527">sla_build_trunk()</a>.<div class="fragment"><pre class="fragment"><a name="l03919"></a>03919 {
<a name="l03920"></a>03920    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#04aa8a1856d1ec89ebff7bd112b037eb">__ast_context_create</a>(extcontexts, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>, 1);
<a name="l03921"></a>03921 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="35f43efa8b6f025e116b28e16d7cd355"></a><!-- doxytag: member="pbx.h::ast_context_lockmacro" ref="35f43efa8b6f025e116b28e16d7cd355" args="(const char *macrocontext)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_lockmacro           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>context</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
locks the macrolock in the given given context 
<p>
<dl compact><dt><b>Note:</b></dt><dd>This function locks contexts list by &amp;conlist, searches for the right context structure, and locks the macrolock mutex in that context. macrolock is used to limit a macro to be executed by one call at a time. </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02823">2823</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06100">ast_get_context_name()</a>, <a class="el" href="lock_8h-source.html#l00530">ast_mutex_lock()</a>, <a class="el" href="pbx_8c-source.html#l06069">ast_rdlock_contexts()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l06196">ast_walk_contexts()</a>.
<p>
Referenced by <a class="el" href="app__macro_8c-source.html#l00144">_macro_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l02824"></a>02824 {
<a name="l02825"></a>02825    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = NULL;
<a name="l02826"></a>02826    <span class="keywordtype">int</span> ret = -1;
<a name="l02827"></a>02827 
<a name="l02828"></a>02828    <a class="code" href="pbx_8c.html#1b60f4b570102084989c86fd02ca6536">ast_rdlock_contexts</a>();
<a name="l02829"></a>02829 
<a name="l02830"></a>02830    <span class="keywordflow">while</span> ((c = <a class="code" href="pbx_8c.html#709c9b64f2da1eaace237db32a5e1445">ast_walk_contexts</a>(c))) {
<a name="l02831"></a>02831       <span class="keywordflow">if</span> (!strcmp(<a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(c), <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>)) {
<a name="l02832"></a>02832          ret = 0;
<a name="l02833"></a>02833          <span class="keywordflow">break</span>;
<a name="l02834"></a>02834       }
<a name="l02835"></a>02835    }
<a name="l02836"></a>02836 
<a name="l02837"></a>02837    <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l02838"></a>02838 
<a name="l02839"></a>02839    <span class="comment">/* if we found context, lock macrolock */</span>
<a name="l02840"></a>02840    <span class="keywordflow">if</span> (ret == 0) 
<a name="l02841"></a>02841       ret = <a class="code" href="lock_8h.html#b3c5e3093b325167f88db93c8b4b2421">ast_mutex_lock</a>(&amp;c-&gt;macrolock);
<a name="l02842"></a>02842 
<a name="l02843"></a>02843    <span class="keywordflow">return</span> ret;
<a name="l02844"></a>02844 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ed70bf6c908a1c70415454997c0d7902"></a><!-- doxytag: member="pbx.h::ast_context_remove_extension" ref="ed70bf6c908a1c70415454997c0d7902" args="(const char *context, const char *extension, int priority, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_remove_extension           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>extension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Simply remove extension from context. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>context to remove extension from </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>extension</em>&nbsp;</td><td>which extension to remove </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>priority</em>&nbsp;</td><td>priority of extension to remove </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>registrar</em>&nbsp;</td><td>registrar of the extension</td></tr>
  </table>
</dl>
This function removes an extension from a given context.<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02724">2724</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l02746">ast_context_remove_extension2()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>.
<p>
Referenced by <a class="el" href="app__meetme_8c-source.html#l04461">destroy_station()</a>, <a class="el" href="app__meetme_8c-source.html#l04447">destroy_trunk()</a>, <a class="el" href="pbx__config_8c-source.html#l00335">handle_context_remove_extension()</a>, and <a class="el" href="chan__iax2_8c-source.html#l05647">register_peer_exten()</a>.<div class="fragment"><pre class="fragment"><a name="l02725"></a>02725 {
<a name="l02726"></a>02726    <span class="keywordtype">int</span> ret = -1; <span class="comment">/* default error return */</span>
<a name="l02727"></a>02727    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = <a class="code" href="pbx_8c.html#4669bd753e060c6bb15a0c63c4e3785a">find_context_locked</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l02728"></a>02728 
<a name="l02729"></a>02729    <span class="keywordflow">if</span> (c) { <span class="comment">/* ... remove extension ... */</span>
<a name="l02730"></a>02730       ret = <a class="code" href="pbx_8c.html#c1d85c0d2ff75a7c476fa8379affd931">ast_context_remove_extension2</a>(c, extension, priority, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l02731"></a>02731       <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l02732"></a>02732    }
<a name="l02733"></a>02733    <span class="keywordflow">return</span> ret;
<a name="l02734"></a>02734 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c1d85c0d2ff75a7c476fa8379affd931"></a><!-- doxytag: member="pbx.h::ast_context_remove_extension2" ref="c1d85c0d2ff75a7c476fa8379affd931" args="(struct ast_context *con, const char *extension, int priority, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_remove_extension2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>extension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This functionc locks given context, search for the right extension and fires out all peer in this extensions with given priority. If priority is set to 0, all peers are removed. After that, unlock context and return. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>When do you want to call this function, make sure that &amp;conlock is locked, because some process can handle with your *con context before you lock it. </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02746">2746</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06092">ast_unlock_context()</a>, <a class="el" href="pbx_8c-source.html#l06082">ast_wrlock_context()</a>, <a class="el" href="pbx_8c-source.html#l02521">destroy_exten()</a>, <a class="el" href="pbx_8c-source.html#l00119">ast_exten::exten</a>, <a class="el" href="chan__alsa_8c-source.html#l00126">exten</a>, <a class="el" href="pbx_8c-source.html#l00131">ast_exten::next</a>, <a class="el" href="pbx_8c-source.html#l00129">ast_exten::peer</a>, <a class="el" href="pbx_8c-source.html#l00122">ast_exten::priority</a>, <a class="el" href="pbx_8c-source.html#l00130">ast_exten::registrar</a>, and <a class="el" href="pbx_8c-source.html#l00167">ast_context::root</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02724">ast_context_remove_extension()</a>, <a class="el" href="res__features_8c-source.html#l01761">do_parking_thread()</a>, and <a class="el" href="res__features_8c-source.html#l02453">load_config()</a>.<div class="fragment"><pre class="fragment"><a name="l02747"></a>02747 {
<a name="l02748"></a>02748    <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, *prev_exten = NULL;
<a name="l02749"></a>02749    <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a>;
<a name="l02750"></a>02750 
<a name="l02751"></a>02751    <a class="code" href="pbx_8c.html#18884df37a7c36a24fd0b5f4225d1112">ast_wrlock_context</a>(con);
<a name="l02752"></a>02752 
<a name="l02753"></a>02753    <span class="comment">/* scan the extension list to find matching extension-registrar */</span>
<a name="l02754"></a>02754    <span class="keywordflow">for</span> (exten = con-&gt;<a class="code" href="structast__context.html#63a9f0ea7bb98050796b649e85481845">root</a>; exten; prev_exten = exten, exten = exten-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l02755"></a>02755       <span class="keywordflow">if</span> (!strcmp(exten-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>, extension) &amp;&amp;
<a name="l02756"></a>02756          (!<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a> || !strcmp(exten-&gt;<a class="code" href="structast__exten.html#5940569cd1d60781f856f93235b072ee">registrar</a>, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>)))
<a name="l02757"></a>02757          <span class="keywordflow">break</span>;
<a name="l02758"></a>02758    }
<a name="l02759"></a>02759    <span class="keywordflow">if</span> (!exten) {
<a name="l02760"></a>02760       <span class="comment">/* we can't find right extension */</span>
<a name="l02761"></a>02761       <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l02762"></a>02762       <span class="keywordflow">return</span> -1;
<a name="l02763"></a>02763    }
<a name="l02764"></a>02764 
<a name="l02765"></a>02765    <span class="comment">/* should we free all peers in this extension? (priority == 0)? */</span>
<a name="l02766"></a>02766    <span class="keywordflow">if</span> (<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a> == 0) {
<a name="l02767"></a>02767       <span class="comment">/* remove this extension from context list */</span>
<a name="l02768"></a>02768       <span class="keywordflow">if</span> (prev_exten)
<a name="l02769"></a>02769          prev_exten-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = exten-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l02770"></a>02770       <span class="keywordflow">else</span>
<a name="l02771"></a>02771          con-&gt;<a class="code" href="structast__context.html#63a9f0ea7bb98050796b649e85481845">root</a> = exten-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l02772"></a>02772 
<a name="l02773"></a>02773       <span class="comment">/* fire out all peers */</span>
<a name="l02774"></a>02774       <span class="keywordflow">while</span> ( (peer = exten) ) {
<a name="l02775"></a>02775          exten = peer-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a>; <span class="comment">/* prepare for next entry */</span>
<a name="l02776"></a>02776          <a class="code" href="pbx_8c.html#c7a22bae87915c24108c7304264b78c8">destroy_exten</a>(peer);
<a name="l02777"></a>02777       }
<a name="l02778"></a>02778    } <span class="keywordflow">else</span> {
<a name="l02779"></a>02779       <span class="comment">/* scan the priority list to remove extension with exten-&gt;priority == priority */</span>
<a name="l02780"></a>02780       <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *previous_peer = NULL;
<a name="l02781"></a>02781 
<a name="l02782"></a>02782       <span class="keywordflow">for</span> (peer = exten; peer; previous_peer = peer, peer = peer-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a>) {
<a name="l02783"></a>02783          <span class="keywordflow">if</span> (peer-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a> == <a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a> &amp;&amp;
<a name="l02784"></a>02784                (!<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a> || !strcmp(peer-&gt;<a class="code" href="structast__exten.html#5940569cd1d60781f856f93235b072ee">registrar</a>, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>) ))
<a name="l02785"></a>02785             <span class="keywordflow">break</span>; <span class="comment">/* found our priority */</span>
<a name="l02786"></a>02786       }
<a name="l02787"></a>02787       <span class="keywordflow">if</span> (!peer) { <span class="comment">/* not found */</span>
<a name="l02788"></a>02788          <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l02789"></a>02789          <span class="keywordflow">return</span> -1;
<a name="l02790"></a>02790       }
<a name="l02791"></a>02791       <span class="comment">/* we are first priority extension? */</span>
<a name="l02792"></a>02792       <span class="keywordflow">if</span> (!previous_peer) {
<a name="l02793"></a>02793          <span class="comment">/*</span>
<a name="l02794"></a>02794 <span class="comment">          * We are first in the priority chain, so must update the extension chain.</span>
<a name="l02795"></a>02795 <span class="comment">          * The next node is either the next priority or the next extension</span>
<a name="l02796"></a>02796 <span class="comment">          */</span>
<a name="l02797"></a>02797          <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *next_node = peer-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a> ? peer-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a> : peer-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l02798"></a>02798 
<a name="l02799"></a>02799          <span class="keywordflow">if</span> (!prev_exten)  <span class="comment">/* change the root... */</span>
<a name="l02800"></a>02800             con-&gt;<a class="code" href="structast__context.html#63a9f0ea7bb98050796b649e85481845">root</a> = next_node;
<a name="l02801"></a>02801          <span class="keywordflow">else</span>
<a name="l02802"></a>02802             prev_exten-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = next_node; <span class="comment">/* unlink */</span>
<a name="l02803"></a>02803          <span class="keywordflow">if</span> (peer-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a>)   <span class="comment">/* XXX update the new head of the pri list */</span>
<a name="l02804"></a>02804             peer-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a>-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = peer-&gt;<a class="code" href="structast__exten.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l02805"></a>02805       } <span class="keywordflow">else</span> { <span class="comment">/* easy, we are not first priority in extension */</span>
<a name="l02806"></a>02806          previous_peer-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a> = peer-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a>;
<a name="l02807"></a>02807       }
<a name="l02808"></a>02808 
<a name="l02809"></a>02809       <span class="comment">/* now, free whole priority extension */</span>
<a name="l02810"></a>02810       <a class="code" href="pbx_8c.html#c7a22bae87915c24108c7304264b78c8">destroy_exten</a>(peer);
<a name="l02811"></a>02811       <span class="comment">/* XXX should we return -1 ? */</span>
<a name="l02812"></a>02812    }
<a name="l02813"></a>02813    <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l02814"></a>02814    <span class="keywordflow">return</span> 0;
<a name="l02815"></a>02815 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="041875d3b92a3d0f748b8a0203e042a0"></a><!-- doxytag: member="pbx.h::ast_context_remove_ignorepat" ref="041875d3b92a3d0f748b8a0203e042a0" args="(const char *context, const char *ignorepat, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_remove_ignorepat           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>ignorepat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04454">4454</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l04466">ast_context_remove_ignorepat2()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01153">handle_context_remove_ignorepat()</a>.<div class="fragment"><pre class="fragment"><a name="l04455"></a>04455 {
<a name="l04456"></a>04456    <span class="keywordtype">int</span> ret = -1;
<a name="l04457"></a>04457    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = <a class="code" href="pbx_8c.html#4669bd753e060c6bb15a0c63c4e3785a">find_context_locked</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l04458"></a>04458 
<a name="l04459"></a>04459    <span class="keywordflow">if</span> (c) {
<a name="l04460"></a>04460       ret = <a class="code" href="pbx_8c.html#ad389cee2e8dda09b52d35340ddd294b">ast_context_remove_ignorepat2</a>(c, ignorepat, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l04461"></a>04461       <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l04462"></a>04462    }
<a name="l04463"></a>04463    <span class="keywordflow">return</span> ret;
<a name="l04464"></a>04464 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ad389cee2e8dda09b52d35340ddd294b"></a><!-- doxytag: member="pbx.h::ast_context_remove_ignorepat2" ref="ad389cee2e8dda09b52d35340ddd294b" args="(struct ast_context *con, const char *ignorepat, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_remove_ignorepat2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>ignorepat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04466">4466</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06092">ast_unlock_context()</a>, <a class="el" href="pbx_8c-source.html#l06082">ast_wrlock_context()</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="pbx_8c-source.html#l00170">ast_context::ignorepats</a>, <a class="el" href="pbx_8c-source.html#l00160">ast_ignorepat::next</a>, <a class="el" href="pbx_8c-source.html#l00161">ast_ignorepat::pattern</a>, and <a class="el" href="pbx_8c-source.html#l00159">ast_ignorepat::registrar</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04454">ast_context_remove_ignorepat()</a>.<div class="fragment"><pre class="fragment"><a name="l04467"></a>04467 {
<a name="l04468"></a>04468    <span class="keyword">struct </span><a class="code" href="structast__ignorepat.html">ast_ignorepat</a> *ip, *ipl = NULL;
<a name="l04469"></a>04469 
<a name="l04470"></a>04470    <a class="code" href="pbx_8c.html#18884df37a7c36a24fd0b5f4225d1112">ast_wrlock_context</a>(con);
<a name="l04471"></a>04471 
<a name="l04472"></a>04472    <span class="keywordflow">for</span> (ip = con-&gt;<a class="code" href="structast__context.html#79a69e07731e7d02c0f52f19bab94dcb">ignorepats</a>; ip; ip = ip-&gt;<a class="code" href="structast__ignorepat.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l04473"></a>04473       <span class="keywordflow">if</span> (!strcmp(ip-&gt;<a class="code" href="structast__ignorepat.html#6ed092b904da0ceba9109608322e7880">pattern</a>, ignorepat) &amp;&amp;
<a name="l04474"></a>04474          (!<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a> || (<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a> == ip-&gt;<a class="code" href="structast__ignorepat.html#5940569cd1d60781f856f93235b072ee">registrar</a>))) {
<a name="l04475"></a>04475          <span class="keywordflow">if</span> (ipl) {
<a name="l04476"></a>04476             ipl-&gt;<a class="code" href="structast__ignorepat.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = ip-&gt;<a class="code" href="structast__ignorepat.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l04477"></a>04477             <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(ip);
<a name="l04478"></a>04478          } <span class="keywordflow">else</span> {
<a name="l04479"></a>04479             con-&gt;<a class="code" href="structast__context.html#79a69e07731e7d02c0f52f19bab94dcb">ignorepats</a> = ip-&gt;<a class="code" href="structast__ignorepat.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l04480"></a>04480             <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(ip);
<a name="l04481"></a>04481          }
<a name="l04482"></a>04482          <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l04483"></a>04483          <span class="keywordflow">return</span> 0;
<a name="l04484"></a>04484       }
<a name="l04485"></a>04485       ipl = ip;
<a name="l04486"></a>04486    }
<a name="l04487"></a>04487 
<a name="l04488"></a>04488    <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l04489"></a>04489    errno = EINVAL;
<a name="l04490"></a>04490    <span class="keywordflow">return</span> -1;
<a name="l04491"></a>04491 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4318ec7b57c8064d746a1a395b5459bb"></a><!-- doxytag: member="pbx.h::ast_context_remove_include" ref="4318ec7b57c8064d746a1a395b5459bb" args="(const char *context, const char *include, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_remove_include           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>include</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Remove a context include. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>See ast_context_add_include for information on arguments</dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02619">2619</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l02640">ast_context_remove_include2()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l00117">handle_context_remove_include()</a>.<div class="fragment"><pre class="fragment"><a name="l02620"></a>02620 {
<a name="l02621"></a>02621    <span class="keywordtype">int</span> ret = -1;
<a name="l02622"></a>02622    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = <a class="code" href="pbx_8c.html#4669bd753e060c6bb15a0c63c4e3785a">find_context_locked</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l02623"></a>02623 
<a name="l02624"></a>02624    <span class="keywordflow">if</span> (c) {
<a name="l02625"></a>02625       <span class="comment">/* found, remove include from this context ... */</span>
<a name="l02626"></a>02626       ret = <a class="code" href="pbx_8c.html#c9afd67fae6ebbdc4e991024f69cff82">ast_context_remove_include2</a>(c, include, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l02627"></a>02627       <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l02628"></a>02628    }
<a name="l02629"></a>02629    <span class="keywordflow">return</span> ret;
<a name="l02630"></a>02630 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c9afd67fae6ebbdc4e991024f69cff82"></a><!-- doxytag: member="pbx.h::ast_context_remove_include2" ref="c9afd67fae6ebbdc4e991024f69cff82" args="(struct ast_context *con, const char *include, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_remove_include2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>include</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Removes an include by an <a class="el" href="structast__context.html">ast_context</a> structure. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>See ast_context_add_include2 for information on arguments</dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on success </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02640">2640</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06092">ast_unlock_context()</a>, <a class="el" href="pbx_8c-source.html#l06082">ast_wrlock_context()</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="pbx_8c-source.html#l00169">ast_context::includes</a>, <a class="el" href="pbx_8c-source.html#l00137">ast_include::name</a>, <a class="el" href="pbx_8c-source.html#l00142">ast_include::next</a>, and <a class="el" href="pbx_8c-source.html#l00139">ast_include::registrar</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02619">ast_context_remove_include()</a>.<div class="fragment"><pre class="fragment"><a name="l02641"></a>02641 {
<a name="l02642"></a>02642    <span class="keyword">struct </span><a class="code" href="structast__include.html">ast_include</a> *i, *pi = NULL;
<a name="l02643"></a>02643    <span class="keywordtype">int</span> ret = -1;
<a name="l02644"></a>02644 
<a name="l02645"></a>02645    <a class="code" href="pbx_8c.html#18884df37a7c36a24fd0b5f4225d1112">ast_wrlock_context</a>(con);
<a name="l02646"></a>02646 
<a name="l02647"></a>02647    <span class="comment">/* find our include */</span>
<a name="l02648"></a>02648    <span class="keywordflow">for</span> (i = con-&gt;<a class="code" href="structast__context.html#bb2b21ef7774df8687ff02b0284505c6">includes</a>; i; pi = i, i = i-&gt;<a class="code" href="structast__include.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l02649"></a>02649       <span class="keywordflow">if</span> (!strcmp(i-&gt;<a class="code" href="structast__include.html#b068931cc450442b63f5b3d276ea4297">name</a>, include) &amp;&amp;
<a name="l02650"></a>02650             (!<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a> || !strcmp(i-&gt;<a class="code" href="structast__include.html#5940569cd1d60781f856f93235b072ee">registrar</a>, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>))) {
<a name="l02651"></a>02651          <span class="comment">/* remove from list */</span>
<a name="l02652"></a>02652          <span class="keywordflow">if</span> (pi)
<a name="l02653"></a>02653             pi-&gt;next = i-&gt;<a class="code" href="structast__include.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l02654"></a>02654          <span class="keywordflow">else</span>
<a name="l02655"></a>02655             con-&gt;<a class="code" href="structast__context.html#bb2b21ef7774df8687ff02b0284505c6">includes</a> = i-&gt;<a class="code" href="structast__include.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l02656"></a>02656          <span class="comment">/* free include and return */</span>
<a name="l02657"></a>02657          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(i);
<a name="l02658"></a>02658          ret = 0;
<a name="l02659"></a>02659          <span class="keywordflow">break</span>;
<a name="l02660"></a>02660       }
<a name="l02661"></a>02661    }
<a name="l02662"></a>02662 
<a name="l02663"></a>02663    <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l02664"></a>02664 
<a name="l02665"></a>02665    <span class="keywordflow">return</span> ret;
<a name="l02666"></a>02666 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2db384d8d5d6a3155584ba62248a466a"></a><!-- doxytag: member="pbx.h::ast_context_remove_switch" ref="2db384d8d5d6a3155584ba62248a466a" args="(const char *context, const char *sw, const char *data, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_remove_switch           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>sw</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Remove a switch. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>This function locks contexts list by &amp;conlist, search for the rigt context structure, leave context list locked and call ast_context_remove_switch2 which removes switch, unlock contexts list and return ... </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02673">2673</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l02694">ast_context_remove_switch2()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>.<div class="fragment"><pre class="fragment"><a name="l02674"></a>02674 {
<a name="l02675"></a>02675    <span class="keywordtype">int</span> ret = -1; <span class="comment">/* default error return */</span>
<a name="l02676"></a>02676    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = <a class="code" href="pbx_8c.html#4669bd753e060c6bb15a0c63c4e3785a">find_context_locked</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l02677"></a>02677 
<a name="l02678"></a>02678    <span class="keywordflow">if</span> (c) {
<a name="l02679"></a>02679       <span class="comment">/* remove switch from this context ... */</span>
<a name="l02680"></a>02680       ret = <a class="code" href="pbx_8c.html#70c9b3efb9b5ad9ac26580cc90536fff">ast_context_remove_switch2</a>(c, sw, data, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l02681"></a>02681       <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l02682"></a>02682    }
<a name="l02683"></a>02683    <span class="keywordflow">return</span> ret;
<a name="l02684"></a>02684 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="70c9b3efb9b5ad9ac26580cc90536fff"></a><!-- doxytag: member="pbx.h::ast_context_remove_switch2" ref="70c9b3efb9b5ad9ac26580cc90536fff" args="(struct ast_context *con, const char *sw, const char *data, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_remove_switch2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>sw</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function locks given context, removes switch, unlock context and return. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>When we call this function, &amp;conlock lock must be locked, because when we giving *con argument, some process can remove/change this context and after that there can be segfault. </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02694">2694</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00516">AST_LIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h-source.html#l00491">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h-source.html#l00554">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="pbx_8c-source.html#l06092">ast_unlock_context()</a>, <a class="el" href="pbx_8c-source.html#l06082">ast_wrlock_context()</a>, <a class="el" href="pbx_8c-source.html#l00150">ast_sw::data</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="pbx_8c-source.html#l00148">ast_sw::name</a>, and <a class="el" href="pbx_8c-source.html#l00149">ast_sw::registrar</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02673">ast_context_remove_switch()</a>.<div class="fragment"><pre class="fragment"><a name="l02695"></a>02695 {
<a name="l02696"></a>02696    <span class="keyword">struct </span><a class="code" href="structast__sw.html">ast_sw</a> *i;
<a name="l02697"></a>02697    <span class="keywordtype">int</span> ret = -1;
<a name="l02698"></a>02698 
<a name="l02699"></a>02699    <a class="code" href="pbx_8c.html#18884df37a7c36a24fd0b5f4225d1112">ast_wrlock_context</a>(con);
<a name="l02700"></a>02700 
<a name="l02701"></a>02701    <span class="comment">/* walk switches */</span>
<a name="l02702"></a>02702    <a class="code" href="linkedlists_8h.html#915e438a9528c8d6316c617b5bd84487">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;con-&gt;alts, i, list) {
<a name="l02703"></a>02703       <span class="keywordflow">if</span> (!strcmp(i-&gt;<a class="code" href="structast__sw.html#b068931cc450442b63f5b3d276ea4297">name</a>, sw) &amp;&amp; !strcmp(i-&gt;<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>, <a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a>) &amp;&amp;
<a name="l02704"></a>02704          (!<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a> || !strcmp(i-&gt;<a class="code" href="structast__sw.html#5940569cd1d60781f856f93235b072ee">registrar</a>, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>))) {
<a name="l02705"></a>02705          <span class="comment">/* found, remove from list */</span>
<a name="l02706"></a>02706          <a class="code" href="linkedlists_8h.html#37f99379dafa45c921f95bf7235eb91d">AST_LIST_REMOVE_CURRENT</a>(&amp;con-&gt;alts, list);
<a name="l02707"></a>02707          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(i); <span class="comment">/* free switch and return */</span>
<a name="l02708"></a>02708          ret = 0;
<a name="l02709"></a>02709          <span class="keywordflow">break</span>;
<a name="l02710"></a>02710       }
<a name="l02711"></a>02711    }
<a name="l02712"></a>02712    <a class="code" href="linkedlists_8h.html#a93fdadc00a2a090968004b7d9c79630">AST_LIST_TRAVERSE_SAFE_END</a>
<a name="l02713"></a>02713 
<a name="l02714"></a>02714    <a class="code" href="pbx_8c.html#adad2f961a9f0ccdd8a48dee073793cc">ast_unlock_context</a>(con);
<a name="l02715"></a>02715 
<a name="l02716"></a>02716    <span class="keywordflow">return</span> ret;
<a name="l02717"></a>02717 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="31dbf16f2aa0ba7d3e7173e851a13437"></a><!-- doxytag: member="pbx.h::ast_context_unlockmacro" ref="31dbf16f2aa0ba7d3e7173e851a13437" args="(const char *macrocontext)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_unlockmacro           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>context</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unlocks the macrolock in the given context. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>This function locks contexts list by &amp;conlist, searches for the right context structure, and unlocks the macrolock mutex in that context. macrolock is used to limit a macro to be executed by one call at a time. </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02851">2851</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06100">ast_get_context_name()</a>, <a class="el" href="lock_8h-source.html#l00520">ast_mutex_unlock()</a>, <a class="el" href="pbx_8c-source.html#l06069">ast_rdlock_contexts()</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, and <a class="el" href="pbx_8c-source.html#l06196">ast_walk_contexts()</a>.<div class="fragment"><pre class="fragment"><a name="l02852"></a>02852 {
<a name="l02853"></a>02853    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *c = NULL;
<a name="l02854"></a>02854    <span class="keywordtype">int</span> ret = -1;
<a name="l02855"></a>02855 
<a name="l02856"></a>02856    <a class="code" href="pbx_8c.html#1b60f4b570102084989c86fd02ca6536">ast_rdlock_contexts</a>();
<a name="l02857"></a>02857 
<a name="l02858"></a>02858    <span class="keywordflow">while</span> ((c = <a class="code" href="pbx_8c.html#709c9b64f2da1eaace237db32a5e1445">ast_walk_contexts</a>(c))) {
<a name="l02859"></a>02859       <span class="keywordflow">if</span> (!strcmp(<a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(c), <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>)) {
<a name="l02860"></a>02860          ret = 0;
<a name="l02861"></a>02861          <span class="keywordflow">break</span>;
<a name="l02862"></a>02862       }
<a name="l02863"></a>02863    }
<a name="l02864"></a>02864 
<a name="l02865"></a>02865    <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l02866"></a>02866 
<a name="l02867"></a>02867    <span class="comment">/* if we found context, unlock macrolock */</span>
<a name="l02868"></a>02868    <span class="keywordflow">if</span> (ret == 0) 
<a name="l02869"></a>02869       ret = <a class="code" href="lock_8h.html#1d33e3caf152f0901c5ebdb69c2d4d26">ast_mutex_unlock</a>(&amp;c-&gt;macrolock);
<a name="l02870"></a>02870 
<a name="l02871"></a>02871    <span class="keywordflow">return</span> ret;
<a name="l02872"></a>02872 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d08532bf153875f677d2d3c59b13397f"></a><!-- doxytag: member="pbx.h::ast_context_verify_includes" ref="d08532bf153875f677d2d3c59b13397f" args="(struct ast_context *con)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_context_verify_includes           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>con</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Verifies includes in an ast_contect structure. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>con</em>&nbsp;</td><td>context in which to verify the includes</td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if no problems found </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>if there were any missing context </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06243">6243</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00889">ast_context_find()</a>, <a class="el" href="pbx_8c-source.html#l06100">ast_get_context_name()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="pbx_8c-source.html#l06225">ast_walk_context_includes()</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, and <a class="el" href="pbx_8c-source.html#l00138">ast_include::rname</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01596">pbx_load_module()</a>.<div class="fragment"><pre class="fragment"><a name="l06244"></a>06244 {
<a name="l06245"></a>06245    <span class="keyword">struct </span><a class="code" href="structast__include.html">ast_include</a> *inc = NULL;
<a name="l06246"></a>06246    <span class="keywordtype">int</span> res = 0;
<a name="l06247"></a>06247 
<a name="l06248"></a>06248    <span class="keywordflow">while</span> ( (inc = <a class="code" href="pbx_8c.html#ff52371424397442d32568beb910e153">ast_walk_context_includes</a>(con, inc)) )
<a name="l06249"></a>06249       <span class="keywordflow">if</span> (!<a class="code" href="pbx_8c.html#f8c5b4e7d06b7aff72707b5d7d7c94e1">ast_context_find</a>(inc-&gt;<a class="code" href="structast__include.html#c626d8954194dd0136691c301dcf7ece">rname</a>)) {
<a name="l06250"></a>06250          res = -1;
<a name="l06251"></a>06251          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Context '%s' tries includes nonexistent context '%s'\n"</span>,
<a name="l06252"></a>06252                <a class="code" href="pbx_8c.html#4571490d866dec074492c52ea27a304b">ast_get_context_name</a>(con), inc-&gt;<a class="code" href="structast__include.html#c626d8954194dd0136691c301dcf7ece">rname</a>);
<a name="l06253"></a>06253       }
<a name="l06254"></a>06254    <span class="keywordflow">return</span> res;
<a name="l06255"></a>06255 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2f6033daa3dd2a6a51ee380a86a783ba"></a><!-- doxytag: member="pbx.h::ast_custom_function_find" ref="2f6033daa3dd2a6a51ee380a86a783ba" args="(const char *name)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__custom__function.html">ast_custom_function</a>* ast_custom_function_find           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>name</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01345">1345</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00060">AST_RWLIST_RDLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, and <a class="el" href="pbx_8h-source.html#l00073">ast_custom_function::name</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l01437">ast_func_read()</a>, <a class="el" href="pbx_8c-source.html#l01452">ast_func_write()</a>, and <a class="el" href="pbx_8c-source.html#l01269">handle_show_function()</a>.<div class="fragment"><pre class="fragment"><a name="l01346"></a>01346 {
<a name="l01347"></a>01347    <span class="keyword">struct </span><a class="code" href="structast__custom__function.html">ast_custom_function</a> *acf = NULL;
<a name="l01348"></a>01348 
<a name="l01349"></a>01349    <a class="code" href="linkedlists_8h.html#23c0c844e5abcb474854867b408e3be8">AST_RWLIST_RDLOCK</a>(&amp;acf_root);
<a name="l01350"></a>01350    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;acf_root, acf, acflist) {
<a name="l01351"></a>01351       <span class="keywordflow">if</span> (!strcmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, acf-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>))
<a name="l01352"></a>01352          <span class="keywordflow">break</span>;
<a name="l01353"></a>01353    }
<a name="l01354"></a>01354    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;acf_root);
<a name="l01355"></a>01355 
<a name="l01356"></a>01356    <span class="keywordflow">return</span> acf;
<a name="l01357"></a>01357 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="93b5bf1865d6f3290372ca5ee3274391"></a><!-- doxytag: member="pbx.h::ast_custom_function_register" ref="93b5bf1865d6f3290372ca5ee3274391" args="(struct ast_custom_function *acf)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_custom_function_register           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__custom__function.html">ast_custom_function</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>acf</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Reigster a custom function. 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01381">1381</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="linkedlists_8h-source.html#l00549">AST_RWLIST_INSERT_BEFORE_CURRENT</a>, <a class="el" href="linkedlists_8h-source.html#l00680">AST_RWLIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00503">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h-source.html#l00556">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, <a class="el" href="pbx_8h-source.html#l00073">ast_custom_function::name</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, and <a class="el" href="logger_8h-source.html#l00044">VERBOSE_PREFIX_2</a>.
<p>
Referenced by <a class="el" href="app__minivm_8c-source.html#l03157">load_module()</a>, and <a class="el" href="func__odbc_8c-source.html#l00630">reload()</a>.<div class="fragment"><pre class="fragment"><a name="l01382"></a>01382 {
<a name="l01383"></a>01383    <span class="keyword">struct </span><a class="code" href="structast__custom__function.html">ast_custom_function</a> *cur;
<a name="l01384"></a>01384 
<a name="l01385"></a>01385    <span class="keywordflow">if</span> (!acf)
<a name="l01386"></a>01386       <span class="keywordflow">return</span> -1;
<a name="l01387"></a>01387 
<a name="l01388"></a>01388    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;acf_root);
<a name="l01389"></a>01389 
<a name="l01390"></a>01390    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;acf_root, cur, acflist) {
<a name="l01391"></a>01391       <span class="keywordflow">if</span> (!strcmp(acf-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>, cur-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>)) {
<a name="l01392"></a>01392          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Function %s already registered.\n"</span>, acf-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l01393"></a>01393          <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;acf_root);
<a name="l01394"></a>01394          <span class="keywordflow">return</span> -1;
<a name="l01395"></a>01395       }
<a name="l01396"></a>01396    }
<a name="l01397"></a>01397 
<a name="l01398"></a>01398    <span class="comment">/* Store in alphabetical order */</span>
<a name="l01399"></a>01399    <a class="code" href="linkedlists_8h.html#b564f1f262db6464e1644462c38d61e3">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;acf_root, cur, acflist) {
<a name="l01400"></a>01400       <span class="keywordflow">if</span> (strcasecmp(acf-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>, cur-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>) &lt; 0) {
<a name="l01401"></a>01401          <a class="code" href="linkedlists_8h.html#cf4d2eed92b828f7212b90b1dcde0b29">AST_RWLIST_INSERT_BEFORE_CURRENT</a>(&amp;acf_root, acf, acflist);
<a name="l01402"></a>01402          <span class="keywordflow">break</span>;
<a name="l01403"></a>01403       }
<a name="l01404"></a>01404    }
<a name="l01405"></a>01405    <a class="code" href="linkedlists_8h.html#e5be717f6b8c1586fa30a060b56403fe">AST_RWLIST_TRAVERSE_SAFE_END</a>
<a name="l01406"></a>01406    <span class="keywordflow">if</span> (!cur)
<a name="l01407"></a>01407       <a class="code" href="linkedlists_8h.html#64b41a3e9f2e6a867c09431dfae7ce21">AST_RWLIST_INSERT_TAIL</a>(&amp;acf_root, acf, acflist);
<a name="l01408"></a>01408 
<a name="l01409"></a>01409    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;acf_root);
<a name="l01410"></a>01410 
<a name="l01411"></a>01411    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 1)
<a name="l01412"></a>01412       <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Registered custom function %s\n"</span>, acf-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l01413"></a>01413 
<a name="l01414"></a>01414    <span class="keywordflow">return</span> 0;
<a name="l01415"></a>01415 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="cfc1bbe0fad0bcf852611eaee79b2d03"></a><!-- doxytag: member="pbx.h::ast_custom_function_unregister" ref="cfc1bbe0fad0bcf852611eaee79b2d03" args="(struct ast_custom_function *acf)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_custom_function_unregister           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__custom__function.html">ast_custom_function</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>acf</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unregister a custom function. 
<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01359">1359</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00526">AST_RWLIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h-source.html#l00503">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h-source.html#l00556">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="pbx_8h-source.html#l00073">ast_custom_function::name</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, and <a class="el" href="logger_8h-source.html#l00044">VERBOSE_PREFIX_2</a>.
<p>
Referenced by <a class="el" href="func__odbc_8c-source.html#l00630">reload()</a>, and <a class="el" href="app__minivm_8c-source.html#l03204">unload_module()</a>.<div class="fragment"><pre class="fragment"><a name="l01360"></a>01360 {
<a name="l01361"></a>01361    <span class="keyword">struct </span><a class="code" href="structast__custom__function.html">ast_custom_function</a> *cur;
<a name="l01362"></a>01362 
<a name="l01363"></a>01363    <span class="keywordflow">if</span> (!acf)
<a name="l01364"></a>01364       <span class="keywordflow">return</span> -1;
<a name="l01365"></a>01365 
<a name="l01366"></a>01366    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;acf_root);
<a name="l01367"></a>01367    <a class="code" href="linkedlists_8h.html#b564f1f262db6464e1644462c38d61e3">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;acf_root, cur, acflist) {
<a name="l01368"></a>01368       <span class="keywordflow">if</span> (cur == acf) {
<a name="l01369"></a>01369          <a class="code" href="linkedlists_8h.html#93783e4cad722e705630e975d2e8d7f9">AST_RWLIST_REMOVE_CURRENT</a>(&amp;acf_root, acflist);
<a name="l01370"></a>01370          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 1)
<a name="l01371"></a>01371             <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Unregistered custom function %s\n"</span>, acf-&gt;<a class="code" href="structast__custom__function.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l01372"></a>01372          <span class="keywordflow">break</span>;
<a name="l01373"></a>01373       }
<a name="l01374"></a>01374    }
<a name="l01375"></a>01375    <a class="code" href="linkedlists_8h.html#e5be717f6b8c1586fa30a060b56403fe">AST_RWLIST_TRAVERSE_SAFE_END</a>
<a name="l01376"></a>01376    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;acf_root);
<a name="l01377"></a>01377 
<a name="l01378"></a>01378    <span class="keywordflow">return</span> acf ? 0 : -1;
<a name="l01379"></a>01379 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="90b58be34145fcfd99652f0c3ae7377d"></a><!-- doxytag: member="pbx.h::ast_exists_extension" ref="90b58be34145fcfd99652f0c3ae7377d" args="(struct ast_channel *c, const char *context, const char *exten, int priority, const char *callerid)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_exists_extension           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>callerid</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Determine whether an extension exists. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>this is not important </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>which context to look in </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>exten</em>&nbsp;</td><td>which extension to search for </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>priority</em>&nbsp;</td><td>priority of the action within the extension </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callerid</em>&nbsp;</td><td>callerid to search for</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>If an extension within the given context(or callerid) with the given priority is found a non zero value will be returned. Otherwise, 0 is returned. </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02183">2183</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe437691af9bdd09d1ad4c2e5b087d5717">E_MATCH</a>, and <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l06258">__ast_goto_if_exists()</a>, <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>, <a class="el" href="chan__agent_8c-source.html#l01763">__login_exec()</a>, <a class="el" href="app__macro_8c-source.html#l00144">_macro_exec()</a>, <a class="el" href="chan__agent_8c-source.html#l02207">agentmonitoroutgoing_exec()</a>, <a class="el" href="chan__h323_8c-source.html#l02238">answer_call()</a>, <a class="el" href="app_8c-source.html#l00065">ast_app_dtget()</a>, <a class="el" href="res__features_8c-source.html#l00342">ast_park_call()</a>, <a class="el" href="pbx_8c-source.html#l04991">ast_pbx_outgoing_exten()</a>, <a class="el" href="res__features_8c-source.html#l00776">builtin_atxfer()</a>, <a class="el" href="res__features_8c-source.html#l00673">builtin_blindtransfer()</a>, <a class="el" href="chan__alsa_8c-source.html#l01004">console_dial()</a>, <a class="el" href="chan__oss_8c-source.html#l01339">console_transfer()</a>, <a class="el" href="chan__iax2_8c-source.html#l06220">dp_lookup()</a>, <a class="el" href="pbx__dundi_8c-source.html#l00532">dundi_lookup_local()</a>, <a class="el" href="chan__sip_8c-source.html#l09533">get_also_info()</a>, <a class="el" href="chan__sip_8c-source.html#l09207">get_destination()</a>, <a class="el" href="chan__sip_8c-source.html#l09372">get_refer_info()</a>, <a class="el" href="app__rpt_8c-source.html#l03406">handle_link_data()</a>, <a class="el" href="app__rpt_8c-source.html#l03557">handle_link_phone_dtmf()</a>, <a class="el" href="chan__skinny_8c-source.html#l03102">handle_stimulus_message()</a>, <a class="el" href="app__voicemail_8c-source.html#l02956">leave_voicemail()</a>, <a class="el" href="chan__local_8c-source.html#l00550">local_alloc()</a>, <a class="el" href="chan__local_8c-source.html#l00127">local_devicestate()</a>, <a class="el" href="pbx__loopback_8c-source.html#l00124">loopback_exists()</a>, <a class="el" href="res__features_8c-source.html#l00318">metermaidstate()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02638">mgcp_ss()</a>, <a class="el" href="app__minivm_8c-source.html#l01818">minivm_greet_exec()</a>, <a class="el" href="chan__misdn_8c-source.html#l00650">misdn_overlap_dial_task()</a>, <a class="el" href="pbx_8c-source.html#l05584">pbx_builtin_waitexten()</a>, <a class="el" href="chan__phone_8c-source.html#l00939">phone_check_exception()</a>, <a class="el" href="chan__misdn_8c-source.html#l02539">process_ast_dsp()</a>, <a class="el" href="chan__iax2_8c-source.html#l05647">register_peer_exten()</a>, <a class="el" href="chan__skinny_8c-source.html#l02365">skinny_ss()</a>, <a class="el" href="chan__iax2_8c-source.html#l06624">socket_process()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, <a class="el" href="file_8c-source.html#l00983">waitstream_core()</a>, and <a class="el" href="chan__zap_8c-source.html#l03875">zt_handle_dtmfup()</a>.<div class="fragment"><pre class="fragment"><a name="l02184"></a>02184 {
<a name="l02185"></a>02185    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#2377c7b979811bdd54ebf819e5d2037b">pbx_extension_helper</a>(c, NULL, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, priority, NULL, callerid, <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe437691af9bdd09d1ad4c2e5b087d5717">E_MATCH</a>);
<a name="l02186"></a>02186 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1e0079c7f2934dd7ebe801fefe4057da"></a><!-- doxytag: member="pbx.h::ast_explicit_goto" ref="1e0079c7f2934dd7ebe801fefe4057da" args="(struct ast_channel *chan, const char *context, const char *exten, int priority)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_explicit_goto           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04576">4576</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73002122d39475941a27a292dfd49534d079">AST_FLAG_IN_AUTOLOOP</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="utils_8h-source.html#l00067">ast_test_flag</a>, <a class="el" href="channel_8h-source.html#l00441">ast_channel::context</a>, <a class="el" href="channel_8h-source.html#l00442">ast_channel::exten</a>, and <a class="el" href="channel_8h-source.html#l00443">ast_channel::priority</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l06258">__ast_goto_if_exists()</a>, <a class="el" href="pbx_8c-source.html#l04595">ast_async_goto()</a>, <a class="el" href="pbx_8c-source.html#l06287">ast_parseable_goto()</a>, <a class="el" href="res__features_8c-source.html#l00776">builtin_atxfer()</a>, <a class="el" href="res__features_8c-source.html#l02147">do_bridge_masquerade()</a>, <a class="el" href="res__agi_8c-source.html#l00873">handle_setpriority()</a>, and <a class="el" href="app__stack_8c-source.html#l00163">return_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l04577"></a>04577 {
<a name="l04578"></a>04578    <span class="keywordflow">if</span> (!chan)
<a name="l04579"></a>04579       <span class="keywordflow">return</span> -1;
<a name="l04580"></a>04580 
<a name="l04581"></a>04581    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>))
<a name="l04582"></a>04582       ast_copy_string(chan-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <span class="keyword">sizeof</span>(chan-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>));
<a name="l04583"></a>04583    <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>))
<a name="l04584"></a>04584       ast_copy_string(chan-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <span class="keyword">sizeof</span>(chan-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>));
<a name="l04585"></a>04585    <span class="keywordflow">if</span> (priority &gt; -1) {
<a name="l04586"></a>04586       chan-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a> = priority;
<a name="l04587"></a>04587       <span class="comment">/* see flag description in channel.h for explanation */</span>
<a name="l04588"></a>04588       <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#d26671e9d352536be0df3d41a800bb83">ast_test_flag</a>(chan, <a class="code" href="channel_8h.html#68986ab776eb5d6b5a809a1c005a73002122d39475941a27a292dfd49534d079">AST_FLAG_IN_AUTOLOOP</a>))
<a name="l04589"></a>04589          chan-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>--;
<a name="l04590"></a>04590    }
<a name="l04591"></a>04591 
<a name="l04592"></a>04592    <span class="keywordflow">return</span> 0;
<a name="l04593"></a>04593 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a82c6deae96c20bc56e29d921d6e036f"></a><!-- doxytag: member="pbx.h::ast_extension_close" ref="a82c6deae96c20bc56e29d921d6e036f" args="(const char *pattern, const char *data, int needmore)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_extension_close           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>pattern</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>needmore</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00882">882</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fee9684886238bd81a61f3358030326178">E_CANMATCH</a>, <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824febb13020eaa30c314c1bff110026a7cd2">E_MATCHMORE</a>, <a class="el" href="pbx_8c-source.html#l00865">extension_match_core()</a>, and <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>.<div class="fragment"><pre class="fragment"><a name="l00883"></a>00883 {
<a name="l00884"></a>00884    <span class="keywordflow">if</span> (needmore != <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824febb13020eaa30c314c1bff110026a7cd2">E_MATCHMORE</a> &amp;&amp; needmore != <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fee9684886238bd81a61f3358030326178">E_CANMATCH</a>)
<a name="l00885"></a>00885       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"invalid argument %d\n"</span>, needmore);
<a name="l00886"></a>00886    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#489ae231aa1cc1031dcfd0adc1cc4600">extension_match_core</a>(pattern, data, needmore);
<a name="l00887"></a>00887 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="07a807af656bad67ca8118e88987b263"></a><!-- doxytag: member="pbx.h::ast_extension_match" ref="07a807af656bad67ca8118e88987b263" args="(const char *pattern, const char *extension)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_extension_match           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>pattern</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>extension</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Determine if a given extension matches a given pattern (in NXX format). 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pattern</em>&nbsp;</td><td>pattern to match </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>extension</em>&nbsp;</td><td>extension to check against the pattern.</td></tr>
  </table>
</dl>
Checks whether or not the given extension matches the given pattern.<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>1</em>&nbsp;</td><td>on match </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00877">877</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe437691af9bdd09d1ad4c2e5b087d5717">E_MATCH</a>, and <a class="el" href="pbx_8c-source.html#l00865">extension_match_core()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04542">ast_ignore_pattern()</a>, <a class="el" href="app__playback_8c-source.html#l00147">do_say()</a>, <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>, <a class="el" href="pbx__loopback_8c-source.html#l00133">loopback_canmatch()</a>, <a class="el" href="pbx__loopback_8c-source.html#l00142">loopback_exec()</a>, <a class="el" href="pbx__loopback_8c-source.html#l00124">loopback_exists()</a>, <a class="el" href="pbx__loopback_8c-source.html#l00152">loopback_matchmore()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, <a class="el" href="pbx_8c-source.html#l00907">matchcid()</a>, <a class="el" href="misdn__config_8c-source.html#l00631">misdn_cfg_is_msn_valid()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l00878"></a>00878 {
<a name="l00879"></a>00879    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#489ae231aa1cc1031dcfd0adc1cc4600">extension_match_core</a>(pattern, data, <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe437691af9bdd09d1ad4c2e5b087d5717">E_MATCH</a>);
<a name="l00880"></a>00880 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3c3c36826d708839388bcc4c935de3a6"></a><!-- doxytag: member="pbx.h::ast_extension_patmatch" ref="3c3c36826d708839388bcc4c935de3a6" args="(const char *pattern, const char *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_extension_patmatch           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>pattern</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="16769dc669e528ae10a063594fb7f4ae"></a><!-- doxytag: member="pbx.h::ast_extension_state" ref="16769dc669e528ae10a063594fb7f4ae" args="(struct ast_channel *c, const char *context, const char *exten)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_extension_state           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Uses hint and devicestate callback to get the state of an extension. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>this is not important </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>which context to look in </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>exten</em>&nbsp;</td><td>which extension to get state</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>extension state as defined in the ast_extension_states enum </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01909">1909</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l01812">ast_extension_state2()</a>, and <a class="el" href="pbx_8c-source.html#l01799">ast_hint_extension()</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l02085">action_extensionstate()</a>, and <a class="el" href="chan__sip_8c-source.html#l15240">handle_request_subscribe()</a>.<div class="fragment"><pre class="fragment"><a name="l01910"></a>01910 {
<a name="l01911"></a>01911    <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *e;
<a name="l01912"></a>01912 
<a name="l01913"></a>01913    e = <a class="code" href="pbx_8c.html#a4691f6ae9689498c10c695381f36103">ast_hint_extension</a>(c, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>);   <span class="comment">/* Do we have a hint for this extension ? */</span>
<a name="l01914"></a>01914    <span class="keywordflow">if</span> (!e)
<a name="l01915"></a>01915       <span class="keywordflow">return</span> -1;           <span class="comment">/* No hint, return -1 */</span>
<a name="l01916"></a>01916 
<a name="l01917"></a>01917    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#6aecfed8ee63e22940bc2d842f0a536c">ast_extension_state2</a>(e);        <span class="comment">/* Check all devices in the hint */</span>
<a name="l01918"></a>01918 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c4e2c1f2a0862db3fb3faa3d5dd9350c"></a><!-- doxytag: member="pbx.h::ast_extension_state2str" ref="c4e2c1f2a0862db3fb3faa3d5dd9350c" args="(int extension_state)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_extension_state2str           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>extension_state</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return string representation of the state of an extension. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>extension_state</em>&nbsp;</td><td>is the numerical state delivered by ast_extension_state</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the state of an extension as string </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01897">1897</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c.html#63938e196e95ba3f1d098ec3884aca3a">extension_states</a>.
<p>
Referenced by <a class="el" href="chan__sip_8c-source.html#l11299">__sip_show_channels()</a>, <a class="el" href="chan__sip_8c-source.html#l15240">handle_request_subscribe()</a>, and <a class="el" href="pbx_8c-source.html#l03142">handle_show_hints()</a>.<div class="fragment"><pre class="fragment"><a name="l01898"></a>01898 {
<a name="l01899"></a>01899    <span class="keywordtype">int</span> i;
<a name="l01900"></a>01900 
<a name="l01901"></a>01901    <span class="keywordflow">for</span> (i = 0; (i &lt; (<span class="keyword">sizeof</span>(<a class="code" href="pbx_8c.html#63938e196e95ba3f1d098ec3884aca3a">extension_states</a>) / <span class="keyword">sizeof</span>(extension_states[0]))); i++) {
<a name="l01902"></a>01902       <span class="keywordflow">if</span> (extension_states[i].extension_state == extension_state)
<a name="l01903"></a>01903          <span class="keywordflow">return</span> extension_states[i].text;
<a name="l01904"></a>01904    }
<a name="l01905"></a>01905    <span class="keywordflow">return</span> <span class="stringliteral">"Unknown"</span>;
<a name="l01906"></a>01906 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="14f63100164300fc4b55b09d6c3474fd"></a><!-- doxytag: member="pbx.h::ast_extension_state_add" ref="14f63100164300fc4b55b09d6c3474fd" args="(const char *context, const char *exten, ast_state_cb_type callback, void *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_extension_state_add           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="pbx_8h.html#a083658b5411c328227915675531df43">ast_state_cb_type</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>callback</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Registers a state change callback. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>which context to look in </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>exten</em>&nbsp;</td><td>which extension to get state </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callback</em>&nbsp;</td><td>callback to call if state changed </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>to pass to callback</td></tr>
  </table>
</dl>
The callback is called if the state of an extension is changed.<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ID</em>&nbsp;</td><td>on success </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01964">1964</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="pbx_8c-source.html#l01799">ast_hint_extension()</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="pbx_8c-source.html#l00192">ast_state_cb::callback</a>, <a class="el" href="pbx_8c-source.html#l00205">ast_hint::callbacks</a>, <a class="el" href="pbx_8c-source.html#l00191">ast_state_cb::data</a>, <a class="el" href="pbx_8c-source.html#l00203">ast_hint::exten</a>, <a class="el" href="pbx_8c-source.html#l00193">ast_state_cb::next</a>, <a class="el" href="pbx_8c-source.html#l00504">statecbs</a>, and <a class="el" href="pbx_8c-source.html#l00496">stateid</a>.
<p>
Referenced by <a class="el" href="chan__sip_8c-source.html#l15240">handle_request_subscribe()</a>, <a class="el" href="manager_8c-source.html#l03215">init_manager()</a>, and <a class="el" href="chan__skinny_8c-source.html#l01355">skinny_register()</a>.<div class="fragment"><pre class="fragment"><a name="l01966"></a>01966 {
<a name="l01967"></a>01967    <span class="keyword">struct </span><a class="code" href="structast__hint.html">ast_hint</a> *hint;
<a name="l01968"></a>01968    <span class="keyword">struct </span><a class="code" href="structast__state__cb.html">ast_state_cb</a> *cblist;
<a name="l01969"></a>01969    <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *e;
<a name="l01970"></a>01970 
<a name="l01971"></a>01971    <span class="comment">/* If there's no context and extension:  add callback to statecbs list */</span>
<a name="l01972"></a>01972    <span class="keywordflow">if</span> (!<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a> &amp;&amp; !<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>) {
<a name="l01973"></a>01973       <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;hints);
<a name="l01974"></a>01974 
<a name="l01975"></a>01975       <span class="keywordflow">for</span> (cblist = <a class="code" href="pbx_8c.html#3b088b468374b928f6ab90bfe5db48bf">statecbs</a>; cblist; cblist = cblist-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l01976"></a>01976          <span class="keywordflow">if</span> (cblist-&gt;<a class="code" href="structast__state__cb.html#924a8ceeac17f54d3be3f8cdf1c04eb2">callback</a> == callback) {
<a name="l01977"></a>01977             cblist-&gt;<a class="code" href="structast__state__cb.html#8d777f385d3dfec8815d20f7496026dc">data</a> = <a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a>;
<a name="l01978"></a>01978             <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l01979"></a>01979             <span class="keywordflow">return</span> 0;
<a name="l01980"></a>01980          }
<a name="l01981"></a>01981       }
<a name="l01982"></a>01982 
<a name="l01983"></a>01983       <span class="comment">/* Now insert the callback */</span>
<a name="l01984"></a>01984       <span class="keywordflow">if</span> (!(cblist = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*cblist)))) {
<a name="l01985"></a>01985          <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l01986"></a>01986          <span class="keywordflow">return</span> -1;
<a name="l01987"></a>01987       }
<a name="l01988"></a>01988       cblist-&gt;id = 0;
<a name="l01989"></a>01989       cblist-&gt;callback = callback;
<a name="l01990"></a>01990       cblist-&gt;data = <a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a>;
<a name="l01991"></a>01991 
<a name="l01992"></a>01992       cblist-&gt;next = <a class="code" href="pbx_8c.html#3b088b468374b928f6ab90bfe5db48bf">statecbs</a>;
<a name="l01993"></a>01993       <a class="code" href="pbx_8c.html#3b088b468374b928f6ab90bfe5db48bf">statecbs</a> = cblist;
<a name="l01994"></a>01994 
<a name="l01995"></a>01995       <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l01996"></a>01996       <span class="keywordflow">return</span> 0;
<a name="l01997"></a>01997    }
<a name="l01998"></a>01998 
<a name="l01999"></a>01999    <span class="keywordflow">if</span> (!<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a> || !<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>)
<a name="l02000"></a>02000       <span class="keywordflow">return</span> -1;
<a name="l02001"></a>02001 
<a name="l02002"></a>02002    <span class="comment">/* This callback type is for only one hint, so get the hint */</span>
<a name="l02003"></a>02003    e = <a class="code" href="pbx_8c.html#a4691f6ae9689498c10c695381f36103">ast_hint_extension</a>(NULL, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>);
<a name="l02004"></a>02004    <span class="keywordflow">if</span> (!e) {
<a name="l02005"></a>02005       <span class="keywordflow">return</span> -1;
<a name="l02006"></a>02006    }
<a name="l02007"></a>02007 
<a name="l02008"></a>02008    <span class="comment">/* Find the hint in the list of hints */</span>
<a name="l02009"></a>02009    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;hints);
<a name="l02010"></a>02010 
<a name="l02011"></a>02011    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;hints, hint, list) {
<a name="l02012"></a>02012       <span class="keywordflow">if</span> (hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a> == e)
<a name="l02013"></a>02013          <span class="keywordflow">break</span>;
<a name="l02014"></a>02014    }
<a name="l02015"></a>02015 
<a name="l02016"></a>02016    <span class="keywordflow">if</span> (!hint) {
<a name="l02017"></a>02017       <span class="comment">/* We have no hint, sorry */</span>
<a name="l02018"></a>02018       <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l02019"></a>02019       <span class="keywordflow">return</span> -1;
<a name="l02020"></a>02020    }
<a name="l02021"></a>02021 
<a name="l02022"></a>02022    <span class="comment">/* Now insert the callback in the callback list  */</span>
<a name="l02023"></a>02023    <span class="keywordflow">if</span> (!(cblist = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*cblist)))) {
<a name="l02024"></a>02024       <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l02025"></a>02025       <span class="keywordflow">return</span> -1;
<a name="l02026"></a>02026    }
<a name="l02027"></a>02027    cblist-&gt;id = <a class="code" href="pbx_8c.html#2749ddcba583cf049c6034826528c0a4">stateid</a>++;    <span class="comment">/* Unique ID for this callback */</span>
<a name="l02028"></a>02028    cblist-&gt;callback = callback;  <span class="comment">/* Pointer to callback routine */</span>
<a name="l02029"></a>02029    cblist-&gt;data = <a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a>;    <span class="comment">/* Data for the callback */</span>
<a name="l02030"></a>02030 
<a name="l02031"></a>02031    cblist-&gt;next = hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a>;
<a name="l02032"></a>02032    hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a> = cblist;
<a name="l02033"></a>02033 
<a name="l02034"></a>02034    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l02035"></a>02035    <span class="keywordflow">return</span> cblist-&gt;id;
<a name="l02036"></a>02036 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2eee51fa21b14e53302712d806421fbb"></a><!-- doxytag: member="pbx.h::ast_extension_state_del" ref="2eee51fa21b14e53302712d806421fbb" args="(int id, ast_state_cb_type callback)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_extension_state_del           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>id</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="pbx_8h.html#a083658b5411c328227915675531df43">ast_state_cb_type</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>callback</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Deletes a registered state change callback by ID. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>id</em>&nbsp;</td><td>of the callback to delete </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callback</em>&nbsp;</td><td>callback</td></tr>
  </table>
</dl>
Removes the callback from list of callbacks<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02039">2039</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="pbx_8c-source.html#l00205">ast_hint::callbacks</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="pbx_8c-source.html#l00193">ast_state_cb::next</a>, and <a class="el" href="pbx_8c-source.html#l00504">statecbs</a>.
<p>
Referenced by <a class="el" href="chan__sip_8c-source.html#l03286">__sip_destroy()</a>, and <a class="el" href="chan__skinny_8c-source.html#l01398">skinny_unregister()</a>.<div class="fragment"><pre class="fragment"><a name="l02040"></a>02040 {
<a name="l02041"></a>02041    <span class="keyword">struct </span><a class="code" href="structast__state__cb.html">ast_state_cb</a> **p_cur = NULL; <span class="comment">/* address of pointer to us */</span>
<a name="l02042"></a>02042    <span class="keywordtype">int</span> ret = -1;
<a name="l02043"></a>02043 
<a name="l02044"></a>02044    <span class="keywordflow">if</span> (!<span class="keywordtype">id</span> &amp;&amp; !<a class="code" href="structast__state__cb.html#924a8ceeac17f54d3be3f8cdf1c04eb2">callback</a>)
<a name="l02045"></a>02045       <span class="keywordflow">return</span> -1;
<a name="l02046"></a>02046 
<a name="l02047"></a>02047    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;hints);
<a name="l02048"></a>02048 
<a name="l02049"></a>02049    <span class="keywordflow">if</span> (!<span class="keywordtype">id</span>) {  <span class="comment">/* id == 0 is a callback without extension */</span>
<a name="l02050"></a>02050       <span class="keywordflow">for</span> (p_cur = &amp;<a class="code" href="pbx_8c.html#3b088b468374b928f6ab90bfe5db48bf">statecbs</a>; *p_cur; p_cur = &amp;(*p_cur)-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l02051"></a>02051          <span class="keywordflow">if</span> ((*p_cur)-&gt;callback == <a class="code" href="structast__state__cb.html#924a8ceeac17f54d3be3f8cdf1c04eb2">callback</a>)
<a name="l02052"></a>02052             <span class="keywordflow">break</span>;
<a name="l02053"></a>02053       }
<a name="l02054"></a>02054    } <span class="keywordflow">else</span> { <span class="comment">/* callback with extension, find the callback based on ID */</span>
<a name="l02055"></a>02055       <span class="keyword">struct </span><a class="code" href="structast__hint.html">ast_hint</a> *hint;
<a name="l02056"></a>02056       <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;hints, hint, list) {
<a name="l02057"></a>02057          <span class="keywordflow">for</span> (p_cur = &amp;hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a>; *p_cur; p_cur = &amp;(*p_cur)-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l02058"></a>02058             <span class="keywordflow">if</span> ((*p_cur)-&gt;id == <span class="keywordtype">id</span>)
<a name="l02059"></a>02059                <span class="keywordflow">break</span>;
<a name="l02060"></a>02060          }
<a name="l02061"></a>02061          <span class="keywordflow">if</span> (*p_cur) <span class="comment">/* found in the inner loop */</span>
<a name="l02062"></a>02062             <span class="keywordflow">break</span>;
<a name="l02063"></a>02063       }
<a name="l02064"></a>02064    }
<a name="l02065"></a>02065    <span class="keywordflow">if</span> (p_cur &amp;&amp; *p_cur) {
<a name="l02066"></a>02066       <span class="keyword">struct </span><a class="code" href="structast__state__cb.html">ast_state_cb</a> *cur = *p_cur;
<a name="l02067"></a>02067       *p_cur = cur-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l02068"></a>02068       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(cur);
<a name="l02069"></a>02069       ret = 0;
<a name="l02070"></a>02070    }
<a name="l02071"></a>02071    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l02072"></a>02072    <span class="keywordflow">return</span> ret;
<a name="l02073"></a>02073 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6f1b63f69b489517c49ccfecdbe1642e"></a><!-- doxytag: member="pbx.h::ast_findlabel_extension" ref="6f1b63f69b489517c49ccfecdbe1642e" args="(struct ast_channel *c, const char *context, const char *exten, const char *label, const char *callerid)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_findlabel_extension           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>label</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>callerid</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Find the priority of an extension that has the specified label. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>this is not important </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>which context to look in </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>exten</em>&nbsp;</td><td>which extension to search for </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>label</em>&nbsp;</td><td>label of the action within the extension to match to priority </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callerid</em>&nbsp;</td><td>callerid to search for</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the priority which matches the given label in the extension or -1 if not found. </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02188">2188</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe1bb8d310644e3f6e2603d80f8464bdda">E_FINDLABEL</a>, and <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l01912">action_originate()</a>, <a class="el" href="manager_8c-source.html#l01726">action_redirect()</a>, <a class="el" href="pbx_8c-source.html#l06287">ast_parseable_goto()</a>, <a class="el" href="app__channelredirect_8c-source.html#l00052">asyncgoto_exec()</a>, and <a class="el" href="res__agi_8c-source.html#l00873">handle_setpriority()</a>.<div class="fragment"><pre class="fragment"><a name="l02189"></a>02189 {
<a name="l02190"></a>02190    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#2377c7b979811bdd54ebf819e5d2037b">pbx_extension_helper</a>(c, NULL, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, 0, label, callerid, <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe1bb8d310644e3f6e2603d80f8464bdda">E_FINDLABEL</a>);
<a name="l02191"></a>02191 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="7139f616e9b477dc630ba7cec0c22df4"></a><!-- doxytag: member="pbx.h::ast_findlabel_extension2" ref="7139f616e9b477dc630ba7cec0c22df4" args="(struct ast_channel *c, struct ast_context *con, const char *exten, const char *label, const char *callerid)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_findlabel_extension2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>label</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>callerid</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Find the priority of an extension that has the specified label. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>This function is the same as ast_findlabel_extension, except that it accepts a pointer to an <a class="el" href="structast__context.html">ast_context</a> structure to specify the context instead of the name of the context. Otherwise, the functions behave the same. </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02193">2193</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe1bb8d310644e3f6e2603d80f8464bdda">E_FINDLABEL</a>, and <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01332">pbx_load_config()</a>.<div class="fragment"><pre class="fragment"><a name="l02194"></a>02194 {
<a name="l02195"></a>02195    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#2377c7b979811bdd54ebf819e5d2037b">pbx_extension_helper</a>(c, con, NULL, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, 0, label, callerid, <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe1bb8d310644e3f6e2603d80f8464bdda">E_FINDLABEL</a>);
<a name="l02196"></a>02196 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="fc067f1890b3fdeeacbc538e92a39fbd"></a><!-- doxytag: member="pbx.h::ast_func_read" ref="fc067f1890b3fdeeacbc538e92a39fbd" args="(struct ast_channel *chan, const char *function, char *workspace, size_t len)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_func_read           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>function</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>workspace</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
executes a read operation on a function 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>Channel to execute on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>function</em>&nbsp;</td><td>Data containing the function call string (will be modified) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>workspace</em>&nbsp;</td><td>A pointer to safe memory to use for a return value </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>the number of bytes in workspace</td></tr>
  </table>
</dl>
This application executes a function in read mode on a given channel.<p>
<dl compact><dt><b>Returns:</b></dt><dd>zero on success, non-zero on failure </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01437">1437</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l01345">ast_custom_function_find()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>, <a class="el" href="file_8c-source.html#l00207">copy()</a>, <a class="el" href="pbx_8c-source.html#l01420">func_args()</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, and <a class="el" href="structast__custom__function.html#7fa57fbc014b0b862cf2bbeb43888f5e">ast_custom_function::read</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l01548">action_getvar()</a>, <a class="el" href="res__agi_8c-source.html#l01187">handle_getvariable()</a>, and <a class="el" href="pbx_8c-source.html#l01468">pbx_substitute_variables_helper_full()</a>.<div class="fragment"><pre class="fragment"><a name="l01438"></a>01438 {
<a name="l01439"></a>01439    <span class="keywordtype">char</span> *<a class="code" href="file_8c.html#231def655f9282cd0b10171d366f3d38">copy</a> = <a class="code" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>(function);
<a name="l01440"></a>01440    <span class="keywordtype">char</span> *args = <a class="code" href="pbx_8c.html#3d2c812ce63291930182ea8c9edb17b8">func_args</a>(copy);
<a name="l01441"></a>01441    <span class="keyword">struct </span><a class="code" href="structast__custom__function.html">ast_custom_function</a> *acfptr = <a class="code" href="pbx_8c.html#2f6033daa3dd2a6a51ee380a86a783ba">ast_custom_function_find</a>(copy);
<a name="l01442"></a>01442 
<a name="l01443"></a>01443    <span class="keywordflow">if</span> (acfptr == NULL)
<a name="l01444"></a>01444       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Function %s not registered\n"</span>, copy);
<a name="l01445"></a>01445    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!acfptr-&gt;<a class="code" href="structast__custom__function.html#7fa57fbc014b0b862cf2bbeb43888f5e">read</a>)
<a name="l01446"></a>01446       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Function %s cannot be read\n"</span>, copy);
<a name="l01447"></a>01447    <span class="keywordflow">else</span>
<a name="l01448"></a>01448       <span class="keywordflow">return</span> acfptr-&gt;<a class="code" href="structast__custom__function.html#7fa57fbc014b0b862cf2bbeb43888f5e">read</a>(chan, copy, args, workspace, <a class="code" href="utils_8h.html#f5a8e923f8cd24b56b3bab32358cc58a">len</a>);
<a name="l01449"></a>01449    <span class="keywordflow">return</span> -1;
<a name="l01450"></a>01450 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2432c0e88181cb3ba2c1a2764b0a6238"></a><!-- doxytag: member="pbx.h::ast_func_write" ref="2432c0e88181cb3ba2c1a2764b0a6238" args="(struct ast_channel *chan, const char *function, const char *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_func_write           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>function</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
executes a write operation on a function 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>chan</em>&nbsp;</td><td>Channel to execute on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>function</em>&nbsp;</td><td>Data containing the function call string (will be modified) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>A value parameter to pass for writing</td></tr>
  </table>
</dl>
This application executes a function in write mode on a given channel.<p>
<dl compact><dt><b>Returns:</b></dt><dd>zero on success, non-zero on failure </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01452">1452</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l01345">ast_custom_function_find()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>, <a class="el" href="file_8c-source.html#l00207">copy()</a>, <a class="el" href="pbx_8c-source.html#l01420">func_args()</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, and <a class="el" href="structast__custom__function.html#07c22fb96be36e9fdeed80ce4067f2a2">ast_custom_function::write</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l05794">pbx_builtin_pushvar_helper()</a>, and <a class="el" href="pbx_8c-source.html#l05821">pbx_builtin_setvar_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l01453"></a>01453 {
<a name="l01454"></a>01454    <span class="keywordtype">char</span> *<a class="code" href="file_8c.html#231def655f9282cd0b10171d366f3d38">copy</a> = <a class="code" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>(function);
<a name="l01455"></a>01455    <span class="keywordtype">char</span> *args = <a class="code" href="pbx_8c.html#3d2c812ce63291930182ea8c9edb17b8">func_args</a>(copy);
<a name="l01456"></a>01456    <span class="keyword">struct </span><a class="code" href="structast__custom__function.html">ast_custom_function</a> *acfptr = <a class="code" href="pbx_8c.html#2f6033daa3dd2a6a51ee380a86a783ba">ast_custom_function_find</a>(copy);
<a name="l01457"></a>01457 
<a name="l01458"></a>01458    <span class="keywordflow">if</span> (acfptr == NULL)
<a name="l01459"></a>01459       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Function %s not registered\n"</span>, copy);
<a name="l01460"></a>01460    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!acfptr-&gt;<a class="code" href="structast__custom__function.html#07c22fb96be36e9fdeed80ce4067f2a2">write</a>)
<a name="l01461"></a>01461       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Function %s cannot be written to\n"</span>, copy);
<a name="l01462"></a>01462    <span class="keywordflow">else</span>
<a name="l01463"></a>01463       <span class="keywordflow">return</span> acfptr-&gt;<a class="code" href="structast__custom__function.html#07c22fb96be36e9fdeed80ce4067f2a2">write</a>(chan, copy, args, value);
<a name="l01464"></a>01464 
<a name="l01465"></a>01465    <span class="keywordflow">return</span> -1;
<a name="l01466"></a>01466 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4571490d866dec074492c52ea27a304b"></a><!-- doxytag: member="pbx.h::ast_get_context_name" ref="4571490d866dec074492c52ea27a304b" args="(struct ast_context *con)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_context_name           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>con</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06100">6100</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04304">ast_context_add_include2()</a>, <a class="el" href="pbx_8c-source.html#l04386">ast_context_add_switch2()</a>, <a class="el" href="pbx_8c-source.html#l02823">ast_context_lockmacro()</a>, <a class="el" href="pbx_8c-source.html#l02851">ast_context_unlockmacro()</a>, <a class="el" href="pbx_8c-source.html#l06243">ast_context_verify_includes()</a>, <a class="el" href="pbx__config_8c-source.html#l01033">complete_context_add_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01104">complete_context_add_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00619">complete_context_add_include()</a>, <a class="el" href="pbx__config_8c-source.html#l00449">complete_context_remove_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01187">complete_context_remove_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00211">complete_context_remove_include()</a>, <a class="el" href="pbx_8c-source.html#l03275">complete_show_dialplan_context()</a>, <a class="el" href="pbx__dundi_8c-source.html#l03615">dundi_precache_full()</a>, <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>, <a class="el" href="app__while_8c-source.html#l00123">find_matching_endwhile()</a>, <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>, <a class="el" href="pbx_8c-source.html#l03142">handle_show_hints()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06101"></a>06101 {
<a name="l06102"></a>06102    <span class="keywordflow">return</span> con ? con-&gt;name : NULL;
<a name="l06103"></a>06103 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="76308d8bcceb0331e0d4736df41b1412"></a><!-- doxytag: member="pbx.h::ast_get_context_registrar" ref="76308d8bcceb0331e0d4736df41b1412" args="(struct ast_context *c)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_context_registrar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>c</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06138">6138</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00171">ast_context::registrar</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06139"></a>06139 {
<a name="l06140"></a>06140    <span class="keywordflow">return</span> c ? c-&gt;<a class="code" href="structast__context.html#5940569cd1d60781f856f93235b072ee">registrar</a> : NULL;
<a name="l06141"></a>06141 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c8eaa4fc248390fee258e7d2b2ff3490"></a><!-- doxytag: member="pbx.h::ast_get_extension_app" ref="c8eaa4fc248390fee258e7d2b2ff3490" args="(struct ast_exten *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_extension_app           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06168">6168</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00125">ast_exten::app</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02076">ast_add_hint()</a>, <a class="el" href="pbx_8c-source.html#l01812">ast_extension_state2()</a>, <a class="el" href="pbx_8c-source.html#l02166">ast_get_hint()</a>, <a class="el" href="pbx_8c-source.html#l01920">ast_hint_state_changed()</a>, <a class="el" href="app__while_8c-source.html#l00123">find_matching_endwhile()</a>, <a class="el" href="pbx_8c-source.html#l03142">handle_show_hints()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03315">print_ext()</a>.<div class="fragment"><pre class="fragment"><a name="l06169"></a>06169 {
<a name="l06170"></a>06170    <span class="keywordflow">return</span> e ? e-&gt;<a class="code" href="structast__exten.html#d2a57dc1d883fd21fb9951699df71cc7">app</a> : NULL;
<a name="l06171"></a>06171 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4a723bd9d782fe0a3fb16d00268ec5a4"></a><!-- doxytag: member="pbx.h::ast_get_extension_app_data" ref="4a723bd9d782fe0a3fb16d00268ec5a4" args="(struct ast_exten *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void* ast_get_extension_app_data           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06173">6173</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00127">ast_exten::data</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02166">ast_get_hint()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03315">print_ext()</a>.<div class="fragment"><pre class="fragment"><a name="l06174"></a>06174 {
<a name="l06175"></a>06175    <span class="keywordflow">return</span> e ? e-&gt;<a class="code" href="structast__exten.html#8d777f385d3dfec8815d20f7496026dc">data</a> : NULL;
<a name="l06176"></a>06176 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="05032ac07f5935587193e7da044e30de"></a><!-- doxytag: member="pbx.h::ast_get_extension_cidmatch" ref="05032ac07f5935587193e7da044e30de" args="(struct ast_exten *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_extension_cidmatch           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06163">6163</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00121">ast_exten::cidmatch</a>.
<p>
Referenced by <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>.<div class="fragment"><pre class="fragment"><a name="l06164"></a>06164 {
<a name="l06165"></a>06165    <span class="keywordflow">return</span> e ? e-&gt;<a class="code" href="structast__exten.html#2ef4524f32df05033fd0502689de872e">cidmatch</a> : NULL;
<a name="l06166"></a>06166 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="61636cd55acce8616de92323b8a427b9"></a><!-- doxytag: member="pbx.h::ast_get_extension_context" ref="61636cd55acce8616de92323b8a427b9" args="(struct ast_exten *exten)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a>* ast_get_extension_context           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>exten</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06105">6105</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00124">ast_exten::parent</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03142">handle_show_hints()</a>.<div class="fragment"><pre class="fragment"><a name="l06106"></a>06106 {
<a name="l06107"></a>06107    <span class="keywordflow">return</span> exten ? exten-&gt;<a class="code" href="structast__exten.html#d0e45878043844ffc41aac437e86b602">parent</a> : NULL;
<a name="l06108"></a>06108 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ec068be9b53a7d12a6e733c4c49c3f43"></a><!-- doxytag: member="pbx.h::ast_get_extension_label" ref="ec068be9b53a7d12a6e733c4c49c3f43" args="(struct ast_exten *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_extension_label           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06115">6115</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00123">ast_exten::label</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06116"></a>06116 {
<a name="l06117"></a>06117    <span class="keywordflow">return</span> <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a> ? <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>-&gt;label : NULL;
<a name="l06118"></a>06118 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8c7f1a8dd6fbdb6df987ac164ef7fdfc"></a><!-- doxytag: member="pbx.h::ast_get_extension_matchcid" ref="8c7f1a8dd6fbdb6df987ac164ef7fdfc" args="(struct ast_exten *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_get_extension_matchcid           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06158">6158</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00120">ast_exten::matchcid</a>.
<p>
Referenced by <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>.<div class="fragment"><pre class="fragment"><a name="l06159"></a>06159 {
<a name="l06160"></a>06160    <span class="keywordflow">return</span> e ? e-&gt;<a class="code" href="structast__exten.html#efe3a90f8f309530890b1682034f13c8">matchcid</a> : 0;
<a name="l06161"></a>06161 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4318ec15d92ac47de94902f6aba4c114"></a><!-- doxytag: member="pbx.h::ast_get_extension_name" ref="4318ec15d92ac47de94902f6aba4c114" args="(struct ast_exten *exten)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_extension_name           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>exten</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06110">6110</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00119">ast_exten::exten</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02076">ast_add_hint()</a>, <a class="el" href="pbx__config_8c-source.html#l00449">complete_context_remove_extension()</a>, <a class="el" href="pbx__dundi_8c-source.html#l03615">dundi_precache_full()</a>, <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>, <a class="el" href="pbx_8c-source.html#l03142">handle_show_hints()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06111"></a>06111 {
<a name="l06112"></a>06112    <span class="keywordflow">return</span> exten ? exten-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a> : NULL;
<a name="l06113"></a>06113 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ecebedf381a09dd2630dc03e49b83112"></a><!-- doxytag: member="pbx.h::ast_get_extension_priority" ref="ecebedf381a09dd2630dc03e49b83112" args="(struct ast_exten *exten)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_get_extension_priority           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>exten</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06130">6130</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00122">ast_exten::priority</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l00449">complete_context_remove_extension()</a>, <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03315">print_ext()</a>.<div class="fragment"><pre class="fragment"><a name="l06131"></a>06131 {
<a name="l06132"></a>06132    <span class="keywordflow">return</span> exten ? exten-&gt;<a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a> : -1;
<a name="l06133"></a>06133 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="20537e2517918a112d0b738d8c70cae2"></a><!-- doxytag: member="pbx.h::ast_get_extension_registrar" ref="20537e2517918a112d0b738d8c70cae2" args="(struct ast_exten *e)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_extension_registrar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>e</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06143">6143</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00130">ast_exten::registrar</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06144"></a>06144 {
<a name="l06145"></a>06145    <span class="keywordflow">return</span> e ? e-&gt;<a class="code" href="structast__exten.html#5940569cd1d60781f856f93235b072ee">registrar</a> : NULL;
<a name="l06146"></a>06146 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3afea100b9227e24b1334dced9595864"></a><!-- doxytag: member="pbx.h::ast_get_hint" ref="3afea100b9227e24b1334dced9595864" args="(char *hint, int maxlen, char *name, int maxnamelen, struct ast_channel *c, const char *context, const char *exten)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_get_hint           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>hint</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>maxnamelen</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
If an extension hint exists, return non-zero. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>hint</em>&nbsp;</td><td>buffer for hint </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>maxlen</em>&nbsp;</td><td>size of hint buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>buffer for name portion of hint </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>maxnamelen</em>&nbsp;</td><td>size of name buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>this is not important </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>which context to look in </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>exten</em>&nbsp;</td><td>which extension to search for</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>If an extension within the given context with the priority PRIORITY_HINT is found a non zero value will be returned. Otherwise, 0 is returned. </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02166">2166</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06168">ast_get_extension_app()</a>, <a class="el" href="pbx_8c-source.html#l06173">ast_get_extension_app_data()</a>, and <a class="el" href="pbx_8c-source.html#l01799">ast_hint_extension()</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l02085">action_extensionstate()</a>, <a class="el" href="app__dial_8c-source.html#l00392">get_cid_name()</a>, <a class="el" href="manager_8c-source.html#l02654">manager_state_cb()</a>, <a class="el" href="pbx_8c-source.html#l01132">pbx_retrieve_variable()</a>, <a class="el" href="chan__skinny_8c-source.html#l01719">skinny_extensionstate_cb()</a>, and <a class="el" href="chan__sip_8c-source.html#l07533">transmit_state_notify()</a>.<div class="fragment"><pre class="fragment"><a name="l02167"></a>02167 {
<a name="l02168"></a>02168    <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *e = <a class="code" href="pbx_8c.html#a4691f6ae9689498c10c695381f36103">ast_hint_extension</a>(c, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>);
<a name="l02169"></a>02169 
<a name="l02170"></a>02170    <span class="keywordflow">if</span> (e) {
<a name="l02171"></a>02171       <span class="keywordflow">if</span> (hint)
<a name="l02172"></a>02172          ast_copy_string(hint, <a class="code" href="pbx_8c.html#c8eaa4fc248390fee258e7d2b2ff3490">ast_get_extension_app</a>(e), hintsize);
<a name="l02173"></a>02173       <span class="keywordflow">if</span> (<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>) {
<a name="l02174"></a>02174          <span class="keyword">const</span> <span class="keywordtype">char</span> *tmp = <a class="code" href="pbx_8c.html#4a723bd9d782fe0a3fb16d00268ec5a4">ast_get_extension_app_data</a>(e);
<a name="l02175"></a>02175          <span class="keywordflow">if</span> (tmp)
<a name="l02176"></a>02176             ast_copy_string(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, tmp, namesize);
<a name="l02177"></a>02177       }
<a name="l02178"></a>02178       <span class="keywordflow">return</span> -1;
<a name="l02179"></a>02179    }
<a name="l02180"></a>02180    <span class="keywordflow">return</span> 0;
<a name="l02181"></a>02181 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8362b5fbecbf06d68596f1361a817971"></a><!-- doxytag: member="pbx.h::ast_get_ignorepat_name" ref="8362b5fbecbf06d68596f1361a817971" args="(struct ast_ignorepat *ip)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_ignorepat_name           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__ignorepat.html">ast_ignorepat</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ip</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06125">6125</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00161">ast_ignorepat::pattern</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01187">complete_context_remove_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00151">lookup_c_ip()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06126"></a>06126 {
<a name="l06127"></a>06127    <span class="keywordflow">return</span> ip ? ip-&gt;<a class="code" href="structast__ignorepat.html#6ed092b904da0ceba9109608322e7880">pattern</a> : NULL;
<a name="l06128"></a>06128 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ecf759381e5bb2d13dbf2188d6728217"></a><!-- doxytag: member="pbx.h::ast_get_ignorepat_registrar" ref="ecf759381e5bb2d13dbf2188d6728217" args="(struct ast_ignorepat *ip)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_ignorepat_registrar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__ignorepat.html">ast_ignorepat</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ip</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06153">6153</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00159">ast_ignorepat::registrar</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06154"></a>06154 {
<a name="l06155"></a>06155    <span class="keywordflow">return</span> ip ? ip-&gt;<a class="code" href="structast__ignorepat.html#5940569cd1d60781f856f93235b072ee">registrar</a> : NULL;
<a name="l06156"></a>06156 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4a816e24ecefa880d77ecdb16ad2deb5"></a><!-- doxytag: member="pbx.h::ast_get_include_name" ref="4a816e24ecefa880d77ecdb16ad2deb5" args="(struct ast_include *include)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_include_name           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__include.html">ast_include</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>include</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06120">6120</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00137">ast_include::name</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l00211">complete_context_remove_include()</a>, <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>, <a class="el" href="pbx__config_8c-source.html#l00137">lookup_ci()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06121"></a>06121 {
<a name="l06122"></a>06122    <span class="keywordflow">return</span> inc ? inc-&gt;name : NULL;
<a name="l06123"></a>06123 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a10e2a34982bf1e3c4df8fbf94a8f858"></a><!-- doxytag: member="pbx.h::ast_get_include_registrar" ref="a10e2a34982bf1e3c4df8fbf94a8f858" args="(struct ast_include *i)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_include_registrar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__include.html">ast_include</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>i</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06148">6148</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00139">ast_include::registrar</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06149"></a>06149 {
<a name="l06150"></a>06150    <span class="keywordflow">return</span> i ? i-&gt;<a class="code" href="structast__include.html#5940569cd1d60781f856f93235b072ee">registrar</a> : NULL;
<a name="l06151"></a>06151 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ee960249076eea022f3aaa855b0a2475"></a><!-- doxytag: member="pbx.h::ast_get_switch_data" ref="ee960249076eea022f3aaa855b0a2475" args="(struct ast_sw *sw)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_switch_data           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__sw.html">ast_sw</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>sw</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06183">6183</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00150">ast_sw::data</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06184"></a>06184 {
<a name="l06185"></a>06185    <span class="keywordflow">return</span> sw ? sw-&gt;<a class="code" href="structast__sw.html#8d777f385d3dfec8815d20f7496026dc">data</a> : NULL;
<a name="l06186"></a>06186 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="e78e1da5bf7f86cd550128a0cc440658"></a><!-- doxytag: member="pbx.h::ast_get_switch_name" ref="e78e1da5bf7f86cd550128a0cc440658" args="(struct ast_sw *sw)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_switch_name           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__sw.html">ast_sw</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>sw</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06178">6178</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00148">ast_sw::name</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06179"></a>06179 {
<a name="l06180"></a>06180    <span class="keywordflow">return</span> sw ? sw-&gt;<a class="code" href="structast__sw.html#b068931cc450442b63f5b3d276ea4297">name</a> : NULL;
<a name="l06181"></a>06181 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6e9fbaaa189820f4a0c36a1ad4dfca6d"></a><!-- doxytag: member="pbx.h::ast_get_switch_registrar" ref="6e9fbaaa189820f4a0c36a1ad4dfca6d" args="(struct ast_sw *sw)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_get_switch_registrar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__sw.html">ast_sw</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>sw</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06188">6188</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00149">ast_sw::registrar</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06189"></a>06189 {
<a name="l06190"></a>06190    <span class="keywordflow">return</span> sw ? sw-&gt;<a class="code" href="structast__sw.html#5940569cd1d60781f856f93235b072ee">registrar</a> : NULL;
<a name="l06191"></a>06191 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="66e271b78f5b09452a521e220c223e1e"></a><!-- doxytag: member="pbx.h::ast_goto_if_exists" ref="66e271b78f5b09452a521e220c223e1e" args="(struct ast_channel *chan, const char *context, const char *exten, int priority)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_goto_if_exists           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06277">6277</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l06258">__ast_goto_if_exists()</a>.
<p>
Referenced by <a class="el" href="app__queue_8c-source.html#l03326">aqm_exec()</a>, <a class="el" href="app__authenticate_8c-source.html#l00094">auth_exec()</a>, <a class="el" href="app__talkdetect_8c-source.html#l00063">background_detect_exec()</a>, <a class="el" href="app__chanisavail_8c-source.html#l00069">chanavail_exec()</a>, <a class="el" href="app__chanspy_8c-source.html#l00266">channel_spy()</a>, <a class="el" href="app__chanspy_8c-source.html#l00465">common_exec()</a>, <a class="el" href="app__controlplayback_8c-source.html#l00075">controlplayback_exec()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="app__directory_8c-source.html#l00400">do_directory()</a>, <a class="el" href="app__voicemail_8c-source.html#l02956">leave_voicemail()</a>, <a class="el" href="app__dial_8c-source.html#l00373">onedigit_goto()</a>, <a class="el" href="app__osplookup_8c-source.html#l01311">ospauth_exec()</a>, <a class="el" href="app__osplookup_8c-source.html#l01803">ospfinished_exec()</a>, <a class="el" href="app__osplookup_8c-source.html#l01415">osplookup_exec()</a>, <a class="el" href="app__osplookup_8c-source.html#l01618">ospnext_exec()</a>, <a class="el" href="app__directory_8c-source.html#l00261">play_mailbox_owner()</a>, <a class="el" href="app__playback_8c-source.html#l00378">playback_exec()</a>, <a class="el" href="app__queue_8c-source.html#l03157">pqm_exec()</a>, <a class="el" href="app__privacy_8c-source.html#l00078">privacy_exec()</a>, <a class="el" href="app__queue_8c-source.html#l03263">rqm_exec()</a>, <a class="el" href="app__image_8c-source.html#l00063">sendimage_exec()</a>, <a class="el" href="app__sendtext_8c-source.html#l00067">sendtext_exec()</a>, <a class="el" href="app__url_8c-source.html#l00070">sendurl_exec()</a>, <a class="el" href="app__system_8c-source.html#l00085">system_exec_helper()</a>, <a class="el" href="app__transfer_8c-source.html#l00068">transfer_exec()</a>, <a class="el" href="app__queue_8c-source.html#l03210">upqm_exec()</a>, <a class="el" href="app__queue_8c-source.html#l01320">valid_exit()</a>, <a class="el" href="app__voicemail_8c-source.html#l07081">vm_box_exists()</a>, <a class="el" href="app__voicemail_8c-source.html#l06944">vm_exec()</a>, and <a class="el" href="app__dial_8c-source.html#l00532">wait_for_answer()</a>.<div class="fragment"><pre class="fragment"><a name="l06278"></a>06278 {
<a name="l06279"></a>06279    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#ea67e0eddc31f7145c5c9c7991255636">__ast_goto_if_exists</a>(chan, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="code" href="structast__exten.html#b988295c268025b49dfb3df26171ddc3">priority</a>, 0);
<a name="l06280"></a>06280 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="5bc7455c31be4c32a90e55a101009fdf"></a><!-- doxytag: member="pbx.h::ast_hint_state_changed" ref="5bc7455c31be4c32a90e55a101009fdf" args="(const char *device)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_hint_state_changed           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>device</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01920">1920</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l01812">ast_extension_state2()</a>, <a class="el" href="pbx_8c-source.html#l06168">ast_get_extension_app()</a>, <a class="el" href="channel_8h-source.html#l00139">AST_MAX_EXTENSION</a>, <a class="el" href="linkedlists_8h-source.html#l00060">AST_RWLIST_RDLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="adsistub_8c-source.html#l00065">buf</a>, <a class="el" href="pbx_8c-source.html#l00192">ast_state_cb::callback</a>, <a class="el" href="pbx_8c-source.html#l00205">ast_hint::callbacks</a>, <a class="el" href="pbx_8c-source.html#l00191">ast_state_cb::data</a>, <a class="el" href="pbx_8c-source.html#l00119">ast_exten::exten</a>, <a class="el" href="pbx_8c-source.html#l00203">ast_hint::exten</a>, <a class="el" href="pbx_8c-source.html#l00204">ast_hint::laststate</a>, <a class="el" href="pbx_8c-source.html#l00193">ast_state_cb::next</a>, <a class="el" href="pbx_8c-source.html#l00124">ast_exten::parent</a>, <a class="el" href="chan__mgcp_8c-source.html#l01734">parse()</a>, <a class="el" href="pbx_8c-source.html#l00504">statecbs</a>, and <a class="el" href="strcompat_8c-source.html#l00035">strsep()</a>.
<p>
Referenced by <a class="el" href="devicestate_8c-source.html#l00421">do_state_change()</a>.<div class="fragment"><pre class="fragment"><a name="l01921"></a>01921 {
<a name="l01922"></a>01922    <span class="keyword">struct </span><a class="code" href="structast__hint.html">ast_hint</a> *hint;
<a name="l01923"></a>01923 
<a name="l01924"></a>01924    <a class="code" href="linkedlists_8h.html#23c0c844e5abcb474854867b408e3be8">AST_RWLIST_RDLOCK</a>(&amp;hints);
<a name="l01925"></a>01925 
<a name="l01926"></a>01926    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;hints, hint, list) {
<a name="l01927"></a>01927       <span class="keyword">struct </span><a class="code" href="structast__state__cb.html">ast_state_cb</a> *cblist;
<a name="l01928"></a>01928       <span class="keywordtype">char</span> <a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>[<a class="code" href="channel_8h.html#729d25558b5b1940c1a6ff9d806f944c">AST_MAX_EXTENSION</a>];
<a name="l01929"></a>01929       <span class="keywordtype">char</span> *<a class="code" href="chan__mgcp_8c.html#96d2a4ae057584ce23ca92b03303bd2f">parse</a> = buf;
<a name="l01930"></a>01930       <span class="keywordtype">char</span> *cur;
<a name="l01931"></a>01931       <span class="keywordtype">int</span> <a class="code" href="structstate.html">state</a>;
<a name="l01932"></a>01932 
<a name="l01933"></a>01933       ast_copy_string(buf, <a class="code" href="pbx_8c.html#c8eaa4fc248390fee258e7d2b2ff3490">ast_get_extension_app</a>(hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>), <span class="keyword">sizeof</span>(buf));
<a name="l01934"></a>01934       <span class="keywordflow">while</span> ( (cur = <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;parse, <span class="stringliteral">"&amp;"</span>)) ) {
<a name="l01935"></a>01935          <span class="keywordflow">if</span> (!strcasecmp(cur, device))
<a name="l01936"></a>01936             <span class="keywordflow">break</span>;
<a name="l01937"></a>01937       }
<a name="l01938"></a>01938       <span class="keywordflow">if</span> (!cur)
<a name="l01939"></a>01939          <span class="keywordflow">continue</span>;
<a name="l01940"></a>01940 
<a name="l01941"></a>01941       <span class="comment">/* Get device state for this hint */</span>
<a name="l01942"></a>01942       state = <a class="code" href="pbx_8c.html#6aecfed8ee63e22940bc2d842f0a536c">ast_extension_state2</a>(hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>);
<a name="l01943"></a>01943 
<a name="l01944"></a>01944       <span class="keywordflow">if</span> ((state == -1) || (state == hint-&gt;<a class="code" href="structast__hint.html#406c995dd8ced9add7c7f6eb95532fe7">laststate</a>))
<a name="l01945"></a>01945          <span class="keywordflow">continue</span>;
<a name="l01946"></a>01946 
<a name="l01947"></a>01947       <span class="comment">/* Device state changed since last check - notify the watchers */</span>
<a name="l01948"></a>01948 
<a name="l01949"></a>01949       <span class="comment">/* For general callbacks */</span>
<a name="l01950"></a>01950       <span class="keywordflow">for</span> (cblist = <a class="code" href="pbx_8c.html#3b088b468374b928f6ab90bfe5db48bf">statecbs</a>; cblist; cblist = cblist-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>)
<a name="l01951"></a>01951          cblist-&gt;<a class="code" href="structast__state__cb.html#924a8ceeac17f54d3be3f8cdf1c04eb2">callback</a>(hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>-&gt;<a class="code" href="structast__exten.html#d0e45878043844ffc41aac437e86b602">parent</a>-&gt;name, hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>, state, cblist-&gt;<a class="code" href="structast__state__cb.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l01952"></a>01952 
<a name="l01953"></a>01953       <span class="comment">/* For extension callbacks */</span>
<a name="l01954"></a>01954       <span class="keywordflow">for</span> (cblist = hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a>; cblist; cblist = cblist-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>)
<a name="l01955"></a>01955          cblist-&gt;<a class="code" href="structast__state__cb.html#924a8ceeac17f54d3be3f8cdf1c04eb2">callback</a>(hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>-&gt;<a class="code" href="structast__exten.html#d0e45878043844ffc41aac437e86b602">parent</a>-&gt;name, hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>, state, cblist-&gt;<a class="code" href="structast__state__cb.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l01956"></a>01956 
<a name="l01957"></a>01957       hint-&gt;<a class="code" href="structast__hint.html#406c995dd8ced9add7c7f6eb95532fe7">laststate</a> = state;   <span class="comment">/* record we saw the change */</span>
<a name="l01958"></a>01958    }
<a name="l01959"></a>01959 
<a name="l01960"></a>01960    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l01961"></a>01961 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3c8a7255ea36a7270c24fd5ccccc56f6"></a><!-- doxytag: member="pbx.h::ast_ignore_pattern" ref="3c8a7255ea36a7270c24fd5ccccc56f6" args="(const char *context, const char *pattern)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_ignore_pattern           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>pattern</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Checks to see if a number should be ignored. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>context to search within </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pattern</em>&nbsp;</td><td>to check whether it should be ignored or not</td></tr>
  </table>
</dl>
Check if a number should be ignored with respect to dialtone cancellation.<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if the pattern should not be ignored </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>non-zero</em>&nbsp;</td><td>if the pattern should be ignored </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04542">4542</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00889">ast_context_find()</a>, <a class="el" href="pbx_8c-source.html#l00877">ast_extension_match()</a>, <a class="el" href="pbx_8c-source.html#l00170">ast_context::ignorepats</a>, <a class="el" href="pbx_8c-source.html#l00160">ast_ignorepat::next</a>, and <a class="el" href="pbx_8c-source.html#l00161">ast_ignorepat::pattern</a>.
<p>
Referenced by <a class="el" href="app_8c-source.html#l00065">ast_app_dtget()</a>, <a class="el" href="app__disa_8c-source.html#l00113">disa_exec()</a>, <a class="el" href="chan__iax2_8c-source.html#l06220">dp_lookup()</a>, <a class="el" href="pbx__dundi_8c-source.html#l00532">dundi_lookup_local()</a>, <a class="el" href="chan__skinny_8c-source.html#l03920">handle_soft_key_event_message()</a>, <a class="el" href="chan__skinny_8c-source.html#l03102">handle_stimulus_message()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02638">mgcp_ss()</a>, <a class="el" href="chan__skinny_8c-source.html#l02365">skinny_ss()</a>, and <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>.<div class="fragment"><pre class="fragment"><a name="l04543"></a>04543 {
<a name="l04544"></a>04544    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *con = <a class="code" href="pbx_8c.html#f8c5b4e7d06b7aff72707b5d7d7c94e1">ast_context_find</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>);
<a name="l04545"></a>04545    <span class="keywordflow">if</span> (con) {
<a name="l04546"></a>04546       <span class="keyword">struct </span><a class="code" href="structast__ignorepat.html">ast_ignorepat</a> *pat;
<a name="l04547"></a>04547       <span class="keywordflow">for</span> (pat = con-&gt;<a class="code" href="structast__context.html#79a69e07731e7d02c0f52f19bab94dcb">ignorepats</a>; pat; pat = pat-&gt;<a class="code" href="structast__ignorepat.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>) {
<a name="l04548"></a>04548          <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#fee4ebd3f1d86114fe9bb33931f9a6cf">ast_extension_match</a>(pat-&gt;<a class="code" href="structast__ignorepat.html#6ed092b904da0ceba9109608322e7880">pattern</a>, <a class="code" href="structast__ignorepat.html#6ed092b904da0ceba9109608322e7880">pattern</a>))
<a name="l04549"></a>04549             <span class="keywordflow">return</span> 1;
<a name="l04550"></a>04550       }
<a name="l04551"></a>04551    }
<a name="l04552"></a>04552 
<a name="l04553"></a>04553    <span class="keywordflow">return</span> 0;
<a name="l04554"></a>04554 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6e9c6f3a112b82510968f729fa3765bc"></a><!-- doxytag: member="pbx.h::ast_matchmore_extension" ref="6e9c6f3a112b82510968f729fa3765bc" args="(struct ast_channel *c, const char *context, const char *exten, int priority, const char *callerid)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_matchmore_extension           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>callerid</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Looks to see if adding anything to this extension might match something. (exists ^ canmatch). 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>not really important XXX </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>context to serach within </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>exten</em>&nbsp;</td><td>extension to check </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>priority</em>&nbsp;</td><td>priority of extension path </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callerid</em>&nbsp;</td><td>callerid of extension being searched for</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>If "exten" *could match* a valid extension in this context with some more digits, return non-zero. Does NOT return non-zero if this is an exact-match only. Basically, when this returns 0, no matter what you add to exten, it's not going to be a valid extension anymore </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02203">2203</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824febb13020eaa30c314c1bff110026a7cd2">E_MATCHMORE</a>, and <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>.
<p>
Referenced by <a class="el" href="app_8c-source.html#l00065">ast_app_dtget()</a>, <a class="el" href="pbx_8c-source.html#l02224">collect_digits()</a>, <a class="el" href="app__disa_8c-source.html#l00113">disa_exec()</a>, <a class="el" href="chan__iax2_8c-source.html#l06220">dp_lookup()</a>, <a class="el" href="pbx__dundi_8c-source.html#l00532">dundi_lookup_local()</a>, <a class="el" href="pbx__loopback_8c-source.html#l00152">loopback_matchmore()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02638">mgcp_ss()</a>, <a class="el" href="chan__skinny_8c-source.html#l02365">skinny_ss()</a>, and <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>.<div class="fragment"><pre class="fragment"><a name="l02204"></a>02204 {
<a name="l02205"></a>02205    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#2377c7b979811bdd54ebf819e5d2037b">pbx_extension_helper</a>(c, NULL, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, priority, NULL, callerid, <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824febb13020eaa30c314c1bff110026a7cd2">E_MATCHMORE</a>);
<a name="l02206"></a>02206 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6a86443aa2d56a55b117b3f985565bcb"></a><!-- doxytag: member="pbx.h::ast_merge_contexts_and_delete" ref="6a86443aa2d56a55b117b3f985565bcb" args="(struct ast_context **extcontexts, const char *registrar)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_merge_contexts_and_delete           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>extcontexts</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>registrar</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Merge the temporary contexts into a global contexts list and delete from the global list the ones that are being added. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>extcontexts</em>&nbsp;</td><td>pointer to the <a class="el" href="structast__context.html">ast_context</a> structure pointer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>registrar</em>&nbsp;</td><td>of the context; if it's set the routine will delete all contexts that belong to that registrar; if NULL only the contexts that are specified in extcontexts </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03936">3936</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l05285">__ast_context_destroy()</a>, <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f7564c0d9d79bfb21b4578eb245ddcecd9a">AST_EXTENSION_REMOVED</a>, <a class="el" href="pbx_8c-source.html#l01799">ast_hint_extension()</a>, <a class="el" href="linkedlists_8h-source.html#l00198">AST_LIST_HEAD_INIT_VALUE</a>, <a class="el" href="linkedlists_8h-source.html#l00650">AST_LIST_INSERT_HEAD</a>, <a class="el" href="linkedlists_8h-source.html#l00710">AST_LIST_REMOVE_HEAD</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="pbx_8c-source.html#l06074">ast_unlock_contexts()</a>, <a class="el" href="pbx_8c-source.html#l06064">ast_wrlock_contexts()</a>, <a class="el" href="pbx_8c-source.html#l00192">ast_state_cb::callback</a>, <a class="el" href="pbx_8c-source.html#l00205">ast_hint::callbacks</a>, <a class="el" href="chan__alsa_8c-source.html#l00124">context</a>, <a class="el" href="pbx_8c-source.html#l00489">contexts</a>, <a class="el" href="pbx_8c-source.html#l00191">ast_state_cb::data</a>, <a class="el" href="pbx_8c-source.html#l00119">ast_exten::exten</a>, <a class="el" href="pbx_8c-source.html#l00203">ast_hint::exten</a>, <a class="el" href="chan__alsa_8c-source.html#l00126">exten</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="pbx_8c-source.html#l00204">ast_hint::laststate</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="pbx_8c-source.html#l00193">ast_state_cb::next</a>, <a class="el" href="pbx_8c-source.html#l00168">ast_context::next</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, <a class="el" href="pbx_8c-source.html#l00124">ast_exten::parent</a>, and <a class="el" href="pbx_8c-source.html#l00171">ast_context::registrar</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01596">pbx_load_module()</a>.<div class="fragment"><pre class="fragment"><a name="l03937"></a>03937 {
<a name="l03938"></a>03938    <span class="keyword">struct </span><a class="code" href="structast__context.html">ast_context</a> *tmp, *lasttmp = NULL;
<a name="l03939"></a>03939    <span class="keyword">struct </span>store_hints store = <a class="code" href="linkedlists_8h.html#2bed4896e7f99dbbabfe1c897dcb96d9">AST_LIST_HEAD_INIT_VALUE</a>;
<a name="l03940"></a>03940    <span class="keyword">struct </span><a class="code" href="structstore__hint.html">store_hint</a> *<span class="keyword">this</span>;
<a name="l03941"></a>03941    <span class="keyword">struct </span><a class="code" href="structast__hint.html">ast_hint</a> *hint;
<a name="l03942"></a>03942    <span class="keyword">struct </span><a class="code" href="structast__exten.html">ast_exten</a> *<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>;
<a name="l03943"></a>03943    <span class="keywordtype">int</span> length;
<a name="l03944"></a>03944    <span class="keyword">struct </span><a class="code" href="structast__state__cb.html">ast_state_cb</a> *thiscb, *prevcb;
<a name="l03945"></a>03945 
<a name="l03946"></a>03946    <span class="comment">/* it is very important that this function hold the hint list lock _and_ the conlock</span>
<a name="l03947"></a>03947 <span class="comment">      during its operation; not only do we need to ensure that the list of contexts</span>
<a name="l03948"></a>03948 <span class="comment">      and extensions does not change, but also that no hint callbacks (watchers) are</span>
<a name="l03949"></a>03949 <span class="comment">      added or removed during the merge/delete process</span>
<a name="l03950"></a>03950 <span class="comment"></span>
<a name="l03951"></a>03951 <span class="comment">      in addition, the locks _must_ be taken in this order, because there are already</span>
<a name="l03952"></a>03952 <span class="comment">      other code paths that use this order</span>
<a name="l03953"></a>03953 <span class="comment">   */</span>
<a name="l03954"></a>03954    <a class="code" href="pbx_8c.html#6f41efd0c2fa84486ef11fef33681139">ast_wrlock_contexts</a>();
<a name="l03955"></a>03955    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;hints);
<a name="l03956"></a>03956 
<a name="l03957"></a>03957    <span class="comment">/* preserve all watchers for hints associated with this registrar */</span>
<a name="l03958"></a>03958    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;hints, hint, list) {
<a name="l03959"></a>03959       <span class="keywordflow">if</span> (hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a> &amp;&amp; !strcmp(<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>, hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>-&gt;<a class="code" href="structast__exten.html#d0e45878043844ffc41aac437e86b602">parent</a>-&gt;<a class="code" href="structast__context.html#5940569cd1d60781f856f93235b072ee">registrar</a>)) {
<a name="l03960"></a>03960          length = strlen(hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>) + strlen(hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>-&gt;<a class="code" href="structast__exten.html#d0e45878043844ffc41aac437e86b602">parent</a>-&gt;name) + 2 + <span class="keyword">sizeof</span>(*this);
<a name="l03961"></a>03961          <span class="keywordflow">if</span> (!(<span class="keyword">this</span> = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, length)))
<a name="l03962"></a>03962             <span class="keywordflow">continue</span>;
<a name="l03963"></a>03963          this-&gt;callbacks = hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a>;
<a name="l03964"></a>03964          hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a> = NULL;
<a name="l03965"></a>03965          this-&gt;laststate = hint-&gt;<a class="code" href="structast__hint.html#406c995dd8ced9add7c7f6eb95532fe7">laststate</a>;
<a name="l03966"></a>03966          this-&gt;<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a> = this-&gt;<a class="code" href="structast__state__cb.html#8d777f385d3dfec8815d20f7496026dc">data</a>;
<a name="l03967"></a>03967          strcpy(this-&gt;data, hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>-&gt;<a class="code" href="structast__exten.html#d0e45878043844ffc41aac437e86b602">parent</a>-&gt;name);
<a name="l03968"></a>03968          this-&gt;exten = this-&gt;<a class="code" href="structast__state__cb.html#8d777f385d3dfec8815d20f7496026dc">data</a> + strlen(this-&gt;context) + 1;
<a name="l03969"></a>03969          strcpy(this-&gt;exten, hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>-&gt;<a class="code" href="structast__exten.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a>);
<a name="l03970"></a>03970          <a class="code" href="linkedlists_8h.html#5df56040a8838bdc841ef8eb179b7609">AST_LIST_INSERT_HEAD</a>(&amp;store, <span class="keyword">this</span>, list);
<a name="l03971"></a>03971       }
<a name="l03972"></a>03972    }
<a name="l03973"></a>03973 
<a name="l03974"></a>03974    tmp = *extcontexts;
<a name="l03975"></a>03975    <span class="keywordflow">if</span> (<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>) {
<a name="l03976"></a>03976       <span class="comment">/* XXX remove previous contexts from same registrar */</span>
<a name="l03977"></a>03977       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a>)
<a name="l03978"></a>03978          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"must remove any reg %s\n"</span>, <a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l03979"></a>03979       <a class="code" href="pbx_8c.html#e2faf43e79194dd93e6200a86f08d563">__ast_context_destroy</a>(NULL,<a class="code" href="pbx__ael_8c.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l03980"></a>03980       <span class="keywordflow">while</span> (tmp) {
<a name="l03981"></a>03981          lasttmp = tmp;
<a name="l03982"></a>03982          tmp = tmp-&gt;<a class="code" href="structast__context.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l03983"></a>03983       }
<a name="l03984"></a>03984    } <span class="keywordflow">else</span> {
<a name="l03985"></a>03985       <span class="comment">/* XXX remove contexts with the same name */</span>
<a name="l03986"></a>03986       <span class="keywordflow">while</span> (tmp) {
<a name="l03987"></a>03987          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"must remove %s  reg %s\n"</span>, tmp-&gt;name, tmp-&gt;<a class="code" href="structast__context.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l03988"></a>03988          <a class="code" href="pbx_8c.html#e2faf43e79194dd93e6200a86f08d563">__ast_context_destroy</a>(tmp,tmp-&gt;<a class="code" href="structast__context.html#5940569cd1d60781f856f93235b072ee">registrar</a>);
<a name="l03989"></a>03989          lasttmp = tmp;
<a name="l03990"></a>03990          tmp = tmp-&gt;<a class="code" href="structast__context.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l03991"></a>03991       }
<a name="l03992"></a>03992    }
<a name="l03993"></a>03993    <span class="keywordflow">if</span> (lasttmp) {
<a name="l03994"></a>03994       lasttmp-&gt;<a class="code" href="structast__context.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = <a class="code" href="pbx_8c.html#9be90dc64c1f5b5c993ff11d732a8da0">contexts</a>;
<a name="l03995"></a>03995       <a class="code" href="pbx_8c.html#9be90dc64c1f5b5c993ff11d732a8da0">contexts</a> = *extcontexts;
<a name="l03996"></a>03996       *extcontexts = NULL;
<a name="l03997"></a>03997    } <span class="keywordflow">else</span>
<a name="l03998"></a>03998       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Requested contexts didn't get merged\n"</span>);
<a name="l03999"></a>03999 
<a name="l04000"></a>04000    <span class="comment">/* restore the watchers for hints that can be found; notify those that</span>
<a name="l04001"></a>04001 <span class="comment">      cannot be restored</span>
<a name="l04002"></a>04002 <span class="comment">   */</span>
<a name="l04003"></a>04003    <span class="keywordflow">while</span> ((<span class="keyword">this</span> = <a class="code" href="linkedlists_8h.html#beec347da29fe6b0d7fdb3e80b851f90">AST_LIST_REMOVE_HEAD</a>(&amp;store, list))) {
<a name="l04004"></a>04004       exten = <a class="code" href="pbx_8c.html#a4691f6ae9689498c10c695381f36103">ast_hint_extension</a>(NULL, this-&gt;context, this-&gt;exten);
<a name="l04005"></a>04005       <span class="comment">/* Find the hint in the list of hints */</span>
<a name="l04006"></a>04006       <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;hints, hint, list) {
<a name="l04007"></a>04007          <span class="keywordflow">if</span> (hint-&gt;<a class="code" href="structast__hint.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a> == exten)
<a name="l04008"></a>04008             <span class="keywordflow">break</span>;
<a name="l04009"></a>04009       }
<a name="l04010"></a>04010       <span class="keywordflow">if</span> (!exten || !hint) {
<a name="l04011"></a>04011          <span class="comment">/* this hint has been removed, notify the watchers */</span>
<a name="l04012"></a>04012          prevcb = NULL;
<a name="l04013"></a>04013          thiscb = this-&gt;callbacks;
<a name="l04014"></a>04014          <span class="keywordflow">while</span> (thiscb) {
<a name="l04015"></a>04015             prevcb = thiscb;
<a name="l04016"></a>04016             thiscb = thiscb-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l04017"></a>04017             prevcb-&gt;<a class="code" href="structast__state__cb.html#924a8ceeac17f54d3be3f8cdf1c04eb2">callback</a>(this-&gt;context, this-&gt;exten, <a class="code" href="pbx_8h.html#f571613d99899b77c0f4d4c18f112f7564c0d9d79bfb21b4578eb245ddcecd9a">AST_EXTENSION_REMOVED</a>, prevcb-&gt;<a class="code" href="structast__state__cb.html#8d777f385d3dfec8815d20f7496026dc">data</a>);
<a name="l04018"></a>04018             <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(prevcb);
<a name="l04019"></a>04019             }
<a name="l04020"></a>04020       } <span class="keywordflow">else</span> {
<a name="l04021"></a>04021          thiscb = this-&gt;callbacks;
<a name="l04022"></a>04022          <span class="keywordflow">while</span> (thiscb-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>)
<a name="l04023"></a>04023             thiscb = thiscb-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l04024"></a>04024          thiscb-&gt;<a class="code" href="structast__state__cb.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> = hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a>;
<a name="l04025"></a>04025          hint-&gt;<a class="code" href="structast__hint.html#89885eff552e13893a0dade8efb1b731">callbacks</a> = this-&gt;callbacks;
<a name="l04026"></a>04026          hint-&gt;<a class="code" href="structast__hint.html#406c995dd8ced9add7c7f6eb95532fe7">laststate</a> = this-&gt;laststate;
<a name="l04027"></a>04027       }
<a name="l04028"></a>04028       <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(<span class="keyword">this</span>);
<a name="l04029"></a>04029    }
<a name="l04030"></a>04030 
<a name="l04031"></a>04031    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;hints);
<a name="l04032"></a>04032    <a class="code" href="pbx_8c.html#dc1d3ecafa5a93767dd4ed321ed91d10">ast_unlock_contexts</a>();
<a name="l04033"></a>04033 
<a name="l04034"></a>04034    <span class="keywordflow">return</span>;
<a name="l04035"></a>04035 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="86eba1ec3178373f61c082e1f1f12b68"></a><!-- doxytag: member="pbx.h::ast_parseable_goto" ref="86eba1ec3178373f61c082e1f1f12b68" args="(struct ast_channel *chan, const char *goto_string)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_parseable_goto           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>goto_string</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06287">6287</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="cdr_8c-source.html#l00885">ast_cdr_update()</a>, <a class="el" href="pbx_8c-source.html#l04576">ast_explicit_goto()</a>, <a class="el" href="pbx_8c-source.html#l02188">ast_findlabel_extension()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="channel_8h-source.html#l00437">ast_channel::cid</a>, <a class="el" href="channel_8h-source.html#l00212">ast_callerid::cid_num</a>, <a class="el" href="channel_8h-source.html#l00441">ast_channel::context</a>, <a class="el" href="channel_8h-source.html#l00442">ast_channel::exten</a>, <a class="el" href="chan__alsa_8c-source.html#l00126">exten</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="channel_8h-source.html#l00443">ast_channel::priority</a>, and <a class="el" href="strcompat_8c-source.html#l00035">strsep()</a>.
<p>
Referenced by <a class="el" href="app__while_8c-source.html#l00164">_while_exec()</a>, <a class="el" href="res__features_8c-source.html#l00192">check_goto_on_transfer()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="app__stack_8c-source.html#l00193">gosub_exec()</a>, <a class="el" href="app_8c-source.html#l01149">ivr_dispatch()</a>, <a class="el" href="pbx_8c-source.html#l05725">pbx_builtin_goto()</a>, <a class="el" href="app__rpt_8c-source.html#l06759">rpt_exec()</a>, and <a class="el" href="app__while_8c-source.html#l00290">while_continue_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l06288"></a>06288 {
<a name="l06289"></a>06289    <span class="keywordtype">char</span> *<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, *pri, *<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>;
<a name="l06290"></a>06290    <span class="keywordtype">char</span> *stringp;
<a name="l06291"></a>06291    <span class="keywordtype">int</span> ipri;
<a name="l06292"></a>06292    <span class="keywordtype">int</span> mode = 0;
<a name="l06293"></a>06293 
<a name="l06294"></a>06294    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(goto_string)) {
<a name="l06295"></a>06295       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Goto requires an argument (optional context|optional extension|priority)\n"</span>);
<a name="l06296"></a>06296       <span class="keywordflow">return</span> -1;
<a name="l06297"></a>06297    }
<a name="l06298"></a>06298    stringp = <a class="code" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>(goto_string);
<a name="l06299"></a>06299    context = <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;stringp, <span class="stringliteral">"|"</span>); <span class="comment">/* guaranteed non-null */</span>
<a name="l06300"></a>06300    exten = <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;stringp, <span class="stringliteral">"|"</span>);
<a name="l06301"></a>06301    pri = <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;stringp, <span class="stringliteral">"|"</span>);
<a name="l06302"></a>06302    <span class="keywordflow">if</span> (!exten) {  <span class="comment">/* Only a priority in this one */</span>
<a name="l06303"></a>06303       pri = context;
<a name="l06304"></a>06304       exten = NULL;
<a name="l06305"></a>06305       context = NULL;
<a name="l06306"></a>06306    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!pri) {   <span class="comment">/* Only an extension and priority in this one */</span>
<a name="l06307"></a>06307       pri = exten;
<a name="l06308"></a>06308       exten = context;
<a name="l06309"></a>06309       context = NULL;
<a name="l06310"></a>06310    }
<a name="l06311"></a>06311    <span class="keywordflow">if</span> (*pri == <span class="charliteral">'+'</span>) {
<a name="l06312"></a>06312       mode = 1;
<a name="l06313"></a>06313       pri++;
<a name="l06314"></a>06314    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*pri == <span class="charliteral">'-'</span>) {
<a name="l06315"></a>06315       mode = -1;
<a name="l06316"></a>06316       pri++;
<a name="l06317"></a>06317    }
<a name="l06318"></a>06318    <span class="keywordflow">if</span> (sscanf(pri, <span class="stringliteral">"%d"</span>, &amp;ipri) != 1) {
<a name="l06319"></a>06319       <span class="keywordflow">if</span> ((ipri = <a class="code" href="pbx_8c.html#6f1b63f69b489517c49ccfecdbe1642e">ast_findlabel_extension</a>(chan, context ? context : chan-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, exten ? exten : chan-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>,
<a name="l06320"></a>06320          pri, chan-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#64191918d2ec3d68a26f486c5d134221">cid_num</a>)) &lt; 1) {
<a name="l06321"></a>06321          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Priority '%s' must be a number &gt; 0, or valid label\n"</span>, pri);
<a name="l06322"></a>06322          <span class="keywordflow">return</span> -1;
<a name="l06323"></a>06323       } <span class="keywordflow">else</span>
<a name="l06324"></a>06324          mode = 0;
<a name="l06325"></a>06325    }
<a name="l06326"></a>06326    <span class="comment">/* At this point we have a priority and maybe an extension and a context */</span>
<a name="l06327"></a>06327 
<a name="l06328"></a>06328    <span class="keywordflow">if</span> (mode)
<a name="l06329"></a>06329       ipri = chan-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a> + (ipri * mode);
<a name="l06330"></a>06330 
<a name="l06331"></a>06331    <a class="code" href="pbx_8c.html#1e0079c7f2934dd7ebe801fefe4057da">ast_explicit_goto</a>(chan, context, exten, ipri);
<a name="l06332"></a>06332    <a class="code" href="cdr_8c.html#0247fba893abcaf42f3861b4982361db">ast_cdr_update</a>(chan);
<a name="l06333"></a>06333    <span class="keywordflow">return</span> 0;
<a name="l06334"></a>06334 
<a name="l06335"></a>06335 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8bd05d7cdf218eaecfb4a33dd0eb32d8"></a><!-- doxytag: member="pbx.h::ast_pbx_outgoing_app" ref="8bd05d7cdf218eaecfb4a33dd0eb32d8" args="(const char *type, int format, void *data, int timeout, const char *app, const char *appdata, int *reason, int sync, const char *cid_num, const char *cid_name, struct ast_variable *vars, const char *account, struct ast_channel **locked_channel)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_pbx_outgoing_app           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>timeout</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>app</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>appdata</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>reason</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>sync</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cid_num</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cid_name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__variable.html">ast_variable</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>vars</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>account</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__channel.html">ast_channel</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>locked_channel</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Synchronously or asynchronously make an outbound call and send it to a particular application with given extension 
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05150">5150</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="cdr_8c-source.html#l00460">ast_cdr_alloc()</a>, <a class="el" href="cdr_8c-source.html#l00684">ast_cdr_disposition()</a>, <a class="el" href="cdr_8c-source.html#l00657">ast_cdr_failed()</a>, <a class="el" href="cdr_8c-source.html#l00763">ast_cdr_init()</a>, <a class="el" href="cdr_8c-source.html#l00834">ast_cdr_setaccount()</a>, <a class="el" href="cdr_8c-source.html#l00620">ast_cdr_start()</a>, <a class="el" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="channel_8c-source.html#l01598">ast_hangup()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="pbx_8c-source.html#l04966">ast_pbx_outgoing_cdr_failed()</a>, <a class="el" href="pbx_8c-source.html#l05134">ast_pbx_run_app()</a>, <a class="el" href="utils_8h-source.html#l00302">ast_pthread_create_detached</a>, <a class="el" href="channel_8c-source.html#l04486">ast_set_variables()</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="config_8c-source.html#l00211">ast_variables_destroy()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="pbx_8c-source.html#l04903">async_wait()</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="channel_8h-source.html#l00449">ast_channel::pbx</a>, and <a class="el" href="logger_8h-source.html#l00046">VERBOSE_PREFIX_4</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l01912">action_originate()</a>, <a class="el" href="pbx__spool_8c-source.html#l00327">attempt_thread()</a>, <a class="el" href="manager_8c-source.html#l01850">fast_originate()</a>, and <a class="el" href="res__clioriginate_8c-source.html#l00072">orig_app()</a>.<div class="fragment"><pre class="fragment"><a name="l05151"></a>05151 {
<a name="l05152"></a>05152    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>;
<a name="l05153"></a>05153    <span class="keyword">struct </span><a class="code" href="structapp__tmp.html">app_tmp</a> *tmp;
<a name="l05154"></a>05154    <span class="keywordtype">int</span> res = -1, cdr_res = -1;
<a name="l05155"></a>05155    <span class="keyword">struct </span><a class="code" href="structoutgoing__helper.html">outgoing_helper</a> oh;
<a name="l05156"></a>05156 
<a name="l05157"></a>05157    memset(&amp;oh, 0, <span class="keyword">sizeof</span>(oh));
<a name="l05158"></a>05158    oh.<a class="code" href="structoutgoing__helper.html#b63119da730344b345cdc8f62a4711e9">vars</a> = vars;
<a name="l05159"></a>05159    oh.<a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a> = <a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a>;
<a name="l05160"></a>05160 
<a name="l05161"></a>05161    <span class="keywordflow">if</span> (locked_channel)
<a name="l05162"></a>05162       *locked_channel = NULL;
<a name="l05163"></a>05163    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(<a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>)) {
<a name="l05164"></a>05164       res = -1;
<a name="l05165"></a>05165       <span class="keywordflow">goto</span> outgoing_app_cleanup;
<a name="l05166"></a>05166    }
<a name="l05167"></a>05167    <span class="keywordflow">if</span> (sync) {
<a name="l05168"></a>05168       chan = <a class="code" href="channel_8c.html#8537f62a5cf4153cbafae491fb365303">__ast_request_and_dial</a>(<a class="code" href="rtp_8c.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, <a class="code" href="chan__alsa_8c.html#1ddcb92ade31c8fbd370001f9b29a7d9">format</a>, data, timeout, reason, <a class="code" href="chan__mgcp_8c.html#ca3c0eb6b6e898f3a32aed5de1320774">cid_num</a>, <a class="code" href="chan__mgcp_8c.html#70f178a59d8df82fe5e107da71415b9b">cid_name</a>, &amp;oh);
<a name="l05169"></a>05169       <span class="keywordflow">if</span> (chan) {
<a name="l05170"></a>05170          <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>) { <span class="comment">/* check if the channel already has a cdr record, if not give it one */</span>
<a name="l05171"></a>05171             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"%s already has a call record??\n"</span>, chan-&gt;name);
<a name="l05172"></a>05172          } <span class="keywordflow">else</span> {
<a name="l05173"></a>05173             chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a> = <a class="code" href="cdr_8c.html#0dd431954a27c67f78c6e13be8a0b136">ast_cdr_alloc</a>();   <span class="comment">/* allocate a cdr for the channel */</span>
<a name="l05174"></a>05174             <span class="keywordflow">if</span> (!chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>) {
<a name="l05175"></a>05175                <span class="comment">/* allocation of the cdr failed */</span>
<a name="l05176"></a>05176                <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(chan-&gt;<a class="code" href="structast__channel.html#569f7a090087f9e7071a247a24ea0809">pbx</a>);
<a name="l05177"></a>05177                res = -1;
<a name="l05178"></a>05178                <span class="keywordflow">goto</span> outgoing_app_cleanup;
<a name="l05179"></a>05179             }
<a name="l05180"></a>05180             <span class="comment">/* allocation of the cdr was successful */</span>
<a name="l05181"></a>05181             <a class="code" href="cdr_8c.html#4d85bb268956ffbf0b19df25915726e8">ast_cdr_init</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>, chan);  <span class="comment">/* initialize our channel's cdr */</span>
<a name="l05182"></a>05182             <a class="code" href="cdr_8c.html#56e1b7b9d5acada4d22d345813710582">ast_cdr_start</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>);
<a name="l05183"></a>05183          }
<a name="l05184"></a>05184          <a class="code" href="channel_8c.html#ee674fb53b907cc57dda6e54ac24a637">ast_set_variables</a>(chan, vars);
<a name="l05185"></a>05185          <span class="keywordflow">if</span> (<a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a>)
<a name="l05186"></a>05186             <a class="code" href="cdr_8c.html#8aa58d36e6bd15ba7d10e367d9870e60">ast_cdr_setaccount</a>(chan, <a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a>);
<a name="l05187"></a>05187          <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a> == <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>) {
<a name="l05188"></a>05188             res = 0;
<a name="l05189"></a>05189             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 3)
<a name="l05190"></a>05190                <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#8f25f582e7a737b25f607fb6ad653807">VERBOSE_PREFIX_4</a> <span class="stringliteral">"Channel %s was answered.\n"</span>, chan-&gt;name);
<a name="l05191"></a>05191             tmp = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*tmp));
<a name="l05192"></a>05192             <span class="keywordflow">if</span> (!tmp)
<a name="l05193"></a>05193                res = -1;
<a name="l05194"></a>05194             <span class="keywordflow">else</span> {
<a name="l05195"></a>05195                ast_copy_string(tmp-&gt;<a class="code" href="structapp__tmp.html#c43b13e5c8f54532967ff0925bb74a16">app</a>, <a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>, <span class="keyword">sizeof</span>(tmp-&gt;<a class="code" href="structapp__tmp.html#c43b13e5c8f54532967ff0925bb74a16">app</a>));
<a name="l05196"></a>05196                <span class="keywordflow">if</span> (appdata)
<a name="l05197"></a>05197                   ast_copy_string(tmp-&gt;<a class="code" href="structapp__tmp.html#e7232ed861fc8b075649bf08d405e789">data</a>, appdata, <span class="keyword">sizeof</span>(tmp-&gt;<a class="code" href="structapp__tmp.html#e7232ed861fc8b075649bf08d405e789">data</a>));
<a name="l05198"></a>05198                tmp-&gt;<a class="code" href="structapp__tmp.html#26c322652770620e64ac90682eb6504c">chan</a> = chan;
<a name="l05199"></a>05199                <span class="keywordflow">if</span> (sync &gt; 1) {
<a name="l05200"></a>05200                   <span class="keywordflow">if</span> (locked_channel)
<a name="l05201"></a>05201                      <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l05202"></a>05202                   <a class="code" href="pbx_8c.html#38fb34f5a491b6b51279535ef9ba6620">ast_pbx_run_app</a>(tmp);
<a name="l05203"></a>05203                } <span class="keywordflow">else</span> {
<a name="l05204"></a>05204                   <span class="keywordflow">if</span> (locked_channel)
<a name="l05205"></a>05205                      <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l05206"></a>05206                   <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#97e9ed35da1f19087b177cdffdf53c97">ast_pthread_create_detached</a>(&amp;tmp-&gt;<a class="code" href="structapp__tmp.html#e358efa489f58062f10dd7316b65649e">t</a>, NULL, <a class="code" href="pbx_8c.html#38fb34f5a491b6b51279535ef9ba6620">ast_pbx_run_app</a>, tmp)) {
<a name="l05207"></a>05207                      <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Unable to spawn execute thread on %s: %s\n"</span>, chan-&gt;name, strerror(errno));
<a name="l05208"></a>05208                      <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(tmp);
<a name="l05209"></a>05209                      <span class="keywordflow">if</span> (locked_channel)
<a name="l05210"></a>05210                         <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l05211"></a>05211                      <a class="code" href="channel_8c.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a>(chan);
<a name="l05212"></a>05212                      res = -1;
<a name="l05213"></a>05213                   } <span class="keywordflow">else</span> {
<a name="l05214"></a>05214                      <span class="keywordflow">if</span> (locked_channel)
<a name="l05215"></a>05215                         *locked_channel = chan;
<a name="l05216"></a>05216                   }
<a name="l05217"></a>05217                }
<a name="l05218"></a>05218             }
<a name="l05219"></a>05219          } <span class="keywordflow">else</span> {
<a name="l05220"></a>05220             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 3)
<a name="l05221"></a>05221                <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#8f25f582e7a737b25f607fb6ad653807">VERBOSE_PREFIX_4</a> <span class="stringliteral">"Channel %s was never answered.\n"</span>, chan-&gt;name);
<a name="l05222"></a>05222             <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>) { <span class="comment">/* update the cdr */</span>
<a name="l05223"></a>05223                <span class="comment">/* here we update the status of the call, which sould be busy.</span>
<a name="l05224"></a>05224 <span class="comment">                * if that fails then we set the status to failed */</span>
<a name="l05225"></a>05225                <span class="keywordflow">if</span> (<a class="code" href="cdr_8c.html#995ca95113dc7070faca1a0969a72eb9">ast_cdr_disposition</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>, chan-&gt;<a class="code" href="structast__channel.html#8be5f831332d8ff714e90c2cf85171fe">hangupcause</a>))
<a name="l05226"></a>05226                   <a class="code" href="cdr_8c.html#3f2e573eb7fde7a250ca8aa95a0d367d">ast_cdr_failed</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>);
<a name="l05227"></a>05227             }
<a name="l05228"></a>05228             <a class="code" href="channel_8c.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a>(chan);
<a name="l05229"></a>05229          }
<a name="l05230"></a>05230       }
<a name="l05231"></a>05231 
<a name="l05232"></a>05232       <span class="keywordflow">if</span> (res &lt; 0) { <span class="comment">/* the call failed for some reason */</span>
<a name="l05233"></a>05233          <span class="keywordflow">if</span> (*reason == 0) { <span class="comment">/* if the call failed (not busy or no answer)</span>
<a name="l05234"></a>05234 <span class="comment">                        * update the cdr with the failed message */</span>
<a name="l05235"></a>05235             cdr_res = <a class="code" href="pbx_8c.html#09a9b482db62db9b75905bfad1c77ef1">ast_pbx_outgoing_cdr_failed</a>();
<a name="l05236"></a>05236             <span class="keywordflow">if</span> (cdr_res != 0) {
<a name="l05237"></a>05237                res = cdr_res;
<a name="l05238"></a>05238                <span class="keywordflow">goto</span> outgoing_app_cleanup;
<a name="l05239"></a>05239             }
<a name="l05240"></a>05240          }
<a name="l05241"></a>05241       }
<a name="l05242"></a>05242 
<a name="l05243"></a>05243    } <span class="keywordflow">else</span> {
<a name="l05244"></a>05244       <span class="keyword">struct </span><a class="code" href="structasync__stat.html">async_stat</a> *as;
<a name="l05245"></a>05245       <span class="keywordflow">if</span> (!(as = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*as)))) {
<a name="l05246"></a>05246          res = -1;
<a name="l05247"></a>05247          <span class="keywordflow">goto</span> outgoing_app_cleanup;
<a name="l05248"></a>05248       }
<a name="l05249"></a>05249       chan = <a class="code" href="channel_8c.html#8537f62a5cf4153cbafae491fb365303">__ast_request_and_dial</a>(<a class="code" href="rtp_8c.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, <a class="code" href="chan__alsa_8c.html#1ddcb92ade31c8fbd370001f9b29a7d9">format</a>, data, <a class="code" href="structasync__stat.html#90272dda245ae1fb3cf197e91a8689dc">timeout</a>, reason, <a class="code" href="chan__mgcp_8c.html#ca3c0eb6b6e898f3a32aed5de1320774">cid_num</a>, <a class="code" href="chan__mgcp_8c.html#70f178a59d8df82fe5e107da71415b9b">cid_name</a>, &amp;oh);
<a name="l05250"></a>05250       <span class="keywordflow">if</span> (!chan) {
<a name="l05251"></a>05251          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(as);
<a name="l05252"></a>05252          res = -1;
<a name="l05253"></a>05253          <span class="keywordflow">goto</span> outgoing_app_cleanup;
<a name="l05254"></a>05254       }
<a name="l05255"></a>05255       as-&gt;chan = chan;
<a name="l05256"></a>05256       ast_copy_string(as-&gt;app, <a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>, <span class="keyword">sizeof</span>(as-&gt;app));
<a name="l05257"></a>05257       <span class="keywordflow">if</span> (<a class="code" href="structasync__stat.html#ffa091f1a08de73baae354df77b07668">appdata</a>)
<a name="l05258"></a>05258          ast_copy_string(as-&gt;appdata,  <a class="code" href="structasync__stat.html#ffa091f1a08de73baae354df77b07668">appdata</a>, <span class="keyword">sizeof</span>(as-&gt;appdata));
<a name="l05259"></a>05259       as-&gt;timeout = <a class="code" href="structasync__stat.html#90272dda245ae1fb3cf197e91a8689dc">timeout</a>;
<a name="l05260"></a>05260       <a class="code" href="channel_8c.html#ee674fb53b907cc57dda6e54ac24a637">ast_set_variables</a>(chan, vars);
<a name="l05261"></a>05261       <span class="keywordflow">if</span> (account)
<a name="l05262"></a>05262          <a class="code" href="cdr_8c.html#8aa58d36e6bd15ba7d10e367d9870e60">ast_cdr_setaccount</a>(chan, account);
<a name="l05263"></a>05263       <span class="comment">/* Start a new thread, and get something handling this channel. */</span>
<a name="l05264"></a>05264       <span class="keywordflow">if</span> (locked_channel)
<a name="l05265"></a>05265          <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l05266"></a>05266       <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#97e9ed35da1f19087b177cdffdf53c97">ast_pthread_create_detached</a>(&amp;as-&gt;p, NULL, <a class="code" href="pbx_8c.html#23af98d69a15a8250c44aaea18d487af">async_wait</a>, as)) {
<a name="l05267"></a>05267          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Failed to start async wait\n"</span>);
<a name="l05268"></a>05268          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(as);
<a name="l05269"></a>05269          <span class="keywordflow">if</span> (locked_channel)
<a name="l05270"></a>05270             <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l05271"></a>05271          <a class="code" href="channel_8c.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a>(chan);
<a name="l05272"></a>05272          res = -1;
<a name="l05273"></a>05273          <span class="keywordflow">goto</span> outgoing_app_cleanup;
<a name="l05274"></a>05274       } <span class="keywordflow">else</span> {
<a name="l05275"></a>05275          <span class="keywordflow">if</span> (locked_channel)
<a name="l05276"></a>05276             *locked_channel = chan;
<a name="l05277"></a>05277       }
<a name="l05278"></a>05278       res = 0;
<a name="l05279"></a>05279    }
<a name="l05280"></a>05280 outgoing_app_cleanup:
<a name="l05281"></a>05281    <a class="code" href="config_8c.html#d616f18584600c70e8744e217c03407c">ast_variables_destroy</a>(vars);
<a name="l05282"></a>05282    <span class="keywordflow">return</span> res;
<a name="l05283"></a>05283 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6258fddab1409e4a7b96577ece3f2364"></a><!-- doxytag: member="pbx.h::ast_pbx_outgoing_exten" ref="6258fddab1409e4a7b96577ece3f2364" args="(const char *type, int format, void *data, int timeout, const char *context, const char *exten, int priority, int *reason, int sync, const char *cid_num, const char *cid_name, struct ast_variable *vars, const char *account, struct ast_channel **locked_channel)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_pbx_outgoing_exten           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>timeout</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>reason</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>sync</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cid_num</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cid_name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__variable.html">ast_variable</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>vars</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>account</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__channel.html">ast_channel</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>locked_channel</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Synchronously or asynchronously make an outbound call and send it to a particular extension 
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l04991">4991</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="channel_8c-source.html#l02932">__ast_request_and_dial()</a>, <a class="el" href="channel_8h-source.html#l00435">ast_channel::_state</a>, <a class="el" href="channel_8h-source.html#l00578">outgoing_helper::account</a>, <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="cdr_8c-source.html#l00684">ast_cdr_disposition()</a>, <a class="el" href="cdr_8c-source.html#l00657">ast_cdr_failed()</a>, <a class="el" href="cdr_8c-source.html#l00834">ast_cdr_setaccount()</a>, <a class="el" href="channel_8c-source.html#l00632">ast_channel_alloc()</a>, <a class="el" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="pbx_8c-source.html#l02183">ast_exists_extension()</a>, <a class="el" href="channel_8c-source.html#l01598">ast_hangup()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="pbx_8c-source.html#l04966">ast_pbx_outgoing_cdr_failed()</a>, <a class="el" href="pbx_8c-source.html#l02572">ast_pbx_run()</a>, <a class="el" href="pbx_8c-source.html#l02551">ast_pbx_start()</a>, <a class="el" href="utils_8h-source.html#l00302">ast_pthread_create_detached</a>, <a class="el" href="channel_8c-source.html#l03058">ast_request_and_dial()</a>, <a class="el" href="channel_8c-source.html#l04486">ast_set_variables()</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a3c9bf8b90a4d4f25fc98dd1360bba58b">AST_STATE_DOWN</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>, <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>, <a class="el" href="config_8c-source.html#l00211">ast_variables_destroy()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="pbx_8c-source.html#l04903">async_wait()</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, <a class="el" href="channel_8h-source.html#l00577">outgoing_helper::cid_name</a>, <a class="el" href="channel_8h-source.html#l00576">outgoing_helper::cid_num</a>, <a class="el" href="channel_8h-source.html#l00441">ast_channel::context</a>, <a class="el" href="channel_8h-source.html#l00573">outgoing_helper::context</a>, <a class="el" href="channel_8h-source.html#l00574">outgoing_helper::exten</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="channel_8h-source.html#l00466">ast_channel::hangupcause</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="channel_8h-source.html#l00580">outgoing_helper::parent_channel</a>, <a class="el" href="channel_8h-source.html#l00575">outgoing_helper::priority</a>, <a class="el" href="pbx_8c-source.html#l02214">set_ext_pri()</a>, <a class="el" href="channel_8h-source.html#l00579">outgoing_helper::vars</a>, and <a class="el" href="logger_8h-source.html#l00046">VERBOSE_PREFIX_4</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l01912">action_originate()</a>, <a class="el" href="pbx__spool_8c-source.html#l00327">attempt_thread()</a>, <a class="el" href="manager_8c-source.html#l01850">fast_originate()</a>, and <a class="el" href="res__clioriginate_8c-source.html#l00094">orig_exten()</a>.<div class="fragment"><pre class="fragment"><a name="l04992"></a>04992 {
<a name="l04993"></a>04993    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>;
<a name="l04994"></a>04994    <span class="keyword">struct </span><a class="code" href="structasync__stat.html">async_stat</a> *as;
<a name="l04995"></a>04995    <span class="keywordtype">int</span> res = -1, cdr_res = -1;
<a name="l04996"></a>04996    <span class="keyword">struct </span><a class="code" href="structoutgoing__helper.html">outgoing_helper</a> oh;
<a name="l04997"></a>04997 
<a name="l04998"></a>04998    <span class="keywordflow">if</span> (sync) {
<a name="l04999"></a>04999       oh.<a class="code" href="structoutgoing__helper.html#5c18ef72771564b7f43c497dc507aeab">context</a> = <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>;
<a name="l05000"></a>05000       oh.<a class="code" href="structoutgoing__helper.html#3963aa6c69c239f72ae38e92b2ce0f48">exten</a> = <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>;
<a name="l05001"></a>05001       oh.<a class="code" href="structoutgoing__helper.html#b988295c268025b49dfb3df26171ddc3">priority</a> = <a class="code" href="structoutgoing__helper.html#b988295c268025b49dfb3df26171ddc3">priority</a>;
<a name="l05002"></a>05002       oh.<a class="code" href="structoutgoing__helper.html#64191918d2ec3d68a26f486c5d134221">cid_num</a> = <a class="code" href="chan__mgcp_8c.html#ca3c0eb6b6e898f3a32aed5de1320774">cid_num</a>;
<a name="l05003"></a>05003       oh.<a class="code" href="structoutgoing__helper.html#51ae63e8ccffb05b130f96cc397ec7b0">cid_name</a> = <a class="code" href="chan__mgcp_8c.html#70f178a59d8df82fe5e107da71415b9b">cid_name</a>;
<a name="l05004"></a>05004       oh.<a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a> = <a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a>;
<a name="l05005"></a>05005       oh.<a class="code" href="structoutgoing__helper.html#b63119da730344b345cdc8f62a4711e9">vars</a> = vars;
<a name="l05006"></a>05006       oh.<a class="code" href="structoutgoing__helper.html#61b4aeaf61a5a027c4783915d73aa2ae">parent_channel</a> = NULL;
<a name="l05007"></a>05007 
<a name="l05008"></a>05008       chan = <a class="code" href="channel_8c.html#8537f62a5cf4153cbafae491fb365303">__ast_request_and_dial</a>(<a class="code" href="rtp_8c.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, <a class="code" href="chan__alsa_8c.html#1ddcb92ade31c8fbd370001f9b29a7d9">format</a>, data, timeout, reason, <a class="code" href="chan__mgcp_8c.html#ca3c0eb6b6e898f3a32aed5de1320774">cid_num</a>, <a class="code" href="chan__mgcp_8c.html#70f178a59d8df82fe5e107da71415b9b">cid_name</a>, &amp;oh);
<a name="l05009"></a>05009       <span class="keywordflow">if</span> (channel) {
<a name="l05010"></a>05010          *channel = chan;
<a name="l05011"></a>05011          <span class="keywordflow">if</span> (chan)
<a name="l05012"></a>05012             <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l05013"></a>05013       }
<a name="l05014"></a>05014       <span class="keywordflow">if</span> (chan) {
<a name="l05015"></a>05015          <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a> == <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87aea66d48cb3e294b70a35486fb5fe2ce6">AST_STATE_UP</a>) {
<a name="l05016"></a>05016                res = 0;
<a name="l05017"></a>05017             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 3)
<a name="l05018"></a>05018                <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#8f25f582e7a737b25f607fb6ad653807">VERBOSE_PREFIX_4</a> <span class="stringliteral">"Channel %s was answered.\n"</span>, chan-&gt;name);
<a name="l05019"></a>05019 
<a name="l05020"></a>05020             <span class="keywordflow">if</span> (sync &gt; 1) {
<a name="l05021"></a>05021                <span class="keywordflow">if</span> (channel)
<a name="l05022"></a>05022                   <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l05023"></a>05023                <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#235c18a381a9501a4dc41b06b080c24f">ast_pbx_run</a>(chan)) {
<a name="l05024"></a>05024                   <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Unable to run PBX on %s\n"</span>, chan-&gt;name);
<a name="l05025"></a>05025                   <span class="keywordflow">if</span> (channel)
<a name="l05026"></a>05026                      *channel = NULL;
<a name="l05027"></a>05027                   <a class="code" href="channel_8c.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a>(chan);
<a name="l05028"></a>05028                   res = -1;
<a name="l05029"></a>05029                }
<a name="l05030"></a>05030             } <span class="keywordflow">else</span> {
<a name="l05031"></a>05031                <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#c55e82ff3dabed89efd77f20209b1006">ast_pbx_start</a>(chan)) {
<a name="l05032"></a>05032                   <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Unable to start PBX on %s\n"</span>, chan-&gt;name);
<a name="l05033"></a>05033                   <span class="keywordflow">if</span> (channel) {
<a name="l05034"></a>05034                      *channel = NULL;
<a name="l05035"></a>05035                      <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l05036"></a>05036                   }
<a name="l05037"></a>05037                   <a class="code" href="channel_8c.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a>(chan);
<a name="l05038"></a>05038                   res = -1;
<a name="l05039"></a>05039                }
<a name="l05040"></a>05040             }
<a name="l05041"></a>05041          } <span class="keywordflow">else</span> {
<a name="l05042"></a>05042             <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 3)
<a name="l05043"></a>05043                <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#8f25f582e7a737b25f607fb6ad653807">VERBOSE_PREFIX_4</a> <span class="stringliteral">"Channel %s was never answered.\n"</span>, chan-&gt;name);
<a name="l05044"></a>05044 
<a name="l05045"></a>05045             <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>) { <span class="comment">/* update the cdr */</span>
<a name="l05046"></a>05046                <span class="comment">/* here we update the status of the call, which sould be busy.</span>
<a name="l05047"></a>05047 <span class="comment">                * if that fails then we set the status to failed */</span>
<a name="l05048"></a>05048                <span class="keywordflow">if</span> (<a class="code" href="cdr_8c.html#995ca95113dc7070faca1a0969a72eb9">ast_cdr_disposition</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>, chan-&gt;<a class="code" href="structast__channel.html#8be5f831332d8ff714e90c2cf85171fe">hangupcause</a>))
<a name="l05049"></a>05049                   <a class="code" href="cdr_8c.html#3f2e573eb7fde7a250ca8aa95a0d367d">ast_cdr_failed</a>(chan-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>);
<a name="l05050"></a>05050             }
<a name="l05051"></a>05051 
<a name="l05052"></a>05052             <span class="keywordflow">if</span> (channel) {
<a name="l05053"></a>05053                *channel = NULL;
<a name="l05054"></a>05054                <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l05055"></a>05055             }
<a name="l05056"></a>05056             <a class="code" href="channel_8c.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a>(chan);
<a name="l05057"></a>05057          }
<a name="l05058"></a>05058       }
<a name="l05059"></a>05059 
<a name="l05060"></a>05060       <span class="keywordflow">if</span> (res &lt; 0) { <span class="comment">/* the call failed for some reason */</span>
<a name="l05061"></a>05061          <span class="keywordflow">if</span> (*reason == 0) { <span class="comment">/* if the call failed (not busy or no answer)</span>
<a name="l05062"></a>05062 <span class="comment">                        * update the cdr with the failed message */</span>
<a name="l05063"></a>05063             cdr_res = <a class="code" href="pbx_8c.html#09a9b482db62db9b75905bfad1c77ef1">ast_pbx_outgoing_cdr_failed</a>();
<a name="l05064"></a>05064             <span class="keywordflow">if</span> (cdr_res != 0) {
<a name="l05065"></a>05065                res = cdr_res;
<a name="l05066"></a>05066                <span class="keywordflow">goto</span> outgoing_exten_cleanup;
<a name="l05067"></a>05067             }
<a name="l05068"></a>05068          }
<a name="l05069"></a>05069 
<a name="l05070"></a>05070          <span class="comment">/* create a fake channel and execute the "failed" extension (if it exists) within the requested context */</span>
<a name="l05071"></a>05071          <span class="comment">/* check if "failed" exists */</span>
<a name="l05072"></a>05072          <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#90b58be34145fcfd99652f0c3ae7377d">ast_exists_extension</a>(chan, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <span class="stringliteral">"failed"</span>, 1, NULL)) {
<a name="l05073"></a>05073             chan = <a class="code" href="channel_8c.html#3e12df96f6a8fc8b7293ad03b29c729f">ast_channel_alloc</a>(0, <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a3c9bf8b90a4d4f25fc98dd1360bba58b">AST_STATE_DOWN</a>, 0, 0, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, 0, <span class="stringliteral">"OutgoingSpoolFailed"</span>);
<a name="l05074"></a>05074             <span class="keywordflow">if</span> (chan) {
<a name="l05075"></a>05075                <span class="keywordflow">if</span> (!<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(<a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>))
<a name="l05076"></a>05076                   ast_copy_string(chan-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <span class="keyword">sizeof</span>(chan-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>));
<a name="l05077"></a>05077                <a class="code" href="pbx_8c.html#09e258d284c6e074e06ec6e73fb5886e">set_ext_pri</a>(chan, <span class="stringliteral">"failed"</span>, 1);
<a name="l05078"></a>05078                <a class="code" href="channel_8c.html#ee674fb53b907cc57dda6e54ac24a637">ast_set_variables</a>(chan, vars);
<a name="l05079"></a>05079                <span class="keywordflow">if</span> (<a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a>)
<a name="l05080"></a>05080                   <a class="code" href="cdr_8c.html#8aa58d36e6bd15ba7d10e367d9870e60">ast_cdr_setaccount</a>(chan, <a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a>);
<a name="l05081"></a>05081                <a class="code" href="pbx_8c.html#235c18a381a9501a4dc41b06b080c24f">ast_pbx_run</a>(chan);
<a name="l05082"></a>05082             }
<a name="l05083"></a>05083          }
<a name="l05084"></a>05084       }
<a name="l05085"></a>05085    } <span class="keywordflow">else</span> {
<a name="l05086"></a>05086       <span class="keywordflow">if</span> (!(as = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*as)))) {
<a name="l05087"></a>05087          res = -1;
<a name="l05088"></a>05088          <span class="keywordflow">goto</span> outgoing_exten_cleanup;
<a name="l05089"></a>05089       }
<a name="l05090"></a>05090       chan = <a class="code" href="channel_8c.html#354090aed9318ebfbf7629d0a4e5fb7c">ast_request_and_dial</a>(<a class="code" href="rtp_8c.html#599dcce2998a6b40b1e38e8c6006cb0a">type</a>, <a class="code" href="chan__alsa_8c.html#1ddcb92ade31c8fbd370001f9b29a7d9">format</a>, data, timeout, reason, <a class="code" href="chan__mgcp_8c.html#ca3c0eb6b6e898f3a32aed5de1320774">cid_num</a>, <a class="code" href="chan__mgcp_8c.html#70f178a59d8df82fe5e107da71415b9b">cid_name</a>);
<a name="l05091"></a>05091       <span class="keywordflow">if</span> (channel) {
<a name="l05092"></a>05092          *channel = chan;
<a name="l05093"></a>05093          <span class="keywordflow">if</span> (chan)
<a name="l05094"></a>05094             <a class="code" href="lock_8h.html#0a2d3319a8f002f769ab38110cef9699">ast_channel_lock</a>(chan);
<a name="l05095"></a>05095       }
<a name="l05096"></a>05096       <span class="keywordflow">if</span> (!chan) {
<a name="l05097"></a>05097          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(as);
<a name="l05098"></a>05098          res = -1;
<a name="l05099"></a>05099          <span class="keywordflow">goto</span> outgoing_exten_cleanup;
<a name="l05100"></a>05100       }
<a name="l05101"></a>05101       as-&gt;chan = chan;
<a name="l05102"></a>05102       ast_copy_string(as-&gt;context, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <span class="keyword">sizeof</span>(as-&gt;context));
<a name="l05103"></a>05103       <a class="code" href="pbx_8c.html#09e258d284c6e074e06ec6e73fb5886e">set_ext_pri</a>(as-&gt;chan,  <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, <a class="code" href="structoutgoing__helper.html#b988295c268025b49dfb3df26171ddc3">priority</a>);
<a name="l05104"></a>05104       as-&gt;timeout = timeout;
<a name="l05105"></a>05105       <a class="code" href="channel_8c.html#ee674fb53b907cc57dda6e54ac24a637">ast_set_variables</a>(chan, vars);
<a name="l05106"></a>05106       <span class="keywordflow">if</span> (<a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a>)
<a name="l05107"></a>05107          <a class="code" href="cdr_8c.html#8aa58d36e6bd15ba7d10e367d9870e60">ast_cdr_setaccount</a>(chan, <a class="code" href="structoutgoing__helper.html#e268443e43d93dab7ebef303bbe9642f">account</a>);
<a name="l05108"></a>05108       <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#97e9ed35da1f19087b177cdffdf53c97">ast_pthread_create_detached</a>(&amp;as-&gt;p, NULL, <a class="code" href="pbx_8c.html#23af98d69a15a8250c44aaea18d487af">async_wait</a>, as)) {
<a name="l05109"></a>05109          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Failed to start async wait\n"</span>);
<a name="l05110"></a>05110          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(as);
<a name="l05111"></a>05111          <span class="keywordflow">if</span> (channel) {
<a name="l05112"></a>05112             *channel = NULL;
<a name="l05113"></a>05113             <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l05114"></a>05114          }
<a name="l05115"></a>05115          <a class="code" href="channel_8c.html#ff55e854df5692f9b3b8dc64c95a5619">ast_hangup</a>(chan);
<a name="l05116"></a>05116          res = -1;
<a name="l05117"></a>05117          <span class="keywordflow">goto</span> outgoing_exten_cleanup;
<a name="l05118"></a>05118       }
<a name="l05119"></a>05119       res = 0;
<a name="l05120"></a>05120    }
<a name="l05121"></a>05121 outgoing_exten_cleanup:
<a name="l05122"></a>05122    <a class="code" href="config_8c.html#d616f18584600c70e8744e217c03407c">ast_variables_destroy</a>(vars);
<a name="l05123"></a>05123    <span class="keywordflow">return</span> res;
<a name="l05124"></a>05124 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="235c18a381a9501a4dc41b06b080c24f"></a><!-- doxytag: member="pbx.h::ast_pbx_run" ref="235c18a381a9501a4dc41b06b080c24f" args="(struct ast_channel *c)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912">ast_pbx_result</a> ast_pbx_run           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>c</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Execute the PBX in the current thread. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>channel to run the pbx on</td></tr>
  </table>
</dl>
This executes the PBX on a given channel. It allocates a new PBX structure for the channel, and provides all PBX functionality. See ast_pbx_start for an asynchronous function to run the PBX in a new thread as opposed to the current one.<p>
<dl compact><dt><b>Returns:</b></dt><dd>Zero on success, non-zero on failure </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02572">2572</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>, <a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a9126d32a4969792a16a712111cd4664d1c8">AST_PBX_CALL_LIMIT</a>, <a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912c86643c5e19588b3eb7dce58a2b4145a">AST_PBX_SUCCESS</a>, <a class="el" href="pbx_8c-source.html#l02513">decrease_call_count()</a>, and <a class="el" href="pbx_8c-source.html#l02468">increase_call_count()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04991">ast_pbx_outgoing_exten()</a>, <a class="el" href="pbx_8c-source.html#l04903">async_wait()</a>, <a class="el" href="chan__mgcp_8c-source.html#l02638">mgcp_ss()</a>, <a class="el" href="chan__skinny_8c-source.html#l02342">skinny_newcall()</a>, and <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>.<div class="fragment"><pre class="fragment"><a name="l02573"></a>02573 {
<a name="l02574"></a>02574    <span class="keyword">enum</span> <a class="code" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912">ast_pbx_result</a> res = <a class="code" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912c86643c5e19588b3eb7dce58a2b4145a">AST_PBX_SUCCESS</a>;
<a name="l02575"></a>02575 
<a name="l02576"></a>02576    <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#98ddc357b5ac13bfaa71167740ecc75a">increase_call_count</a>(c))
<a name="l02577"></a>02577       <span class="keywordflow">return</span> <a class="code" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a9126d32a4969792a16a712111cd4664d1c8">AST_PBX_CALL_LIMIT</a>;
<a name="l02578"></a>02578 
<a name="l02579"></a>02579    res = <a class="code" href="pbx_8c.html#d6a76cc38fc49b50acb5368a81899555">__ast_pbx_run</a>(c);
<a name="l02580"></a>02580    <a class="code" href="pbx_8c.html#2cf1332e5b45c96d7508015a47e21b84">decrease_call_count</a>();
<a name="l02581"></a>02581 
<a name="l02582"></a>02582    <span class="keywordflow">return</span> res;
<a name="l02583"></a>02583 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="c55e82ff3dabed89efd77f20209b1006"></a><!-- doxytag: member="pbx.h::ast_pbx_start" ref="c55e82ff3dabed89efd77f20209b1006" args="(struct ast_channel *c)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912">ast_pbx_result</a> ast_pbx_start           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>c</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Create a new thread and start the PBX. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>channel to start the pbx on</td></tr>
  </table>
</dl>
See ast_pbx_run for a synchronous function to run the PBX in the current thread, as opposed to starting a new one.<p>
<dl compact><dt><b>Returns:</b></dt><dd>Zero on success, non-zero on failure </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02551">2551</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a9126d32a4969792a16a712111cd4664d1c8">AST_PBX_CALL_LIMIT</a>, <a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912f5f5d3987a33fd6012262bab9c332519">AST_PBX_FAILED</a>, <a class="el" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912c86643c5e19588b3eb7dce58a2b4145a">AST_PBX_SUCCESS</a>, <a class="el" href="utils_8h-source.html#l00302">ast_pthread_create_detached</a>, <a class="el" href="pbx_8c-source.html#l02468">increase_call_count()</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, and <a class="el" href="pbx_8c-source.html#l02531">pbx_thread()</a>.
<p>
Referenced by <a class="el" href="chan__h323_8c-source.html#l01010">__oh323_new()</a>, <a class="el" href="chan__alsa_8c-source.html#l00790">alsa_new()</a>, <a class="el" href="pbx_8c-source.html#l04595">ast_async_goto()</a>, <a class="el" href="res__features_8c-source.html#l00231">ast_bridge_call_thread()</a>, <a class="el" href="chan__iax2_8c-source.html#l03426">ast_iax2_new()</a>, <a class="el" href="pbx_8c-source.html#l04991">ast_pbx_outgoing_exten()</a>, <a class="el" href="res__features_8c-source.html#l02716">bridge_exec()</a>, <a class="el" href="res__features_8c-source.html#l00192">check_goto_on_transfer()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="res__features_8c-source.html#l01761">do_parking_thread()</a>, <a class="el" href="chan__gtalk_8c-source.html#l00902">gtalk_new()</a>, <a class="el" href="chan__gtalk_8c-source.html#l01070">gtalk_newcall()</a>, <a class="el" href="chan__sip_8c-source.html#l14098">handle_request_invite()</a>, <a class="el" href="chan__jingle_8c-source.html#l00759">jingle_new()</a>, <a class="el" href="chan__jingle_8c-source.html#l00911">jingle_newcall()</a>, <a class="el" href="chan__local_8c-source.html#l00446">local_call()</a>, <a class="el" href="chan__mgcp_8c-source.html#l01457">mgcp_new()</a>, <a class="el" href="chan__nbs_8c-source.html#l00233">nbs_new()</a>, <a class="el" href="chan__oss_8c-source.html#l01020">oss_new()</a>, <a class="el" href="chan__misdn_8c-source.html#l03427">pbx_start_chan()</a>, <a class="el" href="chan__phone_8c-source.html#l00864">phone_new()</a>, <a class="el" href="app__rpt_8c-source.html#l02483">rpt_call()</a>, <a class="el" href="chan__sip_8c-source.html#l04179">sip_new()</a>, <a class="el" href="chan__skinny_8c-source.html#l02823">skinny_new()</a>, <a class="el" href="chan__iax2_8c-source.html#l06624">socket_process()</a>, and <a class="el" href="chan__zap_8c-source.html#l05516">zt_new()</a>.<div class="fragment"><pre class="fragment"><a name="l02552"></a>02552 {
<a name="l02553"></a>02553    pthread_t t;
<a name="l02554"></a>02554 
<a name="l02555"></a>02555    <span class="keywordflow">if</span> (!c) {
<a name="l02556"></a>02556       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Asked to start thread on NULL channel?\n"</span>);
<a name="l02557"></a>02557       <span class="keywordflow">return</span> <a class="code" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912f5f5d3987a33fd6012262bab9c332519">AST_PBX_FAILED</a>;
<a name="l02558"></a>02558    }
<a name="l02559"></a>02559 
<a name="l02560"></a>02560    <span class="keywordflow">if</span> (<a class="code" href="pbx_8c.html#98ddc357b5ac13bfaa71167740ecc75a">increase_call_count</a>(c))
<a name="l02561"></a>02561       <span class="keywordflow">return</span> <a class="code" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a9126d32a4969792a16a712111cd4664d1c8">AST_PBX_CALL_LIMIT</a>;
<a name="l02562"></a>02562 
<a name="l02563"></a>02563    <span class="comment">/* Start a new thread, and get something handling this channel. */</span>
<a name="l02564"></a>02564    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#97e9ed35da1f19087b177cdffdf53c97">ast_pthread_create_detached</a>(&amp;t, NULL, <a class="code" href="pbx_8c.html#b3150b6a7a36bf2a840a8d53b01a36c9">pbx_thread</a>, c)) {
<a name="l02565"></a>02565       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Failed to create new channel thread\n"</span>);
<a name="l02566"></a>02566       <span class="keywordflow">return</span> <a class="code" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912f5f5d3987a33fd6012262bab9c332519">AST_PBX_FAILED</a>;
<a name="l02567"></a>02567    }
<a name="l02568"></a>02568 
<a name="l02569"></a>02569    <span class="keywordflow">return</span> <a class="code" href="pbx_8h.html#bc3ba53eb07b914cc39444bfcf88a912c86643c5e19588b3eb7dce58a2b4145a">AST_PBX_SUCCESS</a>;
<a name="l02570"></a>02570 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a09f0d0ac316a1ae5c74d6958d2b913e"></a><!-- doxytag: member="pbx.h::ast_rdlock_context" ref="a09f0d0ac316a1ae5c74d6958d2b913e" args="(struct ast_context *con)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_rdlock_context           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>con</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read locks a given context. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>con</em>&nbsp;</td><td>context to lock</td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06087">6087</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="lock_8h-source.html#l00642">ast_rwlock_rdlock()</a>, and <a class="el" href="pbx_8c-source.html#l00166">ast_context::lock</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01187">complete_context_remove_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00211">complete_context_remove_include()</a>, <a class="el" href="pbx__dundi_8c-source.html#l03615">dundi_precache_full()</a>, <a class="el" href="app__while_8c-source.html#l00123">find_matching_endwhile()</a>, <a class="el" href="pbx__config_8c-source.html#l00151">lookup_c_ip()</a>, <a class="el" href="pbx__config_8c-source.html#l00137">lookup_ci()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06088"></a>06088 {
<a name="l06089"></a>06089    <span class="keywordflow">return</span> <a class="code" href="lock_8h.html#f4b8158bcd471d4f28b380768e3ee073">ast_rwlock_rdlock</a>(&amp;con-&gt;<a class="code" href="structast__context.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l06090"></a>06090 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="74950b58e1607aa4ba6cf1f2d2f5813d"></a><!-- doxytag: member="pbx.h::ast_rdlock_contexts" ref="74950b58e1607aa4ba6cf1f2d2f5813d" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_rdlock_contexts           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read locks the context list. 
<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on error </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06069">6069</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="lock_8h-source.html#l00642">ast_rwlock_rdlock()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l00889">ast_context_find()</a>, <a class="el" href="pbx_8c-source.html#l02823">ast_context_lockmacro()</a>, <a class="el" href="pbx_8c-source.html#l02851">ast_context_unlockmacro()</a>, <a class="el" href="pbx_8c-source.html#l01799">ast_hint_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01033">complete_context_add_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01104">complete_context_add_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00619">complete_context_add_include()</a>, <a class="el" href="pbx__config_8c-source.html#l00449">complete_context_remove_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01187">complete_context_remove_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00211">complete_context_remove_include()</a>, <a class="el" href="pbx_8c-source.html#l03275">complete_show_dialplan_context()</a>, <a class="el" href="pbx__dundi_8c-source.html#l03615">dundi_precache_full()</a>, <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>, <a class="el" href="app__while_8c-source.html#l00123">find_matching_endwhile()</a>, <a class="el" href="pbx__config_8c-source.html#l00717">handle_save_dialplan()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>, <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03830">unreference_cached_app()</a>.<div class="fragment"><pre class="fragment"><a name="l06070"></a>06070 {
<a name="l06071"></a>06071    <span class="keywordflow">return</span> <a class="code" href="lock_8h.html#f4b8158bcd471d4f28b380768e3ee073">ast_rwlock_rdlock</a>(&amp;conlock);
<a name="l06072"></a>06072 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="f8e9b339fed38c405332f222cceeec40"></a><!-- doxytag: member="pbx.h::ast_register_application" ref="f8e9b339fed38c405332f222cceeec40" args="(const char *app, int(*execute)(struct ast_channel *, void *), const char *synopsis, const char *description)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_register_application           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>app</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int(*)(struct <a class="el" href="structast__channel.html">ast_channel</a> *, void *)&nbsp;</td>
          <td class="mdname" nowrap> <em>execute</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>synopsis</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>description</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Register an application. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>app</em>&nbsp;</td><td>Short name of the application </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>execute</em>&nbsp;</td><td>a function callback to execute the application. It should return non-zero if the channel needs to be hung up. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>synopsis</em>&nbsp;</td><td>a short description (one line synopsis) of the application </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>description</em>&nbsp;</td><td>long description with all of the details about the use of the application</td></tr>
  </table>
</dl>
This registers an application with Asterisk's internal application list. <dl compact><dt><b>Note:</b></dt><dd>The individual applications themselves are responsible for registering and unregistering and unregistering their own CLI commands.</dd></dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>failure. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02875">2875</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="linkedlists_8h-source.html#l00549">AST_RWLIST_INSERT_BEFORE_CURRENT</a>, <a class="el" href="linkedlists_8h-source.html#l00680">AST_RWLIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00503">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h-source.html#l00556">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="term_8h-source.html#l00052">COLOR_BRCYAN</a>, <a class="el" href="pbx_8c-source.html#l00182">ast_app::description</a>, <a class="el" href="structast__app.html#881e868890bc8e5cd8614a1ce80c09eb">ast_app::execute</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="pbx_8c-source.html#l00181">ast_app::synopsis</a>, <a class="el" href="term_8c-source.html#l00150">term_color()</a>, and <a class="el" href="logger_8h-source.html#l00044">VERBOSE_PREFIX_2</a>.
<p>
Referenced by <a class="el" href="app__adsiprog_8c-source.html#l01585">load_module()</a>, and <a class="el" href="pbx_8c-source.html#l06035">load_pbx()</a>.<div class="fragment"><pre class="fragment"><a name="l02876"></a>02876 {
<a name="l02877"></a>02877    <span class="keyword">struct </span><a class="code" href="structast__app.html">ast_app</a> *tmp, *cur = NULL;
<a name="l02878"></a>02878    <span class="keywordtype">char</span> tmps[80];
<a name="l02879"></a>02879    <span class="keywordtype">int</span> length;
<a name="l02880"></a>02880 
<a name="l02881"></a>02881    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;apps);
<a name="l02882"></a>02882    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;apps, tmp, list) {
<a name="l02883"></a>02883       <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>, tmp-&gt;name)) {
<a name="l02884"></a>02884          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Already have an application '%s'\n"</span>, <a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>);
<a name="l02885"></a>02885          <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;apps);
<a name="l02886"></a>02886          <span class="keywordflow">return</span> -1;
<a name="l02887"></a>02887       }
<a name="l02888"></a>02888    }
<a name="l02889"></a>02889 
<a name="l02890"></a>02890    length = <span class="keyword">sizeof</span>(*tmp) + strlen(<a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>) + 1;
<a name="l02891"></a>02891 
<a name="l02892"></a>02892    <span class="keywordflow">if</span> (!(tmp = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, length))) {
<a name="l02893"></a>02893       <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;apps);
<a name="l02894"></a>02894       <span class="keywordflow">return</span> -1;
<a name="l02895"></a>02895    }
<a name="l02896"></a>02896 
<a name="l02897"></a>02897    strcpy(tmp-&gt;name, <a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>);
<a name="l02898"></a>02898    tmp-&gt;<a class="code" href="structast__app.html#881e868890bc8e5cd8614a1ce80c09eb">execute</a> = <a class="code" href="structast__app.html#881e868890bc8e5cd8614a1ce80c09eb">execute</a>;
<a name="l02899"></a>02899    tmp-&gt;<a class="code" href="structast__app.html#512fbb4e7b617c04031f58b631f2b05d">synopsis</a> = <a class="code" href="chan__agent_8c.html#485d112e4e425dde393e2e7091451856">synopsis</a>;
<a name="l02900"></a>02900    tmp-&gt;<a class="code" href="structast__app.html#67daf92c833c41c95db874e18fcb2786">description</a> = <a class="code" href="callerid_8c.html#67daf92c833c41c95db874e18fcb2786">description</a>;
<a name="l02901"></a>02901 
<a name="l02902"></a>02902    <span class="comment">/* Store in alphabetical order */</span>
<a name="l02903"></a>02903    <a class="code" href="linkedlists_8h.html#b564f1f262db6464e1644462c38d61e3">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;apps, cur, list) {
<a name="l02904"></a>02904       <span class="keywordflow">if</span> (strcasecmp(tmp-&gt;name, cur-&gt;name) &lt; 0) {
<a name="l02905"></a>02905          <a class="code" href="linkedlists_8h.html#cf4d2eed92b828f7212b90b1dcde0b29">AST_RWLIST_INSERT_BEFORE_CURRENT</a>(&amp;apps, tmp, list);
<a name="l02906"></a>02906          <span class="keywordflow">break</span>;
<a name="l02907"></a>02907       }
<a name="l02908"></a>02908    }
<a name="l02909"></a>02909    <a class="code" href="linkedlists_8h.html#e5be717f6b8c1586fa30a060b56403fe">AST_RWLIST_TRAVERSE_SAFE_END</a>
<a name="l02910"></a>02910    <span class="keywordflow">if</span> (!cur)
<a name="l02911"></a>02911       <a class="code" href="linkedlists_8h.html#64b41a3e9f2e6a867c09431dfae7ce21">AST_RWLIST_INSERT_TAIL</a>(&amp;apps, tmp, list);
<a name="l02912"></a>02912 
<a name="l02913"></a>02913    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 1)
<a name="l02914"></a>02914       <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>( <a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Registered application '%s'\n"</span>, <a class="code" href="term_8c.html#e93d6667c9a6823fef4ab75cd64c90ca">term_color</a>(tmps, tmp-&gt;name, <a class="code" href="term_8h.html#ed35747ad832f24a4b7cf183cf619ad5">COLOR_BRCYAN</a>, 0, <span class="keyword">sizeof</span>(tmps)));
<a name="l02915"></a>02915 
<a name="l02916"></a>02916    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;apps);
<a name="l02917"></a>02917 
<a name="l02918"></a>02918    <span class="keywordflow">return</span> 0;
<a name="l02919"></a>02919 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ce9b1b9b9951df409f13e9c6c9a94d71"></a><!-- doxytag: member="pbx.h::ast_register_switch" ref="ce9b1b9b9951df409f13e9c6c9a94d71" args="(struct ast_switch *sw)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_register_switch           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__switch.html">ast_switch</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>sw</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Register an alternative dialplan switch. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sw</em>&nbsp;</td><td>switch to register</td></tr>
  </table>
</dl>
This function registers a populated <a class="el" href="structast__switch.html">ast_switch</a> structure with the asterisk switching architecture.<p>
<dl compact><dt><b>Returns:</b></dt><dd>0 on success, and other than 0 on failure </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02925">2925</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="linkedlists_8h-source.html#l00680">AST_RWLIST_INSERT_TAIL</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, and <a class="el" href="pbx_8h-source.html#l00089">ast_switch::name</a>.
<p>
Referenced by <a class="el" href="chan__iax2_8c-source.html#l10425">load_module()</a>.<div class="fragment"><pre class="fragment"><a name="l02926"></a>02926 {
<a name="l02927"></a>02927    <span class="keyword">struct </span><a class="code" href="structast__switch.html">ast_switch</a> *tmp;
<a name="l02928"></a>02928 
<a name="l02929"></a>02929    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;switches);
<a name="l02930"></a>02930    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;switches, tmp, list) {
<a name="l02931"></a>02931       <span class="keywordflow">if</span> (!strcasecmp(tmp-&gt;<a class="code" href="structast__switch.html#b068931cc450442b63f5b3d276ea4297">name</a>, sw-&gt;<a class="code" href="structast__switch.html#b068931cc450442b63f5b3d276ea4297">name</a>)) {
<a name="l02932"></a>02932          <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;switches);
<a name="l02933"></a>02933          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Switch '%s' already found\n"</span>, sw-&gt;<a class="code" href="structast__switch.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l02934"></a>02934          <span class="keywordflow">return</span> -1;
<a name="l02935"></a>02935       }
<a name="l02936"></a>02936    }
<a name="l02937"></a>02937    <a class="code" href="linkedlists_8h.html#64b41a3e9f2e6a867c09431dfae7ce21">AST_RWLIST_INSERT_TAIL</a>(&amp;switches, sw, list);
<a name="l02938"></a>02938    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;switches);
<a name="l02939"></a>02939 
<a name="l02940"></a>02940    <span class="keywordflow">return</span> 0;
<a name="l02941"></a>02941 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="63a99eec1b6004791bd2013ad855eea8"></a><!-- doxytag: member="pbx.h::ast_spawn_extension" ref="63a99eec1b6004791bd2013ad855eea8" args="(struct ast_channel *c, const char *context, const char *exten, int priority, const char *callerid)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_spawn_extension           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>callerid</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Launch a new extension (i.e. new stack). 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>not important </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>which context to generate the extension within </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>exten</em>&nbsp;</td><td>new extension to add </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>priority</em>&nbsp;</td><td>priority of new extension </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callerid</em>&nbsp;</td><td>callerid of extension</td></tr>
  </table>
</dl>
This adds a new extension to the asterisk extension list.<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02208">2208</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe216abbac78adc685e53502161a311679">E_SPAWN</a>, and <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>, and <a class="el" href="pbx__loopback_8c-source.html#l00142">loopback_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l02209"></a>02209 {
<a name="l02210"></a>02210    <span class="keywordflow">return</span> <a class="code" href="pbx_8c.html#2377c7b979811bdd54ebf819e5d2037b">pbx_extension_helper</a>(c, NULL, <a class="code" href="chan__alsa_8c.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>, priority, NULL, callerid, <a class="code" href="pbx_8c.html#5982fa5b4310acd51c79b20de9f824fe216abbac78adc685e53502161a311679">E_SPAWN</a>);
<a name="l02211"></a>02211 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="adad2f961a9f0ccdd8a48dee073793cc"></a><!-- doxytag: member="pbx.h::ast_unlock_context" ref="adad2f961a9f0ccdd8a48dee073793cc" args="(struct ast_context *con)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_unlock_context           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>con</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Unlocks</em>&nbsp;</td><td>the given context</td></tr>
  </table>
</dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>con</em>&nbsp;</td><td>context to unlock</td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06092">6092</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="lock_8h-source.html#l00637">ast_rwlock_unlock()</a>, and <a class="el" href="pbx_8c-source.html#l00166">ast_context::lock</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l05285">__ast_context_destroy()</a>, <a class="el" href="pbx_8c-source.html#l04765">ast_add_extension2()</a>, <a class="el" href="pbx_8c-source.html#l04509">ast_context_add_ignorepat2()</a>, <a class="el" href="pbx_8c-source.html#l04304">ast_context_add_include2()</a>, <a class="el" href="pbx_8c-source.html#l04386">ast_context_add_switch2()</a>, <a class="el" href="pbx_8c-source.html#l02746">ast_context_remove_extension2()</a>, <a class="el" href="pbx_8c-source.html#l04466">ast_context_remove_ignorepat2()</a>, <a class="el" href="pbx_8c-source.html#l02640">ast_context_remove_include2()</a>, <a class="el" href="pbx_8c-source.html#l02694">ast_context_remove_switch2()</a>, <a class="el" href="pbx__config_8c-source.html#l01187">complete_context_remove_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00211">complete_context_remove_include()</a>, <a class="el" href="pbx__dundi_8c-source.html#l03615">dundi_precache_full()</a>, <a class="el" href="app__while_8c-source.html#l00123">find_matching_endwhile()</a>, <a class="el" href="pbx__config_8c-source.html#l00151">lookup_c_ip()</a>, <a class="el" href="pbx__config_8c-source.html#l00137">lookup_ci()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06093"></a>06093 {
<a name="l06094"></a>06094    <span class="keywordflow">return</span> <a class="code" href="lock_8h.html#97ed909ef0a0582cf3870dd0629852c8">ast_rwlock_unlock</a>(&amp;con-&gt;<a class="code" href="structast__context.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l06095"></a>06095 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3551033115b63707d99ce90e97df42df"></a><!-- doxytag: member="pbx.h::ast_unlock_contexts" ref="3551033115b63707d99ce90e97df42df" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_unlock_contexts           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unlocks contexts. 
<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06074">6074</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="lock_8h-source.html#l00637">ast_rwlock_unlock()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03870">__ast_context_create()</a>, <a class="el" href="pbx_8c-source.html#l04561">ast_add_extension()</a>, <a class="el" href="pbx_8c-source.html#l04497">ast_context_add_ignorepat()</a>, <a class="el" href="pbx_8c-source.html#l04042">ast_context_add_include()</a>, <a class="el" href="pbx_8c-source.html#l04367">ast_context_add_switch()</a>, <a class="el" href="pbx_8c-source.html#l05344">ast_context_destroy()</a>, <a class="el" href="pbx_8c-source.html#l00889">ast_context_find()</a>, <a class="el" href="pbx_8c-source.html#l02823">ast_context_lockmacro()</a>, <a class="el" href="pbx_8c-source.html#l02724">ast_context_remove_extension()</a>, <a class="el" href="pbx_8c-source.html#l04454">ast_context_remove_ignorepat()</a>, <a class="el" href="pbx_8c-source.html#l02619">ast_context_remove_include()</a>, <a class="el" href="pbx_8c-source.html#l02673">ast_context_remove_switch()</a>, <a class="el" href="pbx_8c-source.html#l02851">ast_context_unlockmacro()</a>, <a class="el" href="pbx_8c-source.html#l01799">ast_hint_extension()</a>, <a class="el" href="pbx_8c-source.html#l03936">ast_merge_contexts_and_delete()</a>, <a class="el" href="pbx__config_8c-source.html#l01033">complete_context_add_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01104">complete_context_add_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00619">complete_context_add_include()</a>, <a class="el" href="pbx__config_8c-source.html#l00449">complete_context_remove_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01187">complete_context_remove_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00211">complete_context_remove_include()</a>, <a class="el" href="pbx_8c-source.html#l03275">complete_show_dialplan_context()</a>, <a class="el" href="pbx__dundi_8c-source.html#l03615">dundi_precache_full()</a>, <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>, <a class="el" href="app__while_8c-source.html#l00123">find_matching_endwhile()</a>, <a class="el" href="pbx__config_8c-source.html#l00717">handle_save_dialplan()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>, <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03830">unreference_cached_app()</a>.<div class="fragment"><pre class="fragment"><a name="l06075"></a>06075 {
<a name="l06076"></a>06076    <span class="keywordflow">return</span> <a class="code" href="lock_8h.html#97ed909ef0a0582cf3870dd0629852c8">ast_rwlock_unlock</a>(&amp;conlock);
<a name="l06077"></a>06077 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="4fc9ac8a7093a1f73637df0b9d6d6de9"></a><!-- doxytag: member="pbx.h::ast_unregister_application" ref="4fc9ac8a7093a1f73637df0b9d6d6de9" args="(const char *app)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_unregister_application           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>app</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unregister an application. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>app</em>&nbsp;</td><td>name of the application (does not have to be the same string as the one that was registered)</td></tr>
  </table>
</dl>
This unregisters an application from Asterisk's internal application list.<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l03849">3849</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00526">AST_RWLIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h-source.html#l00503">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h-source.html#l00556">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="pbx_8c-source.html#l03830">unreference_cached_app()</a>, and <a class="el" href="logger_8h-source.html#l00044">VERBOSE_PREFIX_2</a>.
<p>
Referenced by <a class="el" href="chan__iax2_8c-source.html#l10340">__unload_module()</a>, and <a class="el" href="app__adsiprog_8c-source.html#l01573">unload_module()</a>.<div class="fragment"><pre class="fragment"><a name="l03850"></a>03850 {
<a name="l03851"></a>03851    <span class="keyword">struct </span><a class="code" href="structast__app.html">ast_app</a> *tmp;
<a name="l03852"></a>03852 
<a name="l03853"></a>03853    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;apps);
<a name="l03854"></a>03854    <a class="code" href="linkedlists_8h.html#b564f1f262db6464e1644462c38d61e3">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;apps, tmp, list) {
<a name="l03855"></a>03855       <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>, tmp-&gt;name)) {
<a name="l03856"></a>03856          <a class="code" href="pbx_8c.html#de5c3078bd604949446521990a001661">unreference_cached_app</a>(tmp);
<a name="l03857"></a>03857          <a class="code" href="linkedlists_8h.html#93783e4cad722e705630e975d2e8d7f9">AST_RWLIST_REMOVE_CURRENT</a>(&amp;apps, list);
<a name="l03858"></a>03858          <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 1)
<a name="l03859"></a>03859             <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>( <a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Unregistered application '%s'\n"</span>, tmp-&gt;name);
<a name="l03860"></a>03860          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(tmp);
<a name="l03861"></a>03861          <span class="keywordflow">break</span>;
<a name="l03862"></a>03862       }
<a name="l03863"></a>03863    }
<a name="l03864"></a>03864    <a class="code" href="linkedlists_8h.html#e5be717f6b8c1586fa30a060b56403fe">AST_RWLIST_TRAVERSE_SAFE_END</a>
<a name="l03865"></a>03865    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;apps);
<a name="l03866"></a>03866 
<a name="l03867"></a>03867    <span class="keywordflow">return</span> tmp ? 0 : -1;
<a name="l03868"></a>03868 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="dfce547713eae00cf11fd0b876adb7f7"></a><!-- doxytag: member="pbx.h::ast_unregister_switch" ref="dfce547713eae00cf11fd0b876adb7f7" args="(struct ast_switch *sw)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_unregister_switch           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__switch.html">ast_switch</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>sw</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unregister an alternative switch. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sw</em>&nbsp;</td><td>switch to unregister</td></tr>
  </table>
</dl>
Unregisters a switch from asterisk.<p>
<dl compact><dt><b>Returns:</b></dt><dd>nothing </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02943">2943</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00749">AST_RWLIST_REMOVE</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, and <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>.
<p>
Referenced by <a class="el" href="chan__iax2_8c-source.html#l10340">__unload_module()</a>, and <a class="el" href="pbx__dundi_8c-source.html#l04703">unload_module()</a>.<div class="fragment"><pre class="fragment"><a name="l02944"></a>02944 {
<a name="l02945"></a>02945    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;switches);
<a name="l02946"></a>02946    <a class="code" href="linkedlists_8h.html#dd27d7fa9f70ab8e5e35161cafdd0459">AST_RWLIST_REMOVE</a>(&amp;switches, sw, list);
<a name="l02947"></a>02947    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;switches);
<a name="l02948"></a>02948 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="95639736856685dd7cd10d145e595c0a"></a><!-- doxytag: member="pbx.h::ast_walk_context_extensions" ref="95639736856685dd7cd10d145e595c0a" args="(struct ast_context *con, struct ast_exten *priority)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a>* ast_walk_context_extensions           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06201">6201</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00131">ast_exten::next</a>, and <a class="el" href="pbx_8c-source.html#l00167">ast_context::root</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l00449">complete_context_remove_extension()</a>, <a class="el" href="pbx__dundi_8c-source.html#l03615">dundi_precache_full()</a>, <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>, <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03830">unreference_cached_app()</a>.<div class="fragment"><pre class="fragment"><a name="l06203"></a>06203 {
<a name="l06204"></a>06204    <span class="keywordflow">if</span> (!<a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>)
<a name="l06205"></a>06205       <span class="keywordflow">return</span> con ? con-&gt;<a class="code" href="structast__context.html#63a9f0ea7bb98050796b649e85481845">root</a> : NULL;
<a name="l06206"></a>06206    <span class="keywordflow">else</span>
<a name="l06207"></a>06207       <span class="keywordflow">return</span> <a class="code" href="chan__alsa_8c.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>-&gt;next;
<a name="l06208"></a>06208 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="78f92771f39acc0696f7d12053ff4304"></a><!-- doxytag: member="pbx.h::ast_walk_context_ignorepats" ref="78f92771f39acc0696f7d12053ff4304" args="(struct ast_context *con, struct ast_ignorepat *ip)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__ignorepat.html">ast_ignorepat</a>* ast_walk_context_ignorepats           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__ignorepat.html">ast_ignorepat</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ip</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06234">6234</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00170">ast_context::ignorepats</a>, and <a class="el" href="pbx_8c-source.html#l00160">ast_ignorepat::next</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01187">complete_context_remove_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00151">lookup_c_ip()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06236"></a>06236 {
<a name="l06237"></a>06237    <span class="keywordflow">if</span> (!ip)
<a name="l06238"></a>06238       <span class="keywordflow">return</span> con ? con-&gt;<a class="code" href="structast__context.html#79a69e07731e7d02c0f52f19bab94dcb">ignorepats</a> : NULL;
<a name="l06239"></a>06239    <span class="keywordflow">else</span>
<a name="l06240"></a>06240       <span class="keywordflow">return</span> ip-&gt;<a class="code" href="structast__ignorepat.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l06241"></a>06241 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ff52371424397442d32568beb910e153"></a><!-- doxytag: member="pbx.h::ast_walk_context_includes" ref="ff52371424397442d32568beb910e153" args="(struct ast_context *con, struct ast_include *inc)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__include.html">ast_include</a>* ast_walk_context_includes           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__include.html">ast_include</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>inc</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06225">6225</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00169">ast_context::includes</a>, and <a class="el" href="pbx_8c-source.html#l00142">ast_include::next</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l06243">ast_context_verify_includes()</a>, <a class="el" href="pbx__config_8c-source.html#l00211">complete_context_remove_include()</a>, <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>, <a class="el" href="pbx__config_8c-source.html#l00137">lookup_ci()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06227"></a>06227 {
<a name="l06228"></a>06228    <span class="keywordflow">if</span> (!inc)
<a name="l06229"></a>06229       <span class="keywordflow">return</span> con ? con-&gt;<a class="code" href="structast__context.html#bb2b21ef7774df8687ff02b0284505c6">includes</a> : NULL;
<a name="l06230"></a>06230    <span class="keywordflow">else</span>
<a name="l06231"></a>06231       <span class="keywordflow">return</span> inc-&gt;<a class="code" href="structast__include.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a>;
<a name="l06232"></a>06232 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6cbdae284c7bcff5b16d687a1f60b61b"></a><!-- doxytag: member="pbx.h::ast_walk_context_switches" ref="6cbdae284c7bcff5b16d687a1f60b61b" args="(struct ast_context *con, struct ast_sw *sw)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__sw.html">ast_sw</a>* ast_walk_context_switches           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>con</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__sw.html">ast_sw</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>sw</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06210">6210</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00385">AST_LIST_FIRST</a>, and <a class="el" href="linkedlists_8h-source.html#l00403">AST_LIST_NEXT</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l06212"></a>06212 {
<a name="l06213"></a>06213    <span class="keywordflow">if</span> (!sw)
<a name="l06214"></a>06214       <span class="keywordflow">return</span> con ? <a class="code" href="linkedlists_8h.html#e4deb7f32ef480cbc3b2e9b7e4ceff6c">AST_LIST_FIRST</a>(&amp;con-&gt;alts) : NULL;
<a name="l06215"></a>06215    <span class="keywordflow">else</span>
<a name="l06216"></a>06216       <span class="keywordflow">return</span> <a class="code" href="linkedlists_8h.html#ab7d30c78fda9982ddc59f746adf8a69">AST_LIST_NEXT</a>(sw, list);
<a name="l06217"></a>06217 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="709c9b64f2da1eaace237db32a5e1445"></a><!-- doxytag: member="pbx.h::ast_walk_contexts" ref="709c9b64f2da1eaace237db32a5e1445" args="(struct ast_context *con)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a>* ast_walk_contexts           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>con</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06196">6196</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00489">contexts</a>, and <a class="el" href="pbx_8c-source.html#l00168">ast_context::next</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l00889">ast_context_find()</a>, <a class="el" href="pbx_8c-source.html#l02823">ast_context_lockmacro()</a>, <a class="el" href="pbx_8c-source.html#l02851">ast_context_unlockmacro()</a>, <a class="el" href="pbx__config_8c-source.html#l01033">complete_context_add_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01104">complete_context_add_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00619">complete_context_add_include()</a>, <a class="el" href="pbx__config_8c-source.html#l00449">complete_context_remove_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01187">complete_context_remove_ignorepat()</a>, <a class="el" href="pbx__config_8c-source.html#l00211">complete_context_remove_include()</a>, <a class="el" href="pbx_8c-source.html#l03275">complete_show_dialplan_context()</a>, <a class="el" href="pbx__dundi_8c-source.html#l03615">dundi_precache_full()</a>, <a class="el" href="pbx_8c-source.html#l02600">find_context_locked()</a>, <a class="el" href="app__while_8c-source.html#l00123">find_matching_endwhile()</a>, <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01596">pbx_load_module()</a>, <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03830">unreference_cached_app()</a>.<div class="fragment"><pre class="fragment"><a name="l06197"></a>06197 {
<a name="l06198"></a>06198    <span class="keywordflow">return</span> con ? con-&gt;<a class="code" href="structast__context.html#d0cab90d8d20d57e2f2b9be52f7dd25d">next</a> : <a class="code" href="pbx_8c.html#9be90dc64c1f5b5c993ff11d732a8da0">contexts</a>;
<a name="l06199"></a>06199 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2ae60ad33dfd510584655331ac42b890"></a><!-- doxytag: member="pbx.h::ast_walk_extension_priorities" ref="2ae60ad33dfd510584655331ac42b890" args="(struct ast_exten *exten, struct ast_exten *priority)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a>* ast_walk_extension_priorities           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>exten</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__exten.html">ast_exten</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>priority</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06219">6219</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00129">ast_exten::peer</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l00449">complete_context_remove_extension()</a>, <a class="el" href="app__macro_8c-source.html#l00109">find_matching_priority()</a>, <a class="el" href="pbx_8c-source.html#l03545">manager_show_dialplan_helper()</a>, <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>, <a class="el" href="pbx_8c-source.html#l03329">show_dialplan_helper()</a>, and <a class="el" href="pbx_8c-source.html#l03830">unreference_cached_app()</a>.<div class="fragment"><pre class="fragment"><a name="l06221"></a>06221 {
<a name="l06222"></a>06222    <span class="keywordflow">return</span> priority ? priority-&gt;<a class="code" href="structast__exten.html#f8fe68b4c4cba197efa9c8bbd45f144e">peer</a> : exten;
<a name="l06223"></a>06223 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="18884df37a7c36a24fd0b5f4225d1112"></a><!-- doxytag: member="pbx.h::ast_wrlock_context" ref="18884df37a7c36a24fd0b5f4225d1112" args="(struct ast_context *con)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_wrlock_context           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__context.html">ast_context</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>con</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Write locks a given context. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>con</em>&nbsp;</td><td>context to lock</td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06082">6082</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="lock_8h-source.html#l00652">ast_rwlock_wrlock()</a>, and <a class="el" href="pbx_8c-source.html#l00166">ast_context::lock</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l05285">__ast_context_destroy()</a>, <a class="el" href="pbx_8c-source.html#l04765">ast_add_extension2()</a>, <a class="el" href="pbx_8c-source.html#l04509">ast_context_add_ignorepat2()</a>, <a class="el" href="pbx_8c-source.html#l04304">ast_context_add_include2()</a>, <a class="el" href="pbx_8c-source.html#l04386">ast_context_add_switch2()</a>, <a class="el" href="pbx_8c-source.html#l02746">ast_context_remove_extension2()</a>, <a class="el" href="pbx_8c-source.html#l04466">ast_context_remove_ignorepat2()</a>, <a class="el" href="pbx_8c-source.html#l02640">ast_context_remove_include2()</a>, and <a class="el" href="pbx_8c-source.html#l02694">ast_context_remove_switch2()</a>.<div class="fragment"><pre class="fragment"><a name="l06083"></a>06083 {
<a name="l06084"></a>06084    <span class="keywordflow">return</span> <a class="code" href="lock_8h.html#25d2e851f878ee9a64d36b67b67ede6e">ast_rwlock_wrlock</a>(&amp;con-&gt;<a class="code" href="structast__context.html#dce7c4174ce9323904a934a486c41288">lock</a>);
<a name="l06085"></a>06085 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="7f2720f357b0f5e3f098635da99ed7a7"></a><!-- doxytag: member="pbx.h::ast_wrlock_contexts" ref="7f2720f357b0f5e3f098635da99ed7a7" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_wrlock_contexts           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Write locks the context list. 
<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on error </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l06064">6064</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="lock_8h-source.html#l00652">ast_rwlock_wrlock()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l03870">__ast_context_create()</a>, <a class="el" href="pbx_8c-source.html#l05344">ast_context_destroy()</a>, <a class="el" href="pbx_8c-source.html#l03936">ast_merge_contexts_and_delete()</a>, and <a class="el" href="pbx__config_8c-source.html#l00211">complete_context_remove_include()</a>.<div class="fragment"><pre class="fragment"><a name="l06065"></a>06065 {
<a name="l06066"></a>06066    <span class="keywordflow">return</span> <a class="code" href="lock_8h.html#25d2e851f878ee9a64d36b67b67ede6e">ast_rwlock_wrlock</a>(&amp;conlock);
<a name="l06067"></a>06067 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="70b34943ce7b4a596f724e9d2e5463f6"></a><!-- doxytag: member="pbx.h::pbx_builtin_clear_globals" ref="70b34943ce7b4a596f724e9d2e5463f6" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pbx_builtin_clear_globals           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05937">5937</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00710">AST_LIST_REMOVE_HEAD</a>, <a class="el" href="lock_8h-source.html#l00637">ast_rwlock_unlock()</a>, <a class="el" href="lock_8h-source.html#l00652">ast_rwlock_wrlock()</a>, and <a class="el" href="chanvars_8c-source.html#l00056">ast_var_delete()</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01271">handle_reload_extensions()</a>, and <a class="el" href="pbx__config_8c-source.html#l01627">reload()</a>.<div class="fragment"><pre class="fragment"><a name="l05938"></a>05938 {
<a name="l05939"></a>05939    <span class="keyword">struct </span><a class="code" href="structast__var__t.html">ast_var_t</a> *vardata;
<a name="l05940"></a>05940 
<a name="l05941"></a>05941    <a class="code" href="lock_8h.html#25d2e851f878ee9a64d36b67b67ede6e">ast_rwlock_wrlock</a>(&amp;globalslock);
<a name="l05942"></a>05942    <span class="keywordflow">while</span> ((vardata = <a class="code" href="linkedlists_8h.html#beec347da29fe6b0d7fdb3e80b851f90">AST_LIST_REMOVE_HEAD</a>(&amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>, entries)))
<a name="l05943"></a>05943       <a class="code" href="chanvars_8c.html#32e018d32324bab845a9cac601c175d8">ast_var_delete</a>(vardata);
<a name="l05944"></a>05944    <a class="code" href="lock_8h.html#97ed909ef0a0582cf3870dd0629852c8">ast_rwlock_unlock</a>(&amp;globalslock);
<a name="l05945"></a>05945 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="944d18aa90701f025b30e63d9644e448"></a><!-- doxytag: member="pbx.h::pbx_builtin_getvar_helper" ref="944d18aa90701f025b30e63d9644e448" args="(struct ast_channel *chan, const char *name)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* pbx_builtin_getvar_helper           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05762">5762</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="lock_8h-source.html#l00642">ast_rwlock_rdlock()</a>, <a class="el" href="lock_8h-source.html#l00637">ast_rwlock_unlock()</a>, <a class="el" href="chanvars_8c-source.html#l00062">ast_var_name()</a>, <a class="el" href="chanvars_8c-source.html#l00082">ast_var_value()</a>, and <a class="el" href="channel_8h-source.html#l00467">ast_channel::varshead</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>, <a class="el" href="chan__agent_8c-source.html#l01763">__login_exec()</a>, <a class="el" href="app__macro_8c-source.html#l00144">_macro_exec()</a>, <a class="el" href="app__while_8c-source.html#l00164">_while_exec()</a>, <a class="el" href="chan__iax2_8c-source.html#l06597">acf_iaxvar_read()</a>, <a class="el" href="chan__agent_8c-source.html#l00717">agent_hangup()</a>, <a class="el" href="chan__agent_8c-source.html#l00427">agent_read()</a>, <a class="el" href="chan__agent_8c-source.html#l02207">agentmonitoroutgoing_exec()</a>, <a class="el" href="func__strings_8c-source.html#l00204">array()</a>, <a class="el" href="res__features_8c-source.html#l01478">ast_bridge_call()</a>, <a class="el" href="res__features_8c-source.html#l01194">ast_feature_interpret()</a>, <a class="el" href="res__monitor_8c-source.html#l00254">ast_monitor_stop()</a>, <a class="el" href="res__features_8c-source.html#l00342">ast_park_call()</a>, <a class="el" href="res__features_8c-source.html#l00562">builtin_automonitor()</a>, <a class="el" href="res__features_8c-source.html#l00192">check_goto_on_transfer()</a>, <a class="el" href="app__chanspy_8c-source.html#l00465">common_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l01350">conf_run()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="app__dial_8c-source.html#l00430">do_forward()</a>, <a class="el" href="app__dial_8c-source.html#l00839">do_timelimit()</a>, <a class="el" href="pbx__dundi_8c-source.html#l04479">dundi_exec()</a>, <a class="el" href="pbx__dundi_8c-source.html#l04430">dundi_helper()</a>, <a class="el" href="chan__sip_8c-source.html#l09533">get_also_info()</a>, <a class="el" href="app__while_8c-source.html#l00081">get_index()</a>, <a class="el" href="chan__sip_8c-source.html#l09372">get_refer_info()</a>, <a class="el" href="func__global_8c-source.html#l00043">global_read()</a>, <a class="el" href="func__strings_8c-source.html#l00316">hash_read()</a>, <a class="el" href="chan__iax2_8c-source.html#l09890">iax2_exec()</a>, <a class="el" href="chan__misdn_8c-source.html#l03679">import_ch()</a>, <a class="el" href="app__voicemail_8c-source.html#l02956">leave_voicemail()</a>, <a class="el" href="chan__local_8c-source.html#l00488">local_hangup()</a>, <a class="el" href="app__minivm_8c-source.html#l02021">minivm_delete_exec()</a>, <a class="el" href="app__minivm_8c-source.html#l01673">minivm_notify_exec()</a>, <a class="el" href="chan__misdn_8c-source.html#l02107">misdn_answer()</a>, <a class="el" href="chan__misdn_8c-source.html#l02376">misdn_hangup()</a>, <a class="el" href="app__morsecode_8c-source.html#l00109">morsecode_exec()</a>, <a class="el" href="app__minivm_8c-source.html#l01427">notify_new_message()</a>, <a class="el" href="chan__h323_8c-source.html#l00594">oh323_call()</a>, <a class="el" href="chan__h323_8c-source.html#l00696">oh323_hangup()</a>, <a class="el" href="app__directed__pickup_8c-source.html#l00113">pickup_by_mark()</a>, <a class="el" href="app__queue_8c-source.html#l03443">queue_exec()</a>, <a class="el" href="res__features_8c-source.html#l00661">real_ctx()</a>, <a class="el" href="app__dial_8c-source.html#l01747">retrydial_exec()</a>, <a class="el" href="res__agi_8c-source.html#l01833">run_agi()</a>, <a class="el" href="res__features_8c-source.html#l01252">set_config_flags()</a>, <a class="el" href="chan__sip_8c-source.html#l18113">sip_addheader()</a>, <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>, <a class="el" href="chan__sip_8c-source.html#l03836">try_suggested_sip_codec()</a>, <a class="el" href="app__dial_8c-source.html#l00532">wait_for_answer()</a>, <a class="el" href="chan__zap_8c-source.html#l01923">zt_call()</a>, and <a class="el" href="chan__zap_8c-source.html#l02612">zt_hangup()</a>.<div class="fragment"><pre class="fragment"><a name="l05763"></a>05763 {
<a name="l05764"></a>05764    <span class="keyword">struct </span><a class="code" href="structast__var__t.html">ast_var_t</a> *variables;
<a name="l05765"></a>05765    <span class="keyword">const</span> <span class="keywordtype">char</span> *ret = NULL;
<a name="l05766"></a>05766    <span class="keywordtype">int</span> i;
<a name="l05767"></a>05767    <span class="keyword">struct </span>varshead *places[2] = { NULL, &amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a> };
<a name="l05768"></a>05768 
<a name="l05769"></a>05769    <span class="keywordflow">if</span> (!<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>)
<a name="l05770"></a>05770       <span class="keywordflow">return</span> NULL;
<a name="l05771"></a>05771    <span class="keywordflow">if</span> (chan)
<a name="l05772"></a>05772       places[0] = &amp;chan-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>;
<a name="l05773"></a>05773 
<a name="l05774"></a>05774    <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++) {
<a name="l05775"></a>05775       <span class="keywordflow">if</span> (!places[i])
<a name="l05776"></a>05776          <span class="keywordflow">continue</span>;
<a name="l05777"></a>05777       <span class="keywordflow">if</span> (places[i] == &amp;globals)
<a name="l05778"></a>05778          <a class="code" href="lock_8h.html#f4b8158bcd471d4f28b380768e3ee073">ast_rwlock_rdlock</a>(&amp;globalslock);
<a name="l05779"></a>05779       <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(places[i], variables, entries) {
<a name="l05780"></a>05780          <span class="keywordflow">if</span> (!strcmp(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <a class="code" href="chanvars_8c.html#29d40dfad3c6b59de315b3a0d2ed0a23">ast_var_name</a>(variables))) {
<a name="l05781"></a>05781             ret = <a class="code" href="chanvars_8c.html#6aa089cff5424a26ade21a520e443f82">ast_var_value</a>(variables);
<a name="l05782"></a>05782             <span class="keywordflow">break</span>;
<a name="l05783"></a>05783          }
<a name="l05784"></a>05784       }
<a name="l05785"></a>05785       <span class="keywordflow">if</span> (places[i] == &amp;globals)
<a name="l05786"></a>05786          <a class="code" href="lock_8h.html#97ed909ef0a0582cf3870dd0629852c8">ast_rwlock_unlock</a>(&amp;globalslock);
<a name="l05787"></a>05787       <span class="keywordflow">if</span> (ret)
<a name="l05788"></a>05788          <span class="keywordflow">break</span>;
<a name="l05789"></a>05789    }
<a name="l05790"></a>05790 
<a name="l05791"></a>05791    <span class="keywordflow">return</span> ret;
<a name="l05792"></a>05792 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="314bde51a938aa39daab1c3379eed3c7"></a><!-- doxytag: member="pbx.h::pbx_builtin_pushvar_helper" ref="314bde51a938aa39daab1c3379eed3c7" args="(struct ast_channel *chan, const char *name, const char *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pbx_builtin_pushvar_helper           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05794">5794</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l01452">ast_func_write()</a>, <a class="el" href="linkedlists_8h-source.html#l00650">AST_LIST_INSERT_HEAD</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="lock_8h-source.html#l00637">ast_rwlock_unlock()</a>, <a class="el" href="lock_8h-source.html#l00652">ast_rwlock_wrlock()</a>, <a class="el" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>, <a class="el" href="chanvars_8c-source.html#l00039">ast_var_assign()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="channel_8h-source.html#l00467">ast_channel::varshead</a>, and <a class="el" href="logger_8h-source.html#l00044">VERBOSE_PREFIX_2</a>.
<p>
Referenced by <a class="el" href="func__odbc_8c-source.html#l00199">acf_odbc_read()</a>, <a class="el" href="func__odbc_8c-source.html#l00099">acf_odbc_write()</a>, and <a class="el" href="app__stack_8c-source.html#l00193">gosub_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l05795"></a>05795 {
<a name="l05796"></a>05796    <span class="keyword">struct </span><a class="code" href="structast__var__t.html">ast_var_t</a> *newvariable;
<a name="l05797"></a>05797    <span class="keyword">struct </span>varshead *headp;
<a name="l05798"></a>05798 
<a name="l05799"></a>05799    <span class="keywordflow">if</span> (<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>[strlen(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>)-1] == <span class="charliteral">')'</span>) {
<a name="l05800"></a>05800       <span class="keywordtype">char</span> *function = <a class="code" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>(name);
<a name="l05801"></a>05801 
<a name="l05802"></a>05802       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"Cannot push a value onto a function\n"</span>);
<a name="l05803"></a>05803       <a class="code" href="pbx_8c.html#2432c0e88181cb3ba2c1a2764b0a6238">ast_func_write</a>(chan, function, value);
<a name="l05804"></a>05804       <span class="keywordflow">return</span>;
<a name="l05805"></a>05805    }
<a name="l05806"></a>05806 
<a name="l05807"></a>05807    headp = (chan) ? &amp;chan-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a> : &amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>;
<a name="l05808"></a>05808 
<a name="l05809"></a>05809    if (value) {
<a name="l05810"></a>05810       <span class="keywordflow">if</span> ((<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 1) &amp;&amp; (headp == &amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>))
<a name="l05811"></a>05811          <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Setting global variable '%s' to '%s'\n"</span>, name, value);
<a name="l05812"></a>05812       newvariable = <a class="code" href="chanvars_8c.html#4d0028e2dbd755ae38d2fe4204ad9071">ast_var_assign</a>(name, value);
<a name="l05813"></a>05813       <span class="keywordflow">if</span> (headp == &amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>)
<a name="l05814"></a>05814          <a class="code" href="lock_8h.html#25d2e851f878ee9a64d36b67b67ede6e">ast_rwlock_wrlock</a>(&amp;globalslock);
<a name="l05815"></a>05815       <a class="code" href="linkedlists_8h.html#5df56040a8838bdc841ef8eb179b7609">AST_LIST_INSERT_HEAD</a>(headp, newvariable, entries);
<a name="l05816"></a>05816       <span class="keywordflow">if</span> (headp == &amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>)
<a name="l05817"></a>05817          <a class="code" href="lock_8h.html#97ed909ef0a0582cf3870dd0629852c8">ast_rwlock_unlock</a>(&amp;globalslock);
<a name="l05818"></a>05818    }
<a name="l05819"></a>05819 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="54b5d868be87581f886aee1b5fed126a"></a><!-- doxytag: member="pbx.h::pbx_builtin_serialize_variables" ref="54b5d868be87581f886aee1b5fed126a" args="(struct ast_channel *chan, struct ast_str **buf)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int pbx_builtin_serialize_variables           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__str.html">ast_str</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05734">5734</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="strings_8h.html#0c00985509b077cfe0ccdd5829342ca4">ast_str_append()</a>, <a class="el" href="chanvars_8c-source.html#l00062">ast_var_name()</a>, <a class="el" href="chanvars_8c-source.html#l00082">ast_var_value()</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, <a class="el" href="res__adsi_8c-source.html#l00943">total</a>, <a class="el" href="ast__expr2f_8c-source.html#l01417">var</a>, and <a class="el" href="channel_8h-source.html#l00467">ast_channel::varshead</a>.
<p>
Referenced by <a class="el" href="app__dumpchan_8c-source.html#l00143">dumpchan_exec()</a>, <a class="el" href="cli_8c-source.html#l00770">handle_showchan()</a>, and <a class="el" href="app__queue_8c-source.html#l01623">vars2manager()</a>.<div class="fragment"><pre class="fragment"><a name="l05735"></a>05735 {
<a name="l05736"></a>05736    <span class="keyword">struct </span><a class="code" href="structast__var__t.html">ast_var_t</a> *variables;
<a name="l05737"></a>05737    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, *<a class="code" href="structval.html">val</a>;
<a name="l05738"></a>05738    <span class="keywordtype">int</span> <a class="code" href="res__adsi_8c.html#fbb44b4487415b134bce9c790a27fe5e">total</a> = 0;
<a name="l05739"></a>05739 
<a name="l05740"></a>05740    <span class="keywordflow">if</span> (!chan)
<a name="l05741"></a>05741       <span class="keywordflow">return</span> 0;
<a name="l05742"></a>05742 
<a name="l05743"></a>05743    (*buf)-&gt;used = 0;
<a name="l05744"></a>05744    (*buf)-&gt;str[0] = <span class="charliteral">'\0'</span>;
<a name="l05745"></a>05745 
<a name="l05746"></a>05746    <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(&amp;chan-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>, variables, entries) {
<a name="l05747"></a>05747       <span class="keywordflow">if</span> ((var=<a class="code" href="chanvars_8c.html#29d40dfad3c6b59de315b3a0d2ed0a23">ast_var_name</a>(variables)) &amp;&amp; (val=<a class="code" href="chanvars_8c.html#6aa089cff5424a26ade21a520e443f82">ast_var_value</a>(variables))
<a name="l05748"></a>05748          <span class="comment">/* &amp;&amp; !ast_strlen_zero(var) &amp;&amp; !ast_strlen_zero(val) */</span>
<a name="l05749"></a>05749          ) {
<a name="l05750"></a>05750          <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#0c00985509b077cfe0ccdd5829342ca4">ast_str_append</a>(buf, 0, <span class="stringliteral">"%s=%s\n"</span>, var, val) &lt; 0) {
<a name="l05751"></a>05751             <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Data Buffer Size Exceeded!\n"</span>);
<a name="l05752"></a>05752             <span class="keywordflow">break</span>;
<a name="l05753"></a>05753          } <span class="keywordflow">else</span>
<a name="l05754"></a>05754             total++;
<a name="l05755"></a>05755       } <span class="keywordflow">else</span>
<a name="l05756"></a>05756          <span class="keywordflow">break</span>;
<a name="l05757"></a>05757    }
<a name="l05758"></a>05758 
<a name="l05759"></a>05759    <span class="keywordflow">return</span> total;
<a name="l05760"></a>05760 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="069eef65dcddfd8f88fa71b904f52e7a"></a><!-- doxytag: member="pbx.h::pbx_builtin_setvar" ref="069eef65dcddfd8f88fa71b904f52e7a" args="(struct ast_channel *chan, void *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int pbx_builtin_setvar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="64407c916a2de6ae3f0efeca471c1b1d"></a><!-- doxytag: member="pbx.h::pbx_builtin_setvar_helper" ref="64407c916a2de6ae3f0efeca471c1b1d" args="(struct ast_channel *chan, const char *name, const char *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pbx_builtin_setvar_helper           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>chan</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05821">5821</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l01452">ast_func_write()</a>, <a class="el" href="linkedlists_8h-source.html#l00650">AST_LIST_INSERT_HEAD</a>, <a class="el" href="linkedlists_8h-source.html#l00731">AST_LIST_REMOVE</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="lock_8h-source.html#l00637">ast_rwlock_unlock()</a>, <a class="el" href="lock_8h-source.html#l00652">ast_rwlock_wrlock()</a>, <a class="el" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>, <a class="el" href="chanvars_8c-source.html#l00039">ast_var_assign()</a>, <a class="el" href="chanvars_8c-source.html#l00056">ast_var_delete()</a>, <a class="el" href="chanvars_8c-source.html#l00062">ast_var_name()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="channel_8h-source.html#l00467">ast_channel::varshead</a>, and <a class="el" href="logger_8h-source.html#l00044">VERBOSE_PREFIX_2</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l02250">__ast_pbx_run()</a>, <a class="el" href="chan__h323_8c-source.html#l01010">__oh323_new()</a>, <a class="el" href="app__macro_8c-source.html#l00144">_macro_exec()</a>, <a class="el" href="app__while_8c-source.html#l00164">_while_exec()</a>, <a class="el" href="chan__iax2_8c-source.html#l06607">acf_iaxvar_write()</a>, <a class="el" href="func__odbc_8c-source.html#l00199">acf_odbc_read()</a>, <a class="el" href="func__odbc_8c-source.html#l00099">acf_odbc_write()</a>, <a class="el" href="manager_8c-source.html#l01506">action_setvar()</a>, <a class="el" href="res__agi_8c-source.html#l02033">agi_exec_full()</a>, <a class="el" href="app__externalivr_8c-source.html#l00244">app_exec()</a>, <a class="el" href="app__queue_8c-source.html#l03326">aqm_exec()</a>, <a class="el" href="func__strings_8c-source.html#l00204">array()</a>, <a class="el" href="res__features_8c-source.html#l01478">ast_bridge_call()</a>, <a class="el" href="res__features_8c-source.html#l01295">ast_feature_request_and_dial()</a>, <a class="el" href="chan__iax2_8c-source.html#l03426">ast_iax2_new()</a>, <a class="el" href="res__monitor_8c-source.html#l00127">ast_monitor_start()</a>, <a class="el" href="channel_8c-source.html#l04486">ast_set_variables()</a>, <a class="el" href="app__talkdetect_8c-source.html#l00063">background_detect_exec()</a>, <a class="el" href="res__features_8c-source.html#l02716">bridge_exec()</a>, <a class="el" href="res__features_8c-source.html#l00562">builtin_automonitor()</a>, <a class="el" href="res__features_8c-source.html#l00673">builtin_blindtransfer()</a>, <a class="el" href="app__chanisavail_8c-source.html#l00069">chanavail_exec()</a>, <a class="el" href="app__chanspy_8c-source.html#l00266">channel_spy()</a>, <a class="el" href="app__meetme_8c-source.html#l01350">conf_run()</a>, <a class="el" href="app__controlplayback_8c-source.html#l00075">controlplayback_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l02434">count_exec()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="res__features_8c-source.html#l01761">do_parking_thread()</a>, <a class="el" href="app__waitforsilence_8c-source.html#l00078">do_waiting()</a>, <a class="el" href="chan__misdn_8c-source.html#l00493">export_aoc_vars()</a>, <a class="el" href="chan__misdn_8c-source.html#l03713">export_ch()</a>, <a class="el" href="func__db_8c-source.html#l00165">function_db_delete()</a>, <a class="el" href="func__db_8c-source.html#l00121">function_db_exists()</a>, <a class="el" href="func__db_8c-source.html#l00049">function_db_read()</a>, <a class="el" href="chan__sip_8c-source.html#l09150">get_rdnis()</a>, <a class="el" href="func__global_8c-source.html#l00055">global_write()</a>, <a class="el" href="app__stack_8c-source.html#l00091">gosub_release_frame()</a>, <a class="el" href="chan__sip_8c-source.html#l15145">handle_request_bye()</a>, <a class="el" href="pbx_8c-source.html#l03770">handle_set_global()</a>, <a class="el" href="res__agi_8c-source.html#l01178">handle_setvariable()</a>, <a class="el" href="func__strings_8c-source.html#l00316">hash_read()</a>, <a class="el" href="func__strings_8c-source.html#l00296">hash_write()</a>, <a class="el" href="app__amd_8c-source.html#l00097">isAnsweringMachine()</a>, <a class="el" href="app__minivm_8c-source.html#l01501">leave_voicemail()</a>, <a class="el" href="chan__local_8c-source.html#l00488">local_hangup()</a>, <a class="el" href="app__minivm_8c-source.html#l02065">minivm_accmess_exec()</a>, <a class="el" href="app__minivm_8c-source.html#l02021">minivm_delete_exec()</a>, <a class="el" href="app__minivm_8c-source.html#l01818">minivm_greet_exec()</a>, <a class="el" href="app__minivm_8c-source.html#l01673">minivm_notify_exec()</a>, <a class="el" href="app__minivm_8c-source.html#l01751">minivm_record_exec()</a>, <a class="el" href="chan__misdn_8c-source.html#l01948">misdn_call()</a>, <a class="el" href="app__mixmonitor_8c-source.html#l00302">mixmonitor_exec()</a>, <a class="el" href="app__osplookup_8c-source.html#l01311">ospauth_exec()</a>, <a class="el" href="app__osplookup_8c-source.html#l01803">ospfinished_exec()</a>, <a class="el" href="app__osplookup_8c-source.html#l01415">osplookup_exec()</a>, <a class="el" href="app__osplookup_8c-source.html#l01618">ospnext_exec()</a>, <a class="el" href="chan__sip_8c-source.html#l12501">parse_moved_contact()</a>, <a class="el" href="pbx_8c-source.html#l05642">pbx_builtin_background()</a>, <a class="el" href="pbx_8c-source.html#l05901">pbx_builtin_importvar()</a>, <a class="el" href="pbx_8c-source.html#l05866">pbx_builtin_setvar()</a>, <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>, <a class="el" href="pbx__config_8c-source.html#l01332">pbx_load_config()</a>, <a class="el" href="app__voicemail_8c-source.html#l04396">play_message_datetime()</a>, <a class="el" href="app__playback_8c-source.html#l00378">playback_exec()</a>, <a class="el" href="app__queue_8c-source.html#l03157">pqm_exec()</a>, <a class="el" href="app__minivm_8c-source.html#l00738">prep_email_sub_vars()</a>, <a class="el" href="app__privacy_8c-source.html#l00078">privacy_exec()</a>, <a class="el" href="chan__misdn_8c-source.html#l02539">process_ast_dsp()</a>, <a class="el" href="app__read_8c-source.html#l00087">read_exec()</a>, <a class="el" href="app__readfile_8c-source.html#l00056">readfile_exec()</a>, <a class="el" href="app__record_8c-source.html#l00078">record_exec()</a>, <a class="el" href="app__stack_8c-source.html#l00163">return_exec()</a>, <a class="el" href="app__queue_8c-source.html#l03263">rqm_exec()</a>, <a class="el" href="app__image_8c-source.html#l00063">sendimage_exec()</a>, <a class="el" href="app__sendtext_8c-source.html#l00067">sendtext_exec()</a>, <a class="el" href="app__url_8c-source.html#l00070">sendurl_exec()</a>, <a class="el" href="func__logic_8c-source.html#l00121">set()</a>, <a class="el" href="chan__agent_8c-source.html#l00705">set_agentbycallerid()</a>, <a class="el" href="app__queue_8c-source.html#l00419">set_queue_result()</a>, <a class="el" href="chan__sip_8c-source.html#l18113">sip_addheader()</a>, <a class="el" href="chan__sip_8c-source.html#l03676">sip_hangup()</a>, <a class="el" href="chan__sip_8c-source.html#l04179">sip_new()</a>, <a class="el" href="app__meetme_8c-source.html#l04166">sla_station_exec()</a>, <a class="el" href="app__meetme_8c-source.html#l04326">sla_trunk_exec()</a>, <a class="el" href="chan__iax2_8c-source.html#l06624">socket_process()</a>, <a class="el" href="app__speech__utils_8c-source.html#l00346">speech_create()</a>, <a class="el" href="chan__zap_8c-source.html#l05744">ss_thread()</a>, <a class="el" href="res__monitor_8c-source.html#l00389">start_monitor_exec()</a>, <a class="el" href="app__system_8c-source.html#l00085">system_exec_helper()</a>, <a class="el" href="app__transfer_8c-source.html#l00068">transfer_exec()</a>, <a class="el" href="app__exec_8c-source.html#l00126">tryexec_exec()</a>, <a class="el" href="app__queue_8c-source.html#l03210">upqm_exec()</a>, <a class="el" href="app__voicemail_8c-source.html#l07081">vm_box_exists()</a>, <a class="el" href="app__voicemail_8c-source.html#l06944">vm_exec()</a>, <a class="el" href="app__voicemail_8c-source.html#l07154">vmauthenticate()</a>, <a class="el" href="chan__zap_8c-source.html#l03875">zt_handle_dtmfup()</a>, and <a class="el" href="chan__zap_8c-source.html#l05516">zt_new()</a>.<div class="fragment"><pre class="fragment"><a name="l05822"></a>05822 {
<a name="l05823"></a>05823    <span class="keyword">struct </span><a class="code" href="structast__var__t.html">ast_var_t</a> *newvariable;
<a name="l05824"></a>05824    <span class="keyword">struct </span>varshead *headp;
<a name="l05825"></a>05825    <span class="keyword">const</span> <span class="keywordtype">char</span> *nametail = <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>;
<a name="l05826"></a>05826 
<a name="l05827"></a>05827    <span class="comment">/* XXX may need locking on the channel ? */</span>
<a name="l05828"></a>05828    <span class="keywordflow">if</span> (<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>[strlen(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>)-1] == <span class="charliteral">')'</span>) {
<a name="l05829"></a>05829       <span class="keywordtype">char</span> *function = <a class="code" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>(name);
<a name="l05830"></a>05830 
<a name="l05831"></a>05831       <a class="code" href="pbx_8c.html#2432c0e88181cb3ba2c1a2764b0a6238">ast_func_write</a>(chan, function, value);
<a name="l05832"></a>05832       <span class="keywordflow">return</span>;
<a name="l05833"></a>05833    }
<a name="l05834"></a>05834 
<a name="l05835"></a>05835    headp = (chan) ? &amp;chan-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a> : &amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>;
<a name="l05836"></a>05836 
<a name="l05837"></a>05837    <span class="comment">/* For comparison purposes, we have to strip leading underscores */</span>
<a name="l05838"></a>05838    if (*nametail == <span class="charliteral">'_'</span>) {
<a name="l05839"></a>05839       nametail++;
<a name="l05840"></a>05840       <span class="keywordflow">if</span> (*nametail == <span class="charliteral">'_'</span>)
<a name="l05841"></a>05841          nametail++;
<a name="l05842"></a>05842    }
<a name="l05843"></a>05843 
<a name="l05844"></a>05844    <span class="keywordflow">if</span> (headp == &amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>)
<a name="l05845"></a>05845       <a class="code" href="lock_8h.html#25d2e851f878ee9a64d36b67b67ede6e">ast_rwlock_wrlock</a>(&amp;globalslock);
<a name="l05846"></a>05846    <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a> (headp, newvariable, entries) {
<a name="l05847"></a>05847       <span class="keywordflow">if</span> (strcasecmp(<a class="code" href="chanvars_8c.html#29d40dfad3c6b59de315b3a0d2ed0a23">ast_var_name</a>(newvariable), nametail) == 0) {
<a name="l05848"></a>05848          <span class="comment">/* there is already such a variable, delete it */</span>
<a name="l05849"></a>05849          <a class="code" href="linkedlists_8h.html#d4a4c53d3b264b4e1c5e3fdd84cd8b5a">AST_LIST_REMOVE</a>(headp, newvariable, entries);
<a name="l05850"></a>05850          <a class="code" href="chanvars_8c.html#32e018d32324bab845a9cac601c175d8">ast_var_delete</a>(newvariable);
<a name="l05851"></a>05851          <span class="keywordflow">break</span>;
<a name="l05852"></a>05852       }
<a name="l05853"></a>05853    }
<a name="l05854"></a>05854 
<a name="l05855"></a>05855    <span class="keywordflow">if</span> (value) {
<a name="l05856"></a>05856       <span class="keywordflow">if</span> ((<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 1) &amp;&amp; (headp == &amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>))
<a name="l05857"></a>05857          <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#6e3640436a97291b451a8d264b5ab15d">VERBOSE_PREFIX_2</a> <span class="stringliteral">"Setting global variable '%s' to '%s'\n"</span>, name, value);
<a name="l05858"></a>05858       newvariable = <a class="code" href="chanvars_8c.html#4d0028e2dbd755ae38d2fe4204ad9071">ast_var_assign</a>(name, value);
<a name="l05859"></a>05859       <a class="code" href="linkedlists_8h.html#5df56040a8838bdc841ef8eb179b7609">AST_LIST_INSERT_HEAD</a>(headp, newvariable, entries);
<a name="l05860"></a>05860    }
<a name="l05861"></a>05861 
<a name="l05862"></a>05862    <span class="keywordflow">if</span> (headp == &amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a>)
<a name="l05863"></a>05863       <a class="code" href="lock_8h.html#97ed909ef0a0582cf3870dd0629852c8">ast_rwlock_unlock</a>(&amp;globalslock);
<a name="l05864"></a>05864 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="356fc557c1fe7c36e2773ba403e7625a"></a><!-- doxytag: member="pbx.h::pbx_checkcondition" ref="356fc557c1fe7c36e2773ba403e7625a" args="(const char *condition)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int pbx_checkcondition           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>condition</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Evaluate a condition. 
<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if the condition is NULL or of zero length </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>If the string is an integer, the integer representation of the integer is returned </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>1</em>&nbsp;</td><td>Any other non-empty string </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l05947">5947</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="strings_8h-source.html#l00037">ast_strlen_zero()</a>.
<p>
Referenced by <a class="el" href="app__while_8c-source.html#l00164">_while_exec()</a>, <a class="el" href="func__logic_8c-source.html#l00093">acf_if()</a>, <a class="el" href="app__exec_8c-source.html#l00162">execif_exec()</a>, <a class="el" href="app__stack_8c-source.html#l00277">gosubif_exec()</a>, <a class="el" href="app__macro_8c-source.html#l00499">macroif_exec()</a>, and <a class="el" href="pbx_8c-source.html#l05957">pbx_builtin_gotoif()</a>.<div class="fragment"><pre class="fragment"><a name="l05948"></a>05948 {
<a name="l05949"></a>05949    <span class="keywordflow">if</span> (<a class="code" href="strings_8h.html#8ea6cd7603b8f588209bc49c9c29e968">ast_strlen_zero</a>(condition))  <span class="comment">/* NULL or empty strings are false */</span>
<a name="l05950"></a>05950       <span class="keywordflow">return</span> 0;
<a name="l05951"></a>05951    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*condition &gt;= <span class="charliteral">'0'</span> &amp;&amp; *condition &lt;= <span class="charliteral">'9'</span>)   <span class="comment">/* Numbers are evaluated for truth */</span>
<a name="l05952"></a>05952       <span class="keywordflow">return</span> atoi(condition);
<a name="l05953"></a>05953    <span class="keywordflow">else</span>  <span class="comment">/* Strings are true */</span>
<a name="l05954"></a>05954       <span class="keywordflow">return</span> 1;
<a name="l05955"></a>05955 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="5970fbcb6a776848d11bf1c8ddb1c948"></a><!-- doxytag: member="pbx.h::pbx_exec" ref="5970fbcb6a776848d11bf1c8ddb1c948" args="(struct ast_channel *c, struct ast_app *app, void *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int pbx_exec           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct <a class="el" href="structast__app.html">ast_app</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>app</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Execute an application. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>channel to execute on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>app</em>&nbsp;</td><td>which app to execute </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>the data passed into the app</td></tr>
  </table>
</dl>
This application executes an application on a given channel. It saves the stack and executes the given application passing in the given data.<p>
<dl compact><dt><b>Returns:</b></dt><dd>0 on success, and -1 on failure </dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>c</em>&nbsp;</td><td>
Channel </td></tr>
<tr><td valign="top"><em>app</em>&nbsp;</td><td>
Application </td></tr>
<tr><td valign="top"><em>data</em>&nbsp;</td><td>
Data for execution </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00509">509</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00421">ast_channel::appl</a>, <a class="el" href="cdr_8c-source.html#l00718">ast_cdr_setapp()</a>, <a class="el" href="channel_8c-source.html#l00325">ast_check_hangup()</a>, <a class="el" href="channel_8h-source.html#l00451">ast_channel::cdr</a>, <a class="el" href="channel_8h-source.html#l00422">ast_channel::data</a>, and <a class="el" href="structast__app.html#881e868890bc8e5cd8614a1ce80c09eb">ast_app::execute</a>.
<p>
Referenced by <a class="el" href="dial_8c-source.html#l00142">answer_exec_run()</a>, <a class="el" href="res__features_8c-source.html#l01478">ast_bridge_call()</a>, <a class="el" href="pbx_8c-source.html#l05134">ast_pbx_run_app()</a>, <a class="el" href="pbx_8c-source.html#l04903">async_wait()</a>, <a class="el" href="res__features_8c-source.html#l00562">builtin_automonitor()</a>, <a class="el" href="app__meetme_8c-source.html#l01350">conf_run()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="pbx__dundi_8c-source.html#l04479">dundi_exec()</a>, <a class="el" href="app__exec_8c-source.html#l00091">exec_exec()</a>, <a class="el" href="app__exec_8c-source.html#l00162">execif_exec()</a>, <a class="el" href="res__features_8c-source.html#l01098">feature_exec_app()</a>, <a class="el" href="app__voicemail_8c-source.html#l04129">forward_message()</a>, <a class="el" href="res__agi_8c-source.html#l01110">handle_exec()</a>, <a class="el" href="chan__iax2_8c-source.html#l09890">iax2_exec()</a>, <a class="el" href="app__page_8c-source.html#l00085">page_exec()</a>, <a class="el" href="pbx_8c-source.html#l05525">pbx_builtin_execiftime()</a>, <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>, <a class="el" href="pbx__realtime_8c-source.html#l00174">realtime_exec()</a>, <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>, and <a class="el" href="app__exec_8c-source.html#l00126">tryexec_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l00512"></a>00512 {
<a name="l00513"></a>00513    <span class="keywordtype">int</span> res;
<a name="l00514"></a>00514 
<a name="l00515"></a>00515    <span class="keyword">const</span> <span class="keywordtype">char</span> *saved_c_appl;
<a name="l00516"></a>00516    <span class="keyword">const</span> <span class="keywordtype">char</span> *saved_c_data;
<a name="l00517"></a>00517 
<a name="l00518"></a>00518    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a> &amp;&amp;  !<a class="code" href="channel_8c.html#042e64a8d465783855a52ec8c56a9373">ast_check_hangup</a>(c))
<a name="l00519"></a>00519       <a class="code" href="cdr_8c.html#018b6c8a00209b6cf1fd7386b493f930">ast_cdr_setapp</a>(c-&gt;<a class="code" href="structast__channel.html#30491931d0d510243046864dbc71a8c9">cdr</a>, app-&gt;name, data);
<a name="l00520"></a>00520 
<a name="l00521"></a>00521    <span class="comment">/* save channel values */</span>
<a name="l00522"></a>00522    saved_c_appl= c-&gt;<a class="code" href="structast__channel.html#63469c3c4f19f07c737127a117296de4">appl</a>;
<a name="l00523"></a>00523    saved_c_data= c-&gt;<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a>;
<a name="l00524"></a>00524 
<a name="l00525"></a>00525    c-&gt;<a class="code" href="structast__channel.html#63469c3c4f19f07c737127a117296de4">appl</a> = app-&gt;name;
<a name="l00526"></a>00526    c-&gt;<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a> = data;
<a name="l00527"></a>00527    <span class="comment">/* XXX remember what to to when we have linked apps to modules */</span>
<a name="l00528"></a>00528    <span class="keywordflow">if</span> (app-&gt;module) {
<a name="l00529"></a>00529       <span class="comment">/* XXX LOCAL_USER_ADD(app-&gt;module) */</span>
<a name="l00530"></a>00530    }
<a name="l00531"></a>00531    res = app-&gt;<a class="code" href="structast__app.html#881e868890bc8e5cd8614a1ce80c09eb">execute</a>(c, data);
<a name="l00532"></a>00532    <span class="keywordflow">if</span> (app-&gt;module) {
<a name="l00533"></a>00533       <span class="comment">/* XXX LOCAL_USER_REMOVE(app-&gt;module) */</span>
<a name="l00534"></a>00534    }
<a name="l00535"></a>00535    <span class="comment">/* restore channel values */</span>
<a name="l00536"></a>00536    c-&gt;<a class="code" href="structast__channel.html#63469c3c4f19f07c737127a117296de4">appl</a> = saved_c_appl;
<a name="l00537"></a>00537    c-&gt;<a class="code" href="structast__channel.html#8d777f385d3dfec8815d20f7496026dc">data</a> = saved_c_data;
<a name="l00538"></a>00538    <span class="keywordflow">return</span> res;
<a name="l00539"></a>00539 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d407cf204ec8fc50e5a578c8c17e0cb5"></a><!-- doxytag: member="pbx.h::pbx_findapp" ref="d407cf204ec8fc50e5a578c8c17e0cb5" args="(const char *app)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__app.html">ast_app</a>* pbx_findapp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>app</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Look up an application. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>app</em>&nbsp;</td><td>name of the app</td></tr>
  </table>
</dl>
This function searches for the <a class="el" href="structast__app.html">ast_app</a> structure within the apps that are registered for the one with the name you passed in.<p>
<dl compact><dt><b>Returns:</b></dt><dd>the <a class="el" href="structast__app.html">ast_app</a> structure that matches on success, or NULL on failure </dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l00547">547</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00060">AST_RWLIST_RDLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00456">AST_RWLIST_TRAVERSE</a>, and <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>.
<p>
Referenced by <a class="el" href="dial_8c-source.html#l00142">answer_exec_run()</a>, <a class="el" href="res__features_8c-source.html#l01478">ast_bridge_call()</a>, <a class="el" href="pbx_8c-source.html#l05134">ast_pbx_run_app()</a>, <a class="el" href="pbx_8c-source.html#l04903">async_wait()</a>, <a class="el" href="res__features_8c-source.html#l00562">builtin_automonitor()</a>, <a class="el" href="app__meetme_8c-source.html#l01350">conf_run()</a>, <a class="el" href="app__dial_8c-source.html#l01184">dial_exec_full()</a>, <a class="el" href="pbx__dundi_8c-source.html#l04479">dundi_exec()</a>, <a class="el" href="app__exec_8c-source.html#l00091">exec_exec()</a>, <a class="el" href="app__exec_8c-source.html#l00162">execif_exec()</a>, <a class="el" href="res__features_8c-source.html#l01098">feature_exec_app()</a>, <a class="el" href="app__voicemail_8c-source.html#l04129">forward_message()</a>, <a class="el" href="res__agi_8c-source.html#l01110">handle_exec()</a>, <a class="el" href="chan__iax2_8c-source.html#l09890">iax2_exec()</a>, <a class="el" href="app__page_8c-source.html#l00085">page_exec()</a>, <a class="el" href="pbx_8c-source.html#l05525">pbx_builtin_execiftime()</a>, <a class="el" href="pbx_8c-source.html#l01692">pbx_extension_helper()</a>, <a class="el" href="pbx__realtime_8c-source.html#l00174">realtime_exec()</a>, <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>, and <a class="el" href="app__exec_8c-source.html#l00126">tryexec_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l00548"></a>00548 {
<a name="l00549"></a>00549    <span class="keyword">struct </span><a class="code" href="structast__app.html">ast_app</a> *tmp;
<a name="l00550"></a>00550 
<a name="l00551"></a>00551    <a class="code" href="linkedlists_8h.html#23c0c844e5abcb474854867b408e3be8">AST_RWLIST_RDLOCK</a>(&amp;apps);
<a name="l00552"></a>00552    <a class="code" href="linkedlists_8h.html#36b8c64a6c62cb77baa726f81dcaa7f5">AST_RWLIST_TRAVERSE</a>(&amp;apps, tmp, list) {
<a name="l00553"></a>00553       <span class="keywordflow">if</span> (!strcasecmp(tmp-&gt;name, <a class="code" href="adsistub_8c.html#d2a57dc1d883fd21fb9951699df71cc7">app</a>))
<a name="l00554"></a>00554          <span class="keywordflow">break</span>;
<a name="l00555"></a>00555    }
<a name="l00556"></a>00556    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;apps);
<a name="l00557"></a>00557 
<a name="l00558"></a>00558    <span class="keywordflow">return</span> tmp;
<a name="l00559"></a>00559 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="2753b759766c3d305e2551f63e403677"></a><!-- doxytag: member="pbx.h::pbx_retrieve_variable" ref="2753b759766c3d305e2551f63e403677" args="(struct ast_channel *c, const char *var, char **ret, char *workspace, int workspacelen, struct varshead *headp)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pbx_retrieve_variable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>var</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char **&nbsp;</td>
          <td class="mdname" nowrap> <em>ret</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>workspace</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>workspacelen</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct varshead *&nbsp;</td>
          <td class="mdname" nowrap> <em>headp</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Support for Asterisk built-in variables in the dialplan. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>See also<ul>
<li><a class="el" href="AstVar.html">Globally predefined channel variables</a> Channel variables</li><li><a class="el" href="AstCauses.html">Hangup Causes for Asterisk</a> The HANGUPCAUSE variable </li></ul>
</dd></dl>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01132">1132</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="asterisk_8c-source.html#l00230">ast_config_AST_SYSTEM_NAME</a>, <a class="el" href="pbx_8c-source.html#l02166">ast_get_hint()</a>, <a class="el" href="linkedlists_8h-source.html#l00453">AST_LIST_TRAVERSE</a>, <a class="el" href="lock_8h-source.html#l00642">ast_rwlock_rdlock()</a>, <a class="el" href="lock_8h-source.html#l00637">ast_rwlock_unlock()</a>, <a class="el" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>, <a class="el" href="chanvars_8c-source.html#l00062">ast_var_name()</a>, <a class="el" href="chanvars_8c-source.html#l00082">ast_var_value()</a>, <a class="el" href="channel_8h-source.html#l00437">ast_channel::cid</a>, <a class="el" href="channel_8h-source.html#l00217">ast_callerid::cid_ani2</a>, <a class="el" href="channel_8h-source.html#l00216">ast_callerid::cid_pres</a>, <a class="el" href="channel_8h-source.html#l00219">ast_callerid::cid_tns</a>, <a class="el" href="channel_8h-source.html#l00218">ast_callerid::cid_ton</a>, <a class="el" href="channel_8h-source.html#l00441">ast_channel::context</a>, <a class="el" href="channel_8h-source.html#l00442">ast_channel::exten</a>, <a class="el" href="channel_8h-source.html#l00466">ast_channel::hangupcause</a>, <a class="el" href="chan__alsa_8c-source.html#l00183">offset</a>, <a class="el" href="pbx_8c-source.html#l01060">parse_variable_name()</a>, <a class="el" href="channel_8h-source.html#l00443">ast_channel::priority</a>, <a class="el" href="aesopt_8h-source.html#l00399">s</a>, <a class="el" href="pbx_8c-source.html#l01090">substring()</a>, and <a class="el" href="channel_8h-source.html#l00467">ast_channel::varshead</a>.
<p>
Referenced by <a class="el" href="manager_8c-source.html#l01548">action_getvar()</a>, <a class="el" href="res__agi_8c-source.html#l01187">handle_getvariable()</a>, and <a class="el" href="pbx_8c-source.html#l01468">pbx_substitute_variables_helper_full()</a>.<div class="fragment"><pre class="fragment"><a name="l01133"></a>01133 {
<a name="l01134"></a>01134    <span class="keyword">const</span> <span class="keywordtype">char</span> not_found = <span class="charliteral">'\0'</span>;
<a name="l01135"></a>01135    <span class="keywordtype">char</span> *tmpvar;
<a name="l01136"></a>01136    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="aesopt_8h.html#8d6242bc80162ac99dd4d368eabe77cc">s</a>; <span class="comment">/* the result */</span>
<a name="l01137"></a>01137    <span class="keywordtype">int</span> <a class="code" href="chan__alsa_8c.html#7a86c157ee9713c34fbd7a1ee40f0c5a">offset</a>, length;
<a name="l01138"></a>01138    <span class="keywordtype">int</span> i, need_substring;
<a name="l01139"></a>01139    <span class="keyword">struct </span>varshead *places[2] = { headp, &amp;<a class="code" href="pbx_8c.html#0c54ed5f674437c1eba26ffc6c786909">globals</a> };  <span class="comment">/* list of places where we may look */</span>
<a name="l01140"></a>01140 
<a name="l01141"></a>01141    <span class="keywordflow">if</span> (c) {
<a name="l01142"></a>01142       places[0] = &amp;c-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a>;
<a name="l01143"></a>01143    }
<a name="l01144"></a>01144    <span class="comment">/*</span>
<a name="l01145"></a>01145 <span class="comment">    * Make a copy of var because parse_variable_name() modifies the string.</span>
<a name="l01146"></a>01146 <span class="comment">    * Then if called directly, we might need to run substring() on the result;</span>
<a name="l01147"></a>01147 <span class="comment">    * remember this for later in 'need_substring', 'offset' and 'length'</span>
<a name="l01148"></a>01148 <span class="comment">    */</span>
<a name="l01149"></a>01149    tmpvar = <a class="code" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>); <span class="comment">/* parse_variable_name modifies the string */</span>
<a name="l01150"></a>01150    need_substring = <a class="code" href="pbx_8c.html#1f596dad2120f1ef7d9cceea084686cc">parse_variable_name</a>(tmpvar, &amp;offset, &amp;length, &amp;i <span class="comment">/* ignored */</span>);
<a name="l01151"></a>01151 
<a name="l01152"></a>01152    <span class="comment">/*</span>
<a name="l01153"></a>01153 <span class="comment">    * Look first into predefined variables, then into variable lists.</span>
<a name="l01154"></a>01154 <span class="comment">    * Variable 's' points to the result, according to the following rules:</span>
<a name="l01155"></a>01155 <span class="comment">    * s == &amp;not_found (set at the beginning) means that we did not find a</span>
<a name="l01156"></a>01156 <span class="comment">    * matching variable and need to look into more places.</span>
<a name="l01157"></a>01157 <span class="comment">    * If s != &amp;not_found, s is a valid result string as follows:</span>
<a name="l01158"></a>01158 <span class="comment">    * s = NULL if the variable does not have a value;</span>
<a name="l01159"></a>01159 <span class="comment">    * you typically do this when looking for an unset predefined variable.</span>
<a name="l01160"></a>01160 <span class="comment">    * s = workspace if the result has been assembled there;</span>
<a name="l01161"></a>01161 <span class="comment">    * typically done when the result is built e.g. with an snprintf(),</span>
<a name="l01162"></a>01162 <span class="comment">    * so we don't need to do an additional copy.</span>
<a name="l01163"></a>01163 <span class="comment">    * s != workspace in case we have a string, that needs to be copied</span>
<a name="l01164"></a>01164 <span class="comment">    * (the ast_copy_string is done once for all at the end).</span>
<a name="l01165"></a>01165 <span class="comment">    * Typically done when the result is already available in some string.</span>
<a name="l01166"></a>01166 <span class="comment">    */</span>
<a name="l01167"></a>01167    s = &amp;not_found;   <span class="comment">/* default value */</span>
<a name="l01168"></a>01168    <span class="keywordflow">if</span> (c) { <span class="comment">/* This group requires a valid channel */</span>
<a name="l01169"></a>01169       <span class="comment">/* Names with common parts are looked up a piece at a time using strncmp. */</span>
<a name="l01170"></a>01170       <span class="keywordflow">if</span> (!strncmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"CALL"</span>, 4)) {
<a name="l01171"></a>01171          <span class="keywordflow">if</span> (!strncmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a> + 4, <span class="stringliteral">"ING"</span>, 3)) {
<a name="l01172"></a>01172             <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a> + 7, <span class="stringliteral">"PRES"</span>)) {        <span class="comment">/* CALLINGPRES */</span>
<a name="l01173"></a>01173                snprintf(workspace, workspacelen, <span class="stringliteral">"%d"</span>, c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#872e42fb90e7d76ff7350f6741f567ff">cid_pres</a>);
<a name="l01174"></a>01174                s = workspace;
<a name="l01175"></a>01175             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a> + 7, <span class="stringliteral">"ANI2"</span>)) {    <span class="comment">/* CALLINGANI2 */</span>
<a name="l01176"></a>01176                snprintf(workspace, workspacelen, <span class="stringliteral">"%d"</span>, c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#644bbeb978ab62db10db9fd8cdaef142">cid_ani2</a>);
<a name="l01177"></a>01177                s = workspace;
<a name="l01178"></a>01178             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a> + 7, <span class="stringliteral">"TON"</span>)) {     <span class="comment">/* CALLINGTON */</span>
<a name="l01179"></a>01179                snprintf(workspace, workspacelen, <span class="stringliteral">"%d"</span>, c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#ed6d65567170b0bab67f0616396d247f">cid_ton</a>);
<a name="l01180"></a>01180                s = workspace;
<a name="l01181"></a>01181             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a> + 7, <span class="stringliteral">"TNS"</span>)) {     <span class="comment">/* CALLINGTNS */</span>
<a name="l01182"></a>01182                snprintf(workspace, workspacelen, <span class="stringliteral">"%d"</span>, c-&gt;<a class="code" href="structast__channel.html#4b7cc5694dd3a265bac326eaba31266e">cid</a>.<a class="code" href="structast__callerid.html#9010703800c4f5d446cfc1ad720bba2d">cid_tns</a>);
<a name="l01183"></a>01183                s = workspace;
<a name="l01184"></a>01184             }
<a name="l01185"></a>01185          }
<a name="l01186"></a>01186       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"HINT"</span>)) {
<a name="l01187"></a>01187          s = <a class="code" href="pbx_8c.html#b654f3264742a57f212c38761672a6c0">ast_get_hint</a>(workspace, workspacelen, NULL, 0, c, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>) ? workspace : NULL;
<a name="l01188"></a>01188       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"HINTNAME"</span>)) {
<a name="l01189"></a>01189          s = <a class="code" href="pbx_8c.html#b654f3264742a57f212c38761672a6c0">ast_get_hint</a>(NULL, 0, workspace, workspacelen, c, c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>, c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>) ? workspace : NULL;
<a name="l01190"></a>01190       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"EXTEN"</span>)) {
<a name="l01191"></a>01191          s = c-&gt;<a class="code" href="structast__channel.html#5aedfeaeaac21e5e5f297360633ea9a3">exten</a>;
<a name="l01192"></a>01192       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"CONTEXT"</span>)) {
<a name="l01193"></a>01193          s = c-&gt;<a class="code" href="structast__channel.html#c1ae8ba118483c4c23841d72b5e7ebbb">context</a>;
<a name="l01194"></a>01194       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"PRIORITY"</span>)) {
<a name="l01195"></a>01195          snprintf(workspace, workspacelen, <span class="stringliteral">"%d"</span>, c-&gt;<a class="code" href="structast__channel.html#b988295c268025b49dfb3df26171ddc3">priority</a>);
<a name="l01196"></a>01196          s = workspace;
<a name="l01197"></a>01197       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"CHANNEL"</span>)) {
<a name="l01198"></a>01198          s = c-&gt;name;
<a name="l01199"></a>01199       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"UNIQUEID"</span>)) {
<a name="l01200"></a>01200          s = c-&gt;uniqueid;
<a name="l01201"></a>01201       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"HANGUPCAUSE"</span>)) {
<a name="l01202"></a>01202          snprintf(workspace, workspacelen, <span class="stringliteral">"%d"</span>, c-&gt;<a class="code" href="structast__channel.html#8be5f831332d8ff714e90c2cf85171fe">hangupcause</a>);
<a name="l01203"></a>01203          s = workspace;
<a name="l01204"></a>01204       }
<a name="l01205"></a>01205    }
<a name="l01206"></a>01206    <span class="keywordflow">if</span> (s == &amp;not_found) { <span class="comment">/* look for more */</span>
<a name="l01207"></a>01207       <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"EPOCH"</span>)) {
<a name="l01208"></a>01208          snprintf(workspace, workspacelen, <span class="stringliteral">"%u"</span>,(<span class="keywordtype">int</span>)time(NULL));
<a name="l01209"></a>01209          s = workspace;
<a name="l01210"></a>01210       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>, <span class="stringliteral">"SYSTEMNAME"</span>)) {
<a name="l01211"></a>01211          s = <a class="code" href="asterisk_8c.html#0a0f8ba4c757a1da509a0cae1830025b">ast_config_AST_SYSTEM_NAME</a>;
<a name="l01212"></a>01212       }
<a name="l01213"></a>01213    }
<a name="l01214"></a>01214    <span class="comment">/* if not found, look into chanvars or global vars */</span>
<a name="l01215"></a>01215    <span class="keywordflow">for</span> (i = 0; s == &amp;not_found &amp;&amp; i &lt; (<span class="keyword">sizeof</span>(places) / <span class="keyword">sizeof</span>(places[0])); i++) {
<a name="l01216"></a>01216       <span class="keyword">struct </span><a class="code" href="structast__var__t.html">ast_var_t</a> *variables;
<a name="l01217"></a>01217       <span class="keywordflow">if</span> (!places[i])
<a name="l01218"></a>01218          <span class="keywordflow">continue</span>;
<a name="l01219"></a>01219       <span class="keywordflow">if</span> (places[i] == &amp;globals)
<a name="l01220"></a>01220          <a class="code" href="lock_8h.html#f4b8158bcd471d4f28b380768e3ee073">ast_rwlock_rdlock</a>(&amp;globalslock);
<a name="l01221"></a>01221       <a class="code" href="linkedlists_8h.html#e5bbda4b7ef1cd9462bb86ba25c5d7eb">AST_LIST_TRAVERSE</a>(places[i], variables, entries) {
<a name="l01222"></a>01222          <span class="keywordflow">if</span> (strcasecmp(<a class="code" href="chanvars_8c.html#29d40dfad3c6b59de315b3a0d2ed0a23">ast_var_name</a>(variables), <a class="code" href="ast__expr2f_8c.html#b2145aac704ce76dbe1ac7adac535b23">var</a>)==0) {
<a name="l01223"></a>01223             s = <a class="code" href="chanvars_8c.html#6aa089cff5424a26ade21a520e443f82">ast_var_value</a>(variables);
<a name="l01224"></a>01224             <span class="keywordflow">break</span>;
<a name="l01225"></a>01225          }
<a name="l01226"></a>01226       }
<a name="l01227"></a>01227       <span class="keywordflow">if</span> (places[i] == &amp;globals)
<a name="l01228"></a>01228          <a class="code" href="lock_8h.html#97ed909ef0a0582cf3870dd0629852c8">ast_rwlock_unlock</a>(&amp;globalslock);
<a name="l01229"></a>01229    }
<a name="l01230"></a>01230    <span class="keywordflow">if</span> (s == &amp;not_found || s == NULL)
<a name="l01231"></a>01231       *ret = NULL;
<a name="l01232"></a>01232    <span class="keywordflow">else</span> {
<a name="l01233"></a>01233       <span class="keywordflow">if</span> (s != workspace)
<a name="l01234"></a>01234          ast_copy_string(workspace, s, workspacelen);
<a name="l01235"></a>01235       *ret = workspace;
<a name="l01236"></a>01236       <span class="keywordflow">if</span> (need_substring)
<a name="l01237"></a>01237          *ret = <a class="code" href="pbx_8c.html#04e7768e5fe29c8e12f2f22671d1b63d">substring</a>(*ret, offset, length, workspace, workspacelen);
<a name="l01238"></a>01238    }
<a name="l01239"></a>01239 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ea7c4ebeb23de4a6efa64ef901058db6"></a><!-- doxytag: member="pbx.h::pbx_set_autofallthrough" ref="ea7c4ebeb23de4a6efa64ef901058db6" args="(int newval)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int pbx_set_autofallthrough           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>newval</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set "autofallthrough" flag, if newval is &lt;0, does not acutally set. If set to 1, sets to auto fall through. If newval set to 0, sets to no auto fall through (reads extension instead). Returns previous value. 
<p>
Definition at line <a class="el" href="pbx_8c-source.html#l02590">2590</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l00249">autofallthrough</a>.
<p>
Referenced by <a class="el" href="pbx__config_8c-source.html#l01596">pbx_load_module()</a>.<div class="fragment"><pre class="fragment"><a name="l02591"></a>02591 {
<a name="l02592"></a>02592    <span class="keywordtype">int</span> oldval = <a class="code" href="pbx_8c.html#509cd842fa6ca4f1b6be7d908dbedf09">autofallthrough</a>;
<a name="l02593"></a>02593    <a class="code" href="pbx_8c.html#509cd842fa6ca4f1b6be7d908dbedf09">autofallthrough</a> = newval;
<a name="l02594"></a>02594    <span class="keywordflow">return</span> oldval;
<a name="l02595"></a>02595 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="7f62e5d5f926a2eeedb559b6afd3d80a"></a><!-- doxytag: member="pbx.h::pbx_substitute_variables_helper" ref="7f62e5d5f926a2eeedb559b6afd3d80a" args="(struct ast_channel *c, const char *cp1, char *cp2, int count)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pbx_substitute_variables_helper           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structast__channel.html">ast_channel</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cp1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cp2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>count</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01660">1660</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l01468">pbx_substitute_variables_helper_full()</a>, and <a class="el" href="channel_8h-source.html#l00467">ast_channel::varshead</a>.
<p>
Referenced by <a class="el" href="func__odbc_8c-source.html#l00199">acf_odbc_read()</a>, <a class="el" href="func__odbc_8c-source.html#l00099">acf_odbc_write()</a>, <a class="el" href="cdr__custom_8c-source.html#l00106">custom_log()</a>, <a class="el" href="func__cut_8c-source.html#l00118">cut_internal()</a>, <a class="el" href="app__exec_8c-source.html#l00091">exec_exec()</a>, <a class="el" href="func__strings_8c-source.html#l00681">function_eval()</a>, <a class="el" href="func__strings_8c-source.html#l00048">function_fieldqty()</a>, <a class="el" href="pbx__dundi_8c-source.html#l00519">get_mapping_weight()</a>, <a class="el" href="res__agi_8c-source.html#l01210">handle_getvariablefull()</a>, <a class="el" href="app__mixmonitor_8c-source.html#l00229">launch_monitor_thread()</a>, <a class="el" href="app__voicemail_8c-source.html#l01965">make_email_file()</a>, <a class="el" href="pbx_8c-source.html#l05901">pbx_builtin_importvar()</a>, <a class="el" href="pbx_8c-source.html#l00934">pbx_find_extension()</a>, <a class="el" href="pbx__config_8c-source.html#l01332">pbx_load_config()</a>, <a class="el" href="pbx_8c-source.html#l01670">pbx_substitute_variables()</a>, <a class="el" href="pbx__realtime_8c-source.html#l00174">realtime_exec()</a>, <a class="el" href="app__rpt_8c-source.html#l01329">rpt_do_lstats()</a>, <a class="el" href="app__rpt_8c-source.html#l06759">rpt_exec()</a>, <a class="el" href="app__minivm_8c-source.html#l00892">sendmail()</a>, <a class="el" href="app__voicemail_8c-source.html#l02166">sendpage()</a>, <a class="el" href="cdr__sqlite3__custom_8c-source.html#l00151">sqlite3_log()</a>, <a class="el" href="app__queue_8c-source.html#l02421">try_calling()</a>, and <a class="el" href="app__exec_8c-source.html#l00126">tryexec_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l01661"></a>01661 {
<a name="l01662"></a>01662    <a class="code" href="pbx_8c.html#8055099d4774142bb312da4f1e35be1e">pbx_substitute_variables_helper_full</a>(c, (c) ? &amp;c-&gt;<a class="code" href="structast__channel.html#104b87f05b6aae74d9ba38d4c91f2e11">varshead</a> : NULL, cp1, cp2, count);
<a name="l01663"></a>01663 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="9c87adf1e75b8a9298ffc59378531172"></a><!-- doxytag: member="pbx.h::pbx_substitute_variables_varshead" ref="9c87adf1e75b8a9298ffc59378531172" args="(struct varshead *headp, const char *cp1, char *cp2, int count)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pbx_substitute_variables_varshead           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct varshead *&nbsp;</td>
          <td class="mdname" nowrap> <em>headp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cp1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cp2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>count</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pbx_8c-source.html#l01665">1665</a> of file <a class="el" href="pbx_8c-source.html">pbx.c</a>.
<p>
References <a class="el" href="pbx_8c-source.html#l01468">pbx_substitute_variables_helper_full()</a>.
<p>
Referenced by <a class="el" href="pbx_8c-source.html#l04765">ast_add_extension2()</a>, <a class="el" href="app__playback_8c-source.html#l00147">do_say()</a>, <a class="el" href="pbx__dundi_8c-source.html#l00532">dundi_lookup_local()</a>, and <a class="el" href="pbx__loopback_8c-source.html#l00083">loopback_helper()</a>.<div class="fragment"><pre class="fragment"><a name="l01666"></a>01666 {
<a name="l01667"></a>01667    <a class="code" href="pbx_8c.html#8055099d4774142bb312da4f1e35be1e">pbx_substitute_variables_helper_full</a>(NULL, headp, cp1, cp2, count);
<a name="l01668"></a>01668 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Thu May 24 22:27:40 2007 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.5 </small></address>
</body>
</html>
