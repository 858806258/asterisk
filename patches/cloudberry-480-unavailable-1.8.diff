Index: channels/chan_sip.c
===================================================================
--- channels/chan_sip.c	(.../branches/1.8)	(revision 402882)
+++ channels/chan_sip.c	(.../team/oej/cloudberry-480-unavailable-1.8)	(revision 402882)
@@ -21204,14 +21204,23 @@
 	case 408: /* Request timeout */
 	case 405: /* Not allowed */
 	case 501: /* Not implemented */
+	case 480: /* Temporarily Unavailable */
+	case 482: /* Loop Detected */
+	case 410: /* Gone */
+	case 400: /* Bad Request */
+	case 500: /* Server error */
+	case 502: /* Bad gateway */
+	case 503: /* Service Unavailable */
 		xmitres = transmit_request(p, SIP_ACK, seqno, XMIT_UNRELIABLE, FALSE);
 		if (p->owner) {
 			ast_queue_hangup_with_cause(p->owner, hangup_sip2cause(resp));
 		}
 		break;
+
 	}
-	if (xmitres == XMIT_ERROR)
+	if (xmitres == XMIT_ERROR) {
 		ast_log(LOG_WARNING, "Could not transmit message in dialog %s\n", p->callid);
+	}
 }
 
 /* \brief Handle SIP response in NOTIFY transaction
@@ -22060,8 +22069,12 @@
 				case 502: /* Bad gateway */
 				case 503: /* Service Unavailable */
 				case 504: /* Server Timeout */
-					if (owner)
-						ast_queue_control(p->owner, AST_CONTROL_CONGESTION);
+					if (sipmethod == SIP_INVITE) {
+						handle_response_invite(p, resp, rest, req, seqno);
+					} else {
+						if (owner)
+							ast_queue_control(p->owner, AST_CONTROL_CONGESTION);
+					}
 					break;
 				case 484: /* Address Incomplete */
 					if (owner && sipmethod != SIP_BYE) {
