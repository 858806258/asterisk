<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (24 May 2007)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Thu May 24 22:27:26 2007</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir__2Fusr_2Flocal_2Fsrc_2Fasterisk_2Esvn_2Fastum_2Finclude_2F.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir__2Fusr_2Flocal_2Fsrc_2Fasterisk_2Esvn_2Fastum_2Finclude_2Fasterisk_2F.html">asterisk</a></div>
<h1>devicestate.h File Reference</h1>Device state management. <a href="#_details">More...</a>
<p>

<p>
<a href="devicestate_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef int(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="devicestate_8h.html#46d6f3eba391a4a61601a0373570df6f">ast_devstate_cb_type</a> )(const char *dev, enum <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e">ast_device_state</a> <a class="el" href="structstate.html">state</a>, void *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Devicestate watcher call back.  <a href="#46d6f3eba391a4a61601a0373570df6f"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e">ast_device_state</a> { <br>
&nbsp;&nbsp;<a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9ec0882f63fc5e52ac924c0e826d4782d3">AST_DEVICE_UNKNOWN</a>, 
<a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e0fe2efc106235ced7c3742c8fb054544">AST_DEVICE_NOT_INUSE</a>, 
<a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9eb54883b8e5fcba0b30f9db4b98eb0f42">AST_DEVICE_INUSE</a>, 
<a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e1036467dfee7c023a3b7a28e45f7ef21">AST_DEVICE_BUSY</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e9cc12f38e2eec4c5ed63a43bc967834d">AST_DEVICE_INVALID</a>, 
<a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9eedbb8a648c9f4b3dfb164b9d5cf5cabb">AST_DEVICE_UNAVAILABLE</a>, 
<a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e4f429c553fc5d377aa9966350ff34d44">AST_DEVICE_RINGING</a>, 
<a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e3ee5721810b67dd7c7bad7036ce97f37">AST_DEVICE_RINGINUSE</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9ecec0bdf83d7b3e88d7e376422f6ba00d">AST_DEVICE_ONHOLD</a>
<br>
 }</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e">ast_device_state</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="devicestate_8h.html#108baa7a6e968d91099ef15c445e215c">ast_device_state</a> (const char *device)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Asks a channel for device state.  <a href="#108baa7a6e968d91099ef15c445e215c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="devicestate_8h.html#1ebe9ed719fcc93a2470a6d0f32f2b09">ast_device_state_changed</a> (const char *<a class="el" href="strings_8h.html#7631454338ff70b1a6b1262f5f36beac">fmt</a>,...) <a class="el" href="struct____attribute____.html">__attribute__</a>((<a class="el" href="cdr__custom_8c.html#b954976e6264c40232046aacb5b7c390">format</a>(printf</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tells Asterisk the State for Device is changed.  <a href="#1ebe9ed719fcc93a2470a6d0f32f2b09"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="devicestate_8h.html#61240e3c80f0696af9fcb72a5d7ec925">ast_device_state_changed_literal</a> (const char *device)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tells Asterisk the State for Device is changed.  <a href="#61240e3c80f0696af9fcb72a5d7ec925"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="devicestate_8h.html#3975a4eaeb7e540ec5c2b368d3c803c2">ast_device_state_engine_init</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize the device state engine in separate thread.  <a href="#3975a4eaeb7e540ec5c2b368d3c803c2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="devicestate_8h.html#9eb1911b7b709c7cd82fe352690b75dd">ast_devstate_add</a> (<a class="el" href="devicestate_8h.html#46d6f3eba391a4a61601a0373570df6f">ast_devstate_cb_type</a> callback, void *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Registers a device state change callback.  <a href="#9eb1911b7b709c7cd82fe352690b75dd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="devicestate_8h.html#7d4add30d8667d7e2945e49dc8c67323">ast_devstate_del</a> (<a class="el" href="devicestate_8h.html#46d6f3eba391a4a61601a0373570df6f">ast_devstate_cb_type</a> callback, void *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unregisters a device state change callback.  <a href="#7d4add30d8667d7e2945e49dc8c67323"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="devicestate_8h.html#bb0b7d59cba82040757824a5e6df4cf1">ast_devstate_prov_add</a> (const char *label, <a class="el" href="devicestate_8h.html#ff6ddc7f6403e464dfb4f2e35453b308">ast_devstate_prov_cb_type</a> callback)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add device state provider.  <a href="#bb0b7d59cba82040757824a5e6df4cf1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="devicestate_8h.html#1996c0db248eebe4b033249932023f02">ast_devstate_prov_del</a> (const char *label)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove device state provider.  <a href="#1996c0db248eebe4b033249932023f02"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="devicestate_8h.html#71c1ca5e00cff64884e5d1c519925d26">ast_devstate_str</a> (enum <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e">ast_device_state</a> devstate)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert device state to text string that is easier to parse.  <a href="#71c1ca5e00cff64884e5d1c519925d26"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e">ast_device_state</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="devicestate_8h.html#ec5d8d519ef0c2b6fa5c1c46ba5c0b2a">ast_devstate_val</a> (const char *<a class="el" href="structval.html">val</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert device state from text to integer value.  <a href="#ec5d8d519ef0c2b6fa5c1c46ba5c0b2a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e">ast_device_state</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="devicestate_8h.html#fc0363f5b3377019e19ab7095e6d3a2f">ast_parse_device_state</a> (const char *device)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Search the Channels by Name.  <a href="#fc0363f5b3377019e19ab7095e6d3a2f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="devicestate_8h.html#7dbbe3294576db414214a8b1c7d8c074">devstate2str</a> (enum <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e">ast_device_state</a> devstate)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert device state to text string for output.  <a href="#7dbbe3294576db414214a8b1c7d8c074"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e">ast_device_state</a>(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="devicestate_8h.html#ff6ddc7f6403e464dfb4f2e35453b308">ast_devstate_prov_cb_type</a> )(const char *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Devicestate provider call back.  <a href="#ff6ddc7f6403e464dfb4f2e35453b308"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Device state management. 
<p>
<ul>
<li>See <a class="el" href="AstExtState.html">Extension and device states in Asterisk</a> </li>
</ul>

<p>
Definition in file <a class="el" href="devicestate_8h-source.html">devicestate.h</a>.<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="46d6f3eba391a4a61601a0373570df6f"></a><!-- doxytag: member="devicestate.h::ast_devstate_cb_type" ref="46d6f3eba391a4a61601a0373570df6f" args=")(const char *dev, enum ast_device_state state, void *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">typedef int(* <a class="el" href="devicestate_8h.html#46d6f3eba391a4a61601a0373570df6f">ast_devstate_cb_type</a>)(const char *dev, enum <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e">ast_device_state</a> <a class="el" href="structstate.html">state</a>, void *data)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Devicestate watcher call back. 
<p>

<p>
Definition at line <a class="el" href="devicestate_8h-source.html#l00046">46</a> of file <a class="el" href="devicestate_8h-source.html">devicestate.h</a>.    </td>
  </tr>
</table>
<hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="b32c9d7f2a117281efcc381ee116cc9e"></a><!-- doxytag: member="devicestate.h::ast_device_state" ref="b32c9d7f2a117281efcc381ee116cc9e" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e">ast_device_state</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Device States <dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="b32c9d7f2a117281efcc381ee116cc9ec0882f63fc5e52ac924c0e826d4782d3"></a><!-- doxytag: member="AST_DEVICE_UNKNOWN" ref="b32c9d7f2a117281efcc381ee116cc9ec0882f63fc5e52ac924c0e826d4782d3" args="" -->AST_DEVICE_UNKNOWN</em>&nbsp;</td><td>
Device is valid but channel didn't know state </td></tr>
<tr><td valign="top"><em><a class="anchor" name="b32c9d7f2a117281efcc381ee116cc9e0fe2efc106235ced7c3742c8fb054544"></a><!-- doxytag: member="AST_DEVICE_NOT_INUSE" ref="b32c9d7f2a117281efcc381ee116cc9e0fe2efc106235ced7c3742c8fb054544" args="" -->AST_DEVICE_NOT_INUSE</em>&nbsp;</td><td>
Device is not used </td></tr>
<tr><td valign="top"><em><a class="anchor" name="b32c9d7f2a117281efcc381ee116cc9eb54883b8e5fcba0b30f9db4b98eb0f42"></a><!-- doxytag: member="AST_DEVICE_INUSE" ref="b32c9d7f2a117281efcc381ee116cc9eb54883b8e5fcba0b30f9db4b98eb0f42" args="" -->AST_DEVICE_INUSE</em>&nbsp;</td><td>
Device is in use </td></tr>
<tr><td valign="top"><em><a class="anchor" name="b32c9d7f2a117281efcc381ee116cc9e1036467dfee7c023a3b7a28e45f7ef21"></a><!-- doxytag: member="AST_DEVICE_BUSY" ref="b32c9d7f2a117281efcc381ee116cc9e1036467dfee7c023a3b7a28e45f7ef21" args="" -->AST_DEVICE_BUSY</em>&nbsp;</td><td>
Device is busy </td></tr>
<tr><td valign="top"><em><a class="anchor" name="b32c9d7f2a117281efcc381ee116cc9e9cc12f38e2eec4c5ed63a43bc967834d"></a><!-- doxytag: member="AST_DEVICE_INVALID" ref="b32c9d7f2a117281efcc381ee116cc9e9cc12f38e2eec4c5ed63a43bc967834d" args="" -->AST_DEVICE_INVALID</em>&nbsp;</td><td>
Device is invalid </td></tr>
<tr><td valign="top"><em><a class="anchor" name="b32c9d7f2a117281efcc381ee116cc9eedbb8a648c9f4b3dfb164b9d5cf5cabb"></a><!-- doxytag: member="AST_DEVICE_UNAVAILABLE" ref="b32c9d7f2a117281efcc381ee116cc9eedbb8a648c9f4b3dfb164b9d5cf5cabb" args="" -->AST_DEVICE_UNAVAILABLE</em>&nbsp;</td><td>
Device is unavailable </td></tr>
<tr><td valign="top"><em><a class="anchor" name="b32c9d7f2a117281efcc381ee116cc9e4f429c553fc5d377aa9966350ff34d44"></a><!-- doxytag: member="AST_DEVICE_RINGING" ref="b32c9d7f2a117281efcc381ee116cc9e4f429c553fc5d377aa9966350ff34d44" args="" -->AST_DEVICE_RINGING</em>&nbsp;</td><td>
Device is ringing </td></tr>
<tr><td valign="top"><em><a class="anchor" name="b32c9d7f2a117281efcc381ee116cc9e3ee5721810b67dd7c7bad7036ce97f37"></a><!-- doxytag: member="AST_DEVICE_RINGINUSE" ref="b32c9d7f2a117281efcc381ee116cc9e3ee5721810b67dd7c7bad7036ce97f37" args="" -->AST_DEVICE_RINGINUSE</em>&nbsp;</td><td>
Device is ringing *and* in use </td></tr>
<tr><td valign="top"><em><a class="anchor" name="b32c9d7f2a117281efcc381ee116cc9ecec0bdf83d7b3e88d7e376422f6ba00d"></a><!-- doxytag: member="AST_DEVICE_ONHOLD" ref="b32c9d7f2a117281efcc381ee116cc9ecec0bdf83d7b3e88d7e376422f6ba00d" args="" -->AST_DEVICE_ONHOLD</em>&nbsp;</td><td>
Device is on hold </td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="devicestate_8h-source.html#l00033">33</a> of file <a class="el" href="devicestate_8h-source.html">devicestate.h</a>.<div class="fragment"><pre class="fragment"><a name="l00033"></a>00033                       {
<a name="l00034"></a>00034    <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9ec0882f63fc5e52ac924c0e826d4782d3">AST_DEVICE_UNKNOWN</a>,      <span class="comment">/*!&lt; Device is valid but channel didn't know state */</span>
<a name="l00035"></a>00035    <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e0fe2efc106235ced7c3742c8fb054544">AST_DEVICE_NOT_INUSE</a>,    <span class="comment">/*!&lt; Device is not used */</span>
<a name="l00036"></a>00036    <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9eb54883b8e5fcba0b30f9db4b98eb0f42">AST_DEVICE_INUSE</a>,        <span class="comment">/*!&lt; Device is in use */</span>
<a name="l00037"></a>00037    <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e1036467dfee7c023a3b7a28e45f7ef21">AST_DEVICE_BUSY</a>,         <span class="comment">/*!&lt; Device is busy */</span>
<a name="l00038"></a>00038    <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e9cc12f38e2eec4c5ed63a43bc967834d">AST_DEVICE_INVALID</a>,      <span class="comment">/*!&lt; Device is invalid */</span>
<a name="l00039"></a>00039    <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9eedbb8a648c9f4b3dfb164b9d5cf5cabb">AST_DEVICE_UNAVAILABLE</a>,  <span class="comment">/*!&lt; Device is unavailable */</span>
<a name="l00040"></a>00040    <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e4f429c553fc5d377aa9966350ff34d44">AST_DEVICE_RINGING</a>,      <span class="comment">/*!&lt; Device is ringing */</span>
<a name="l00041"></a>00041    <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e3ee5721810b67dd7c7bad7036ce97f37">AST_DEVICE_RINGINUSE</a>,    <span class="comment">/*!&lt; Device is ringing *and* in use */</span>
<a name="l00042"></a>00042    <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9ecec0bdf83d7b3e88d7e376422f6ba00d">AST_DEVICE_ONHOLD</a>,       <span class="comment">/*!&lt; Device is on hold */</span>
<a name="l00043"></a>00043 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="108baa7a6e968d91099ef15c445e215c"></a><!-- doxytag: member="devicestate.h::ast_device_state" ref="108baa7a6e968d91099ef15c445e215c" args="(const char *device)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e">ast_device_state</a> <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e">ast_device_state</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>device</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Asks a channel for device state. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>device</em>&nbsp;</td><td>like a dialstring Asks a channel for device state, data is normaly a number from dialstring used by the low level module Trys the channel devicestate callback if not supported search in the active channels list for the device. Returns an AST_DEVICE_??? state -1 on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="devicestate_8c-source.html#l00274">274</a> of file <a class="el" href="devicestate_8c-source.html">devicestate.c</a>.
<p>
References <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e9cc12f38e2eec4c5ed63a43bc967834d">AST_DEVICE_INVALID</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e0fe2efc106235ced7c3742c8fb054544">AST_DEVICE_NOT_INUSE</a>, <a class="el" href="devicestate_8c-source.html#l00274">ast_device_state()</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9ec0882f63fc5e52ac924c0e826d4782d3">AST_DEVICE_UNKNOWN</a>, <a class="el" href="channel_8c-source.html#l00473">ast_get_channel_tech()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="devicestate_8c-source.html#l00250">ast_parse_device_state()</a>, <a class="el" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>, <a class="el" href="adsistub_8c-source.html#l00065">buf</a>, <a class="el" href="structast__channel__tech.html#3038bc3503e3e2a47e7ea6538338e371">ast_channel_tech::devicestate</a>, <a class="el" href="devicestate_8c-source.html#l00363">getproviderstate()</a>, <a class="el" href="logger_8h-source.html#l00094">LOG_DEBUG</a>, <a class="el" href="asterisk_8c-source.html#l00164">option_debug</a>, and <a class="el" href="strcompat_8c-source.html#l00035">strsep()</a>.
<p>
Referenced by <a class="el" href="devicestate_8c-source.html#l00274">ast_device_state()</a>, <a class="el" href="pbx_8c-source.html#l01812">ast_extension_state2()</a>, <a class="el" href="devicestate_8c-source.html#l00250">ast_parse_device_state()</a>, <a class="el" href="app__chanisavail_8c-source.html#l00069">chanavail_exec()</a>, <a class="el" href="app__queue_8c-source.html#l00679">create_queue_member()</a>, <a class="el" href="func__devstate_8c-source.html#l00095">custom_devstate_callback()</a>, <a class="el" href="func__devstate_8c-source.html#l00053">devstate_read()</a>, <a class="el" href="devicestate_8c-source.html#l00421">do_state_change()</a>, <a class="el" href="res__features_8c-source.html#l00318">metermaidstate()</a>, <a class="el" href="app__page_8c-source.html#l00085">page_exec()</a>, <a class="el" href="chan__skinny_8c-source.html#l01719">skinny_extensionstate_cb()</a>, <a class="el" href="app__meetme_8c-source.html#l04397">sla_state()</a>, and <a class="el" href="chan__sip_8c-source.html#l07533">transmit_state_notify()</a>.<div class="fragment"><pre class="fragment"><a name="l00275"></a>00275 {
<a name="l00276"></a>00276    <span class="keywordtype">char</span> *<a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>;
<a name="l00277"></a>00277    <span class="keywordtype">char</span> *<a class="code" href="structnumber.html">number</a>;
<a name="l00278"></a>00278    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structast__channel__tech.html">ast_channel_tech</a> *chan_tech;
<a name="l00279"></a>00279    <span class="keyword">enum</span> <a class="code" href="devicestate_8c.html#108baa7a6e968d91099ef15c445e215c">ast_device_state</a> res = <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9ec0882f63fc5e52ac924c0e826d4782d3">AST_DEVICE_UNKNOWN</a>;<span class="comment"></span>
<a name="l00280"></a>00280 <span class="comment">   /*! \brief Channel driver that provides device state */</span>
<a name="l00281"></a>00281    <span class="keywordtype">char</span> *tech;<span class="comment"></span>
<a name="l00282"></a>00282 <span class="comment">   /*! \brief Another provider of device state */</span>
<a name="l00283"></a>00283    <span class="keywordtype">char</span> *provider = NULL;
<a name="l00284"></a>00284    
<a name="l00285"></a>00285    buf = <a class="code" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>(device);
<a name="l00286"></a>00286    tech = <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;buf, <span class="stringliteral">"/"</span>);
<a name="l00287"></a>00287    <span class="keywordflow">if</span> (!(number = buf)) {
<a name="l00288"></a>00288       <span class="keywordflow">if</span> (!(provider = <a class="code" href="strcompat_8c.html#a541370456ac872bdb4bdcc462fc6a6e">strsep</a>(&amp;tech, <span class="stringliteral">":"</span>)))
<a name="l00289"></a>00289          <span class="keywordflow">return</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e9cc12f38e2eec4c5ed63a43bc967834d">AST_DEVICE_INVALID</a>;
<a name="l00290"></a>00290       <span class="comment">/* We have a provider */</span>
<a name="l00291"></a>00291       number = tech;
<a name="l00292"></a>00292       tech = NULL;
<a name="l00293"></a>00293    }
<a name="l00294"></a>00294 
<a name="l00295"></a>00295    <span class="keywordflow">if</span> (provider)  {
<a name="l00296"></a>00296       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a> &gt; 2)
<a name="l00297"></a>00297          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"Checking if I can find provider for \"%s\" - number: %s\n"</span>, provider, number);
<a name="l00298"></a>00298       <span class="keywordflow">return</span> <a class="code" href="devicestate_8c.html#dd970b119901005ee0fd6bb269f5d9c4">getproviderstate</a>(provider, number);
<a name="l00299"></a>00299    }
<a name="l00300"></a>00300 
<a name="l00301"></a>00301    <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#g1cc76c5e6a626e61ced4609749a57a6e">option_debug</a> &gt; 3)
<a name="l00302"></a>00302       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#eded50d942c7c2d37d09ba8241ff017f">LOG_DEBUG</a>, <span class="stringliteral">"No provider found, checking channel drivers for %s - %s\n"</span>, tech, number);
<a name="l00303"></a>00303 
<a name="l00304"></a>00304    <span class="keywordflow">if</span> (!(chan_tech = <a class="code" href="channel_8c.html#3a695cf963066b80546be9da976d27c8">ast_get_channel_tech</a>(tech)))
<a name="l00305"></a>00305       <span class="keywordflow">return</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e9cc12f38e2eec4c5ed63a43bc967834d">AST_DEVICE_INVALID</a>;
<a name="l00306"></a>00306 
<a name="l00307"></a>00307    <span class="keywordflow">if</span> (!(chan_tech-&gt;<a class="code" href="structast__channel__tech.html#3038bc3503e3e2a47e7ea6538338e371">devicestate</a>)) <span class="comment">/* Does the channel driver support device state notification? */</span>
<a name="l00308"></a>00308       <span class="keywordflow">return</span> <a class="code" href="devicestate_8c.html#fc0363f5b3377019e19ab7095e6d3a2f">ast_parse_device_state</a>(device); <span class="comment">/* No, try the generic function */</span>
<a name="l00309"></a>00309 
<a name="l00310"></a>00310    res = chan_tech-&gt;<a class="code" href="structast__channel__tech.html#3038bc3503e3e2a47e7ea6538338e371">devicestate</a>(number);
<a name="l00311"></a>00311 
<a name="l00312"></a>00312    <span class="keywordflow">if</span> (res != <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9ec0882f63fc5e52ac924c0e826d4782d3">AST_DEVICE_UNKNOWN</a>)
<a name="l00313"></a>00313       <span class="keywordflow">return</span> res;
<a name="l00314"></a>00314 
<a name="l00315"></a>00315    res = <a class="code" href="devicestate_8c.html#fc0363f5b3377019e19ab7095e6d3a2f">ast_parse_device_state</a>(device);
<a name="l00316"></a>00316 
<a name="l00317"></a>00317    <span class="keywordflow">if</span> (res == <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9ec0882f63fc5e52ac924c0e826d4782d3">AST_DEVICE_UNKNOWN</a>)
<a name="l00318"></a>00318       <span class="keywordflow">return</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e0fe2efc106235ced7c3742c8fb054544">AST_DEVICE_NOT_INUSE</a>;
<a name="l00319"></a>00319 
<a name="l00320"></a>00320    <span class="keywordflow">return</span> res;
<a name="l00321"></a>00321 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1ebe9ed719fcc93a2470a6d0f32f2b09"></a><!-- doxytag: member="devicestate.h::ast_device_state_changed" ref="1ebe9ed719fcc93a2470a6d0f32f2b09" args="(const char *fmt,...) __attribute__((format(printf" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_device_state_changed           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>...</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Tells Asterisk the State for Device is changed. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fmt</em>&nbsp;</td><td>devicename like a dialstring with format parameters Asterisk polls the new extensionstates and calls the registered callbacks for the changed extensions Returns 0 on success, -1 on failure </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="61240e3c80f0696af9fcb72a5d7ec925"></a><!-- doxytag: member="devicestate.h::ast_device_state_changed_literal" ref="61240e3c80f0696af9fcb72a5d7ec925" args="(const char *device)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int int ast_device_state_changed_literal           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>device</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Tells Asterisk the State for Device is changed. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>device</em>&nbsp;</td><td>devicename like a dialstring Asterisk polls the new extensionstates and calls the registered callbacks for the changed extensions Returns 0 on success, -1 on failure </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="devicestate_8c-source.html#l00470">470</a> of file <a class="el" href="devicestate_8c-source.html">devicestate.c</a>.
<p>
References <a class="el" href="devicestate_8c-source.html#l00438">__ast_device_state_changed_literal()</a>, <a class="el" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>, and <a class="el" href="adsistub_8c-source.html#l00065">buf</a>.
<p>
Referenced by <a class="el" href="channel_8c-source.html#l01069">ast_channel_free()</a>, and <a class="el" href="channel_8c-source.html#l03728">ast_setstate()</a>.<div class="fragment"><pre class="fragment"><a name="l00471"></a>00471 {
<a name="l00472"></a>00472    <span class="keywordtype">char</span> *<a class="code" href="adsistub_8c.html#cb7e52b21171fb9a53b498202607f0bd">buf</a>;
<a name="l00473"></a>00473    buf = <a class="code" href="utils_8h.html#b38bbfc0f090d7e013ad805ff172a7d2">ast_strdupa</a>(dev);
<a name="l00474"></a>00474    <span class="keywordflow">return</span> <a class="code" href="devicestate_8c.html#79bb3461c961afe791043212bb13b029">__ast_device_state_changed_literal</a>(buf);
<a name="l00475"></a>00475 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="3975a4eaeb7e540ec5c2b368d3c803c2"></a><!-- doxytag: member="devicestate.h::ast_device_state_engine_init" ref="3975a4eaeb7e540ec5c2b368d3c803c2" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_device_state_engine_init           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initialize the device state engine in separate thread. 
<p>

<p>
Definition at line <a class="el" href="devicestate_8c-source.html#l00515">515</a> of file <a class="el" href="devicestate_8c-source.html">devicestate.c</a>.
<p>
References <a class="el" href="lock_8h-source.html#l00542">ast_cond_init()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="utils_8h-source.html#l00307">ast_pthread_create_background</a>, <a class="el" href="devicestate_8c-source.html#l00490">do_devstate_changes()</a>, and <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>.
<p>
Referenced by <a class="el" href="asterisk_8c-source.html#l02570">main()</a>.<div class="fragment"><pre class="fragment"><a name="l00516"></a>00516 {
<a name="l00517"></a>00517    <a class="code" href="lock_8h.html#26b556000e9ba452b40f732a86644de6">ast_cond_init</a>(&amp;<a class="code" href="devicestate_8c.html#0d308dea7f58141f160106621bafaae6">change_pending</a>, NULL);
<a name="l00518"></a>00518    <span class="keywordflow">if</span> (<a class="code" href="utils_8h.html#351b78c7aeb62b2b57eb447287cdd9d4">ast_pthread_create_background</a>(&amp;<a class="code" href="devicestate_8c.html#5cd18848328ffb85aaecedde630b91b8">change_thread</a>, NULL, <a class="code" href="devicestate_8c.html#e65bff7fc245e4f76e9817c07a8b07a7">do_devstate_changes</a>, NULL) &lt; 0) {
<a name="l00519"></a>00519       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Unable to start device state change thread.\n"</span>);
<a name="l00520"></a>00520       <span class="keywordflow">return</span> -1;
<a name="l00521"></a>00521    }
<a name="l00522"></a>00522 
<a name="l00523"></a>00523    <span class="keywordflow">return</span> 0;
<a name="l00524"></a>00524 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="9eb1911b7b709c7cd82fe352690b75dd"></a><!-- doxytag: member="devicestate.h::ast_devstate_add" ref="9eb1911b7b709c7cd82fe352690b75dd" args="(ast_devstate_cb_type callback, void *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_devstate_add           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="devicestate_8h.html#46d6f3eba391a4a61601a0373570df6f">ast_devstate_cb_type</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>callback</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Registers a device state change callback. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>callback</em>&nbsp;</td><td>Callback </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>to pass to callback The callback is called if the state for extension is changed Return -1 on failure, ID on success </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="devicestate_8c-source.html#l00384">384</a> of file <a class="el" href="devicestate_8c-source.html">devicestate.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="linkedlists_8h-source.html#l00657">AST_RWLIST_INSERT_HEAD</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, and <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>.
<p>
Referenced by <a class="el" href="app__queue_8c-source.html#l04759">load_module()</a>.<div class="fragment"><pre class="fragment"><a name="l00385"></a>00385 {
<a name="l00386"></a>00386    <span class="keyword">struct </span><a class="code" href="structdevstate__cb.html">devstate_cb</a> *devcb;
<a name="l00387"></a>00387 
<a name="l00388"></a>00388    <span class="keywordflow">if</span> (!<a class="code" href="structdevstate__cb.html#924a8ceeac17f54d3be3f8cdf1c04eb2">callback</a> || !(devcb = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*devcb))))
<a name="l00389"></a>00389       <span class="keywordflow">return</span> -1;
<a name="l00390"></a>00390 
<a name="l00391"></a>00391    devcb-&gt;data = <a class="code" href="structdevstate__cb.html#8d777f385d3dfec8815d20f7496026dc">data</a>;
<a name="l00392"></a>00392    devcb-&gt;callback = <a class="code" href="structdevstate__cb.html#924a8ceeac17f54d3be3f8cdf1c04eb2">callback</a>;
<a name="l00393"></a>00393 
<a name="l00394"></a>00394    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;devstate_cbs);
<a name="l00395"></a>00395    <a class="code" href="linkedlists_8h.html#b4592c522c6b3831f739508553316599">AST_RWLIST_INSERT_HEAD</a>(&amp;devstate_cbs, devcb, list);
<a name="l00396"></a>00396    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;devstate_cbs);
<a name="l00397"></a>00397 
<a name="l00398"></a>00398    <span class="keywordflow">return</span> 0;
<a name="l00399"></a>00399 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="7d4add30d8667d7e2945e49dc8c67323"></a><!-- doxytag: member="devicestate.h::ast_devstate_del" ref="7d4add30d8667d7e2945e49dc8c67323" args="(ast_devstate_cb_type callback, void *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_devstate_del           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="devicestate_8h.html#46d6f3eba391a4a61601a0373570df6f">ast_devstate_cb_type</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>callback</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unregisters a device state change callback. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>callback</em>&nbsp;</td><td>Callback </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>to pass to callback The callback is called if the state for extension is changed Return -1 on failure, ID on success </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="devicestate_8c-source.html#l00402">402</a> of file <a class="el" href="devicestate_8c-source.html">devicestate.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00526">AST_RWLIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h-source.html#l00503">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h-source.html#l00556">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="devicestate_8c-source.html#l00156">devstate_cb::callback</a>, <a class="el" href="devicestate_8c-source.html#l00155">devstate_cb::data</a>, and <a class="el" href="astmm_8h-source.html#l00069">free</a>.
<p>
Referenced by <a class="el" href="app__queue_8c-source.html#l04719">unload_module()</a>.<div class="fragment"><pre class="fragment"><a name="l00403"></a>00403 {
<a name="l00404"></a>00404    <span class="keyword">struct </span><a class="code" href="structdevstate__cb.html">devstate_cb</a> *devcb;
<a name="l00405"></a>00405 
<a name="l00406"></a>00406    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;devstate_cbs);
<a name="l00407"></a>00407    <a class="code" href="linkedlists_8h.html#b564f1f262db6464e1644462c38d61e3">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;devstate_cbs, devcb, list) {
<a name="l00408"></a>00408       <span class="keywordflow">if</span> ((devcb-&gt;<a class="code" href="structdevstate__cb.html#924a8ceeac17f54d3be3f8cdf1c04eb2">callback</a> == <a class="code" href="structdevstate__cb.html#924a8ceeac17f54d3be3f8cdf1c04eb2">callback</a>) &amp;&amp; (devcb-&gt;<a class="code" href="structdevstate__cb.html#8d777f385d3dfec8815d20f7496026dc">data</a> == <a class="code" href="structdevstate__cb.html#8d777f385d3dfec8815d20f7496026dc">data</a>)) {
<a name="l00409"></a>00409          <a class="code" href="linkedlists_8h.html#93783e4cad722e705630e975d2e8d7f9">AST_RWLIST_REMOVE_CURRENT</a>(&amp;devstate_cbs, list);
<a name="l00410"></a>00410          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(devcb);
<a name="l00411"></a>00411          <span class="keywordflow">break</span>;
<a name="l00412"></a>00412       }
<a name="l00413"></a>00413    }
<a name="l00414"></a>00414    <a class="code" href="linkedlists_8h.html#e5be717f6b8c1586fa30a060b56403fe">AST_RWLIST_TRAVERSE_SAFE_END</a>;
<a name="l00415"></a>00415    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;devstate_cbs);
<a name="l00416"></a>00416 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="bb0b7d59cba82040757824a5e6df4cf1"></a><!-- doxytag: member="devicestate.h::ast_devstate_prov_add" ref="bb0b7d59cba82040757824a5e6df4cf1" args="(const char *label, ast_devstate_prov_cb_type callback)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_devstate_prov_add           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>label</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="devicestate_8h.html#ff6ddc7f6403e464dfb4f2e35453b308">ast_devstate_prov_cb_type</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>callback</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add device state provider. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>label</em>&nbsp;</td><td>to use in hint, like label:object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>callback</em>&nbsp;</td><td>Callback </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>failure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>success </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="devicestate_8c-source.html#l00324">324</a> of file <a class="el" href="devicestate_8c-source.html">devicestate.c</a>.
<p>
References <a class="el" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>, <a class="el" href="linkedlists_8h-source.html#l00657">AST_RWLIST_INSERT_HEAD</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, and <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>.
<p>
Referenced by <a class="el" href="app__meetme_8c-source.html#l04847">load_module()</a>.<div class="fragment"><pre class="fragment"><a name="l00325"></a>00325 {
<a name="l00326"></a>00326    <span class="keyword">struct </span><a class="code" href="structdevstate__prov.html">devstate_prov</a> *devprov;
<a name="l00327"></a>00327 
<a name="l00328"></a>00328    <span class="keywordflow">if</span> (!<a class="code" href="structdevstate__prov.html#924a8ceeac17f54d3be3f8cdf1c04eb2">callback</a> || !(devprov = <a class="code" href="utils_8h.html#27f1d0ddbd22dac569b18963c5cb7e19">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*devprov))))
<a name="l00329"></a>00329       <span class="keywordflow">return</span> -1;
<a name="l00330"></a>00330 
<a name="l00331"></a>00331    devprov-&gt;callback = <a class="code" href="structdevstate__prov.html#924a8ceeac17f54d3be3f8cdf1c04eb2">callback</a>;
<a name="l00332"></a>00332    ast_copy_string(devprov-&gt;label, <a class="code" href="structdevstate__prov.html#fdf3daa1b593160a9dd1aef566762926">label</a>, <span class="keyword">sizeof</span>(devprov-&gt;label));
<a name="l00333"></a>00333 
<a name="l00334"></a>00334    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;devstate_provs);
<a name="l00335"></a>00335    <a class="code" href="linkedlists_8h.html#b4592c522c6b3831f739508553316599">AST_RWLIST_INSERT_HEAD</a>(&amp;devstate_provs, devprov, list);
<a name="l00336"></a>00336    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;devstate_provs);
<a name="l00337"></a>00337 
<a name="l00338"></a>00338    <span class="keywordflow">return</span> 0;
<a name="l00339"></a>00339 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="1996c0db248eebe4b033249932023f02"></a><!-- doxytag: member="devicestate.h::ast_devstate_prov_del" ref="1996c0db248eebe4b033249932023f02" args="(const char *label)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_devstate_prov_del           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>label</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Remove device state provider. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>label</em>&nbsp;</td><td>to use in hint, like label:object Return -1 on failure, 0 on success </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="devicestate_8c-source.html#l00342">342</a> of file <a class="el" href="devicestate_8c-source.html">devicestate.c</a>.
<p>
References <a class="el" href="linkedlists_8h-source.html#l00526">AST_RWLIST_REMOVE_CURRENT</a>, <a class="el" href="linkedlists_8h-source.html#l00503">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="linkedlists_8h-source.html#l00556">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="linkedlists_8h-source.html#l00115">AST_RWLIST_UNLOCK</a>, <a class="el" href="linkedlists_8h-source.html#l00049">AST_RWLIST_WRLOCK</a>, <a class="el" href="astmm_8h-source.html#l00069">free</a>, and <a class="el" href="devicestate_8c-source.html#l00145">devstate_prov::label</a>.
<p>
Referenced by <a class="el" href="app__meetme_8c-source.html#l04823">unload_module()</a>.<div class="fragment"><pre class="fragment"><a name="l00343"></a>00343 {
<a name="l00344"></a>00344    <span class="keyword">struct </span><a class="code" href="structdevstate__prov.html">devstate_prov</a> *devcb;
<a name="l00345"></a>00345    <span class="keywordtype">int</span> res = -1;
<a name="l00346"></a>00346 
<a name="l00347"></a>00347    <a class="code" href="linkedlists_8h.html#a8a78c1cb0b68179bb2e44d27216a5af">AST_RWLIST_WRLOCK</a>(&amp;devstate_provs);
<a name="l00348"></a>00348    <a class="code" href="linkedlists_8h.html#b564f1f262db6464e1644462c38d61e3">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;devstate_provs, devcb, list) {
<a name="l00349"></a>00349       <span class="keywordflow">if</span> (!strcasecmp(devcb-&gt;<a class="code" href="structdevstate__prov.html#fdf3daa1b593160a9dd1aef566762926">label</a>, <a class="code" href="structdevstate__prov.html#fdf3daa1b593160a9dd1aef566762926">label</a>)) {
<a name="l00350"></a>00350          <a class="code" href="linkedlists_8h.html#93783e4cad722e705630e975d2e8d7f9">AST_RWLIST_REMOVE_CURRENT</a>(&amp;devstate_provs, list);
<a name="l00351"></a>00351          <a class="code" href="astmm_8h.html#eb051e552619427a26721b1a925a56e8">free</a>(devcb);
<a name="l00352"></a>00352          res = 0;
<a name="l00353"></a>00353          <span class="keywordflow">break</span>;
<a name="l00354"></a>00354       }
<a name="l00355"></a>00355    }
<a name="l00356"></a>00356    <a class="code" href="linkedlists_8h.html#e5be717f6b8c1586fa30a060b56403fe">AST_RWLIST_TRAVERSE_SAFE_END</a>;
<a name="l00357"></a>00357    <a class="code" href="linkedlists_8h.html#470215c8af4ffcdb09701e5d092a9205">AST_RWLIST_UNLOCK</a>(&amp;devstate_provs);
<a name="l00358"></a>00358 
<a name="l00359"></a>00359    <span class="keywordflow">return</span> res;
<a name="l00360"></a>00360 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="71c1ca5e00cff64884e5d1c519925d26"></a><!-- doxytag: member="devicestate.h::ast_devstate_str" ref="71c1ca5e00cff64884e5d1c519925d26" args="(enum ast_device_state devstate)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* ast_devstate_str           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">enum <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e">ast_device_state</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>devstate</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Convert device state to text string that is easier to parse. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>devstate</em>&nbsp;</td><td>Current device state </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="devicestate_8c-source.html#l00187">187</a> of file <a class="el" href="devicestate_8c-source.html">devicestate.c</a>.
<p>
References <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e1036467dfee7c023a3b7a28e45f7ef21">AST_DEVICE_BUSY</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9eb54883b8e5fcba0b30f9db4b98eb0f42">AST_DEVICE_INUSE</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e9cc12f38e2eec4c5ed63a43bc967834d">AST_DEVICE_INVALID</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e0fe2efc106235ced7c3742c8fb054544">AST_DEVICE_NOT_INUSE</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9ecec0bdf83d7b3e88d7e376422f6ba00d">AST_DEVICE_ONHOLD</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e4f429c553fc5d377aa9966350ff34d44">AST_DEVICE_RINGING</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e3ee5721810b67dd7c7bad7036ce97f37">AST_DEVICE_RINGINUSE</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9eedbb8a648c9f4b3dfb164b9d5cf5cabb">AST_DEVICE_UNAVAILABLE</a>, and <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9ec0882f63fc5e52ac924c0e826d4782d3">AST_DEVICE_UNKNOWN</a>.
<p>
Referenced by <a class="el" href="func__devstate_8c-source.html#l00112">cli_funcdevstate_list()</a>, and <a class="el" href="func__devstate_8c-source.html#l00053">devstate_read()</a>.<div class="fragment"><pre class="fragment"><a name="l00188"></a>00188 {
<a name="l00189"></a>00189    <span class="keyword">const</span> <span class="keywordtype">char</span> *res = <span class="stringliteral">"UNKNOWN"</span>;
<a name="l00190"></a>00190 
<a name="l00191"></a>00191    <span class="keywordflow">switch</span> (<a class="code" href="structstate.html">state</a>) {
<a name="l00192"></a>00192    <span class="keywordflow">case</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9ec0882f63fc5e52ac924c0e826d4782d3">AST_DEVICE_UNKNOWN</a>:
<a name="l00193"></a>00193       <span class="keywordflow">break</span>;
<a name="l00194"></a>00194    <span class="keywordflow">case</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e0fe2efc106235ced7c3742c8fb054544">AST_DEVICE_NOT_INUSE</a>:
<a name="l00195"></a>00195       res = <span class="stringliteral">"NOT_INUSE"</span>;
<a name="l00196"></a>00196       <span class="keywordflow">break</span>;
<a name="l00197"></a>00197    <span class="keywordflow">case</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9eb54883b8e5fcba0b30f9db4b98eb0f42">AST_DEVICE_INUSE</a>:
<a name="l00198"></a>00198       res = <span class="stringliteral">"INUSE"</span>;
<a name="l00199"></a>00199       <span class="keywordflow">break</span>;
<a name="l00200"></a>00200    <span class="keywordflow">case</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e1036467dfee7c023a3b7a28e45f7ef21">AST_DEVICE_BUSY</a>:
<a name="l00201"></a>00201       res = <span class="stringliteral">"BUSY"</span>;
<a name="l00202"></a>00202       <span class="keywordflow">break</span>;
<a name="l00203"></a>00203    <span class="keywordflow">case</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e9cc12f38e2eec4c5ed63a43bc967834d">AST_DEVICE_INVALID</a>:
<a name="l00204"></a>00204       res = <span class="stringliteral">"INVALID"</span>;
<a name="l00205"></a>00205       <span class="keywordflow">break</span>;
<a name="l00206"></a>00206    <span class="keywordflow">case</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9eedbb8a648c9f4b3dfb164b9d5cf5cabb">AST_DEVICE_UNAVAILABLE</a>:
<a name="l00207"></a>00207       res = <span class="stringliteral">"UNAVAILABLE"</span>;
<a name="l00208"></a>00208       <span class="keywordflow">break</span>;
<a name="l00209"></a>00209    <span class="keywordflow">case</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e4f429c553fc5d377aa9966350ff34d44">AST_DEVICE_RINGING</a>:
<a name="l00210"></a>00210       res = <span class="stringliteral">"RINGING"</span>;
<a name="l00211"></a>00211       <span class="keywordflow">break</span>;
<a name="l00212"></a>00212    <span class="keywordflow">case</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e3ee5721810b67dd7c7bad7036ce97f37">AST_DEVICE_RINGINUSE</a>:
<a name="l00213"></a>00213       res = <span class="stringliteral">"RINGINUSE"</span>;
<a name="l00214"></a>00214       <span class="keywordflow">break</span>;
<a name="l00215"></a>00215    <span class="keywordflow">case</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9ecec0bdf83d7b3e88d7e376422f6ba00d">AST_DEVICE_ONHOLD</a>:
<a name="l00216"></a>00216       res = <span class="stringliteral">"ONHOLD"</span>;
<a name="l00217"></a>00217       <span class="keywordflow">break</span>;
<a name="l00218"></a>00218    }
<a name="l00219"></a>00219 
<a name="l00220"></a>00220    <span class="keywordflow">return</span> res;
<a name="l00221"></a>00221 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ec5d8d519ef0c2b6fa5c1c46ba5c0b2a"></a><!-- doxytag: member="devicestate.h::ast_devstate_val" ref="ec5d8d519ef0c2b6fa5c1c46ba5c0b2a" args="(const char *val)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e">ast_device_state</a> ast_devstate_val           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>val</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Convert device state from text to integer value. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>The</em>&nbsp;</td><td>text representing the device state. Valid values are anything that comes after AST_DEVICE_ in one of the defined values. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The AST_DEVICE_ integer value </dd></dl>

<p>
Definition at line <a class="el" href="devicestate_8c-source.html#l00223">223</a> of file <a class="el" href="devicestate_8c-source.html">devicestate.c</a>.
<p>
References <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e1036467dfee7c023a3b7a28e45f7ef21">AST_DEVICE_BUSY</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9eb54883b8e5fcba0b30f9db4b98eb0f42">AST_DEVICE_INUSE</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e9cc12f38e2eec4c5ed63a43bc967834d">AST_DEVICE_INVALID</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e0fe2efc106235ced7c3742c8fb054544">AST_DEVICE_NOT_INUSE</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9ecec0bdf83d7b3e88d7e376422f6ba00d">AST_DEVICE_ONHOLD</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e4f429c553fc5d377aa9966350ff34d44">AST_DEVICE_RINGING</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e3ee5721810b67dd7c7bad7036ce97f37">AST_DEVICE_RINGINUSE</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9eedbb8a648c9f4b3dfb164b9d5cf5cabb">AST_DEVICE_UNAVAILABLE</a>, and <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9ec0882f63fc5e52ac924c0e826d4782d3">AST_DEVICE_UNKNOWN</a>.
<p>
Referenced by <a class="el" href="func__devstate_8c-source.html#l00060">devstate_write()</a>.<div class="fragment"><pre class="fragment"><a name="l00224"></a>00224 {
<a name="l00225"></a>00225    <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="structval.html">val</a>, <span class="stringliteral">"NOT_INUSE"</span>))
<a name="l00226"></a>00226       <span class="keywordflow">return</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e0fe2efc106235ced7c3742c8fb054544">AST_DEVICE_NOT_INUSE</a>;
<a name="l00227"></a>00227    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="structval.html">val</a>, <span class="stringliteral">"INUSE"</span>))
<a name="l00228"></a>00228       <span class="keywordflow">return</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9eb54883b8e5fcba0b30f9db4b98eb0f42">AST_DEVICE_INUSE</a>;
<a name="l00229"></a>00229    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="structval.html">val</a>, <span class="stringliteral">"BUSY"</span>))
<a name="l00230"></a>00230       <span class="keywordflow">return</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e1036467dfee7c023a3b7a28e45f7ef21">AST_DEVICE_BUSY</a>;
<a name="l00231"></a>00231    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="structval.html">val</a>, <span class="stringliteral">"INVALID"</span>))
<a name="l00232"></a>00232       <span class="keywordflow">return</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e9cc12f38e2eec4c5ed63a43bc967834d">AST_DEVICE_INVALID</a>;
<a name="l00233"></a>00233    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="structval.html">val</a>, <span class="stringliteral">"UNAVAILABLE"</span>))
<a name="l00234"></a>00234       <span class="keywordflow">return</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9eedbb8a648c9f4b3dfb164b9d5cf5cabb">AST_DEVICE_UNAVAILABLE</a>;
<a name="l00235"></a>00235    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="structval.html">val</a>, <span class="stringliteral">"RINGING"</span>))
<a name="l00236"></a>00236       <span class="keywordflow">return</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e4f429c553fc5d377aa9966350ff34d44">AST_DEVICE_RINGING</a>;
<a name="l00237"></a>00237    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="structval.html">val</a>, <span class="stringliteral">"RINGINUSE"</span>))
<a name="l00238"></a>00238       <span class="keywordflow">return</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e3ee5721810b67dd7c7bad7036ce97f37">AST_DEVICE_RINGINUSE</a>;
<a name="l00239"></a>00239    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="structval.html">val</a>, <span class="stringliteral">"ONHOLD"</span>))
<a name="l00240"></a>00240       <span class="keywordflow">return</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9ecec0bdf83d7b3e88d7e376422f6ba00d">AST_DEVICE_ONHOLD</a>;
<a name="l00241"></a>00241 
<a name="l00242"></a>00242    <span class="keywordflow">return</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9ec0882f63fc5e52ac924c0e826d4782d3">AST_DEVICE_UNKNOWN</a>;
<a name="l00243"></a>00243 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="fc0363f5b3377019e19ab7095e6d3a2f"></a><!-- doxytag: member="devicestate.h::ast_parse_device_state" ref="fc0363f5b3377019e19ab7095e6d3a2f" args="(const char *device)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e">ast_device_state</a> ast_parse_device_state           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>device</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Search the Channels by Name. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>find channels with the device's name in it This function is only used for channels that does not implement devicestate natively </dd></dl>

<p>
Definition at line <a class="el" href="devicestate_8c-source.html#l00250">250</a> of file <a class="el" href="devicestate_8c-source.html">devicestate.c</a>.
<p>
References <a class="el" href="channel_8h-source.html#l00435">ast_channel::_state</a>, <a class="el" href="channel_8h-source.html#l00141">AST_CHANNEL_NAME</a>, <a class="el" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9eb54883b8e5fcba0b30f9db4b98eb0f42">AST_DEVICE_INUSE</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e4f429c553fc5d377aa9966350ff34d44">AST_DEVICE_RINGING</a>, <a class="el" href="devicestate_8c-source.html#l00274">ast_device_state()</a>, <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9ec0882f63fc5e52ac924c0e826d4782d3">AST_DEVICE_UNKNOWN</a>, <a class="el" href="channel_8c-source.html#l01001">ast_get_channel_by_name_prefix_locked()</a>, <a class="el" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a85da5b3ea10583d638bc7ce8fe638ec2">AST_STATE_RINGING</a>, <a class="el" href="adsistub_8c-source.html#l00055">chan</a>, and <a class="el" href="chan__iax2_8c-source.html#l01198">match()</a>.
<p>
Referenced by <a class="el" href="devicestate_8c-source.html#l00274">ast_device_state()</a>, and <a class="el" href="app__chanisavail_8c-source.html#l00069">chanavail_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l00251"></a>00251 {
<a name="l00252"></a>00252    <span class="keyword">struct </span><a class="code" href="structast__channel.html">ast_channel</a> *<a class="code" href="adsistub_8c.html#26c322652770620e64ac90682eb6504c">chan</a>;
<a name="l00253"></a>00253    <span class="keywordtype">char</span> <a class="code" href="chan__iax2_8c.html#b5f545ec55667a61a75dd2047251b4ac">match</a>[<a class="code" href="channel_8h.html#57fb43d64b209037cdc198f3db578d39">AST_CHANNEL_NAME</a>];
<a name="l00254"></a>00254    <span class="keyword">enum</span> <a class="code" href="devicestate_8c.html#108baa7a6e968d91099ef15c445e215c">ast_device_state</a> res;
<a name="l00255"></a>00255 
<a name="l00256"></a>00256    ast_copy_string(match, device, <span class="keyword">sizeof</span>(match)-1);
<a name="l00257"></a>00257    strcat(match, <span class="stringliteral">"-"</span>);
<a name="l00258"></a>00258    chan = <a class="code" href="channel_8c.html#73dcef78b8c7fc8cb85dde3ee0058c57">ast_get_channel_by_name_prefix_locked</a>(match, strlen(match));
<a name="l00259"></a>00259 
<a name="l00260"></a>00260    <span class="keywordflow">if</span> (!chan)
<a name="l00261"></a>00261       <span class="keywordflow">return</span> <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9ec0882f63fc5e52ac924c0e826d4782d3">AST_DEVICE_UNKNOWN</a>;
<a name="l00262"></a>00262 
<a name="l00263"></a>00263    <span class="keywordflow">if</span> (chan-&gt;<a class="code" href="structast__channel.html#fb303761f789500fe4c0c9938c1c0245">_state</a> == <a class="code" href="channel_8h.html#c04acac682ff0cff5eda96378318b87a85da5b3ea10583d638bc7ce8fe638ec2">AST_STATE_RINGING</a>)
<a name="l00264"></a>00264       res = <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e4f429c553fc5d377aa9966350ff34d44">AST_DEVICE_RINGING</a>;
<a name="l00265"></a>00265    <span class="keywordflow">else</span>
<a name="l00266"></a>00266       res = <a class="code" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9eb54883b8e5fcba0b30f9db4b98eb0f42">AST_DEVICE_INUSE</a>;
<a name="l00267"></a>00267    
<a name="l00268"></a>00268    <a class="code" href="lock_8h.html#a2fac4e1b143bef3b1ac807e0ab48f9f">ast_channel_unlock</a>(chan);
<a name="l00269"></a>00269 
<a name="l00270"></a>00270    <span class="keywordflow">return</span> res;
<a name="l00271"></a>00271 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="7dbbe3294576db414214a8b1c7d8c074"></a><!-- doxytag: member="devicestate.h::devstate2str" ref="7dbbe3294576db414214a8b1c7d8c074" args="(enum ast_device_state devstate)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* devstate2str           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">enum <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e">ast_device_state</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>devstate</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Convert device state to text string for output. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>devstate</em>&nbsp;</td><td>Current device state </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="devicestate_8c-source.html#l00182">182</a> of file <a class="el" href="devicestate_8c-source.html">devicestate.c</a>.
<p>
References <a class="el" href="devicestate_8c-source.html#l00131">devstatestring</a>.
<p>
Referenced by <a class="el" href="app__queue_8c-source.html#l04140">__queues_show()</a>, <a class="el" href="devicestate_8c-source.html#l00421">do_state_change()</a>, <a class="el" href="app__queue_8c-source.html#l00541">handle_statechange()</a>, and <a class="el" href="app__page_8c-source.html#l00085">page_exec()</a>.<div class="fragment"><pre class="fragment"><a name="l00183"></a>00183 {
<a name="l00184"></a>00184    <span class="keywordflow">return</span> <a class="code" href="devicestate_8c.html#b7f7621b2806098b98deea7d299c9498">devstatestring</a>[devstate];
<a name="l00185"></a>00185 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="ff6ddc7f6403e464dfb4f2e35453b308"></a><!-- doxytag: member="devicestate.h::ast_devstate_prov_cb_type" ref="ff6ddc7f6403e464dfb4f2e35453b308" args=")(const char *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="devicestate_8h.html#b32c9d7f2a117281efcc381ee116cc9e">ast_device_state</a>(* <a class="el" href="devicestate_8h.html#ff6ddc7f6403e464dfb4f2e35453b308">ast_devstate_prov_cb_type</a>)(const char *data)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Devicestate provider call back. 
<p>

<p>
Definition at line <a class="el" href="devicestate_8h-source.html#l00049">49</a> of file <a class="el" href="devicestate_8h-source.html">devicestate.h</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Thu May 24 22:27:26 2007 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.5 </small></address>
</body>
</html>
