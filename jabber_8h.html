<HTML>
    <HEAD>
      <TITLE>Asterisk.org: Developer Documentation (24 May 2007)</TITLE>
      <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
    </HEAD>
    <BODY BGCOLOR="#FFFFFF">
<div><font size="2" align="right">Thu May 24 22:27:34 2007</font></div>

<h2>Asterisk developer's documentation</h2>
<hr/>
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir__2Fusr_2Flocal_2Fsrc_2Fasterisk_2Esvn_2Fastum_2Finclude_2F.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir__2Fusr_2Flocal_2Fsrc_2Fasterisk_2Esvn_2Fastum_2Finclude_2Fasterisk_2F.html">asterisk</a></div>
<h1>jabber.h File Reference</h1>AJI - The Asterisk Jabber Interface <a class="el" href="AJI_intro.html">AJI - The Asterisk Jabber Interface</a> <a class="el" href="res__jabber_8c.html">res_jabber.c</a>. <a href="#_details">More...</a>
<p>
<code>#include &lt;iksemel.h&gt;</code><br>
<code>#include &quot;<a class="el" href="astobj_8h-source.html">asterisk/astobj.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="linkedlists_8h-source.html">asterisk/linkedlists.h</a>&quot;</code><br>

<p>
<a href="jabber_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaji__buddy.html">aji_buddy</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaji__buddy__container.html">aji_buddy_container</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaji__capabilities.html">aji_capabilities</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaji__client.html">aji_client</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaji__client__container.html">aji_client_container</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaji__message.html">aji_message</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaji__resource.html">aji_resource</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaji__transport__container.html">aji_transport_container</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structaji__version.html">aji_version</a></td></tr>

<tr><td colspan="2"><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="jabber_8h.html#dca29a1140aadadfd92b34a02fa516ef06a41072317f7ac737a6c1184614dcc8">AJI_AUTOPRUNE</a> =  (1 &lt;&lt; 0), 
<a class="el" href="jabber_8h.html#dca29a1140aadadfd92b34a02fa516ef3bb663af18eefaedfada893d270461fe">AJI_AUTOREGISTER</a> =  (1 &lt;&lt; 1)
 }</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#6cf519fe6cd004f907a91afe0df59b28">aji_btype</a> { <a class="el" href="jabber_8h.html#6cf519fe6cd004f907a91afe0df59b288fcfb687807ea69697f8ce8bfadc7b06">AJI_USER</a> = 0, 
<a class="el" href="jabber_8h.html#6cf519fe6cd004f907a91afe0df59b2807a6754867c82ab49a7e8e186781c6f0">AJI_TRANS</a> = 1, 
<a class="el" href="jabber_8h.html#6cf519fe6cd004f907a91afe0df59b287f54e356f9b9b0450cf40dcaea7d981c">AJI_UTRANS</a> = 2
 }</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#a7803c50f209988f91243660782a4968">aji_state</a> { <a class="el" href="jabber_8h.html#a7803c50f209988f91243660782a4968dc02f24ab750bc9d5c0ea90a1e118ffc">AJI_DISCONNECTED</a> =  0, 
<a class="el" href="jabber_8h.html#a7803c50f209988f91243660782a4968bd0009b0a599c343dd67bda97df21667">AJI_CONNECTING</a>, 
<a class="el" href="jabber_8h.html#a7803c50f209988f91243660782a49688714eda3e048a4103c90a29756ccf74a">AJI_CONNECTED</a>
 }</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#96e3c38873e23969a62361a640cf3b6f">ast_aji_check_roster</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#8ef0ac1eb05ee9817ac93bf3b4ea9fc7">ast_aji_create_chat</a> (struct <a class="el" href="structaji__client.html">aji_client</a> *client, char *room, char *server, char *topic)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">create a chatroom.  <a href="#8ef0ac1eb05ee9817ac93bf3b4ea9fc7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#562927b787f20710d70a995ec9ebaf2f">ast_aji_disconnect</a> (struct <a class="el" href="structaji__client.html">aji_client</a> *client)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">disconnect from jabber server.  <a href="#562927b787f20710d70a995ec9ebaf2f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structaji__client.html">aji_client</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#07a908ee08552b61e1fdc273ff290ce3">ast_aji_get_client</a> (const char *<a class="el" href="cdr__tds_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">grab a <a class="el" href="structaji__client.html">aji_client</a> structure by label name.  <a href="#07a908ee08552b61e1fdc273ff290ce3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structaji__client__container.html">aji_client_container</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#7d9bd3d52ee56cf01e4e7e3e7b0894e3">ast_aji_get_clients</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#ebfaf0db3d081c62499bc5126b0e317a">ast_aji_increment_mid</a> (char *mid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">increments the mid field for messages and other events.  <a href="#ebfaf0db3d081c62499bc5126b0e317a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#315197c47b6a5240d2dab6b011b1707f">ast_aji_invite_chat</a> (struct <a class="el" href="structaji__client.html">aji_client</a> *client, char *user, char *room, char *<a class="el" href="structmessage.html">message</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">invite to a chatroom.  <a href="#315197c47b6a5240d2dab6b011b1707f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#8d5c66f8b55017a19b6e7cf1d722f151">ast_aji_join_chat</a> (struct <a class="el" href="structaji__client.html">aji_client</a> *client, char *room)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">join a chatroom.  <a href="#8d5c66f8b55017a19b6e7cf1d722f151"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="jabber_8h.html#8a5f0430e6a8f92ea68af8e06e06dee7">ast_aji_send</a> (struct <a class="el" href="structaji__client.html">aji_client</a> *client, const char *address, const char *<a class="el" href="structmessage.html">message</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">sends messages.  <a href="#8a5f0430e6a8f92ea68af8e06e06dee7"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
AJI - The Asterisk Jabber Interface <a class="el" href="AJI_intro.html">AJI - The Asterisk Jabber Interface</a> <a class="el" href="res__jabber_8c.html">res_jabber.c</a>. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Matt O'Gorman &lt;<a href="mailto:mogorman@digium.com">mogorman@digium.com</a>&gt; </dd></dl>
<dl compact><dt><b><a class="el" href="extref.html#_extref000002">ExtRef:</a></b></dt><dd>IKSEMEL <a href="http://iksemel.jabberstudio.org">http://iksemel.jabberstudio.org</a></dd></dl>

<p>
Definition in file <a class="el" href="jabber_8h-source.html">jabber.h</a>.<hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="dca29a1140aadadfd92b34a02fa516ef"></a><!-- doxytag: member="jabber.h::@0" ref="dca29a1140aadadfd92b34a02fa516ef" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">anonymous enum          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="dca29a1140aadadfd92b34a02fa516ef06a41072317f7ac737a6c1184614dcc8"></a><!-- doxytag: member="AJI_AUTOPRUNE" ref="dca29a1140aadadfd92b34a02fa516ef06a41072317f7ac737a6c1184614dcc8" args="" -->AJI_AUTOPRUNE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="dca29a1140aadadfd92b34a02fa516ef3bb663af18eefaedfada893d270461fe"></a><!-- doxytag: member="AJI_AUTOREGISTER" ref="dca29a1140aadadfd92b34a02fa516ef3bb663af18eefaedfada893d270461fe" args="" -->AJI_AUTOREGISTER</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="jabber_8h-source.html#l00058">58</a> of file <a class="el" href="jabber_8h-source.html">jabber.h</a>.<div class="fragment"><pre class="fragment"><a name="l00058"></a>00058      {
<a name="l00059"></a>00059    <a class="code" href="jabber_8h.html#dca29a1140aadadfd92b34a02fa516ef06a41072317f7ac737a6c1184614dcc8">AJI_AUTOPRUNE</a> = (1 &lt;&lt; 0),
<a name="l00060"></a>00060    <a class="code" href="jabber_8h.html#dca29a1140aadadfd92b34a02fa516ef3bb663af18eefaedfada893d270461fe">AJI_AUTOREGISTER</a> = (1 &lt;&lt; 1)
<a name="l00061"></a>00061 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="6cf519fe6cd004f907a91afe0df59b28"></a><!-- doxytag: member="jabber.h::aji_btype" ref="6cf519fe6cd004f907a91afe0df59b28" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="jabber_8h.html#6cf519fe6cd004f907a91afe0df59b28">aji_btype</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="6cf519fe6cd004f907a91afe0df59b288fcfb687807ea69697f8ce8bfadc7b06"></a><!-- doxytag: member="AJI_USER" ref="6cf519fe6cd004f907a91afe0df59b288fcfb687807ea69697f8ce8bfadc7b06" args="" -->AJI_USER</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="6cf519fe6cd004f907a91afe0df59b2807a6754867c82ab49a7e8e186781c6f0"></a><!-- doxytag: member="AJI_TRANS" ref="6cf519fe6cd004f907a91afe0df59b2807a6754867c82ab49a7e8e186781c6f0" args="" -->AJI_TRANS</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="6cf519fe6cd004f907a91afe0df59b287f54e356f9b9b0450cf40dcaea7d981c"></a><!-- doxytag: member="AJI_UTRANS" ref="6cf519fe6cd004f907a91afe0df59b287f54e356f9b9b0450cf40dcaea7d981c" args="" -->AJI_UTRANS</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="jabber_8h-source.html#l00063">63</a> of file <a class="el" href="jabber_8h-source.html">jabber.h</a>.<div class="fragment"><pre class="fragment"><a name="l00063"></a>00063                {
<a name="l00064"></a>00064    <a class="code" href="jabber_8h.html#6cf519fe6cd004f907a91afe0df59b288fcfb687807ea69697f8ce8bfadc7b06">AJI_USER</a>=0,
<a name="l00065"></a>00065    <a class="code" href="jabber_8h.html#6cf519fe6cd004f907a91afe0df59b2807a6754867c82ab49a7e8e186781c6f0">AJI_TRANS</a>=1,
<a name="l00066"></a>00066    <a class="code" href="jabber_8h.html#6cf519fe6cd004f907a91afe0df59b287f54e356f9b9b0450cf40dcaea7d981c">AJI_UTRANS</a>=2
<a name="l00067"></a>00067 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a7803c50f209988f91243660782a4968"></a><!-- doxytag: member="jabber.h::aji_state" ref="a7803c50f209988f91243660782a4968" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="jabber_8h.html#a7803c50f209988f91243660782a4968">aji_state</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="a7803c50f209988f91243660782a4968dc02f24ab750bc9d5c0ea90a1e118ffc"></a><!-- doxytag: member="AJI_DISCONNECTED" ref="a7803c50f209988f91243660782a4968dc02f24ab750bc9d5c0ea90a1e118ffc" args="" -->AJI_DISCONNECTED</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="a7803c50f209988f91243660782a4968bd0009b0a599c343dd67bda97df21667"></a><!-- doxytag: member="AJI_CONNECTING" ref="a7803c50f209988f91243660782a4968bd0009b0a599c343dd67bda97df21667" args="" -->AJI_CONNECTING</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="a7803c50f209988f91243660782a49688714eda3e048a4103c90a29756ccf74a"></a><!-- doxytag: member="AJI_CONNECTED" ref="a7803c50f209988f91243660782a49688714eda3e048a4103c90a29756ccf74a" args="" -->AJI_CONNECTED</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="jabber_8h-source.html#l00052">52</a> of file <a class="el" href="jabber_8h-source.html">jabber.h</a>.<div class="fragment"><pre class="fragment"><a name="l00052"></a>00052                {
<a name="l00053"></a>00053    <a class="code" href="jabber_8h.html#a7803c50f209988f91243660782a4968dc02f24ab750bc9d5c0ea90a1e118ffc">AJI_DISCONNECTED</a> = 0,
<a name="l00054"></a>00054    <a class="code" href="jabber_8h.html#a7803c50f209988f91243660782a4968bd0009b0a599c343dd67bda97df21667">AJI_CONNECTING</a>,
<a name="l00055"></a>00055    <a class="code" href="jabber_8h.html#a7803c50f209988f91243660782a49688714eda3e048a4103c90a29756ccf74a">AJI_CONNECTED</a>
<a name="l00056"></a>00056 };
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="96e3c38873e23969a62361a640cf3b6f"></a><!-- doxytag: member="jabber.h::ast_aji_check_roster" ref="96e3c38873e23969a62361a640cf3b6f" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_aji_check_roster           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8ef0ac1eb05ee9817ac93bf3b4ea9fc7"></a><!-- doxytag: member="jabber.h::ast_aji_create_chat" ref="8ef0ac1eb05ee9817ac93bf3b4ea9fc7" args="(struct aji_client *client, char *room, char *server, char *topic)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_aji_create_chat           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structaji__client.html">aji_client</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>room</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>server</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>topic</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
create a chatroom. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="structaji__client.html">aji_client</a></em>&nbsp;</td><td>struct , room, server, topic for the room. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0. </dd></dl>

<p>
Definition at line <a class="el" href="res__jabber_8c-source.html#l01412">1412</a> of file <a class="el" href="res__jabber_8c-source.html">res_jabber.c</a>.
<p>
References <a class="el" href="res__jabber_8c-source.html#l01534">ast_aji_increment_mid()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, <a class="el" href="jabber_8h-source.html#l00123">aji_client::mid</a>, and <a class="el" href="jabber_8h-source.html#l00125">aji_client::p</a>.<div class="fragment"><pre class="fragment"><a name="l01413"></a>01413 {
<a name="l01414"></a>01414    <span class="keywordtype">int</span> res = 0;
<a name="l01415"></a>01415    iks *iq = NULL;
<a name="l01416"></a>01416    iq = iks_new(<span class="stringliteral">"iq"</span>);
<a name="l01417"></a>01417    <span class="keywordflow">if</span> (iq &amp;&amp; client) {
<a name="l01418"></a>01418       iks_insert_attrib(iq, <span class="stringliteral">"type"</span>, <span class="stringliteral">"get"</span>);
<a name="l01419"></a>01419       iks_insert_attrib(iq, <span class="stringliteral">"to"</span>, server);
<a name="l01420"></a>01420       iks_insert_attrib(iq, <span class="stringliteral">"id"</span>, client-&gt;<a class="code" href="structaji__client.html#b54636fb2424701bb8b88c2be67879d5">mid</a>);
<a name="l01421"></a>01421       <a class="code" href="jabber_8h.html#ebfaf0db3d081c62499bc5126b0e317a">ast_aji_increment_mid</a>(client-&gt;<a class="code" href="structaji__client.html#b54636fb2424701bb8b88c2be67879d5">mid</a>);
<a name="l01422"></a>01422       iks_send(client-&gt;<a class="code" href="structaji__client.html#83878c91171338902e0fe0fb97a8c47a">p</a>, iq);
<a name="l01423"></a>01423    } <span class="keywordflow">else</span> 
<a name="l01424"></a>01424       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Out of memory.\n"</span>);
<a name="l01425"></a>01425    <span class="keywordflow">return</span> res;
<a name="l01426"></a>01426 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="562927b787f20710d70a995ec9ebaf2f"></a><!-- doxytag: member="jabber.h::ast_aji_disconnect" ref="562927b787f20710d70a995ec9ebaf2f" args="(struct aji_client *client)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_aji_disconnect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structaji__client.html">aji_client</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>client</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
disconnect from jabber server. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="structaji__client.html">aji_client</a></em>&nbsp;</td><td>struct. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>1. </dd></dl>

<p>
Definition at line <a class="el" href="res__jabber_8c-source.html#l01874">1874</a> of file <a class="el" href="res__jabber_8c-source.html">res_jabber.c</a>.
<p>
References <a class="el" href="res__jabber_8c-source.html#l00175">aji_client_destroy()</a>, <a class="el" href="logger_8c-source.html#l00989">ast_verbose()</a>, <a class="el" href="astobj_8h-source.html#l00219">ASTOBJ_UNREF</a>, <a class="el" href="asterisk_8c-source.html#l00163">option_verbose</a>, <a class="el" href="jabber_8h-source.html#l00125">aji_client::p</a>, and <a class="el" href="logger_8h-source.html#l00045">VERBOSE_PREFIX_3</a>.
<p>
Referenced by <a class="el" href="res__jabber_8c-source.html#l02401">unload_module()</a>.<div class="fragment"><pre class="fragment"><a name="l01875"></a>01875 {
<a name="l01876"></a>01876    <span class="keywordflow">if</span> (client) {
<a name="l01877"></a>01877       <span class="keywordflow">if</span> (<a class="code" href="group__main__options.html#ge36cdd7167e060bff70d00fbd82809eb">option_verbose</a> &gt; 3)
<a name="l01878"></a>01878          <a class="code" href="logger_8c.html#6a1ef0a194bcc79fccfb662192954477">ast_verbose</a>(<a class="code" href="logger_8h.html#aefd5a67b7464040f5352e4ecdc535ca">VERBOSE_PREFIX_3</a> <span class="stringliteral">"JABBER: Disconnecting\n"</span>);
<a name="l01879"></a>01879       iks_disconnect(client-&gt;p);
<a name="l01880"></a>01880       iks_parser_delete(client-&gt;p);
<a name="l01881"></a>01881       <a class="code" href="astobj_8h.html#5a9448be019b56fa37bce1be4bc2a48f">ASTOBJ_UNREF</a>(client, <a class="code" href="res__jabber_8c.html#467c714ad46b53c5dab9a2ec511d93d0">aji_client_destroy</a>);
<a name="l01882"></a>01882    }
<a name="l01883"></a>01883 
<a name="l01884"></a>01884    <span class="keywordflow">return</span> 1;
<a name="l01885"></a>01885 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="07a908ee08552b61e1fdc273ff290ce3"></a><!-- doxytag: member="jabber.h::ast_aji_get_client" ref="07a908ee08552b61e1fdc273ff290ce3" args="(const char *name)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structaji__client.html">aji_client</a>* ast_aji_get_client           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>name</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
grab a <a class="el" href="structaji__client.html">aji_client</a> structure by label name. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>void.</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>1. </dd></dl>

<p>
Definition at line <a class="el" href="res__jabber_8c-source.html#l02316">2316</a> of file <a class="el" href="res__jabber_8c-source.html">res_jabber.c</a>.
<p>
References <a class="el" href="astobj_8h-source.html#l00402">ASTOBJ_CONTAINER_FIND</a>, <a class="el" href="astobj_8h-source.html#l00429">ASTOBJ_CONTAINER_FIND_FULL</a>, and <a class="el" href="jabber_8h-source.html#l00118">aji_client::user</a>.
<p>
Referenced by <a class="el" href="res__jabber_8c-source.html#l00412">aji_send_exec()</a>, <a class="el" href="chan__gtalk_8c-source.html#l01645">gtalk_create_member()</a>, <a class="el" href="chan__jingle_8c-source.html#l01504">jingle_create_member()</a>, and <a class="el" href="res__jabber_8c-source.html#l02339">manager_jabber_send()</a>.<div class="fragment"><pre class="fragment"><a name="l02317"></a>02317 {
<a name="l02318"></a>02318    <span class="keyword">struct </span><a class="code" href="structaji__client.html">aji_client</a> *client = NULL;
<a name="l02319"></a>02319 
<a name="l02320"></a>02320    client = <a class="code" href="astobj_8h.html#bb4a582d1b01a686da4f5dacfab2cfba">ASTOBJ_CONTAINER_FIND</a>(&amp;<a class="code" href="res__jabber_8c.html#fac04ca68a48af91f0290001604a2463">clients</a>, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>);
<a name="l02321"></a>02321    <span class="keywordflow">if</span> (!client &amp;&amp; !strchr(<a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <span class="charliteral">'@'</span>))
<a name="l02322"></a>02322       client = <a class="code" href="astobj_8h.html#fb9cba0593f685b2803aa8738d393b19">ASTOBJ_CONTAINER_FIND_FULL</a>(&amp;<a class="code" href="res__jabber_8c.html#fac04ca68a48af91f0290001604a2463">clients</a>, <a class="code" href="callerid_8c.html#b068931cc450442b63f5b3d276ea4297">name</a>, <a class="code" href="structaji__client.html#19fb64240c5b0f01607e3215b9f577d9">user</a>,,, strcasecmp);
<a name="l02323"></a>02323    <span class="keywordflow">return</span> client;
<a name="l02324"></a>02324 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="7d9bd3d52ee56cf01e4e7e3e7b0894e3"></a><!-- doxytag: member="jabber.h::ast_aji_get_clients" ref="7d9bd3d52ee56cf01e4e7e3e7b0894e3" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structaji__client__container.html">aji_client_container</a>* ast_aji_get_clients           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="res__jabber_8c-source.html#l02326">2326</a> of file <a class="el" href="res__jabber_8c-source.html">res_jabber.c</a>.
<p>
Referenced by <a class="el" href="chan__gtalk_8c-source.html#l01703">gtalk_load_config()</a>, and <a class="el" href="chan__jingle_8c-source.html#l01561">jingle_load_config()</a>.<div class="fragment"><pre class="fragment"><a name="l02327"></a>02327 {
<a name="l02328"></a>02328    <span class="keywordflow">return</span> &amp;<a class="code" href="res__jabber_8c.html#fac04ca68a48af91f0290001604a2463">clients</a>;
<a name="l02329"></a>02329 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="ebfaf0db3d081c62499bc5126b0e317a"></a><!-- doxytag: member="jabber.h::ast_aji_increment_mid" ref="ebfaf0db3d081c62499bc5126b0e317a" args="(char *mid)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ast_aji_increment_mid           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>mid</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
increments the mid field for messages and other events. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>message</em>&nbsp;</td><td>id. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>void. </dd></dl>

<p>
Definition at line <a class="el" href="res__jabber_8c-source.html#l01534">1534</a> of file <a class="el" href="res__jabber_8c-source.html">res_jabber.c</a>.
<p>
Referenced by <a class="el" href="res__jabber_8c-source.html#l00677">aji_register_approve_handler()</a>, <a class="el" href="res__jabber_8c-source.html#l01412">ast_aji_create_chat()</a>, <a class="el" href="res__jabber_8c-source.html#l01461">ast_aji_invite_chat()</a>, <a class="el" href="chan__gtalk_8c-source.html#l01004">gtalk_action()</a>, <a class="el" href="chan__gtalk_8c-source.html#l00705">gtalk_create_candidates()</a>, <a class="el" href="chan__gtalk_8c-source.html#l00391">gtalk_invite()</a>, <a class="el" href="chan__gtalk_8c-source.html#l00464">gtalk_invite_response()</a>, <a class="el" href="chan__jingle_8c-source.html#l00313">jingle_accept_call()</a>, <a class="el" href="chan__jingle_8c-source.html#l00844">jingle_action()</a>, <a class="el" href="chan__jingle_8c-source.html#l00577">jingle_create_candidates()</a>, and <a class="el" href="chan__jingle_8c-source.html#l01261">jingle_transmit_invite()</a>.<div class="fragment"><pre class="fragment"><a name="l01535"></a>01535 {
<a name="l01536"></a>01536    <span class="keywordtype">int</span> i = 0;
<a name="l01537"></a>01537 
<a name="l01538"></a>01538    <span class="keywordflow">for</span> (i = strlen(<a class="code" href="structaji__client.html#b54636fb2424701bb8b88c2be67879d5">mid</a>) - 1; i &gt;= 0; i--) {
<a name="l01539"></a>01539       <span class="keywordflow">if</span> (<a class="code" href="structaji__client.html#b54636fb2424701bb8b88c2be67879d5">mid</a>[i] != <span class="charliteral">'z'</span>) {
<a name="l01540"></a>01540          <a class="code" href="structaji__client.html#b54636fb2424701bb8b88c2be67879d5">mid</a>[i] = <a class="code" href="structaji__client.html#b54636fb2424701bb8b88c2be67879d5">mid</a>[i] + 1;
<a name="l01541"></a>01541          i = 0;
<a name="l01542"></a>01542       } <span class="keywordflow">else</span>
<a name="l01543"></a>01543          <a class="code" href="structaji__client.html#b54636fb2424701bb8b88c2be67879d5">mid</a>[i] = <span class="charliteral">'a'</span>;
<a name="l01544"></a>01544    }
<a name="l01545"></a>01545 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="315197c47b6a5240d2dab6b011b1707f"></a><!-- doxytag: member="jabber.h::ast_aji_invite_chat" ref="315197c47b6a5240d2dab6b011b1707f" args="(struct aji_client *client, char *user, char *room, char *message)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_aji_invite_chat           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structaji__client.html">aji_client</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>user</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>room</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>message</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
invite to a chatroom. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="structaji__client.html">aji_client</a></em>&nbsp;</td><td>struct ,user, room, message. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>res. </dd></dl>

<p>
Definition at line <a class="el" href="res__jabber_8c-source.html#l01461">1461</a> of file <a class="el" href="res__jabber_8c-source.html">res_jabber.c</a>.
<p>
References <a class="el" href="res__jabber_8c-source.html#l01534">ast_aji_increment_mid()</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, <a class="el" href="jabber_8h-source.html#l00123">aji_client::mid</a>, and <a class="el" href="jabber_8h-source.html#l00125">aji_client::p</a>.<div class="fragment"><pre class="fragment"><a name="l01462"></a>01462 {
<a name="l01463"></a>01463    <span class="keywordtype">int</span> res = 0;
<a name="l01464"></a>01464    iks *invite, *body, *<span class="keyword">namespace</span>;
<a name="l01465"></a>01465 
<a name="l01466"></a>01466    invite = iks_new(<span class="stringliteral">"message"</span>);
<a name="l01467"></a>01467    body = iks_new(<span class="stringliteral">"body"</span>);
<a name="l01468"></a>01468    <span class="keyword">namespace </span>= iks_new("x");
<a name="l01469"></a>01469    <span class="keywordflow">if</span> (client &amp;&amp; invite &amp;&amp; body &amp;&amp; <span class="keyword">namespace</span>) {
<a name="l01470"></a>01470       iks_insert_attrib(invite, <span class="stringliteral">"to"</span>, user);
<a name="l01471"></a>01471       iks_insert_attrib(invite, <span class="stringliteral">"id"</span>, client-&gt;<a class="code" href="structaji__client.html#b54636fb2424701bb8b88c2be67879d5">mid</a>);
<a name="l01472"></a>01472       <a class="code" href="jabber_8h.html#ebfaf0db3d081c62499bc5126b0e317a">ast_aji_increment_mid</a>(client-&gt;<a class="code" href="structaji__client.html#b54636fb2424701bb8b88c2be67879d5">mid</a>);
<a name="l01473"></a>01473       iks_insert_cdata(body, <a class="code" href="structmessage.html">message</a>, 0);
<a name="l01474"></a>01474       iks_insert_attrib(<span class="keyword">namespace</span>, <span class="stringliteral">"xmlns"</span>, <span class="stringliteral">"jabber:x:conference"</span>);
<a name="l01475"></a>01475       iks_insert_attrib(<span class="keyword">namespace</span>, <span class="stringliteral">"jid"</span>, room);
<a name="l01476"></a>01476       iks_insert_node(invite, body);
<a name="l01477"></a>01477       iks_insert_node(invite, <span class="keyword">namespace</span>);
<a name="l01478"></a>01478       res = iks_send(client-&gt;<a class="code" href="structaji__client.html#83878c91171338902e0fe0fb97a8c47a">p</a>, invite);
<a name="l01479"></a>01479    } <span class="keywordflow">else</span> 
<a name="l01480"></a>01480       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Out of memory.\n"</span>);
<a name="l01481"></a>01481    <span class="keywordflow">if</span> (body)
<a name="l01482"></a>01482       iks_delete(body);
<a name="l01483"></a>01483    <span class="keywordflow">if</span> (<span class="keyword">namespace</span>)
<a name="l01484"></a>01484       iks_delete(<span class="keyword">namespace</span>);
<a name="l01485"></a>01485    <span class="keywordflow">if</span> (invite)
<a name="l01486"></a>01486       iks_delete(invite);
<a name="l01487"></a>01487    <span class="keywordflow">return</span> res;
<a name="l01488"></a>01488 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8d5c66f8b55017a19b6e7cf1d722f151"></a><!-- doxytag: member="jabber.h::ast_aji_join_chat" ref="8d5c66f8b55017a19b6e7cf1d722f151" args="(struct aji_client *client, char *room)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_aji_join_chat           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structaji__client.html">aji_client</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>room</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
join a chatroom. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="structaji__client.html">aji_client</a></em>&nbsp;</td><td>struct , room. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>res. </dd></dl>

<p>
Definition at line <a class="el" href="res__jabber_8c-source.html#l01433">1433</a> of file <a class="el" href="res__jabber_8c-source.html">res_jabber.c</a>.
<p>
References <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, <a class="el" href="jabber_8h-source.html#l00125">aji_client::p</a>, and <a class="el" href="jabber_8h-source.html#l00087">aji_resource::priority</a>.<div class="fragment"><pre class="fragment"><a name="l01434"></a>01434 {
<a name="l01435"></a>01435    <span class="keywordtype">int</span> res = 0;
<a name="l01436"></a>01436    iks *presence = NULL, *priority = NULL;
<a name="l01437"></a>01437    presence = iks_new(<span class="stringliteral">"presence"</span>);
<a name="l01438"></a>01438    priority = iks_new(<span class="stringliteral">"priority"</span>);
<a name="l01439"></a>01439    <span class="keywordflow">if</span> (presence &amp;&amp; priority &amp;&amp; client) {
<a name="l01440"></a>01440       iks_insert_cdata(priority, <span class="stringliteral">"0"</span>, 1);
<a name="l01441"></a>01441       iks_insert_attrib(presence, <span class="stringliteral">"to"</span>, room);
<a name="l01442"></a>01442       iks_insert_node(presence, priority);
<a name="l01443"></a>01443       res = iks_send(client-&gt;<a class="code" href="structaji__client.html#83878c91171338902e0fe0fb97a8c47a">p</a>, presence);
<a name="l01444"></a>01444       iks_insert_cdata(priority, <span class="stringliteral">"5"</span>, 1);
<a name="l01445"></a>01445       iks_insert_attrib(presence, <span class="stringliteral">"to"</span>, room);
<a name="l01446"></a>01446       res = iks_send(client-&gt;<a class="code" href="structaji__client.html#83878c91171338902e0fe0fb97a8c47a">p</a>, presence);
<a name="l01447"></a>01447    } <span class="keywordflow">else</span> 
<a name="l01448"></a>01448       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Out of memory.\n"</span>);
<a name="l01449"></a>01449    <span class="keywordflow">if</span> (presence)
<a name="l01450"></a>01450       iks_delete(presence);
<a name="l01451"></a>01451    <span class="keywordflow">if</span> (priority)
<a name="l01452"></a>01452       iks_delete(priority);
<a name="l01453"></a>01453    <span class="keywordflow">return</span> res;
<a name="l01454"></a>01454 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="8a5f0430e6a8f92ea68af8e06e06dee7"></a><!-- doxytag: member="jabber.h::ast_aji_send" ref="8a5f0430e6a8f92ea68af8e06e06dee7" args="(struct aji_client *client, const char *address, const char *message)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ast_aji_send           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structaji__client.html">aji_client</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>client</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>message</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
sends messages. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="structaji__client.html">aji_client</a></em>&nbsp;</td><td>struct , reciever, message. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>1. </dd></dl>

<p>
Definition at line <a class="el" href="res__jabber_8c-source.html#l01388">1388</a> of file <a class="el" href="res__jabber_8c-source.html">res_jabber.c</a>.
<p>
References <a class="el" href="jabber_8h.html#a7803c50f209988f91243660782a49688714eda3e048a4103c90a29756ccf74a">AJI_CONNECTED</a>, <a class="el" href="logger_8c-source.html#l00866">ast_log()</a>, <a class="el" href="jabber_8h-source.html#l00124">aji_client::jid</a>, <a class="el" href="logger_8h-source.html#l00118">LOG_ERROR</a>, <a class="el" href="logger_8h-source.html#l00112">LOG_WARNING</a>, <a class="el" href="jabber_8h-source.html#l00125">aji_client::p</a>, and <a class="el" href="jabber_8h-source.html#l00128">aji_client::state</a>.
<p>
Referenced by <a class="el" href="res__jabber_8c-source.html#l00412">aji_send_exec()</a>, <a class="el" href="res__jabber_8c-source.html#l02002">aji_test()</a>, and <a class="el" href="res__jabber_8c-source.html#l02339">manager_jabber_send()</a>.<div class="fragment"><pre class="fragment"><a name="l01389"></a>01389 {
<a name="l01390"></a>01390    <span class="keywordtype">int</span> res = 0;
<a name="l01391"></a>01391    iks *message_packet = NULL;
<a name="l01392"></a>01392    <span class="keywordflow">if</span> (client-&gt;<a class="code" href="structaji__client.html#9ed39e2ea931586b6a985a6942ef573e">state</a> == <a class="code" href="jabber_8h.html#a7803c50f209988f91243660782a49688714eda3e048a4103c90a29756ccf74a">AJI_CONNECTED</a>) {
<a name="l01393"></a>01393       message_packet = iks_make_msg(IKS_TYPE_CHAT, address, <a class="code" href="structmessage.html">message</a>);
<a name="l01394"></a>01394       <span class="keywordflow">if</span> (message_packet) {
<a name="l01395"></a>01395          iks_insert_attrib(message_packet, <span class="stringliteral">"from"</span>, client-&gt;<a class="code" href="structaji__client.html#3d4478eb8cae476e97eacd52aa1cca16">jid</a>-&gt;full);
<a name="l01396"></a>01396          res = iks_send(client-&gt;<a class="code" href="structaji__client.html#83878c91171338902e0fe0fb97a8c47a">p</a>, message_packet);
<a name="l01397"></a>01397       } <span class="keywordflow">else</span> {
<a name="l01398"></a>01398          <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#4490aa3d29644e716440fada68f54032">LOG_ERROR</a>, <span class="stringliteral">"Out of memory.\n"</span>);
<a name="l01399"></a>01399       }
<a name="l01400"></a>01400       <span class="keywordflow">if</span> (message_packet)
<a name="l01401"></a>01401          iks_delete(message_packet);
<a name="l01402"></a>01402    } <span class="keywordflow">else</span>
<a name="l01403"></a>01403       <a class="code" href="logger_8c.html#46fbacc19de763bbca2547c1a9c6a5fa">ast_log</a>(<a class="code" href="logger_8h.html#d0cb3df3102ca9270c5785af9a8c137f">LOG_WARNING</a>, <span class="stringliteral">"JABBER: Not connected can't send\n"</span>);
<a name="l01404"></a>01404    <span class="keywordflow">return</span> 1;
<a name="l01405"></a>01405 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Thu May 24 22:27:34 2007 for Asterisk - the Open Source PBX by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.5 </small></address>
</body>
</html>
